Executor5-bulk is a full Git clone of ooRexx5.
Executor5 is a partial Git clone of ooRexx5.
Executor is a partial Git clone of ooRexx4.2.

2014 was the year of a very drastic overhaul of ooRexx for Git Merge:
files were renamed, moved, classes and methods were renamed, moved,
and a multitude of cosmetic changes were made.
ooRexx5 was borned.

Executor5 was created because it was not possible to merge the changes made to
ooRexx5 into the Executor Github repository.

Twelve years later, Executor5-bulk was created to test the feasibility and
usability of a complete Git clone of ooRexx's SVN repository. The directory
organization is identical to that of SVN: branches and releases are
subdirectories, not Git branches or Git tags. This should facilitate support for
future SVN branches.

Executor5 and Executor5-bulk are not synchronized.
Some changes made to Executor5, such as low-level MT trace at the semaphore/
mutex level, will not be applied to Executor5-bulk. And vice-versa.


===============================================================================
2026 feb 25

[ooTest framework]

Fixed this bug when asking for a log file:

    $ rexx -S -U -l log.txt -X native_api
       856 *-*         if \ self~checkFileName(lFile)
       531 *-*         if \ self~validateAndSetOpt("logFile"~upper, value, "-l")
       393 *-*         j = self~parseShortOpt(token, i)
       204 *-* self~parse
           *-* Compiled method "NEW" with scope "Object".
        51 *-* cl = .CommandLine~new(arguments)
        79 *-* retCode = 'worker.rex'(arguments)
    Error 98 running /Users/Shared/local/rexx/oorexx/executor5-bulk/test/trunk/worker.rex line 856:  Execution error.
    Error 98.986:  Reference to unassigned variable "LFILE".


===============================================================================
2026 feb 24

[.Class~method]

Fixed bug #2038 say .buffer~method("INIT") crashes the interpreter

Before the fix:
    Crash when executing say .buffer~method("INIT").
    Not compatible with ooRexx 4.2:
    Returns a method only if this method has been defined on the class.
    The inherited methods are not taken into account.
    say .weakreference~method("INIT") -- Object method not found.

After the fix:
    No crash when executing say .buffer~method("INIT").
    Remains compatible with ooRexx 4.2:
    say .weakreference~method("INIT") -- a Method


Validation:
say .buffer~method("INIT")          -- a Method instead of a crash
say .weakreference~method("INIT")   -- a Method instead of .NIL


===============================================================================
2026 feb 23

[String]

Added a new "translateInto" method to the String class.
This is a generalization of the "translate" method.

string~translate(                  [tableo], [tablei], [pad], [n], [length]           )
string~translateInto( destination, [tableo], [tablei], [pad], [n], [length], [refEnd] )

Documentation:
--------------

Translate sequences of characters into another sequence of characters.
Append the translated sequences of characters to the destination.
Currently, the destination must be a mutable buffer, but it could be any object
supporting the "append" method at C++ level..
The resulting string may be shorter or longer than the receiving string.

tablei and tableo can be either a string or an array.

If tablei is a string:
  - each character in the receiving string is searched in tablei.
  - If the character is found, the corresponding translation item in tableo
    is tried.
If tablei is an array, the matcher items are:
  - either a routine that may match a sequence of characters,
  - or any non-NIL object whose string representation is used as a sequence
    of characters for matching in the receiving string.
  - or .NIL which is ignored
  - or OREF_NULL (an omitted item in the array) which is ignored.
  - If there is a match, the corresponding translation item in tableo is tried.

If tableo is a string, the translation items are characters.
If tableo is an array, the translation items are:
  - either a routine that may append a sequence of characters,
  - or any non-NIL object whose string representation is used as a sequence
    of characters to append. A string representation is always applicable.
  - or .NIL to stop the translation.
  - or OREF_NULL (an omitted item in the array) to stop the translation.

Arguments passed to a matcher routine in tablei:
    string: The string that received the "translateInto" message.
    pos:    The current matching position in string (first character).

Arguments passed to a translation routine in tableo:
    destination: The destination of the translation.
                 The routine can append text to it.
    string:      The string that received the "translateInto" message.
    pad:         The pad string passed with the "translateInto" message, can be
                 omitted.
    pos:         The current matching position in string (first character).
    matchLength: The length of the current matched substring. The routine can
                 either return this length or return a different length.

Interpretation of the result returned by a routine:
          |    no result     | 0 or not a number | > 0 (offset of next position)
in tablei | stop translation | no match          | match
in tableo | stop translation | not applicable    | translation applied

If there are duplicates in tablei:
  - the first (leftmost if string) occurrence is selected.
  - if the corresponding translation item is a routine and this routine
    returns 0, then the next occurrence in tablei is selected.
    Repeat until a translation item is applicable, or until there are no more
    occurences.
  - otherwise only the first corresponding translation item is used.

If there is a match and the corresponding translation item is applicable, the
translation is appended to the destination. The next position in the receiving
string is updated:
  - Character matching: advance by one character.
  - String matching: advance by the length of the corresponding string.
  - Matching by routine: advance by the returned number (unless overriden)
  - Translation by routine: advance by the returned number (override)

If there is no match or no applicable translation item, the current character
in the receiving string is appended to the destination. The next position in
the receiving string is advanced by one character.

At the end of the translation, the current position in the receiving string
is returned in the optional refEnd variable reference.


Validation:
-----------

scripts/string/translateInto_test.rex


===============================================================================
2026 feb 23

[rexxtry]

RFE #868	Better support of EOF in rexxtry

Implemented using a Windows workaround for stream~query("isTTY"), to avoid
creating a dependency on a new feature.

Validation:
echo say hello | rexx rexxtry

No more infinite loop.
rexxtry is terminated with the message "Exit because no more input to interpret: STDIN NOTREADY".


===============================================================================
2026 feb 23

[Stream]

RFE #867 Determine whether a stream is associated with a terminal

I use "isTTY" instead of "isaTerminal", following these recommendations:
https://claude.ai/share/ad054966-a3fa-4426-91e6-a57faee3504a
https://chatgpt.com/share/699b057b-b7dc-8007-8d04-0a1b546cef56

Added support for
- stream~query("isTTY")
- stream~command("query isTTY")
- stream("aStream", "Command", "Query isTTY")
returning "YES" or "NO" or "UNKNOWN"

Examples:
say .stdout~query("isTTY")                        -- "YES"
say .stdout~command("Query isTTY")                -- "YES"
say stream("STDOUT", "Command", "Query isTTY")    -- "YES"
rexx -e "say .stdin~query('isTTY')"               -- "YES"
echo "test" | rexx -e "say .stdin~query('isTTY')" -- "NO"


Validation:
scripts/stream/stream_isatty_test
scripts/stream/stream_isatty_test.bat

Output on macOS:                                                            Output on Windows:
cd scripts/stream/                                                          cd scripts\stream\
./stream_isatty_test                                                        stream_isatty_test.bat

    output=stream_istty_test-out.txt                                            set output=stream_istty_test-out.txt

    rexx stream_istty.rex "$output"                                             rexx stream_istty.rex %output%
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

    rexx stream_istty.rex "$output" 1> /dev/stdout                              rexx stream_istty.rex %output% 1> CON
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

    rexx stream_istty.rex "$output" 2> /dev/stdout                              rexx stream_istty.rex %output% 2> CON
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

                                                              *****************
                                                              * Difference #1 *
                                                              *****************
    rexx stream_istty.rex "$output" dont_stdout 1> /dev/null                    rexx stream_istty.rex %output% dont_stdout 1> NUL
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: TRANSIENT  isTTY: NO                                     stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

                                                              *****************
                                                              * Difference #2 *
                                                              *****************
    rexx stream_istty.rex "$output" 2> /dev/null                                rexx stream_istty.rex %output% 2> NUL
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: NO                                     stderr streamType: TRANSIENT  isTTY: YES

    echo test | rexx stream_istty.rex "$output"                                 echo test | rexx stream_istty.rex %output%
         stdin  streamType: TRANSIENT  isTTY: NO                                     stdin  streamType: TRANSIENT  isTTY: NO
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

                                                                                :: Executed manually from CMD because must press ENTER
    echo test | cat /dev/stdin | rexx stream_istty.rex "$output"                echo test | type CON | rexx stream_istty.rex %output%
         stdin  streamType: TRANSIENT  isTTY: NO                                     stdin  streamType: TRANSIENT  isTTY: NO
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES

    rexx stream_istty.rex "$output" < /dev/stdin                                rexx stream_istty.rex %output% < CON
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

    echo test > in.tmp.txt && rexx stream_istty.rex "$output" < in.tmp.txt      echo test > in.tmp.txt && rexx stream_istty.rex %output% < in.tmp.txt
         stdin  streamType: PERSISTENT isTTY: NO                                     stdin  streamType: PERSISTENT isTTY: NO
         stdout streamType: TRANSIENT  isTTY: YES                                    stdout streamType: TRANSIENT  isTTY: YES
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

    rexx stream_istty.rex "$output" > out.tmp.txt && cat out.tmp.txt            rexx stream_istty.rex %output% > out.tmp.txt && type out.tmp.txt
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: PERSISTENT isTTY: NO                                     stdout streamType: PERSISTENT isTTY: NO
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

    rexx stream_istty.rex "$output" | cat                                       rexx stream_istty.rex %output% | findstr "^"
         stdin  streamType: TRANSIENT  isTTY: YES                                    stdin  streamType: TRANSIENT  isTTY: YES
         stdout streamType: TRANSIENT  isTTY: NO                                     stdout streamType: TRANSIENT  isTTY: NO
         stderr streamType: TRANSIENT  isTTY: YES                                    stderr streamType: TRANSIENT  isTTY: YES

                                                              *****************
                                                              * Difference #3 *
                                                              *****************
    rexx -e "say .stream~new('/dev/null')~~open('read')~query('isTTY')"         rexx -e "say .stream~new('NUL')~~open('read')~query('isTTY')"
         UNKNOWN                                                                     YES


Difference #1 and #2
   Windows.
    _isatty returns non-zero for NUL ==> isTTY == YES, should be NO.
    This is a known problem:
    https://stackoverflow.com/questions/3648711/detect-nul-file-descriptor-isatty-is-bogus
    https://github.com/pallets/click/pull/1135

Difference #3
    Bug ooRexx on macOS and Linux.
    Error when opening /dev/null read-only ==> isTTY == UNKNOWN
    No error when opening /dev/null write-only or read-write ==> isTTY == NO.
    More details in _notes.txt.


===============================================================================
2026 feb 21

[Windows]

For users (like me) who prefer not to enable the UTF-8 beta option:
Added codepage and translateflags parameters to RxMessageBox.

Motivated by:
https://sourceforge.net/p/oorexx/discussion/408478/thread/ec4123a46d/
2025 Mar 22 [oorexx:discussions] Output text in Russian in RxMessageBox()

RxMessageBox(text [, title] [, button] [,icon] [, option]    [, codepage [, translateflags]])
                                                 *updated*       *new*          *new*

new CUSTOM option.
new HELP option.
codepage = The text and title code page.
translateflags = flags for SysToUnicode.

- If codePage is omitted or is an empty string, the text and title (which should
  be ANSI strings) are converted from ACP to Unicode by the system.

- If codePage is "UNICODE", the text and title (which should be UTF-16 strings)
  are displayed as-is.

- For any other value of codepage, the text and title (which should be strings
  encoded in codepage) are converted from codepage to Unicode using the Rexx
  utility SysToUnicode.

- The standard MessageBoxW is used by default to display Unicode strings.
  If the CUSTOM option is specified then a custom MessageBoxW is used.
  The custom MessageBoxW displays emojis in colors using the "Segoe UI Emoji"
  font that carries the full-color COLR/CPAL emoji glyphs on Windows 10+.
  The emojis in the caption are still displayed in black and white.

- If the HELP option is specified then a Help button is added to the message
  box. This is applicable to any button style, so more general than the HELP
  button style.

- The HELP button style is not documented, but is supported.
  The message box contains two push buttons: OK and Help.

The behavior of the custom MessageBoxW is different from the standard
MessageBoxW regarding the effect of the Help button:

- Standard MessageBoxW: When the user clicks the Help button or presses F1, the
  system sends a WM_HELP message to the owner window. The message box is not
  closed. Since RxMessageBox creates a message box with no owner window, the
  WM_HELP message is not sent.

- Custom MessageBoxW: When the user clicks the Help button, the message box is
  closed and the value 9 is returned. The F1 key has no effect.

When displaying long multi-line text with many emojis using the CUSTOM option,
there is a noticeable lag between the dialog box display and the text display.
AI can't do better. It's definitely not me who can make this better.


It remains to support:

    Modality:
        MB_APPLMODAL (default, already supported)
        MB_SYSTEMMODAL
        MB_TASKMODAL

    Other options:
        MB_SETFOREGROUND
        MB_DEFAULT_DESKTOP_ONLY
        MB_TOPMOST
        MB_RIGHT
        MB_RTLREADING
        MB_SERVICE_NOTIFICATION


Validation:
scripts/unicode/rxmessagebox.rex

Careful!
The following tests performed from the CLI will not display Unicode strings
correctly:
rexx -e "say RxMessageBox('PÃ¨re NoÃ«l ðŸŽ…', /*title*/, /*button*/, /*icon*/, /*options*/, 65001)"
rexx -e "chcp; text = 'PÃ¨re NoÃ«l ðŸŽ…'; say text; say text~c2x; say RxMessageBox(text, text, /*button*/, /*icon*/, /*options*/, 65001)"

This is not a limitation or bug of the extended RxMessageBox.
Under Windows, character strings passed to rexx.exe from the CLI are encoded in
the ACP code page (or the OEM code page, not sure which one is used...),
regardless of the console code page (chcp).
Examples, when OEM = 437 and ACP = 1252:
    chcp 437 &   rexx -e "s = 'PÃ¨re NoÃ«l ðŸŽ…'; say s s~c2x"      -- PÎ¦re NoÎ´l ?? 50E87265204E6FEB6C203F3F
    chcp 850 &   rexx -e "s = 'PÃ¨re NoÃ«l ðŸŽ…'; say s s~c2x"      -- PÃžre NoÃ™l ?? 50E87265204E6FEB6C203F3F
    chcp 1252 &  rexx -e "s = 'PÃ¨re NoÃ«l ðŸŽ…'; say s s~c2x"      -- PÃ¨re NoÃ«l ?? 50E87265204E6FEB6C203F3F
    chcp 65001 & rexx -e "s = 'PÃ¨re NoÃ«l ðŸŽ…'; say s s~c2x"      -- Pï¿½re Noï¿½l ?? 50E87265204E6FEB6C203F3F
    chcp 65001 & rexx -e "s = 'PÃˆRE NOÃ‹L ðŸŽ…'; say s s~c2x"      -- Pï¿½RE NOï¿½L ?? 50C85245204E4FCB4C203F3F


===============================================================================
2026 feb 19

[Unicode]

Implement RFE #864 Add Unicode (UTF-8) support to syntax error 13.1
https://sourceforge.net/p/oorexx/feature-requests/864/
When the invalid byte is the begining of an UTF_8 bytes sequence then
    display the UTF-8 character (1 to 4 bytes).
    display the bytes sequence in hex (2 to 8 hexadecimal digits).
Otherwise the default behavior is applied:
    display the invalid byte as a character.
    display its two hexadecimal digits.

Validation:
scripts/unicode/incorrect_character.rex

Output:
    1: say a {= 1
         5 *-* say a {
         5 *-* interpret s      -- Error 13.1:  Incorrect character in program "{" ('7B'X).
    Incorrect character in program "{" ('7B'X).
    Error code= 13.1

    2: say a Â¬= 1
         6 *-* say a Â¬
         6 *-* interpret s      -- Error 13.1:  Incorrect character in program "Â¬" ('C2AC'X).
    Incorrect character in program "Â¬" ('C2AC'X).
    Error code= 13.1

    3: say a â‚¬= 1
         7 *-* say a â‚¬
         7 *-* interpret s      -- Error 13.1:  Incorrect character in program "â‚¬" ('E282AC'X).
    Incorrect character in program "â‚¬" ('E282AC'X).
    Error code= 13.1

    4: say a ðŸ¦–= 1
         8 *-* say a ðŸ¦–
         8 *-* interpret s     -- Error 13.1:  Incorrect character in program "ðŸ¦–" ('F09FA696'X).
    Incorrect character in program "ðŸ¦–" ('F09FA696'X).
    Error code= 13.1

    5: "say a " || "C0"x || "= 1"
        13 *-* say a ?
        13 *-* interpret s    -- Error 13.1:  Incorrect character in program "?" ('C0'X).
    Incorrect character in program "?" ('C0'X).
    Error code= 13.1

    6: "say a " || "80"x || "= 1"
        16 *-* say a ?
        16 *-* interpret s    -- Error 13.1:  Incorrect character in program "?" ('80'X).
    Incorrect character in program "?" ('80'X).
    Error code= 13.1


===============================================================================
2026 feb 18

[Unicode]

Add utf8proc version 2.11.3 with Unicode 17 support.
License http://opensource.org/licenses/MIT


===============================================================================
2026 feb 15

Creation of the Github repository Executor5-bulk.

Inspired by
https://stackoverflow.com/questions/60009188/cloning-a-large-svn-repository-from-sourceforge-with-git-svn-clone

The key point is that the Git clone is created from a local backup of the SVN
repository. It's fast, no time-out.
No attempt is made to create Git branches from SVN releases and branches.
Instead, the SVN folder organization is reproduced as-is in the Git repo.
Anyway, it would not be possible to create Git branches because there are
several roots (docs, main, ooDialog, rexxgtk, test, websites).
No attempt to map SVN usernames to Git names and emails
(e.g., john = John Doe <john@example.com>), but that could be easily done.


The procedure:

# https://sourceforge.net/p/forge/documentation/svn/#h-backups
$ cd /local/rexx/oorexx
$ rsync -av svn.code.sf.net::p/oorexx/code-0 oorexx.svn
# around 10 min.
# size = 538â€¯667â€¯304 bytes (635,3 MB on disk) for 26â€¯512 items


$ git svn clone file://`pwd`/oorexx.svn oorexx.git > git_svn_clone.log 2>&1
# around 40 min
# 2,4 GB on disk for 75â€¯217 items
# 1,98 GB on disk for 75â€¯212 items

$ cd /local/rexx/oorexx/oorexx.git
$ git svn info
    Path: .
    URL: file:///local/rexx/oorexx/oorexx.svn
    Repository Root: file:///local/rexx/oorexx/oorexx.svn
    Repository UUID: 0b6cbdbe-3aab-466e-b73a-abd511dda0a2
    Revision: 13100
    Node Kind: directory
    Schedule: normal
    Last Changed Author: perolovjonsson
    Last Changed Rev: 13100
    Last Changed Date: 2026-02-08 22:53:25 +0100 (Sun, 08 Feb 2026)


# https://git-scm.com/docs/git-svn#Documentation/git-svn.txt-svn-remoteltnamegtrewriteRoot

# the order is important!
$ git config --local svn-remote.svn.rewriteRoot `git config --local --get svn-remote.svn.url`
$ git config --local svn-remote.svn.url https://svn.code.sf.net/p/oorexx/code-0

$ git svn info
    Path: .
    URL: file:///local/rexx/oorexx/oorexx.svn
    Repository Root: https://svn.code.sf.net/p/oorexx/code-0
    Repository UUID: 0b6cbdbe-3aab-466e-b73a-abd511dda0a2
    Revision: 13100
    Node Kind: directory
    Schedule: normal
    Last Changed Author: perolovjonsson
    Last Changed Rev: 13100
    Last Changed Date: 2026-02-08 22:53:25 +0100 (Sun, 08 Feb 2026)
# It's normal to still see the local URL.
# It must be kept because the history depends on it.
# The new commits will be taken from the Repository Root.
# The repository's UUID is identical to that of SourceForge.


# Now preparing to push the local clone to github.
# First, rename oorexx.git to executor5-bulk
$ cd /local/rexx/oorexx
$ mv oorexx.git executor5-bulk

# Create the github repository executor5-bulk
<not described>

# Push the local clone to github.
$ git remote add origin git@github.com:jlfaucher/executor5-bulk.git
$ git status
    On branch master
    nothing to commit (use -u to show untracked files)
$ git branch -M main
$ git status
    On branch main
    nothing to commit (use -u to show untracked files)
$ git push -u origin main


# Fetch and rebase latest SVN changes
git svn rebase


# For those who do not wish to clone the entire git repository, it will be
# possible to obtain a subset of it.
git clone --filter=blob:none --no-checkout https://github.com/jlfaucher/executor5-bulk.git executor5-bulk.subset
# 340 MB
cd executor5-bulk.subset
git sparse-checkout init --cone
git sparse-checkout set main/trunk
git sparse-checkout add incubator/regex
git sparse-checkout add docs/trunk
git sparse-checkout add test/trunk
git checkout
# 438 MB instead of 1.98 GB


===============================================================================
History of merges.

rev 13100

Remember, to merge the last changes from SVN:
cd /local/rexx/oorexx/executor5-bulk
git svn rebase
