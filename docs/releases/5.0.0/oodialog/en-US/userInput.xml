<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2005-2022, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter id="chapUserInput"><title>User Input</title>
<indexterm><primary>User Input</primary></indexterm>
<para>
  Capturing user input is normally an important part of any program. In one sense, the ooDialog framework is almost
  completely about capturing user input as that is the primary role of a dialog.
</para>
<para>
  The following table lists the general categories of user input in the Windows operating system, as described by the
  Windows documentation. Several of the categories have no current implmentation in ooDialog, or the implementation
  is scattered throughout the <xref linkend="chpDialogObject"/> and dialog
  <xref linkend="chpDialogControlObject"/> classes. These categories are mentioned here for completeness. Future versions of
  ooDialog may be enhanced to address those categories.
<table id="tblUserInputClasses" frame="all"> <title>ooDialog User Input Groups</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>User Input</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="sctCommonDialogLibrary"/></entry>
<entry>Objects and routines used to easily gather user input in a standard way.</entry>
</row>
<row>
<entry>Keyboard Accelerators</entry>
<entry>Keyboard accelerators are keystrokes or combination of keystrokes that generate a command notification for a program.</entry>
</row>
<row>
<entry><xref linkend="clsKeyboard"/>  Input</entry>
<entry>The operating system generates keyboard input from the physical keyboard and provides the means for a program to receive and process that input. ooDialog has the <computeroutput>Keyboard</computeroutput> class to deal with functionality related to the keyboard. However, for historic reasons some of the keyboard related function is scattered throughout the dialog and dialog control classes.</entry>
</row>
<row>
<entry><xref linkend="clsMouse"/> Input</entry>
<entry>The mouse is an important, but optional, input device for programs. ooDialog programs deal with mouse input primarily through the <computeroutput>Mouse</computeroutput> class</entry>
</row>
<row>
<entry>Raw Input</entry>
<entry>
  There are many user input devices beside the traditional keyboard and mouse, such as a joystick or touchpad. The operating system provides a generalized means for programs to receive and process
  that input.
</entry>
</row>
</tbody></tgroup>
</table>
</para>


<section id="sctCommonDialogLibrary" xreflabel="Common Dialog Library"><title>Common Dialog Library</title>
<indexterm><primary>Common Input Dialogs and Routines</primary></indexterm>
<para>
  The ooDialog framework provides a number of easy to use dialogs and routines that obtain user input in common
  scenarios. These dialogs and routines allow programmers to include simple graphical elements in their Rexx
  applications and collect user input in a standard way. The public routines can be called with a single line of code
  and the standard dialogs can usually be executed with only two lines of code. This does not require the programmer to
  do much set up and makes them simple to work with.
</para>

<section id="sctStandardClassesRoutines"><title>Class and Routine Table</title>

<para>
  The common dialogs and routines are listed the following table:
</para>
<table id="tStandardElements" frame="all">
<title>Common Dialog Classes and Public Routines</title>
<tgroup cols="2">
<colspec colwidth="11*" />
<colspec colwidth="32*" />
<thead>
<row>
<entry>Class / Routine</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="rtnAskDialog"/> routine</entry>
<entry>Pops up a message box containing the specified question, a Yes, and a No push button.</entry>
</row>
<row>
<entry><xref linkend="clsCheckList"/> class</entry>
<entry>A dialog with a group of one or more check boxes.</entry>
</row>
<row>
<entry><xref linkend="rtnCheckList"/> routine</entry>
<entry>A shortcut function to invoke the <computeroutput>CheckList</computeroutput> dialog.</entry>
</row>
<row>
<entry><xref linkend="rtnErrorDialog"/> routine</entry>
<entry>Pops up a message box containing the specified error message, an Ok push button, and an error icon.</entry>
</row>
<row>
<entry><xref linkend="rtnFileNameDialog"/> routine</entry>
<entry>Causes a file selection dialog box to appear.</entry>
</row>
<row>
<entry><xref linkend="rtnInfoDialog"/> routine</entry>
<entry>Pops up a message box containing the specified text and an Ok push button.</entry>
</row>
<row>
<entry><xref linkend="clsInputBox"/> class</entry>
<entry>Provides a simple dialog with a title, a message, an edit control, and the Ok and Cancel push buttons.</entry>
</row>
<row>
<entry><xref linkend="rtnInputBox"/> routine</entry>
<entry>A shortcut function to invoke an <computeroutput>InputBox</computeroutput> dialog as a function.</entry>
</row>
<row>
<entry><xref linkend="clsIntegerBox"/> class</entry>
<entry>An <computeroutput>InputBox</computeroutput> dialog whose edit control allows only numerical data.</entry>
</row>
<row>
<entry><xref linkend="rtnIntegerBox"/> routine</entry>
<entry>A shortcut to invoke an <computeroutput>IntegerBox</computeroutput> dialog as a function.</entry>
</row>
<row>
<entry><xref linkend="clsListChoice"/> class</entry>
<entry>Provides a dialog with a single-selection list box, and the Ok and Cancel push buttons.</entry>
</row>
<row>
<entry><xref linkend="rtnListChoice"/> routine</entry>
<entry>Provides a shortcut to invoke a <computeroutput>ListChoice</computeroutput> dialog.</entry>
</row>
<row>
<entry><xref linkend="rtnMessageDialog"/> routine</entry>
<entry>Pops up a message box with the options specified.</entry>
</row>
<row>
<entry><xref linkend="clsMultiInputBox"/> class</entry>
<entry>A dialog that provides a title, a message, and one or more edit controls.</entry>
</row>
<row>
<entry><xref linkend="rtnMultiInputBox"/> routine</entry>
<entry>Provides a shortcut function to invoke a <computeroutput>MultiInputBox</computeroutput> dialog</entry>
</row>
<row>
<entry><xref linkend="clsMultiListChoice"/> class</entry>
<entry>A <computeroutput>ListChoice</computeroutput> dialog that allows multi-item selection</entry>
</row>
<row>
<entry><xref linkend="rtnMultiListChoice"/> routine</entry>
<entry>Provides a shortcut to invoke a <computeroutput>MultiListChoice</computeroutput> dialog.</entry>
</row>
<row>
<entry><xref linkend="clsPasswordBox"/> class</entry>
<entry><computeroutput>InputBox</computeroutput> dialog with that uses a password edit control.</entry>
</row>
<row>
<entry><xref linkend="rtnPasswordBox"/> routine</entry>
<entry>A shortcut to invoke a <computeroutput>PasswordBox</computeroutput> dialog.</entry>
</row>
<row>
<entry><xref linkend="clsProgressDialog"/> class</entry>
<entry>A pre-built dialog with a progress bar that can be used to show the progress of a lengthy operation in an application</entry>
</row>
<row>
<entry><xref linkend="clsSingleSelection"/> class</entry>
<entry>A dialog that has a group of radio buttons. The user can select only one item of the group.</entry>
</row>
<row>
<entry><xref linkend="rtnSingleSelection"/> routine</entry>
<entry>Provides a quick way to invoke a <computeroutput>SingleSelection</computeroutput> dialog.</entry>
</row>
<row>
<entry><xref linkend="clsTimedMessage"/> class</entry>
<entry>Shows a message window for a defined duration.</entry>
</row>
<row>
<entry><xref linkend="rtnTimedMessage"/> routine</entry>
<entry>Provides a quick way to invoking a <computeroutput>TimedMessage</computeroutput> dialog.</entry>
</row>
</tbody></tgroup>
</table>

</section>

<section id="sctStandardDialogs"><title>Standard Dialog Classes</title>
<indexterm><primary>standard dialogs</primary></indexterm>
<para>The standard dialog classes are: </para>
<itemizedlist>
<listitem><para>TimedMessage</para></listitem>
<listitem><para>InputBox</para></listitem>
<listitem><para>PasswordBox</para></listitem>
<listitem><para>IntegerBox</para></listitem>
<listitem><para>MultiInputBox</para></listitem>
<listitem><para>ListChoice</para></listitem>
<listitem><para>MultiListChoice</para></listitem>
<listitem><para>CheckList</para></listitem>
<listitem><para>SingleSelection</para></listitem>
</itemizedlist>
<para></para>
<variablelist>
<varlistentry><term>Preparation:</term>
<listitem><para>Standard dialogs are prepared by using the
<computeroutput>new</computeroutput> method of the class, which in turn
invokes the <computeroutput>init</computeroutput> method. The parameters for
the <computeroutput>new</computeroutput> method are described for the
<computeroutput>init</computeroutput> method of each class.
</para></listitem></varlistentry>
<varlistentry><term>Execution:</term>
<listitem><para>The dialog is then run by using the
<computeroutput>execute</computeroutput> method. For most of the standard
dialogs <computeroutput>execute</computeroutput> returns the user's input if
the OK button is clicked and the null string if the Cancel button is clicked to
terminate the dialog. If there is more than one return value, execute returns
the value 1 and stores the results in an attribute.  Exceptions to the general
rule are noted in the documentation for the individual dialog.
</para></listitem></varlistentry>
<varlistentry><term>Functions:</term>
<listitem><para>Each standard dialog is also available as a callable function.
These functions are described in the
Public Routines <link linkend="sctPublicRoutines">section</link> of this chapter.
</para></listitem></varlistentry>
</variablelist>


<section id="clsCheckList" xreflabel="CheckList"><title>CheckList Class</title>
<indexterm><primary>CheckList</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>CheckList</secondary></indexterm>
<para>The CheckList class is a dialog with a group of
one or more check boxes. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns 1 (if OK was clicked). The check boxes
selected by the user are marked in a stem variable with the value 1.
</para></listitem></varlistentry>
</variablelist>
<para>The method listed below is defined by this class.</para>

<section id="initCheckList" xreflabel="init"><title>init</title>
<indexterm><primary>init</primary>
<secondary>CheckList class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aCheckList~init(--message--,--title--,--labels.--,--datas.-->

>---+------------------------+--)----------------><
    +-,--+-----+--+--------+-+
         +-len-+  +-,--max-+


]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the check box group.  Use
it to give the user advice on what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string for the dialog's title
</para></listitem></varlistentry>
<varlistentry><term>labels.</term>
<listitem><para>A stem variable (do not forget the trailing period) containing all the
labels for the check boxes
</para></listitem></varlistentry>
<varlistentry><term>datas.</term>
<listitem><para>This argument is a stem variable (do not forget the trailing period)
that you can use to preselect the check boxes. The first check box relates
to stem item 101, the second to 102, and so forth. A value of 1 indicates selected, and a value of 0 indicates deselected.</para>
<para>For example, Datas.103=1 indicates
that there is a check mark on the third box.</para>
</listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>Determines the length of the check boxes and labels. If omitted, the
size is calculated to fit the largest label.
</para></listitem></varlistentry>
<varlistentry><term>max</term>
<listitem><para>The maximum number of check boxes in one column. If there are more check
boxes than max - that is, labels. has more items than the value of max
- this method continues with a new column.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates and shows a dialog with seven check boxes:
</para></listitem></varlistentry>
</variablelist>

<programlisting>
<![CDATA[
lst.1 = "Monday";   lst.2 = "Tuesday"; lst.3 = "Wednesday"
lst.4 = "Thursday"; lst.5 = "Friday";  lst.6 = "Saturday"
lst.7 = "Sunday"

do i = 101 to 107
   chk.i = 0
end

dlg = .CheckList~new("Please select a day!","Day of week",lst., chk.)
if dlg~execute = 1 then do
   say "You selected the following day(s): "
   do i = 101 to 107
      a = i-100
      if chk.i = 1 then say lst.a
   end
end
]]>
</programlisting>
</section>
</section>

<section id="clsInputBox" xreflabel="InputBox"><title>InputBox Class</title>
<indexterm><primary>InputBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>InputBox</secondary></indexterm>
<para>The InputBox class provides a simple dialog with
a title, a message, one entry line, an OK, and a Cancel push button. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's input
</para></listitem></varlistentry>
</variablelist>
<para>The methods listed below are defined by this class.</para>

<section id="initInputBox" xreflabel="init"><title>init</title>
<indexterm><primary>init</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~init(--message--,--title--,--prevalue--,--len--)----><


]]>
</programlisting>

<para>The init method prepares the input dialog. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed in the dialog
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A string that is displayed as the dialog's title in the title bar
</para></listitem></varlistentry>
<varlistentry><term>prevalue</term>
<listitem><para>A string to initialize the entry line. If you do not want to put any
text in the entry line, just pass an empty string.
</para></listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>The width of the entry line in dialog units
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example shows an InputBox dialog with the title of
<emphasis role="italic">Input</emphasis> and an entry line:
<programlisting>
<![CDATA[
dlg = .InputBox~New("Please enter your email address", -
                    "Input", "user@host.domain", 150)
value = dlg~execute
say "You entered:" value
drop dlg
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="h002128"><title>defineDialog</title>
<indexterm><primary>defineDialog</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~DefineDialog--------------------------------------><


]]>
</programlisting>

<para>The defineDialog method is called by the create method of the parent
class, which in turn is called at the very beginning of
Execute. You do not have to call it. However, you may want to over-ride it in
your subclass to add more dialog controls to the window. If you over-ride it, you
have to forward the message to the parent class by using the keyword super.
</para>
</section>

<section id="h002138"><title>AddLine</title>
<indexterm><primary>AddLine</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~AddLine(--x--,--y--,--l--)------------------------><


]]>
</programlisting>

<para>The AddLine method is used internally to add one
entry line to the dialog.</para>
</section>

<section id="h002148"><title>execute</title>
<indexterm><primary>execute</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~Execute-------------------------------------------><


]]>
</programlisting>

<para>The execute method creates and shows the dialog. After termination, the
value of the entry line is returned if the user clicks the OK button; a null
string is returned if the user clicks on Cancel.</para>
</section>
</section>

<section id="clsIntegerBox" xreflabel="IntegerBox"><title>IntegerBox Class</title>
<indexterm><primary>IntegerBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>IntegerBox</secondary></indexterm>
<para>The IntegerBox class is an <xref linkend="clsInputBox"/>
dialog whose entry line allows only numerical data. </para>
<variablelist>
<varlistentry><term>Subclass:</term>
<listitem><para>This class is a subclass of the InputBox <xref linkend="clsInputBox"/> class
</para></listitem></varlistentry>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's numeric input
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the InputBox <xref linkend="clsInputBox"/>
class, with the exception of Validate.</para>

<section id="h002189"><title>validate</title>
<indexterm><primary>validate</primary>
<secondary>IntegerBox function</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aIntegerBox~validate----------------------------------------><


]]>
</programlisting>

<para>The only method this subclass overrides is validate, which is one of the
automatically called methods of PlainUserDialog. It is invoked by the OK method,
which in turn is called in response to a push button event. This method checks
whether or not the entry line contains a valid numerical value. If the value is
invalid, a message window is displayed.
</para>
</section>
</section>

<section id="clsListChoice" xreflabel="ListChoice"><title>ListChoice Class</title>
<indexterm><primary>ListChoice</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>ListChoice</secondary></indexterm>
<para>The ListChoice class provides a dialog with a list
box, an OK, and a Cancel button.
The selected item is returned if the OK push button
is used to terminate the dialog. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's choice or a null string
</para></listitem></varlistentry>
</variablelist>
<para>The method listed below is defined by this class.</para>

<section id="initListChoice" xreflabel="init"><title>init</title>
<indexterm><primary>init</primary>
<secondary>ListChoice class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListChoice~init(--message--,--title--,--input.-------------->

>--+---------------------------------------------------+-------><
   +-,--+------+--+-------------------------------+--)-+
        +-lenx-+  +-,--+------+--+--------------+-+
                       +-leny-+  +-,--preselect-+


]]>
</programlisting>

<para>The init method is used to initialize a newly created
instance of this class. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the list box. Use it to give
the user advice on what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string for the dialog's title
</para></listitem></varlistentry>
<varlistentry><term>input.</term>
<listitem><para>A stem variable (do not forget the trailing period) containing string
values that are inserted into the list box
</para></listitem></varlistentry>
<varlistentry><term>lenx, leny</term>
<listitem><para>The size of the list box in dialog units
</para></listitem></varlistentry>
<varlistentry><term>preselect</term>
<listitem><para>Entry that is selected when list pops up
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a list choice dialog box where the user
can select exactly one dessert:
</para></listitem></varlistentry>
</variablelist>
<programlisting>
<![CDATA[
lst.1 = "Cookies"; lst.2 = "Pie"; lst.3 = "Ice cream"; lst.4 = "Fruit"

dlg = .ListChoice~new("Select the dessert please","YourChoice",lst., , ,"Pie")
say "Your ListChoice data:" dlg~execute
]]>
</programlisting>
</section>
</section>

<section id="clsMultiInputBox" xreflabel="MultiInputBox"><title>MultiInputBox Class</title>
<indexterm><primary>MultiInputBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>MultiInputBox</secondary></indexterm>
<para>The MultiInputBox class is a dialog that provides
a title, a message, and one or more entry lines. After execution of this dialog
you can access the values of the entry lines. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns 1 (if OK was clicked). The values entered
by the user are stored in attributes matching the labels of the entry lines.
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the InputBox <xref linkend="clsInputBox"/>
class, with the exception of Init.</para>

<section id="initMultiInputBox" xreflabel="init"><title>init</title>
<indexterm><primary>init</primary>
<secondary>MultiInputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aMultiInputBox~init(--message--,--title--,--labels.--,--datas.-->

>--+--------+--)---------------------------------><
   +-,--len-+


]]>
</programlisting>

<para>The init method is called automatically whenever
a new instance of this class is created.  It prepares the dialog. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the entry lines. Use it to
give the user advice on what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string that is displayed in the title bar.
</para></listitem></varlistentry>
<varlistentry><term>labels.</term>
<listitem><para>A stem variable containing strings that are used as labels on the left
side of the entry lines. Labels.1 becomes the label
for the first entry line, labels.2 for the second,
and so forth.
</para></listitem></varlistentry>
<varlistentry><term>datas.</term>
<listitem><para>A stem variable (do not forget the trailing period) containing strings
that are used to initialize the entry lines. The entries must start with 101
and continue in increments of 1.
</para></listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>The length of the entry lines. All entry lines get the same length.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a four-line input box. The data entered
is stored in the object attributes that are displayed after dialog execution.

<programlisting>
<![CDATA[
lab.1 = "First name"  ;     lab.2 = "Last name "
lab.3 = "Street and City" ; lab.4 = "Profession:"

addr.101 = "John" ; addr.102 = "Smith" ; addr.103 = ""
addr.104 = "Software Engineer"

dlg = .MultiInputBox~new("Please enter your address", ,
"Your Address", lab., addr.)
if dlg~execute = 1 then do
  say "The address is:"
  say dlg~firstname dlg~lastname
  say dlg~StreetandCity
  say dlg~Profession
end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>
</section>

<section id="clsMultiListChoice" xreflabel="MultiListChoice"><title>MultiListChoice Class</title>
<indexterm><primary>MultiListChoice</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>MultiListChoice</secondary></indexterm>
<para>The MultiListChoice class is an extension of the ListChoice class. It makes it possible for the user to
select more than one line at a time. The execute method
returns the selected items' indexes separated by blank spaces.  The first
item has index 1. </para>
<variablelist>
<varlistentry><term>Subclass:</term>
<listitem><para>This class is a subclass of the ListChoice <xref linkend="clsListChoice"/>
</para></listitem></varlistentry>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the index numbers of the entries selected
</para></listitem></varlistentry>
<varlistentry><term>Preselect:</term>
<listitem><para>Indexes of entries, separated by a blank, that are to be preselected.
The first entry has index 1 and the rest are increments of one.
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the ListChoice <xref linkend="clsListChoice"/>
class, except that execute returns the index numbers
of the selected entries. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a multiple list choice box where the user
can select multiple entries:
</para></listitem></varlistentry>
</variablelist>
<programlisting>
<![CDATA[
lst.1 = "Monday" ;   lst.2 = "Tuesday" ; lst.3 = "Wednesday"
lst.4 = "Thursday" ; lst.5 = "Friday" ;  lst.6 = "Saturday"
lst.7 = "Sunday"

dlg = .MultiListChoice~new("Select the days you are working this week", ,
                           "YourMultipleChoice",lst., , ,"2 5")
s = dlg~execute
if s <> "" then do while s \= ""
                  parse var s res s
                  say lst.res
               end
]]>
</programlisting>
</section>

<section id="clsPasswordBox" xreflabel="PasswordBox"><title>PasswordBox Class</title>
<indexterm><primary>PasswordBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>PasswordBox</secondary></indexterm>
<para>The PasswordBox class is an InputBox dialog with an entry line that echoes the keys with asterisks
(*) instead of characters. </para>
<variablelist>
<varlistentry><term>Subclass:</term>
<listitem><para>This class is a subclass of the InputBox <xref linkend="clsInputBox"/>
</para></listitem></varlistentry>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's password
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the InputBox <xref linkend="clsInputBox"/>,
with the exception of AddLine.</para>

<section id="h002166"><title>AddLine</title>
<indexterm><primary>AddLine</primary>
<secondary>PasswordBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aPasswordBox~AddLine(--x--,--y--,--l--)-------><

]]>
</programlisting>

<para>The AddLine overrides the same method of the parent
class, InputBox, by using a password entry line instead
of a simple entry line.</para>
</section>
</section>

<section id="sctProgressDialog" xreflabel="A Progress Dialog"><title>A Progress Dialog</title>
<indexterm><primary>progress dialog implementation</primary></indexterm>
<para>
  ooDialog provides, as a standard dialog, an easy to use implementation of a progress dialog in the <xref
  linkend="clsProgressDialog"/> class. This implementation includes two small helper classes for the
  <computeroutput>ProgressDialog</computeroutput> class, the <xref linkend="clsInterruptible"/> and the <xref
  linkend="clsAlerter"/> classes. These classes are documented in this section.
</para>

<section id="clsProgressDialog" xreflabel="ProgressDialog"><title>ProgressDialog Class</title>
<indexterm><primary>ProgressDialog class</primary></indexterm>
<para>
  A <computeroutput>ProgressDialog</computeroutput> object is used to show a dialog containing a <xref
  linkend="clsProgressBar"/>, an optional message, an optional status line, and an optional <emphasis
  role="italic">Cancel</emphasis> button. The dialog shows the progress a lengthy task is making to the user. The optional
  components of the dialog, the message text, the status line, et., can be used to convey more information concerning the
  progress, or the purpose of the dialog, to the user. The components can be used, or not used, according to the needs of
  the application.
</para>
<para>
  The progress dialog internally creates and sizes the components of the dialog, and the dialog itself, depending on how it
  is configured. For instance, if the dialog is configured to skip the message and status components, and the progress is not
  cancelable by the user, the dialog will consist of a progress bar only. The width of the dialog will either be a calculated
  width, default width, or a configured width. The height of the dialog will be the proper height to accommodate the progress
  bar and other components, with margins. The layout of the dialog, from top to bottom, has a static control for the message
  at the top of the dialog, then a static control for the status line, then the progress bar, and finally a cancel button at
  the bottom right hand corner. The static message text, static status text, and progress bar controls are all the entire
  width of the dialog with an equal margin on each side.
</para>
<para>
  By default, the width of the dialog is calculated based on the width of the message text. If there is no message, the width
  is calculated based on the width of a typical message. Or, the programmer can configure a width. The dialog maintains a
  minimum width that it will not be sized smaller than.
</para>
<para>
  The dialog object has a number of attributes that are used configure the appearance and behaviour of the dialog. The
  attributes all have default values and the progress dialog can be simply used <emphasis role="italic">as is</emphasis>, or
  the programmer can change the values of any or all of the attributes. The methods of the
  <computeroutput>ProgressDialog</computeroutput> class are used to start, update, and close the dialog.
</para>
<para>
  Normally, an application, shows the progress bar, starts its lengthy operation, and periodically, as it makes progress with
  the operation, it advances the progress bar position. When the operation finishes, the application ends the progress bar.
  With the <computeroutput>ProgressDialog</computeroutput> object, the programmer first configures the object by setting any
  attributes whose default values are not appropriate. The <xref linkend="mthBegin"/> method shows the progress bar. As the
  operation progresses, the programmer advances the progress bar position using the <xref linkend="mthIncrease"/> method. The
  <xref linkend="mthUpdateStatus"/> and <xref linkend="mthUpdateStatusText"/> methods can also be used to update the status
  line as progress is made, if desired. Finally, the <xref linkend="mthCompleteClsProgressDialog"/> and <xref
  linkend="mthEndNow"/> methods are used to end the dialog.
</para>
<para>
  One important aspect of performing a lengthy operation is whether the user can, or can not, cancel the operation once it is
  begun. By default, the progress dialog can not be canceled by the user, and no cancel button is present in the dialog. If
  the user tries to end the dialog using the Escape key, the Close menu item in the system menu, or the close button in the
  title bar, a message box is put up explaining that the operation is not done yet and can not be canceled. The dialog is not
  allowed to close. This default behaviour is changed throught the <xref linkend="atrCanCancel"/> attribute or through the
  <xref linkend="mthSetInterruptible"/> method. The use of an <xref linkend="clsInterruptible"/> object gives the programmer
  an elegant way of handling and controlling a user's request to cancel the operation.
</para>

<section id="sctMethodsProgressDialog"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>ProgressDialog</computeroutput> class:

<table id="tblMethodsProgressDialog" frame="all"> <title>ProgressDialog Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Constant Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">constant Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="sctProgressDialogConstantMethods"/></entry>
<entry>Some constants defined by the <computeroutput>ProgressDialog</computeroutput> class may be of use to the programmer.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsProgressDialog"/></entry>
<entry>Instantiates a new <computeroutput>ProgressDialog</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrAbsoluteWidth"/></entry>
<entry>Reflects whether the width of the dialog is calculated based on the width of the message text, or if the width is set to an absolute value by the application.</entry>
</row>
<row>
<entry><xref linkend="atrCanCancel"/></entry>
<entry>The <emphasis role="italic">canCancel</emphasis> attribute specifies whether the user is allowed to cancel the progress dialog or not.</entry>
</row>
<row>
<entry><xref linkend="atrCaptionText"/></entry>
<entry>Reflects the text that will be used for the title of the progress dialog.</entry>
</row>
<row>
<entry><xref linkend="atrIncrStep"/></entry>
<entry>Reflects the value of the step increment for the progress bar in the dilaog.</entry>
</row>
<row>
<entry><xref linkend="atrInitialStatusText"/></entry>
<entry>Reflects the text that will be displayed on the status line in the progress dialog when the dialog is first shown.</entry>
</row>
<row>
<entry><xref linkend="atrMarqueeMode"/></entry>
<entry>Reflects the status of the marquee mode of the progress bar.</entry>
</row>
<row>
<entry><xref linkend="atrMarqueePause"/></entry>
<entry>Reflects the time in milliseconds between updates in the animation when in marquee mode.</entry>
</row>
<row>
<entry><xref linkend="atrMsgHeight"/></entry>
<entry>Reflects the number of lines that the area for the message text will take up.</entry>
</row>
<row>
<entry><xref linkend="atrMsgText"/></entry>
<entry>Reflects the text to be displayed in the message area of the progress dialog.</entry>
</row>
<row>
<entry><xref linkend="atrNoMsg"/></entry>
<entry>Reflects whether the progress dialog will contain a message area or not.</entry>
</row>
<row>
<entry><xref linkend="atrNoStatus"/></entry>
<entry>Reflects whether the progress dialog will have a status line or not.</entry>
</row>
<row>
<entry><xref linkend="atrRangeMax"/></entry>
<entry>Reflects the highest position the progress bar can be moved to.</entry>
</row>
<row>
<entry><xref linkend="atrRangeMin"/></entry>
<entry>Reflects the lowest position the progress bar can be moved to.</entry>
</row>
<row>
<entry><xref linkend="atrWidthClsProgressDialog"/></entry>
<entry>Reflects the, possible, width of the progress dialog.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthBegin"/></entry>
<entry>Begins the execution of the underlying Windows dialog.</entry>
</row>
<row>
<entry><xref linkend="mthCompleteClsProgressDialog"/></entry>
<entry>Moves the position of the progress bar to the end of the bar.</entry>
</row>
<row>
<entry><xref linkend="mthEndNow"/></entry>
<entry>Ends the execution of the underlying progress dialog.</entry>
</row>
<row>
<entry><xref linkend="mthIncrease"/></entry>
<entry>The <emphasis role="italic">increase</emphasis> method moves the position of the progress bar by the value of the <xref linkend="atrIncrStep"/> attribute, or by the specified amount if the <emphasis role="italic">step</emphasis> argument is specified.</entry>
</row>
<row>
<entry><xref linkend="mthSetInterruptible"/></entry>
<entry>Passes an instantiated <xref linkend="clsInterruptible"/> object to the Rexx progress dialog object.</entry>
</row>
<row>
<entry><xref linkend="mthUpdateStatus"/></entry>
<entry>Updates the status line with the supplied text.</entry>
</row>
<row>
<entry><xref linkend="mthUpdateStatusText"/></entry>
<entry>Updates the status line using the exact text specified.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="sctProgressDialogConstantMethods" xreflabel="constants"><title>Constant Methods</title>
<indexterm><primary>constant methods</primary><secondary>ProgressDialog class</secondary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>constant methods</secondary></indexterm>
<para>
  The <computeroutput>ProgressDialog</computeroutput> class uses a number of <emphasis role="italic">constant</emphasis>
  values that are defined using the <computeroutput>::constant</computeroutput> directive. Some of these constants may be of
  use to the programmer when working with a progress dialog object. These constants are listed and documented in this
  section. The useful constants provided by the class are listed in the table below:
</para>
<table id="tblConstantsProgressDialog" frame="all"> <title>Useful Progress Dialog Constant Reference</title>
<tgroup cols="2">
<colspec colwidth="1*"/>
<colspec colwidth="3*"/>
<thead>
<row>
<entry>Constant Symbol</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry>IDC_PB_MAIN</entry>
<entry>The resource ID of the progress bar used in the dialog. This ID could be used to get the <xref linkend="clsProgressBar"/> object in the dialog and manipulate it directly using the methods of the class.</entry>
</row>
<row>
<entry>IDC_ST_MSG</entry>
<entry>The resource ID of the static text control used for the message in the dialog. This ID could be used to get the <xref linkend="clsStatic"/> object in the dialog and manipulate it directly using the methods of the class.</entry>
</row>
<row>
<entry>IDC_ST_STATUS</entry>
<entry>The resource ID of the static text control used for the status line in the dialog. This ID could be used to get the <xref linkend="clsStatic"/> object in the dialog and manipulate it directly using the methods of the class.</entry>
</row>
</tbody></tgroup>
</table>
</section>  <!-- End Section Constant Methods -->

<section id="mthNewClsProgressDialog" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>ProgressDialog class</secondary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--+--------+--+-------+--+-------+--+-------+--+--------+--)-----------><
          +-capt-,-+  +-,-msg-+  +-,-min-+  +-,-max-+  +-,-step-+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>ProgressDialog</computeroutput> object and sets its configuration attributes as
  specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>capt [optional]</term>
    <listitem>
    <para>
      Specifies the caption, the title, for the dialog. The <xref linkend="atrCaptionText"/> attribute is set to the value
      specified. If this argument is omitted, the <emphasis role="italic">captionText</emphasis> attribute is set to the
      default of <emphasis role="italic">Application Processing ...</emphasis>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>msg [optional]</term>
    <listitem>
    <para>
      Specifies the text for a message to be displayed at the top of the dialog box. The <xref linkend="atrMsgText"/>
      attribute is set to this value. If this argument is omitted, the <emphasis role="italic">msgText</emphasis> attribute
      is set to a default value of <emphasis role="italic">Background processing is taking place.  Please be
      patient.</emphasis>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>min [optional]</term>
    <listitem>
    <para>
      Sets the minimum value for the progress bar's <link linkend="mthSetFullRangePBC">range</link>. The <xref
      linkend="atrRangeMin"/> attribute is set to this value. If this arugment is omitted, the <emphasis
      role="italic">rangeMin</emphasis> attribute is set to 0.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>max [optional]</term>
    <listitem>
    <para>
      Sets the maximum value for the progress bar's <link linkend="mthSetFullRangePBC">range</link>. The <xref
      linkend="atrRangeMax"/> attribute is set to this value. If this arugment is omitted, the <emphasis
      role="italic">rangeMax</emphasis> attribute is set to 100.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>step [optional]</term>
    <listitem>
    <para>
      Specifies the <link linkend="mthSetStepPBC">step</link> increment for the progress bar. The <xref
      linkend="atrIncrStep"/> attribute is set to this value. If this argument is omitted, the <emphasis
      role="italic">stepIncr</emphasis> attribute is set to a default value of 1.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a newly instantiated <computeroutput>ProgressDialog</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The exact behaviour and appearance of the progress dialog is configured by setting the values of its attributes. Only
    a few of the attribute's values can be set by arguments to the <emphasis role="italic">new</emphasis> method. The other
    attriubtes are all set to default values when the object is instantiated. The documentation for the individual attributes
    specifies what the default value for the attribute is.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a progress dialog, specifying a title and message for the dialog. It changes the range from
    0 to 100, to 0 to 200, and changes the step increment value to 4:
<programlisting>
<![CDATA[

  title = 'Acme Widgets - Business Contacts'
  msg = 'Creating and inserting the contact information. This will take some time.'

  pbDlg = .ProgressDialog~new(title, msg, , 200, 4)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::new() -->

<section id="atrAbsoluteWidth" xreflabel="absoluteWidth"><title>absoluteWidth (Attribute)</title>
<indexterm><primary>absoluteWidth</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>absoluteWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--absoluteWidth--------------------------------><

>>--absoluteWidth = trueOrFalse------------------><

]]>
</programlisting>

<para>
  Reflects whether the width of the dialog is calculated based on the width of the message text, or if the width is set to
  an absolute value by the application. This attribute is set to true or false. By default, the width of the dialog is
  calculated based on the width of the message text, or the width of the default message if the <xref linkend="atrMsgText"/>
  attribute is not set.
</para>
<para>
  However, the programmer can change this behavior by setting <emphasis role="italic">absoluteWidth</emphasis> to true and
  setting the <xref linkend="atrWidthClsProgressDialog"/> attriubte to a desired width.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When <emphasis role="italic">absoluteWidth</emphasis> is false, the value of the <emphasis role="italic">width</emphasis>
    attribute is always ignored. False is the default value for <emphasis role="italic">absoluteWidth</emphasis>. The
    programmer needs to set both attributes to force a desired width for the progress bar dialog.
  </para>
  <para>
    Note that the progress dialog can not be made smaller in width than a minimum width enforced by the class. This
    minimum width is the width of 2 buttons plus the margins and the space between 2 buttons.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example the programmer wants the progress dialog to be wider than that calculated from the message text and
    wider than the enforced minimum:
<programlisting>
<![CDATA[

  title = 'Acme Widgets - Business Contacts'
  msg = 'Inserting information.'

  pbDlg = .ProgressDialog~new(title, msg, , 200, 4)

  pbDlg~absoluteWidth = .true
  pbDlg~width = 196
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::absoluteWidth() [attribute]  -->

<section id="atrCanCancel" xreflabel="canCancel"><title>canCancel (Attribute)</title>
<indexterm><primary>CanCancel</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>canCancel</secondary></indexterm>
<programlisting>
<![CDATA[
>>--canCancel------------------------------------><

>>--canCancel = trueOrFalse----------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">canCancel</emphasis> attribute specifies whether the user is allowed to cancel the progress
  dialog or not. By default, the dialog can not be canceled and the value of this attriubte is false. If this attribute is
  true, then a Cancel button is added to the dialog and the user is allowed to close, to cancel, the dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the programmer configures the dialog such that it can be canceled, then this implies to the user that closing the
    dialog halts the lengthy operation in progress. It is the programmer's responsibility to handle that. The <xref
    linkend="clsInterruptible"/> class and the <xref linkend="mthSetInterruptible"/> method provide some tools to allow the
    programmer to handle canceling the dialog in a graceful manner.
  </para>
  <para>
    If the <emphasis role="italic">setInterruptible</emphasis> method is used to assign an
    <computeroutput>Interruptible</computeroutput> object, the <emphasis role="italic">canCancel</emphasis> attribute is
    automatically set to true.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::canCancel() [attribute]  -->

<section id="atrCaptionText" xreflabel="captionText"><title>captionText (Attribute)</title>
<indexterm><primary>captionText</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>captionText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--captionText----------------------------------><

>>--captionText = title--------------------------><
]]>
</programlisting>

<para>
  Reflects the text that will be used for the title of the progress dialog. By default this attribute is set to <emphasis
  role="italic">Application Processing ...</emphasis>
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">captionText</emphasis> attribute can also be set by using the <emphasis
    role="italic">capt</emphasis> argument in the <xref linkend="mthNewClsProgressDialog"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a new progress dialog object and then configures its title and message:
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new

  pbDlg~captionText = 'Acme Widgets - Business Contacts'
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::captionText() [attribute]  -->

<section id="atrIncrStep" xreflabel="incrStep"><title>incrStep (Attribute)</title>
<indexterm><primary>incrStep</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>incrStep</secondary></indexterm>
<programlisting>
<![CDATA[
>>--incrStep-------------------------------------><

>>--incrStep = increment-------------------------><

]]>
</programlisting>

<para>
  Reflects the value of the step increment for the progress bar in the dilaog. The step increment is the amount by which the
  progress bar advances its current position when the <xref linkend="mthIncrease"/> method is called without an increment
  value.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    By default the step increment for the progress bar is set to 1. Each time the <emphasis role="italic">increase</emphasis>
    method is invoked with no arguments, the position in the progress bar is advanced by the value of the step increment. If
    the progress bar has a range of 0 - 100 and the step increment is 4, invoking the <emphasis
    role="italic">increase</emphasis> method 25 times would move the position in the progress bar to the end.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a new progress dialog and then configures its step increment to 4.
<programlisting>
<![CDATA[

  title = 'Acme Widgets - Business Contacts'
  msg = 'Inserting information.'

  pbDlg = .ProgressDialog~new(title, msg)

  pbDlg~incrStep = 4
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::incrStep() [attribute]  -->

<section id="atrInitialStatusText" xreflabel="initialStatusText"><title>initialStatusText (Attribute)</title>
<indexterm><primary>initialStatusText</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>initialStatusText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--initialStatusText----------------------------><

>>--initialStatusText = text---------------------><

]]>
</programlisting>

<para>
  Reflects the text that will be displayed on the status line in the progress dialog when the dialog is first shown. The
  status line is displayed just above the progress bar in the dialog. By default, if the <xref linkend="atrNoStatus"/>
  attribute is not set to true, the status line will display <emphasis role="italic">Status:</emphasis>. The programmer can
  change the value of the <emphasis role="italic">initialStatusText</emphasis> so that some other text is displayed when the
  dialog starts. Perhaps the empty string.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example configures the progress dialog to have a status line, but to display no text for the status when the dialog
    starts. Then, as the operation of creating rows proceeds, the application periodically updates the status line with the
    number of rows created.
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~initialStatusText = ''
  ...
  pbDlg~begin
  ...
  pbDlg~updateStatus(i 'full rows created')


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::initialStatusText() [attribute]  -->

<section id="atrMarqueeMode" xreflabel="marqueeMode"><title>marqueeMode (Attribute)</title>
<indexterm><primary>MarqueeMode</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>marqueeMode</secondary></indexterm>
<programlisting>
<![CDATA[
>>--marqueeMode----------------------------------><

>>--marqueeMode = onOrOff------------------------><

]]>
</programlisting>

<para>
  Reflects the status of the marquee mode of the progress bar. By default, the attribute is false, the progress bar will not
  use marquee mode. Setting this attributed to true has the progress bar use marquee mode.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Marquee mode animates a progress bar in a way that shows activity but does not indicate what proportion of the task is
    complete. The highlighted part of the progress bar moves repeatedly along the length of the bar. The animation of the
    progress bar can be started and stopped.  The speed of the animation can also be controlled. Marquee progress bars do
    not have a range or position.
  </para>
  <para>
    The initial speed of the animation is controlled through the <xref linkend="atrMarqueePause"/> attribute. Starting,
    stopping the animation, or changing its speed after the progress dialog is started can be done by using the <link
    linkend="sctProgressDialogConstantMethods">constant</link> ID of the progress bar to retrieve the <xref
    linkend="clsProgressBar"/> object and using the <xref linkend="mthSetMarqueePBC"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example configures a progress dialog to use marquee mode with an initial pause time of 50 milliseconds. At some
    later point during the operation, the animation is turned off. At a later point following that, the animation is turned
    back on with a pause time of 25 milliseconds:
<programlisting>
<![CDATA[

  progressDlg = .ProgressDialog~new
  progressDlg~marqueeMode = .true
  progressDlg~marqueePause = 50

  ...

  pb = progressDlg~newProgressBar(progressDlg~IDC_PB_MAIN)

  -- Turn the animation off
  pb~setMarquee(.false)

  ...

  -- Turn the animation back on, but faster
  pb~setMarquee(.true, 25)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::MarqueeMode() [attribute]  -->

<section id="atrMarqueePause" xreflabel="marqueePause"><title>marqueePause (Attribute)</title>
<indexterm><primary>MarqueePause</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>marqueePause</secondary></indexterm>
<programlisting>
<![CDATA[
>>--marqueePause---------------------------------><

>>--marqueePause = milliseconds------------------><

]]>
</programlisting>

<para>
  Reflects the time in milliseconds between updates in the animation when in marquee mode. The default for this attriubte is
  100 milliseconds. The value of the attribute is ignored unless the progress bar is put in marquee <link
  linkend="atrMarqueeMode">mode</link>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example configures the progress dialog to use marquee mode for the progress bar and sets the pause time ot 50
    milliseconds instead of the default 100.
<programlisting>
<![CDATA[

  progressDlg = .ProgressDialog~new
  progressDlg~marqueeMode = .true
  progressDlg~marqueePause = 50

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::marqueePause() [attribute]  -->

<section id="atrMsgHeight" xreflabel="msgHeight"><title>msgHeight (Attribute)</title>
<indexterm><primary>msgHeight</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>msgHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--msgHeight------------------------------------><

>>--msgHeight = lines----------------------------><

]]>
</programlisting>

<para>
  Reflects the number of lines that the area for the message text will take up. By default, <emphasis
  role="italic">msgHeight</emphasis> is set to 1 and the width of the dialog is calculated by calculating the width of the
  message. The height of 1 line is calculated from the height of the message. This doesn't work well for very long messages.
  The programmer may want set the message area height to 2 or more lines to end up with a more balanced dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the <emphasis role="italic">msgHeight</emphasis> attribute is greater than 1, the width of the dialog is calculated
    using the width of the default message <link linkend="atrMsgHeight">text</link>. The height of 1 line is always
    calculated using some text, the default message, the assigned message, etc.. The height calculation is not effected by
    what the exact text is as long as the text has a few words in it.
  </para>
  <para>
    The height of the static control for the message is <emphasis role="italic">always</emphasis> set to <emphasis
    role="italic">msgHeight</emphasis> times the calculated height of a single line. The static control for the message will
    automatically wrap the text at word breaks. The control also honors new line characters if they are embedded in the text.
  </para>
  <para>
    No attempt is made during the height and width calculations to try and determine if the assigned message text will fit in
    the static control or not if the <emphasis role="italic">msgHeight</emphasis> is set higher than 1. This means the
    programmer can increase the over all height of the dialog by increasing the message height, even if the height does not
    need to be increased to accommodate the message text.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example, the application sometimes adds some extra text to the message. Knowing that the progress dialog will be
    very short and very long without some change, the message height is set to 5 lines to produce a balanced dialog. Note the
    insertion of two new lines in the message text to set off the added text:
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  if self~itemCount > 30000 then do
    extra = .endOfLine~copies(2) || -
            'It is possible that inserting' self~itemCount 'items'   || -
            ' will exhaust your system resources.'

    pbDlg~msgText ||= extra
    pbDlg~msgHeight = 5
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::msgHeight() [attribute]  -->

<section id="atrMsgText" xreflabel="msgText"><title>msgText (Attribute)</title>
<indexterm><primary>msgText</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>msgText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--msgText--------------------------------------><

>>--msgText = text-------------------------------><

]]>
</programlisting>

<para>
  Reflects the text to be displayed in the message area of the progress dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The default value for the message text is <emphasis role="italic">Background processing is taking place.  Please be
    patient.</emphasis> The message text is displayed at the top of the progress dialog. To remove the message entirely, use
    the <xref linkend="atrNoMsg"/> attribute. To control the number of lines used for the message, use the <xref
    linkend="atrMsgHeight"/> attribute.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the default message to one appropriate for the specific application:
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::msgText() [attribute]  -->

<section id="atrNoMsg" xreflabel="noMsg"><title>noMsg (Attribute)</title>
<indexterm><primary>noMsg</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>noMsg</secondary></indexterm>
<programlisting>
<![CDATA[
>>--noMsg----------------------------------------><

>>--noMsg = trueOrFalse--------------------------><

]]>
</programlisting>

<para>
  Reflects whether the progress dialog will contain a message area or not. The default is false, the dialog will contain a
  message area. If the <emphasis role="italic">noMsg</emphasis> attriubte is set to true, the message area is removed from
  the progress dialog, and the <xref linkend="atrMsgText"/> attribute is ignored.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When <emphasis role="italic">noMsg</emphasis> is true, by default, the width of the dialog is calculated using the width
    of the default message text. However, the setting of the <xref linkend="atrAbsoluteWidth"/> attribute can also have an
    effect on the width calculation.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example configures a progress dialog so that it has no status line area and no message text area.
<programlisting>
<![CDATA[

  progressDlg = .ProgressDialog~new
  progressDlg~noMsg = .true
  progressDlg~noStatus = .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::noMsg() [attribute]  -->

<section id="atrNoStatus" xreflabel="noStatus"><title>noStatus (Attribute)</title>
<indexterm><primary>noStatus</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>noStatus</secondary></indexterm>
<programlisting>
<![CDATA[
>>--noStatus-------------------------------------><

>>--noStatus = trueOrFalse-----------------------><

]]>
</programlisting>

<para>
  Reflects whether the progress dialog will have a status line or not. If <emphasis role="italic">noStatus</emphasis> is
  true, no area for the status line is included in the progress dialog. The default is false, the dialog includes a status
  line.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the status line is desired, but the default status text is not appropriate, the <xref linkend="atrInitialStatusText"/>
    attribute can be set to the empty string, or to a string appropriate for the application.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example configures a progress dialog so that it has no message text area and no status line area.
<programlisting>
<![CDATA[

  progressDlg = .ProgressDialog~new
  progressDlg~noStatus = .true
  progressDlg~noMsg = .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::noStatus() [attribute]  -->

<section id="atrRangeMax" xreflabel="rangeMax"><title>rangeMax (Attribute)</title>
<indexterm><primary>rangeMax</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>rangeMax</secondary></indexterm>
<programlisting>
<![CDATA[
>>--rangeMax-------------------------------------><

>>--rangeMax = max-------------------------------><

]]>
</programlisting>

<para>
  Reflects the highest position the progress bar can be moved to.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">rangeMax</emphasis> attribute can also be set using the <emphasis
    role="italic">max</emphasis> argument in the <xref linkend="mthNewClsProgressDialog"/> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::rangeMax() [attribute]  -->

<section id="atrRangeMin" xreflabel="rangeMin"><title>rangeMin (Attribute)</title>
<indexterm><primary>rangeMin</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>rangeMin</secondary></indexterm>
<programlisting>
<![CDATA[
>>--rangeMin-------------------------------------><

>>--rangeMin = min-------------------------------><
]]>
</programlisting>

<para>
  Reflects the lowest position the progress bar can be moved to.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">rangeMin</emphasis> attribute can also be set using the <emphasis
    role="italic">min</emphasis> argument in the <xref linkend="mthNewClsProgressDialog"/> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::rangeMin() [attribute]  -->

<section id="atrWidthClsProgressDialog" xreflabel="width"><title>width (Attribute)</title>
<indexterm><primary>width</primary><secondary>ProgressDialog class</secondary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>width</secondary></indexterm>
<programlisting>
<![CDATA[
>>--width----------------------------------------><

>>--width = dlgUnits-----------------------------><

]]>
</programlisting>

<para>
  Reflects the, possible, width of the progress dialog. The <emphasis role="italic">width</emphasis> attribute is ignored
  unless the <xref linkend="atrAbsoluteWidth"/> attribute is set to true. By default <emphasis
  role="italic">absoluteWidth</emphasis> is false. If <emphasis role="italic">absoluteWidth</emphasis> is true, then the
  width of the progress bar, in dialog units, is set to the value of the <emphasis role="italic">width</emphasis> attribute.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the progress dialog object is instantiated, the <emphasis role="italic">width</emphasis> attribute is set to the
    minimum width the dialog will be set to. This is done simply to ensure the attribute has a numerical value. It is
    expected that the if the application sets the <emphasis role="italic">absoluteWidth</emphasis> attribute to true, the
    application will also set the <emphasis role="italic">width</emphasis> attribute to some specific value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example configures a progress dialog to not have a message or a status line. Rather than allow the progress dialog
    to calculate a width, the application sets the width to a specific value:
<programlisting>
<![CDATA[

  title = 'Acme Widgets - Business Contacts'
  pbDlg = .ProgressDialog~new(title)

  pbDlg~noMsg
  pbDlg~noStatus
  pbDlg~absoluteWidth = .true
  pbDlg~width = 192
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::width() [attribute]  -->

<section id="mthBegin" xreflabel="begin"><title>begin</title>
<indexterm><primary>begin</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>begin</secondary></indexterm>
<programlisting>
<![CDATA[
>>--begin----------------------------------------><
]]>
</programlisting>

<para>
  Begins the execution of the underlying Windows dialog. The <emphasis role="italic">begin</emphasis> method is similar in
  concept to the <xref linkend="mthPopup"/> method of the dialog object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 for some unexpected error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">begin</emphasis> method starts the dialog and returns immediately. If there is some error
    creating the underlying dialog, a message box is put up explaining the problem to the user. This is highly unlikely to
    happen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example configures a progress dialog and then uses the <emphasis role="italic">begin</emphasis> method to start it:
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  a = .Alerter~new
  pbDlg~setInterruptible(a)
  pbDlg~begin
  pbDlg~updateStatus('0 full rows created')

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::begin() -->

<section id="mthCompleteClsProgressDialog" xreflabel="complete"><title>complete</title>
<indexterm><primary>complete</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>complete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--complete-------------------------------------><
]]>
</programlisting>

<para>
  Moves the position of the progress bar to the end of the bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    There is no return from this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is intended to be invoked when the lengthy operation is finished. Moving the position of the progress bar to
    the end gives the user a visual clue that the operation has ended. It is not necessary to use this method to finish the
    dialog, it is a convenience method. The <xref linkend="mthEndNow"/> method actually ends the dialog, and is required to
    end the dialog when it has not been canceled by the user.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example uses the <emphasis role="italic">complete</emphasis> method to move the position of the progress bar to the
    end when it drops out of the processing loop. It then updates the status line and pauses a short time before actually
    ending the dialog. This gives the user a visual clue that the operation completed successfully:
<programlisting>
<![CDATA[

  do i = 1 to rows~items
      ...
  end

  pbDlg~complete
  pbDlg~updateStatus('finished inserting' rows~items 'full rows')
  r = SysSleep(1.5)
  pbDlg~endNow

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::complete() -->

<section id="mthEndNow" xreflabel="endNow"><title>endNow</title>
<indexterm><primary>endNow</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>endNow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--endNow---------------------------------------><
]]>
</programlisting>

<para>
  Ends the execution of the underlying progress dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method does not have any arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the progress bar is cancelable and the user cancels the dialog, that will of course close the dialog. If the dialog
    is not cancelable, then the user can not close the dialog and the programmer must end the dialog using the <emphasis
    role="italic">endNow</emphasis> method. Good practice would probably be to close the dialog for the user when the lengthy
    operation is ended.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example supplies the user with a visual clue that the operation completed successfully when it drops out of the
    processing loop. It then ends the dialog using the <emphasis role="italic">endNow</emphasis> method.
<programlisting>
<![CDATA[

  do i = 1 to rows~items
      ...
  end

  pbDlg~complete
  pbDlg~updateStatus('finished inserting' rows~items 'full rows')
  r = SysSleep(1.5)
  pbDlg~endNow

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::endNow() -->

<section id="mthIncrease" xreflabel="increase"><title>increase</title>
<indexterm><primary>increase</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>increase</secondary></indexterm>
<programlisting>
<![CDATA[
>>--increase(--+--------+--)---------------------><
               +--step--+
]]>
</programlisting>

<para>
  The <emphasis role="italic">increase</emphasis> method moves the position of the progress bar by the value of the <xref
  linkend="atrIncrStep"/> attribute, or by the specified amount if the <emphasis role="italic">step</emphasis> argument is
  specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>step [optional]</term>
    <listitem>
    <para>
      A specific amount to move the progress bar by. If this argument is omitted the value of the <emphasis
      role="italic">incrStep</emphasis> attribute is used.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method does not return a value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">increase</emphasis> method is exactly equivalent to the <xref linkend="mthStepPBC"/> method
    of the <xref linkend="clsProgressBar"/> class.
  </para>
  <para>
    If the progress bar is in marquee mode, or the progress dialog was not instantiated correctly, this method does nothing.
    If the underlying dialog has not been created yet, this method will wait until it has been created.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example immediately invokes the <emphasis role="italic">increase</emphasis> method after it starts the dialog. If
    the underlying Windows dialog has not been fully created, the <emphasis role="italic">increase</emphasis> method will
    wait until it has been created:
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  a = .Alerter~new
  pbDlg~setInterruptible(a)
  pbDlg~begin
  pbDlg~increase

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::increase() -->

<section id="mthSetInterruptible" xreflabel="setInterruptible"><title>setInterruptible</title>
<indexterm><primary>setInterruptible</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>setInterruptible</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setInterruptible(--interruptibleObject--)----><
]]>
</programlisting>

<para>
  Passes an instantiated <xref linkend="clsInterruptible"/> object to the Rexx progress dialog object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>interruptibleObject [required]</term>
    <listitem>
    <para>
      The interruptible object the progress dialog should use.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    An <computeroutput>Interruptible</computeroutput> object provides a generic way for the progress dialog to handle the user
    canceling the dialog. When the <emphasis role="italic">setInterruptible</emphasis> method is invoked, the <xref
    linkend="atrCanCancel"/> attribute is automatically set to true.
  </para>
  <para>
    If the user cancels the dialog, the progress dialog will first invoke the <xref
    linkend="mthInterruptibleClsInterruptible"/> method to determine if the lengthy operation in progress can be interrupted
    at that point. If the return is false, the progress dialog informs the user, through a message dialog, that the operation
    can not be canceled and does not close the dialog. If the return is true, then the progress dialog invokes the <xref
    linkend="mthInterruptClsInterruptible"/> method to notify the <emphasis role="italic">interruptible</emphasis> object
    that the user canceled the operation, and ends the dialog.
  </para>
  <para>
    Using those methods of the <emphasis role="italic">interruptible</emphasis> object, the programmer can manage how and
    when the user can cancel the operation and react correctly to a cancellation.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates an <xref linkend="clsAlerter"/> object, which is a concrete implementation of the
    <computeroutput>Interruptible</computeroutput> class, and passes the object to the progress dialog. This allows the user
    to cancel the dialog. The <computeroutput>Alerter</computeroutput> class provides the <xref linkend="atrIsCanceled"/>
    attribute. By checking the <emphasis role="italic">isCanceled</emphasis> attribute within the processing loop, the
    application can determine if the user has canceled the operation and end the processing loop:
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  a = .Alerter~new
  pbDlg~setInterruptible(a)
  pbDlg~begin

  do i = 1 to count
      -- do stuff

      if /* some condition */ then do
            pbDlg~increase
      end

      if a~isCanceled then do
            pbDlg~updateStatus('canceled after ...' )
            r = SysSleep(1.5)
            pbDlg~endNow
            leave
      end
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::setInterruptible() -->

<section id="mthUpdateStatus" xreflabel="updateStatus"><title>updateStatus</title>
<indexterm><primary>updateStatus</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>updateStatus</secondary></indexterm>
<programlisting>
<![CDATA[
>>--updateStatus(--text--)-----------------------><
]]>
</programlisting>

<para>
  Updates the status line with the supplied text. The status line will always begin with the string: <emphasis
  role="italic">Status: </emphasis> and continue with the supplied text.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text to append after the <emphasis role="italic">status :</emphasis> string.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    There is no return from this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To change the status line text without having the <emphasis role="italic">Status: </emphasis> string prepended use the
    <xref linkend="mthUpdateStatusText"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example creates a progress dialog and enters a processing loop. Every 100 iterations, it updates the status line
    using the <emphasis role="italic">updateStatus</emphasis> method. When i equals 200, the status line will read: <emphasis
    role="italic">Status: 200 records inserted.</emphasis>
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  pbDlg~begin

  do i = 1 to count
      -- do stuff

      if i // 100 = 0 then do
            pbDlg~increase
            pbDlg~updateStatus(i 'records inserted.')
      end
      ...
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::updateStatus() -->

<section id="mthUpdateStatusText" xreflabel="updateStatusText"><title>updateStatusText</title>
<indexterm><primary>updateStatusText</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>updateStatusText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--updateStatusText(--text--)-------------------><
]]>
</programlisting>

<para>
  Updates the status line using the exact text specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text to be displayed on the status line.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    There is no return from this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The similar, <xref linkend="mthUpdateStatus"/> method, always starts the status line with <emphasis
    role="italic">Status: </emphasis>. This is a convenience, sometimes. This method is provided for situations where the
    <emphasis role="italic">Status: </emphasis> prolog is undesired.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example creates a progress dialog and enters a processing loop. Every 100 iterations, it updates the status line
    using the <emphasis role="italic">updateStatusText</emphasis> method. When i equals 200, the status line will read:
    <emphasis role="italic">Have now inserted the contact information for 200 contacts ...</emphasis>
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  pbDlg~begin

  do i = 1 to count
      -- do stuff

      if i // 100 = 0 then do
            pbDlg~increase
            pbDlg~updateStatus('Have now inserted the contact information for' i 'contacts ...')
      end
      ...
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ProgressDialog::updateStatusText() -->

</section> <!-- End ProgressDialog Class -->

<section id="clsAlerter" xreflabel="Alerter"><title>Alerter Class</title>
<indexterm><primary>Alerter class</primary></indexterm>
<indexterm><primary>ProgressDialog class</primary><secondary>Alerter class</secondary></indexterm>
<para>
  The <computeroutput>Alerter</computeroutput> class is a simple implementation of the <xref linkend="clsInterruptible"/>
  interface that can be used with a <xref linkend="clsProgressDialog"/> object to notify the application that the user has
  canceled the progress dialog.
</para>
<para>
  An <computeroutput>Alerter</computeroutput> object is intended to be used when the progress dialog can always be canceled
  by the user, but the application needs to know if and when the user cancels.
</para>

<section id="sctMethodsAlerter"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>Alerter</computeroutput> class:

<table id="tblMethodsAlerter" frame="all"> <title>Alerter Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsAlerter"/> </entry>
<entry>Instantiates a new <computeroutput>Alerter</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrIsCanceled"/></entry>
<entry>Reflects the state of the internal canceled flag.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthInterruptClsAlerter"/> </entry>
<entry>Signals this object that it is being interrupted.</entry>
</row>
<row>
<entry><xref linkend="mthInterruptibleClsAlerter"/></entry>
<entry>Determines if this object is interruptible at this point in time. By definition an <computeroutput>Alerter</computeroutput> object is always interruptible.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsAlerter" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>Alerter class</secondary></indexterm>
<indexterm><primary>Alerter class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new------------------------------------------><
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>Alerter</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a newly instantiated <computeroutput>Alerter</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    An <emphasis role="italic">Alerter</emphasis> object provides a concrete implementation of the two abstract methods of
    the <computeroutput>Interruptible</computeroutput> interface. The object sets the <xref linkend="atrIsCanceled"/>
    attributed to false on instantiation. if the <xref linkend="mthInterruptClsAlerter"/> method is invoked, the attribute is
    set to true. This allows the application to test the value of the <emphasis role="italic">isCanceled</emphasis> attribute
    to determine if the user has canceled the progress dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows an <computeroutput>Alerter</computeroutput> object being used with a progress dialog. Within a
    processing loop, the application periodically checks to see if the user has canceled the operation by checking the
    <emphasis role="italic">isCanceled</emphasis> attribute of the alerter:
<programlisting>
<![CDATA[

  pbDlg = .ProgressDialog~new
  pbDlg~msgText = 'Creating and inserting the contact information. ' || -
                  'This will take some time.'

  a = .Alerter~new
  pbDlg~setInterruptible(a)
  pbDlg~begin

  do i = 1 to count
      -- do stuff

      if /* some condition */ then do
            pbDlg~increase
      end

      if a~isCanceled then do
            pbDlg~updateStatus('canceled after ...' )
            r = SysSleep(1.5)
            pbDlg~endNow
            leave
      end
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Alerter::new() -->

<section id="atrIsCanceled" xreflabel="isCanceled"><title>isCanceled (Attribute)</title>
<indexterm><primary>isCanceled</primary></indexterm>
<indexterm><primary>Alerter class</primary><secondary>isCanceled</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isCanceled-----------------------------------><
]]>
</programlisting>

<para>
  Reflects the state of the internal canceled flag. The flag is false if the <xref linkend="mthInterruptClsAlerter"/> method
  of this object has not been invoked and true if it has been invoked.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">isCanceled</emphasis> attribute is a <emphasis role="italic">get</emphasis> only attribute. The
    programmer can not set the value of this attribute. It is set internally by the object and can not be changed.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Alerter::isCanceled() [attribute]  -->

<section id="mthInterruptClsAlerter" xreflabel="interrupt"><title>interrupt</title>
<indexterm><primary>interrupt</primary><secondary>Alerter class</secondary></indexterm>
<indexterm><primary>Alerter class</primary><secondary>interrupt</secondary></indexterm>
<programlisting>
<![CDATA[
>>--interrupt------------------------------------><
]]>
</programlisting>

<para>
  Signals this object that it is being interrupted.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method does not return any value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">alerter</emphasis> object provides a concrete implmentation of the <xref
    linkend="clsInterruptible"/> interface that can be used as the arguemnt to the <xref linkend="mthSetInterruptible"/>
    method of the <xref linkend="clsProgressDialog"/>. It is intended to be used when the progress dialog can always be
    canceled and provides a notification to the application if the progress dialog is canceled.
  </para>
  <para>
    When the <emphasis role="italic">interrupt</emphasis> method is invoked, the <xref linkend="atrIsCanceled"/> attribute is
    set to true. When used with the progress dialog object, the progress dialog invokes this method if the user cancels the
    dialog. This allows the programmer to determine if the user has canceled the dialog by checking the <emphasis
    role="italic">isCanceled</emphasis> attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Alerter::interrupt() -->

<section id="mthInterruptibleClsAlerter" xreflabel="interruptible"><title>interruptible</title>
<indexterm><primary>interruptible</primary><secondary>Alerter class</secondary></indexterm>
<indexterm><primary>Alerter class</primary><secondary>interruptible</secondary></indexterm>
<programlisting>
<![CDATA[
>>--interruptible--------------------------------><
]]>
</programlisting>

<para>
  Determines if this object is interruptible at this point in time. By definition an <computeroutput>Alerter</computeroutput>
  object is always interruptible.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns true.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">alerter</emphasis> object provides a concrete implmentation of the <xref
    linkend="clsInterruptible"/> interface that can be used as the arguemnt to the <xref linkend="mthSetInterruptible"/>
    method of the <xref linkend="clsProgressDialog"/>. It is intended to be used when the progress dialog can always be
    canceled and provides a notification to the application if the progress dialog is canceled. When used with the progress
    dialog object, the progress dialog invokes this method if the user cancels, to determine if it is okay to cancel, to
    close, the dialog. This method always returns true for that invocation.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Alerter::interruptible() -->

</section> <!-- End Alerter Class -->

<section id="clsInterruptible" xreflabel="Interruptible"><title>Interruptible Mixin Class</title>
<indexterm><primary>Interruptible class</primary></indexterm>
<para>
  The <computeroutput>Interruptible</computeroutput> class defines an interface for an object that can be <emphasis
  role="italic">interrupted</emphasis>, but possibly only interrupted at certain times. It does this by defining two abstract
  methods. Users of the <computeroutput>Interruptible</computeroutput> class are expected to inherit this mixin class and
  provide concrete implementations of both abstract methods.
</para>
<para>
  The <computeroutput>Interruptible</computeroutput> class is a helper class for the <xref linkend="clsProgressDialog"/>
  class. Only <emphasis role="italic">interruptible</emphasis> objects can be used as an argument for the <xref
  linkend="mthSetInterruptible"/> method. The progress dialog will invoke both methods of the
  <computeroutput>Interruptible</computeroutput> object, so concrete implementations for both methods must be provided to
  prevent syntax conditions from being raised.
</para>

<section id="sctMethodsInterruptible"><title>Method Table</title>
<para>
  The following table lists the abstract instance methods of the <computeroutput>Interruptible</computeroutput> mixin class:

<table id="tblMethodsInterruptible" frame="all"> <title>Interruptible Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthInterruptClsInterruptible"/> </entry>
<entry>Signals this object that it is being interrupted.</entry>
</row>
<row>
<entry><xref linkend="mthInterruptibleClsInterruptible"/></entry>
<entry>Determines if this object is interruptible at this point in time.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthInterruptClsInterruptible" xreflabel="interrupt"><title>interrupt (abstract)</title>
<indexterm><primary>interrupt</primary><secondary>Interruptible class</secondary></indexterm>
<indexterm><primary>Interruptible class</primary><secondary>interrupt</secondary></indexterm>
<programlisting>
<![CDATA[
>>--interrupt------------------------------------><
]]>
</programlisting>

<para>
  Signals this object that it is being interrupted.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method does not return any value
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The contract for this abstract method is that it will not receive any arguments and will not return any value.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Interruptible::interrupt() -->

<section id="mthInterruptibleClsInterruptible" xreflabel="interruptible"><title>interruptible (abstract)</title>
<indexterm><primary>interruptible</primary><secondary>Interruptible class</secondary></indexterm>
<indexterm><primary>Interruptible class</primary><secondary>interruptible</secondary></indexterm>
<programlisting>
<![CDATA[
>>--interruptible--------------------------------><
]]>
</programlisting>

<para>
  Determines if this object is interruptible at this point in time.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if this object can be interrupted now. Returns false if this object should not be interrupted now, but can
    possibly be interrupted at a later time.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The contract for this abstract method is that it will not be passed any arguments and will always return either true or
    false.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Interruptible::interruptible() -->

</section> <!-- End Interruptible Class -->

</section> <!-- End Progress Dialog section -->


<section id="clsSingleSelection" xreflabel="SingleSelection"><title>SingleSelection Class</title>
<indexterm><primary>SingleSelection</primary><secondary>standard dialog</secondary></indexterm>
<indexterm><primary>standard dialogs</primary><secondary>SingleSelection</secondary></indexterm>
<para>
  The <computeroutput>SingleSelection</computeroutput> class presents a dialog that has a group of <link
  linkend="clsRadioButton">radio</link> buttons. The user can select only one item of the group, or cancel the dialog. The
  programmer can specify how many radio buttons are in the group, if they should be placed in one, or several, columns. The
  ooDialog framework internally handles all the layout of the controls of the dialog. This makes the dialog class very easy
  to use.
</para>
<para>
  The basic steps to user the <computeroutput>SingleSelection</computeroutput> are to instantiate the dialog using the
  <emphasis role="italic">new</emphasis> method, run the dialog using the <emphasis role="italic">execute</emphasis> method,
  and do something with the user's response which is returned from the <emphasis role="italic">execute</emphasis> method.
</para>

<section id="mthNewClsSingleSelection" xreflabel="new"><title>new</title>
<indexterm><primary>new</primary><secondary>SingleSelection class</secondary></indexterm>
<indexterm><primary>SingleSelection class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>-new(--msg--,--title--,--labels.--,--+----------+--+-----------+--+-------+--)--><
                                       +-,-preSel-+  +-,-rbWidth-+  +-,-max-+
]]>
</programlisting>
<para>
  Instantiates a new <computeroutput>SingleSelection</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>msg [required]</term>
    <listitem>
    <para>
      A text string that is displayed above the radio button group. Typically, the text would be used to give the user the
      purpose of the radio buttons.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>title [required]</term>
    <listitem>
    <para>
      A title, the caption bar text, for the dialog
    </para>
    </listitem></varlistentry>
    <varlistentry><term>labels. [required]</term>
    <listitem>
    <para>
      A stem with whole number numeric indexes, one through the number of radio buttons desired. The value for each index is
      the label for the corresponding radio button. For instance <computeroutput>labels.2</computeroutput> would be set to
      the label for the second radio button.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>preSel  [optional]</term>
    <listitem>
    <para>
       This argument can be used to preselect, (check,) one radio button. A value of 1 checks the first radio button, a
       value of 2 checks the second, and so on. If this argument is omitted, the first radio button is checked.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>rbWidth [optiona]</term>
    <listitem>
    <para>
      Specifies the width, in dialog units, of the radio button controls. If omitted, the width is calculated so that the
      longest label will not be clipped. If used, all radio buttons are set to this width without regard as to whether the
      label will be clipped or not.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>max [optional]</term>
    <listitem>
    <para>
      The maximum number of radio buttons in one column. If there are more radio buttons than <emphasis
      role="italic">max</emphasis>, that is, if the <emphasis role="italic">labels.</emphasis> argument has more indexes
      than the value of <emphasis role="italic">max</emphasis>, the radio buttons are positioned in columns. Each column will
      have <emphasis role="italic">max</emphasis> radio buttons and ther will be as many columns as needed to display all the
      radio buttons.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example instantiates and executes a dialog that contains a two-column radio button group. The fifth radio
    button (the button with the label May) is preselected.

<programlisting>
<![CDATA[
mon.1 = "January" ; mon.2 = "February" ; mon.3 = "March"
mon.4 = "April"   ; mon.5 = "May"      ; mon.6 = "June"
mon.7 = "July"    ; mon.8 = "August"   ; mon.9 = "September"
mon.10= "October" ; mon.11= "November" ; mon.12= "December"

dlg = .SingleSelection~new("Please select a month:", ,
                           "Single Selection", mon., 5, , 6)
s = dlg~execute
say  "You Selected the month:" mon.s
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthExecuteClsSingleSelection" xreflabel="execute"><title>execute</title>
<indexterm><primary>execute</primary><secondary>SingleSelection class</secondary></indexterm>
<indexterm><primary>SingleSelection class</primary><secondary>execute</secondary></indexterm>
<programlisting>
<![CDATA[
>>--execute--------------------------------------><
]]>
</programlisting>

<para>
  Executes the dialog and returns the user's selection or the empty string if the user cancels the dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    If the user cancels the dialog, the empty string is returned. If the user closes the dialog with <emphasis
    role="italic">Ok</emphasis> the return is the number of the selected radio button. 1 for the first radio button, 2 for
    the second radio button, 8 for the eighth radion button, etc., etc..
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the <emphasis role="italic">execute</emphasis> method is invoked, the ooDialog framework, internally, does a number
    of calculations to determine the optimal size of the dialog controls and dialog. The framework then positions all the
    dialog controls such that none of the radio button labels, message, and title of the dialog are clipped.
  </para>
  <para>
    The one exception to this is if the programmer specifies the width of the radio button controls using the optional
    <emphasis role="italic">rbWidth</emphasis> argument in the <xref linkend="mthNewClsSingleSelection"/> method. In that
    case the width of the radio buttons is always set to what the programmer has specified. It is possible that the radio
    buttons will be clipped, but that is now the responsibility of the programmer.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a single selection dialog
<programlisting>
<![CDATA[

rex.1 = "Regina" ; rex.2 = "ooRexx" ; rex.3 = "Reginald" ; rex.4 = "Personal Rexx"

d = .SingleSelection~new("Pick your favorite Rexx", "Rexx is King", rex., 2, , 2)
index = d~execute

if index == "" then say "You failed to pick a Rexx interpreter."
else say "The Rexx you picked:" rex.index

::requires 'ooDialog.cls'

/* Output will most likely be:

The Rexx you picked: ooRexx

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SingleSelection::execute() -->

</section>

<section id="clsTimedMessage" xreflabel="TimedMessage"><title>TimedMessage Class</title>
<indexterm><primary>TimedMessage</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>TimedMessage</secondary></indexterm>
<para>The TimeMessage class shows a message window for
a defined duration. </para>
<para>The methods listed below are defined by this class.</para>

<section id="initTimedMessage" xreflabel="init"><title>init</title>
<indexterm><primary>init</primary>
<secondary>TimedMessage class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTimedMessage~init(--msg-,-title-,-sleeping--+--------------+-+-----+--)----><
                                                +-,-earlyReply-+ +-,-p-+

]]>
</programlisting>

<para>The init method prepares the dialog. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A string that is displayed inside the window as a message. The length
of the message determines the horizontal size of all standard dialogs.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A string that is displayed as the window title in the title bar of the
dialog
</para></listitem></varlistentry>
<varlistentry><term>sleeping</term>
<listitem><para>A number that determines how long (in milliseconds) the window
is shown. If this number is 0 or greater, the message window is shown for that
time and automatically dismisses itself.  The programmer need take no further
action.
</para>
<para>If the number is less than 0 then the message window is shown
indefinitely.  The <computeroutput>execute</computeroutput> method returns
immediately.  In this case, the programmer needs to dismiss the window manually.
This is done by invoking the <computeroutput>ok</computeroutput> method. See
<emphasis role="bold">Example 2</emphasis> below.
</para></listitem></varlistentry>
<varlistentry><term>earlyReply</term>
<listitem><para>The optional early reply argument defaults to false.  If used
and if true, the <computeroutput>execute</computeroutput> method of the dialog
returns immediately.  This allows the code at the point where <computeroutput>
execute</computeroutput> was invoked to continue.  The message windows continues
to display for its specified duration and then dismisses itself automatically.
</para></listitem></varlistentry>
<varlistentry><term>p [optional]</term>
<listitem>
<para>
  A <xref linkend="clsPoint"/> object that specifies the position, in pixels, for the position of the timed
  message dialog on the screen. By default the dialog is centered in the screen. If <emphasis role="italic">p</emphasis>
  is used, the point specifies the position of the upper left corner of the dialog.
</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry id="example1TimedMessage"><term><emphasis role="bold">Example
  1:</emphasis></term>
<listitem><para>The following example shows a window with the title of <emphasis
role="italic">Infomation</emphasis> for a duration of 3 seconds:
<programlisting>
<![CDATA[
dlg = .TimedMessage~New("Application will be started, please wait", -
                        "Information", 3000)
dlg~execute
drop dlg
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry id="example2TimedMessage"><term><emphasis role="bold">Example
2:</emphasis></term>
<listitem><para>The following example shows an introductory window that displays
while an application is doing its time consuming start up routine.  Since this
start up process can vary in time depending on the individual system, the window
is set to display indefinitely.  When the start up process is finished, the
programmer dismisses the window and destroys the dialog manually.
<programlisting>
<![CDATA[
dlg = .TimedMessage~New("The WidgetCreator Application - loading ...", -
                        "The Widget Factory", -1)
dlg~execute
ret = doStartup()
dlg~ok
drop dlg
if ret <> 0 then do
  ...
end
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry id="example3TimedMessage"><term><emphasis role="bold">Example
3:</emphasis></term>
<listitem><para>The following example is a variation on <emphasis role="bold">
Example 2</emphasis>.  In this case the Widget Factory executives decided that
they want their WidgeCreator splash screen to always display for 2 seconds to
the customer and then close.  The early reply argument is used so that the start
up routine executes immediately.  After 2 seconds the splash screen dismisses
and the dialog is destroyed automatically.
</para>
<note><title>Note</title><para>It is not necessary to explicitly drop the dlg
variable.  That is shown in the other examples to emphasize the point that the
dialog has been destroyed.</para></note>
<programlisting> <![CDATA[
dlg = .TimedMessage~New("The WidgetCreator Application - loading ...", -
                        "The Widget Factory", 2000)
dlg~execute
if doStartup() <> 0 then do
  ...
end
]]>
</programlisting></listitem></varlistentry>
</variablelist>
</section>

<section id="defDlgTimedMessage"><title>defineDialog</title>
<indexterm><primary>Define</primary>
<secondary>TimedMessage</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTimedMessage~DefineDialog----------------------------------><

]]>
</programlisting>

<para>The defineDialog method is called by the create method of the parent
class, PlainUserDialog, which in turn is called at the very beginning of
Execute. You do not have to call it. However, you may want to over-ride it in
your subclass to add more dialog controls to the window.  If you over-ride it,
you have to forward the message to the parent class by using the keyword super.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example shows how to subclass the TimedMessage
class and how to add a background bitmap to the dialog window:
<programlisting>
<![CDATA[
::class MyTimedMessage subclass TimedMessage inherit DialogExtensions

::method defineDialog
   self~backgroundBitmap("mybackg.bmp", "USEPAL")
   self~DefineDialog:super()
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="h002097"><title>execute</title>
<indexterm><primary>execute</primary>
<secondary>TimedMessage class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTimedMessage~Execute---------------------------------------><
]]>
</programlisting>

<para>
  The execute method creates and shows the message window. If the specified <link linkend="initTimedMessage">duration</link>
  is not negative, this method destroys the dialog automatically when the duration is up. If the duration is less than 0,
  then the programmer must destroy the dialog manually by invoking the <computeroutput>ok</computeroutput> method.  See this
  <link linkend="example2TimedMessage">example</link> for a code snippet showing the procedure.
</para>
</section>

</section>

</section>


<section id="sctPublicRoutines"><title>Public Routines</title>
<indexterm><primary>ooDialog public routines</primary></indexterm>
<para>
  The routines listed in this section can be used in any Rexx program.  They are designed to be even easier to use than
  the standard dialogs. Simply add a requires directive for the <computeroutput>ooDialog.cls</computeroutput> file in
  a Rexx program to use any of these routines.
<programlisting>
<![CDATA[
::requires ooDialog.cls
]]>
</programlisting>
</para>

<section id="rtnAskDialog" xreflabel="AskDialog"><title>AskDialog Routine</title>
<indexterm><primary>AskDialog</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>AskDialog</secondary></indexterm>
<para>Pops up a message box containing the specified text, a Yes button, and
a No Button.</para>
<programlisting>
<![CDATA[
>>-AskDialog(--question--+-------------------+--)-------------><
                         +--, defaultbutton--+

]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>question</term>
<listitem><para>Text to be displayed in the message box.
</para></listitem></varlistentry>
<varlistentry><term>defaultbutton</term>
<listitem><para>Specifies which button, the Yes or the No button, has the
default focus when the message box pops up. This argument can be Yes or No and
is optional. If the argument is omitted, the Yes button will be given the focus.
Only the first letter of the option is needed and case is not significant.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>Return Values:</term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The No button has been selected.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The Yes button has been selected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnCheckList" xreflabel="CheckList"><title>CheckList Routine</title>
<indexterm><primary>CheckList</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>CheckList</secondary></indexterm>
<para>A shortcut function to invoke the <xref linkend="clsCheckList"/>
dialog: </para>

<programlisting>
<![CDATA[
>>--CheckList(--message--,--title--,--labels--,-+-----------+---->
                                                +-,--checks-+

>---+------------------------+--)-------------------------------><
    +-,--+-----+--+--------+-+
         +-len-+  +-,--max-+


]]>
</programlisting>

<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem>
<para>
  The arguments are similar to what is described in the <xref linkend="initCheckList"/>) method of the
  <computeroutput>CheckList</computeroutput> class. However, instead of stems, arrays are passed into and returned from the
  function.
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the check box group.
It could be used, for example, to give the user a hint as to what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string for the dialog's title
</para></listitem></varlistentry>
<varlistentry><term>labels</term>
<listitem><para>An array containing the labels, in order, for each of the check
boxes.  The dialog will contain a check box for each label.
</para></listitem></varlistentry>
<varlistentry><term>checks</term>
<listitem><para>This argument is an array that allows you to pre-check any of
the check boxes. For each index in this array whose item is <computeroutput>
.true</computeroutput>, (or 1,) the check box at the corresponding index in the
<computeroutput>labels</computeroutput> array will be checked.  For any index
that is not <computeroutput>.true </computeroutput>, the corresponding check box
will not be checked.  This means that the programmer only needs to put a
<computeroutput>.true</computeroutput> at the indexes where he wants the check
boxes checked.  All the other indexes can be left empty.
</para></listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>Determines the length (in dialog units) of the check boxes and
labels. If omitted, the size is calculated to fit the largest label.
</para></listitem></varlistentry>
<varlistentry><term>max</term>
<listitem><para>The maximum number of check boxes in one column. If there are
more check boxes than max, that is, if labels has more items than the value of
max, the check boxes will be put into columns.  Each column will contain no more
than the number of check boxes specified by max.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>If the user cancels the dialog, then <computeroutput>.nil
</computeroutput> is returned.  If the user clicks the okay button, then an
array is returned.  The array will be the same size as the input
<computeroutput>labels</computeroutput> array.  Each index of the returned array
will contain <computeroutput>.true</computeroutput> if the corresponding check
box was checked by the user or will contain <computeroutput>.false
</computeroutput> if the check box was not checked.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example</emphasis></term>
<listitem><para>The following example show how to use the
<computeroutput>CheckList</computeroutput> public routine:

<programlisting>
<![CDATA[

  weekdays = .array~of("Monday","Tuesday","Wednesday","Thursday", -
                       "Friday","Saturday","Sunday")

  -- Monday and Tuesday will be checked, all the rest will not be checked.
  checks = .array~of(.true, .true, .false)
  checks[5] = 0
  checks[7] = 'a'

  -- The labels will be 60 dialog units wide and there will be at most 4 check
  -- boxes in a column.  (Only 7 check boxes, so 2 columns, the first with 4
  -- check boxes, the second with 3.)

  days = CheckList("Check the days", "Working Days", weekdays, checks, 60, 4)

  if days <> .Nil then do i = 1 to days~items
    if days[i] then say "Working day =" weekdays[i]
  end

::requires "ooDialog.cls"

]]>
</programlisting>

</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnErrorDialog" xreflabel="ErrorDialog"><title>ErrorDialog Routine</title>
<indexterm><primary>ErrorDialog</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>ErrorDialog</secondary></indexterm>
<para>Pops up a message box containing the specified text, an OK button, and
an error symbol.</para>
<programlisting>
<![CDATA[
>>-ErrorDialog(--error_text--)--------------------------------><
]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Argument:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>error_text</term>
<listitem><para>Text to be displayed in the message box.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnFileNameDialog" xreflabel="FileNameDialog"><title>FileNameDialog Routine</title>
<indexterm><primary>FilenameDialog</primary></indexterm>
<indexterm><primary>public routines</primary><secondary>FileNameDialog</secondary></indexterm>
<programlisting>
<![CDATA[
>>-FileNameDialog(-+-----+-+----------+-+-------+-+--------+-+---------+-->
                   +-sel-+ +-,-parent-+ +-,-msk-+ +-,-type-+ +-,-title-+

>-----------------+----------+-+---------+-+-----------+--)---------------><
                  +-,-defExt-+ +-,-multi-+ +-,-sepChar-+


]]>
</programlisting>

<para>
  Causes a file selection dialog box to appear. File selection dialogs are used to allow the user to pick a file or set
  of files to open, or to pick a file to save to.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>sel [optional]</term>
    <listitem>
    <para>
      This argument can be used to pre-select a file and / or have the open or save dialog start in a specified
     directory.
    </para>
    <para>
      This argument initializes the open or save dialog by selecting the specified file and placing its name in the
      <emphasis role="italic">File</emphasis> edit control of the dialog. In addition this argument can also be used to
      specify the initial directory (folder) the dialog opens in.
    </para>
    <para>
      When this argument contains no path information, then the <emphasis role="italic">File</emphasis> name edit
      control will contain the argument and the initial directory is determined by the operating system.  Which
      directory the operating system picks varies slightly between versions of Windows. But, in general, it will be a
      directory previously used in one of the Windows common dialogs, or a directory in the users My Documents folder.
    </para>
    <para>
      If the argument contains file name and path information, the initial directory will be determined by the path
      information and the <emphasis role="italic">File</emphasis> name edit control will contain the file information.
      When the argument contains only path information and no file name information, i.e. the
      argument ends with a backslash <emphasis role="italic">\</emphasis>, then the initial directory will be that
      path and the <emphasis role="italic">File</emphasis> name edit control will be left blank.
    </para>
    <para>
      In cases where the argument contains incorrect path information, the initial directory is determined as if no path
      information had been supplied and the entire value of the argument is placed in the File name field.
    </para>
    <para>
      <emphasis role="bold">Note</emphasis> that Windows treats normal wild card characters as valid for file names.
      Therefore, values such as <emphasis role="italic">C:\*.*</emphasis> or <emphasis
      role="italic">C:\Windows\*.exe</emphasis> are acceptable for this argument.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>parent [optional]</term>
    <listitem>
    <para>
      The window <xref linkend="defHandle"/> of a parent window for the open or save file dialog. Normally
      the programmer would use the handle of a dialog in her program. The operating system disables the parent window
      until the user closes the open or save dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>msk [optional]</term>
    <listitem>
    <para>
      This argument consists of pairs of filter strings where each of the filter strings is separated with a
      <computeroutput>'0'x</computeroutput> character and the pairs of strings within a filter are also separated with a
      <computeroutput>'0'x</computeroutput> character. The first string in each pair describes the filter and the
      second string in the pair is a list of file patterns to use for the filter. For instance, if the file pattern
      filter is <computeroutput>*.txt</computeroutput> then only files with the extension of
      <computeroutput>.txt</computeroutput> are displayed in the dialog. The file pattern can consist of any valid file
      name characters and and the asterisk (*) wildcard character. But the pattern can not contain any space characters.
    </para>
    <para>
      An example of how to construct this string is as follows:

<programlisting>
<![CDATA[

  delimiter = '0'x

  pair1 = "DLL Files (*.dll)"delimiter"*.dll"delimiter
  pair2 = "Class Files (*.cls)"delimiter"*.cls"delimiter

  filter = pair1 || pair2

]]>
</programlisting>
      To specify multiple file extension patterns for a single display string, use a semicolon to separate the patterns,
      for example:

<programlisting>
<![CDATA[

  delimiter = '0'x

  pair1 = "Text Files (*.txt)"delimiter"*.txt;*.bak;*.doc"delimiter
  pair2 = "Class Files (*.cls)"delimiter"*.cls"delimiter

  filter = pair1 || pair2

]]>
</programlisting>

    </para>
    <para>
      The operating system does not change the order of the filters. In the open or save dialog the filters are
      displayed in the File Types combo box in the order specified in the <emphasis role="italic">mask</emphasis>
      argument.
    </para>
    <para>
      To have the dialog box not display any filters, use the empty string for this argument. The default filter string
      when this argument is omitted is:

<programlisting>
<![CDATA[

  delimiter = '0'x

  "Text Files (*.txt)"delimiter"*.txt"delimiter"All Files (*.*)"delimiter"*.*"delimiter

]]>
</programlisting>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>type [optional]</term>
    <listitem>
    <para>
      A keyword specifying if the <emphasis role="italic">File Open</emphasis> or <emphasis role="italic">File
      Save</emphasis> dialog is displayed. By default the <emphasis role="italic">File Open</emphasis> is used. The
      keyword can be <emphasis role="italic">LOAD</emphasis> for the file open dialog or <emphasis
      role="italic">SAVE</emphasis> for the file save dialog. Only the first letter of the argument is needed and case
      is not significant.
    </para>
    <para>
      If the <emphasis role="italic">File Save</emphasis> dialog is not explicitly requested, the <emphasis role="italic">File Open</emphasis>
      dialog is always presented.  For historic reasons this argument can also be <computeroutput>1</computeroutput> for
      the <emphasis role="italic">File Open</emphasis> dialog or <computeroutput>0</computeroutput> for the
      <computeroutput>File Save</computeroutput> dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>title [optional]</term>
    <listitem>
    <para>
      The window title for the save or open file dialog. The default is <emphasis role="italic">Open a File</emphasis>
      or <emphasis role="italic">Save File As</emphasis>, depending on what is specified for the <emphasis
      role="italic">type</emphasis> argument.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>defExt [optional]</term>
    <listitem>
    <para>
      The default file extension. The <emphasis role="italic">File Open</emphasis> or <emphasis role="italic">File
      Save</emphasis> dialog append this extension if the user does not type an extension.  Although this extension can
      be any length, the operating system only uses the first 3 characters. The string must not include the <emphasis
      role="italic">.</emphasis> character.
    </para>
    <para>
      If this argument is omitted, <emphasis role="italic">txt</emphasis> is used. To prevent the operating system from
      appending an extension, the programmer should use the empty string for this argument.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>multi [optional]</term>
    <listitem>
    <para>
      Specifies if the <emphasis role="italic">File Open</emphasis> dialog allows selection of multiple files. Normally,
      the open dialog allows the user to select one file only.  This can be changed by specifying the keyword <emphasis
      role="italic">MULTI</emphasis> for this option. Only the first letter is needed and case is not significant.
    </para>
    <para>
      This option is ignored for <emphasis role="italic">File Save</emphasis> dialogs. If the multiple file selection is
      enabled and the user selects multiple files, the returned result is then: <computeroutput>path file1 file2 file3
      ...</computeroutput>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>sepChar [optional]</term>
    <listitem>
    <para>
      Specifies the separation character for the returned path and file names. This is needed for file names with blank
      characters. If this argument is omitted, the separation character is a blank. If the argument is specified, the
      returned path and file name string uses this separation character. For example, if you specify <emphasis
      role="italic">#</emphasis>  as the separation character, the return string might look as follows:

<programlisting>
<![CDATA[
C:\WINNT#file with blank.ext#fileWithNoBlank.TXT
]]>
</programlisting>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the selected file name or 0 if the user cancels the dialog. Open file dialogs with multiple selection return
    <computeroutput>path file1 file2 file3 ...</computeroutput> when the user selects multiple files.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the user changes directory with the <emphasis role="italic">File Open</emphasis> or <computeroutput>File
    Save</computeroutput> dialog, then the current directory of the Rexx program will be changed.  This is the behavior
    of the underlying Windows dialog, which is designed to work that way.  The ooDialog programmer should be aware of
    this behavior and insert code to change the directory back if that is needed. For example:

<programlisting>
<![CDATA[
curdir = directory()
file = FileNameDialog("*.pdf", , "Adobe PDF Files"'0'x"*.pdf"'0'x)
call directory curdir
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="rtnInfoDialog" xreflabel="InfoDialog"><title>InfoDialog Routine</title>
<indexterm><primary>InfoDialog</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>InfoDialog</secondary></indexterm>
<para>Pops up a message box containing the specified text and an OK button.</para>
<programlisting>
<![CDATA[
>>-InfoDialog(--info_text--)----------------------------------><


]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Argument:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>info_text</term>
<listitem><para>Text to be displayed in the message box.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnInputBox" xreflabel="InputBox"><title>InputBox Routine</title>
<indexterm><primary>InputBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>InputBox</secondary></indexterm>
<para>
  A shortcut function to invoke an <xref linkend="clsInputBox"/> dialog as a function:
</para>
<programlisting>
<![CDATA[
say "Your name:" InputBox("Please enter your name","Personal Data")
]]>
</programlisting>
<para>
  The parameters are described in the <xref linkend="initInputBox"/> method of the<computeroutput>InputBox</computeroutput>
  class.
</para>
</section>

<section id="rtnIntegerBox" xreflabel="IntegerBox"><title>IntegerBox Routine</title>
<indexterm><primary>IntegerBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>IntegerBox</secondary></indexterm>
<para>A shortcut to invoke an <xref linkend="clsIntegerBox"/>
dialog as a function:
</para>
<programlisting>
<![CDATA[
say "Your age:" IntegerBox("Please enter your age","Personal Data")
]]>
</programlisting>
<para>
  The parameters are described in the <xref linkend="initInputBox"/> method of the <computeroutput>InputBox</computeroutput>
  class.
</para>
</section>

<section id="rtnListChoice" xreflabel="ListChoice"><title>ListChoice Routine</title>
<indexterm><primary>ListChoice</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>ListChoice</secondary></indexterm>
<para>The ListChoice function provides a shortcut to invoke a
 <xref linkend="clsListChoice"/> dialog:
</para>
<programlisting>
<![CDATA[
day = ListChoice("Select a day","My favorite day", ,
                 .array~of("Monday","Tuesday","Wednesday","Thursday", ,
                          "Friday","Saturday","Sunday") , , ,"Thursday")
say "Your favorite day is" day
]]>
</programlisting>
<para>
  The parameters are described in the <xref linkend="initListChoice"/> method of the
  <computeroutput>ListChoice</computeroutput> class. However, instead of an input stem an array is passed into the function.
</para>
<para>If the user cancels the dialog <computeroutput>.nil</computeroutput> is
returned rather than the empty string.
</para>
</section>

<section id="rtnMessageDialog" xreflabel="MessageDialog"><title>MessageDialog Routine</title>
<indexterm><primary>MessageDialog</primary></indexterm>
<indexterm><primary>public routines</primary><secondary>MessageDialog</secondary></indexterm>
<programlisting>
<![CDATA[
>>--MessageDialog(--msg-+--------+-+-------+-+------+-+--------+-+--------+-)---><
                        +-,-hwnd-+ +-,-cap-+ +-,-pb-+ +-,-icon-+ +-,-misc-+
]]>
</programlisting>

<para>
  Displays a message box on the screen with the options specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>msg [required]</term>
      <listitem>
      <para>
        The message text to be displayed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>hwnd [optional]</term>
      <listitem>
      <para>
        The window <xref linkend="defHandle"/> of the owner window for the message box. The owner window is
        disabled until the user closes the message box. If this argument is omitted, the ooDialog framework will use the
        last created, topmost, dialog as the owner window. To explicitly choose that there should be no owner window,
        specify <computeroutput>0</computeroutput> for this argument.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>cap [optional]</term>
      <listitem>
      <para>
        The caption, or title, of the message box. The default title when omitted is: <emphasis role="italic">ooDialog
        Application Message</emphasis>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>pb [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">pb</emphasis> argument specifies which push buttons the message box will have. The
        default if this argument is omitted is a single Ok button. Otherwise, use exactly one of the following keywords,
        case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>ABORTRETRYIGNORE </member>
          <member>CANCELTRYCONTINUE</member>
          <member>OK               </member>
          <member>OKCANCEL         </member>
          <member>RETRYCANCEL      </member>
          <member>YESNO            </member>
          <member>YESNOCANCEL      </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>ABORTRETRYIGNORE</term>
          <listitem>
          <para>
            The message box wil have three push buttons: <emphasis role="bold">Abort</emphasis>, <emphasis
            role="bold">Retry</emphasis>, and <emphasis role="bold">Ignore</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CANCELTRYCONTINUE</term>
          <listitem>
          <para>
            The message box wil have three push buttons: <emphasis role="bold">Cancel</emphasis>, <emphasis
            role="bold">Try Again</emphasis>, and <emphasis role="bold">Continue</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>OK</term>
          <listitem>
          <para>
            The message box wil have one push button: <emphasis role="bold">Ok</emphasis>. This is the default if the
            argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>OKCANCEL</term>
          <listitem>
          <para>
            The message box wil have two push buttons: <emphasis role="bold">Ok</emphasis> and <emphasis
            role="bold">Cancel</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RETRYCANCEL</term>
          <listitem>
          <para>
            The message box wil have two push buttons: <emphasis role="bold">Retry</emphasis> and <emphasis
            role="bold">Cancel</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>YESNO</term>
          <listitem>
          <para>
            The message box wil have two push buttons: <emphasis role="bold">Yes</emphasis> and <emphasis
            role="bold">No</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>YESNOCANCEL</term>
          <listitem>
          <para>
            The message box wil have three push buttons: <emphasis role="bold">Yes</emphasis>, <emphasis
            role="bold">No</emphasis>, and <emphasis role="bold">Cancel</emphasis>.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>icon [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">icon</emphasis> argument specifies the icon placed in the message box. If this
        argument is omitted then the message box will not display an icon. Note that several keywords may specify the
        same icon. To have an icon appear in the message box, use exactly one of the following keywords, case is not
        significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>EXCLAMATION</member>
          <member>WARNING    </member>
          <member>INFORMATION</member>
          <member>ASTERISK   </member>
          <member>QUESTION   </member>
          <member>STOP       </member>
          <member>ERROR      </member>
          <member>HAND       </member>
          <member>QUERY      </member>
          <member>NONE       </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>EXCLAMATION</term>
          <listitem>
          <para>
            The message box will have an exclamation-point icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>WARNING</term>
          <listitem>
          <para>
            The message box will have an exclamation-point icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>INFORMATION</term>
          <listitem>
          <para>
            The message box will have an icon consisting of a lowercase letter i in a circle.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ASTERISK</term>
          <listitem>
          <para>
            The message box will have an icon consisting of a lowercase letter i in a circle.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>QUESTION</term>
          <listitem>
          <para>
            The message box will have a question-mark icon. Microsoft recommends that this icon not be used any more for
            a number of reasons. If you want your Rexx programs to have the same look and feel of other Windows
            programs, then you should not use the question-mark icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>STOP</term>
          <listitem>
          <para>
            The message box will have a stop-sign icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ERROR</term>
          <listitem>
          <para>
            The message box will have a stop-sign icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HAND</term>
          <listitem>
          <para>
            The message box will have a stop-sign icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>QUERY</term>
          <listitem>
          <para>
            The message box will have a question-mark icon, same as the QUESTION keyword. Microsoft recommends not using
            this icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NONE</term>
          <listitem>
          <para>
            Used to allow the programmer to explicitly state that the message box should not have an icon. Omitting the
            <emphasis role="italic">icon</emphasis> argument altogether has the same effect.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>misc [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">misc</emphasis> argument specifies a number of other attributes that can be set for
        the message box. The argument consists of a blank separated string of keywords from the lists below. The
        default if this argument is omitted is <computeroutput>"DEFBUTTON1 APPLMODAL"</computeroutput>.
      </para>
      <para>
        The keywords are divided up into four groups. Except for the <emphasis role="italic">other
        miscellaneous</emphasis> group, only one keyword from each group should be used, case is not significant. If
        more than one keyword in a group is used, the behavior is undefined.
      </para>
      <para>
        These keywords are used to select the default push button when the message box is shown. Use only one keyword
        from this group.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>DEFBUTTON1</member>
          <member>DEFBUTTON2</member>
          <member>DEFBUTTON3</member>
          <member>DEFBUTTON4</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>DEFBUTTON1</term>
          <listitem>
          <para>
            The first button is the default button. This is the default value if none of the other default button
            keywords are used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFBUTTON2</term>
          <listitem>
          <para>
            The second button is the default button.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFBUTTON3</term>
          <listitem>
          <para>
            The third button is the default button.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFBUTTON4</term>
          <listitem>
          <para>
            The fourth button is the default button.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      <para>
        These keywords are used to indicate the <link linkend="defModalModeless">modality</link> of the message box.
        <emphasis role="bold">Note</emphasis> that the description of the modality behaviour here assumes that the window
        specified by the <emphasis role="italic">hwnd</emphasis> argument belongs to the programmer's Rexx application. Use
        only one keyword from this group.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>APPLMODAL  </member>
          <member>SYSTEMMODAL</member>
          <member>TASKMODAL  </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>APPLMODAL</term>
          <listitem>
          <para>
            Application Modal: The user must close the message box before continuing to work in the window specified by
            the <emphasis role="italic">hwnd</emphasis> argument. However, the user can move to windows on the desktop
            not part of the application and work in those windows.
          </para>
          <para>
            Depending on the hierarchy of windows in the application, the user may be able to move to other windows
            within the application. However, all child windows of the owner window of the message box are automatically
            disabled.
          </para>
          <para>
            APPLMODAL is the default if neither SYSTEMMODAL nor TASKMODAL are specified.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SYSTEMMODAL</term>
          <listitem>
          <para>
            System Modal: The modality for this keyword is the same as APPLMODAL except that the message box will have
            the topmost style. This means that the message box will stay on top of other windows not part of the
            application, if the user moves to those windows.
          </para>
          <para>
            Microsoft suggests that this type of message box be used to notify the user of serious, potentially
            damaging errors that require immediate attention. SYSTEMMODAL has no effect on the user's ability to
            interact with windows other than those associated with the <emphasis role="italic">hwnd</emphasis> argument.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TASKMODAL</term>
          <listitem>
          <para>
            Task Modal: This is the same as APPLMODAL except that all the top-level windows belonging to the current
            thread are disabled if the <emphasis role="italic">hwnd</emphasis> argument is 0. Use this keyword when the
            programmer does not have a window handle available but still needs to prevent input to other windows in
            the application.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      <para>
        Other miscellaneous keywords. One or more keywords from this group can be used..
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>DEFAULTDESKTOP     </member>
          <member>RIGHT              </member>
          <member>RTLREADING         </member>
          <member>SETFOREGROUND      </member>
          <member>TOPMOST            </member>
          <member>SERVICENOTIFICATION</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>DEFAULTDESKTOP</term>
          <listitem>
          <para>
            Same as the desktop of the interactive window station. The programmer should consult the Windows
            <xref linkend="defWindowsDoc"/> when considering to use this keyword.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RIGHT</term>
          <listitem>
          <para>
           The message text is right-justified.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RTLREADING</term>
          <listitem>
          <para>
            Displays the message and caption text using right-to-left reading order on Hebrew and Arabic systems.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SETFOREGROUND</term>
          <listitem>
          <para>
            The operating system, internally, sets the message box as the foreground window.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TOPMOST</term>
          <listitem>
          <para>
            The message box will have the topmost window style. This will keep the message box above all other windows
            on the desktop.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SERVICENOTIFICATION</term>
          <listitem>
          <para>
            The application dialog calling the <emphasis role="italic">MessageDialog</emphasis> routine is a service
            notifying the user of an event. The <emphasis role="italic">MessageDialog</emphasis> displays a message box
            on the current active desktop, even if there is no user logged on to the computer.
          </para>
          <para>
            ooDialog and Rexx programs in general are not particularly suited to implement Windows services. So it is
            unlikely that this keyword will be used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HELP</term>
          <listitem>
          <para>
            Adds a <emphasis role="bold">Help</emphasis> push button to the message box, in addition to the push buttons
            specifed in the <emphasis role="italic">pb</emphasis> argument. When the user clicks the <emphasis
            role="bold">Help</emphasis> button or presses F1, the operating system sends a HELP <xref
            linkend="ovvEvents"/> notification  to the window specified by the <emphasis role="italic">hwnd</emphasis>
            argument. If this window is an ooDialog dialog, the programmer can capture this notification using the
            <xref linkend="mthConnectHelp"/> method.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="italic">MessageDialog</emphasis> returns the Microsoft defined resource ID of the button pushed by
    the user, and 0 on error. The programmer can use a <link linkend="sctMethodsDlgObject">constant</link> of the
    <xref linkend="chpDialogObject"/> object to determine the return. The return values are:
    <variablelist>
      <varlistentry><term>0</term>
      <listitem>
      <para>
        An error occurred. the <xref linkend="dotSystemErrorCode"/> will be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>1 IDOK</term>
      <listitem>
      <para>
        The <emphasis role="bold">Ok</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>2 IDCANCEL</term>
      <listitem>
      <para>
        The <emphasis role="bold">Cancel</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>3 IDABORT</term>
      <listitem>
      <para>
        The <emphasis role="bold">Abort</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>4 IDRETRY</term>
      <listitem>
      <para>
        The <emphasis role="bold">Retry</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>5 IDIGNORE</term>
      <listitem>
      <para>
        The <emphasis role="bold">Ignore</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>6 IDYES</term>
      <listitem>
      <para>
        The <emphasis role="bold">Yes</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>7 IDNO</term>
      <listitem>
      <para>
        The <emphasis role="bold">No</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>8 IDCLOSE</term>
      <listitem>
      <para>
        The <emphasis role="bold">Close</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>9 IDHELP</term>
      <listitem>
      <para>
        The <emphasis role="bold">Help</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>10 IDTRYAGAIN</term>
      <listitem>
      <para>
        The <emphasis role="bold">Try Again</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>11 IDCONTINUE</term>
      <listitem>
      <para>
        The <emphasis role="bold">Continue</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the message box has a <emphasis role="bold">Cancel</emphasis> button, IDCANCEL is also returned if the user
    uses the ESC key. If the message box does not have a <emphasis role="bold">Cancel</emphasis> button, then the user
    can not close the message box by using the ESC key.
  </para>
  <para>
    The <xref linkend="rtnAskDialog"/>, <xref linkend="rtnInfoDialog"/>, and
 <xref linkend="rtnErrorDialog"/> routines are all implemented using the
    <computeroutput>MessageDialog</computeroutput> routine. While they are simplier to use, they are not very flexible.
    In addition because of the way <xref linkend="defModalModeless"/> dialogs are implemented, it is possible that those
    routines will not disable the correct dialog. If the programmer encounters problems with the wrong dialog being disabled,
    the solution is to use the <computeroutput>MessageDialog</computeroutput> routine and specify the
    proper window handle of the owner window.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from a Wizard 97 program that warns the user when she is about to change the page and has not
    completed all of the steps on the page she is on.
<programlisting>
<![CDATA[

::method wizNext unguarded
  expose selectedMovies movieTheaters movieCombo
  use arg propSheet

  do movie over selectedMovies
    if movieTheaters[movie] == .nil then do

      msg = "Warning.  You have not selected a movie" || .endOfLine ||           -
            "theater for all selected movies."        || .endOfLine~copies(2) || -
            "Are you sure you want to go to"          || .endOfLine ||           -
            "the next page?"

      title = "Theater Selection is not Complete"
      buttons = "YESNO"
      icon = "WARNING"
      style = "DEFBUTTON2 TASKMODAL"

      ans = MessageDialog(msg, propSheet~dlgHandle, title, buttons, icon, style)

      if ans == .PlainBaseDialog~IDYES then return 0

      movieCombo~select(movie)
      self~setRadioButtons(movie)
      return -1
    end
  end

  return 0
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End public routines::messageDialog() -->


<section id="rtnMultiInputBox" xreflabel="MultiInputBox"><title>MultiInputBox Routine</title>
<indexterm><primary>MultiInputBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>MultiInputBox</secondary></indexterm>
<para>Provides a shortcut function to invoke a
 <xref linkend="clsMultiInputBox"/> dialog:</para>
<programlisting>
<![CDATA[
res = MultiInputBox("Enter your address","Personal Data", ,
                    .array~of("&First name","Last &name","&City"), ,
                    .array~of("John","Smith","San Jose"), 100)
if res \= .Nil then do entry over res
                       say "Address-line[]= " entry
                    end
]]>
</programlisting>
<para>
  The parameters are described in the <xref linkend="initMultiInputBox"/> method of the
  <computeroutput>MultiInputBox</computeroutput> class. However, instead of using stems, arrays are used for input.
</para>
<para>The user's input to the dialog is also returned in an array.  Note this
other difference from the MultiInputBox dialog: if the user cancels the dialog
<computeroutput>.nil</computeroutput> is returned rather than the empty string.
</para>
</section>

<section id="rtnMultiListChoice" xreflabel="MultiListChoice"><title>MultiListChoice Routine</title>
<indexterm><primary>MultiListChoice</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>MultiListChoice</secondary></indexterm>
<para>Provides a shortcut to invoke a
 <xref linkend="clsMultiListChoice"/> dialog as a function:
</para>
<programlisting>
<![CDATA[
days = MultiListChoice("Select days","My TV Days", ,
                       .array~of("Monday","Tuesday","Wednesday", ,
                              "Thursday","Friday","Saturday","Sunday"), , ,"2 5")
if days <> .Nil then do day over days
                       say "TV day =" day
                    end
]]>
</programlisting>
<para>
  The parameters are described in the <xref linkend="initListChoice"/> method of the
  <computeroutput>MultiListChoice</computeroutput> class. However, instead of stems, arrays are passed into the function.
</para>
<para>
  If the user cancels the dialog, <computeroutput>.nil</computeroutput> is returned rather than the empty string.
</para>
</section>

<section id="rtnPasswordBox" xreflabel="PasswordBox"><title>PasswordBox Routine</title>
<indexterm><primary>PasswordBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>PasswordBox</secondary></indexterm>
<para>A shortcut to invoke a <xref linkend="clsPasswordBox"/>
dialog as a function:
</para>
<programlisting>
<![CDATA[
pwd = PasswordBox("Please enter your password","Security")
]]>
</programlisting>
<para>
  The parameters are described in the <xref linkend="initInputBox"/> method of the <computeroutput>InputBox</computeroutput>
  class.
</para>
</section>

<section id="rtnSingleSelection" xreflabel="SingleSelection"><title>SingleSelection Routine</title>
<indexterm><primary>SingleSelection</primary><secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary><secondary>SingleSelection</secondary></indexterm>
<programlisting>
<![CDATA[
>>-SingleSelection(--msg-,-title-,-labels-+----------+-+-----------+-+-------+--)--><
                                          +-,-preSel-+ +-,-rbWidth-+ +-,-max-+
]]>
</programlisting>
<para>
  The SingleSelection function provides a shortcut to invoke a <xref linkend="clsSingleSelection"/> dialog. However, the
  <emphasis role="italic">labels</emphasis> argument is an array, rather than a stem as it is in the
  <computeroutput>SingleSelection</computeroutput> class.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>msg [required]</term>
    <listitem>
    <para>
      A text string that is displayed above the radio button group. Typically, the text would be used to give the user the
      purpose of the radio buttons, or to prompt the user as to what to do.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>title [required]</term>
    <listitem>
    <para>
      A title, the caption bar text, for the dialog that will be invoked.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>labels [required]</term>
    <listitem>
    <para>
      An array with indexes one through the number of radio buttons desired. The value for each index is the label for the
      corresponding radio button. For instance the value at index 2 of the array would be set to the label for the second
      radio button.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>preSel  [optional]</term>
    <listitem>
    <para>
       This argument can be used to preselect, (that is to check,) one radio button. A value of 1 checks the first radio
       button, a value of 2 checks the second, and so on. If this argument is omitted, the first radio button is checked.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>rbWidth [optiona]</term>
    <listitem>
    <para>
      Specifies the width, in dialog units, of the radio button controls. If omitted, the width is calculated so that the
      longest label will not be clipped. If used, all radio buttons are set to this width without regard as to whether the
      label will be clipped or not.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>max [optional]</term>
    <listitem>
    <para>
      The maximum number of radio buttons in one column. If there are more radio buttons than <emphasis
      role="italic">max</emphasis>, that is, if the <emphasis role="italic">labels</emphasis> argument has more indexes than
      the value of <emphasis role="italic">max</emphasis>, the radio buttons are positioned in columns. Each column will
      have <emphasis role="italic">max</emphasis> radio buttons and there will be as many columns as needed to display all
      the radio buttons.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    If the user cancels the dialog, the empty string is returned. If the user closes the dialog with <emphasis
    role="italic">Ok</emphasis> the return is the index in the <emphasis role="italic">labels</emphasis> array of the
    selected radio button. 1 for the first radio button, 2 for the second radio button, 8 for the eighth radion button,
    etc., etc..
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the <emphasis role="italic">SingleSelection</emphasis> routine is called, the ooDialog framework, internally, does
    a number of calculations to determine the optimal size of the dialog controls and dialog. The framework then positions
    all the dialog controls such that none of the radio button labels, message, and title of the dialog are clipped.
  </para>
  <para>
    The one exception to this is if the programmer specifies the width of the radio button controls using the optional
    <emphasis role="italic">rbWidth</emphasis> argument. In this case the width of the radio buttons is always set to what
    the programmer has specified. It is possible that the radio buttons will be clipped, but that is now the responsibility
    of the programmer.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example shows a dialog that contains a two-column radio button group. The sixth radio button (the button
    with the label Jun) is checked, (preselected.)

<programlisting>
<![CDATA[

months = .array~of("Jan","Feb","Mar","Apr","May","Jun",  -
                   "Jul","Aug","Sep","Oct","Nov","Dec")
dlgTitle = "The Month You Were Born"
prompt = "Select the month of your birth:"
selectedRadioButton = 3

m = SingleSelection(prompt, dlgTitle, months, selectedRadioButton, , 6)
if m == "" then
    say "The user canceled the dialog."
else
    say "Born in month" m "=" months[m]

::requires "ooDialog.cls"
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="rtnTimedMessage" xreflabel="TimedMessage"><title>TimedMessage Routine</title>
<indexterm><primary>TimedMessage</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>TimedMessage</secondary></indexterm>
<para>The TimedMessage routine provides a shortcut to invoke a
 <xref linkend="clsTimedMessage"/> dialog as a function:
</para>
<programlisting>
<![CDATA[
ret = TimedMessage("We are starting...","Please wait",3000)
]]>
</programlisting><para> The parameters are the same as described in the
<xref linkend="initTimedMessage"/> method of the <computeroutput>
TimedMessage</computeroutput> class.
</para>
<para>The function returns 0, always, when the duration is non-negative.  When
the duration is less than 0, the function returns a reference to the
<computeroutput>TimedMessage</computeroutput> dialog object.  This is needed in
order for the programmer to manually dismiss the dialog.  Below are the same 3 <link
linkend="example1TimedMessage">examples</link> listed for the <computeroutput>TimedMessage</computeroutput> dialog,
modified to work with the public routine:
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Example
 1:</emphasis></term>
<listitem><para>The following example shows a window with the title of <emphasis
role="italic">Infomation</emphasis> for a duration of 3 seconds:
<programlisting> <![CDATA[
ret = timedMessage("Application will be started, please wait", -
                   "Information", 3000)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example
2:</emphasis></term>
<listitem><para>The following example shows an introductory window that displays
while an application is doing its time consuming start up routine.  Since this
start up process can vary in time depending on the individual system, the window
is set to display indefinitely.  When the start up process is finished, the
programmer dismisses the window and destroys the dialog manually.  Note how a
reference to the <computeroutput>TimedMessage</computeroutput> dialog is
returned.  The programmer only needs to use this to dismiss / destroy the dialog
<programlisting>
<![CDATA[
dlg = timedMessage("The WidgetCreator Application - loading ...", -
                   "The Widget Factory", -1)
ret = doStartup()
dlg~ok
if ret <> 0 then do
  ...
end
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example
3:</emphasis></term>
<listitem><para>The following example is a variation on <emphasis role="bold">
Example 2</emphasis>.  In this case the Widget Factory executives decided that
they want their WidgeCreator splash screen to always display for 2 seconds to
the customer and then close.  The early reply argument is used so that the start
up routine executes immediately.  After 2 seconds the splash screen dismisses
and the dialog is destroyed automatically.
</para>
<programlisting> <![CDATA[
ret = timedMessage("The WidgetCreator Application - loading ...", -
                   "The Widget Factory", 2000)

if doStartup() <> 0 then do
  ...
end
]]>
</programlisting></listitem></varlistentry>
</variablelist>
</section>

</section>

</section>


<!-- <section id="clsMouse" xreflabel="Mouse"><title>Mouse Class</title>  START -->
<xi:include href="mouse.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
<!-- <section id="clsMouse" xreflabel="Mouse"><title>Mouse Class</title>  END   -->


<!-- <section id="clsKeyboard" xreflabel="Keyboard"><title>Keyboard Class</title>  START -->
<xi:include href="keyboard.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
<!-- <section id="clsMouse" xreflabel="Mouse"><title>Mouse Class</title>  END   -->


</chapter>
