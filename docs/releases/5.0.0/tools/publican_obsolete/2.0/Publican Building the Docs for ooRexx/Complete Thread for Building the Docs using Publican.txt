======================================================================

[Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 12:28:21
Attachments: Message as HTML

I have a working Ubuntu 18.10 now running in VirtualBox. It would be nice
to be able to build the docs on VM as well. Is there a guide for what needs
to be installed for this?

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-25 14:30:14
Attachments: Message as HTML

I tried this some two or three years ago, and it was a miserable experience.
I've attached below my notes from back then.

If you want to give it a try, please note down each step as accurately as
possible.  If we get somewhere, I'll add the steps required to our Wiki.

I tried getting help for a few things by posting to the publican-list
publican-list@...

The publican-list archives are to be found at
https://www.redhat.com/archives/publican-list/

~~~
sudo apt install publican
# this will install fop, but fop is deprecated by publican, it wants
wkhtmltopdf
# installing wkhtmltopdf doesn't seem to work, as publican requires a
'patched' version
# see https://www.redhat.com/archives/publican-list/2014-April/msg00003.html

# in case we've already tried to install wkhtmltopdf:
#
http://stackoverflow.com/questions/18758589/wkhtmltopdf-installation-error-on-ubuntu
sudo apt-get remove --purge wkhtmltopdf

# now let's install 'patched' wkhtmltopdf:
sudo apt-get install openssl build-essential xorg libssl-dev
# http://wkhtmltopdf.org/downloads.html
wget
http://download.gna.org/wkhtmltopdf/0.12/0.12.3/wkhtmltox-0.12.3_linux-generic-amd64.tar.xz
tar xf wkhtmltox-0.12.3_linux-generic-amd64.tar.xz
cd wkhtmltox/bin
sudo chown root:root wkhtmltopdf
sudo cp wkhtmltopdf /usr/local/bin/wkhtmltopdf
wkhtmltopdf --version   # wkhtmltopdf 0.12.3 (with patched qt)

# to avoid "failed loading image" errors and unexplained "wkhtmltopdf died"
errors
# https://www.redhat.com/archives/publican-list/2013-August/msg00005.html
ulimit -n 8192
~~~

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 14:37:49
Attachments: Message as HTML

I'll give it a go...how are you building the docs now if not this way?

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-25 15:17:34
Attachments: Message as HTML

I'm building on Windows only, using an ancient, unsupported version of
publican plus fop for Windows
I changed some settings, like single-page formatting and added a crude
manual cleaning-step which removes a lot of annoying whitespace around
examples.  Windows was (and still seems) the only way to get a decent PDF.
PDFs built on Ubuntu had several major issues (reported at
https://www.redhat.com/archives/publican-list/2016-August/msg00004.html)
which I didn't understand well enough to be able to fix.
Also the build would take some ten times longer than on Windows and I'm
doing all the editing on Windows, so a build capability on Windows is
really a must for me.

My old installation notes for publican on Windows are here, but I'm not
sure how complete these are

~~~
Install Publican
https://fedorahosted.org/releases/p/u/publican/
Tars and SRPMs: https://fedorahosted.org/releases/p/u/publican/
Publican-Installer-3.0.exe

Install FOP
https://xmlgraphics.apache.org/fop/download.html
http://www.apache.org/dyn/closer.cgi/xmlgraphics/fop
http://mirror.cc.columbia.edu/pub/software/apache/xmlgraphics/fop/binaries/fop-1.1-bin.zip

add "version: 5.0" to docs/trunk/rexxref/publican.cfg
either
  add Publican path to PATH: set path="\Program Files
(x86)\Publican;"%PATH%, or
  use "\Program Files (x86)\Publican;publican.exe" instead of "publican"
either
  add FOP path to PATH: set path=\FOP\fop-1.1;%PATH%, or
  create a BAT file (within your PATH) that redirects
publican build --formats=pdf --langs=en-US --common_content=".."
~~~

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 15:39:23
Attachments: Message as HTML

I didn't realize you were doing this on Windows...I'd actually prefer that.
Years ago David stated Windows would not be possible, so I didn't realize
that had changed. I'll give that a shot.

I ran into an immediate road block with your ubuntu instructions. The
patched version doesn't appear available any more. I just finished
installing the latest wkhtmltopdf, but haven't had a chance to see if it
works or not. I think I'll focus on the Windows build first, since if I do
any editting, it will be on Windows also.

Rick

======================================================================


Re: [Oorexx-devel] Building the docs
From: Gil Barmwater <gbarmwater@al...> - 2018-12-25 16:20:58
Attachments: Message as HTML

I, too, was under the impression that the docs were built on *ix, not 
Windows!  Once we have a tested "recipe" for doing it, I'll attempt to 
get it working on my system as well.  That way, when I find typos, etc., 
I can edit/build and supply a "tested" patch that a committer can 
confidently apply.

Gil B.

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 16:39:51
Attachments: Message as HTML

OK, snag #1) fedorahosted.org has gone away and I haven't been able to find
another source for publican 3.0. Do you still have the installer file?
Perhaps we should add that to the buildutils directory on sourceforge.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 16:56:10
Attachments: Message as HTML

I thought I'd give the ubuntu build a try. I was able to build and install
the brand successfully. Attempting to build the docs got the the phase
"Starting pdf" and it has been sitting there for a long time. I don't know
it it is hung, or just taking a really long time. This is using the latest
publican and wkhtmltopdf. Since you are using FOP on windows, I wonder if
it might be better to delete wkhtmltopdf and allow it to use FOP instead.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-25 17:51:32
Attachments: Message as HTML

>
> OK, snag #1) fedorahosted.org has gone away
>
Well, as far as I understand this is where the Publican git was hosted.
That could mean, Publican is dead.

>
> Do you still have the installer file? Perhaps we should add that to the
> buildutils directory on sourceforge.
>

Yes, I still have it.
I've packed it together with a bunch of my publican-related stuff into a
ZIP and uploaded to
https://sourceforge.net/projects/oorexx/files/windows-build-tools/PublicanWindows.zip
(I just now see that there's also a oorexx-buildutils/ folder .. I haven't
yet checked if we are keeping redundant files)

The ZIP contains the Publican-Installer-3.0.exe and various helper scripts
that I wrote
e. g. a filter to get rid of thousands of fop warnings during build, or a
fop front-end script, which runs fop-preprocess to remove unwanted
whitespace.
The PublicanBuildHere script will run a build with above mentioned
extensions

======================================================================

Re: [Oorexx-devel] Building the docs
From: René Jansen <rvjansen@xs...> - 2018-12-25 17:55:44
Attachments: Message as HTML

Hi Erich,

I’d like to build the docs on the build server also. Do you still have that email somewhere in which you explained to me what you did?

René.

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-25 17:57:55
Attachments: Message as HTML

>
> it might be better to delete wkhtmltopdf and allow it to use FOP instead
>
I can't remember whether I managed to get publican+fop to work on Ubuntu,
but I think the idea was to create a "supported" publican environment (Jeff
said, publican+fop was deprecated and wouldn't support it) which would have
to be publican+wkhtmltopd

As it emerged, there was so little support from Jeff, that it really
wouldn't have mattered.
publican+fop on Ubuntu might be worth a try.

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-25 18:08:17
Attachments: Message as HTML

>
> I’d like to build the docs on the build server also
>
Hi René, on which platform should that be: Windows or Linux?

Do you still have that email somewhere in which you explained to me what
> you did?
>
Are you maybe referring to this thread?
https://sourceforge.net/p/oorexx/mailman/message/35253785/

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-25 18:14:29
Attachments: Message as HTML

>
> That could mean, Publican is dead
>
According to
https://www.redhat.com/archives/publican-list/2017-January/msg00001.html
the Publican git was moved to
https://sourceware.org/gerrit/#/admin/projects/publican

But for me, this new site is currently unavailable.

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 20:36:55
Attachments: Message as HTML

I fired up a build on unbuntu before I left to walk my dog. It looks like
everything but the rexxref built cleanly, and I think the failure there was
related to the ulimit problem. When I try to issue the ulimit command you
show, I get the following error:

bash: ulimit: open files: cannot modify limit: Operation not permitted.

This is using the latest publican install with Fop.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 21:35:35
Attachments: Message as HTML

I went back and tried rebuilding just the rexxref, and it looks like this
is a heap space problem with java. I don't know if there is a way to
increase this.

Rick

======================================================================


Re: [Oorexx-devel] Building the docs
From: Rony G Flatscher <rony.flatscher@wu...> - 2018-12-25 21:40:41
Attachments: Message as HTML

Use -Xmx fir nax hesp size -Xms initial Java heap size

—-rony

Rony G. Flatscher (mobil/e)

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rony G Flatscher <rony.flatscher@wu...> - 2018-12-25 21:42:10
Attachments: Message as HTML

Use 

  java -X

for all switches

—-rony

Rony G. Flatscher (mobil/e)
======================================================================

Re: [Oorexx-devel] Building the docs
From: René Jansen <rvjansen@xs...> - 2018-12-25 21:59:48
Attachments: Message as HTML

Linux - I am planning a docker image for the build machine, like the one that builds ooRexx for Arch Linux now.

René.


======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 22:35:35
Attachments: Message as HTML

I found this FAQ about how to increase the FOP heap size:

https://jfearn.fedorapeople.org/en-US/Publican/4.0/html/Users_Guide/chap-Publican-Users_Guide-Frequently_Asked_Questions.html#idp21915680

But it didn't seem to work. I tried going as high as 2g on the max, and it
died at the same place. I'm not sure the file is getting picked up because
I even tried setting them to invalid values to see if it would cause an
error to no effect.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-25 23:25:18
Attachments: Message as HTML

Rats, the installer gives an error trying to download components. You might
have the only working installer for this!

I'm still stuck on trying to get this to build on ubunto. If I use Fop, I
get a java out of heap exception that I've not had any success at
eliminating. If I install wkhtmltopdf, I get an error about a missing
abstract age in the BookInfo. Not sure where the source of the problem
here...it might be interesting to pursue this further to see if we can get
something to build.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-26 12:50:33
Attachments: Message as HTML

>
> Rats, the installer gives an error trying to download components. You
> might have the only working installer for this!
>

We really should try to keep alive our ability to build docs on Windows
I've uploaded three ZIPs to
https://sourceforge.net/projects/oorexx/files/windows-build-tools
These are copies of my installed versions that I'm running
see also the README in the same directory

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-26 13:51:19
Attachments: Message as HTML

I found the secret sauce to get the rexxref pdf to build using FOP. Before
running the make, issue

export JAVA_TOOL_OPTIONS="-Xms1g -Xmx2g"

This allows the pdf build to run to completion and the build runs
significantly faster.

I still want to see if I get get things to build with wkhtmltopdf. Right
now, it is giving an error for a missing abstract tag in the BookInfo, so
perhaps it could be as simple as adding abstracts to the books. I'm go to
start with one of the smaller books first to see if I can get it to build.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-26 15:24:48
Attachments: setupwkhtmltopdf.sh Message as HTML

And now I've had success building the rxmath docs with wkhtmltopdf. Adding
a minimal abstract to the BuildInfo..html got past the abstract tag error,
but then I hit the issue of running with the unpatched wkhtmltopdf. I found
an article here showing a shell script for installing the patched version:

https://gist.github.com/Rajeshr34/2e9b2438ff142e51c729b4b9b772680a

I had to tweak a couple of this, but managed to get this working using the
attached script.

I'm not sure I understand why the abstract tags are required when using
wkhtmltopdf, since the error is occurring during the XLT transformation,
which is the step before wkhtmlpdf is used. The FOP build has the same
stage, and runs cleanly. I suspect they must be running with a different
style sheet. But it does work now.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-26 15:36:23
Attachments: Message as HTML

Amazing!
How does the generated PDF look like? Images, font, tables, index etc.
Can you upload (or else make available) the Ubuntu-built fop and
wkhtmltopdf versions of any doc you have done?

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-26 15:41:25
Attachments: Message as HTML

>
> the one that builds ooRexx for Arch Linux now
>
René, can you explain the docker scenario in the Jenkins build machine?
It runs on an Ubuntu slave and creates a build for Arch Linux?  How does it
do that? A cross-compile?
Where to do the generated binaries go?
What about running the regression tests?


On Tue, Dec 25, 2018 at 11:00 PM René Jansen <rvjansen@...> wrote:

> Linux - I am planning a docker image for the build machine, like the one
> that builds ooRexx for Arch Linux now.

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-26 15:43:24
Attachments: Message as HTML

I'm sort of in a mixed state right now. I just made a clone of my VM. I'm
going to set one up for FOP and the other for wkhtmltopdf and generate a
full set both ways.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-26 17:08:10
Attachments: Message as HTML

I just uploaded a fop-docs.zip to the docs folder on Sourceforge. I still
need to modify the BookInfos to add dummy abstracts before I can build the
wkhtmltopdf versions. I've got to run out for a few hours, I'll get to that
later.

Rick

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-26 17:29:05
Attachments: Message as HTML

>
> fop-docs.zip
>
Ok .. I guess I remember this: dull fonts and no images, although it's
fop-based and you'd expect this to be as similar as possible to what we
have with our ancient Publican+fop on Windows installation.

======================================================================

Re: [Oorexx-devel] Building the docs
From: René Jansen <rvjansen@xs...> - 2018-12-26 19:07:53
Attachments: Message as HTML

Hi Erich,

it uses the pipeline process on Jenkins, which is relatively new, and meant to do docker builds. It assumes a running docker system on the host, which P.O. provided. Then it executes the following build pipeline script:

pipeline {
    agent { docker { image 'rvjansen/arch-devel' } label 'ubuntu16'}
    environment {
        PATH="$PATH"
    }
    stages {
        stage('checkout') {
            steps {
                svn 'https://svn.code.sf.net/p/oorexx/code-0/main/trunk';
                sh 'svn upgrade'
            }
        }
        stage('build') {
            steps {
                catchError {
                sh 'cmake -DCMAKE_BUILD_TYPE=RELEASE .'
                }
                sh 'make clean'
                sh 'make'
            }
        }
    }
}

The agent directive tells it to use the rvjansen/arch-devel image from the docker hub, it will download a newer one when that becomes available. The label ‘ubuntu16’ tells it to build on the master machine, because I know that to have a docker system running; without the label it assumes that all slaves run docker.

There are two stages in the pipeline: checkout and build which do more or less what one would expect. The cmake is wrapped in an error handler; cmake complains about one or the other detail, and the pipeline would stop if returncodes are >0.

Compared to the free-format builds we did before, there are a few confusing things, at least until you get used to them.

One is that the build takes place in the docker image, but with an exported directory of the build machine. So all the tools, the cmake and gcc, run on Arch linux, in this case with cmake 3.12.4 and gcc 8.2.1. Another thing is that in the Poll SCM schedule one has to specify the schedule only; it picks up the location where to pull from, from the pipeline.

The build ends up in the ‘last succesfull build’ folder. I’ll add a test stage and an scp to SF. In was in the process of figuring out the makepackage builder that makes packages for Arch Linux’s pacman, but got interrupted.

best regards,

René.

======================================================================


Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-26 19:26:27
Attachments: Message as HTML

>
> The label ‘ubuntu16’ tells it to build on the master machine because I
> know that to have a docker system running
>
Well, ubuntu16 is my Ubuntu VM, and I'm pretty sure it has no docker running
It's seems a bit amazing that the pipeline doesn't notice that.

======================================================================

Re: [Oorexx-devel] Building the docs
From: René Jansen <rvjansen@xs...> - 2018-12-26 19:48:46
Attachments: Message as HTML

well, that certainly is amazing! I am going to see what happened here. Just before I stopped this activity last week I made a zip from the last build that it did, and that ran perfect on Arch Linux - but I see that might have been a ubuntu build. I checked this with a local jenkins and that went also fine - and I put uname -a and gcc —version in there to make sure it ran in the docker image. So, I’ll put in some debug of the build process and will let you know.

René.

======================================================================

Re: [Oorexx-devel] Building the docs
From: René Jansen <rvjansen@xs...> - 2018-12-26 20:09:06
Attachments: Message as HTML

well, that explains a number of things. Indeed it builds on your machine now; rather quickly compared to the much slower docker build on my machine. Also, I took the zip from my local machine so it really is no miracle that it ran on the same image on which it was built on.

I switched to ubuntu16 thinking it was an alias for P.O.’s build machine, that was also just moved to ubuntu. This was because it did not build on master - so black to the blueprints. It appears we need at least one slave that runs docker.

René.

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-26 21:31:49
Attachments: Message as HTML

Just uploaded the wkhtmltopdf versions. At first glance, they look quite a
bit better.

Rick

On Wed, Dec 26, 2018 at 12:29 PM Erich Steinböck <erich.steinboeck@...>
wrote:

> fop-docs.zip
>>
> Ok .. I guess I remember this: dull fonts and no images, although it's
> fop-based and you'd expect this to be as similar as possible to what we
> have with our ancient Publican+fop on Windows installation.
>

======================================================================

Re: [Oorexx-devel] Building the docs
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-27 09:09:11
Attachments: Message as HTML

>
> Just uploaded the wkhtmltopdf versions. At first glance, they look quite a
> bit better.
>
Much better, yes.
Still a few points, you'd need to get used to, like the underlined links or
the one-column index.  Tweaking the xsl could be an option.
The SVG scaling issue looks bad.

As long as they are still fresh in your mind, can you share the steps to
install for both the fop and the wkhtmltopdf setups?

======================================================================

Re: [Oorexx-devel] Building the docs
From: Rick McGuire <object.rexx@gm...> - 2018-12-27 10:48:38
Attachments: Message as HTML

Yes, will do.

Rick

======================================================================

[Oorexx-devel] Steps for building the docs on Ubuntu
From: Rick McGuire <object.rexx@gm...> - 2018-12-27 11:50:10
Attachments: Message as HTML

FOP version:

This is the easiest, but produces the worst results:

1) install publican
   sudo apt install publican

2) make sure wkhtmltopdf is not installed
  sudo apt-get remove --purge wkhtmltopdf

At this point, all of the docs are buildable except for the rexxref which
will give a java out of heap error. To increase the heap, issue

  export JAVA_TOOL_OPTIONS="-Xms1g -Xmx2g"

before building.

wkhtmltopdf version.

Do steps 1) and 2) above to make sure you are clean. It is necessary to
build a patched version of wkhtmltopdf to get this to work. The following
shell script will create the patched version:

setupwkhtmltopdf.sh

cd ~
sudo apt-get install libfontenc1 xfonts-75dpi xfonts-base
xfonts-encodings xfonts-utils openssl build-essential libssl-dev
libxrender-dev git-core libx11-dev libxext-dev libfontconfig1-dev
libfreetype6-dev fontconfig -y
#https://github.com/wkhtmltopdf/wkhtmltopdf/releases
#replace arch
wget https://github.com/wkhtmltopdf/wkhtmltopdf/releases/download/0.12.5/wkhtmltox_0.12.5-1.bionic_amd64.deb
sudo dpkg -i wkhtmltox_0.12.5-1.bionic_amd64.deb
sudo apt --fix-broken install


Note that to uninstall this version, you need to use

  dpkg --remove wkhtmltox

If you try to build the docs now, you will get an error for a missing
"abstract" tag in the BookInfo. I had to manually add a dummy abstract
to the BookInfos, then every thing built cleanly. We should probably
consider adding real abstracts to the docs.


Rick

======================================================================

[Oorexx-devel] Windows doc builds
From: Rick McGuire <object.rexx@gm...> - 2018-12-28 17:32:53
Attachments: Message as HTML

Finally got around to trying to build the docs on Windows and immediately
hit a problem. Your publican tools appear to be missing cdsvn.bat. Also,
what adjusts do a need to make for the location where I unzipped fos?

Rick

======================================================================

Re: [Oorexx-devel] Windows doc builds
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-28 19:00:47
Attachments: Message as HTML

`call cdsvn docs` changes to the docs trunk, which in my installation is
%USERPROFILE%\Downloads\ooRexxSVN\docs\trunk
publicanbuildall.bat is an old piece of code from a time when I started
working on rexxref but didn't yet have a Visual Studio set up, so I
couldn't build using the make files

if you want to use the optional tools, then you'd have to adjust the last
line of fop.bat (one of the optional tools):
%USERPROFILE%\Downloads\FOP\fop-1.1\fop.bat
This line calls fop's fop.bat, so you have to adjust the path to it.

======================================================================

Re: [Oorexx-devel] Windows doc builds
From: Rick McGuire <object.rexx@gm...> - 2018-12-28 21:53:51
Attachments: Message as HTML

Is there an "install the brand step" I need to do, or is that included in
your zipped up publican archive?

Rick

======================================================================


Re: [Oorexx-devel] Windows doc builds
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-28 22:15:45
Attachments: Message as HTML

The original installer did some install steps. The ZIP is now the result of
what I had done back then.  So .. nothing to do for you now anymore.

======================================================================

Re: [Oorexx-devel] Windows doc builds
From: Rick McGuire <object.rexx@gm...> - 2018-12-28 22:26:55
Attachments: Message as HTML

Hmmm, looks like I'm still missing something. I ran a build, but when it
finally finished, no .pdf or html files were created, except in the
rexxref\tmp directory, which ended up with a large number of .pdf files
that looked like they corresponded to chapters.

Rick


======================================================================

Re: [Oorexx-devel] Windows doc builds
From: Erich Steinböck <erich.steinboeck@gm...> - 2018-12-29 07:01:00
Attachments: Message as HTML

Did you see the finishing "Finished pdf" message?
The resulting PDF should be created as
docs\trunk\[specific-doc-dir]\tmp\en-US\pdf\ooRexx_Documentation-5.0-Open_Object_Rexx-en-US.pdf

The optional tool publicanmovepdf.bat will try to figure out the correct
name for the pdf, move it to \temp\docs\ (this is where I collect all built
docs; just modify this as you wish in two lines at the bottom of this bat
file) and open it for reading.

======================================================================

Re: [Oorexx-devel] Windows doc builds
From: Rick McGuire <object.rexx@gm...> - 2018-12-29 10:48:16
Attachments: Message as HTML

On Sat, Dec 29, 2018 at 2:01 AM Erich Steinböck <erich.steinboeck@...>
wrote:

> Did you see the finishing "Finished pdf" message?
>

No I did not. I got a bunch of slightly mangled messages like this (the
mangled parts were the newlines between the two messages, which did not
survive the cut-and-paste operation):

Setting up en-US
Processing file tmp/en-US/xml/Common_Content/CPLv1.0.xml ->
tmp/en-US/xml/Common_Content/CPLv1.0.xm
cannot find tmp\en-US\pdf\*.pdf
-- building rexxref ---------------------------
Setting up en-US
Processing file tmp/en-US/xml/Common_Content/CPLv1.0.xml ->
tmp/en-US/xml/Common_Content/CPLv1.0.xm
cannot find tmp\en-US\pdf directory
-- building rxftp ---------------------------
Setting up en-US
Processing file tmp/en-US/xml/Common_Content/CPLv1.0.xml ->
tmp/en-US/xml/Common_Content/CPLv1.0.xm
cannot find tmp\en-US\pdf\*.pdf
-- building rxmath ---------------------------
Setting up en-US
Processing file tmp/en-US/xml/Common_Content/CPLv1.0.xml ->
tmp/en-US/xml/Common_Content/CPLv1.0.xm
cannot find tmp\en-US\pdf\*.pdf
-- building rxsock ---------------------------
Setting up en-US
Processing file tmp/en-US/xml/Common_Content/CPLv1.0.xml ->
tmp/en-US/xml/Common_Content/CPLv1.0.xm
cannot find tmp\en-US\pdf\*.pdf
-- building unixextensions ---------------------------
Setting up en-US
Processing file tmp/en-US/xml/Common_Content/CPLv1.0.xml ->
tmp/en-US/xml/Common_Content/CPLv1.0.xm
cannot find tmp\en-US\pdf\*.pdf
-- building winextensions ---------------------------
Setting up en-US
Processing file tmp/en-US/xml/Common_Content/CPLv1.0.xml ->
tmp/en-US/xml/Common_Content/CPLv1.0.xm
cannot find tmp\en-US\pdf\*.pdf

======================================================================

Re: [Oorexx-devel] Building the docs
From: P.O. Jonsson <oorexx@jo...> - 2018-12-29 21:03:19
Attachments: Message as HTML

This is just for info; there has been a lot of water under the bridges since this mail but I just wanted to let you know that there exists a Publican installation (ver 3.2.1) for Docker. I could install it in virtually no-time and have it up&running on my Macbook. I tried the test examples from the documentation but got stuck since I do no have any notion on what to do (and very little experience of Docker).

if we later set up Docker on the MacMini build slave it could take care of the building later.

I also downloaded the documentation of ooRexx and tried a few but got stuck at the same place

po$ publican build --formats=xml --langs=all --publish
Failed to load brand file: /usr/share/publican/Common_Content/oorexx/publican.cfg at /usr/bin/publican line 725.

Von meinen Macbook gesendet

Hälsningar/Regards/Grüsse,
P.O. Jonsson
oorexx@...

======================================================================

[Oorexx-devel] Still working on getting the docs to build on Windows
From: Rick McGuire <object.rexx@gm...> - 2019-01-01 14:16:06
Attachments: Message as HTML

I removed the filter from the publican call so that the errors would
display and tried to build just rxmath. Here are the errors:

        Using XML::LibXSLT on C:/Program Files (x86)/Publican/xsl/pdf.xsl
I/O warning : failed to load external entity
"file:///C:/docbook-xsl-1.76.1/fo/docbook.xsl";
compilation error: file
file:///C:/Program%20Files%20(x86)/Publican/xsl/pdf.xsl element import
xsl:import : unable to load file:///C:/docbook-xsl-1.76.1/fo/docbook.xsl
I/O warning : failed to load external entity
"file:///C:/docbook-xsl-1.76.1/fo/graphics.xsl";
compilation error: file
file:///C:/Program%20Files%20(x86)/Publican/xsl/pdf.xsl element import
xsl:import : unable to load file:///C:/docbook-xsl-1.76.1/fo/graphics.xsl
 at Publican/Builder.pm line 1290
cannot find tmp\en-US\pdf\*.pdf

I'm guessing there's at least one more thing required from your setup or I
need to adjust the setup a little bit to find the files.

Rick

======================================================================

Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Erich Steinböck <erich.steinboeck@gm...> - 2019-01-01 16:21:23
Attachments: Message as HTML

Rick, try to use the original pdf.xsl, which is still there but renamed to
pdf-0.xsl because I did some modifications (see xsl\pdf.xsl-changes.txt).
The change to make the xsl work offline may interfere with your setup.
Maybe at least once a download of the Publican xsl is required.

I'm on vacation this week .. I'll try to do a setup on a different Windows
system, if this doesn't work for you.

======================================================================

Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Rick McGuire <object.rexx@gm...> - 2019-01-01 16:59:49
Attachments: Message as HTML

I found the directory docbook-xsl-1,76.1 in the publican install and copied
it to c:\ and got past that error. Not sure why it was looking for this in
c:\. Perhaps I'm missing some environment variable? Now all of the docs are
build, but each of the pdfs are getting
named ooRexx_Documentation-5.0-Open_Object_Rexx-en-US.pdf rather than the
component.pdf.

Rick

======================================================================

Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Erich Steinböck <erich.steinboeck@gm...> - 2019-01-01 17:22:31
Attachments: Message as HTML

The Publican directory should probably  be in PATH.

publicanbuildhere and publicanmovepdf try to take care of the naming issue.
If I remember correctly they look up the correct name in the cfg file and
then move/rename the file.

In the long run we should try to get rid of of my "optional" stuff and
use/adapt the make files.  I think they also do the renaming, but of course
don't use the message filter or the fop preprocess stage.

While talking about doc building, then there is also the railroad diagrams,
for which I've done some special setup too. I've documented this to some
extent in one of the how-to-build wiki pages on SF.

Erich.

======================================================================


Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Rick McGuire <object.rexx@gm...> - 2019-01-01 21:58:21
Attachments: Message as HTML

Sigh, it's always the simple things...I never created the directory that
publicanmovepdf was trying to move the files to.

Rick

On Tue, Jan 1, 2019 at 12:23 PM Erich Steinböck <erich.steinboeck@...>
wrote:

> The Publican directory should probably  be in PATH.
>

======================================================================

Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Erich Steinböck <erich.steinboeck@gm...> - 2019-01-12 15:45:04
Attachments: Message as HTML

I've had to switch my build hardware (and with it I had to move from Win 7
to Win 10) which seems to have taken away my ability to build docs.

When running publican for the first time I'm getting an "IO error: Can't
open file
C:\Users\(userid)\AppData\Local\Temp\par-(userid)\cache-80bd039b8ee13920b2ab8140f67b7e03223f77b1/inc/lib/publican
for write : Permission denied at -e line 953"
The build continues until DTD validation, where it hangs for two minutes
(by opening Windows Resource monitor, Network activity, I noticed that
publican.exe at this point is accessing antiddos.ghostsquadhackers.org
<https://www.ip-adress.com/website/antiddos.ghostsquadhackers.org>; - I
don't have the slightest idea what this means) and then stops with "Unknown
format: pdf at script/publican line 884"

I tried this on a second Win 10 system and it fails in exactly the same way.

When I tried to figure out what the IO error was, I saw that publican.exe
installs a full Perl interpreter (I remember reading about this on the
Publican mailing list) to the location mentioned in the error message.

Rick, did you successfully build on Windows 10?
Am I missing a crucial step (like install a brand) ?

======================================================================

Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Rick McGuire <object.rexx@gm...> - 2019-01-12 15:59:03
Attachments: Message as HTML

On Sat, Jan 12, 2019 at 10:46 AM Erich Steinböck <erich.steinboeck@...>
wrote:

> I've had to switch my build hardware (and with it I had to move from Win 7
> to Win 10) which seems to have taken away my ability to build docs.
> Rick, did you successfully build on Windows 10?
>
yes, that's where I started the process.

I didn't need to install a brand. I unzipped all of your stuff, then had to
play around with your utilities a bit to adjust to my setup. The one extra
step I had to make was to copy the docbook-xsl-1.76/1 directory to c:\
because that's where publican seemed to be looking for it.

Rick
======================================================================


Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: P.O. Jonsson <oorexx@jo...> - 2019-01-13 14:20:39
Attachments: Message as HTML

Dear Erich,

ghostsquadhackers.org <http://ghostsquadhackers.org/>; is/was a hacker organisation organizing denial-of-service attacks, read more about it here <https://en.wikipedia.org/wiki/Ghost_Squad_Hackers>; so it might well be that your Win7 machine was used for a DDNS attack in the past.

Check the .exe with an antivirus pgm, and monitor the network while using Publican, if you are lucky the virus did not survive the move from Win7 to Win10.

Rick, you should do the same.


Hälsningar/Regards/Grüsse,
P.O. Jonsson
oorexx@...


======================================================================

Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Erich Steinböck <erich.steinboeck@gm...> - 2019-01-13 15:22:12
Attachments: Message as HTML

Rick, adding the following registry entries fixes all my doc build issues
(you were better off than me as you ran the - now broken - installer first,
which at least adds the first of the three registry entries)

The registry entries fix the need to copy docbook-xsl-1.76.1 to the root
directory and for me it fixes the 5-minute delays before and after DTD
validation (@P.O. I'm always running with active antivirus software and
during the years I've been using it, the publican executable has never
triggered an alert).

This was exported with `reg export HKLM\Software\WOW6432Node\Publican
Publican.reg` and can be imported with `reg import` or manually.  Of course
you'll have to set the paths to where it's installed on your machine.  I'd
also check first, whether HKEY_LOCAL_MACHINE\Software\WOW6432Node\Publican
and its default entry already exist (the installer should have created
that).

~~~
[HKEY_LOCAL_MACHINE\Software\WOW6432Node\Publican]
@="C:\\Program Files (x86)\\Publican"
"dtd_path"="C:\\Program Files (x86)\\Publican\\DocBook_DTD"
"xsl_path"="C:\\Program Files (x86)\\Publican\\docbook-xsl-1.76.1"
~~~

======================================================================

Re: [Oorexx-devel] Still working on getting the docs to build on Windows
From: Rick McGuire <object.rexx@gm...> - 2019-01-13 15:40:00
Attachments: Message as HTML

Thanks, that will make life easier.

Rick

======================================================================
