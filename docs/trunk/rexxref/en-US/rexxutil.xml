<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "rexxref.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: Reference XML File
    #
    # Copyright (c) 2005-2023, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter id="rexxutil"><title>Rexx Utilities (RexxUtil)</title>
<indexterm><primary>dynamic link library (RexxUtil)</primary></indexterm>
<indexterm><primary>shared library (RexxUtil)</primary></indexterm>
<indexterm><primary>dllfunctions</primary></indexterm>
<para>RexxUtil is a Dynamic Link Library (DLL) package for Windows and *nix
platforms; the package contains external Rexx functions. These functions:</para>
<itemizedlist>
<listitem><para>Manipulate operating system files and directories</para>
</listitem>
<listitem><para>Manipulate Windows classes and objects</para></listitem>
<listitem><para>Perform text screen input and output</para></listitem>
</itemizedlist>
<para>All of the RexxUtil functions are registered by the Rexx interpreter on
startup so there is no need to manually register the functions.
</para>

<section id="systemerrorcodes"><title>A Note on Error Codes</title>
<indexterm><primary>Windows System Error Codes</primary></indexterm>
<para>Some of the RexxUtil functions return operating system error codes on failure.
The <xref linkend="utlSysgeterrortext" xrefstyle="select:title"/> function can
be used to retrieve the description of a system error code.
</para>
<para>On Windows, the meaning of these error return codes can be looked up in
the Windows System Error Codes documentation provided by Microsoft, currently at
<ulink url="https://docs.microsoft.com/en-us/windows/win32/debug/system-error-codes" />.
</para>
</section>

<section id="utilfuncttable"><title>List of Rexx Utility Functions</title>
<indexterm><primary>rexxutil functions</primary></indexterm>
<para>The following table lists all of the RexxUtil functions and the
platforms on which they are available.</para>
<table id="functtable" frame="all" pgwide="1"><title>Rexx Utility Library Functions</title>
<tgroup cols ="4">
<colspec colname="c1" colwidth="6*" />
<colspec colname="c2" colwidth="2*" />
<colspec colname="c3" colwidth="2*" />
<colspec colname="c4" colwidth="3*" />
<thead>
<row>
<entry morerows="1">Function Name</entry>
<entry namest="c2" nameend="c3" align="center">Exists on Platform</entry>
<entry morerows="1">Remarks</entry>
</row>
<row>
<entry align="center">Windows</entry>
<entry align="center">Unix</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="utlRxmessagebox" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlRxwinexec" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysaddrexxmacro" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysbootdrive" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysclearrexxmacrospace" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyscls" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyscreatepipe" xrefstyle="select:title"/></entry><entry>No</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyscurpos" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyscurstate" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysdriveinfo" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysdrivemap" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysdroprexxmacro" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysdumpvariables" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysfilecopy" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysfiledelete" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysFileExists" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysfilemove" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysfilesearch" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysfilesystemtype" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysfiletree" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry>Works differently</entry>
</row>
<row>
<entry><xref linkend="utlSysfork" xrefstyle="select:title"/></entry><entry>No</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysformatmessage" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysfromunicode" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysgeterrortext" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysgetfiledatetime" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysgetkey" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysgetlongpathname" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysgetmessage" xrefstyle="select:title"/></entry><entry>No</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysgetmessagex" xrefstyle="select:title"/></entry><entry>No</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysgetshortpathname" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysini" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfile" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfilecompressed" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfiledirectory" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfileencrypted" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfilelink" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfilenotcontentindexed" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfileoffline" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfilesparse" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysisfiletemporary" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyslinver" xrefstyle="select:title"/></entry><entry>No</entry><entry>No*</entry>
<entry>Linux only*</entry>
</row>
<row>
<entry><xref linkend="utlSysloadrexxmacrospace" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysmkdir" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysqueryprocess" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry>Works differently</entry>
</row>
<row>
<entry><xref linkend="utlSysqueryrexxmacro" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysreorderrexxmacro" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysrmdir" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyssaverexxmacrospace" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyssearchpath" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyssetfiledatetime" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyssetpriority" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysshutdownsystem" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyssleep" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysstemcopy" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysstemdelete" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyssteminsert" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysstemsort" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysswitchsession" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyssystemdirectory" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSystempfilename" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSystextscreenread" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSystextscreensize" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSystounicode" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysutilversion" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysversion" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSysvolumelabel" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswait" xrefstyle="select:title"/></entry><entry>No</entry><entry>Yes</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswaitnamedpipe" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswindecryptfile" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswinencryptfile" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswingetprinters" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswingetdefaultprinter" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswinsetdefaultprinter" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
<row>
<entry><xref linkend="utlSyswinver" xrefstyle="select:title"/></entry><entry>Yes</entry><entry>No</entry>
<entry></entry>
</row>
</tbody>
</tgroup>
</table>
</section>


<section id="utlRxmessagebox"><title>RxMessageBox (Windows only)</title>
<indexterm><primary>RxMessageBox</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>RxMessageBox</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/rxmessagebox.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Displays a Windows message box.</para>
<para>RxMessageBox returns the selected message box push button. Possible values
are: </para>
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The OK push button was pressed
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>The CANCEL push button was pressed
</para></listitem></varlistentry>
<varlistentry><term>3</term>
<listitem><para>The ABORT push button was pressed
</para></listitem></varlistentry>
<varlistentry><term>4</term>
<listitem><para>The RETRY push button was pressed
</para></listitem></varlistentry>
<varlistentry><term>5</term>
<listitem><para>The IGNORE push button was pressed
</para></listitem></varlistentry>
<varlistentry><term>6</term>
<listitem><para>The YES push button was pressed
</para></listitem></varlistentry>
<varlistentry><term>7</term>
<listitem><para>The NO push button was pressed
</para></listitem></varlistentry>
</variablelist>
<para>If a message box has a "CANCEL" button, the function returns the
2 value if either the ESC key is pressed or the "CANCEL" button is
selected.  If the message box has no "CANCEL" button, pressing ESC
has no effect.</para>
<variablelist>
<varlistentry><term><emphasis role="italic">text</emphasis></term>
<listitem><para>The message box text.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">title</emphasis></term>
<listitem><para>The message box title.  The default title is &quot;Error!&quot;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">button</emphasis></term>
<listitem><para>The message box push button style. The allowed styles are:
<variablelist>
<varlistentry><term>"OK"</term>
<listitem><para>A single OK push button.
</para></listitem></varlistentry>
<varlistentry><term>"OKCANCEL"</term>
<listitem><para>An OK push button and a CANCEL push button.
</para></listitem></varlistentry>
<varlistentry><term>"RETRYCANCEL"</term>
<listitem><para>A RETRY push button and a CANCEL push button.
</para></listitem></varlistentry>
<varlistentry><term>"ABORTRETRYIGNORE"</term>
<listitem><para>An ABORT push button, a RETRY push button and an IGNORE push
button.</para></listitem></varlistentry>
<varlistentry><term>"YESNO"</term>
<listitem><para>A YES push button and a NO push button.
</para></listitem></varlistentry>
<varlistentry><term>"YESNOCANCEL"</term>
<listitem><para>A YES push button, a NO push button and a CANCEL push button.
</para></listitem></varlistentry>
</variablelist>
The default push button style is OK.</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="italic">icon</emphasis></term>
<listitem><para>The message box icon style. The allowed styles are:
<variablelist>
<varlistentry><term>"NONE"</term>
<listitem><para>No icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"HAND"</term>
<listitem><para>A hand icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"QUESTION"</term>
<listitem><para>A question mark icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"EXCLAMATION"</term>
<listitem><para>An exclamation point icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"ASTERISK"</term>
<listitem><para>An asterisk icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"INFORMATION"</term>
<listitem><para>An information icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"STOP"</term>
<listitem><para>A stop icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"QUERY"</term>
<listitem><para>A query icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"WARNING"</term>
<listitem><para>A warning icon is displayed.
</para></listitem></varlistentry>
<varlistentry><term>"ERROR"</term>
<listitem><para>An error icon is displayed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>RxMessageBox</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>RxMessageBox</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>RxMessageBox</secondary></indexterm>
<example id="ex.rxmessagebox">
<title>RexxUtil &mdash; RxMessageBox</title>
<programlisting>
/* Give option to quit        */
if RxMessageBox("Shall we continue", , "YesNo", "Question") = 7
Then Exit                          /* quit option given, exit    */
</programlisting>
</example>
</section>

<section id="utlRxwinexec"><title>RxWinExec (Windows only)</title>
<indexterm><primary>RxWinExec</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>RxWinExec</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/rxwinexec.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Starts (executes) the application as specified in
<emphasis role="italic">cmdline</emphasis>.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">cmdline</emphasis></term>
<listitem><para>A string containing a file name and optional parameters for the
application to be executed. If the name of the executable file in
<emphasis role="italic">cmdline</emphasis> does
not contain a directory path, RxWinExec searches for the executable file in
this sequence:
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The directory from which ooRexx was loaded.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>The current directory.
</para></listitem></varlistentry>
<varlistentry><term>3</term>
<listitem><para>The Windows system directory.
</para></listitem></varlistentry>
<varlistentry><term>4</term>
<listitem><para>The Windows directory.
</para></listitem></varlistentry>
<varlistentry><term>5</term>
<listitem><para>The directories listed in the PATH environment variable.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">cmdshow</emphasis></term>
<listitem><para>Specifies how a Windows-based application window is to be shown.
For a non-Windows-based application, the PIF file, if any, for the application
determines the window state.
<variablelist>
<varlistentry><term>SHOWNORMAL</term>
<listitem><para>Activates and displays a window.
</para></listitem></varlistentry>
<varlistentry><term>SHOWNOACTIVATE</term>
<listitem><para>Displays the window while the current active window remains
active.</para></listitem></varlistentry>
<varlistentry><term>SHOWMINNOACTIVE</term>
<listitem><para>Displays the window as a minimized window, the current active
window remains active.
</para></listitem></varlistentry>
<varlistentry><term>SHOWMINIMIZED</term>
<listitem><para>Activates the window and displays it as a minimized window.
</para></listitem></varlistentry>
<varlistentry><term>SHOWMAXIMIZED</term>
<listitem><para>Activates the window and displays it as a maximized window.
</para></listitem></varlistentry>
<varlistentry><term>HIDE</term>
<listitem><para>Hides the window and activates another window.
</para></listitem></varlistentry>
<varlistentry><term>MINIMIZE</term>
<listitem><para>Minimizes the specified window and activates the next top-level
window in the Z order.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<para>If the application is started successfully, the process id (PID) is
returned.  If an error occurs the returned value is less than 32.</para>
<para>Error return codes correspond to a
<xref linkend="systemerrorcodes" xrefstyle="template:Windows System Error code"/>. If the Windows system error code is greater
than 32 it is negated. This is to prevent confusion between a legitimate error
code and a PID.</para>
<para>Some common error returns for this function are as follows.</para>
<variablelist>
<varlistentry><term>2</term>
<listitem><para>The specified file was not found.
</para></listitem></varlistentry>
<varlistentry><term>3</term>
<listitem><para>The specified path was not found.
</para></listitem></varlistentry>
<varlistentry><term>11</term>
<listitem><para>The EXE file is invalid.
</para></listitem></varlistentry>
<varlistentry><term>-53</term>
<listitem><para>The network path is invalid.
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="utlSysaddrexxmacro"><title>SysAddRexxMacro</title>
<indexterm><primary>SysAddRexxMacro</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysAddRexxMacro</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysaddrexxmacro.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Adds a routine to the Rexx macrospace. SysAddRexxMacro returns the
RexxAddMacro return code.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">name</emphasis></term>
<listitem><para>The name of the function added to the macrospace.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">file</emphasis></term>
<listitem><para>The file containing the Rexx program.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">order</emphasis></term>
<listitem><para>The macrospace search order. The order can be "B" (Before), which is default, or
"A" (After).
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysbootdrive"><title>SysBootDrive (Windows only)</title>
<indexterm><primary>SysAddBootDrive</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysBootDrive</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysbootdrive.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the drive used to boot Windows, for example, "C:".</para>
</section>

<section id="utlSysclearrexxmacrospace"><title>SysClearRexxMacroSpace</title>
<indexterm><primary>SysClearRexxMacroSpace</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysClearRexxMacroSpace</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysclearrexxmacrospace.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Clears the Rexx macrospace. SysClearRexxMacroSpace returns the
RexxClearMacroSpace return code.</para>
</section>

<section id="utlSyscls"><title>SysCls</title>
<indexterm><primary>SysCls</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysCls</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syscls.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Clears the screen.</para>
<example id="ex.syscls">
<title>RexxUtil &mdash; SysCls</title>
<programlisting>
call SysCls
</programlisting>
</example>
</section>

<section id="utlSyscreatepipe"><title>SysCreatePipe (Unix only)</title>
<indexterm><primary>SysCreatePipe</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysCreatePipe</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syscreatepipe.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Creates an unnamed pipe.</para>
<para><emphasis role="bold">Returns:</emphasis></para>
<para>Returns a string like <computeroutput>"handle handle"</computeroutput>
where the first handle is for read and the second handle for write.</para>
</section>

<section id="utlSyscurpos"><title>SysCurPos (Windows only)</title>
<indexterm><primary>SysCurPos</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysCurPos</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syscurpos.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the cursor position in the form
<computeroutput>row col</computeroutput> and optionally
moves the cursor to a new location.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">row</emphasis></term>
<listitem><para>The row to move to.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">col</emphasis></term>
<listitem><para>The column to move to.
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title>
<para>Position (0,0) is the upper left corner.</para></note>
<para>You can call SysCurPos without a column and row position to obtain the
cursor position without moving the cursor.</para>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysCurPos</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysCurPos</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysCurPos</secondary></indexterm>
<example id="ex.syscurpos">
<title>RexxUtil &mdash; SysCurPos</title>
<programlisting>
say SysCurPos() -- (e. g.) 10 0
</programlisting>
</example>
</section>

<section id="utlSyscurstate"><title>SysCurState (Windows only)</title>
<indexterm><primary>SysCurState</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysCurState</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syscurstate.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Hides or displays the cursor.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">state</emphasis></term>
<listitem><para>The new cursor state. Allowed states are:
<variablelist>
<varlistentry><term>"ON"</term>
<listitem><para>Display the cursor
</para></listitem></varlistentry>
<varlistentry><term>"OFF"</term>
<listitem><para>Hide the cursor
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysdriveinfo"><title>SysDriveInfo (Windows only)</title>
<indexterm><primary>SysDriveInfo</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysDriveInfo</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysdriveinfo.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns drive information in the form
<literal>drive free total label</literal>, where
<literal>drive</literal> is the drive identifier,
<literal>free</literal> is the total number of unused bytes,
<literal>total</literal> is the total size in bytes, and
<literal>label</literal> is the volume label of the specified
<emphasis role="italic">drive</emphasis>.
Returns the null string if the drive is not accessible.
</para>
<para>If <emphasis role="italic">drive</emphasis> is omitted, the
current drive is used.
</para>

<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">drive</emphasis></term>
<listitem><para>A drive specification like <literal>d:\</literal> or
<literal>\\share\path</literal>.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysDriveInfo</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysDriveInfo</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysDriveInfo</secondary></indexterm>
<example id="ex.sysdriveinfo">
<title>RexxUtil &mdash; SysDriveInfo</title>
<programlisting>
say SysDriveInfo() -- e. g. C: 23989809152 254721126400 Windows
</programlisting>
</example>
</section>

<section id="utlSysdrivemap"><title>SysDriveMap (Windows only)</title>
<indexterm><primary>SysDriveMap</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysDriveMap</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysdrivemap.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a string listing accessible drives (separated by blanks) in the
form: <computeroutput>C:&nbsp;D:&nbsp;...</computeroutput>.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">drive</emphasis></term>
<listitem><para>The first drive letter of the drive map. The default is "C:".
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">opt</emphasis></term>
<listitem><para>The drivemap option.  This can be:
<variablelist>
<varlistentry><term>"USED"</term>
<listitem><para>returns the drives that are accessible or in use, including
all local and remote drives. This is the default.
</para></listitem></varlistentry>
<varlistentry><term>"FREE"</term>
<listitem><para>returns drives that are free or not in use.
</para></listitem></varlistentry>
<varlistentry><term>"LOCAL"</term>
<listitem><para>returns only local drives.
</para></listitem></varlistentry>
<varlistentry><term>"REMOTE"</term>
<listitem><para>returns only remote drives, such as redirected LAN resources
or installable file system (IFS) attached drives.
</para></listitem></varlistentry>
<varlistentry><term>"REMOVABLE"</term>
<listitem><para>returns removable drives.
</para></listitem></varlistentry>
<varlistentry><term>"CDROM"</term>
<listitem><para>returns CD-ROM drives.
</para></listitem></varlistentry>
<varlistentry><term>"RAMDISK"</term>
<listitem><para>returns drives assigned from RAM.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysDriveMap</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysDriveMap</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysDriveMap</secondary></indexterm>
<example id="ex.sysdrivemap">
<title>RexxUtil &mdash; SysDriveMap</title>
<programlisting>
say SysDriveMap("C:", "USED") -- C: M: N: O: P: R: Z:
</programlisting>
</example>
</section>

<section id="utlSysdroprexxmacro"><title>SysDropRexxMacro</title>
<indexterm><primary>SysDropRexxMacro</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysDropRexxMacro</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysdroprexxmacro.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Removes a routine from the Rexx macrospace. SysDropRexxMacro returns the
RexxDropMacro return code.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">name</emphasis></term>
<listitem><para>The name of the function removed from the macrospace.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysdumpvariables"><title>SysDumpVariables</title>
<indexterm><primary>SysDumpVariables</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysDumpVariables</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysdumpvariables.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Dumps all variables in the current scope either to the specified file
<emphasis role="italic">filename</emphasis> (new data is appended) or to
STDOUT if you omit <emphasis role="italic">filename</emphasis>. The format of
the data is, with one variable per line:</para>
<para><computeroutput>Name=MYVAR, Value='This is the content of MYVAR'</computeroutput>
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to which variables are appended. The dump is
written to STDOUT if you omit this parameter.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Dump completed successfully.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>Dump failed.
</para></listitem></varlistentry>
</variablelist>
<para>See also <classname>RexxContext</classname> method
<xref linkend="mthRexxContextVariables" xrefstyle="select:title"/>.
</para>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysDumpVariables</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysDumpVariables</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysDumpVariables</secondary></indexterm>
<example id="ex.sysdumpvariables">
<title>RexxUtil &mdash; SysDumpVariables</title>
<programlisting>
Call SysDumpVariables "MyVars.Lst" /* append vars to file */
Call SysDumpVariables              /* list vars on STDOUT */
</programlisting>
</example>
</section>

<section id="utlSysfilecopy"><title>SysFileCopy</title>
<indexterm><primary>SysFileCopy</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileCopy</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfilecopy.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Copies a file from one location to another. Wildcard file
specifications are not allowed.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">source</emphasis></term>
<listitem><para>The path/name of the file to be copied.
The <emphasis role="italic">source</emphasis> and the
<emphasis role="italic">target</emphasis> path &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">target</emphasis></term>
<listitem><para>The path/name of the target location where the file is to be
copied.</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>File copied successfully.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>A <xref linkend="systemerrorcodes" xrefstyle="template:Windows System Error code"/>.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileCopy</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysFileCopy</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysFileCopy</secondary></indexterm>
<example id="ex.sysfilecopy">
<title>RexxUtil &mdash; SysFileCopy</title>
<programlisting>
call SysFileCopy "c:\temp\myfile.txt", "d:\myfolder\myCopy.txt"
call SysFileCopy "/tmp/myfile.txt", "~/myCopy.txt"
</programlisting>
</example>
</section>

<section id="utlSysfiledelete"><title>SysFileDelete</title>
<indexterm><primary>SysFileDelete</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileDelete</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfiledelete.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Deletes a file.
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">file</emphasis></term>
<listitem><para>The name of the file to be deleted.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>File deleted successfully.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>An <xref linkend="systemerrorcodes" xrefstyle="template:operating system error code" />.
On Windows, this may be one of the following, but could be others.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>File not found.
</para></listitem></varlistentry>
<varlistentry><term>3</term>
<listitem><para>Path not found.
</para></listitem></varlistentry>
<varlistentry><term>5</term>
<listitem><para>Access denied or busy.
</para></listitem></varlistentry>
<varlistentry><term>26</term>
<listitem><para>Not DOS disk.
</para></listitem></varlistentry>
<varlistentry><term>32</term>
<listitem><para>Sharing violation.
</para></listitem></varlistentry>
<varlistentry><term>36</term>
<listitem><para>Sharing buffer exceeded.
</para></listitem></varlistentry>
<varlistentry><term>87</term>
<listitem><para>Does not exist.
</para></listitem></varlistentry>
<varlistentry><term>206</term>
<listitem><para>File name exceeds range error.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileDelete</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysFileDelete</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysFileDelete</secondary></indexterm>
<example id="ex.sysfiledelete">
<title>RexxUtil &mdash; SysFileDelete</title>
<programlisting>
parse arg InputFile OutputFile
call SysFileDelete OutputFile  -- unconditionally erase output file
</programlisting>
</example>
</section>

<section id="utlSysFileExists"><title>SysFileExists</title>
<indexterm><primary>SysFileExists</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileExists</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfileexists.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks for the existence of a file.
Returns <literal>1</literal> if any file system entity with the
given name exists.  In particular, this will return <literal>1</literal> for both regular
files and directories.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to check for the existence of.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file exists.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysfileexists">
<title>RexxUtil &mdash; SysFileExists</title>
<programlisting>
if SysFileExists(InputFile) then say "File Exists!"
else say "File does not exist."
</programlisting>
</example>
</section>

<section id="utlSysfilemove"><title>SysFileMove</title>
<indexterm><primary>SysFileMove</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileMove</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfilemove.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Moves a file from one location to another. Wildcard file
specifications are not allowed.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">source</emphasis></term>
<listitem><para>The path/name of the file to be moved.
The filename &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">target</emphasis></term>
<listitem><para>The path of the target location where the file is to be
moved.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>File copied successfully.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>An <xref linkend="systemerrorcodes" xrefstyle="template:operating system error code" />.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileMove</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysFileMove</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysFileMove</secondary></indexterm>
<example id="ex.sysfilemove">
<title>RexxUtil &mdash; SysFileMove</title>
<programlisting>
call SysFileMove "c:\temp\myfile.txt", "d:\myfolder\myCopy.txt"
call SysFileMove "/tmp/myfile.txt", "~/myCopy.txt"
</programlisting>
</example>
</section>

<section id="utlSysfilesearch"><title>SysFileSearch</title>
<indexterm><primary>SysFileSearch</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileSearch</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfilesearch.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a list of all file lines containing the target string.
</para>

<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">target</emphasis></term>
<listitem><para>The target search string.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">file</emphasis></term>
<listitem><para>The searched file.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">stemarray</emphasis></term>
<listitem><para>A Rexx stem or array variable for the returned lines.
If a stem variable, <emphasis role="italic">stem</emphasis><literal>.0</literal>
is set to <emphasis role="italic">n</emphasis>, the number of lines returned,
and the lines are returned in
<emphasis role="italic">stem</emphasis><literal>.1</literal> to
<emphasis role="italic">stem.n</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">options</emphasis></term>
<listitem><para>Any combination of the following one-character options:
<variablelist>
<varlistentry><term><literal>C</literal></term>
<listitem><para>Conducts a case-sensitive search.
</para></listitem></varlistentry>
<varlistentry><term><literal>I</literal></term>
<listitem><para>Conducts a case-insensitive search.
</para></listitem></varlistentry>
<varlistentry><term><literal>N</literal></term>
<listitem><para>Prepends file line numbers to any returned lines.
</para></listitem></varlistentry>
</variablelist>
The default is a case-insensitive search without line numbers.</para>
</listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Successful.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>Not enough memory.
</para></listitem></varlistentry>
<varlistentry><term>3</term>
<listitem><para>Error opening file.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileSearch</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysFileSearch</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysFileSearch</secondary></indexterm>
<example id="ex.sysfilesearch">
<title>RexxUtil &mdash; SysFileSearch</title>
<programlisting>
/* Find DEVICE statements in CONFIG.SYS */
call SysFileSearch "DEVICE", "C:\CONFIG.SYS", "file."
do i=1 to file.0
say file.i
end

/* Output */
DEVICE=C:\SB16\DRV\CTSB16.SYS /UNIT=0 /BLASTER=A:240 I:5 D:1 H:5
DEVICE=C:\SB16\DRV\CTMMSYS.SYS
rem ****    DOS SCSI CDROM device drivers ***
DEVICE=C:\SCSI\ASPI8DOS.SYS /D
DEVICE=C:\SCSI\ASPICD.SYS /D:ASPICD0
rem **** IDE CDROM device drivers
DEVICE=C:\DOS\HIMEM.SYS
DEVICE=C:\SBCD\DRV\SBIDE.SYS /V /D:MSCD001  /P:1f0,14
DEVICE=C:\DOS\SETVER.EXE
DEVICE=C:\WINDOWS\SMARTDRV.EXE /DOUBLE_BUFFER
DEVICE=C:\WINDOWS\IFSHLP.SYS

/* Find DEVICE statements in CONFIG.SYS (along with */
/* line numbers)                                    */
call SysFileSearch "DEVICE", "C:\CONFIG.SYS", "file.", "N"
do i=1 to file.0
say file.i
end

/* Output */
1 DEVICE=C:\SB16\DRV\CTSB16.SYS /UNIT=0 /BLASTER=A:240 I:5 D:1
H:5
2 DEVICE=C:\SB16\DRV\CTMMSYS.SYS
4 rem ****    DOS SCSI CDROM device drivers ***
5 DEVICE=C:\SCSI\ASPI8DOS.SYS /D
6 DEVICE=C:\SCSI\ASPICD.SYS /D:ASPICD0
8 rem **** IDE CDROM device drivers
9 DEVICE=C:\DOS\HIMEM.SYS
10 DEVICE=C:\SBCD\DRV\SBIDE.SYS /V /D:MSCD001  /P:1f0,14
13 DEVICE=C:\DOS\SETVER.EXE
16 DEVICE=C:\WINDOWS\SMARTDRV.EXE /DOUBLE_BUFFER
17 DEVICE=C:\WINDOWS\IFSHLP.SYS
</programlisting>
</example>
</section>

<section id="utlSysfilesystemtype"><title>SysFileSystemType (Windows only)</title>
<indexterm><primary>SysFileSystemType</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileSystemType</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfilesystemtype.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the type of file system (e. g. FAT or NTFS) used on a drive.
Returns the null string if the drive is not accessible.
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">drive</emphasis></term>
<listitem><para>A drive specification like <literal>d:\</literal> or
<literal>\\share\path</literal>.
If omitted, the current drive is used.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileSystemType</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysFileSystemType</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysFileSystemType</secondary></indexterm>
<example id="ex.sysfilesystemtype">
<title>RexxUtil &mdash; SysFileSystemType</title>
<programlisting>
say SysFileSystemType("C:\")    -- NTFS
</programlisting>
</example>
</section>

<section id="utlSysfiletree"><title>SysFileTree</title>
<indexterm><primary>SysFileTree</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFileTree</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfiletree.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a list of all files that match a file specification. SysFileTree can return
file information like date, time, size, attributes, and file name.
The default format for date and time is platform specific.</para>
<para>
  <emphasis role="italic">SysFileTree</emphasis> uses operating system APIs to find the files. The found files are
  placed in the returned list in the order they are found by the operating system.
  No specific order can be assumed.
</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filespec [required]</emphasis></term>
<listitem>
<para>
  The search pattern, the search file specification. This can not be the empty string.
</para>
<para>
  The search pattern can be a full or partial path with wildcard characters
  in the last part of the path
  information, e. g. <literal>*.bat</literal>, or <literal>../../*.sh</literal>,
  or <literal>c:\temp</literal>.
  Windows supports wildcard characters <literal>*</literal> and <literal>?</literal>,
  Unix-like systems additionally support character classes in <literal>[ ]</literal>
  brackets, including <emphasis role="italic">-</emphasis> for ranges and
  <literal>!</literal> for negation.
</para>
</listitem></varlistentry>

<varlistentry><term><emphasis role="italic">stemarray [required]</emphasis></term>
<listitem><para>A Rexx stem or array variable for the returned matches.
If a stem variable, <emphasis role="italic">stem</emphasis><literal>.0</literal>
is set to <emphasis role="italic">n</emphasis>, the number of matches returned,
and the matching files or directories are returned in
<emphasis role="italic">stem</emphasis><literal>.1</literal> to
<emphasis role="italic">stem.n</emphasis>.
</para></listitem></varlistentry>

<varlistentry><term><emphasis role="italic">options [optional]</emphasis></term>
<listitem><para>A string with any combination of the following.
If this argument is omitted, it defaults to <literal>B</literal>.
</para>
<variablelist>
<varlistentry><term><literal>B</literal></term>
<listitem><para>Search for both files and directories. This is the default.
</para></listitem></varlistentry>
<varlistentry><term><literal>D</literal></term>
<listitem><para>Search for directories only.
</para></listitem></varlistentry>
<varlistentry><term><literal>F</literal></term>
<listitem><para>Search for files only.
</para></listitem></varlistentry>
<varlistentry revisionflag="added"><term><literal>&added50;H</literal></term>
<listitem><para>Returns correct file sizes for files larger than 9999999999
bytes (approx. 10 GB).
Without this option, the maximum file size returned is 9999999999, even if the
file is larger than this.
</para></listitem></varlistentry>
<varlistentry><term><literal>I</literal></term>
<listitem><para>Perform a case-insensitive search for file names or directories.
This option is only used on system that support case-sensitive file names and
is ignored on systems like Windows where the file system is case-insensitive
by default.
</para></listitem></varlistentry>
<varlistentry><term><literal>L</literal></term>
<listitem><para>Returns the file date and time in the form <literal>YYYY-MM-DD HH:MM:SS</literal>.
</para></listitem></varlistentry>
<varlistentry><term><literal>O</literal></term>
<listitem><para>Returns only the fully-qualified file name.
</para></listitem></varlistentry>
<varlistentry><term><literal>S</literal></term>
<listitem><para>Search subdirectories recursively.
</para></listitem></varlistentry>
<varlistentry><term><literal>T</literal></term>
<listitem><para>Returns the file date and time in the form <literal>YY/MM/DD/HH/MM</literal>.
If the <literal>L</literal> option is also specified
then this option will be ignored.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>

<varlistentry><term><emphasis role="italic">tattrib [optional] [Windows only]</emphasis></term>
<listitem><para>The target attribute mask for file specification matches. Only
files that match the target mask are returned. The default mask is <literal>*****</literal>.
This returns all files regardless of the settings (clear or set) of the Archive,
Directory, Hidden, Read-Only, and System attributes. The target mask attributes
must appear in the order <literal>ADHRS</literal>. This argument is Windows only. It is allowed but ignored on Unix-like operating
systems.</para>
<para>Target Mask Options
</para>
<variablelist>
<varlistentry><term><literal>*</literal></term>
<listitem><para>The file attribute may be any state.
</para></listitem></varlistentry>
<varlistentry><term><literal>+</literal></term>
<listitem><para>The file attribute must be set.
</para></listitem></varlistentry>
<varlistentry><term><literal>-</literal></term>
<listitem><para>The file attribute must be cleared.
</para></listitem></varlistentry>
</variablelist>
<para>Target Mask Examples </para>
<variablelist>
<varlistentry><term><literal>***+*</literal></term>
<listitem><para>Find all files with the Read-Only attribute set.
</para></listitem></varlistentry>
<varlistentry><term><literal>+**+*</literal></term>
<listitem><para>Find all files with the Read-Only and Archive attributes set.
</para></listitem></varlistentry>
<varlistentry><term><literal>*++**</literal></term>
<listitem><para>Find all hidden subdirectories.
</para></listitem></varlistentry>
<varlistentry><term><literal>---+-</literal></term>
<listitem><para>Find all files with only the Read-Only attribute set.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>

<varlistentry><term><emphasis role="italic">nattrib [optional] [Windows only]</emphasis></term>
<listitem><para>The new attribute mask for setting the attributes of each
matching file. The default mask is <literal>*****</literal>. This means not to change the
Archive, Directory, Hidden, Read-Only, and System attributes. The target mask
attributes must appear in the order <literal>ADHRS</literal>. This argument is Windows only. It is allowed but ignored on Unix-like
operating systems.</para>
<para>New Attribute
Mask Options </para>
<variablelist>
<varlistentry><term><literal>*</literal></term>
<listitem><para>Do not change the file attribute.
</para></listitem></varlistentry>
<varlistentry><term><literal>+</literal></term>
<listitem><para>Set the file attribute.
</para></listitem></varlistentry>
<varlistentry><term><literal>-</literal></term>
<listitem><para>Clear the file attribute.
</para></listitem></varlistentry>
</variablelist>
<para>New Attribute Mask Examples</para>
<variablelist>
<varlistentry><term><literal>***+*</literal></term>
<listitem><para>Set the Read-Only attribute on all files.
</para></listitem></varlistentry>
<varlistentry><term><literal>-**+*</literal></term>
<listitem><para>Set the Read-Only attribute and clear the Archive attribute
of each file.</para></listitem></varlistentry>
<varlistentry><term><literal>+*+++</literal></term>
<listitem><para>Set all file attributes, except the directory attribute.
</para></listitem></varlistentry>
<varlistentry><term><literal>-----</literal></term>
<listitem><para>Clear all attributes on all files.

<note><title>Note</title>
<para>You cannot set the
directory attribute on non-directory files. SysFileTree
returns the file attribute settings after the new attribute mask has been
applied.</para></note>
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Successful.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>Not enough memory.
</para></listitem></varlistentry>
<varlistentry><term>other</term>
<listitem>
<para>
  On Windows, the return code may be any System Error Code returned by the operating system.
</para>
</listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary> <secondary>SysFileTree</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysFileTree</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysFileTree</secondary></indexterm>
<example id="ex.sysfiletree">
<title>RexxUtil &mdash; SysFileTree</title>
<programlisting>
/* Find all subdirectories on C: */
call SysFileTree "c:\*.*", "file", "SD"

/* Find all executable (.exe) files under Program Files*/
ret = SysFileTree('C:\Program Files\*.exe', f, 'FS')

/* Find all Read-Only files */
call SysFileTree "c:\*.*", "file", "S", "***+*"

/* Clear Archive and Read-Only attributes of files that have them set */
call SysFileTree "c:\*.*", "file", "S", "+**+*", "-**-*"

/****&lt;&lt; Sample Code and Output Example.>>********/

call SysFileTree "c:\win*", file., "b"
do i = 1 to file.0
  say file.i   -- 3/12/21   1:56p           0  -D---  c:\Windows
end
</programlisting>
</example>
</section>

<section id="utlSysfork"><title>SysFork (Unix only)</title>
<indexterm><primary>SysFork</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFork</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfork.svg" scale="55" />
</imageobject>
</mediaobject>

<para><emphasis role="bold">Returns</emphasis></para>
<para>Returns the process id to the parent process.</para>
<para>Returns <computeroutput>0</computeroutput> to the spawned process.</para>
<para><emphasis role="bold">Example:</emphasis></para>
<para>
This is a complete working example. It can be cut and pasted into a file and executed on a Unix system.
</para>
<example id="ex.sysfork">
<title>RexxUtil &mdash; SysFork</title>
<programlisting>
<![CDATA[

/* Example Unix SysFork() and SysWait() */

  pid = SysFork()

  if pid == 0 then do
    say "I am the child."
    code = executeChild()
    say "Child : done with execution, will exit with" code
    exit code
  end
  else do
    say 'I am the parent, child pid is:' pid
    code = executeParent()
    say 'Parent: going to wait for child.'
    code = SysWait()
    say 'Parent: back from waiting. Child exit code:' code
  end

  say 'Operating system version:' SysVersion()

::routine executeChild

    say 'Child : will sleep 1 second.'
    j = SysSleep(1)
    say 'Child : done sleeping 1. Will do some calculations.'

    total = 0
    do 786
      total += 3
    end
    say 'Child : 3 * 786 is:' total

    say 'Child : will sleep 2 seconds.'
    j = SysSleep(2)
    say 'Child : done sleeping 2. Will do some calculations.'

    total = 0
    do 1865
      total += 7
    end
    say 'Child : 7 * 1865 is:' total

    say 'Child : will sleep 2 seconds.'
    j = SysSleep(2)
    say 'Child : done sleeping 2.'
    say 'Child : done executing, will return 0.'
    return 0

::routine executeParent

    say 'Parent: 3 * 786 is:' (3 * 786)
    j = SysSleep(2)
    say 'Parent: 7 * 1865 is:' (7 * 1865)
    return 0
]]>
</programlisting>
</example>
</section>


<section id="utlSysformatmessage" revisionflag="added"><title>&added50;SysFormatMessage</title>
<indexterm><primary>SysFormatMessage</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFormatMessage</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysFormatMessage.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Formats and returns a message text, replacing placeholders
<literal>&amp;</literal><emphasis role="italic">n</emphasis> with
specified message inserts.
SysFormatMessage can replace up to nine placeholders.</para>
<variablelist>
<varlistentry><term><emphasis role="italic">message</emphasis></term>
<listitem><para>The message text.
This string may include up to nine placeholders <literal>&amp;1</literal>,
<literal>&amp;2</literal> &hellip; <literal>&amp;9</literal> in any order.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">substitutions</emphasis></term>
<listitem><para>Text inserts for message placeholders.
This can a be a single string, an Array of strings, or any other object
supporting a <methodname>makeArray</methodname> method.
The first array item is used to replace the <literal>&amp;1</literal> placeholder,
the second item replaces <literal>&amp;2</literal>, up to a maximum of nine items.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysformatmessage">
<title>RexxUtil &mdash; SysFormatMessage
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFormatMessage</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysFormatMessage</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysFormatMessage</secondary></indexterm>
</title>
<programlisting>
<![CDATA[
s = .Stream~new("xyzzy")
if \s~open("read")~startsWith("READY") then
  -- Cannot read file 'xyzzy': ERROR:2 No such file or directory
  say SysFormatMessage("Cannot read file '&1': &2", (s~string, s~description))
]]>
</programlisting>
</example>
</section>


<section id="utlSysfromunicode"><title>SysFromUnicode (Windows only)</title>
<indexterm><primary>SysFromUnicode</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysFromUnicode</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysfromunicode.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Maps a Unicode character string to an ASCII character string.  The new character
string and additional information is returned in the outstem.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">string</emphasis></term>
<listitem><para>A string containing the Unicode characters to be mapped.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">codepage</emphasis></term>
<listitem><para>Specifies the code page used to perform the conversion.
This parameter
can be the value of any code page that is installed or available in the system.
The default is the current original equipment manufacturer (OEM) code-page
identifier for the system.</para>
<para>You can also
specify one of the following values:</para>
<variablelist>
<varlistentry><term>ACP</term>
<listitem><para>ANSI code page.
</para></listitem></varlistentry>
<varlistentry><term>OEMCP</term>
<listitem><para>OEM code page.
</para></listitem></varlistentry>
<varlistentry><term>SYMBOL</term>
<listitem><para>symbol code page.
</para></listitem></varlistentry>
<varlistentry><term>THREAD_ACP
<indexterm><primary>thread</primary></indexterm>
</term>
<listitem><para>current thread's ANSI code page.
</para></listitem></varlistentry>
<varlistentry><term>UTF7</term>
<listitem><para>translate using UTF-7.
</para></listitem></varlistentry>
<varlistentry><term>UTF8</term>
<listitem><para>translate using UTF-8. When
this is set, <computeroutput>mappingflags</computeroutput> must be set.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term><emphasis role="italic">mappingflags</emphasis></term>
<listitem><para>Specifies the handling of unmapped characters. The function
performs more quickly when none of these flags is set.</para>
<para>The following flags can be
used:</para>
<variablelist>
<varlistentry><term>COMPOSITECHECK</term>
<listitem><para>Converts composite characters to precomposed characters.
</para></listitem></varlistentry>
<varlistentry><term>SEPCHARS</term>
<listitem><para>Generates separate characters during conversion. This is the
default conversion behavior.
</para></listitem></varlistentry>
<varlistentry><term>DISCARDNS</term>
<listitem><para>Discards nonspacing characters during conversion.
</para></listitem></varlistentry>
<varlistentry><term>DEFAULTCHAR</term>
<listitem><para>Replaces non-convertible characters with the default character
during conversion.
</para></listitem></varlistentry>
</variablelist>
<para>When <computeroutput>compositecheck</computeroutput> is specified,
the function converts composite characters to precomposed characters.
A composite character consists of a base character and a nonspacing character,
each having different character
values. A precomposed character has a single character value for a combination
of a base and a nonspacing character. In the character &egrave;, the "e" is the
base character, and the "grave" accent mark is the nonspacing character.</para>
<para>When <computeroutput>compositecheck</computeroutput> is specified, it can
use the last three flags in this list
(<computeroutput>discardns, sepchars</computeroutput>, and
<computeroutput>defaultchar</computeroutput>)
to customize the conversion to precomposed characters. These flags determine
the function's behavior when there is no precomposed mapping for a combination
of a base and a nonspace character in a Unicode character string. These last
three flags can be used only if the
<computeroutput>compositecheck</computeroutput> flag is set.
The function's default behavior is to generate separate characters
(<computeroutput>sepchars</computeroutput>) for unmapped composite characters.
</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="italic">defaultchar</emphasis></term>
<listitem><para>Character to be used if a Unicode character cannot be
represented in the specified code page. If this parameter is NULL, a
system default value is used. The function is faster when
<computeroutput>defaultchar</computeroutput> is not used.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">outstem</emphasis></term>
<listitem><para>The name of the stem variable that will contain the converted
result. If the conversion was successful the stem will be composed of
the following value(s):
</para>
<variablelist>
<varlistentry><term>outstem.!USEDDEFAULTchar</term>
<listitem><para>This variable will be set to "1" if the
<emphasis role="italic">defaultchar</emphasis> was used
during the conversion and "0" if it was not.</para></listitem></varlistentry>
<varlistentry><term>outstem.!TEXT</term>
<listitem><para>This variable will contain the converted string.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No errors.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>An <xref linkend="systemerrorcodes" xrefstyle="template:operating system error code" />.
On Windows, this may be one of the following, but could be others.
</para></listitem></varlistentry>
<varlistentry><term>87</term>
<listitem><para>Incorrect code page or
<computeroutput>codepage</computeroutput> value.
</para></listitem></varlistentry>
<varlistentry><term>1004</term>
<listitem><para>Invalid mapping flags.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysgeterrortext"><title>SysGetErrorText</title>
<indexterm><primary>SysGetErrorText</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetErrorText</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysgeterrortext.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Obtains a string describing the system error identified by the error
number.</para>
<para>Returns a string with the description of the error, or an empty string
if no description is available.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">errornumber</emphasis></term>
<listitem><para>The error number for which a description is to be retrieved.
Note that both the error number and the descriptive text are operating-system
specific.
</para></listitem></varlistentry>
</variablelist>

<para>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetErrorText</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysGetErrorText</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysGetErrorText</secondary></indexterm>
<example id="ex.sysgeterrortext-1">
<title>RexxUtil &mdash; SysGetErrorText</title>
<programlisting>
-- Windows: Cannot create a file when that file already exists.
say SysGetErrorText(SysMkDir("\Users"))

-- Unix: File exists
say SysGetErrorText(SysMkDir("/usr"))
</programlisting>
</example>
</para>
</section>

<section id="utlSysgetfiledatetime"><title>SysGetFileDateTime</title>
<indexterm><primary>SysGetFileDateTime</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetFileDateTime</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysgetfiledatetime.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a file timestamp.
</para>
<para><emphasis role="bold">Parameters</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of a file or directory for which a timestamp
should be returned.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">timesel</emphasis></term>
<listitem><para>An optional selector specifying the type of timestamp
to be returned.
Depending on the operating system and the file system, one of the
following timestamps may be selected (only the first letter is required):
<variablelist>
  <varlistentry>
    <term><literal>ACCESS</literal></term>
    <listitem><para>The date and time when the file was last accessed.
    Not available on FAT file systems.
    </para></listitem>
  </varlistentry>
  <varlistentry>
    <term><literal>CREATE</literal></term>
    <listitem><para>The creation date and time.
    Not available on Unix-like systems or on FAT file systems.
    </para></listitem>
  </varlistentry>
  <varlistentry>
    <term><literal>WRITE</literal></term>
    <listitem><para>The date and time the file was last modified.
    This is the default if <emphasis role="italic">timesel</emphasis>
    is omitted.
    </para></listitem>
  </varlistentry>
</variablelist>
</para></listitem>
</varlistentry>

</variablelist>

<para><emphasis role="bold">Returns</emphasis>
</para>
<para>The file timestamp in the format <literal>yyyy-mm-dd hh:mm:ss</literal>,
or <literal>-1</literal> to indicate that the timestamp is unavailable
or could not be retrieved.
</para>
<para>See also <classname>File</classname> methods
<xref linkend="mthFileLastAccessed" xrefstyle="select:title"/> and
<xref linkend="mthFileLastModified" xrefstyle="select:title"/>, and
Rexxutil <xref linkend="utlSyssetfiledatetime" xrefstyle="select:title"/>.
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetFileDateTime</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysGetFileDateTime</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysGetFileDateTime</secondary></indexterm>
</para>
<example id="ex.sysgetfiledatetime">
<title>RexxUtil &mdash; SysGetFileDateTime</title>
<programlisting>
say SysGetFileDateTime(".")           -- (e. g.) 2020-04-01 17:45:20
say SysGetFileDateTime("main.c", "w") -- (e. g.) 2020-02-11 05:00:00
</programlisting>
</example>
</section>

<section id="utlSysgetkey"><title>SysGetKey</title>
<indexterm><primary>SysGetKey</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetKey</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysgetkey.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Reads and returns the next key from the keyboard buffer. If the keyboard
buffer is empty, SysGetKey waits until a key is pressed. Unlike the CHARIN
built-in function, SysGetKey does not wait until the Enter key is pressed.
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">opt</emphasis></term>
<listitem><para>An option controlling screen echoing. Allowed values are:
<variablelist>
<varlistentry><term>"ECHO"</term>
<listitem><para>Echo the pressed key to the screen. This is the default.
</para></listitem></varlistentry>
<varlistentry><term>"NOECHO"</term>
<listitem><para>Do not echo the pressed key.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="utlSysgetlongpathname" revisionflag="added"><title>&added50;SysGetLongPathName (Windows only)</title>
<indexterm><primary>SysGetLongPathNamey</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetLongPathName</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysgetlongpathname.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the long version of the specified <emphasis role="italic">path</emphasis>.
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">path</emphasis></term>
<listitem><para>A relative or a fully qualified path of an existing file or directory.
</para></listitem></varlistentry>
</variablelist>

<para><emphasis role="bold">Returns:</emphasis></para>
<para>The long version of <emphasis role="italic">path</emphasis>, or
the null string, if <emphasis role="italic">path</emphasis> doesn't exist or
the call to the Windows API <methodname>GetLongPathName</methodname> fails for
any other reason.

<indexterm><primary>rexxutil functions</primary><secondary>SysGetLongPathName</secondary><tertiary>example</tertiary></indexterm>
<indexterm><primary>SysGetLongPathName</primary><secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary><secondary>SysGetLongPathName</secondary></indexterm>
<example id="ex.sysgetlongpathname">
<title>RexxUtil &mdash; SysGetLongPathName</title>
<programlisting>
say SysGetLongPathName("C:\progra~1")            -- C:\Program Files
say SysGetLongPathName("\windows\explorer.exe")  -- \Windows\explorer.exe
</programlisting>
</example>
</para>

</section>


<section id="utlSysgetmessage" revisionflag="changed"><title>&changed50;SysGetMessage (Unix only)</title>
<indexterm><primary>SysGetMessage</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetMessage</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysgetmessage.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a message retrieved from a Unix message catalog,
with placeholders replaced with specified message inserts.
</para>
<para>SysGetMessage is implemented on Unix-like systems only.
It always retrieves messages from the catalog's message set 1.
To retrieve messages from a specified message set, use
<xref linkend="utlSysgetmessagex" xrefstyle="select:title"/>.
</para>
<para>To create a Unix message catalog use the
<literal>gencat</literal> command.
</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">num</emphasis></term>
<listitem><para>The message number.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the catalog file containing the message.
If <emphasis role="italic">filename</emphasis> is omitted or specified as
<literal>rexx.cat</literal> the internal Rexx message catalog is searched.
Otherwise the Unix message catalog is located using the absolute
<emphasis role="italic">filename</emphasis> path or
searched along the <literal>NLSPATH</literal> environment variable.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">str</emphasis></term>
<listitem><para>Zero to nine replacement strings for placeholders
in the message.
The first replacement string is for placeholder <literal>&amp;1</literal>,
the second for <literal>&amp;2</literal>, up to placeholder
<literal>&amp;9</literal>.
If a placeholder has no replacement string specified, it is replaced by
the null string.
Any unused replacement string is ignored.
Other placeholders like <literal>%s</literal> are not replaced and are
returned unchanged with the message.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetMessage</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysGetMessage</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysGetMessage</secondary></indexterm>
<example id="ex.sysgetmessage">
<title>RexxUtil &mdash; SysGetMessage</title>
<programlisting>
<![CDATA[
say SysGetMessage(485, "rexx.cat", "foo") -- Class "foo" not found.
]]>
</programlisting>
</example>
</section>


<section id="utlSysgetmessagex" revisionflag="changed"><title>&changed50;SysGetMessageX (Unix only)</title>
<indexterm><primary>SysGetMessageX</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetMessageX</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysgetmessagex.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a message retrieved from a Unix message catalog,
with placeholders replaced with specified message inserts.
</para>
<para>SysGetMessageX is implemented on Unix-like systems only.
</para>
<para>To create a Unix message catalog use the
<literal>gencat</literal> command.
</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">set</emphasis></term>
<listitem><para>The message set.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">num</emphasis></term>
<listitem><para>The message number.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the catalog file containing the message.
If <emphasis role="italic">filename</emphasis> is omitted or specified as
<literal>rexx.cat</literal> the internal Rexx message catalog is searched.
Otherwise the Unix message catalog is located using the absolute
<emphasis role="italic">filename</emphasis> path or
searched along the <literal>NLSPATH</literal> environment variable.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">str</emphasis></term>
<listitem><para>Zero to nine replacement strings for placeholders
in the message.
The first replacement string is for placeholder <literal>&amp;1</literal>,
the second for <literal>&amp;2</literal>, up to placeholder
<literal>&amp;9</literal>.
If a placeholder has no replacement string specified, it is replaced by
the null string.
Any unused replacement string is ignored.
Other placeholders like <literal>%s</literal> are not replaced and are
returned unchanged with the message.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetMessageX</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysGetMessageX</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysGetMessageX</secondary></indexterm>
<example id="ex.sysgetmessagex">
<title>RexxUtil &mdash; SysGetMessageX</title>
<programlisting>
<![CDATA[
say SysGetMessageX(1, 485, "rexx.cat", "foo") -- Class "foo" not found.
]]>
</programlisting>
</example>
</section>


<section id="utlSysgetshortpathname" revisionflag="added"><title>&added50;SysGetShortPathName (Windows only)</title>
<indexterm><primary>SysGetShortPathNamey</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysGetShortPathName</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysgetshortpathname.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the short version of the specified <emphasis role="italic">path</emphasis>.
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">path</emphasis></term>
<listitem><para>A relative or a fully qualified path of an existing file or directory.
</para></listitem></varlistentry>
</variablelist>

<para><emphasis role="bold">Returns:</emphasis></para>
<para>The short version of <emphasis role="italic">path</emphasis>, or
the null string, if <emphasis role="italic">path</emphasis> doesn't exist or
the call to the Windows API <methodname>GetShortPathName</methodname> fails for
any other reason.

<indexterm><primary>rexxutil functions</primary><secondary>SysGetShortPathName</secondary><tertiary>example</tertiary></indexterm>
<indexterm><primary>SysGetShortPathName</primary><secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary><secondary>SysGetShortPathName</secondary></indexterm>
<example id="ex.sysgetshortpathname">
<title>RexxUtil &mdash; SysGetShortPathName</title>
<programlisting>
say SysGetShortPathName("C:\Program Files")       -- C:\PROGRA~1
say SysGetShortPathName("\windows\explorer.exe")  -- \windows\explorer.exe
</programlisting>
</example>
</para>

</section>


<section id="utlSysini"><title>SysIni (Windows only)</title>
<indexterm><primary>SysIni</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIni</secondary></indexterm>

<para>Allows limited access to INI file variables. Variables are stored in the
INI file under Application Names and their associated key names or keywords.
You can use SysIni to share variables between applications or as a way of
implementing GLOBALV in the Windows operating system. Be careful when
changing application profile information.</para>

<note><title>Note</title>
<para>SysIni works on all types of data stored in an INI file (text,
numeric, or binary).</para></note>
<para>When SysIni successfully sets or deletes key values, it returns "".
For a successful query, it returns the value of the specified application
keyword.</para>
<para>SysIni may return the string <computeroutput>ERROR:</computeroutput>
when an error occurs. Possible error conditions include:</para>
<itemizedlist>
<listitem><para>An attempt was made to query or delete an application/key pair
that does not exist.</para></listitem>
<listitem><para>An error opening the profile file occurred. You may have
specified the current user or system INI file with a relative file
specification. Make sure to use the full file specification
(specify drive, path, and file name).</para></listitem>
</itemizedlist>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">inifile</emphasis></term>
<listitem><para>The name of the INI file with which you would like to work. The
default is WIN.INI.
<note><title>Note</title>
<para>If this argument does not contain a fully qualified file name, the Windows
operating system searches for the file in the Windows directory.  Therefore to
work with a file outside of the Windows directory, specify the full path name of
the file.
</para></note>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">app</emphasis></term>
<listitem><para>The application name or some other meaningful value with which
you want to store keywords (some sort of data).
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">key</emphasis></term>
<listitem><para>The name of a keyword to hold data.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">val</emphasis></term>
<listitem><para>The value to associate with the keyword of the specified
application. This can be <computeroutput>"DELETE:"</computeroutput> or
<computeroutput>"ALL:"</computeroutput>.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">stemarray</emphasis></term>
<listitem><para>A Rexx stem or array variable for the returned names.
If a stem variable, <emphasis role="italic">stem</emphasis><literal>.0</literal>
is set to <emphasis role="italic">n</emphasis>, the number of names returned,
and the names are returned in
<emphasis role="italic">stem</emphasis><literal>.1</literal> to
<emphasis role="italic">stem.n</emphasis>.
</para></listitem></varlistentry>
</variablelist>
<para>SysIni has six modes. The modes and the syntax variations are as follows:
</para>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysini1.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Sets a single key value.</para>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysini2.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Queries a single key value.</para>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysini3.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Deletes a single key.</para>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysini4.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Deletes an application and all associated keys.</para>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysini5.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Queries names of all keys associated with a certain application.</para>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysini6.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Queries the names of all applications.</para>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIni</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysIni</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysIni</secondary></indexterm>
<example id="ex.sysini-1">
<title>RexxUtil &mdash; SysIni</title>
<programlisting>
/***  Save the user entered name under the key "NAME" of *****
****  the application "MYAPP".                           ****/
pull name .
call SysIni , "MYAPP", "NAME", name /* Save the value        */
say  SysIni(, "MYAPP", "NAME")      /* Query the value       */
call SysIni , "MYAPP"               /* Delete all MYAPP info */
exit
</programlisting>
</example>
<example id="ex.sysini-2">
<title>RexxUtil &mdash; SysIni</title>
<programlisting>
/****  Type all WIN.INI file information to the screen  *****/
call SysIni "WIN.INI", "All:", "Apps."
if Result \= "ERROR:" then
do i = 1 to Apps.0
call SysIni "WIN.INI", Apps.i, "All:", "Keys"
if Result \= "ERROR:" then
do j=1 to Keys.0
val = SysIni("WIN.INI", Apps.i, Keys.j)
say left(Apps.i, 20) left(Keys.j, 20),
"Len=x"Left(d2x(length(val)),4) left(val, 20)
end
end
exit
</programlisting>
</example>
</section>

<section id="utlSysisfile"><title>SysIsFile</title>
<indexterm><primary>SysIsFile</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFile</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfile.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks for the existence of a file.
</para>
<para>On Linux/Unix block devices are also considered to be regular files
by this function.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to check for the existence of.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file exists.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfile">
<title>RexxUtil &mdash; SysIsFile</title>
<programlisting>
if SysIsFile(InputFile) then say "File Exists!"
else say "File does not exist."
</programlisting>
</example>
</section>

<section id="utlSysisfilecompressed"><title>SysIsFileCompressed (Windows only)</title>
<indexterm><primary>SysIsFileCompressed</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileCompressed</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfilecompressed.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks if a file is compressed. This function does not support
wildcard specifications.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to check.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file is not compressed or does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file is compressed.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfilecompressed">
<title>RexxUtil &mdash; SysIsFileCompressed</title>
<programlisting>
if SysIsFileCompressed(InputFile) then say "File is compressed!"
else say "File is not compressed or does not exist."
</programlisting>
</example>
</section>

<section id="utlSysisfiledirectory"><title>SysIsFileDirectory</title>
<indexterm><primary>SysIsFileDirectory</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileDirectory</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfiledirectory.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks for the existence of a subdirectory.
</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">dirname</emphasis></term>
<listitem><para>The name of the subdirectory to check for the existence of.
The directory name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The subdirectory does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The subdirectory exists.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfiledirectory">
<title>RexxUtil &mdash; SysIsFileDirectory</title>
<programlisting>
if SysIsFileDirectory(InputFile) then say "Subdirectory Exists!"
else say "Subdirectory does not exist."
</programlisting>
</example>
</section>

<section id="utlSysisfileencrypted"><title>SysIsFileEncrypted (Windows only)</title>
<indexterm><primary>SysIsFileEncrypted</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileEncrypted</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfileencrypted.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks if a file is encrypted. This function does not support
wildcard specifications.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to check.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file is not encrypted or does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file is encrypted.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfileencrypted">
<title>RexxUtil &mdash; SysIsFileEncrypted</title>
<programlisting>
if SysIsFileEncrypted(InputFile) then say "File is encrypted!"
else say "File is not encrypted or does not exist."
</programlisting>
</example>
</section>

<section id="utlSysisfilelink"><title>SysIsFileLink</title>
<indexterm><primary>SysIsFileLink</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileLink</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfilelink.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks for the existence of a link.
</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">linkname</emphasis></term>
<listitem><para>The name of the link to check for the existence of.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The link does not exist or it is not a link.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The link exists.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfilelink">
<title>RexxUtil &mdash; SysIsFileLink</title>
<programlisting>
if SysIsFileLink(InputFile) then say "Link Exists!"
else say "Link does not exist."
</programlisting>
</example>
</section>

<section id="utlSysisfilenotcontentindexed">
<title>SysIsFileNotContentIndexed (Windows only)</title>
<indexterm><primary>SysIsFileNotContentIndexed</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileNotContentIndexed</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfilenotcontentindexed.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks if a file is flagged to be indexed by the Index Service.
This function does not support wildcard specifications.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to check.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file is not flagged to be Indexed or does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file is flagged to be Indexed.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfilenotcontentindexed">
<title>RexxUtil &mdash; SysIsFileNotContentIndexed</title>
<programlisting>
if SysIsFileNotContentIndexed(InputFile) then say "File is flagged to be Indexed!"
else say "File is not flagged to be Indexed."
</programlisting>
</example>
</section>

<section id="utlSysisfileoffline"><title>SysIsFileOffline (Windows only)</title>
<indexterm><primary>SysIsFileOffline</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileOffline</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfileoffline.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks if a file is flagged as Offline.
This function does not support wildcard specifications.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to check.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file is not flagged as Offline or does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file is flagged as Offline.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfileoffline">
<title>RexxUtil &mdash; SysIsFileOffline</title>
<programlisting>
if SysIsFileOffline(InputFile) then say "File is flagged as Offline!"
else say "File is not flagged as Offline."
</programlisting>
</example>
</section>

<section id="utlSysisfilesparse"><title>SysIsFileSparse (Windows only)</title>
<indexterm><primary>SysIsFileSparse</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileSparse</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfilesparse.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks if a file is flagged as Sparse.
This function does not support wildcard specifications.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file, subdirectory or link to check.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file is not flagged as Sparse or does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file is flagged as Sparse.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfilesparse">
<title>RexxUtil &mdash; SysIsFileSparse</title>
<programlisting>
if SysIsFileSparse(InputFile) then say "File is Sparse!"
else say "File is not Sparse."
</programlisting>
</example>
</section>

<section id="utlSysisfiletemporary"><title>SysIsFileTemporary (Windows only)</title>
<indexterm><primary>SysIsFileTemporary</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysIsFileTemporary</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysisfiletemporary.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Checks if a file is flagged as Temporary.
This function does not support wildcard specifications.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file, subdirectory or link to check.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Returns:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file is not flagged as Temporary or does not exist.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The file is flagged as Temporary.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.sysisfiletemporary">
<title>RexxUtil &mdash; SysIsFileTemporary</title>
<programlisting>
if SysIsFileTemporary(InputFile) then say "File is Temporary!"
else say "File is not Temporary."
</programlisting>
</example>
</section>

<section id="utlSyslinver"><title>SysLinVer (Linux Only)</title>
<indexterm><primary>SysLinVer</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysLinVer</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syslinver.svg" scale="55" />
</imageobject>
</mediaobject>

<para>
  Returns a string identifying the Linux system version.
  The first word of the returned string is <literal>Linux</literal>
  and the remaining part of the string identifies the version.
  Rexx code should not rely on the exact format returned.
</para>
<para>Possible output might be:
<example id="ex.syslinver">
<title>RexxUtil &mdash; SysLinVer</title>
<programlisting>
-- CentOS 7
say SysVersion() -- Linux 3.10.0-957.10.1.el7.x86_64
-- Ubuntu 16.04
say SysVersion() -- Linux 4.4.0-154-generic
-- Raspbian
say SysVersion() -- Linux 4.14.70-v7+
-- SLES/390
say SysVersion() -- Linux 3.12.74-60.64.40-default
</programlisting>
</example>
</para>
<para>See also functions
<xref linkend="utlSysversion" xrefstyle="select:title"/> and
<xref linkend="utlSyswinver" xrefstyle="select:title"/>.
</para>
</section>


<section id="utlSysloadrexxmacrospace"><title>SysLoadRexxMacroSpace</title>
<indexterm><primary>SysLoadRexxMacroSpace</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysLoadRexxMacroSpace</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysloadrexxmacrospace.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Loads functions from a saved macrospace file. SysLoadRexxMacroSpace
returns the RexxLoadMacroSpace return code.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">file</emphasis></term>
<listitem><para>The file used to load functions into the Rexx macrospace.
SysSaveRexxMacroSpace must have created the file.
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="utlSysmkdir"><title>SysMkDir</title>
<indexterm><primary>SysMkDir</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysMkDir</secondary></indexterm>

<para><emphasis role="bold">Windows:</emphasis></para>
<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysmkdir.svg" scale="55" />
</imageobject>
</mediaobject>

<para><emphasis role="bold">Unix:</emphasis></para>
<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysmkdir_unix.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Creates the specified directory.
This function will only create the final directory in the path,
all intermediate directories must already exist.
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">dirspec</emphasis></term>
<listitem><para>The directory to be created.
The directory name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">mode</emphasis> (Unix only)</term>
<listitem><para>The file permission bits of the new directory as a decimal
number between 0 (octal 000) and 511 (octal 777).
If not specified, <emphasis role="italic">mode</emphasis> defaults to 511
(octal 777).
</para>
<para>Any mode restrictions specified by <command>umask</command>
will always be taken into account.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Directory creation was successful.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>An <xref linkend="systemerrorcodes" xrefstyle="template:operating system error code" />.
On Windows, this may be one of the following, but could be others.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>File not found.
</para></listitem></varlistentry>
<varlistentry><term>3</term>
<listitem><para>Path not found.
</para></listitem></varlistentry>
<varlistentry><term>5</term>
<listitem><para>Access denied.
</para></listitem></varlistentry>
<varlistentry><term>26</term>
<listitem><para>Not a DOS disk.
</para></listitem></varlistentry>
<varlistentry><term>87</term>
<listitem><para>Invalid parameter.
</para></listitem></varlistentry>
<varlistentry><term>108</term>
<listitem><para>Drive locked.
</para></listitem></varlistentry>
<varlistentry><term>183</term>
<listitem><para>Directory already exists.
</para></listitem></varlistentry>
<varlistentry><term>206</term>
<listitem><para>File name exceeds range.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysMkDir</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysMkDir</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysMkDir</secondary></indexterm>
<example id="ex.sysmkdir">
<title>RexxUtil &mdash; SysMkDir</title>
<programlisting>
call SysMkDir "backup"
</programlisting>
</example>
</section>

<section id="utlSysqueryprocess"><title>SysQueryProcess</title>
<indexterm><primary>SysQueryProcess</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysQueryProcess</secondary></indexterm>
<para><emphasis role="bold">Windows</emphasis></para>
<indexterm><primary>thread</primary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysqueryprocess1.svg" scale="55" />
</imageobject>
</mediaobject>

<para><emphasis role="bold">Unix</emphasis></para>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysqueryprocess2.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Retrieves information about the current
process or Windows thread.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">info</emphasis></term>
<listitem><para>The kind of information requested:
<variablelist>
<varlistentry><term>PID</term>
<listitem><para>Returns the process ID of the current process.
</para></listitem></varlistentry>
<varlistentry><term>PPID</term>
<listitem><para>Returns the parent process ID of the current process.
</para></listitem></varlistentry>
<varlistentry><term>TID</term>
<listitem><para>Returns the thread ID of the current thread.
</para></listitem></varlistentry>
<varlistentry><term>PPRIO</term>
<listitem><para>Returns the priority class of the current process.
</para></listitem></varlistentry>
<varlistentry><term>TPRIO</term>
<listitem><para>Returns the relative priority of the current thread.
</para></listitem></varlistentry>
<varlistentry><term>PTIME</term>
<listitem><para>Returns time information on the current process.
</para></listitem></varlistentry>
<varlistentry><term>TTIME</term>
<listitem><para>Returns time information on the current thread.
</para></listitem></varlistentry>
<varlistentry><term>PMEM</term>
<listitem><para>Returns the maximum memory (RSS) used by the current
process.</para></listitem></varlistentry>
<varlistentry><term>PRCVDSIG</term>
<listitem><para>Returns the number of signals that have been received by
the process.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<itemizedlist>
<listitem><para>For PID, PPID or TID: an ID</para></listitem>
<listitem><para>For Windows PPRIO: &quot;IDLE&quot;, &quot;NORMAL&quot;,
&quot;HIGH&quot;, &quot;REALTIME&quot;,
or &quot;UNKNOWN&quot;</para></listitem>
<listitem><para>For Unix PPRIO: a number from -20 to +20.
</para></listitem>
<listitem><para>For TPRIO: &quot;IDLE&quot;, &quot;LOWEST&quot;,
&quot;BELOW_NORMAL&quot;, &quot;NORMAL&quot;, &quot;ABOVE_NORMAL&quot;,
&quot;HIGHEST&quot;, &quot;TIME_CRITICAL&quot;,
or &quot;UNKNOWN&quot;</para></listitem>
<listitem><para>For Windows PTIME or TTIME: the creation date and time, the
amount of time that the process executed in kernel mode, and the amount of time
that the process executed in user mode</para></listitem>
<listitem><para>For Unix PTIME: the summary and the duration that the process
executed in kernel mode, and the duration that the process executed in
user mode</para></listitem></itemizedlist>
</section>

<section id="utlSysqueryrexxmacro"><title>SysQueryRexxMacro</title>
<indexterm><primary>SysQueryRexxMacro</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysQueryRexxMacro</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysqueryrexxmacro.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Queries the existence of a macrospace function. SysQueryRexxMacro returns
the placement order of the macrospace function or a null string (&quot;&quot;)
if the function does not exist in the macrospace.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">name</emphasis></term>
<listitem><para>The name of a function in the Rexx macrospace.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysreorderrexxmacro"><title>SysReorderRexxMacro</title>
<indexterm><primary>SysReorderRexxmacro</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysReorderRexxMacro</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysreorderrexxmacro.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Reorders a routine loaded in the Rexx macrospace. SysReorderRexxMacro
returns the RexxReorderMacro return code.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">name</emphasis></term>
<listitem><para>The name of a function in the macrospace.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">order</emphasis></term>
<listitem><para>The new macro search order. The order can be "B" (Before) or "A"
(After).
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysrmdir"><title>SysRmDir</title>
<indexterm><primary>SysRmDir</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysRmDir</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysrmdir.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Deletes a specified file directory without your confirmation. </para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">dirspec</emphasis></term>
<listitem><para>The directory that should be deleted.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Directory removal was successful.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>An <xref linkend="systemerrorcodes" xrefstyle="template:operating system error code" />.
On Windows, this may be one of the following, but could be others.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>File not found.
</para></listitem></varlistentry>
<varlistentry><term>3</term>
<listitem><para>Path not found.
</para></listitem></varlistentry>
<varlistentry><term>5</term>
<listitem><para>Access denied or busy.
</para></listitem></varlistentry>
<varlistentry><term>16</term>
<listitem><para>Current directory.
</para></listitem></varlistentry>
<varlistentry><term>26</term>
<listitem><para>Not a DOS disk.
</para></listitem></varlistentry>
<varlistentry><term>32</term>
<listitem><para>Sharing violation.
</para></listitem></varlistentry>
<varlistentry><term>108</term>
<listitem><para>Drive locked.
</para></listitem></varlistentry>
<varlistentry><term>123</term>
<listitem><para>Invalid name.
</para></listitem></varlistentry>
<varlistentry><term>145</term>
<listitem><para>Directory not empty.
</para></listitem></varlistentry>
<varlistentry><term>146</term>
<listitem><para>Is Subst Path.
</para></listitem></varlistentry>
<varlistentry><term>147</term>
<listitem><para>Is Join Path.
</para></listitem></varlistentry>
<varlistentry><term>206</term>
<listitem><para>File name exceeds range.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysRmDir</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysRmDir</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysRmDir</secondary></indexterm>
<example id="ex.sysrmkdir">
<title>RexxUtil &mdash; SysRmDir</title>
<programlisting>
call SysRmDir "backup"
</programlisting>
</example>
</section>

<section id="utlSyssaverexxmacrospace"><title>SysSaveRexxMacroSpace</title>
<indexterm><primary>SysSaveRexxMacroSpace</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSaveRexxMacroSpace</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syssaverexxmacrospace.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Saves the Rexx macrospace. SysSaveRexxMacroSpace returns the RexxSaveMacroSpace
return code.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">file</emphasis></term>
<listitem><para>The file used to save the functions in the Rexx macrospace.
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="utlSyssearchpath"><title>SysSearchPath</title>
<indexterm><primary>SysSearchPath</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSearchPath</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syssearchpath.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the absolute path of
<emphasis role="italic">filename</emphasis> if it can be found along any
of the paths specified in environment variable
<emphasis role="italic">path</emphasis>.
Returns the null string otherwise.
</para>
<para><emphasis role="bold">Parameters</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">path</emphasis></term>
<listitem><para>An environment variable name. The environment variable
must contain a list of paths, like in <literal>PATH</literal>.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of the file to be searched.
The name can optionally include a relative or an absolute path, but the
name part must be a file, not a directory.
If the name specified with an absolute path, it is returned without
searching along the environment variable's paths.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">option</emphasis></term>
<listitem><para>Specifies where the search starts.
<variablelist>
<varlistentry><term><literal>C</literal></term>
<listitem><para>Starts the search at the current directory and then along the
specified <emphasis role="italic">path</emphasis>.
This is the default.
</para></listitem></varlistentry>
<varlistentry><term><literal>N</literal></term>
<listitem><para>Only searches along <emphasis role="italic">path</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
<para>See also <classname>File</classname> method
<xref linkend="mthFileSearchPath" xrefstyle="select:title"/>.
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSearchPath</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysSearchPath</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysSearchPath</secondary></indexterm>
</para>
<example id="ex.syssearchpath">
<title>RexxUtil &mdash; SysSearchPath</title>
<programlisting>
say SysSearchPath("PATH", "rexx")      -- (Unix e.g.) /usr/local/bin/rexx
say SysSearchPath("PATH", "rexx.exe")  -- (Windows e.g.) C:\Program Files\ooRexx\rexx.exe
</programlisting>
</example>
</section>


<section id="utlSyssetfiledatetime"><title>SysSetFileDateTime</title>
<indexterm><primary>SysSetFileDateTime</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSetFileDateTime</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syssetfiledatetime.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Sets the last-modified timestamp of a file.
</para>
<para>If both <emphasis role="italic">newdate</emphasis> and
<emphasis role="italic">newtime</emphasis> are omitted, the
last-modified timestamp is set to the current date and time, similar
to what the Unix command <literal>touch</literal> does.
</para>
<para>If only one of the <emphasis role="italic">newdate</emphasis> and
<emphasis role="italic">newtime</emphasis> arguments is supplied, the
respective other last-modified date/time portion stays unchanged.
</para>
<para><emphasis role="bold">Parameters</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The name of a file or directory for which the
last-modified timestamp should be updated.
The name &wildcards_no_tilde_yes;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">newdate</emphasis></term>
<listitem><para>An optional new date in the format
<literal>yyyy-mm-dd</literal>.
On Windows <literal>yyyy</literal> must be greater than or equal to
<literal>1800</literal>.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">newtime</emphasis></term>
<listitem><para>An optional new time in the format
<literal>hh:mm:ss</literal> (24-hour format).
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The file date and/or time were updated successfully.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The timestamp update failed.
</para></listitem></varlistentry>
</variablelist>
<para>See also <classname>File</classname> methods
<xref linkend="mthFileLastModified" xrefstyle="select:title"/> and
<xref linkend="mthFileLastModified" xrefstyle="select:title"/>, and
Rexxutil <xref linkend="utlSysgetfiledatetime" xrefstyle="select:title"/>.
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSetFileDateTime</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysSetFileDateTime</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysSetFileDateTime</secondary></indexterm>
</para>
<example id="ex.syssetfiledatetime">
<title>RexxUtil &mdash; SysSetFileDateTime</title>
<programlisting>
call SysSetFileDateTime "."                       -- touch current directory
call SysSetFileDateTime "main.c", , "05:00:00"    -- change file time only
</programlisting>
</example>
</section>

<section id="utlSyssetpriority"><title>SysSetPriority</title>
<indexterm><primary>SysSetPriority</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSetPriority</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syssetpriority.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Changes the priority of the current process. A return code
of 0 indicates no error.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">class</emphasis></term>
<listitem><para>The new process priority class. The allowed classes are:
<variablelist>
<varlistentry><term>0 or &quot;IDLE&quot;</term>
<listitem><para>Idle time priority
</para></listitem></varlistentry>
<varlistentry><term>1 or &quot;NORMAL&quot;</term>
<listitem><para>Regular priority
</para></listitem></varlistentry>
<varlistentry><term>2 or &quot;HIGH&quot;</term>
<listitem><para>High or time-critical priority
</para></listitem></varlistentry>
<varlistentry><term>3 or &quot;REALTIME&quot;</term>
<listitem><para>Real-time priority
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">delta</emphasis></term>
<listitem><para>The change applied to the process priority level.
<emphasis role="italic">delta</emphasis> must be in the range -15 to +15.
It can also be a symbolic name:
<itemizedlist>
<listitem><para>&quot;IDLE&quot; for -15</para></listitem>
<listitem><para>&quot;LOWEST&quot; for -2</para></listitem>
<listitem><para>&quot;BELOW_NORMAL&quot;  for -1</para></listitem>
<listitem><para>&quot;NORMAL&quot; for 0</para></listitem>
<listitem><para>&quot;ABOVE_NORMAL&quot; for 1</para></listitem>
<listitem><para>&quot;HIGHEST&quot; for 2</para></listitem>
<listitem><para>&quot;TIME_CRITICAL&quot; for 15</para></listitem>
</itemizedlist>
</para></listitem></varlistentry>
</variablelist>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No errors.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>An <xref linkend="systemerrorcodes" xrefstyle="template:operating system error code" />.
On Windows, this may be one of the following, but could be others.
</para></listitem></varlistentry>
<varlistentry><term>307</term>
<listitem><para>Invalid priority class.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysshutdownsystem"><title>SysShutdownSystem (Windows only)</title>
<indexterm><primary>SysShutdownSystem</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysShutdownSystem</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysshutdownsystem.svg" scale="55" />
</imageobject>
</mediaobject>

<warning>
<para>Once this function has been called, the initiated shutdown cannot be aborted&mdash;data loss may occur!
</para>
</warning>

<para>
  Provides an interface to the <computeroutput>InitiateSystemShutdown()</computeroutput> API on Windows.
  If the user has sufficient privileges, this function can be used to shut down the local machine or a
  remote system. In general all users have sufficient privileges to shut down the local machine and only
  Administrators have sufficient privileges to shut down remote machines.
</para>
<para>
  The user of this function is <emphasis role="bold">strongly</emphasis> encouraged to read the Microsoft
  documentation for <computeroutput>InitiateSystemShutdown()</computeroutput> to understand the finer
  points to using this function.  The documentation is freely available online. A Google search
  using <emphasis role="italic">InitiateSystemShutdown MSDN</emphasis> will provide a link to the
  documentation. In particular, this function can be used to force a shut down of a system while users
  are logged on and applications have unsaved data.
</para>
<para>
  If the <emphasis role="italic">timeout</emphasis> argument is not 0, a shut down dialog is displayed on
  the machine being shut down, naming the user who initiated the shut down, a timer counting down the
  seconds until the machine is shut down, and prompting the user to log off. This dialog can be moved but
  it can not be closed and remains on top of all other windows on the system.
</para>
<para>
  If any open application has unsaved data, the operating system gives the application a chance to prompt
  the user to save and close the application. If the <emphasis role="italic">force</emphasis> argument is
  false, the shut down will be delayed until the user responds, and ultimately the user could cancel the
  shut down.  If the <emphasis role="italic">force</emphasis> argument is true the system will force the
  application closed whether the data gets saved or not. The application is still given a chance to
  prompt the user to save the data, but the user only has a few seconds to respond before the system
  forcibly closing the application.
</para>
<para>
  The implications of the preceding two paragraphs are this, if the <emphasis
  role="italic">timeout</emphasis> argument is 0 and the <emphasis role="italic">force</emphasis>
  argument is true, the system immediately shuts down and any unsaved data is forever lost.  This is why
  the user of this function is encouraged to fully understand this function before using it.
</para>

<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis>computer</emphasis></term>
<listitem>
<para>
  Indicates which system to shut down. If omitted or the empty string, the local machine is shut down.
  Otherwise this should be the network name of the remote machine.
</para></listitem></varlistentry>
<varlistentry><term><emphasis>message</emphasis></term>
<listitem><para>
  An additional message that is added to the shut down dialog. If omitted, no additional message is
  added.
</para></listitem></varlistentry>
<varlistentry><term><emphasis>timeout</emphasis></term>
<listitem><para>
  The time, in seconds, before the system is shut down. If this value is 0, the system is immediately
  shut down and no shut down dialog is displayed.  The shut down can not be aborted. If omitted the
  default time out is 30 seconds.
</para></listitem></varlistentry>
<varlistentry><term><emphasis>force</emphasis></term>
<listitem>
<para>
  If this argument is true, applications with unsaved data will be forced close by the system whether the
  data is saved or not. If false, the shut down is delayed until applications with unsaved data responds.
  If an application does not respond, the user will be prompted by the system to end the application.  At
  this point, if the user chooses not to forcibly end the application, the shut down will be aborted.
</para>
<para>
  Please <emphasis role="bold">note</emphasis> some consequences of this argument as described by
  Microsoft. If this argument is false, i.e. applications are not forced to close, and an application
  with unsaved changes is running on the console session, the shutdown will remain in progress until the
  user logged into the console session aborts the shutdown, saves changes, closes the application, or
  forces the application to close. During this period, the shutdown <emphasis role="italic">may not
  be</emphasis> aborted except by the console user, and another shutdown <emphasis role="italic">may not
  be</emphasis> initiated. Using true for this argument prevents that situation. But, using true can also
  result in unsaved data being lost.
</para></listitem></varlistentry>
<varlistentry><term><emphasis>reboot</emphasis></term>
<listitem><para>
  If this argument is true, the system is rebooted after the shut down. If it is false, the system is
  shut down. The default if omitted is false.
</para></listitem></varlistentry>
</variablelist>

<para><emphasis role="bold">Returns:</emphasis></para>
<para>
  Returns <computeroutput>0</computeroutput> for success or a Windows
  <xref linkend="systemerrorcodes" xrefstyle="template:System Error code"/>
  for failure. For instance a return of 1300 would indicate the user does not
  have sufficient privileges to shut down the named system.
  Use <xref linkend="utlSysgeterrortext" xrefstyle="select:title"/>
  to get a generic text description for any Windows System Error code.
  For example, the description for error code 1300 is <emphasis role="italic">Not all
  privileges referenced are assigned to the caller.</emphasis>
</para>
</section>

<section id="utlSyssleep"><title>SysSleep</title>
<indexterm><primary>SysSleep</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSleep</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syssleep.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Pauses a Rexx program for a specified time interval.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">delay</emphasis></term>
<listitem><para>The number of seconds for which the program is to be paused,
which must be in the range 0 to 2147483 for Windows,
and 0 to 999999999 for Unix-like systems.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSleep</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysSleep</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysSleep</secondary></indexterm>
<example id="ex.syssleep">
<title>RexxUtil &mdash; SysSleep</title>
<programlisting>
Say "Now paused for 2 seconds ..."
Call SysSleep 2
Say "Now paused for 0.1234567 seconds ..."
Call SysSleep 0.1234567
</programlisting>
</example>
</section>

<section id="utlSysstemcopy"><title>SysStemCopy</title>
<indexterm><primary>SysStemCopy</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysStemCopy</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysstemcopy.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Copies items from the source stem to the target stem. Items in the source
stem are copied starting at the
<emphasis role="italic">from</emphasis> index (default is 1) into the
target stem beginning at the <emphasis role="italic">to </emphasis>
index (default is 1). The number
of items to be copied to the target stem can be specified with the count.
The default is to copy all items in the source stem.</para>
<para>You can also specify that the items are to be inserted into the target
stem at the position and the existing items are shifted to the end.</para>
<para>This function operates only on stem arrays that specify the number of
items in stem.0 and all items must be numbered from 1 to n without omitting
an index.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">fromstem</emphasis></term>
<listitem><para>The name of the source stem.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">tostem</emphasis></term>
<listitem><para>The name of the target stem.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">from</emphasis></term>
<listitem><para>The first index in the source stem to be copied.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">to</emphasis></term>
<listitem><para>The position at which the items are to be inserted in the
target stem.</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">count</emphasis></term>
<listitem><para>The number of items to be copied or inserted.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">insert</emphasis></term>
<listitem><para>Either of the following values:
<variablelist>
<varlistentry><term>I</term>
<listitem><para>Insert items.
</para></listitem></varlistentry>
<varlistentry><term>O</term>
<listitem><para>Overwrite items.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The stem was copied successfully.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>Copying the stem failed.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysStemCopy</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysStemCopy</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysStemCopy</secondary></indexterm>
<example id="ex.sysstemcopy">
<title>RexxUtil &mdash; SysStemCopy</title>
<programlisting>
Source.0 = 3
Source.1 = "Hello"
Source.2 = "from"
Source.3 = "Rexx"
Call SysStemCopy "Source.", "Target."

Call SysStemCopy "Source.", "Target.", 1, 5, 2, "I"
</programlisting>
</example>
</section>

<section id="utlSysstemdelete"><title>SysStemDelete</title>
<indexterm><primary>SysStemDelete</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysStemDelete</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysstemdelete.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Deletes the specified item at the index
<emphasis role="italic">startitem</emphasis> in the stem.
If more than one item is to be deleted the
<emphasis role="italic">itemcount</emphasis> must be specified.
After deleting the requested items the stem is compacted, which means that
items following the deleted items are moved to the vacant positions.</para>
<para>This function operates only on stem arrays that specify the number of
items in stem.0 and all items must be numbered from 1 to n without omitting
an index.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">stem</emphasis></term>
<listitem><para>The name of the stem from which the item is to be deleted.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">startitem</emphasis></term>
<listitem><para>The index of the item to be deleted.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">itemcount</emphasis></term>
<listitem><para>The number of items to be deleted if more than one.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Deleting was successful.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>Deleting failed.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysStemDelete</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysStemDelete</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysStemDelete</secondary></indexterm>
<example id="ex.sysstemdelete">
<title>RexxUtil &mdash; SysStemDelete</title>
<programlisting>
Call SysStemDelete "MyStem.", 5
Call SysStemDelete "MyStem.", 5, 4
</programlisting>
</example>
</section>

<section id="utlSyssteminsert"><title>SysStemInsert</title>
<indexterm><primary>SysStemInsert</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysStemInsert</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syssteminsert.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Inserts a new item at <emphasis role="italic">position</emphasis>
in the stem. All items in the stem
following this position are shifted down by one position.</para>
<para>This function operates only on stem arrays that specify the number of
items in stem.0 and all items must be numbered from 1 to n without omitting
an index.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">stem</emphasis></term>
<listitem><para>The name of the stem in which an item is to be inserted.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">position</emphasis></term>
<listitem><para>The index at which the new item is to be inserted.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">value</emphasis></term>
<listitem><para>The value of the new item.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Inserting was successful.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>Inserting failed.
</para></listitem></varlistentry>
</variablelist>
<example id="ex.syssteminsert">
<title>RexxUtil &mdash; SysStemInsert</title>
<programlisting>
Call SysStemInsert "MyStem.", 5, "New value for item 5"
</programlisting>
</example>
</section>

<section id="utlSysstemsort"><title>SysStemSort</title>
<indexterm><primary>SysStemSort</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysStemSort</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysstemsort.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Sorts all or the specified items in the stem. The items can
be sorted in ascending or descending order and the case of the strings being
compared can be respected or ignored. Sorting can be further narrowed by
specifying the first and last item to be sorted or the columns used as sort
keys. Because the sort uses a quick-sort algorithm, the order of sorted items
according to the sort key is undetermined.</para>
<para>This function operates only on stems that specify the number
of items in stem.0 and all items must be numbered from 1 to n without omitting
an index. A value of 0 in stem.0 is also valid but no sort will be performed.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">stem</emphasis></term>
<listitem><para>The name of the stem to be sorted.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">order</emphasis></term>
<listitem><para>Either &quot;A&quot; for ascending or &quot;D&quot; for
descending. The default is &quot;A&quot;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">type</emphasis></term>
<listitem><para>The type of comparison: either &quot;C&quot; for case or
&quot;I&quot; for ignore. The default is &quot;C&quot;.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">start</emphasis></term>
<listitem><para>The index at which the sort is to start. The default is 1.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">end</emphasis></term>
<listitem><para>The index at which the sort is to end. The default is the
last item.</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">firstcol</emphasis></term>
<listitem><para>The first column to be used as sort key. The default is 1.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">lastcol</emphasis></term>
<listitem><para>The last column to be used as sort key. The default is the
last column.</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The sort was successful.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The sort failed.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysStemSort</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysStemSort</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysStemSort</secondary></indexterm>
<example id="ex.sysstemsort">
<title>RexxUtil &mdash; SysStemSort</title>
<programlisting>
/* sort all elements descending, use cols 5 to 10 as key */
Call SysStemSort "MyStem.", "D", , , ,5, 10

/* sort all elements ascending, ignore the case */
Call SysStemSort "MyStem.", "A", "I"

/* sort elements 10 to 20 ascending, use cols 1 to 10 as key */
Call SysStemSort "MyStem.", , ,10, 20, 1, 10
</programlisting>
</example>
</section>

<section id="utlSysswitchsession"><title>SysSwitchSession (Windows only)</title>
<indexterm><primary>SysSwitchSession</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSwitchSession</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysswitchsession.svg" scale="55" />
</imageobject>
</mediaobject>

<para>
  Brings the named window to the foreground. Modern versions of Windows do not always allow a window to
  be brought to the foreground programmatically. Instead, the icon for the window on the task bar is set
  to flashing.
</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">name</emphasis></term>
<listitem><para>
  The name of the window you want to be the foreground window. The name of the window must exactly match
  the title of the window, but is not case sensitive. The title of a window is the text displayed in its
  title bar.
</para></listitem></varlistentry>
</variablelist>
<para>
  0 is returned on success and a Windows
  <xref linkend="systemerrorcodes" xrefstyle="template:System Error code"/>
  on failure.
</para>
</section>

<section id="utlSyssystemdirectory"><title>SysSystemDirectory (Windows only)</title>
<indexterm><primary>SysSystemDirectory</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysSystemDirectory</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syssystemdirectory.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the Windows system directory.</para>
</section>

<section id="utlSystempfilename"><title>&changed50;SysTempFileName</title>
<indexterm><primary>SysTempFileName</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysTempFileName</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/systempfilename.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a unique name for a file or directory that does not currently
exist. If an error occurs or SysTempFileName cannot create a unique name from
the template, it returns a null string. SysTempFileName is useful
when a program requires a temporary file.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">template</emphasis></term>
<listitem><para>The <emphasis role="italic">template</emphasis> is a valid file or
directory specification including a path, with between one and nine filler characters.
</para>
<para>
  SysTempFileName generates filler character replacements with a random number algorithm. If the
  resulting file or directory already exists, SysTempFileName increments the replacement value until all
  possibilities have been exhausted.
</para>
<para>
  The file path and name of the template can be of any length.
  If the template contains no or more than nine filler characters,
  SysTempFileName returns a null string.
  Filler characters are allowed both in the path and the name part of
  <emphasis role="italic">template</emphasis>.
  The unique name is created solely by
  substituting a random numeric digit for each filler character.  If there is a directory name part of the
  template in addition to the file name part, and the directory name part contains a non-existent
  directory, the function will succeed. However, the temporary file will not be writable unless the user
  first creates the non-existent directory, or directories.
</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="italic">filler</emphasis></term>
<listitem><para>The filler character used in
<emphasis role="italic">template</emphasis>. SysTempFileName replaces
each filler character in <emphasis role="italic">template</emphasis>
with a random numeric digit. The resulting string represents a file or directory that
does not exist. The default filler character is <literal>?</literal>.
</para></listitem></varlistentry>
</variablelist>
<para>See also <xref linkend="clsFile" xrefstyle="template:File"/> method
<xref linkend="mthFileTemporaryPath" xrefstyle="select:title"/>.
</para>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysTempFileName</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysTempFileName</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysTempFileName</secondary></indexterm>
<example id="ex.systempfilename">
<title>RexxUtil &mdash; SysTempFileName</title>
<programlisting>
say SysTempFileName("file???")                -- (e. g.) C:\Users\User1\file392
                                              -- (e. g.) /home/user1/file384
say SysTempFileName("/temp/myfile.***", "*")  -- (e. g.) C:\temp\myfile.938
                                              -- (e. g.) /temp/myfile.341
</programlisting>
</example>
</section>

<section id="utlSystextscreenread"><title>SysTextScreenRead (Windows
only)</title>
<indexterm><primary>SysTextScreenRead</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysTextScreenRead</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/systextscreenread.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns characters from a specified console screen buffer location.
</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">row</emphasis></term>
<listitem><para>The row from which to start reading.
Console screen buffer rows are numbered from top to bottom starting
with <literal>0</literal>.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">col</emphasis></term>
<listitem><para>The column from which to start reading.
Console screen buffer columns are numbered from left to right starting
with <literal>0</literal>.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">len</emphasis></term>
<listitem><para>The number of characters to read.
The default is to read to the end of the console screen buffer.
</para></listitem></varlistentry>
</variablelist>

<note><title>Limitation</title>
<para>This function reads in only screen characters
and does not consider the color attributes of each character read. When
restoring a character string to the screen with SAY or the CHAROUT built-in
function, the previous color settings are lost.
</para></note>
<note><title>Note</title>
<para>The Windows API used by function is not recommended any more.
</para></note>

<indexterm><primary>rexxutil functions</primary>
<secondary>SysTextScreenRead</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysTextScreenRead</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysTextScreenRead</secondary></indexterm>
<example id="ex.systextscreenread">
<title>RexxUtil &mdash; SysTextScreenRead</title>
<programlisting>
// read the entire console screen buffer
screen = SysTextScreenRead(0, 0)

// read one screen buffer line
parse value SysTextScreenSize() with rows columns
line = SysTextScreenRead(2, 0, columns)
</programlisting>
</example>
</section>

<section id="utlSystextscreensize" revisionflag="changed"><title>&changed50;SysTextScreenSize (Windows only)</title>
<indexterm><primary>SysTextScreenSize</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysTextScreenSize</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/systextscreensize.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns or sets the size of the console screen buffer,
returns or sets the position of the current console window rectangle, or
returns the maximum possible console window size.
</para>

<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">option</emphasis></term>
<listitem>
<para>Specifies which size or position is to be returned or set.
</para>

  <variablelist>
  <varlistentry><term><literal>BUFFERSIZE</literal></term>
  <listitem><para>Returns or sets the size of the current console buffer.
  This is the default.
  </para>
  <para>If a size is returned, it is a string of the form
  <emphasis role="italic"><literal>rows columns</literal></emphasis>,
  where <emphasis role="italic">rows</emphasis> is the height and
  <emphasis role="italic">columns</emphasis> is the width in terms of character cells.
  If no character-mode console is attached, the string <literal>0 0</literal> is returned.
  </para>

    <variablelist>
    <varlistentry><term><emphasis role="italic">rows</emphasis>,
      <emphasis role="italic">columns</emphasis></term>
    <listitem><para>If both optional <emphasis role="italic">rows</emphasis> and
    <emphasis role="italic">columns</emphasis> are specified, the console buffer
    size is changed to the height and width given by
    <emphasis role="italic">rows</emphasis> and
    <emphasis role="italic">columns</emphasis>.
    The buffer size cannot be smaller than the size of the current console window.
    If the function succeeds, it returns <literal>0</literal>, otherwise a
    Windows System Error code is returned.
    </para></listitem></varlistentry>
    </variablelist>

  </listitem></varlistentry>

  <varlistentry><term><literal>WINDOWRECT</literal></term>
  <listitem><para>Returns or sets the position of the current console window rectangle.
  </para>
  <para>If a position is returned, it is a string of the form
  <emphasis role="italic"><literal>top left bottom right</literal></emphasis>, where
  (<emphasis role="italic">top</emphasis>, <emphasis role="italic">left</emphasis>) and
  (<emphasis role="italic">bottom</emphasis>, <emphasis role="italic">right</emphasis>)
  are absolute character-cell coordinates in the current console buffer, with the origin
  (0, 0) at the upper-left corner.
  If no character-mode console is attached, the string <literal>0 0 0 0</literal> is returned.
  </para>

    <variablelist>
    <varlistentry><term><emphasis role="italic">top</emphasis>,
      <emphasis role="italic">left</emphasis>,
      <emphasis role="italic">bottom</emphasis>,
      <emphasis role="italic">right</emphasis></term>
    <listitem><para>If all optional arguments <emphasis role="italic">top</emphasis>,
      <emphasis role="italic">left</emphasis>,
      <emphasis role="italic">bottom</emphasis>, and
      <emphasis role="italic">right</emphasis> are specified, the position of the current console window rectangle
    is changed to the given
    (<emphasis role="italic">top</emphasis>, <emphasis role="italic">left</emphasis>) and
    (<emphasis role="italic">bottom</emphasis>, <emphasis role="italic">right</emphasis>)
    positions.
    Both positions must be within the boundaries of the current console buffer.
    If the function succeeds, it returns <literal>0</literal>, otherwise a
    Windows System Error code is returned.
    </para></listitem></varlistentry>
    </variablelist>

  </listitem></varlistentry>

  <varlistentry><term><literal>MAXWINDOWSIZE</literal></term>
  <listitem><para>Returns the maximum possible console window size, considering the size
  of the current console screen buffer, the chosen window font, and the screen size.
  </para>
  <para>The size is returned as a string of the form
  <emphasis role="italic"><literal>rows columns</literal></emphasis>,
  where <emphasis role="italic">rows</emphasis> is the height and
  <emphasis role="italic">columns</emphasis> is the width in terms of character cells.
  If no character-mode console is attached, the string <literal>0 0</literal> is returned.
  </para></listitem></varlistentry>
  </variablelist>

</listitem></varlistentry>
</variablelist>

<indexterm><primary>rexxutil functions</primary>
<secondary>SysTextScreenSize</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysTextScreenSize</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysTextScreenSize</secondary></indexterm>
<example id="ex.systextscreensize">
<title>RexxUtil &mdash; SysTextScreenSize</title>
<programlisting>
parse value SysTextScreenSize() with rows columns
parse value SysTextScreenSize("windowrect") with top left bottom right
say "current console buffer is" rows "rows by" columns "columns"
say "current window rectangle is ("top"," left") ("bottom"," right")"
</programlisting>
</example>
</section>

<section id="utlSystounicode"><title>SysToUnicode (Windows only)</title>
<indexterm><primary>SysToUnicode</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysToUnicode</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/systounicode.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Maps a character string to a Unicode string.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">string</emphasis></term>
<listitem><para>A string that should be mapped to Unicode characters.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">codepage</emphasis></term>
<listitem><para>Specifies the code page used to perform the conversion.
This parameter can be the value of any code page that is installed or available
in the system. The default is the current original equipment manufacturer
(OEM) code-page identifier for the system.</para>
<para>You can also
specify one of the following values:</para>
<variablelist>
<varlistentry><term>ACP</term>
<listitem><para>ANSI code page.
</para></listitem></varlistentry>
<varlistentry><term>OEMCP</term>
<listitem><para>OEM code page.
</para></listitem></varlistentry>
<varlistentry><term>SYMBOL</term>
<listitem><para>symbol code page.
</para></listitem></varlistentry>
<varlistentry><term>THREAD_ACP
<indexterm><primary>thread</primary></indexterm>
</term>
<listitem><para>current thread's ANSI code page.
</para></listitem></varlistentry>
<varlistentry><term>UTF7</term>
<listitem><para>translate using UTF-7.
</para></listitem></varlistentry>
<varlistentry><term>UTF8</term>
<listitem><para>translate using UTF-8. When
this is set, <computeroutput>translateflags</computeroutput> must be set.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term><emphasis role="italic">translateflags</emphasis></term>
<listitem><para>Indicates whether to translate to precomposed or composite-wide
characters (if a composite form exists), whether to use glyph characters in
place of control characters, and how to deal with invalid characters.</para>
<para>You can specify
a combination of the following flags:</para>
<variablelist>
<varlistentry><term>PRECOMPOSED</term>
<listitem><para>Always use precomposed characters, that is, characters in which
a base character and a nonspacing character have a single character value. This
is the default translation option. Cannot be used with COMPOSITE.
</para></listitem></varlistentry>
<varlistentry><term>COMPOSITE</term>
<listitem><para>Always use composite characters, that is, characters in which a
base character and a nonspacing character have different character values.
Cannot be used with PRECOMPOSED.
</para></listitem></varlistentry>
<varlistentry><term>ERR_INVALID_CHARS</term>
<listitem><para>If the function encounters an invalid input character, it fails
and returns &quot;1113&quot;.
</para></listitem></varlistentry>
<varlistentry><term>USEGLYPHCHARS</term>
<listitem><para>Use glyph characters instead of control characters.
</para></listitem></varlistentry>
</variablelist>
<para>A composite character consists of a base character and a nonspacing
character, each having different character values. A precomposed character
has a single character value for a base-nonspacing character combination.
In the character &egrave;, the "e" is the base character and the "grave" accent
mark is the nonspacing character. The function's default behavior is to
translate to the precomposed form. If a precomposed form does not exist, the
function attempts to translate to a composite form.</para>
<para>The flags PRECOMPOSED and
COMPOSITE are mutually exclusive. The USEGLYPHCHARS flag and the
ERR_INVALID_CHARS can be set regardless of the state of the other flags.</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="italic">outstem</emphasis></term>
<listitem><para>The name of the stem variable that will contain the converted
result. If the conversion was successful the stem will be composed of
the following value(s):
</para>
<variablelist>
<varlistentry><term>outstem.!TEXT</term>
<listitem><para>This variable will contain the converted string.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No errors.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>An error occurred.  A  <xref linkend="systemerrorcodes" xrefstyle="template:Windows System Error code"/>
is returned.  This may be one of the following, but
could be others.
</para></listitem></varlistentry>
<varlistentry><term>87</term>
<listitem><para>Incorrect code page or
<computeroutput>codepage</computeroutput> value.
</para></listitem></varlistentry>
<varlistentry><term>1004</term>
<listitem><para>Invalid translate flags.
</para></listitem></varlistentry>
<varlistentry><term>1113</term>
<listitem><para>No mapping for the Unicode character exists in the target code
page.</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSysutilversion"><title>SysUtilVersion</title>
<indexterm><primary>SysUtilVersion</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysUtilVersion</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysutilversion.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a version number that identifies the current level of the Rexx
Utilities package. It can be used to verify the availability of certain
functions.</para>
<para>Return code: The RexxUtil version number in the format
<computeroutput>n.m.l</computeroutput>.</para>
<para><emphasis role="bold">Examples:</emphasis></para>
<para>Because this function was not part of the original packaging, a sample
logic to check for a certain level of RexxUTIL can look as follows:</para>
<example id="ex.sysutilversion">
<title>RexxUtil &mdash; SysUtilVersion</title>
<programlisting>
If RxFuncQuery("SysUtilVersion") = 1 |,
   SysUtilVersion() &lt; "2.00" Then
     Say "Your RexxUTIL.DLL is not at the current level"
</programlisting>
</example>
<para>If a specific function should be used that was added at a later RexxUtil
level a similar check can be performed by querying this function as follows:
</para>
<example id="ex.rxfuncquery-1">
<title>RexxUtil &mdash; RxFuncQuery</title>
<programlisting>
If RxFuncQuery("SysSetFileDateTime") = 1 Then
  Say "Your RexxUtil.DLL is not at the current level"
</programlisting>
</example>
</section>

<section id="utlSysversion"><title>SysVersion</title>
<indexterm><primary>SysVersion</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysVersion</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysversion.svg" scale="55" />
</imageobject>
</mediaobject>

<para>
  Returns a string to identify the operating system and version. The first word of the returned string
  contains the identifier for the operating system and the rest of the string contains an operating system
  specific version string.
  Rexx code should not rely on the exact format returned.
</para>
<para>Possible output may be:
<example id="ex.sysversion">
<title>RexxUtil &mdash; SysVersion</title>
<programlisting>
-- CentOS 7
say SysVersion() -- Linux 3.10.0-957.10.1.el7.x86_64
-- Ubuntu 16.04
say SysVersion() -- Linux 4.4.0-154-generic
-- macOS 10.13
say SysVersion() -- Darwin 18.7.0
-- Raspbian
say SysVersion() -- Linux 4.14.70-v7+
-- SLES/390
say SysVersion() -- Linux 3.12.74-60.64.40-default
-- Windows 10
say SysVersion() -- Windows 10.0.18363
</programlisting>
</example>
</para>
<para>See also functions
<xref linkend="utlSyswinver" xrefstyle="select:title"/> and
<xref linkend="utlSyslinver" xrefstyle="select:title"/>.
</para>
</section>

<section id="utlSysvolumelabel"><title>SysVolumeLabel (Windows only)</title>
<indexterm><primary>SysVolumeLabel</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysVolumeLabel</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/sysvolumelabel.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the volume label for the specified drive.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">drive</emphasis></term>
<listitem><para>A drive specification like <literal>d:\</literal> or
<literal>\\share\path</literal>.
If omitted, the current drive is used.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSyswait"><title>SysWait (Unix only)</title>
<indexterm><primary>SysWait</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWait</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswait.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Waits for all child processes to end.</para>
<para><emphasis role="bold">Returns:</emphasis></para>
<para>The exit code from the child process.</para>
<para><emphasis role="bold">Example:</emphasis></para>
<para>
  <xref linkend="utlSysfork" xrefstyle="select:title"/> has an example that uses
  <computeroutput>wait()</computeroutput>.</para>
</section>

<section id="utlSyswaitnamedpipe"><title>SysWaitNamedPipe (Windows only)</title>
<indexterm><primary>SysWaitNamedPipe</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWaitNamedPipe</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswaitnamedpipe.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Performs a timed wait on a named pipe and returns the WaitNamedPipe
return code.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">name</emphasis></term>
<listitem><para>The name of the pipe in the form
&quot;\\servername\pipe\pipename.&quot;
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">timeout</emphasis></term>
<listitem><para>The number of microseconds to be waited. If you omit
<emphasis role="italic">timeout</emphasis> or
specify 0, SysWaitNamedPipe uses the default timeout value. To wait until
the pipe is no longer busy, you can use a value of -1.
</para></listitem></varlistentry>
</variablelist>
<para>Returns 0 on success. A <xref linkend="systemerrorcodes" xrefstyle="template:Windows System Error code"/>
is returned on error.
</para>
</section>

<section id="utlSyswindecryptfile"><title>SysWinDecryptFile (Windows
only)</title>
<indexterm><primary>SysWinDecryptFile</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinDecryptFile</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswindecryptfile.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Decrypts a given file.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The file to be decrypted.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Decryption was successful.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>A  <xref linkend="systemerrorcodes" xrefstyle="template:Windows System Error code"/>.
This may be one of the following, but could be others.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>File not found.
</para></listitem></varlistentry>
<varlistentry><term>4</term>
<listitem><para>Cannot open file.
</para></listitem></varlistentry>
<varlistentry><term>5</term>
<listitem><para>Access denied.
</para></listitem></varlistentry>
<varlistentry><term>82</term>
<listitem><para>Cannot decrypt.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSyswinencryptfile"><title>SysWinEncryptFile (Windows
only)</title>
<indexterm><primary>SysWinEncryptFile</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinEncryptFile</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswinencryptfile.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Encrypts a given file.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>The file to be encrypted.
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Encryption was successful.
</para></listitem></varlistentry>
<varlistentry><term>Other</term>
<listitem><para>A  <xref linkend="systemerrorcodes" xrefstyle="template:Windows System Error code"/>.
This may be one of the following, but could be others.
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>File not found.
</para></listitem></varlistentry>
<varlistentry><term>4</term>
<listitem><para>Cannot open file.
</para></listitem></varlistentry>
<varlistentry><term>5</term>
<listitem><para>Access denied.
</para></listitem></varlistentry>
<varlistentry><term>82</term>
<listitem><para>Cannot encrypt.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSyswingetdefaultprinter"><title>SysWinGetDefaultPrinter (Windows
only)</title>
<indexterm><primary>SysWinGetDefaultPrinter</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinGetDefaultPrinter</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswingetdefaultprinter.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns the current default printer in the form
"Printername,Drivername,Portname".</para>
</section>

<section id="utlSyswingetprinters"><title>SysWinGetPrinters (Windows
only)</title>
<indexterm><primary>SysWinGetPrinters</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinGetPrinters</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswingetprinters.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a list of available printer descriptions.</para>
<para><emphasis role="bold">Parameters:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">stemarray</emphasis></term>
<listitem><para>A Rexx stem or array variable for the returned printers.
If a stem variable, <emphasis role="italic">stem</emphasis><literal>.0</literal>
is set to <emphasis role="italic">n</emphasis>, the number of printers returned,
and the printers are returned in
<emphasis role="italic">stem</emphasis><literal>.1</literal> to
<emphasis role="italic">stem.n</emphasis>.
</para></listitem></varlistentry>
</variablelist>

<para>Each entry is of the form "Printername,Drivername,Portname".</para>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>Failure
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="utlSyswinsetdefaultprinter"><title>SysWinSetDefaultPrinter (Windows
only)</title>
<indexterm><primary>SysWinSetDefaultPrinter</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinSetDefaultPrinter</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswinsetdefaultprinter.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Sets the default printer.</para>
<para><emphasis role="bold">Parameter:</emphasis></para>
<variablelist>
<varlistentry><term><emphasis role="italic">description</emphasis></term>
<listitem><para>A string identifying the printer.
  This can be either just the printer name, or be of
  the form "Printername,Drivername,Portname".
<note><title>Note</title><para>
  Either form of the description string is accepted.
  However, using just the printer name is the preferred method.  Using the
  "Printername,Drivername,Portname" form will invoke an outdated Windows API
  that Microsoft has deprecated.
</para></note>
</para></listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Return codes:</emphasis></para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success
</para></listitem></varlistentry>
<varlistentry><term>non-zero</term>
<listitem><para>A <xref linkend="systemerrorcodes" xrefstyle="template:Windows System Error code"/>.
You can use <xref linkend="utlSysgeterrortext" xrefstyle="select:title"/> to get a description of the error.
</para></listitem></varlistentry>
</variablelist>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinSetDefaultPrinter</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysWinSetDefaultPrinter</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysSetDefaultPrinter</secondary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinGetDefaultPrinter</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysWinGetDefaultPrinter</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysWinGetDefaultPrinter</secondary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinGetPrinters</secondary>
<tertiary>example</tertiary></indexterm>
<indexterm><primary>SysWinGetPrinters</primary>
<secondary>example</secondary></indexterm>
<indexterm><primary>examples</primary>
<secondary>SysWinGetPrinters</secondary></indexterm>
<example id="ex.syswingetprinters">
<title>RexxUtil &mdash; SysWinGetPrinters and SysWinGetDefaultPrinter</title>
<programlisting>
<![CDATA[
/* set default printer */

default = SysWinGetDefaultPrinter()
parse var default default",".
say 'The Default printer is:' default
say

if SysWinGetPrinters(list.) == 0 then do
  say "List of available printers (* = default):"
  do i=1 to list.0
    parse var list.i pname",".
    if pname == default then
      say i list.i "*"
    else
      say i list.i
  end
  say
  say "Please enter number of new default printer (0 = keep default)"
  pull i

  numberOk = .false

  if i~datatype('W') then do
    if 0 <= i & i <= list.0 then do
      numberOK = .true

      if i > 0 then do
        parse var list.i pname",".
        ret = SysWinSetDefaultPrinter(pname)
        if ret <> 0 then do
          say "Error setting default printer ("ret"):" SysGetErrorText(ret)
        end
        else do
          say "The new default printer is:" pname
        end
      end
    end
  end

  if \ numberOk then do
    say "You did not enter a valid printer number."
  end
end
else do
  say "Failed to get a list of the available printers."
end
]]>
</programlisting>
</example>
</section>

<section id="utlSyswinver"><title>SysWinVer (Windows only)</title>
<indexterm><primary>SysWinVer</primary></indexterm>
<indexterm><primary>rexxutil functions</primary>
<secondary>SysWinVer</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/rexxutil/syswinver.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Returns a string specifying the Windows operating system version
information.
Rexx code should not rely on the exact format returned.
</para>
<para>Possible output might be:
<example id="ex.syswinver">
<title>RexxUtil &mdash; SysWinVer</title>
<programlisting>
-- Windows 7
say SysWinVer()  -- Windows 6.01.7601
-- Windows 10
say SysWinVer()  -- Windows 10.0.18363
</programlisting>
</example>
</para>
<para>See also functions
<xref linkend="utlSysversion" xrefstyle="select:title"/> and
<xref linkend="utlSyslinver" xrefstyle="select:title"/>.
</para>
</section>
</chapter>
