<?xml version="1.0" standalone="no">
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook V4.2//EN"
[
<!ENTITY legalstuff SYSTEM "../shared/legalstuff.sgml">
<!ENTITY notices    SYSTEM "../shared/notices.sgml">
<!ENTITY cpl        SYSTEM "../shared/CPLv1.0.sgml">
<!ENTITY gethelp    SYSTEM "../shared/gethelp.sgml">
<!ENTITY genindex   SYSTEM "ootestQuick_index.sgml">
<!ENTITY svnrev     SYSTEM "svnrev.tmp">
]>
<!--#########################################################################
    #
    # Description: Quick Start for the ooTest Framework SGML file.
    #
    # Copyright (c) 2008, Rexx Language Association. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<book>
<bookinfo>
<title>A Quick Start to Writing ooRexx Test Cases</title>
<titleabbrev>Quick Start</titleabbrev>

&legalstuff;

</bookinfo>

<preface id="preface"><title>About This Book</title>
<para>ooTest is a testing framework that facilitates the testing of the ooRexx
interpreter.  It sits on top of the ooRexxUnit framework which is a generic
testing framework that anyone can use to test their Rexx applications.
</para>
<para>This PDF attempts to give anyone, even those with only a small
understanding of Rexx, a quick start to writing test cases to test the ooRexx
interpreter. In particular, it is geared towards the person who says: I would
like to help the ooRexx project by writing test cases, but I don't understand
that object stuff.
</para>
<para>The Quick Start comes from a series of e-mail messages I posted on the
ooRexx Developer's list.  As such it has a rather informal tone.  The basic idea
driving this book is that by using a few mechanical techniques along with some
boilerplate code, anyone who can write a small piece of Rexx code can write a
working test case.  Although the ooTest framework is object orientated, you do
not need to know objects, or even understand objects to write test cases.
</para>
<para>It is not my intention to fully explain every detail here.  My intention
is to get some people started writing test cases.  I believe that if you use the
boilerplate code to start writing test cases, some of the object stuff will just
seep in.  Because of this, writing test cases is a good way to slowly get used
to using objects in your own ooRexx code.
</para>

<section id="relinf"><title>Related Information</title>
<para>See also:
<citetitle pubwork="book">Open Object Rexx: Reference</citetitle></para>
</section>


&gethelp;

</preface>

<chapter><title>First Steps</title>
<para>
    Download one of the ooRexxUnit snapshots from SourceForge.  Through out this
    discussion I use the term ooRexxUnit and ooTest interchangeably. ooRexxUnit
    is a generic testing framework and the term first used when talking about
    testing ooRexx.  Some things retain that name.  What I am really concerned
    with is ooTest which is a framework whose sole purpose is to test the ooRexx
    interpreter.
</para>
<para>
    As the ooRexx interpreter evolves, so does the ooTest framework.  For that
    reason you need to grab a snapshot that matches the version of ooRexx that
    you will be writing and executing your tests with.
</para>
<para>
    It can not be stressed enough how valuable a contribution to the ooRexx
    project test cases are.  You do not need to write and execute test cases
    using the most current non-released version of ooRexx.  Most people should
    write and execute test cases using the most recent released version of
    ooRexx.  This provides a solid base of good test cases with known results.
    These test cases then make it far easier for the developers to improve and
    enhance ooRexx.  After any code changes the suite of known working test
    cases can be executed to ensure the new code did not break anything.
</para>
<para>
    An ooRexxUnit X.X.X Snapshot is a package released by the ooRexx team that
    contains both the testing framework and the set of tests used in testing the
    ooRexx interpreter at that X.X.X level.  As the version name implies, it is
    a snapshot of ooRexxUnit at that point in time.  The package contains all
    the currently available test groups written to test the X.X.X interpreter.
    These test groups are an excellent source of techniques for using
    ooRexxUnit.
</para>
<para>
    The primary purpose of releasing snapshot versions of ooRexxUnit is to
    encourage individuals and organizations to contribute test cases for the
    interpreter.
</para>
<para>
    Writing test groups to test the interpreter requires nothing other than an
    installed X.X.X interpreter and a framework package.  If an individual has
    limited knowledge of ooRexx programming, then writing test cases will be a
    excellent way to learn the language.
</para>
<para>
    Individuals wishing to contribute to ooRexx through writing test case can
    get advice and help by joining the oorexx-devel list.  The list is free and
    open to anyone.  Go to:

    <ulink url="https://sourceforge.net/mail/?group_id=119701">
        <citetitle>Subscribe oorexx-devel list</citetitle>
    </ulink>

    to join the list.
</para>
<para>
    In addition the RexxLA mailing list is also a good place to seek advice or
    help in writing test units.  If not already a member of RexxLA, more
    information on the group can be found at:

    <ulink url="http://rexxla.org/"><citetitle>RexxLA Home Page</citetitle></ulink>
</para>

<section><title>Download</title>
<para>
    Go to the file download section of the ooRexx project on SourceForge:

    <ulink url="https://sourceforge.net/project/showfiles.php?group_id=119701">
        <citetitle>SourceForge.net Files</citetitle>
    </ulink>
    and download the snapshot for your version of ooRexx.
</para>
<para>
    Most of the times the snapshots are packaged in both zip and tar format.
    However, the ooTest framework and files are completely platform independent
    so any package will work on any system that ooRexx is working on.  Pick the
    packaging type that is most convenient for your needs.
</para>
</section>
<section><title>Extract the Files</title>
<para>
    Open a console window and unzip or untar the snapshot in a convenient spot.
    After unpackaging you will end up with a directory structure similar to
    this:

<programlisting>
<![CDATA[
ooRexxUnit.X.X.X
   |
   *------*framework
   |          |
   |          *-----<subdirectories>
   |
   *------*misc
   |         |
   |         *-----<subdirectories>
   |
   *------*ooRexx
             |
             *-----<subdirectories>
]]>
</programlisting>

</para>

<para>
    The framework directory and subdirectories contain additional documentation
    and examples.
</para>
<para>
    The ooRexx directory and subdirectories contain all the tests implemented
    using the ooTest framework.  These sub-directories contain the tests used in
    testing the ooRexx interpreter.
</para>
<para>
    The misc directory has, well miscellaneous stuff.  The most important of
    which for this discussion is a template file that can be used to start your
    test group files.
</para>
</section>
<section><title>Test Your Install</title>
<para>
  After unpackaging the snapshot cd into the top level directory and read the
  ReadMe.first file.
</para>
<para>
  The program file testOORexx.rex is what drives the automated execution of the
  test cases.  Provided that you have a standard ooRexx install, you can execute
  the entire test case with the command below.
</para>
<note><title>Note</title><para>
  For the sake of this document I am going to show examples on Windows.  But,
  the same general thing applies to Linux.  Just translate the slashes.  In
  addition the examples are from the 3.2.0 version of ooTest.  The same general
  principles apply to whatever snapshot you have.
</para></note>
<para>
  This command will execute the entire test suite.  Depending on your system it
  will take several minutes to finish.
<programlisting>
<![CDATA[
E:\work.ooRexx\ooRexxUnit\3.2.0>dir
 Volume in drive E is Blackfoot
 Volume Serial Number is 9C3D-6D2A

 Directory of E:\work.ooRexx\ooRexxUnit\3.2.0

07/03/2008  08:00 PM    <DIR>          .
07/03/2008  08:00 PM    <DIR>          ..
07/03/2008  08:00 PM    <DIR>          framework
07/03/2008  08:06 PM    <DIR>          misc
07/03/2008  08:06 PM    <DIR>          ooRexx
11/29/2007  05:47 PM            11,839 CPLv1.0.txt
12/19/2007  09:15 PM             2,822 directory.structure.tests
06/30/2008  05:47 PM             1,737 Expected.Results
01/18/2008  10:39 AM            69,323 ooTest.frm
06/30/2008  05:47 PM             5,918 ReadMe.first
01/02/2008  08:03 PM             9,139 runTestGroups.rex
12/04/2007  08:07 PM             2,437 setTestEnv.bat
12/04/2007  08:06 PM             3,062 setTestEnv.sh
01/13/2008  01:15 PM             4,441 testOORexx.rex
01/12/2008  08:44 PM            18,190 worker.rex
              10 File(s)        128,908 bytes
               6 Dir(s)  14,359,519,232 bytes free

E:\work.ooRexx\ooRexxUnit\3.2.0>rexx testOORexx.rex -V 5
Searching for test containers........................................
Executing automated test suite..............................................
...........................................................................
..........

ooTest Framework - Automated Test of the ooRexx Interpreter


Interpreter: REXX-ooRexx_3.2.0(MT) 6.02 30 Oct 2007
ooRexxUnit:  2.0.0_3.2.0        ooTest: 1.0.0_3.2.0

Tests ran:           16600
Assertions:          537835
Failures:            2
  (Known failures:)  42
Errors:              2
Exceptions:          0
Skipped files:       0
Messages:            0

[failure] [20080819 17:37:57.809000]
  Test:   TEST_MULTIPLE_INHERITANCE_WITH_MULTIPLE_METACLASSES
  Class:  Class.testGroup
  File:   E:\work.ooRexx\ooRexxUnit\3.2.0\ooRexx\base\class\Class.testGroup
  Line:   576
  Failed: assertEquals
    Expected: [['123.'], identityHash="495954478"]
    Actual:   [['231.'], identityHash="421451928"]

[failure] [20080819 17:37:57.825000]
  Test:   TEST_SUBCLASSES
  Class:  Class.testGroup
  File:   E:\work.ooRexx\ooRexxUnit\3.2.0\ooRexx\base\class\Class.testGroup
  Line:   684
  Failed: assertTrue
    Expected: [1]
    Actual:   [[0], identityHash="535806184"]

[error] [20080819 17:37:57.809000]
  Test:  TEST_MIXINCLASS_01
  Class: Class.testGroup
  File:  E:\work.ooRexx\ooRexxUnit\3.2.0\ooRexx\base\class\Class.testGroup
  Event: [SYNTAX 97.1] raised unexpectedly.
    Object "NOT_AN_EXISTING_CLASS" does not understand message "NEW"
    Line:    509
   509 *-* cl=.object~mixinclass("subTest_01", not_an_existing_class)

[error] [20080819 17:37:57.825000]
  Test:  TEST_SUBCLASS_01
  Class: Class.testGroup
  File:  E:\work.ooRexx\ooRexxUnit\3.2.0\ooRexx\base\class\Class.testGroup
  Event: [SYNTAX 97.1] raised unexpectedly.
    Object "NOT_AN_EXISTING_CLASS" does not understand message "NEW"
    Line:    616
   616 *-* cl=.object~subclass("subtest_01", not_an_existing_class)


Interpreter: REXX-ooRexx_3.2.0(MT) 6.02 30 Oct 2007
ooRexxUnit:  2.0.0_3.2.0        ooTest: 1.0.0_3.2.0

Tests ran:           16600
Assertions:          537835
Failures:            2
  (Known failures:)  42
Errors:              2
Exceptions:          0
Skipped files:       0
Messages:            0

File search:        00:00:51.456000
Suite construction: 00:00:02.000000
Test execution:     00:02:17.632000
Total time:         00:03:11.620000


E:\work.ooRexx\ooRexxUnit\3.2.0>
]]>
</programlisting>
</para>
</section>
<section><title>Understanding What you See</title>
<para>
  You should get results similar to the above.  Included with the snapshot is a
  file called expected results.  That file should show you results similar to
  what you actually get.  Let's pick the above apart.  The below stats show:
<programlisting>
<![CDATA[
Interpreter: REXX-ooRexx_3.2.0(MT) 6.02 30 Oct 2007
ooRexxUnit:  2.0.0_3.2.0        ooTest: 1.0.0_3.2.0

Tests ran:           16600
Assertions:          537835
Failures:            2
  (Known failures:)  42
Errors:              2
Exceptions:          0
Skipped files:       0
Messages:            0

File search:        00:00:51.456000
Suite construction: 00:00:02.000000
Test execution:     00:02:17.632000
Total time:         00:03:11.620000
]]>
</programlisting>
  that 16,600 tests ran, comprising 537,835 assertations, taking about 3 minutes
  total to finish.  There were 2 failures, 42 known failures, and 2 errors.
</para>
<para>
  For a little terminology.  When you write a test case there are 2 expected
  outcomes.  It is expected that the test case either passes or fails.  So in
  ooTest, a failure is a test case that did not pass.  An error is an
  *unexpected* event.
</para>
<para>
  I'm going to just explain one of the failures.  You have this output:
<programlisting>
<![CDATA[
[failure] [20080819 17:37:57.809000]
  Test:   TEST_MULTIPLE_INHERITANCE_WITH_MULTIPLE_METACLASSES
  Class:  Class.testGroup
  File:   E:\work.ooRexx\ooRexxUnit\3.2.0\ooRexx\base\class\Class.testGroup
  Line:   576
  Failed: assertEquals
    Expected: [['123.'], identityHash="495954478"]
    Actual:   [['231.'], identityHash="421451928"]
]]>
</programlisting>
</para>
<para>
  The above shows that the name of the failed test was
  TEST_MULTIPLE_INHERITANCE_WITH_MULTIPLE_METACLASSES and it can be found on
  line 576 in the file ... Class.testGroup.
</para>
<para>
  What failed was an assertion that two things were equal.  It was
  expected to be equal to '123' but it actually was '231'
</para>
<para>
  Unfortunately these failing two test are a little complex, maybe not the best
  for an intro, but to continue with what we have.  If we look at the failing
  test file on line 576 we see:
<programlisting>
<![CDATA[
  self~assertEquals("'123.'", .class123~info)
]]>
</programlisting>
</para>
<para>
  Okay, it has a method, but just bear with me for a second.  This is
  the heart of writing a test case.
<programlisting>
<![CDATA[
  assertEquals("123", .class123~info)
]]>
</programlisting>
</para>
<para>
  Think of the method just as a routine for now with some prefix on it that you
  do not need to worry about.  The routine has 2 args and what we are doing is
  asserting that the 2 args are equal.
</para>
<para>
  If they are not equal, the test case fails and the ooTest framework takes care
  of all the details of reporting the failure.  That is the print out you see
  above.  For now, don't worry about how the framework does this, just accept
  that it does it.
</para>
<para>
  Next, let's look at the lines around 567, and you see this:

<programlisting>
<![CDATA[
::method "test_MULTIPLE_INHERITANCE_WITH_MULTIPLE_METACLASSES"

  self~assertEquals("'123.'", .class123~info)
]]>
</programlisting>
  Think of the method as a routine, for now, that is named:
  test_MULTIPLE_INHERITANCE_WITH_MULTIPLE_METACLASSES
</para>
<para>
  And that is the test name, the name reported in the print out.  That
  is the assertion.  The test writer is asserting that "123" is equal to
  .class123~info.  The assertion failed, the test failed.
</para>
<para>
  You and I don't need to figure out what .class123~info is right now.
</para>
<para>
  Enough for an introduction.
</para>
</section>
</chapter>

<programlisting>
<![CDATA[
]]>
</programlisting>

<chapter><title>Starting to Write a Test Case</title>
<para>
  In the last section we looked at this, which I said was the heart of a test
  case:
<programlisting>
<![CDATA[
  ::method "test_MULTIPLE_INHERITANCE_WITH_MULTIPLE_METACLASSES"

   self~assertEquals("'123.'", .class123~info)
]]>
</programlisting>
  In this section we will start to write our own test case.
</para>
<section><title>A First Test Case</title>
<para>
  Say we want to test that the interpreter is adding 2 + 3 correctly.  We expect
  our test case either to show that the interpreter is adding 2 + 3 correctly or
  that it is not.
</para>
<para>
  To write a test case, it has to be in a method, which always starts as follows:
<programlisting>
<![CDATA[
  ::method
]]>
</programlisting>
</para>
<para>
  That is boilerplate, just type it.  Then the next key thing is that
  the framework executes each method whose name begins with 'test', case
  not significant as a test case.  We need to name the test case method
  so we do this:
<programlisting>
<![CDATA[
  ::method test_simpleAddition
]]>
</programlisting>
</para>
<para>
  That's also boilerplate, make up a name, start it with test.  I usually add
  the underscore, but it is not needed.
</para>
<para>
  What's the test?  We know that 2 + 3 is 5, so if the interpreter adds
  2 + 3 we would expect the result to be 5.  We write some code that
  adds 2 + 3 and then assert that the result is 5:

<programlisting>
<![CDATA[
  ::method test_simpleAdditon

   val = 2 + 3
   self~assertEquals(5, val)
]]>
</programlisting>
</para>
<para>
  That is all there is to it.  The framework takes care of all the details.
</para>
<para>
  Well there is a little more to it, we need to add the test case methods to a
  file, I'll show that later.
</para>
<para>
  To get started, think of ::method as a function think of self~assertEquals as
  a function with a prefix of 'self~'  and we'll worry about learning about
  classes some other time.  This is enough to write test cases.
</para></section>

<section><title>Contributing to the ooRexx Project</title>
<para>
  First, a little info on contributing to the ooRexx project / to the test
  suite.
</para>
<para>
  The test suite is enormously helpful to the project.  Everyone and any
  one can contribute to this effort.  Even though we have a large number
  of tests we still have a lot of holes.
</para>
<para>
  There are 4 main ways someone can contribute:
</para>

<itemizedlist>
<listitem><para>1.) You could write a whole new *.testGroup file.</para></listitem>
<listitem><para>2.) You can add tests to an existing .testGroup file.</para></listitem>
<listitem><para>3.) You can examine existing test case code for correctness and
correct or improve wrong or weak test cases.</para></listitem>
<listitem><para>4.) You can help organize or promote the contribution of test cases
into the project.</para></listitem>
</itemizedlist>

<para>
  It is my strong opinion that all the .testGroup files in the test
  suite are works in progress.
</para>
<para>
  We could really use more pairs of eye examining the existing
  .testGroup files with a critical eye.
</para>
<para>
  Any one and every one is encouraged to either add to an existing file
  or to say hey this test is wrong, it should be written this way.   Or
  to say, hey the Lines.testGroup does not have a test for this option,
  here's a method that does test it.
</para>
<para>
  The other thing that is really important, is that just because
  something is working now, that doesn't mean there shouldn't be a test
  for it.  There  is no guarantee that anything that is working today
  will be working after I make my next commit.  If I break something
  with my next commit, and we have a test case for it, it will show up
  right away and get fixed.
</para>
<para>
  You may think that there is no way the say instruction could be
  broken.  But what about if you have this in a Rexx file:
<programlisting>
<![CDATA[
/* Simple.rex */
say 'Hello World'
]]>
</programlisting>
  and then run it like this:
<programlisting>
<![CDATA[
E:\>rexx Simple.rex > myTest.file
]]>
</programlisting>
</para>
<para>
  You would expect myTest.File to contain 1 line consisting of:
<programlisting>
<![CDATA[
   Hello World<endOfLineCharacter>
]]>
</programlisting>
</para>
<para>
  Well, a real life bug we just had was that instead of the normal
  Windows end of line which is 0x0d0a we were actually getting 0x0d0d0a.
</para>
<para>
  Now, running the test suite did catch this, but not because we had a
  test for it.  The test suite caught it because some other tests were
  failing with what appeared to be no reason.  It took quite awhile to
  locate what was really wrong.
</para>
<para>
  We did not, and still don't, have a simple test case that asserts that
  a say statement redirected to a file produces what it should.  The
  simple test should assert that the bytes in the file are exactly 13
  and then assert that byte 1 is 0x48, byte 2 is 0x45, ... byte 12 is
  0x0d, byte 13 is 0x0a.
</para>
<para>
  Next chapter, create a testGroup file from the template and start a test
  group.
</para></section>
</chapter>
<chapter>
  <section><title>A First Test Case</title>

  </section>
</chapter>

&notices;
&cpl;

&genindex;

</book>

