<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE authorgroup PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "winextensions.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: Windows Extensions SGML file.
    #
    # Copyright (c) 2005-2019, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->

<chapter id="clsWindowsEventLog"><title>The WindowsEventLog Class</title>
<indexterm><primary>WindowsEventLog class</primary></indexterm>
<indexterm><primary>class</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<para>
  The <computeroutput>WindowsEventLog</computeroutput> class provides functionaliy to interact with the
  Windows system event log.
</para>
<para>
  The WindowsEventLog class is not a built-in class. It is defined in the file
  <computeroutput>winSystm.cls</computeroutput>. To use the class, place a
  <computeroutput>::requires</computeroutput> statement in the program file:
</para>
<programlisting>
::requires "winSystm.cls"
</programlisting>
<para>
  A sample program <computeroutput>eventlog.rex</computeroutput> is provided in the
  <computeroutput>samples\oodialog\winsystem</computeroutput> directory.
</para>
<para>
  <emphasis role="bold">Methods:</emphasis>
</para>
<para>
  The WindowsEventLog class implements the class and instance methods listed in the following table.
</para>
<table id="t000023" frame="all">
<title>WindowsEventLog Methods</title>
<tgroup cols="2">
<thead>
<row>
<entry>Method</entry>
<entry>Category</entry>
</row>
</thead>
<tbody>
<row>
<entry>new (<xref linkend="mthNewWindowsEventLog" />)</entry>
<entry>Class method</entry>
</row>
<row>
<entry>events (<xref linkend="atrEvents" />)</entry>
<entry>Attribute</entry>
</row>
<row>
<entry>minimumReadBuffer (<xref linkend="atrMinimumReadBuffer" />)</entry>
<entry>Attribute</entry>
</row>
<row>
<entry>minimumReadMin (<xref linkend="atrMinimumReadMin" />)</entry>
<entry>Attribute</entry>
</row>
<row>
<entry>minimumReadMax (<xref linkend="atrMinimumReadMin" />)</entry>
<entry>Attribute</entry>
</row>
<row>
<entry>clear (<xref linkend="mthClearClsWindowsEventLog" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>close (<xref linkend="mthCloseWindowsEventLog" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>getFirst (<xref linkend="mthGetFirst" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>getLast (<xref linkend="mthGetLast" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>getLogNames (<xref linkend="mthGetLogNames" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>getNumber (<xref linkend="mthGetNumber" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>isFull (<xref linkend="mthIsFull" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>minimumRead (<xref linkend="mthMinimumRead" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>minimumRead= (<xref linkend="mthMinimumReadEquals" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>open (<xref linkend="mthOpenWindowsEventLog" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry><emphasis role="bold">Deprecated</emphasis>  read (<xref linkend="mthReadWindowsEventLog" />)</entry>
<entry><emphasis role="bold">Deprecated</emphasis> instance method</entry>
</row>
<row>
<entry>readRecords (<xref linkend="mthReadRecords" />)</entry>
<entry>Instance method</entry>
</row>
<row>
<entry>write (<xref linkend="mthWrite" /></entry>
<entry>Instance method</entry>
</row>
</tbody></tgroup>
</table>

<section id="sectCommonWindowsEventLog"><title>Using WindowsEventLog</title>
<indexterm><primary>usage</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<para>
  In Windows the Event Log service provides a central facility for both the operating system and
  applications to log important events. The primary purpose for logging an event is to give
  administrators a way to determine the cause of errors and to prevent future errors. The Event Log
  service provides several standard logs: Application, Security, and System. The service also allows for
  applications to register and create Custom logs. Each event is logged as a single event log record in a
  single log.
</para>
<para>
  The ooRexx <computeroutput>WindowsEventLog</computeroutput> class has methods that allow the programmer
  to query, read from, write to, back up, and clear event logs. The class can access logs on both the
  local machine and on remote machines accessed through the network. Full access to any log is governed
  by the security settings of the system. Therefore an ooRexx program that interacts with the Event Log
  service will be restricted to the privilege level of the user running the program.
</para>
<para>
  The Event Log service uses information stored registry. This information controls how the service
  operates. The following list discusses some of the event logging elements to help the programmer better
  understand the methods and method arguments of the <computeroutput>WindowsEventLog</computeroutput> class:
</para>
<variablelist>
  <varlistentry id="eventLogKey"><term><emphasis role="bold">Eventlog key</emphasis></term>
  <listitem>
    <para>
      The Eventlog key is the key in the registry where all information for the Event Log service is
      stored. There are several subkeys under the EventLog key. Each subkey names an event <emphasis
      role="italic">log</emphasis>. The following shows the structure of the Eventlog key. The <emphasis
      role="italic">Application, Security</emphasis> and <emphasis role="italic">System</emphasis>
      subkeys below name the standard logs provided by the system. The actual name(s) and the number of
      <emphasis role="italic">Custom logs</emphasis> are dependent on the system.
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
      EventLog
        Application
        Security
        System
        CustomLog
</programlisting>
    </para>
  </listitem></varlistentry>
  <varlistentry id="server"><term><emphasis role="bold">Server</emphasis></term>
  <listitem>
    <para>
      Many of <computeroutput>WindowsEventLog</computeroutput> instance methods have a <emphasis
      role="italic">server</emphasis> argument. This argument indentifies which machine contains the
      desired event log. The argument is always optional, with the default server being the local
      machine. In all cases, using the empty string is the same as omitting the argument.
    </para>
    <para>
      To work with a log on a remote system, the server name must be in Universal Naming Convention (UNC)
      format. For instance, <computeroutput>\\Osprey</computeroutput>.
    </para>
    <para>
      <emphasis role="bold">Note</emphasis> that if there is an open (<xref linkend="openedEventLog" />)
      , the <emphasis role="italic">server</emphasis> argument is ignored.
    </para>
  </listitem></varlistentry>
  <varlistentry id="eventSource"><term><emphasis role="bold">Event Source</emphasis></term>
  <listitem>
    <para>
      The <emphasis role="italic">event source</emphasis> is the name of the software or driver that logs
      the event. Event source names are usually the name of the application, or a component of the
      application if the application is large, or the driver name. Applications normally use the
      Application log, while drivers normally use the System log. Event source names are stored in the
      registry as subkeys of the log they are used in. Take the following registry example:
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
      EventLog
        Application
          WinApp1
          LoadPerf
        Security
          Security
        System
          Dhcp
          atapi
</programlisting>
      <emphasis role="italic">WinApp1, LoadPerf, Security, Dhcp,</emphasis> and <emphasis
      role="italic">atapi</emphasis> are all event sources.
    </para>
    <para>
      Like the server (<xref linkend="server" />) argument, many of the WindowsEventLog instance
      methods have a <emphasis role="italic">source</emphasis> argument. This argument specifies the
      event source and therefore determines exactly which event log is used. The argument is always
      optional, the default is Application, and the empty string is the same as omitting the argument. In
      the same manner as the server argument, if there is an open event log (<xref linkend="openedEventLog" />),
      the <emphasis role="italic">source</emphasis> argument is ignored.
    </para>
    <para>
      <emphasis role="bold">Note</emphasis> that if the Event Log service can not find the event source
      name in the registry, then the service also uses Application for the source.
    </para>
    <para>
      When opening, querying, or reading event logs, using an event source name is no different than
      using the log name itself. For the above registry example, using:
<programlisting>
eventLog~open( , "WinApp1")
</programlisting>
      or:
<programlisting>
eventLog~open( , "LoadPerf")
</programlisting>
      is exactly the same as:
<programlisting>
eventLog~open( , "Application")
</programlisting>
    </para>
    <para>
      However, when writing to an event log, the event source is included as part of the event log
      record. Therefore:
<programlisting>
eventLog~open( , "WinApp1")
</programlisting>
      produces a different result than using:
<programlisting>
eventLog~open( , "LoadPerf")
</programlisting>
      Although both event records will be written to the System log, the records will show the event
      source as WinApp1 in the first record and LoadPerf for the source in the second record.
    </para>
  </listitem></varlistentry>
  <varlistentry id="eventLogRecord"><term><emphasis role="bold">Event Log Record</emphasis></term>
  <listitem>
    <para>
      Each event is stored in an event log as a single record. The information in the record includes
      things like: time, type, category, record number, etc.. Each record contains the same fields,
      although some fields, like the binary data field, are not always filled in.
    </para>
    <para id="paraEventRecordNumber">
      Each record has a record number. The first record written to a log is number 1 and records are then
      written consecutively. This makes the record with the lowest record number the oldest record.
      Likewise the highest record number makes that record the youngest record. The user can set a
      property for an event log to overwrite records when the maximum log size is reached. Because of
      this, the oldest record is not always record number 1. The getFirst() (<xref
      linkend="mthGetFirst" />) and getLast() (<xref linkend="mthGetLast" />) methods can
      be used to get the absolute record numbers of the oldest and youngest records.
    </para>
    <para>
      Record numbers can be used in the readRecords() (<xref linkend="mthReadRecords" />) method to
      read portions of the event log rather than the entire log.
    </para>
    <para>
      When the readRecords() (<xref linkend="mthReadRecords" />) method reads a record it converts the
      information in the record to a string with a defined format that makes it easy to parse. The parts
      (fields) of the string are as follows, in order:
    </para>
<table id="tblEventRecord" frame="all" pgwide="1">
<title>Event Record Fields</title>
<tgroup cols="3">
<colspec align='left' colwidth='1*' />
<colspec align='left' colwidth='3*' />
<colspec align='left' colwidth='1*' />
<thead>
<row>
<entry>Field</entry>
<entry>Description</entry>
<entry>Format</entry>
</row>
</thead>
<tbody>
<row>
<entry>type</entry>
<entry>The event type (<xref linkend="eventType" />)</entry>
<entry>Single word</entry>
</row>
<row>
<entry>date</entry>
<entry>The date the event was written</entry>
<entry>Single word</entry>
</row>
<row>
<entry>time</entry>
<entry>The time the event was written</entry>
<entry>Single word</entry>
</row>
<row>
<entry>source</entry>
<entry>The event source (<xref linkend="eventSource" />)</entry>
<entry>Enclosed in single quotes</entry>
</row>
<row>
<entry>id</entry>
<entry>The event ID (<xref linkend="eventIdentifier" />)</entry>
<entry>Single word</entry>
</row>
<row>
<entry>userID</entry>
<entry>The user ID, if applicable</entry>
<entry>Single word</entry>
</row>
<row>
<entry>computer</entry>
<entry>The machine generating the event</entry>
<entry>Single word</entry>
</row>
<row>
<entry>description</entry>
<entry>A descripiton of the event</entry>
<entry>Enclosed in single quotes</entry>
</row>
<row>
<entry>data</entry>
<entry>Binary data associated with the event</entry>
<entry>Enclosed in single quotes</entry>
</row>
</tbody></tgroup>
</table>
    <para>
      Assuming that <emphasis role="italic">rec</emphasis> is the event record string, the following
      shows how to parse the string into its component fields:
    </para>
<programlisting>
parse var rec type date time "'" source "'" id userID computer "'" description "'" "'" data "'"
</programlisting>
  </listitem></varlistentry>
  <varlistentry id="eventType"><term><emphasis role="bold">Event Type</emphasis></term>
  <listitem>
    <para>
      Each event recorded in an event log is a single type. There are five types of events that can be
      logged. Each event type has well-defined common data and some optional data that is specific to the
      event. When an event is logged the event type is included.
    </para>
    <para>
      When the <computeroutput>WindowsEventLog</computeroutput> instance reads a record, the event type
      is indicated by a keyword. When the programmer writes to the event log using a
      <computeroutput>WindowsEventLog</computeroutput> object, she specifies the event type with its
      numeric value. The following table contains information on the five event types and shows the event
      type keywords and numeric values.
    </para>
<table id="tblEventType" frame="all" pgwide="1">
<title>Event Types</title>
<tgroup cols="4">
<colspec align='left' colwidth='1*' />
<colspec align='left' colwidth='4*' />
<colspec align='left' colwidth='1*' />
<colspec align='left' colwidth='1*' />
<thead>
<row>
<entry>Type</entry>
<entry>Description</entry>
<entry>Keyword</entry>
<entry>Value</entry>
</row>
</thead>
<tbody>
<row>
<entry>Error</entry>
<entry>
  An event that indicates a significant problem such as loss of data or loss of functionality. For example, if a service
  fails to load during startup, an Error event is logged.
</entry>
<entry>Error</entry>
<entry>1 (0x01)</entry>
</row>
<row>
<entry>Warning</entry>
<entry>
  An event that is not necessarily significant, but may indicate a possible future problem. For example, when disk space is
  low, a Warning event is logged. If an application can recover from an event without loss of functionality or data, it can
  generally classify the event as a warning event.
</entry>
<entry>Warning</entry>
<entry>2 (0x02)</entry>
</row>
<row>
<entry>Information</entry>
<entry>
  An event that describes the successful operation of an application, driver, or service. For example, when a network driver
  loads successfully, it may be appropriate to log an Information event. Note that it is generally inappropriate for a
  desktop application to log each time it starts.
</entry>
<entry>Information</entry>
<entry>4 (0x04)</entry>
</row>
<row>
<entry>Information*</entry>
<entry>
  * The Windows API allows the numeric value of 0. This is not a separate event type, but rather a mapping of 0 to the
  Infomation event type. The <computeroutput>WindowsEventLog</computeroutput> also allows the use of 0 for the numeric value
  of an event type and maps it to Information.
</entry>
<entry>Information</entry>
<entry>0 (0x00)</entry>
</row>
<row>
<entry>Success Audit</entry>
<entry>
  An event that records an audited security access attempt that is successful. For example, a user's successful attempt to
  log on to the system is logged as a Success Audit event.
</entry>
<entry>Success</entry>
<entry>8 (0x08)</entry>
</row>
<row>
<entry>Failure Audit</entry>
<entry>
  An event that records an audited security access attempt that fails. For example, if a user tries to access a network drive
  and fails, the attempt is logged as a Failure Audit event.
</entry>
<entry>Failure</entry>
<entry>16 (0x10)</entry>
</row>
</tbody></tgroup>
</table>
  </listitem></varlistentry>
  <varlistentry id="eventIdentifier"><term><emphasis role="bold">Event ID</emphasis></term>
  <listitem>
    <para>
      The event identifier value is specific to the event source for the event. It is used with source
      name to locate a description string in the message file for the event source.
    </para>
  </listitem></varlistentry>
  <varlistentry id="openedEventLog"><term><emphasis role="bold">Opened event log</emphasis></term>
  <listitem>
    <para>
      When an event log has been opened using the open() (<xref linkend="mthOpenWindowsEventLog" />)
      method, that opened log is always used until it has been closed. The log can be closed using the
      close() (<xref linkend="mthCloseWindowsEventLog" />) method, or by another call to the
      <computeroutput>open()</computeroutput> method. This means that if there is an open log, the
      <emphasis role="italic">server</emphasis> and <emphasis role="italic">source</emphasis> arguments
      are <emphasis role="bold">always</emphasis> ignored. The only exception to this is the write() (<xref
      linkend="mthWrite" />) method. Each time a record is written to a log, the log is
      specifically opened for writing and then closed.
    </para>
    <para>
      <emphasis role="bold">Note</emphasis> that when there is not an open event log, then all the
      instance methods behave as the <computeroutput>write()</computeroutput> method. That is, methods
      like readRecords() (<xref linkend="mthReadRecords" />), isFull() (<xref linkend="mthIsFull" />),
      etc., will open the log specified in the method call and then explicitly close the log before
      returning.
    </para>
  </listitem></varlistentry>
  <varlistentry id="eventCategory"><term><emphasis role="bold">Event Category</emphasis></term>
  <listitem>
    <para>
      Categories are used to organize events so that an event viewer can filter them. Each event source (<xref
      linkend="eventSource" /> can define its own numbered categories and the text
      strings to which they are mapped.
    </para>
    <para>
      The categories must be numbered consecutively, beginning with  the number 1. The categories
      themselves are defined in a message file and the category number maps to a text string in the
      message file.
    </para>
  </listitem></varlistentry>
</variablelist>

</section>

<section id="mthNewWindowsEventLog"><title>new (Class method)</title>
<indexterm><primary>new method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>new method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_new.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Creates an instance of the WindowsEventLog class.
</para>
</section>

<section id="atrMinimumReadMin"><title>minimumReadMin (Attribute)</title>
<indexterm><primary>minimumReadMin</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_minimumreadmin.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  The programmer can set the size (<xref linkend="mthMinimumReadEquals" />) of the minimum read buffer,
  within limits. <computeroutput>minimumReadMin</computeroutput> is the lowest acceptable size of the
  minimum read buffer.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~minimumReadMin=</emphasis> (set minimumReadMin)</term>
  <listitem>
    <para>
      <computeroutput>minimumReadMin=</computeroutput> is a private method, not intended to be changed by
      the programmer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~minimumReadMin</emphasis> (get minimumReadMin)</term>
  <listitem>
    <para>
      The minimum number of kilobytes that the minimum read buffer can be set to.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      The use of the attribute is straight-forward.
<example id="ex.WindowsEventLog-1-class">
<title>WindowsEventLog class - minimumRead method</title>
<programlisting>
<![CDATA[

eventLog = .WindowsEventLog~new
say "Smallest possible read buffer is" eventLog~minimumReadMin "kilobytes"

::requires 'winSystm.cls'

/* Output might be:

Smallest possible read buffer is 16 kilobytes

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumReadMin() -->

<section id="atrMinimumReadMax"><title>minimumReadMax (Attribute)</title>
<indexterm><primary>minimumReadMax</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_minimumreadmax.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  The programmer can set the size (<xref linkend="mthMinimumReadEquals" />) of the minimum read buffer,
  within limits. The <computeroutput>minimumReadMax</computeroutput> value is the largest acceptable size
  for the minimum read buffer.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~minimumReadMax=</emphasis> (set minimumReadMax)</term>
  <listitem>
    <para>
      <computeroutput>minimumReadMax=</computeroutput> is a private method, not inteneded to be changed
      by the programmer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~minimumReadMax</emphasis> (get minmumReadMax)</term>
  <listitem>
    <para>
      The maximum number of kilobytes that the minimum read buffer can be set to.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para> This example displays the maximum size the programmer can set the minimum read buffer to.
<example id="ex.WindowsEventLog-2-class">
<title>WindowsEventLog class - minimumReadMax method</title>
<programlisting>
<![CDATA[

 eventLog = .WindowsEventLog~new
 say "Largest possible minimum read buffer is" eventLog~minimumReadMax "kilobytes"

::requires 'winSystm.cls'

/* Output might be:

Largest possible minimum read buffer is 256 kilobytes

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumReadMax() -->

<section id="atrMinimumReadBuffer"><title>minimumReadBuffer (Attribute)</title>
<indexterm><primary>minimumReadBuffer</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_minimumreadbuffer.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Returns the current size of the minimum read buffer in bytes. The programmer can adjust the size (<xref
  linkend="mthMinimumReadEquals" />) of the minimum read buffer. The value of this
  attribute reflects that size.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~minimumReadBuffer=</emphasis> (set minimumReadBuffer)</term>
  <listitem>
    <para>
      <computeroutput>minimumReadBuffer=</computeroutput> is a private method, not intended to be changed
      by the programmer. The programmer changes the size of the buffer using the minimumRead= (<xref
      linkend="mthMinimumReadEquals" />) method.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~minimumReadBuffer</emphasis> (get minimumReadBuffer)</term>
  <listitem>
    <para>
      The current size in bytes of the minimum read buffer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the size of the minimum read buffer when a new WindowsEventLog object is
      created and then displays the size after the programmer has changed the minimum.
<example id="ex.WindowsEventLog-3-class">
<title>WindowsEventLog class - minimumReadBuffer method</title>
<programlisting>
<![CDATA[

 eventLog = .WindowsEventLog~new
 say "Current size of the minimum read buffer is" eventLog~minimumReadBuffer "bytes"

 eventLog~minimumRead = 64
  say "Adjusted size of the minimum read buffer to" eventLog~minimumReadBuffer "bytes"

::requires 'winSystm.cls'

/* Output might be:

Current size of the minimum read buffer is 16384 bytes
Adjusted size of the minimum read buffer to 65536 bytes

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumReadBuffer() -->

<section id="atrEvents"><title>events (Attribute)</title>
<indexterm><primary>events</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_events.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  The <computeroutput>events</computeroutput> attribute is an array that holds the event log records that
  are read from the event log during a call to readRecords() (<xref linkend="mthReadRecords" />). The
  array is empty if no call to <computeroutput>readRecords()</computeroutput> has been made. Each time
  <computeroutput>readRecords()</computeroutput> is called the array is first emptied.
</para>
<para>
  Each index in the array holds one event record in the form of a string with a fixed format (<xref
  linkend="eventLogRecord" />.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~events=</emphasis> (set events)</term>
  <listitem>
    <para>
      <computeroutput>events=</computeroutput> is a private method, not intended to be changed by the
      programmer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~events</emphasis> (get events)</term>
  <listitem>
    <para>
      Returns the array holding the event log records from the last readRecords() (<xref
      linkend="mthReadRecords" />) call. The array will be empty if no call to
      <computeroutput>readRecords()</computeroutput> has been made.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the number of event log records that were read from the System log.
<example id="ex.WindowsEventLog-4-class">
<title>WindowsEventLog class - events method</title>
<programlisting>
<![CDATA[

  eventLog = .WindowsEventLog~new
  if eventLog~readRecords("BACKWARDS", , "System") == 0 then do
    say 'The System log has' eventLog~events~items 'records'
  end

::requires 'winSystm.cls'

/* Output might be:

The System log has 1983 records

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::events() -->


<section id="mthOpenWindowsEventLog"><title>open</title>
<indexterm><primary>open method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>open method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_open.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Opens the specified event log. Once an event log is opened, other methods of the
  <computeroutput>WindowsEventLog</computeroutput> instance will use that opened log (<xref
  linkend="openedEventLog" /> until it has been closed (<xref
  linkend="mthCloseWindowsEventLog" />).
</para>
<para>
  If an event log is already open, then it is first closed before the specified log is opened.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      The arguments are:
      <variablelist>
        <varlistentry><term>server</term>
        <listitem>
          <para>
            Optional. The name of the server (<xref linkend="server" />) where the event log resides.
          </para>
        </listitem></varlistentry>
        <varlistentry><term>source</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns 0 on success, and the operating system error code on failure.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      The following two code snippets are equivalent.  They both open the Application log on the local
      machine if they succeed:
    </para>
<example id="ex.WindowsEventLog-5-class">
<title>WindowsEventLog class - open method</title>
<programlisting>
eventLog1 = .WindowsEventLog~new
ret = eventLog1~open
if ret \== 0 then do
  say 'Failed to open the event log:'
  say '  Error' ret':'SysGetErrortext(ret)
  ...
end

eventLog2 = .WindowsEventLog~new
ret = eventLog2~open( , "Application")
if ret \== 0 then do
  say 'Failed to open the event log'
  say '  Error' ret':'SysGetErrortext(ret)
  ...
end
</programlisting>
</example>
  <para>
    The following example opens the System log on SERVER01:
  </para>
<example id="ex.WindowsEventLog-6-class">
<title>WindowsEventLog class - open method</title>
<programlisting>

eventLog = .WindowsEventLog~new
ret = eventLog~open("\\SERVER01", "System")
if ret == 0 then do
  -- Do something with the event log
  ...
  eventLog~close
  ...
end
else do
  -- Handle the error in some way
  ...
end
</programlisting>
</example>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthCloseWindowsEventLog"><title>close</title>
<indexterm><primary>close method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>close method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_close.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Closes an open event log (<xref linkend="openedEventLog" />). If no log is open, this method does
  nothing.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      There are no arguments.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns 0 on success. If there is an error closing the event log the operating
      system error code is returned. An error is highly unlikely.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      The following code snippet opens the default event log (the Application log,) displays some
      information about the log, then closes the open log.
    </para>
<example id="ex.WindowsEventLog-7-class">
<title>WindowsEventLog class - close method</title>
<programlisting>
log = .WindowsEventLog~new

ret = log~open
if ret == 0 then do
  say "  Total records:     " log~getNumber
  say "  First record number" log~getFirst
  say "  Last record number " log~getLast
  say "  Log is full?       " log~isFull
  log~close
end

/* Output might be:

  Total records:      1827
  First record number 1
  Last record number  1827
  Log is full?        0

/*
</programlisting>
</example>
  </listitem></varlistentry>
</variablelist>

</section>

<section id="mthReadWindowsEventLog"><title>read <emphasis role="bold">(deprecated)</emphasis></title>
<indexterm>
  <primary>deprecated</primary>
  <secondary>WindowsEventLog class</secondary>
  <tertiary>read</tertiary>
</indexterm>
<note><title>Note</title><para>
  This method is deprecated.  It is replaced by the functionally equivalent readRecords() (<xref
  linkend="mthReadRecords" />) method.  Do not use this method in new
  code. Try to migrate existing code to to the <computeroutput>readRecords()</computeroutput> method.
  This method may not exist in future versions of ooRexx.
</para></note>
</section>

<section id="mthReadRecords"><title>readRecords</title>
<indexterm><primary>readRecords</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_readrecords.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Reads the desired event records from the specified event log. Each record is stored in the events(<xref
  linkend="atrEvents" />) array. After a successful read, all records will be contained in the
  <computeroutput>events</computeroutput> array in the order there were read. Prior to starting the read
  opereation the array is emptied.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      This method will raise syntax errors if the <emphasis role="italic">start</emphasis> or <emphasis
      role="italic">count</emphasis> arguments are used incorrectly. These arguments, if used, must
      specify records actually contained in the event log. Use any combination of the getFirst() (<xref
      linkend="mthGetFirst" />), getLast() (<xref linkend="mthGetLast" />), or getNumber() (<xref
      linkend="mthGetNumber" />) methods to determine the absolute record numbers
      contained in the log.
    </para>
    <para>
      During a read operation, if a single event record is larger than the read buffer an execution error
      will be raised. The text of the error will read: An event log record is too large (<emphasis
      role="italic">recordSize</emphasis>) for the read buffer (<emphasis
      role="italic">bufferSize</emphasis>.) Where <emphasis role="italic">recordSize</emphasis> is the
      size of the record and <emphasis role="italic">bufferSize</emphasis> is the size of the read buffer
      at the time of the error.
    </para>
    <para>
      The minimum size of the read buffer can be increased by using the minimumRead= (<xref
      linkend="mthMinimumReadEquals" />) method. If this error occurred, the minimum read
      buffer should be set larger than the size of the offending record.
    </para>
    <para>
      <emphasis role="bold">Note well:</emphasis> It seems inconceivable that the read buffer could be
      smaller than a single event record. The minimum possible size of the buffer is 16 KB and the
      average size of an event record is between 100 and 200 bytes. The ooRexx programmer should
      <emphasis role="bold">not</emphasis> worry about this. This unlikely possibility is simple
      documented for the sake of completeness.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      The arguments are:
      <variablelist>
        <varlistentry><term>direction</term>
        <listitem>
          <para>
            Optional. The direction to read the from the event log, forwards or backwards. The default is
            to read forwards. If this argument is not omitted, it must be exactly one of the keywords,
            BACKWARDS or FORWARDS. Case is not significant.
          </para>
        </listitem></varlistentry>
        <varlistentry><term>server</term>
        <listitem>
          <para>
            Optional. The name of the server (<xref linkend="server" />) where the event log resides
          </para>
        </listitem></varlistentry>
        <varlistentry><term>source</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
        <varlistentry><term>start</term>
        <listitem>
          <para>
            Optional. The starting record number for the
            read operation. The start and the count arguments must be used together. Either both must be
            used or neither. If both arguments are omitted, the entire log is read. When both arguments
            are used, the read begins with the record number specified by <emphasis
            role="italic">start</emphasis> and reads in the direction specified for <emphasis
            role="italic">count</emphasis> records.
          </para>
        </listitem></varlistentry>
        <varlistentry><term>count</term>
        <listitem>
          <para>
            Optional. The count of records to be read during the read operation. The start and the count
            arguments must be used together. Either both must be used or neither. If both arguments are
            omitted, the entire log is read. When both arguments are specified, the read begins with the
            record number specified by <emphasis role="italic">start</emphasis> and reads in the
            direction specified for <emphasis role="italic">count</emphasis> records.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns 0 on success, and the operating system error code on failure.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example reads the 5 most recent event records in the System event log and displays them to the
      console. (If there are less than 5 records in the log, then all the records are read.)
<example id="ex.WindowsEventLog-8-class">
<title>WindowsEventLog class - readRecords method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new

  startRec = log~getLast( , "System")
  count = log~getNumber~min(5)

  ret = log~readRecords("BACKWARDS", , "System", startRec, count)

  if ret == 0 then do
    c = displayRecords(log~events)
    say 'Displayed' c 'records'
  end
  else do
    say "Error reading the System event log rc:" ret "-" SysGetErrorText(ret)
  end

::requires 'winSystm.cls'

/* Routine to display the event log records */
::routine displayRecords
  use strict arg records

  do record over records
    say "=========================================================================="
    parse var record type date time "'" sourcename"'" id userid computer "'" string "'" "'" data "'"
    say 'Type     : 'type
    say 'Date     : 'date
    say 'Time     : 'time
    say 'Source   : 'sourcename
    say 'ID       : 'id
    say 'UserId   : 'userid
    say 'Computer : 'computer
    say 'Detail   : 'string
    say 'Data     : 'data
  end
  say "=========================================================================="
return records~items

/* The output (shortened to 2 records) might be:

==========================================================================
Type     : Information
Date     : 02/14/09
Time     : 11:32:21
Source   : WinHttpAutoProxySvc
ID       : 12503
UserId   : N/A
Computer : OSPREY
Detail   : The WinHTTP Web Proxy Auto-Discovery Service has been idle for
15 minutes, it will be shut down.

Data     :
==========================================================================
Type     : Information
Date     : 02/14/09
Time     : 11:15:51
Source   : Service Control Manager
ID       : 7036
UserId   : N/A
Computer : OSPREY
Detail   : The WinHTTP Web Proxy Auto-Discovery Service service entered
the running state.

Data     :
==========================================================================
Displayed 5 records

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::readRecords() -->


<section id="mthWrite"><title>write</title>
<indexterm><primary>write</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_write.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
      <variablelist>
        <varlistentry><term>srvr</term>
        <listitem>
          <para>
            Optional. The name of the server (<xref linkend="server" />) where the event log resides
          </para>
        </listitem></varlistentry>
        <varlistentry><term>src</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
        <varlistentry><term><emphasis role="bold">type</emphasis></term>
        <listitem>
          <para>
            Optional. The event type (<xref linkend="eventType" />) for the record. The default is the
            <emphasis role="italic">Error</emphasis> (1) event type. When used, this argument must be the
            numeric value of a valid event type (<xref linkend="eventType" />).
          </para>
        </listitem></varlistentry>
        <varlistentry><term><emphasis role="bold">category</emphasis></term>
        <listitem>
          <para>
            Optional. The event category (<xref linkend="eventCategory" />) for the record. The default
            is 0, which is the same as no category (none.)
          </para>
        </listitem></varlistentry>
        <varlistentry><term><emphasis role="bold">id</emphasis></term>
        <listitem>
          <para>
            Optional. The event identifier (<xref linkend="eventIdentifier" />) for the record.. The
            default is 0.
          </para>
        </listitem></varlistentry>
        <varlistentry><term><emphasis role="bold">data</emphasis></term>
        <listitem>
          <para>
            Optional. The binary data for the record. The default is none. This is binary information
            specific to the event being logged and to the source that generated the entry. It could for
            example be the contents of the processor registers when a device driver got an error, a dump
            of an invalid packet that was received from the network, etc..
          </para>
        </listitem></varlistentry>
        <varlistentry><term><emphasis role="bold">string</emphasis></term>
        <listitem>
          <para>
            Optional. The default is no string. This last argument can be repeated any number of times.
            Each additional argument is a string used as a substitution string in the description string.
          </para>
          <para>
            The event identifier (<xref linkend="eventIdentifier" />) together with the event source(<xref
            linkend="eventSource" />) name identify a description string contained in
            a message file that describes the event in more detail. The description string can contain
            substitution place holders. The substitution strings named by this argument are used to
            replace the substitution place holders in the description string.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns 0 on success, and the operating system error code on failure.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example writes some fictious data to an event log.
<example id="ex.WindowsEventLog-9-class">
<title>WindowsEventLog class - write method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new

  source     = "MyApplication"
  type       = 4  -- Information
  category   = 22
  id         = 33
  binaryData = "01 1a ff 4b 0C"x

  ret = log~write( , source, type, category, id, binaryData, "String1", "String2")
  if ret == 0 then
    say "Record" source "successfully written"
  else
    say "Error writing record" source "rc:" ret ":" SysGetErrorText(ret)


::requires 'winSystm.cls'
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::write() -->


<section id="mthClearClsWindowsEventLog"><title>clear</title>
<indexterm><primary>clear</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_clear.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Clears (removes) all event records from the log. Optionally will back up the log first. When the
  optional backup file name is supplied and for some reason the back up fails, then the event records are
  not cleared.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
      <variablelist>
        <varlistentry><term>srvr</term>
        <listitem>
          <para>
            Optional. The name of the server (<xref linkend="server" />) where the event log resides
          </para>
        </listitem></varlistentry>
        <varlistentry><term>src</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
        <varlistentry><term>backupFileName</term>
        <listitem>
          <para>
            Optional. The path name to a back up file. If this argument is specified, the event log is
            first backed up before it is cleared. If the back up fails, the log is not cleared. The back
            will fail if the file name specified already exists.
          </para>
          <para>
            The back up file will be created on the system that the event log file itself is on. This
            means that if an event log on a remote system is specified, the log will be created on that
            remote system.  The file name must therefore be a valid file name on the remote system.
          </para>
          <para>
            If the file name does not contain an extension, the the normal extension for event log back
            ups, <computeroutput>.evt</computeroutput>, will be used.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns 0 on success, and the operating system error code on failure.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example backs up the Application event log on the remote Eagle system and then clears the log.
      If the back up fails, the log will not be cleared. The back up file will be named
      eagle_application.evt and will be located <emphasis role="italic">on</emphasis> the Eagle system,
      not on the local machine.
<example id="ex.WindowsEventLog-10-class">
<title>WindowsEventLog class - clear method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new

  ret = log~open("\\Eagle", "Application")
  if ret == 0 then do
    ret = log~clear( , , "C:\eagle_application")
    if ret == 0 then do
      say 'Backed up the Application event log on Eagle to:'
      say '  C:\eagle_application.evt on the Eagle system.'
    end
    else do
      say 'Failure backing up event log:' ret ":" SysGetErrorText(ret)
    end
  end

::requires 'winSystm.cls'

]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::clear() -->

<section id="mthMinimumRead"><title>minimumRead</title>
<indexterm><primary>minimumRead</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_minimumread.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Determines the current minimum size, in kilobytes, of the buffer used to read (<xref
  linkend="mthReadRecords" />) event log records.  The minimum size of this buffer can be adjusted (<xref
  linkend="mthMinimumReadEquals" />) by the programmer.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>There are no arguments to this method.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The size in kilobytes of the minimum read buffer.  For example if the minimum buffer size is
      32,768, this method will return 32. (32 KB.)
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the current value of the minimum read buffer size.
<example id="ex.WindowsEventLog-11-class">
<title>WindowsEventLog class - minimumRead method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new
  say 'Current minimum size of the read buffer is:' log~minimumRead "KB"

::requires 'winSystm.cls'

/* Output might be:

Current minimum size of the read buffer is: 16 KB

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumRead() -->

<section id="mthMinimumReadEquals"><title>minimumRead=</title>
<indexterm><primary>minimumRead=</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_minimumread_equal.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Adjusts the minimum size of the read buffer in increments of 1024 bytes. <emphasis
  role="bold">Note</emphasis> that the programmer need not worry about the read buffer. This method is
  documented because it does exist and for the sake of the rare Rexx programmer that might need to change
  the minimum size of the read buffer.
</para>
<para>
  The read buffer is used by the underlying implementation during the readRecords() (<xref
  linkend="mthReadRecords" />) method only. During a read operation, the
  <computeroutput>WindowsEventLog</computeroutput> attempts to allocate a buffer that is big enough to
  read in all the records at once. The size of the buffer is guessed at by using the number of records in
  the event log. The size is constrained by a minimum (<xref linkend="atrMinimumReadMin" />) and maximum (<xref
  linkend="atrMinimumReadMax" />). The buffer will never be larger than the maximum and never
  smaller than the minimum.  The maximum value is fixed.  The minimum value can be adjusted by the
  programmer by this, the <computeroutput>minimumRead()</computeroutput> method.
</para>
<para>
  In almost all cases, the size of the buffer will be set towards the maximum constraint and the minimum
  constraint will not come into play at all. There is only one circumstance where the Rexx programmer
  would need to change the minimum constraint, which is this:
</para>
<para>
  The Windows Event Log Service will only place whole records into the buffer. If a record is bigger in
  size than the buffer, the record can not be read and an execution error will be raised by the
  <computeroutput>WindowsEventLog</computeroutput> object. In this case the minimum constraint for the
  buffer size would need to be set to a size bigger than the record size. The text of the error message
  lists both the record size and the buffer size. To read the record, the programmer would set the
  minimum constraint larger than the record size.
</para>
<para>
  Again, it <emphasis role="italic">must be stressed</emphasis> that the above scenario is extremely
  unlikely.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The single argument is:
    <variablelist>
      <varlistentry><term>sizeKB</term>
      <listitem>
        <para>
          The minimum size to allocate the read buffer, in kilobytes.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      There is no return.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This method is straight forward to use:
<example id="ex.WindowsEventLog-12-class">
<title>WindowsEventLog class - minimumRead= method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new
  log~minimumRead = 64
  say 'Current minimum read is' log~minimumRead 'KB.'

::requires 'winSystm.cls'

/* Output might be:

Current minimum size of the read buffer is: 64 KB

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumRead() -->


<section id="mthIsFull"><title>isFull</title>
<indexterm><primary>isFull</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_isfull.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Determines if the event log is full.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
      <variablelist>
        <varlistentry><term>server</term>
        <listitem>
          <para>
            Optional. The server (<xref linkend="server" />) where the event log resides.
          </para>
        </listitem></varlistentry>
        <varlistentry><term>source</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The method returns <computeroutput>.true</computeroutput> or
      <computeroutput>.false</computeroutput>. True if the event log is full, otherwise false.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example is a snippet of code from an application that monitors the system log. When the log
      gets full, the log is backed up and cleared.
<example id="ex.WindowsEventLog-13-class">
<title>WindowsEventLog class - isFull method</title>
<programlisting>
<![CDATA[

::routine checkLog
  use strict arg sysLog, monitor

  if sysLog~isFull then do
    success = monitor~backupLog(sysLog)
    if \ success then monitor~notifyAdmin
  end
return success

]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::isFull() -->


<section id="mthGetNumber"><title>getNumber</title>
<indexterm><primary>getNumber</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<indexterm><primary>WindowsEventLog class</primary>
<secondary>getNumber</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_getnumber.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Determines the number of records in the event log.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      The arguments are:
      <variablelist>
        <varlistentry><term>server</term>
        <listitem>
          <para>
            Optional. The server (<xref linkend="server" />) where the event log resides.
          </para>
        </listitem></varlistentry>
        <varlistentry><term>source</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      On success, the count of event records in the log. On error, the return is the negated
      system error code.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example opens the system log on the Osprey server. It then checks that there are at least 10
      records before reading the log:
<example id="ex.WindowsEventLog-14-class">
<title>WindowsEventLog class - getNumber method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new
  log~open("\\Osprey", "System")
  if log~getNumber > 10 then do
    log~readRecords
    say 'Read' log~events~items 'records.'
  end

::requires 'winSystm.cls'

]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::getNumber() -->

<section id="mthGetLogNames"><title>getLogNames</title>
<indexterm><primary>getLogNames</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<indexterm><primary>WindowsEventLog class</primary>
<secondary>getLogNames</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_getlognames.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Obtains a list of all the event log names on the current system.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The single argument is:
    <variablelist>
      <varlistentry><term>names</term>
      <listitem>
        <para>
          An array object. On return the array will contain the names of the event logs on the current
          system. This will include any custom logs, if there are any.  The array is emptied before the
          names are added. If an error happens, the array will be empty.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns 0 on success, and the operating system error code on failure.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the names of all the event logs on the current system.
<example id="ex.WindowsEventLog-15-class">
<title>WindowsEventLog class - getLogNames method</title>
<programlisting>
<![CDATA[

logNames = .array~new
ret = log~getLogNames(logNames)

if ret == 0 then do name over logNames
  say "Log:" name
end

::requires 'winSystm.cls'

/* Output might be:

Log: Application
Log: Internet Explorer
Log: Security
Log: System

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::getLogNames() -->


<section id="mthGetLast"><title>getLast</title>
<indexterm><primary>getLast</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_getlast.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Determines the absolute record number of the last record
  in the event log.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      The arguments are:
      <variablelist>
        <varlistentry><term>server</term>
        <listitem>
          <para>
            Optional. The server (<xref linkend="server" />) where the event log resides.
          </para>
        </listitem></varlistentry>
        <varlistentry><term>source</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      On success, the record number of the last (most recently written) event record. On error, the
      return is the negated system error code.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the last record written to application log.
<example id="ex.WindowsEventLog-16-class">
<title>WindowsEventLog class - getLast method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new~~open
  log~readRecords( , , , log~getLast, 1)
  rec = log~events[1]
  if rec \== .nil then do

    parse var rec type date time "'" src"'" id user computer "'" string "'" "'" data "'"
    say 'Type     : 'type
    say 'Date     : 'date
    say 'Time     : 'time
    say 'Source   : 'src
    say 'ID       : 'id
    say 'UserId   : 'user
    say 'Computer : 'computer
    say 'Detail   : 'string
    say 'Data     : 'data
  end

::requires 'winSystm.cls'

/* Output might be:

Type     : Error
Date     : 02/14/09
Time     : 16:55:08
Source   : Windows Search Service
ID       : 3083
UserId   : N/A
Computer : OSPREY
Detail   : The protocol handler Search.Mapi2Handler.1 cannot be loaded. Error
description: Class not registered.
Data     :

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::getLast() -->


<section id="mthGetFirst"><title>getFirst</title>
<indexterm><primary>getFirst</primary>
<secondary>WindowsEventLog class</secondary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/winevent/winevent_getfirst.svg" scale="50" />
</imageobject>
</mediaobject>

<para>
  Determines the absolute record number of the first record
  in the event log.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
      <variablelist>
        <varlistentry><term>server</term>
        <listitem>
          <para>
            Optional. The server (<xref linkend="server" />) where the event log resides.
          </para>
        </listitem></varlistentry>
        <varlistentry><term>source</term>
        <listitem>
          <para>
            Optional. The event source (<xref linkend="eventSource" />).
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      On success, the first record number in the event log. On error, the return is the negated system
      error code.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the first record written to the application log.
    </para>
    <para>
      It is somewhat interesting to note that this first record was written right after the operating
      system had been installed, prior to the computer being added to a work group and given the Osprey
      name.  This can be seen when the record is displayed, the Computer field is MACHINENAME.
<example id="ex.WindowsEventLog-17-class">
<title>WindowsEventLog class - getFirst method</title>
<programlisting>
<![CDATA[

  log = .WindowsEventLog~new~~open("\\Osprey", "System")
  log~readRecords( , , , log~getFirst, 1)
  rec = log~events[1]
  if rec \== .nil then do

    parse var rec type date time "'" src"'" id user computer "'" string "'" "'" data "'"
    say 'Type     : 'type
    say 'Date     : 'date
    say 'Time     : 'time
    say 'Source   : 'src
    say 'ID       : 'id
    say 'UserId   : 'user
    say 'Computer : 'computer
    say 'Detail   : 'string
    say 'Data     : 'data
  end

::requires 'winSystm.cls'

/* Output might be:

Type     : Information
Date     : 08/16/08
Time     : 04:27:01
Source   : EventLog
ID       : 6009
UserId   : N/A
Computer : MACHINENAME
Detail   : 5.02. 3790 Service Pack 1 Multiprocessor Free
Data     :

*/
]]>
</programlisting>
</example>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::getFirst() -->

</chapter>

