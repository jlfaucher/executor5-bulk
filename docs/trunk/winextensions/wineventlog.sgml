<!--#########################################################################
    #
    # Description: Open Object Rexx: WindowsEventLog Class Reference SGML file.
    #
    # Copyright (c) 2005-2009, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->

<chapter id="clsWindowsEventLog"><title>The WindowsEventLog Class</title>
<indexterm><primary>WindowsEventLog class</primary></indexterm>
<indexterm><primary>class</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<para>
  The <computeroutput>WindowsEventLog</computeroutput> class provides functionaliy to interact with the
  Windows system event log. The programmer can use this class to read, write, and clear event-log
  records.
</para>
<para>
  The WindowsEventLog class is not a built-in class. It is defined in the file
  <computeroutput>winSystm.cls</COMPUTEROUTPUT>. To use the class, place a
  <computeroutput>::requires</computeroutput> statement in the program file:
</para>
<programlisting>
::requires "winSystm.cls"
</programlisting>
<para>
  A sample program <computeroutput>eventLog.rex</computeroutput> is provided in the
  <computeroutput>samples\winsystem</computeroutput> directory.
</para>
<para>
  <emphasis role="bold">Methods:</emphasis>
</para>
<para>
  The WindowsEventLog class implements the class and instance methods listed in the following table.
</para>
<table id="t000023" frame="all">
<title>WindowsEventLog Methods</title>
<tgroup cols="2">
<thead>
<row>
<entry>Item</entry>
<entry>...Description</entry>
</row>
</thead>
<tbody>
<row>
<entry>new (Class method)</entry>
<entry><link linkend="mthNewWindowsEventLog">new</link></entry>
</row>
<row>
<entry><emphasis role="bold">Attributes</emphasis></entry>
<entry><emphasis role="bold">Link</emphasis></entry>
</row>
<row>
<entry>events</entry>
<entry><link linkend="atrEvents">events</link></entry>
</row>
<row>
<entry>minimumReadBuffer</entry>
<entry><link linkend="atrMinimumReadBuffer">minimumReadBuffer</link></entry>
</row>
<row>
<entry>minimumReadMin</entry>
<entry><link linkend="atrMinimumReadMin">minimumReadMin</link></entry>
</row>
<row>
<entry>minimumReadMax</entry>
<entry><link linkend="atrMinimumReadMin">minimumReadMax</link></entry>
</row>
<row>
<entry><emphasis role="bold">Methods</emphasis></entry>
<entry><emphasis role="bold">Link</emphasis></entry>
</row>
<row>
<entry>clear</entry>
<entry><link linkend="mthClearWindowsEventLog">clear</link></entry>
</row>
<row>
<entry>close</entry>
<entry><link linkend="mthCloseWindowsEventLog">close</link></entry>
</row>
<row>
<entry>getFirst</entry>
<entry><link linkend="mthGetFirst">getFirst</link></entry>
</row>
<row>
<entry>getLast</entry>
<entry><link linkend="mthGetLast">getLast</link></entry>
</row>
<row>
<entry>getLogNames</entry>
<entry><link linkend="mthGetLogNames">getLogNames</link></entry>
</row>
<row>
<entry>getNumber</entry>
<entry><link linkend="mthGetNumber">getNumber</link></entry>
</row>
<row>
<entry>isFull</entry>
<entry><link linkend="mthIsFull">isFull</link></entry>
</row>
<row>
<entry>minimumRead</entry>
<entry><link linkend="mthMinimumRead">minimumRead</link></entry>
</row>
<row>
<entry>minimumRead=</entry>
<entry><link linkend="mthMinimumReadEquals">minimumRead=</link></entry>
</row>
<row>
<entry>open</entry>
<entry><link linkend="mthOpenWindowsEventLog">open</link></entry>
</row>
<row>
<entry>read <emphasis role="bold">Deprecated</emphasis></entry>
<entry><link linkend="mthReadWindowsEventLog">read</link> <emphasis role="bold">Deprecated</emphasis></entry>
</row>
<row>
<entry>readRecords</entry>
<entry><link linkend="mthReadRecords">readRecords</link></entry>
</row>
<row>
<entry>write</entry>
<entry><link linkend="mthWrite">write</link></entry>
</row>
</tbody></tgroup>
</table>

<section id="mthNewWindowsEventLog"><title>new (Class method)</title>
<indexterm><primary>new method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>new method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--new---------------------------------><
]]>
</programlisting>

<para>
  Creates an instance of the WindowsEventLog class.
</para>
</section>

<section id="atrMinimumReadMin"><title>minimumReadMin (Attribute)</title>
<indexterm><primary>minimumReadMin</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--minimumReadMin----------------------><

]]>
</programlisting>

<para>
  The programmer can <link linkend="mthMinimumReadEquals">set the size</link> of the minimum read buffer,
  within limits. <computeroutput>minimumReadMin</computeroutput> is the lowest acceptable size of the
  minimum read buffer.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~minimumReadMin=</emphasis> (set minimumReadMin)</term>
  <listitem>
    <para>
      <computeroutput>minimumReadMin=</computeroutput> is a private method, not intended to be changed by
      the programmer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~minimumReadMin</emphasis> (get minimumReadMin)</term>
  <listitem>
    <para>
      The minimum number of kilobytes that the minimum read buffer can be set to.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      The use of the attribute is straight-forward.
<programlisting>
<![CDATA[

eventLog = .WindowsEventLog~new
say "Smallest possible read buffer is" eventLog~minimumReadMin "kilobytes"

::requires 'winSystm.cls'

/* Output might be:

Smallest possible read buffer is 16 kilobytes

*/
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumReadMin() -->

<section id="atrMinimumReadMax"><title>minimumReadMax (Attribute)</title>
<indexterm><primary>minimumReadMax</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--minimumReadMax----------------------><

]]>
</programlisting>

<para>
  The programmer can <link linkend="mthMinimumReadEquals">set the size</link> of the minimum read buffer,
  within limits. The <computeroutput>minimumReadMax</computeroutput> value is the largest acceptable size
  for the minimum read buffer.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~minimumReadMax=</emphasis> (set minimumReadMax)</term>
  <listitem>
    <para>
      <computeroutput>minimumReadMax=</computeroutput> is a private method, not inteneded to be changed
      by the programmer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~minimumReadMax</emphasis> (get minmumReadMax)</term>
  <listitem>
    <para>
      The maximum number of kilobytes that the minimum read buffer can be set to.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para> This example displays the maximum size the programmer can set the minimum read buffer to.
<programlisting>
<![CDATA[

 eventLog = .WindowsEventLog~new
 say "Largest possible minimum read buffer is" eventLog~minimumReadMax "kilobytes"

::requires 'winSystm.cls'

/* Output might be:

Largest possible minimum read buffer is 256 kilobytes

*/
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumReadMax() -->

<section id="atrMinimumReadBuffer"><title>minimumReadBuffer (Attribute)</title>
<indexterm><primary>minimumReadBuffer</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--minimumReadBuffer-------------------><

]]>
</programlisting>

<para>
  Returns the current size of the minimum read buffer in bytes. The programmer can <link
  linkend="mthMinimumReadEquals">adjust the size</link> of the minimum read buffer. The value of this
  attribute reflects that size.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~minimumReadBuffer=</emphasis> (set minimumReadBuffer)</term>
  <listitem>
    <para>
      <computeroutput>minimumReadBuffer=</computeroutput> is a private method, not intended to be changed
      by the programmer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~minimumReadBuffer</emphasis> (get minimumReadBuffer)</term>
  <listitem>
    <para>
      The current size in bytes of the minimum read buffer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the size of the minimum read buffer when a new WindowsEventLog object is
      created and then displays the size after the programmer has changed the minimum.
<programlisting>
<![CDATA[

 eventLog = .WindowsEventLog~new
 say "Current size of the minimum read buffer is" eventLog~minimumReadBuffer "bytes"

 eventLog~minimumRead = 64
  say "Adjusted size of the minimum read buffer to" eventLog~minimumReadBuffer "bytes"

::requires 'winSystm.cls'

/* Output might be:

Current size of the minimum read buffer is 16384 bytes
Adjusted size of the minimum read buffer to 65536 bytes

*/
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumReadBuffer() -->

<section id="atrEvents"><title>events (Attribute)</title>
<indexterm><primary>events</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--events------------------------------><

]]>
</programlisting>

<para>
  The <computeroutput>events</computeroutput> attribute is an array that holds the event log records that
  are read from the event log during a call to <link linkend="mthReadRecords">readRecords</link>(). The
  array is empty if no calls to <computeroutput>readRecords()</computeroutput> has been made. Each time
  <computeroutput>readRecords()</computeroutput> is called the array is first emptied.
</para>
<para>
  Each index in the array holds one event record in the form of a string with a fixed format. The <link
  linkend="mthReadRecords">readRecords</link> documentation has the details of this format.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">~events=</emphasis> (set events)</term>
  <listitem>
    <para>
      <computeroutput>events=</computeroutput> is a private method, not intended to be changed by the
      programmer.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">~events</emphasis> (get events)</term>
  <listitem>
    <para>
      Returns the array holding the event log records from the last <link
      linkend="mthReadRecords">readRecords</link>() call. The array will be empty if no call to
      <computeroutput>readRecords()</computeroutput> has been made.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example displays the number of event log records that.
<programlisting>
<![CDATA[

  eventLog = .WindowsEventLog~new
  if eventLog~readRecords("BACKWARDS", , "System") == 0 then do
    say 'The System log has' eventLog~events~items 'records'
  end

::requires 'winSystm.cls'

/* Output might be:

The System log has 1983 records

*/
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::events() -->


<section id="mthOpenWindowsEventLog"><title>open</title>
<indexterm><primary>open method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>open method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--open(--+---------+--+------------+--)-----------------------><
           +-server--+  +-,--source--+
]]>
</programlisting>

<para>Opens the specified event log.</para>
<variablelist>
<varlistentry><term>Arguments:</term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>server</term>
<listitem><para>The UNC (universal naming convention) name of the server on which
the event log is to be opened. If this argument is not specified, the log is
opened at the local machine.
</para></listitem></varlistentry>
<varlistentry><term>source</term>
<listitem><para>The name of the source of the event log. It must be a subkey of
a log file entry under the EventLog key in the registry. If, for example, the
registry looks as follows:
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
      EventLog
        Application
          WinApp1
        Security
          WinApp2
        System
</programlisting>
&quot;Application&quot;, &quot;Security&quot;, &quot;System&quot;,
&quot;WinApp1&quot;, and &quot;WinApp2&quot; are valid sources.
If the source is not found, the &quot;Application
Log&quot; is used.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>Return value:</term>
<listitem><para>The method returns:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The open succeeded.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The open failed.
</para></listitem></varlistentry>
</variablelist></para></listitem>
</varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following two code snippets are equivalent.  They both open
the Application log on the local machine if they succeed:
</para>
<programlisting>
event_log1 = .WindowsEventLog~new
rc = event_log1~open
if rc == 1 then do
  say 'Failed to open the event log'
  ...
end

event_log = .WindowsEventLog~new
rc = event_log~open(,"Application")
if rc == 1 then do
  say 'Failed to open the event log'
  ...
end
</programlisting>
<para>The following example opens the System log on SERVER01:</para>
<programlisting>

event_log = .WindowsEventLog~new
rc = event_log~open("\\SERVER01","System")
if rc == 0 then do
  -- Do something with the event log
  ...
  event_log~close
  ...
end
else do
  -- Handle the error in some way
  ...
end
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>

<section id="mthCloseWindowsEventLog"><title>close</title>
<indexterm><primary>close method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>close method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>
<programlisting>
<![CDATA[
>>-close-------------------------------------------------------><
]]>
</programlisting>

<para>Closes an open event log.</para>
</section>

<section id="mthReadWindowsEventLog"><title>read</title>
<indexterm><primary>read method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>read method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>
<programlisting>
<![CDATA[
>>-read--+---------------------------------------------------+-->
         |    +-FORWARDS--+                                  |
         +-(--+-----------+--,--+--------+--,--+--------+--,-+
              +-BACKWARDS-+     +-server-+     +-source-+

>--+--------------------------+--------------------------------><
   +-+-------+--,--+-----+--)-+
     +-start-+     +-num-+
]]>
</programlisting>

<para>Reads an event log and returns an array containing the event records. If
the event log was not opened with the OPEN method, the event log specified by
the <emphasis role="italic">server</emphasis> and <emphasis
role="italic">source</emphasis> is opened and closed after processing.
</para>
<variablelist>
<varlistentry><term>Arguments:</term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>server</term>
<listitem><para>The UNC (universal naming convention) name of the server on which
the event log is to be opened. If this argument is not specified, the log is
opened at the local machine.</para>
<para>This argument is only used if the event log was not
opened before.</para>
</listitem></varlistentry>
<varlistentry><term>source</term>
<listitem><para>The name of the source of the event log. It must be a subkey of
a log file entry under the EventLog key in the registry. If, for example, the
registry looks as follows:
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
      EventLog
        Application
          WinApp1
        Security
          WinApp2
        System
</programlisting>
&quot;Application&quot;, &quot;Security&quot;, &quot;System&quot;,
&quot;WinApp1&quot;, and &quot;WinApp2&quot; are valid sources. If the source is
not found, the &quot;Application Log&quot; is used.</para>
<para>This argument is only used if the event log was not opened
before.</para>
</listitem></varlistentry>
<varlistentry><term>start</term>
<listitem><para>The record number of the event log record to be started.
The oldest record is always the first record regardless of the direction
specified.
</para></listitem></varlistentry>
<varlistentry><term>num</term>
<listitem><para>The number of the event log record to be read.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>
<programlisting>
evl = .WindowsEventLog~new

say " reading complete System log forwards without opening it before "

records = evl~read("FORWARDS", ,"System")

if records \= .nil then
  call DisplayRecords
else
  say "==> Error reading complete System event log"

exit 0   /* leave program */

DisplayRecords:

say records~items "records read"

do i=1 to records~items
  say "============================================================="
  temp = records[i]
  parse var temp type date time "&apos;" sourcename"&apos;" id,
  userid computer "&apos;" string "&apos;" "&apos;" data "&apos;"
  say "Type	: "type
  say "Date	: "date
  say "Time	: "time
  say "Source	: "sourcename
  say "ID	: "id
  say "UserId	: "userid
  say "Computer : "computer
  say "Detail	: "string
  say "Data 	: "data
end
return

::requires "winsystm.cls"
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthReadRecords"><title>readRecords</title>
<indexterm><primary>readRecords</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--readRecords(--x--,--y--)---------------------------------------><

]]>
</programlisting>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>x</term>
      <listitem>
        <para>
          xx.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
        <para>
          yyy,
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>0</term>
        <listitem>
          <para>
            Success
          </para>
        </listitem></varlistentry>
        <varlistentry><term>-1</term>
        <listitem>
          <para>
            Some error.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example ...
      <programlisting>
      <![CDATA[
      x = y
      return 0
      ]]>
      </programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::readRecords() -->

<section id="mthWrite"><title>write</title>
<indexterm><primary>write method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>write method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>
<programlisting>
<![CDATA[
>>-write--+-------------------------------------------------------------+-->
          |                                  +-1--+     +-0--------+    |
          +-(--+--------+--,--+--------+--,--+----+--,--+----------+--,-+
               +-server-+     +-source-+     +-0--+     +-category-+
                                             +-2--+
                                             +-4--+
                                             +-8--+
                                             +-10-+

>--+---------------------------------------+-------------------><
   | +-0--.                                |
   +-+----+--,--+------+--,--+--------+--)-+
     +-id-+     +-data-+     +-string-+
]]>
</programlisting>

<para>Writes event log records. If the event log was not opened with the Open
method, the event log specified by the <emphasis role="italic">server</emphasis>
and <emphasis role="italic">source</emphasis> is
opened and closed after processing.</para>
<variablelist>
<varlistentry><term>Arguments:</term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>server</term>
<listitem><para>The UNC (universal naming convention) name of the server on
which the event log is to be opened. If this argument is not specified, the
log is opened at the local machine.
</para></listitem></varlistentry>
<varlistentry><term>source</term>
<listitem><para>The name of the source of the event log. It must be a subkey of
a log file entry under the EventLog key in the registry. If, for example, the
registry looks as follows:
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
      EventLog
        Application
          WinApp1
        Security
          WinApp2
        System
</programlisting>
&quot;Application&quot;, &quot;Security&quot;, &quot;System&quot;,
&quot;WinApp1&quot;, and &quot;WinApp2&quot; are valid sources. If the source
is not found, the &quot;Application Log&quot; is used.
</para></listitem></varlistentry>
<varlistentry><term>type</term>
<listitem><para>The type of the events to be logged. It can be one of the
numbers listed in the syntax diagram:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>SUCCESS
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>ERROR, which is the default
</para></listitem></varlistentry>
<varlistentry><term>2</term>
<listitem><para>WARNING
</para></listitem></varlistentry>
<varlistentry><term>4</term>
<listitem><para>INFORMATION
</para></listitem></varlistentry>
<varlistentry><term>8</term>
<listitem><para>AUDIT SUCCESS
</para></listitem></varlistentry>
<varlistentry><term>10</term>
<listitem><para>AUDIT FAILURE
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>category</term>
<listitem><para>The event category. This is source-specific information that
can have any value. The default is 0.
</para></listitem></varlistentry>
<varlistentry><term>id</term>
<listitem><para>The event identifier specifying the message that, together with
the event, is an entry in the message file associated with the event source.
The default is 0.
</para></listitem></varlistentry>
<varlistentry><term>data</term>
<listitem><para>The binary data. This is source-specific information and can
be omitted.
</para></listitem></varlistentry>
<varlistentry><term>string</term>
<listitem><para>The strings merged into the message.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example writes the strings and the data to the
system log. &quot;MyApplication&quot; must be a subkey of a log file entry
under the EventLog key in the registry. If the source name cannot be found,
event logging uses the Application log file.</para>
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
        EventLog
        Application
        Security
          System
            MyApplication
	    </programlisting>
<programlisting>
evl~Write(,"MyApplication", , , ,"1A 1B 1C 0000 00"x, ,
"First String", "Second String")
</programlisting>
<para>See the <computeroutput>EventLog.REX</computeroutput> for
more examples.</para>
</listitem></varlistentry>
</variablelist>
</section>

<section id="mthClearWindowsEventLog"><title>clear</title>
<indexterm><primary>clear method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>clear method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>
<programlisting>
<![CDATA[
>>-clear-+------------------------------------------------------------+-><
         +-(--+--------------------------------------------------+--)-+
              +-server--+--------------------------------------+-+
                        +-,--+--------+--+-------------------+-+
                             +-source-+  +-,--backupFileName-+
]]>
</programlisting>

<para>Clears the specified event log and, optionally, saves a copy of the
current log file as a backup file. If the event log was not opened with the
Open method, the event log specified by the
<emphasis role="italic">server</emphasis> and
<emphasis role="italic">source</emphasis> is opened.
The event log is closed after it is cleared.</para>
<variablelist>
<varlistentry><term>Arguments:</term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>server</term>
<listitem><para>The UNC (universal naming convention) name of the server on
which the event log is to be opened. If this argument is not specified, the
log is opened at the local machine.</para>
<para>This argument is only used if the event log was not
opened before.</para>
</listitem></varlistentry>
<varlistentry><term>source</term>
<listitem><para>The name of the source of the event log. It must be a subkey
of a log file entry under the EventLog key in the registry. If, for example,
the registry looks as follows:
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
      EventLog
        Application
          WinApp1
        Security
          WinApp2
        System
</programlisting>
&quot;Application&quot;, &quot;Security&quot;, &quot;System&quot;,
&quot;WinApp1&quot;, and &quot;WinApp2&quot; are valid sources. If the source
is not found, the &quot;Application Log&quot; is used.</para>
<para>This argument is only used if the event log was not opened
before.</para>
</listitem></varlistentry>
<varlistentry><term>backupFileName</term>
<listitem><para>The name of a file to which the copy of the current event log
file is to be written. If this file already exists, the function fails.
The file can reside on a remote server. </para>
<para>If you omit this argument, the current event
log file is not backed up but cleared.</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a backup of the Application event log
of the local machine and clears it:</para>
<programlisting>
event_log~CLEAR(, ,"e:\evlbackup\application.evt")
</programlisting>
<para>The following example creates a backup of the System event log on
the server \\SERVER01 and clears it:</para>
<programlisting>
event_log~CLEAR("\\SERVER01","System","e:\evlbackup\system_server01.evt")
</programlisting>
<para>The following example clears the Application log on the local
machine without a backup:</para>
<programlisting>
event_log~CLEAR
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>

<section id="mthMinimumRead"><title>minimumRead</title>
<indexterm><primary>minimumRead</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--minimumRead(--x--,--y--)---------------------------------------><

]]>
</programlisting>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>x</term>
      <listitem>
        <para>
          xx.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
        <para>
          yyy,
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>0</term>
        <listitem>
          <para>
            Success
          </para>
        </listitem></varlistentry>
        <varlistentry><term>-1</term>
        <listitem>
          <para>
            Some error.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example ...
      <programlisting>
      <![CDATA[
      x = y
      return 0
      ]]>
      </programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumRead() -->

<section id="mthMinimumReadEquals"><title>minimumRead=</title>
<indexterm><primary>minimumRead=</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--minimumRead(--x--,--y--)---------------------------------------><

]]>
</programlisting>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>x</term>
      <listitem>
        <para>
          xx.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
        <para>
          yyy,
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>0</term>
        <listitem>
          <para>
            Success
          </para>
        </listitem></varlistentry>
        <varlistentry><term>-1</term>
        <listitem>
          <para>
            Some error.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example ...
      <programlisting>
      <![CDATA[
      x = y
      return 0
      ]]>
      </programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::minimumRead() -->


<section id="mthIsFull"><title>isFull</title>
<indexterm><primary>isFull</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isFull(--x--,--y--)---------------------------------------><

]]>
</programlisting>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>x</term>
      <listitem>
        <para>
          xx.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
        <para>
          yyy,
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>0</term>
        <listitem>
          <para>
            Success
          </para>
        </listitem></varlistentry>
        <varlistentry><term>-1</term>
        <listitem>
          <para>
            Some error.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example ...
      <programlisting>
      <![CDATA[
      x = y
      return 0
      ]]>
      </programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::isFull() -->


<section id="mthGetNumber"><title>getNumber</title>
<indexterm><primary>getNumber method</primary>
<secondary>of WindowsEventLog class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>getNumber method</secondary>
<tertiary>of WindowsEventLog class</tertiary></indexterm>
<programlisting>
<![CDATA[
>>-getNumber-+---------------------------------+---------------><
             +-(--+-----------------------+--)-+
                  +-server--+-----------+-+
                            +-,--source-+
]]>
</programlisting>

<para>Retrieves the number of records in the specified event log. If the event
log was not opened with the Open method, the event log specified by the
<emphasis role="italic">server</emphasis> and
<emphasis role="italic">source</emphasis> is opened and closed after processing.
</para>
<variablelist>
<varlistentry><term>Arguments:</term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>server</term>
<listitem><para>The UNC (universal naming convention) name of the server on
which the event log is to be opened. If this argument is not specified, the log
is opened at the local machine.</para>
<para>This argument is only used if the event log was not
opened before.</para>
</listitem></varlistentry>
<varlistentry><term>source</term>
<listitem><para>The name of the source of the event log. It must be a subkey of
a log file entry under the EventLog key in the registry. If, for example, the
registry looks as follows:
<programlisting>
HKEY_LOCAL_MACHINE
  System
    CurrentControlSet
      Services
      EventLog
        Application
          WinApp1
        Security
          WinApp2
        System
</programlisting>
&quot;Application&quot;, &quot;Security&quot;, &quot;System&quot;,
&quot;WinApp1&quot;, and &quot;WinApp2&quot; are valid sources. If the source
is not found, the &quot;Application Log&quot; is used.</para>
<para>This argument is only used if the event log was not opened
before.</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example returns the number of event log records
in the Application log of the local machine:
<programlisting>
num = event_log~getNumber
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthGetLogNames"><title>getLogNames</title>
<indexterm><primary>getLogNames</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getLogNames(--x--,--y--)---------------------------------------><

]]>
</programlisting>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>x</term>
      <listitem>
        <para>
          xx.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
        <para>
          yyy,
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>0</term>
        <listitem>
          <para>
            Success
          </para>
        </listitem></varlistentry>
        <varlistentry><term>-1</term>
        <listitem>
          <para>
            Some error.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example ...
      <programlisting>
      <![CDATA[
      x = y
      return 0
      ]]>
      </programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::getLogNames() -->


<section id="mthGetLast"><title>getLast</title>
<indexterm><primary>getLast</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getLast(--x--,--y--)---------------------------------------><

]]>
</programlisting>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>x</term>
      <listitem>
        <para>
          xx.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
        <para>
          yyy,
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>0</term>
        <listitem>
          <para>
            Success
          </para>
        </listitem></varlistentry>
        <varlistentry><term>-1</term>
        <listitem>
          <para>
            Some error.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example ...
      <programlisting>
      <![CDATA[
      x = y
      return 0
      ]]>
      </programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::getLast() -->


<section id="mthGetFirst"><title>getFirst</title>
<indexterm><primary>getFirst</primary>
<secondary>WindowsEventLog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getFirst(--x--,--y--)---------------------------------------><

]]>
</programlisting>

<para>
  Description
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>x</term>
      <listitem>
        <para>
          xx.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
        <para>
          yyy,
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>0</term>
        <listitem>
          <para>
            Success
          </para>
        </listitem></varlistentry>
        <varlistentry><term>-1</term>
        <listitem>
          <para>
            Some error.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example ...
      <programlisting>
      <![CDATA[
      x = y
      return 0
      ]]>
      </programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WindowsEventLog::getFirst() -->


</chapter>

