<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference SGML file.
    #
    # Copyright (c) 2005-2010, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="clsListBox"><title>List Box Controls</title>
<indexterm><primary>ListBox class</primary></indexterm>
<para>The <computeroutput>ListBox</computeroutput> class provides methods to query and
modify list box controls.
</para>

<para>
  In addition to the methods of the class itself, the following methods from other classes in the ooDialog framework are
  needed, or are useful, when working with list box controls:
<variablelist>
  <varlistentry><term><emphasis role="bold">Instantiation:</emphasis></term>
  <listitem>
  <para>
    Use the <link linkend="mthNewListBox">newListBox</link>() method of the <link
    linkend="chpDialogObject">dialog</link> object to retrieve a list box object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Dynamic Definition:</emphasis></term>
  <listitem>
  <para>
    To dynamically create a list box in the dialog template of a <link linkend="clsUserDialog">UserDialog</link> use
    the <link linkend="mthCreateListBox">createListBox</link> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Notification</emphasis></term>
  <listitem>
  <para>
    To connect the <link linkend="ovvEvents">event</link> notifications sent by the underlying list box control to a
    method in the Rexx dialog object use the <link linkend="mthConnectListBoxEvent">connectListBoxEvent</link>)
    method.
  </para>
  </listitem></varlistentry>
</variablelist>
</para>

<section id="sctMethodsListBox"><title>Method Table</title>
<para>
  The following table provides links to the documentation for the primary methods and attributes used in working
  with ListBox objects, including the pertinent methods from other classes:
</para>
<table id="tblListBoxMethods" frame="all">
<title>ListBox Methods and Attributes</title>
<tgroup cols="2">
<colspec colwidth="1.75in">
<thead>
<row>
<entry>Method</entry>
<entry>Documentation</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Useful External Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="tmthNewListBox">newListBox</link></entry>
<entry>Obtains a ListBox object that represents a list box control in a dialog.</entry>
</row>
<row>
<entry><link linkend="tmthCreateListBox">createListBox</link></entry>
<entry>Creates a list box control in an <link linkend="clsUserDialog">UserDialog</link>.</entry>
</row>
<row>
<entry><link linkend="tmthConnectListBoxEvent">connectListBoxEvent</link></entry>
<entry>Connects ListBox event notifications to a Rexx dialog method.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="mthAddClsListBox">add</link></entry>
<entry>Adds a new item to the list.</entry>
</row>
<row>
<entry><link linkend="mthAddDirectoryClsListBox">addDirectory</link></entry>
<entry>Adds all or selected file names of a given directory to the list box.</entry>
</row>
<row>
<entry><link linkend="mthColumnWidthEquals">columnWidth=</link></entry>
<entry>Sets the width, in dialog units, of the list box columns in a multicolumn list box control. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthColumnWidthPxEquals">columnWidthPxEquals</link></entry>
<entry>Sets the width, in pixels, of the list box columns in a multicolumn list box control.</entry>
</row>
<row>
<entry><link linkend="mthDeleteClsListBox">delete</link></entry>
<entry>Removes a list item from the associated list box.</entry>
</row>
<row>
<entry><link linkend="mthDeleteAllClsListBox">deleteAll</link></entry>
<entry>Removes all list items from the associated list box.</entry>
</row>
<row>
<entry><link linkend="mthDeSelectIndex">deSelectIndex</link></entry>
<entry>Deselects the list entry at the specified position for multiple selection listboxes.</entry>
</row>
<row>
<entry><link linkend="mthDeSelectRange">deSelectRange</link></entry>
<entry>Removes the selection for one or more consecutive items of the associated multiselection list box.</entry>
</row>
<row>
<entry><link linkend="mthFindClsListBox">find</link></entry>
<entry>Searches the list box for a list entry containing a specified text.</entry>
</row>
<row>
<entry><link linkend="mthGetFirstVisible">getFirstVisible</link></entry>
<entry>Retrieves the index of the first visible list item in the list box.</entry>
</row>
<row>
<entry><link linkend="mthGetTextClsListBox">getText</link></entry>
<entry>Gets the text of the list item at the specified position in the list box.</entry>
</row>
<row>
<entry><link linkend="mthInsertClsListBox">insert</link></entry>
<entry>Inserts a new item into the list after the specified item.</entry>
</row>
<row>
<entry><link linkend="mthItemHeight">itemHeight</link></entry>
<entry>Retrieves the height, in dialog units, of the items in the list box. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthItemHeightPx">itemHeightPx</link></entry>
<entry>Retrieves the height, in pixels, of the items in the list box.</entry>
</row>
<row>
<entry><link linkend="mthItemHeightEquals">itemHeight=</link></entry>
<entry>Sets the height, in dialog units, of the items in the list box. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthItemHeightPxEquals">itemHeightPx=</link></entry>
<entry>Sets the height, in pixels, of the items in the list box.</entry>
</row>
<row>
<entry><link linkend="mthItemsClsListBox">items</link></entry>
<entry>Retrieves the number of items in the list box.</entry>
</row>
<row>
<entry><link linkend="mthMakeFirstVisibleClsListBox">makeFirstVisible</link></entry>
<entry>Scrolls the list box so the specified item is at the top of the visible range.</entry>
</row>
<row>
<entry><link linkend="mthModifyClsListBox">modify</link></entry>
<entry>Changes the text of the list item at the specified position.</entry>
</row>
<row>
<entry><link linkend="mthSelectClsListBox">select</link></entry>
<entry>Selects the list entry that matches the specified text.</entry>
</row>
<row>
<entry><link linkend="mthSelectedClsListBox">selected</link></entry>
<entry>Retrieves the text of the currently selected list entry.</entry>
</row>
<row>
<entry><link linkend="mthIsSingleSelection">isSingleSelection</link></entry>
<entry>Determine if a list box is a single-selection list box.</entry>
</row>
<row>
<entry><link linkend="mthSelectedIndexClsListBox">selectedIndex</link></entry>
<entry>Retrieves the index of the currently selected list entry.</entry>
</row>
<row>
<entry><link linkend="mthSelectedIndexes">selectedIndexes</link></entry>
<entry>Retrieves the indexes of all items that are currently selected in the
associated multiselection list box.</entry>
</row>
<row>
<entry><link linkend="mthSelectedItemsClsListBox">selectedItems</link></entry>
<entry>Retrieves the number of items that are currently selected in the
associated multiselection list box.</entry>
</row>
<row>
<entry><link linkend="mthSelectIndexClsListBox">selectIndex</link></entry>
<entry>Selects the list entry at the specified position.</entry>
</row>
<row>
<entry><link linkend="mthSelectRange">selectRange</link></entry>
<entry>Selects one or more consecutive items of the associated multiselection list box.</entry>
</row>
<row>
<entry><link linkend="mthSetTabulators">setTabulators</link></entry>
<entry>Sets the tabulators for the associated list box control.</entry>
</row>
<row>
<entry><link linkend="mthSetWidth">setWidth</link></entry>
<entry>Sets the internal width, in dialog units, of the list box. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthSetWidthPx">setWidthPx</link></entry>
<entry>Sets the internal width, in pixel, of the list box.</entry>
</row>
<row>
<entry><link linkend="mthWidth">width</link></entry>
<entry>Retrieves the internal width, in dialog units, of the associated list box. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthWidthPx">widthPx</link></entry>
<entry>Retrieves the internal width, in pixels, of the associated list box.</entry>
</row>
</tbody></tgroup>
</table>
</section>

<section id="tmthNewListBox"><title>newListBox (dialog object method)</title>
<para>
  <computeroutput>ListBox</computeroutput> objects can not be instantiated by the programmer from Rexx code using a <emphasis
  role="italic">new</emphasis>() method. Rather, a list box object is obtained by using the <link
  linkend="mthNewListBox">newListBox</link>() method of the <link linkend="chpDialogObject">dialog</link>
  object. The syntax is:
<programlisting>
<![CDATA[
>>--newListBox(--id--)---------------------------><

]]>
</programlisting>
</para>
</section>  <!-- End Dialog::newListBox() (dialog object method) -->


<section id="tmthCreateListBox"><title>createListBox (UserDialog method)</title>
<para>
  A list box control can be created in the dialog template of a <link linkend="clsUserDialog">UserDialog</link>
  through the <link linkend="mthCreateListBox">createListBox</link> method. The basic syntax is:

<programlisting>
<![CDATA[
>>--createListBox(-id-,--x-,--y-,--cx-,--cy-+----------+-+-------------+--)----><
                                            +-,--style-+ +-,--attrName-+

]]>
</programlisting>
</para>
</section>  <!-- End UserDialog::createListBox() (UserDialog method) -->


<section id="tmthConnectListBoxEvent"><title>connectListBoxEvent (dialog object method)</title>
<para>
  To connect event notifications from a list box  control use the <link
  linkend="mthConnectListBoxEvent">connectListBoxEvent</link> method of the <link
  linkend="chpDialogObject">dialog</link> object. The basic syntax is:

<programlisting> <![CDATA[
>>--connectListBoxEvent(--id--,--event--+----------------+--)------------------><
                                        +--,-methodName--+

]]>
</programlisting>
</para>
</section>  <!-- End EventNotification::connectListBoxEvent() (dialog object method) -->


<section id="mthAddClsListBox"><title>add</title>
<indexterm><primary>add</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>add</secondary></indexterm>
<programlisting>
<![CDATA[
>>--add(--listEntry--)---------------------------><


]]>
</programlisting>

<para>The add method adds a new item to the list. If
the list is not sorted, the new item is added to the end of the list.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>listEntry</term>
<listitem><para>A text string added to the list.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A one-based index that specifies the position at which the entry has
been added, or 0 or a value less than 0 to indicate an error.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::add() -->

<section id="mthInsertClsListBox"><title>insert</title>
<indexterm><primary>insert</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>insert</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>insert</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insert(--+-------+--,--listEntry--)----------><
             +-index-+


]]>
</programlisting>

<para>The insert method inserts a new item into the list
after the specified item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index (starting with 1) of the list item after which the new item
is to be added. If this argument is omitted, the list entry is added after
the currently selected item.
</para></listitem></varlistentry>
<varlistentry><term>listEntry</term>
<listitem><para>A text string added to the list.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A one-based index that specifies the position at which the entry has
been added, or 0 or a value less than 0 to indicate an error.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::() -->

<section id="mthDeleteClsListBox"><title>delete</title>
<indexterm><primary>delete</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>delete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--delete(--+-------+--)------------------------><
             +-index-+


]]>
</programlisting>

<para>The delete method removes a list item from the
associated list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index (starting with 1) of the list item to be removed from the
list. If this argument is omitted, the currently selected item is deleted.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of remaining list items, or 0 to indicate an error.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::delete() -->

<section id="mthDeleteAllClsListBox"><title>deleteAll</title>
<indexterm><primary>deleteAll</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>deleteAll</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deleteAll------------------------------------><


]]>
</programlisting>

<para>The deleteAll method removes all list items from
the associated list box.</para>
</section>  <!-- End ListBox::deleteAll() -->

<section id="mthFindClsListBox"><title>find</title>
<indexterm><primary>find</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>find</secondary></indexterm>
<programlisting>
<![CDATA[
>>--find(--TextorPrefix--+---------------------------------+--)----------------><
                         +-,--+------------+--+----------+-+
                              +-startIndex-+  +-,--exact-+


]]>
</programlisting>

<para>The find method searches the list box for a list
entry containing the specified text or prefix. The search is caseless.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>TextorPrefix</term>
<listitem><para>The text or prefix for which the list is searched.
</para></listitem></varlistentry>
<varlistentry><term>startIndex</term>
<listitem><para>The first list item at which the search is to be started. When the search
reaches the bottom of the list, it is continued backward. If you omit this
argument or specify 0, the entire list is searched.
</para></listitem></varlistentry>
<varlistentry><term>exact</term>
<listitem><para>If you specify 1 or E, the text of the list item must exactly match
the text specified for <emphasis role="italic">TextorPrefix</emphasis>. If you omit this argument or
specify 0, the list entries are searched for a prefix that matches <emphasis role="italic">TextorPrefix</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based index of the list entry that matches the search text,
or 0 if not found.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::find() -->

<section id="mthSelectedIndexClsListBox"><title>selectedIndex</title>
<indexterm><primary>selectedIndex</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>selectedIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selectedIndex--------------------------------><


]]>
</programlisting>

<para>The selectedIndex method retrieves the
index of the currently selected list entry. This entry is highlighted and
surrounded by a dotted border. To get the selected items for a multiple selection
listbox, use getListBoxData; see <link linkend="mthGetListBoxData">getListBoxData</link>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based index of the currently selected list entry, or 0 if none
is selected.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::selectedIndex() -->

<section id="mthSelectedClsListBox"><title>selected</title>
<indexterm><primary>selected</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>selected</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selected-------------------------------------><


]]>
</programlisting>

<para>The selected method retrieves the text of the currently
selected list entry.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The text of the currently selected list entry, or an empty string if
none is selected.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::selected() -->

<section id="mthSelectIndexClsListBox"><title>selectIndex</title>
<indexterm><primary>selectIndex</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>selectIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selectIndex(--index--)-----------------------><


]]>
</programlisting>

<para>The selectIndex method selects the list
entry at the specified position. The currently selected list item is highlighted
and surrounded by a dotted border. To select multiple items of a multiple
selection listbox, use the <link linkend="mthSetListBoxData">setListBoxData</link>() method.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index (starting with 1) of the list item to be selected. If you
specify 0 for this argument, the list box must not contain any selection.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if an error occurred or you specified 0 for <emphasis role="italic">index</emphasis> to remove
the selection.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::selectIndex() -->

<section id="mthDeSelectIndex"><title>deSelectIndex</title>
<indexterm><primary>deSelectIndex</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>deSelectIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deSelectIndex(--+-------+--)-----------------><
                    +-index-+


]]>
</programlisting>

<para>The deSelectIndex method deselects the list entry
at the specified position for multiple selection listboxes. The currently
selected list item is highlighted and surrounded by a dotted border.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index (starting with 1) of the list item to be deselected. If you
specify no index or 0 for this argument, all items are deselected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>-1 if an error occurred.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::deSelectIndex() -->

<section id="mthIsSingleSelection"><title>isSingleSelection</title>
<indexterm><primary>isSingleSelection</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>isSingleSelection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isSingleSelection----------------------------><

]]>
</programlisting>

<para>
  Determine if a list box is a single-selection list box. In a single-selection list box,
  the user can select only one item at a time.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if the list box is a single-selection list box, otherwise
    <computeroutput>.fase</computeroutput>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::isSingleSelection() -->

<section id="mthSelectClsListBox"><title>select</title>
<indexterm><primary>select</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>select</secondary></indexterm>
<programlisting>
<![CDATA[
>>--select(--itemText--)-------------------------><

]]>
</programlisting>

<para>The select method selects the list entry that matches
the specified text.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>itemText</term>
<listitem><para>The text that the list box is searched for.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if an error occurred or a matching list entry was not found.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::select() -->

<section id="mthSelectRange"><title>selectRange</title>
<indexterm><primary>selectRange</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>selectRange</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selectRange(--+-------------+--+-------------+--)--------------------------><
                  +-startIndex--+  +-,--endIndex-+

]]>
</programlisting>

<para>The selectRange method selects one or more consecutive
items of the associated multiselection list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:</para>
<variablelist>
<varlistentry><term>startIndex</term>
<listitem><para>The position of the first list item to be selected. If this argument
is omitted, the selection range starts with the first item in the list.
</para></listitem></varlistentry>
<varlistentry><term>endIndex</term>
<listitem><para>The position of the last list item to be selected. If this argument
is omitted, the selection range ends with the last item in the list.
</para></listitem></varlistentry>
</variablelist>
<para>If <emphasis role="italic">startIndex</emphasis> is equal to <emphasis role="italic">endIndex</emphasis>, a single item
of the list is selected.</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>-1 if an error occurred. This can happen, for example, if the
list box is not a multiselection list box.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example selects the items 5 through 9:</para>
<programlisting>
<![CDATA[
lb = self~newListBox("Offers")
if lb == .Nil then return
lb~selectRange(5,9)
]]>
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::selectRange() -->

<section id="mthDeSelectRange"><title>deSelectRange</title>
<indexterm><primary>deSelectRange</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>deSelectRange</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deSelectRange(--+-------------+--+-------------+--)------------------------><
                    +-startIndex--+  +-,--endIndex-+

]]>
</programlisting>

<para>The deSelectRange method removes the selection
for one or more consecutive items of the associated multiselection list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:</para>
<variablelist>
<varlistentry><term>startIndex</term>
<listitem><para>The position of the first list item to be deselected. If this argument
is omitted, the deselection range starts with the first item in the list.
</para></listitem></varlistentry>
<varlistentry><term>endIndex</term>
<listitem><para>The position of the last list item to be deselected. If this argument
is omitted, the deselection range ends with the last item in the list.
</para></listitem></varlistentry>
</variablelist>
<para>If <emphasis role="italic">startIndex</emphasis> is equal to <emphasis role="italic">endIndex</emphasis>, a single item
of the list is deselected.</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>-1 if an error occurred. This can happen, for example, if the
list box is no multiselection list box.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example deselects the items 1 through 5:</para>
<programlisting>
<![CDATA[
lb = self~newListBox("Offers")
if lb == .Nil then return
lb~deSelectRange(,6)
]]>
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::deSelectRange() -->

<section id="mthItemsClsListBox"><title>items</title>
<indexterm><primary>items</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>items</secondary></indexterm>
<programlisting>
<![CDATA[
>>--items----------------------------------------><


]]>
</programlisting>

<para>The items method retrieves the number of items
in the list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of items in the list box.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::items() -->

<section id="mthSelectedItemsClsListBox"><title>selectedItems</title>
<indexterm><primary>selectedItems</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>selectedItems</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selectedItems--------------------------------><


]]>
</programlisting>

<para>The selectedItems method retrieves the number of
items that are currently selected in the associated multiselection list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of selected items, or -1 if this method fails, for
example if the list box is no multiselection list box.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>For an example, refer to <link linkend="mthSelectedIndexes">SelectedIndexes</link>.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::selectedItems() -->

<section id="mthSelectedIndexes"><title>selectedIndexes</title>
<indexterm><primary>selectedIndexes</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>selectedIndexes</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selectedIndexes------------------------------><

]]>
</programlisting>

<para>The selectedIndexes method retrieves the indexes
of all items that are currently selected in the associated multiselection
list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A text string containing the indexes of the selected items in the list,
separated by blanks.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example lists all items selected in the associated multiselection
list box:
<programlisting>
<![CDATA[
lb = self~newListBox("Offers")
if lb == .Nil then return
sit = lb~selectedItems
if sit > 0 then do
   say "You ordered:"
   sndx = lb~selectedIndexes
   do i = 1 to sit
      parse var sndx order sndx
      say "1 x" lb~getText(order)
   end
end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::selectedIndexes() -->

<section id="mthMakeFirstVisibleClsListBox"><title>makeFirstVisible</title>
<indexterm><primary>makeFirstVisible</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>makeFirstVisible</secondary></indexterm>
<programlisting>
<![CDATA[
>>--makeFirstVisible(--index--)------------------><


]]>
</programlisting>

<para>The makeFirstVisible method makes the list entry
at the specified position the first visible list item when you scroll up or
down.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The one-based index of the list box item to be made first visible.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>-1 if an error occurred.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::makeFirstVisible() -->

<section id="mthGetFirstVisible"><title>getFirstVisible</title>
<indexterm><primary>getFirstVisible</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>getFirstVisible</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getFirstVisible------------------------------><


]]>
</programlisting>

<para>The getFirstVisible method retrieves the index
of the first list item visible in the list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based index of the list box item visible first.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::getFirstVisible() -->

<section id="mthGetTextClsListBox"><title>getText</title>
<indexterm><primary>getText</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>getText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getText(--index--)---------------------------><


]]>
</programlisting>

<para>The getText method gets the text of the list item
at the specified position in the list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The one-based index of the list box item containing the text you are
interested in.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The text of the list box item at the given position, or an empty string
if the <emphasis role="italic">index</emphasis> does not refer to an item or an error occurred.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::getText() -->

<section id="mthModifyClsListBox"><title>modify</title>
<indexterm><primary>modify</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>modify</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modify(--+-------+--,--newText--)------------><
             +-index-+


]]>
</programlisting>

<para>The modify method changes the text of the list
item at the specified position in the list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The one-based index of the list box item of which the text is to be
changed. If you omit this argument, the currently selected item is modified.
</para></listitem></varlistentry>
<varlistentry><term>newText</term>
<listitem><para>The new text string to be displayed at the given position.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based index of the modified list box item at the given position.
The return value is 0 if an error occurred, or -1 if the <emphasis role="italic">index</emphasis>
does not refer to an item.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::modify() -->

<section id="mthSetTabulators"><title>setTabulators</title>
<indexterm><primary>setTabulators</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>setTabulators</secondary></indexterm>
<programlisting>
<![CDATA[
                    +-,------+
                    V        |
>>--setTabulators(----tabPos-+--)----------------><


]]>
</programlisting>

<para>The setTabulators method sets the tabulators for
the associated list box control. This enables you to use items containing
tab characters ("09"x), which is useful if you want to format the
list in more than one column when using proportional fonts.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>tabPos</term>
<listitem><para>The position or positions of the tabs relative to the left edge of the
list box, in dialog units.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>1 if an error occurred.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a list that can handle up to three tabulators
in a list entry. The tabulator positions are 10, 20, and 30.
<programlisting>
<![CDATA[
lb = MyDialog~newListBox(102)
if lb == .Nil then return
lb~setTabulators(10, 20, 30)
lb~add(textcol1 || "09"x || textcol2 || "09"x || textcol3 || "09"x ||,
   textcol4)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::setTabulators() -->

<section id="mthAddDirectoryClsListBox"><title>addDirectory</title>
<indexterm><primary>addDirectory</primary><secondary>ListBox class</secondary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>addDirectory</secondary></indexterm>
<programlisting>
<![CDATA[

>>--addDirectory(--drvPath--+-------------------+--)---------------------------><
                            +-,-fileAttributes--+


]]>
</programlisting>

<para>
  The addDirectory method adds all or selected file names of a given directory to the list box.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>drvPath [required]</term>
      <listitem>
      <para>
        The drive, path, and name pattern.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fileAttributes [optional]</term>
      <listitem>
      <para>
        A list of 0 or more of the following keywords separated by spaces, case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>READWRITE</member>
          <member>READONLY </member>
          <member>HIDDEN   </member>
          <member>SYSTEM   </member>
          <member>DIRECTORY</member>
          <member>ARCHIVE  </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>READWRITE</term>
          <listitem>
          <para>
            Normal read/write files. This is the default if this argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>READONLY</term>
          <listitem>
          <para>
            Files that have the read-only bit.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HIDDEN</term>
          <listitem>
          <para>
            Files that have the hidden bit.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SYSTEM</term>
          <listitem>
          <para>
            Files that have the system bit.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DIRECTORY</term>
          <listitem>
          <para>
            Files that have the directory bit.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ARCHIVE</term>
          <listitem>
          <para>
            Files that have the archive bit.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The one-based index of the file added last to the list, or 0 if an error occurred.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example puts the names of all read/write files with extension .REX in the given directory of the list
    box:
<programlisting>
<![CDATA[

  self~addDirectory(203, drive":\"path"\*.rex", "READWRITE")
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::addDirectory() -->

<section id="mthSetWidth"><title>setWidth</title>
<indexterm><primary>setWidth</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>setWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setWidth(--width--)--------------------------><


]]>
</programlisting>

<para>The setWidth method sets the internal width of
the list box, in dialog units. If the internal width exceeds the width of
the list box control and the list box has the HSCROLL style, the list box
provides a horizontal scroll bar.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>width</term>
<listitem><para>The width of the list box, in dialog units.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets the internal width twice the width of the
list box control:
<programlisting>
<![CDATA[
lb = MyDialog~newListBox(102)
if lb == .Nil then return
lb~setWidth(lb~SizeX*2)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::setWidth() -->

<section id="mthSetWidthPx"><title>setWidthPx</title>
<indexterm><primary>setWidthPx</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>setWidthPx</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setWidthPx(--width--)------------------------><


]]>
</programlisting>

<para>The setWidthPx method sets the internal width of
the list box, in pixels. If the internal width exceeds the width of
the list box control and the list box has the HSCROLL style, the list box
provides a horizontal scroll bar.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>width</term>
<listitem><para>The width of the list box, in pixels.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::setWidthPx() -->

<section id="mthWidth"><title>width</title>
<indexterm><primary>width</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>width</secondary></indexterm>
<programlisting>
<![CDATA[
>>--width----------------------------------------><


]]>
</programlisting>

<para>The width method retrieves the internal width of
the associated list box, in dialog units.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The internal width of the list box, in dialog units, or 0 if an error
occurred.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::width() -->

<section id="mthWidthPx"><title>widthPx</title>
<indexterm><primary>widthPx</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>width</secondary></indexterm>
<programlisting>
<![CDATA[
>>--widthPx--------------------------------------><


]]>
</programlisting>

<para>The widthPx method retrieves the internal width of
the associated list box, in pixels.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The internal width of the list box, in pixels, or 0 if an error
occurred.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::widthPx() -->

<section id="mthItemHeight"><title>itemHeight</title>
<indexterm><primary>itemHeight</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>itemHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemHeight-----------------------------------><


]]>
</programlisting>

<para>The itemHeight method retrieves the height of the
items in the list box, in dialog units.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The height of the list box items, in dialog units.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::itemHeight() -->

<section id="mthItemHeightPx"><title>itemHeightPx</title>
<indexterm><primary>itemHeightPx</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>itemHeightPx</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemHeightPx---------------------------------><


]]>
</programlisting>

<para>The itemHeightPx method retrieves the height of the
items in the list box, in pixels.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The height of the list box items, in pixels.
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::itemHeightPx() -->

<section id="mthItemHeightEquals"><title>itemHeight=</title>
<indexterm><primary>itemHeight=</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>itemHeight=</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemHeight=--height--------------------------><


]]>
</programlisting>

<para>The itemHeight= method sets the height of the items
in the list box, in dialog units.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>height</term>
<listitem><para>The height of all list box items, in dialog units.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::itemHeight=() -->

<section id="mthItemHeightPxEquals"><title>itemHeightPx=</title>
<indexterm><primary>itemHeightPx=</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>itemHeightPx=</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemHeightPx=--height------------------------><


]]>
</programlisting>

<para>The itemHeightPx= method sets the height of the items
in the list box, in pixels.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>height</term>
<listitem><para>The height of all list box items, in pixels.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::itemHeightPx=() -->

<section id="mthColumnWidthEquals"><title>columnWidth=</title>
<indexterm><primary>columnWidth=</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>columnWidth=</secondary></indexterm>
<programlisting>
<![CDATA[
>>--columnWidth=--width--------------------------><


]]>
</programlisting>

<para>The columnWidth= method sets the width of the list
box columns in a multicolumn list box control, in dialog units.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>width</term>
<listitem><para>The width of all list box columns, in dialog units.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::olumnWidth=() -->

<section id="mthColumnWidthPxEquals"><title>columnWidthPx=</title>
<indexterm><primary>columnWidthPx=</primary></indexterm>
<indexterm><primary>ListBox class</primary><secondary>columnWidthPx=</secondary></indexterm>
<programlisting>
<![CDATA[
>>--columnWidthPx=--width------------------------><


]]>
</programlisting>

<para>The columnWidthPx= method sets the width of the list
box columns in a multicolumn list box control, in pixels.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>width</term>
<listitem><para>The width of all list box columns, in pixels.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>  <!-- End ListBox::columnWidthPx=() -->


</chapter>
