<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference SGML file.
    #
    # Copyright (c) 2005-2010, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->

<chapter id="clsEdit"><title>Edit Controls</title>
<indexterm><primary>Edit class</primary></indexterm>
<para>
  An edit control is a rectangular window that allows the user to enter and edit text using the keyboard. Edit controls
  have two line styles, single-line and multiline.
</para>
<para>
  When the edit control has the focus it displays a blinking line called the caret that marks the insertion point in the
  control. The insertion point can be changed using the keyboard or the mouse. Text can be selected, also using the
  keyboard or mouse.
</para>
<para>
  The <computeroutput>Edit</computeroutput> class provides methods to work with and manipulate the underlying
  Windows edit dialog control which it represents. It is a concrete subclass of the dialog control <link
  linkend="chpDialogControlObject">object</link> and therefore has all methods of the of the dialog control object.
</para>
<para>
  In addition to the methods of the class itself, the following methods from other classes in the ooDialog framework are
  needed, or are useful, when working with edit controls:
<variablelist>
  <varlistentry><term><emphasis role="bold">Instantiation:</emphasis></term>
  <listitem>
  <para>
    Use the <link linkend="tmthNewEdit">newEdit</link>() method of the <link
    linkend="chpDialogObject">dialog</link> object to retrieve a new Edit object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Dynamic Definition:</emphasis></term>
  <listitem>
  <para>
    To dynamically define an edit in a <link linkend="clsUserDialog">UserDialog</link> class, use the <link
    linkend="mthCreateEdit">createEdit</link> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Notification</emphasis></term>
  <listitem>
  <para>
    To connect the <link linkend="ovvEvents">event</link> notifications sent by the underlying edit control to
    a method in the Rexx dialog object use the <link linkend="mthConnectEditEvent">connectEditEvent</link>()
    method.
  </para> </listitem></varlistentry>
</variablelist> </para>

<section id="sctMethodsEdit"><title>Method Table</title>
<para>
  The following table provides links to the documentation for the primary methods and attributes used in working
  with Edit objects, including the pertinent methods from other classes:
</para>
<table id="tblEditMethods" frame="all">
<title>Important Edit Methods</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Useful</emphasis></entry>
<entry align="center"><emphasis role="bold">External Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="tmthNewEdit">newEdit</link></entry>
<entry>Returns an <computeroutput>Edit</computeroutput> object for the edit control with the specified ID.</entry>
</row>
<row>
<entry><link linkend="tmthCreateEdit">createEdit</link></entry>
<entry>Creates an edit control in the dialog template of a <link linkend="clsUserDialog">UserDialog</link></entry>
</row>
<row>
<entry><link linkend="tmthConnectEditEvent">connectEditEvent</link></entry>
<entry>Connects an edit control event notification to a method in the Rexx dialog object</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
</row>
<row>
<entry><link linkend="atrPasswordChar">passwordChar</link></entry>
<entry>Set or get the password character for an edit control with the PASSWORD style.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="mthAddStyle">addStyle</link></entry>
<entry>Adds one or more edit control styles to the edit control.</entry>
</row>
<row>
<entry><link linkend="mthCanUndo">canUndo</link></entry>
<entry>Determines if there are any actions in the undo queue of the edit control.</entry>
</row>
<row>
<entry><link linkend="mthClearText">clearText</link></entry>
<entry>Deletes the currently selected text from the edit control.</entry>
</row>
<row>
<entry><link linkend="mthCopyText">copyText</link></entry>
<entry>Copies the currently selected text to the clipboard in text format.</entry>
</row>
<row>
<entry><link linkend="mthCutText">cutText</link></entry>
<entry>Deletes the currently selected text in the edit control and copies it to the clipboard.</entry>
</row>
<row>
<entry><link linkend="mthDisableInternalResize">disableInternalResize</link></entry>
<entry>Prevents the edit control from internally resizing itself when its owner dialog is resized.</entry>
</row>
<row>
<entry><link linkend="mthEnsureCaretVisibility">ensureCaretVisibility</link></entry>
<entry>Scrolls the edit control until the caret (cursor) is visible.</entry>
</row>
<row>
<entry><link linkend="mthFirstVisibleLine">firstVisibleLine</link></entry>
<entry>Retrieves the index of the first visible line, or the first visible character, in a edit control.</entry>
</row>
<row>
<entry><link linkend="mthGetCue">getCue</link></entry>
<entry>Retrieves the text of the cue for an edit control.</entry>
</row>
<row>
<entry><link linkend="mthGetLine">getLine</link></entry>
<entry>getLine</entry>
</row>
<row>
<entry><link linkend="mthGetMargins">getMargins</link></entry>
<entry>xx</entry>
</row>
<row>
<entry><link linkend="mthGetStyle">getStyle</link></entry>
<entry>getStyle</entry>
</row>
<row>
<entry><link linkend="mthHideBalloon">hideBalloon</link></entry>
<entry>hideBalloon</entry>
</row>
<row>
<entry><link linkend="mthIsModified">isModified</link></entry>
<entry>isModified</entry>
</row>
<row>
<entry><link linkend="mthIsSingleLine">isSingleLine</link></entry>
<entry>xx</entry>
</row>
<row>
<entry><link linkend="mthLineFromIndex">lineFromIndex</link></entry>
<entry>lineFromIndex</entry>
</row>
<row>
<entry><link linkend="mthLineIndex">lineIndex</link></entry>
<entry>lineIndex</entry>
</row>
<row>
<entry><link linkend="mthLineLength">lineLength</link></entry>
<entry>lineLength</entry>
</row>
<row>
<entry><link linkend="mthLines">lines</link></entry>
<entry>lines</entry>
</row>
<row>
<entry><link linkend="mthLineScroll">lineScroll</link></entry>
<entry>lineScroll</entry>
</row>
<row>
<entry><link linkend="mthMargins">margins</link></entry>
<entry>margins</entry>
</row>
<row>
<entry><link linkend="mthNoContextMenu">noContextMenu</link></entry>
<entry>xx</entry>
</row>
<row>
<entry><link linkend="mthPasteText">pasteText</link></entry>
<entry>xx</entry>
</row>
<row>
<entry><link linkend="mthRemoveStyle">removeStyle</link></entry>
<entry>removeStyle</entry>
</row>
<row>
<entry><link linkend="mthReplaceSelText">replaceSelText</link></entry>
<entry>replaceSelText</entry>
</row>
<row>
<entry><link linkend="mthReplaceStyle">replaceStyle</link></entry>
<entry>replaceStyle</entry>
</row>
<row>
<entry><link linkend="mthScrollCommand">scrollCommand</link></entry>
<entry>scrollCommand</entry>
</row>
<row>
<entry><link linkend="mthSelectClsEdit">select</link></entry>
<entry>select</entry>
</row>
<row>
<entry><link linkend="mthSelectedClsEdit">selected</link></entry>
<entry>selected</entry>
</row>
<row>
<entry><link linkend="mthSelection">selection</link></entry>
<entry>xx</entry>
</row>
<row>
<entry><link linkend="mthSetCue">setCue</link></entry>
<entry>setCue</entry>
</row>
<row>
<entry><link linkend="mthSetLimit">setLimit</link></entry>
<entry>setLimit</entry>
</row>
<row>
<entry><link linkend="mthSetMargins">setMargins</link></entry>
<entry>setMargins</entry>
</row>
<row>
<entry><link linkend="mthSetModified">setModified</link></entry>
<entry>setModified</entry>
</row>
<row>
<entry><link linkend="mthSetReadOnly">setReadOnly</link></entry>
<entry>setReadOnly</entry>
</row>
<row>
<entry><link linkend="mthSetTabStops">setTabStops</link></entry>
<entry>setTabStops</entry>
</row>
<row>
<entry><link linkend="mthShowBalloon">showBalloon</link></entry>
<entry>showBalloon</entry>
</row>
<row>
<entry><link linkend="mthTabEquals">tab=</link></entry>
<entry>tab=</entry>
</row>
<row>
<entry><link linkend="mthUndo">undo</link></entry>
<entry>xx</entry>
</row>
</tbody></tgroup>
</table>
</section>


<section id="tmthNewEdit"><title>newEdit (dialog object method)</title>
<para>
  Edit objects can not be instantiated by the programmer from Rexx code. Rather an Edit object is obtained
  by using the <link linkend="mthNewEdit">newEdit</link>() method of the dialog <link
  linkend="chpDialogObject">object</link>. The syntax is:
<programlisting>
<![CDATA[
>>--newEdit(--id--)------------------------------><

]]>
</programlisting>
</para>
</section>  <!-- End newEdit() [PlainBaseDialog method] -->


<section id="tmthCreateEdit"><title>createEdit (UserDialog method)</title>
<para>
  An edit control can be added to the dialog template for a <link linkend="clsUserDialog">UserDialog</link>
  dialog through the <link linkend="mthCreateEdit">createEdit</link>() method. The basic syntax is:
<programlisting> <![CDATA[
>>--createEdit(-id-,--x-,--y-,--cx-,--cy-+---------+--+-----------------+--)---><
                                         +-,-style-+  +-,-attributeName-+

]]>
</programlisting>
</para>
</section>  <!-- End UserDialog::createEdit() [UserDialog method] -->


<section id="tmthConnectEditEvent"><title>connectEditEvent (dialog object method)</title>
<para>
  To connect event notifications from an edit control use the <link
  linkend="mthConnectEditEvent">connectEditEvent</link>() method of the <link
  linkend="chpDialogObject">dialog</link> object. The basic syntax is:

<programlisting> <![CDATA[
>>--connectEditEvent(--id--,--event--+----------------+--)-----><
                                     +--,-methodName--+

]]>
</programlisting>
</para>
</section>  <!-- End connectEditEvent() [EventNotification method] -->


<section id="atrPasswordChar"><title>passwordChar (Attribute)</title>
<indexterm><primary>passwordChar</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>passwordChar</secondary></indexterm>
<programlisting>
<![CDATA[
>>--passwordChar---------------------------------><

>>--passwordChar-=-varName-----------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">passwordChar</emphasis> attribute reflects the password character for a password edit
  control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">passwordChar get:</emphasis></term>
  <listitem>
  <para>
    Returns the current password character for the edit control, if it is set, otherwise the empty string.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">passwordChar set:</emphasis></term>
  <listitem>
  <para>
    Sets the password character for the edit control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The password character only has meaning if the edit control has the PASSWORD style, otherwise it is ignored.
    Multiline edit controls don't support the PASSWORD style or getting and setting the password character.
  </para>
  <para>
    When the operating system creates the underlying edit control, if it has the PASSWORD style, it sets the password
    character to the default. This is an astrisk for earlier versions of <link linkend="ovvComctl32">Comctl32</link>, a
    solid circle for Comctl32 version 6.0 and later.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::passwordChar() [attribute]  -->


<section id="mthSelectedClsEdit"><title>selected</title>
<indexterm><primary>selected</primary>
<secondary>Edit class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selected-------------------------------------><


]]>
</programlisting>

<para>The selected method retrieves the indexes of the
starting and ending character of the text selected. If the starting index
equals the ending index, no text is selected and the index specifies the current
cursor position. If the ending index is 0 and the starting index is 1, the
entire text is selected.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based starting and ending index of the current selection, separated
by a blank.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the starting and ending index of the
text selection of the edit control NAME. It then selects the entire text of
the edit control.
<programlisting>
<![CDATA[
edit = MyDialog~newEdit("NAME")
if edit == .Nil then return
parse value edit~selected with start end
say "Starting index of selection is" start
say "Ending index of selection is" end
edit~select(1,0)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectClsEdit"><title>select</title>
<indexterm><primary>select</primary>
<secondary>Edit class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--select(--start--,--end--)--------------------><


]]>
</programlisting>

<para>The select method selects the text or sets the
cursor position for the associated edit control. If the starting index equals
the ending index, no text is selected and the cursor is set to the character
at the specified index. If the ending index is 0 and the starting index is
1, the entire text is selected.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>start</term>
<listitem><para>A one-based index where the selection begins or the cursor is to be
set.
</para></listitem></varlistentry>
<varlistentry><term>end</term>
<listitem><para>A one-based index where the selection ends.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>See <link linkend="mthSelectedClsEdit">selected</link>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthScrollCommand"><title>scrollCommand</title>
<indexterm><primary>scrollCommand</primary></indexterm>
<programlisting>
<![CDATA[
                       +-UP--------+
>>--scrollCommand(--"--+-----------+--"--+----------------+--)-----------------><
                       +-LEFT------+     +-,--repetitions-+
                       +-DOWN------+
                       +-RIGHT-----+
                       +-PAGEUP----+
                       +-PAGELEFT--+
                       +-PAGEDOWN--+
                       +-PAGERIGHT-+


]]>
</programlisting>

<para>The scrollCommand method scrolls the associated
edit control in a given direction.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>command</term>
<listitem><para>Specifies the direction and the step size of the scroll command. Possible
values are:
<variablelist>
<varlistentry><term>UP or LEFT</term>
<listitem><para>Scrolls up one line. UP is the default.
</para></listitem></varlistentry>
<varlistentry><term>DOWN or RIGHT</term>
<listitem><para>Scrolls down one line.
</para></listitem></varlistentry>
<varlistentry><term>PAGEUP or PAGELEFT</term>
<listitem><para>Scrolls up one page.
</para></listitem></varlistentry>
<varlistentry><term>PAGEDOWN or PAGERIGHT</term>
<listitem><para>Scrolls down one page.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>repetitions</term>
<listitem><para>The number of times the scroll command is to be issued. If this argument
is omitted, the scroll command is issued once.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example scrolls down 3 lines in the edit control:
<programlisting>
<![CDATA[
edit = MyDialog~newEdit("NAME")
if edit == .Nil then return
edit~scrollCommand("DOWN",3)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthLineScroll"><title>lineScroll</title>
<indexterm><primary>lineScroll</primary></indexterm>
<programlisting>
<![CDATA[
>>--lineScroll(--sChars--,--sLines--)------------><


]]>
</programlisting>

<para>The lineScroll method scrolls the text in a multiline
edit control vertically or horizontally by the specified number of characters
and lines.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>sChars</term>
<listitem><para>The number of characters to be scrolled horizontally.
</para></listitem></varlistentry>
<varlistentry><term>sLines</term>
<listitem><para>The number of lines to be scrolled vertically.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if the message is sent to a multiline edit control, or a non-zero
value if the message is sent to a single-line edit control.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example scrolls an edit control by 50 characters and 35
lines:
<programlisting>
<![CDATA[
edit~scroll(50, 35)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
The edit control does not scroll vertically past the last
line of text. If the current line, plus the number of lines specified by <emphasis role="italic">sLines</emphasis>, exceeds the total number of lines in the edit control, the last
line of the edit control is scrolled to the top. The lineScroll message can,
however, be used to scroll horizontally past the last character of a line.
</para></note>
</section>

<section id="mthCanUndo"><title>canUndo</title>
<indexterm><primary>canUndo</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>canUndo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--canUndo--------------------------------------><

]]>
</programlisting>

<para>
  Determines if there are any actions in the undo queue of the edit control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is <computeroutput>.true</computeroutput> if there are actions in the undo queue, otherwise
    <computeroutput>.false</computeroutput>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the undo queue is not empty, the <link linkend="mthUndo">undo</link> method can be used to undo the most recent
    operation.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::canUndo() -->

<section id="mthClearText"><title>clearText</title>
<indexterm><primary>clearText</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>clearText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--clearText------------------------------------><

]]>
</programlisting>

<para>
  Deletes (clears) the current selected text, if any, from the edit control
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the <emphasis role="italic">clearText</emphasis> method is used to delete the selected text, the deletion can
    be undone using the <link linkend="mthUndo">undo</link> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::clearText() -->

<section id="mthCopyText"><title>copyText</title>
<indexterm><primary>copyText</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>copyText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--copyText-------------------------------------><

]]>
</programlisting>

<para>
  Copies the currently selected text to the clipboard in text format.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::copyText() -->

<section id="mthCutText"><title>cutText</title>
<indexterm><primary>cutText</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>cutText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cutText(--+--------+--)----------------------><
              +--type--+
]]>
</programlisting>

<para>
   Deletes (cuts) the currently selected text, if any, in the edit control and copies the deleted text to the clipboard
   in text format.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The deletion performed by the <emphasis role="italic">cutText</emphasis> method can be undone by using the <link
    linkend="mthUndo">undo</link> method.  To delete the currently selected text without placing that text on the
    clipboard, use the <link linkend="mthClearText">clearText</link> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::cutText() -->

<section id="mthGetMargins"><title>getMargins</title>
<indexterm><primary>getMargins</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>getMargins</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMargins-----------------------------------><

]]>
</programlisting>

<para>
  Returns the width of the left and right margins of the edit control in a <computeroutput>Directory</computeroutput>
  object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a <computeroutput>Directory</computeroutput> object. The directory has the width of the left margin in
    the <emphasis role="italic">left</emphasis> index and the width of the right margin in the <emphasis
    role="italic">right</emphasis> index. Both values are in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from a hypothetical application where the user can increass or decrease the margins in an edit
    control by clicking on a '+' or a '-' minus button.
<programlisting>
<![CDATA[

::method onButtonClick unguarded
  expose editControl
  use arg info, handle

  id = .DlgUtil~loWord(info)
  margins = editControl~getMargins

  if id == self~constDir[IDC_PB_PLUS] then do
    if margins~left < 100 then margins~left += 2
    if margins~right < 100 then margins~right += 2
  end
  else if id == self~constDir[IDC_PB_MINUS] then do
    if margins~left > 2 then margins~left -= 2
    if margins~right > 2 then margins~right -= 2
  end
  else do
    return 0
  end

  editControl~setMargins(margins~left, margins~right)
  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::getMargins() -->

<section id="mthIsSingleLine"><title>isSingleLine</title>
<indexterm><primary>isSingleLine</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>isSingleLine</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isSingleLine---------------------------------><

]]>
</programlisting>

<para>
  Determines if this edit control is a single line or a multi-line edit control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if this edit control is a single line edit control and
    <computeroutput>.false</computeroutput> if it is a multi-line edit control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Some methods are not applicable for single line edit controls, or behave differently between single line and
    multi-line edit controls. For instance, the <link linkend="mthSetTabStops">setTabStops</link> method does nothing
    for a single line edit control. The <emphasis role="italic">isSingleLine</emphasis> method allows the programmer to
    write generic code for an edit control by checking which type of edit control the code is dealing with.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

::method setAppDefaultTabs private
  use strict arg editControl

  if editControl~isSingleLine then return .false

  editControl~setTabStops(.array~of(10, 20, 30, 40))
  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::isSingleLine() -->

<section id="mthDisableInternalResize"><title>disableInternalResize</title>
<indexterm><primary>disableInternalResize</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>disableInternalResize</secondary></indexterm>
<programlisting>
<![CDATA[
>>--disableInternalResize(--+-----------+--)-----><
                            +--disable--+
]]>
</programlisting>

<para>
  The edit control, internally, resizes itself in response to its parent dialog being resized.  There are times when
  this behavior may not be desired. The <emphasis role="italic">disableInternalResize</emphasis> method can be used to
  disable that behavior.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>disable [optional]</term>
      <listitem>
      <para>
        <computeroutput>.true</computeroutput> or <computeroutput>.false</computeroutput>. If true, disable the edit
        control's internal resizing.  If false, renable the behavior, if it has been disabled.  The default is
        <computeroutput>.true</computeroutput>
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the programmer is resizing the edit control himself in response to the resizing of the dialog, the edit
    control's internal resizing may get in the way. That behavior of the edit control can be suppressed by using the
    <emphasis role="italic">disableInternalResize</emphasis> method. The programmer can disable / re-enable the internal
    resizing of the edit control as often and whenver he wants.
  </para>
  <para>

  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::disableInternalResize() -->

<section id="mthNoContextMenu"><title>noContextMenu</title>
<indexterm><primary>noContextMenu</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>noContextMenu</secondary></indexterm>
<programlisting>
<![CDATA[
>>--noContextMenu(--+--------+--)----------------><
                    +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::noContextMenu() -->

<section id="mthPasteText"><title>pasteText</title>
<indexterm><primary>pasteText</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>pasteText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--pasteText(--+--------+--)--------------------><
                +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::pasteText() -->

<section id="mthSelection"><title>selection</title>
<indexterm><primary>selection</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>selection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selection(--+--------+--)--------------------><
                +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::selection() -->

<section id="mthUndo"><title>undo</title>
<indexterm><primary>undo</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>undo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--undo(--+--------+--)-------------------------><
           +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::undo() -->


<section id="mthEnsureCaretVisibility"><title>ensureCaretVisibility</title>
<indexterm><primary>ensureCaretVisibility</primary></indexterm>
<programlisting>
<![CDATA[
>>--ensureCaretVisibility------------------------><


]]>
</programlisting>

<para>The ensureCaretVisibility method scrolls the edit
control until the caret (cursor) is visible.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if the object is associated with an existing edit control.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthFirstVisibleLine"><title>firstVisibleLine</title>
<indexterm><primary>firstVisibleLine</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>firstVisibleLine</secondary></indexterm>
<programlisting>
<![CDATA[
>>--firstVisibleLine-----------------------------><

]]>
</programlisting>

<para>
  Retrieves the index of the first visible line in a multiline edit control or the first visible character in a
  single-line edit contrl.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The index of the first visible line or first visible character depending on the top of the edit control
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Both the line index and the character index are one-based indexes.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[
  edit = self~newEdit(IDC_EDIT)

  index = edit~firstVisibleLine
  if edit~isSingleLine then do
    say 'The first visible character in the edit control is at index:' index
  else
    say 'The first visible line in the edit control is at index:' index

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::firstVisibleLine() -->


<section id="mthIsModified"><title>isModified</title>
<indexterm><primary>isModified</primary></indexterm>
<programlisting>
<![CDATA[
>>--isModified-----------------------------------><


]]>
</programlisting>

<para>The isModified method retrieves information on
whether the edit control has been modified.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The text in the edit control has been altered.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem>
  <para>
<programlisting>
<![CDATA[
if edit~isModified = 1 then MyDialog~Save
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetModified"><title>setModified</title>
<indexterm><primary>setModified</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>setModified</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setModified(--bool--)------------------------><


]]>
</programlisting>

<para>The setModified method sets the flag to indicate
whether the edit control has been modified.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>bool</term>
<listitem><para>
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The flag indicates that the text has been altered.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>In the following example, the Save method stores the dialog
contents in a file and clears the modified flag.
<programlisting>
<![CDATA[
::method Save
    /* write contents to file */
    edit = MyDialog~newEdit("TEXT")
    ...
    edit~setModified(.false)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthLines"><title>lines</title>
<indexterm><primary>lines</primary></indexterm>
<programlisting>
<![CDATA[
>>--lines----------------------------------------><


]]>
</programlisting>

<para>The lines method retrieves the number of text lines
of a multiline edit control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of text lines.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>For an example, refer to <link linkend="mthLineIndex">lineIndex</link>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthLineIndex"><title>lineIndex</title>
<indexterm><primary>lineIndex</primary></indexterm>
<programlisting>
<![CDATA[
>>--lineIndex(--line--)--------------------------><


]]>
</programlisting>

<para>The lineIndex method retrieves the one-based character
index of the beginning of the <emphasis role="italic">line</emphasis> in the associated edit control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>line</term>
<listitem><para>The number of the line of which the starting index is to be retrieved.
Line numbers are incremented by 1, starting with 1.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The character index of the specified line. The first line starts at
index 1.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets the text for edit control TEXT and
displays the number of text lines (3), the starting index of the second line
(carriage return, 0x0d, and line feed, 0x0a, which mark a line break, are also
considered to be characters), and the length of the third line:
<programlisting> <![CDATA[
editControl = MyDialog~newEdit("TEXT")
if .nil == editControl then return

text = "It is easy to learn and easy to use." || '0d0a'x || -
       "Have fun with it!"                    || '0d0a'x || -
       "But don't over do it."

edit~setText(text)

say "Number of lines:" edit~lines
say "Line 2 begins at index" edit~lineIndex(2)
say "Length of 3rd line:" edit~lineLength(3)

Result: Number of lines: 3
        Line 2 begins at index 39
        Length of 3rd line: 21
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthLineFromIndex"><title>lineFromIndex</title>
<indexterm><primary>lineFromIndex</primary></indexterm>
<programlisting>
<![CDATA[
>>--lineFromIndex(--index--)---------------------><


]]>
</programlisting>

<para>The lineFromIndex method retrieves the one-based
line number that contains the character index <emphasis role="italic">index</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The one-based character index contained in the line whose number is
to be retrieved.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The line number containing the specified character index. The first
line starts at index 1. If the specified index exceeds the number of characters
contained in the edit control or an invalid character index was specified,
0 is returned.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the line in which character 55 is contained:
<programlisting>
<![CDATA[
edit = MyDialog~newEdit("TEXT")
if edit == .Nil then return

"It is easy to learn and easy to use." || 13~d2c || 10~d2c ||,
"Have fun with it!"
say "Character 55 is contained in line" edit~lineFromIndex(55)

Result: Character 55 is contained in line 2
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthLineLength"><title>lineLength</title>
<indexterm><primary>lineLength</primary></indexterm>
<programlisting>
<![CDATA[
>>--lineLength(--line--)-------------------------><


]]>
</programlisting>

<para>The lineLength method retrieves the number of characters
contained in the <emphasis role="italic">line</emphasis> in the associated edit control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>line</term>
<listitem><para>The number of the line of which the number of characters is to be retrieved.
Line numbers are incremented by 1, starting with 1.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The length of the given line.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>For an example, refer to <link linkend="mthLineIndex">lineIndex</link>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetLine"><title>getLine</title>
<indexterm><primary>getLine</primary></indexterm>
<programlisting>
<![CDATA[
>>--getLine--(--line--+--------------+--)--------><
                      +-,--maxLength-+


]]>
</programlisting>

<para>The getLine method retrieves the text string contained
in the specified line.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>line</term>
<listitem><para>The one-based line number to be retrieved.
</para></listitem></varlistentry>
<varlistentry><term>maxLength</term>
<listitem><para>The maximum number of characters to be retrieved. Object Rexx allocates
the appropriate amount of memory to store the text string. If the line consists
of more characters than fit in the memory, the text string is truncated. If
you omit this argument, the maximum number of characters retrieved is 255.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A text string or an empty string.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example stores all lines contained in edit control EDITOR
in a stem. If a line consists of more than 1024 characters, it is truncated.
TODO FIX THIS TRUNCATION THING.
<programlisting>
<![CDATA[
edit = MyDialog~newEdit("EDITOR")
if edit == .Nil then return
do i = 1 to edit~lines
   lines.i = edit~getLine(i, 1024)
end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
The carriage return and line-feed characters are not included in the returned
text string.
</para></note>
</section>

<section id="mthReplaceSelText"><title>replaceSelText</title>
<indexterm><primary>replaceSelText</primary></indexterm>
<programlisting>
<![CDATA[
>>--replaceSelText(--text--)---------------------><


]]>
</programlisting>

<para>The replaceSelText method replaces the selected
text in the associated edit control with a new one.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text string that is to replace the currently selected text.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>
<programlisting>
<![CDATA[
edit = self~newEdit("TEXT")
if edit == .nil then return
edit~setText("Object Rexx is a hybrid language.")
edit~select(17,25)
    edit~replaceSelText("n interpreted")
    say edit~getText

Result: Object Rexx is an interpreted language.
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetLimit"><title>setLimit</title>
<indexterm><primary>setLimit</primary></indexterm>
<programlisting>
<![CDATA[
>>--setLimit(--chars--)--------------------------><


]]>
</programlisting>

<para>The setLimit method sets the maximum numbers of
characters that the associated edit control can contain.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>chars</term>
<listitem><para>The number of characters that the edit control can contain.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetReadOnly"><title>setReadOnly</title>
<indexterm><primary>setReadOnly</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>setReadOnly</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setReadOnly(--+------+--)--------------------><
                  +-mode-+
]]>
</programlisting>

<para>
  Adds or removes the read only style for the edit control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>mode [optional]</term>
    <listitem>
    <para>
      <computeroutput>.true</computeroutput> adds the read only style and <computeroutput>.false</computeroutput>
      removes the read only style. If the argument is omitted, the read only style is added.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, and 1 if the method fails.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When an edit control has the read only style, the user can not modify the text in the edit control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::setReadOnly() -->


<section id="mthSetMargins"><title>setMargins</title>
<indexterm><primary>setMargins</primary></indexterm>
<programlisting>
<![CDATA[
>>--setMargins(--left--,--right--)---------------><


]]>
</programlisting>

<para>The setMargins method sets the left and right margins
for the associated edit control. The margins determine the spacing to the
left and right of the edit control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>left</term>
<listitem><para>The left margin, specified in screen pixels.
</para></listitem></varlistentry>
<varlistentry><term>right</term>
<listitem><para>The right margin, specified in screen pixels.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets the margins for edit control TEXT such that
the left indent is 10 screen pixels and on the right there is a spacing of
5 pixels between the text and the frame of the edit control:
<programlisting>
<![CDATA[
edit = MyDialog~newEdit("TEXT")
if edit == .Nil then return
edit~setMargins(10, 5)
     parse value edit~margins with left right
     say "The new left margin is" left" and the new right margin is" right
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthMargins"><title>margins</title>
<indexterm><primary>margins</primary></indexterm>
<programlisting>
<![CDATA[
>>--margins--------------------------------------><


]]>
</programlisting>

<para>The margins method retrieves the left and right
margins of the associated edit control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The left and right margins, in screen pixels, separated by a blank.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>For an example, refer to <link linkend="mthSetMargins">setMargins</link>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetCue"><title>getCue</title>
<indexterm><primary>getCue</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>getCue</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCue(--+--------+--)-----------------------><
                  +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::getCue() -->

<section id="mthSetCue"><title>setCue</title>
<indexterm><primary>setCue</primary></indexterm>
<programlisting>
<![CDATA[
>>--setCue(--text--)-----------------------------><

]]>
</programlisting>

<para>
  This method sets the "cue" text for an edit control.  Cue text provides a visual hint to the user as to
  the purpose of the edit control.  When the dialog is first shown to the user the cue text will be
  displayed, (provided there is no text in the edit control's buffer.)
</para>
<para>The cue text is colored a light grey to distinguish it from regular text.
When the edit control gains the focus, Windows dismisses the cue text
automatically.  When the control loses focus, Windows will again display the cue
text, if the entry control is empty.  Once the user has entered text in the edit
control, the cue is no longer displayed.  If the user deletes the text, then the
cue is once again displayed when the edit control does not have the focus.
</para>
<note><title>Note</title><para>
Only single-line edit controls will display cue text.  You can not use cue text
with a multi-line edit control.
</para></note>
<variablelist>
<varlistentry><term><emphasis role="bold">Operating System
Version</emphasis></term>
<listitem><para>This method is only available on Windows XP or later operating
systems.  If the method is used on an unsupported operating system, -4 is
returned.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text to be displayed to the user as a cue.  The maximum
length of the text string is 255 characters.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return value will be one of the following:
<variablelist>
<varlistentry><term>less than -4</term>
<listitem><para>The value is the negated Operating System Error code.
The absolute value of the return can be used to look up the error reason in the
Windows documentation.
</para></listitem></varlistentry>
<varlistentry><term>-4</term>
<listitem><para>The operating system does not support this method.  Windows XP
or later is required.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The text argument is too long for this method, or there is an
(internal) problem converting the text string to Unicode.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>There is an (internal) problem with the dialog or the dialog
handle.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>There is an (internal) problem with the resource ID or window
handle of the edit control.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The method succeeded.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The method failed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>For an example see the <link linkend="exampleShowBalloon">
showBalloon</link> example.
</para></listitem></varlistentry>
</variablelist>

</section>


<section id="mthSetTabStops"><title>setTabStops</title>
<indexterm><primary>setTabStops</primary><secondary>Edit class</secondary></indexterm>
<indexterm><primary>Edit class</primary><secondary>setTabStops</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setTabStops(--tabStops--)--------------------><

]]>
</programlisting>

<para>
  Sets the tab stops for text copied into a multi-line edit control.
</para>
<para>
  When text is copied to the control, any tab character in the text causes space to be generated up to
 the next tab stop.  This method is ignored if the edit control is a single-line edit control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
    <para>
      Raises syntax errors when incorrect arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem><para>The single argument is:
  <variablelist>
  <varlistentry><term>tabStops</term>
  <listitem>
  <para>
    An array containing the tab stops.  Each tab stop is a positive number expressed in dialog template
    units.  If the array contains no elements, default tab stops are set at every 32 dialog template
    units.
  </para>
  <para>
    If the array contains only 1 element at index 1, tab stops are set at every n dialog template units,
    where n is the distance at index 1.
  </para>
  <para>
    Otherwise, tab stops are set to the numbers contained in the array.
  </para></listitem></varlistentry>
  </variablelist>
  </para></listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True if all tab stops were set, otherwise false.
  </para></listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The array must contain all positive numbers (or be an empty array to set the default tab stops.)
 	  Also, the array must not be sparse, i.e., it must not skip any array indexes.
  </para>
  <para>
    The operating system will not do negative tab stops.  I.e. you can not do 15 35 20.  Also, note that
    when specifying an array of more than 1 tap stop, each tab stop is the absolute position of the tab
    stop, not the distance between the tab stops.
  </para>
  <para>
    Under normal circumstances there is no way for a user to enter a tab character by typing in a
    multi-line edit control.  The edit control would need to be sub-classed and this is not provided by
    ooDialog. However, the user could use copy and paste to paste in text with tabs.  And, text placed in
    the edit control by the programmer, (for example by using the <link linkend="mthSetText"></link>()
    method,) can also contain tabs.
  </para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthTabEquals"><title>tab=</title>
<indexterm><primary>tab=</primary><secondary>Edit class</secondary></indexterm>
<indexterm><primary>Edit class</primary><secondary>tab=</secondary></indexterm>
<programlisting>
<![CDATA[
--->>--tab-=-tabStops-----------------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">tab =</emphasis> method is an alias for the <link
  linkend="mthSetTabStops">setTabStops</link>() method.  It behaves exactly the same except there is no return
  value.
</para>
</section>


<section id="mthShowBalloon"><title>showBalloon</title>
<indexterm><primary>showBalloon</primary></indexterm>
<programlisting>
<![CDATA[
>>--showBalloon(--title,--text--+----------+--)--><
                                +-,--icon--+

]]>
</programlisting>

<para>Displays a balloon information window.  Balloon windows are similar in
appearance to the balloon captions used in comic books to display the dialog of
the characters. For an edit control the balloon window looks like it is attached
to the control.
</para>
<para>The balloon is displayed for 10 seconds and then goes away.  The
programmer can also dismiss the balloon sooner using the <link
linkend="mthHideBalloon">hideBalloon</link> method.  Typically balloon windows
are used to convey information to the user without having to put up a message
box that the user then needs to dismiss manually.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Operating System
Version</emphasis></term>
<listitem><para>This method is only available on Windows XP or later operating
systems.  If the method is used on an unsupported operating system, -4 is
returned.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>title</term>
<listitem><para>A title for the balloon window.  Titles are limited to 99
characters total in length.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>The text of the balloon window.  This text is limited to 1024
characters in length.  The programmer can use line break characters to control
the formatting of the text.
</para></listitem></varlistentry>
<varlistentry><term>icon</term>
<listitem><para>Used to specify which icon is displayed on the title line.  The
default is the informational icon.  The following keywords can be used to
specify another icon, or no icon.  Only the first letter of the keyword is
needed and case is insignificant:
<variablelist>
<varlistentry><term>ERROR</term>
<listitem><para>The error icon is used.
</para></listitem></varlistentry>
<varlistentry><term>WARN</term>
<listitem><para>The warning icon is used.
</para></listitem></varlistentry>
<varlistentry><term>NONE</term>
<listitem><para>No icon is displayed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return value will be one of the following:
<variablelist>
<varlistentry><term>less than -4</term>
<listitem><para>The value is the negated Operating System Error code.
The absolute value of the return can be used to look up the error reason in the
Windows documentation.
</para></listitem></varlistentry>
<varlistentry><term>-4</term>
<listitem><para>The operating system does not support this method.  Windows XP
or later is required.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The title or text arguments are too long for this method, or
there is an (internal) problem converting one of the strings to Unicode.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>There is an (internal) problem with the dialog or the dialog
handle.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>There is an (internal) problem with the resource ID or window
handle of the edit control.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The method succeeded.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The method failed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry id="exampleShowBalloon"><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following code snippet could come from a fictitious
inventory program.  An edit control is used to enter a product ID.  If the user
clicks on the edit control a ballon tip is shown displaying extended product
information.  (In a real application, the extended information might be based on
what the user had entered in the edit control.)
</para>
<para>Text is set in the edit control to give the user a 'cue' that she can
click on the edit control for extra information.  When the ballon tip is shown,
it will automatically be dismissed after 10 seconds.  This application connects
a notification for the lost focus event.  When the edit control loses focus, the
ballon tip is hidden by the program.
<programlisting>
<![CDATA[
  ...

::method defineDialog

  ...

  self~createStaticText(200, 10, 125, 150, 10, , "Enter product ID:")
  self~createEdit(IDC_ENTRYLINE, 10, 135, 150, 10, "AUTOSCROLLH", "cEntry")

  ...

::method initDialog
  expose editControl hwndEditControl

  editControl = self~newEdit(IDC_ENTRYLINE)
  hwndEditControl = self~getItem(IDC_ENTRYLINE)

  self~connectEditNotify(IDC_ENTRYLINE, GOTFOCUS, "onFocus")
  self~connectEditNotify(IDC_ENTRYLINE, LOSTFOCUS, "onLostFocus")

  ret = editControl~setCue("Click here for extended product information")
  if ret <> 0 then ErrorDialog( "Set cue error return:" ret )

  -- Capture the mouse activate messages: WM_MOUSEACTIVATE message == 0x0021
  self~addUserMsg(onMouseActivate, "0x0021", "0xFFFFFFFF", 0, 0, 0, 0)

  ...

::method onMouseActivate
  expose editControl hwndEditControl

  if self~getFocus == hwndEditControl then do
    title = "Extended Product Information"
    text = "Product ID:"   || "9"x    || "4538-D32"       || .endOfLine || -
           "In stock:"     || "9"x    || "789"            || .endOfLine || -
           "Back ordered:" || "9"x    || "No"             || .endOfLine || -
           "EOL:"          || "0909"x || "January 2008"   || .endOfLine || -
           "Client:"       || "0909"x || "AT&T"           || .endOfLine || .endOfLine -
           "Notes: This product has served a limited number of customers" -
           "and should be considered archic.  It will be replaced by a"   -
           "superior product line."

    ret = editControl~showBalloon(title, text, "e");
    if ret <> 0 then ErrorDialog("Show balloon error return:" ret)
  end

::method onLostFocus
  expose editControl

  -- When the edit control loses the focus, dismiss the alloon.
  ret = editControl~hideBalloon
  if ret <> 0 then ErrorDialog("Hide balloon error return:" ret)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

</section>

<section id="mthHideBalloon"><title>hideBalloon</title>
<indexterm><primary>hideBalloon</primary></indexterm>
<programlisting>
<![CDATA[
>>--hideBalloon----------------------------------><

]]>
</programlisting>

<para>Hides the balloon information window displayed by the <link
linkend="mthShowBalloon">showBalloon</link> method.  The operating system will
dismiss the balloon window automatically after 10 seconds with no programmer
intervention.  This method can is used to dismiss the ballon sooner.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Operating System
Version</emphasis></term>
<listitem><para>This method is only available on Windows XP or later operating
systems.  If the method is used on an unsupported operating system, -4 is
returned.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The retrun value will be one of the following:
<variablelist>
<varlistentry><term>less than -4</term>
<listitem><para>The value is the negated Operating System Error code.
The absolute value of the return can be used to look up the error reason in the
Windows documentation.
</para></listitem></varlistentry>
<varlistentry><term>-4</term>
<listitem><para>The operating system does not support this method.  Windows XP
or later is required.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>There is an (internal) problem with the dialog or the dialog
handle.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>There is an (internal) problem with the resource ID or window
handle of the edit control.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The method succeeded.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The method failed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>For an example see the <link linkend="exampleShowBalloon">
showBalloon</link> example.
</para></listitem></varlistentry>
</variablelist>

</section>

<section id="mthAddStyle"><title>addStyle</title>
<indexterm><primary>addStyle</primary>
<secondary>Edit class</secondary></indexterm>
<programlisting>
<![CDATA[
                 +----------------+
                 V                |
>>--addStyle(--"---+-UPPER------+-+--"--)--------><
                   +-LOWER------+
                   +-NUMBER-----+
                   +-WANTRETURN-+
                   +-OEM--------+
                   +-TAB--------+
                   +-GROUP------+

]]>
</programlisting>

<para>Adds one or more edit control styles to the edit control. This method
works with the <link linkend="paraDialogControlStyles">window styles</link> that
can be changed by accessing the edit control window directly after the edit
control has been created.
</para>
<variablelist>
<varlistentry><term id="argsAddStyle"><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The style argument can be one or more of the following keywords.
(Each keyword is separated by a blank.):
<variablelist>
<varlistentry><term>UPPER</term>
<listitem><para>Converts all characters to uppercase as they are typed into the edit
control.
</para></listitem></varlistentry>
<varlistentry><term>LOWER</term>
<listitem><para>Converts all characters to lowercase as they are typed into the edit
control.
</para></listitem></varlistentry>
<varlistentry><term>NUMBER</term>
<listitem><para>Only allows digits to be typed into the edit control.  If the
user types an non-digit character an information balloon is displayed informing
the user that only digits are allowd.  This style does not prevent the user from
pasting non-digits into the control.
</para></listitem></varlistentry>
<varlistentry><term>WANTRETURN</term>
<listitem><para>This keyword only effects multi-line edit controls.  With this
style when a user hits the enter key the line break characters are inserted into
the text buffer.  Without the style, when the user hits enter the default push
button of the dialog is pressed.
</para></listitem></varlistentry>
<varlistentry><term>OEM</term>
<listitem><para>Converts text entered in the edit control from the Windows
character set to the OEM character set and then back again to the Windows
character set. This ensures proper character conversion in certain
circumstances. Microsoft states that this style is most useful when edit
controls contain file names that will be used with file systems that do not
support Unicode. For further details see the <link linkend="defWindowsDoc">Windows
documentation</link> provided by Microsoft.
</para></listitem></varlistentry>
<varlistentry><term>TAB</term>
<listitem><para>Adds the <link linkend="wstabstop">tabstop</link> tab stop
style.
</para></listitem></varlistentry>
<varlistentry><term>GROUP</term>
<listitem><para>Adds the <link linkend="wsgroup">group</link> style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>Negative values indicate error, non-negative values indicate
success.
<variablelist>
<varlistentry><term>-4 or less</term>
<listitem><para>The value is the negated Operating System Error code.
The absolute value of the return can be used to look up the error reason in the
Windows documentation.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The was no valid keyword in the style argument. Note that if the
style argument contains at least one valid keyword other invalid keywords are
then ignored.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>There is an (internal) problem with the dialog or the dialog
handle.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>There is an (internal) problem with the resource ID or window
handle of the edit control.
</para></listitem></varlistentry>
<varlistentry><term>other</term>
<listitem><para>The numeric value of the edit control's previous style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>This example shows the syntax to add the number, tabstop, and
group styles to an edit control.
<programlisting>
<![CDATA[
editControl = dlg~newEdit(IDC_ENTRYLINE)
if .nil == editControl  then return
editControl~addStyle("NUMBER TAB GROUP")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

</section>

<section id="mthRemoveStyle"><title>removeStyle</title>
<indexterm><primary>removeStyle</primary>
<secondary>Edit class</secondary></indexterm>
<programlisting>
<![CDATA[
                    +----------------+
                    V                |
>>--removeStyle(--"---+-UPPER------+-+--"--)-----><
                      +-LOWER------+
                      +-NUMBER-----+
                      +-WANTRETURN-+
                      +-OEM--------+
                      +-TAB--------+
                      +-GROUP------+

]]>
</programlisting>

<para>Remove one or more edit control styles from the edit control. This method
works with the <link linkend="paraDialogControlStyles">window styles</link> that
can be changed by accessing the edit control window directly after the edit
control has been created.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The style argument can be one or more of the style keywords.
(Each keyword is separated by a blank.)  See the <link linkend="argsAddStyle">
argument list</link> for the <computeroutput>addStyle</computeroutput> method
for detals on the keywords.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>Negative values indicate error, non-negative values indicate
success.
<variablelist>
<varlistentry><term>-4 or less</term>
<listitem><para>The value is the negated Operating System Error code.
The absolute value of the return can be used to look up the error reason in the
Windows documentation.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The was no valid keyword in the style argument. Note that if the
style argument contains at least one valid keyword other invalid keywords are
then ignored.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>There is an (internal) problem with the dialog or the dialog
handle.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>There is an (internal) problem with the resource ID or window
handle of the edit control.
</para></listitem></varlistentry>
<varlistentry><term>other</term>
<listitem><para>The numeric value of the edit control's previous style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>This example shows the syntax to remove the lower and the
tabstop styles from an edit control.
<programlisting>
<![CDATA[
editControl = dlg~newEdit(IDC_ENTRYLINE)
if .nil == editControl  then return
editControl~removeStyle("LOWER GROUP")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

</section>

<section id="mthReplaceStyle"><title>replaceStyle</title>
<indexterm><primary>replaceStyle</primary>
<secondary>Edit class</secondary></indexterm>
<programlisting>
<![CDATA[
                    +---------------+      +---------------+
                    V               |      V               |
>>--replaceStyle(--"--+-UPPER-----+-+-",--"--+-UPPER-----+-+-"-)---------------><
                      +-LOWER-----+          +-LOWER-----+
                      +-NUMBER----+          +-NUMBER----+
                      +-WANTRETURN+          +-WANTRETURN+
                      +-OEM-------+          +-OEM-------+
                      +-TAB-------+          +-TAB-------+
                      +-GROUP-----+          +-GROUP-----+

]]>
</programlisting>

<para>Removes and adds edit control styles for the edit control in one
operation.  This method works with the <link linkend="paraDialogControlStyles">
window styles</link> that can be changed by accessing the edit control window
directly after the edit control has been created.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The two arguments can be one or more of the style keywords.
(Each keyword is separated by a blank.)  See the <link linkend="argsAddStyle">
argument list</link> for the <computeroutput>addStyle</computeroutput> method
for detals on the keywords.
<variablelist>
<varlistentry><term>remove</term>
<listitem><para>The first argument is the list of styles to remove.
</para></listitem></varlistentry>
<varlistentry><term>add</term>
<listitem><para>The second argument is the list of styles to add.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>Negative values indicate error, non-negative values indicate
success.
<variablelist>
<varlistentry><term>-4 or less</term>
<listitem><para>The value is the negated Operating System Error code.
The absolute value of the return can be used to look up the error reason in the
Windows documentation.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The was no valid keyword in one or both of the style arguments.
Note that if a style argument contains at least one valid keyword other
invalid keywords are then ignored.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>There is an (internal) problem with the dialog or the dialog
handle.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>There is an (internal) problem with the resource ID or window
handle of the edit control.
</para></listitem></varlistentry>
<varlistentry><term>other</term>
<listitem><para>The numeric value of the edit control's previous style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following would change an edit control from one that only
allows numbers to one that uppercases all letters entered, while removing the
tabstop style and adding the group style.
<programlisting> <![CDATA[
editControl = dlg~newEdit(IDC_ENTRYLINE)
if .nil == editControl then return
editControl~replaceStyle("NUMBER TAB", "UPPER GROUP")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

</section>

<section id="mthGetStyle"><title>getStyle</title>
<indexterm><primary>getStyle</primary></indexterm>
<indexterm><primary>Edit class</primary><secondary>getStyle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getStyle-------------------------------------><

]]>
</programlisting>

<para>
  Returns the edit control's current style as a blank delimited list of style keywords.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A string consisting of blank delimited style keywords.  The possible keywords are: VISIBLE HIDDEN TAB NOTAB DISABLED
    ENABLED GROUP HSCROLL VSCROLL PASSWORD MULTILINE AUTOSCROLLH AUTOSCROLLV READONLY WANTRETURN KEEPSELECTION UPPER
    LOWER NUMBER OEM RIGHT CENTER LEFT.  The meaning of these style keywords is documented in the <link
    linkend="mthCreateEdit">createEdit</link> method.
  </para>
  <para>
    It is possible, but very unlikely, that a negative number is returned. See the remarks section below
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If an operating system error occurs, this method returns the negated value of the system error code. However, this
    method also sets <computeroutput>.SystemErrorCode</computeroutput> in that case. The negative number return is a
    hold over from earlier versions of ooDialog before <computeroutput>.SystemErrorCode</computeroutput> was introduced.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

  editControl = dlg~newEdit(IDC_EDIT)
  if editControl == .nil  then return

  style = editControl~getStyle
  if style~wordPos("NUMBER") <> 0 then
    editControl~removeStyle("NUMBER")
  ...
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Edit::getStyle() -->

</chapter>
