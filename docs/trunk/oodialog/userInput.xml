<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference SGML file.
    #
    # Copyright (c) 2011-2011, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="chapUserInput"><title>User Input</title>
<indexterm><primary>User Input</primary></indexterm>
<para>
  xxx
</para>
<para>
  yyy
</para>
<para>
  zzz
</para>
<para> The following table lists the general categories of user input that are documented in this chapter:
<table id="tblUserInputClasses" frame="all"> <title>ooDialog User Input Groups</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>User Input</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="sctCommonDialogLibrary">Common</link></entry>
<entry>Objects and routines used to easily gather user input.</entry>
</row>
<row>
<entry><link linkend="clsMouse">Mouse</link></entry>
<entry>ooDialog programs deal with mouse input primarily through the <computeroutput>Mouse</computeroutput> class</entry>
</row>
</tbody></tgroup>
</table>
</para>


<section id="sctCommonDialogLibrary"><title>Common Dialog Library</title>
<indexterm><primary>Common Input Dialogs and Routines</primary></indexterm>
<para>
  The ooDialog framework provides a number of easy to use dialogs and routines that obtain user input in common
  scenarios. These dialogs and routines allow programmers to include simple graphical elements in their Rexx
  applications and collect user input in a standard way.. The public routines can be called with a single line of code
  and the standard dialogs can usually be executed with only two lines of code. This does not require the programmer to
  do much set up and makes them simple to work with.
</para>

<section id="sctStandardClassesRoutines"><title>Class and Routine Table</title>

<para>
  The common dialogs and routines are listed the following table:
</para>
<table id="tStandardElements" frame="all">
<title>Common Dialog Classes and Public Routines</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Class / Routine</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="rtnAskDialog">AskDialog routine</link></entry>
<entry>Pops up a message box containing the specified question, a Yes and a No push button.</entry>
</row>
<row>
<entry><link linkend="clsCheckList">CheckList class</link></entry>
<entry>A dialog with a group of one or more check boxes.</entry>
</row>
<row>
<entry><link linkend="rtnCheckList">CheckList routine</link></entry>
<entry>A shortcut function to invoke the <computeroutput>CheckList</computeroutput> dialog.</entry>
</row>
<row>
<entry><link linkend="rtnErrorDialog">ErrorDialog routine</link></entry>
<entry>Pops up a message box containing the specified error message, an Ok push button and an error icon.</entry>
</row>
<row>
<entry><link linkend="rtnFileNameDialog">FileNameDialog routine</link></entry>
<entry>Causes a file selection dialog box to appear.</entry>
</row>
<row>
<entry><link linkend="rtnInfoDialog">InfoDialog routine</link></entry>
<entry>Pops up a message box containing the specified text and an Ok push button.</entry>
</row>
<row>
<entry><link linkend="clsInputBox">InputBox class</link></entry>
<entry>Provides a simple dialog with a title, a message, an edit control, and the Ok and Cancel push buttons.</entry>
</row>
<row>
<entry><link linkend="rtnInputBox">InputBox routine</link></entry>
<entry>A shortcut function to invoke an <computeroutput>InputBox</computeroutput> dialog as a function.</entry>
</row>
<row>
<entry><link linkend="clsIntegerBox">IntegerBox class</link></entry>
<entry>An <computeroutput>InputBox</computeroutput> dialog whose edit control allows only numerical data.</entry>
</row>
<row>
<entry><link linkend="rtnIntegerBox">IntegerBox routine</link></entry>
<entry>A shortcut to invoke an <computeroutput>IntegerBox</computeroutput> dialog as a function.</entry>
</row>
<row>
<entry><link linkend="clsListChoice">ListChoice class</link></entry>
<entry>Provides a dialog with a single-selection list box, and the Ok and Cancel push buttons.</entry>
</row>
<row>
<entry><link linkend="rtnListChoice">ListChoice routine</link></entry>
<entry>Provides a shortcut to invoke a <computeroutput>ListChoice</computeroutput> dialog.</entry>
</row>
<row>
<entry><link linkend="rtnMessageDialog">MessageDialog routine</link></entry>
<entry>Pops up a message box with the options specified.</entry>
</row>
<row>
<entry><link linkend="clsMultiInputBox">MultiInputBox class</link></entry>
<entry>A dialog that provides a title, a message, and one or more edit controls.</entry>
</row>
<row>
<entry><link linkend="rtnMultiInputBox">MultiInputBox routine</link></entry>
<entry>Provides a shortcut function to invoke a <computeroutput>MultiInputBox</computeroutput> dialog</entry>
</row>
<row>
<entry><link linkend="clsMultiListChoice">MultiListChoice class</link></entry>
<entry>A <computeroutput>ListChoice</computeroutput> dialog that allows multi-item selection</entry>
</row>
<row>
<entry><link linkend="rtnMultiListChoice">MultiListChoice routine</link></entry>
<entry>Provides a shortcut to invoke a <computeroutput>MultiListChoice</computeroutput> dialog.</entry>
</row>
<row>
<entry><link linkend="clsPasswordBox">PasswordBox class</link></entry>
<entry>An <computeroutput>InputBox</computeroutput> dialog with that uses a password edit control.</entry>
</row>
<row>
<entry><link linkend="rtnPasswordBox">PasswordBox routine</link></entry>
<entry>A shortcut to invoke a <computeroutput>PasswordBox</computeroutput> dialog.</entry>
</row>
<row>
<entry><link linkend="clsSingleSelection">SingleSelection class</link></entry>
<entry>A dialog that has a group of radio buttons. The user can select only one item of the group.</entry>
</row>
<row>
<entry><link linkend="rtnSingleSelection">SingleSelection routine</link></entry>
<entry>Provides a quick way to invoke a <computeroutput>SingleSelection</computeroutput> dialog.</entry>
</row>
<row>
<entry><link linkend="clsTimedMessage">TimedMessage class</link></entry>
<entry>Shows a message window for a defined duration.</entry>
</row>
<row>
<entry><link linkend="rtnTimedMessage">TimedMessage routine</link></entry>
<entry>Provides a quick way to invoking a <computeroutput>TimedMessage</computeroutput> dialog.</entry>
</row>
</tbody></tgroup>
</table>

</section>

<section id="sctStandardDialogs"><title>Standard Dialog Classes</title>
<indexterm><primary>standard dialogs</primary></indexterm>
<para>The standard dialog classes are: </para>
<itemizedlist>
<listitem><para>TimedMessage</para></listitem>
<listitem><para>InputBox</para></listitem>
<listitem><para>PasswordBox</para></listitem>
<listitem><para>IntegerBox</para></listitem>
<listitem><para>MultiInputBox</para></listitem>
<listitem><para>ListChoice</para></listitem>
<listitem><para>MultiListChoice</para></listitem>
<listitem><para>CheckList</para></listitem>
<listitem><para>SingleSelection</para></listitem></itemizedlist>
<para></para>
<variablelist>
<varlistentry><term>Preparation:</term>
<listitem><para>Standard dialogs are prepared by using the
<computeroutput>new</computeroutput> method of the class, which in turn
invokes the <computeroutput>init</computeroutput> method. The parameters for
the <computeroutput>new</computeroutput> method are described for the
<computeroutput>init</computeroutput> method of each class.
</para></listitem></varlistentry>
<varlistentry><term>Execution:</term>
<listitem><para>The dialog is then run by using the
<computeroutput>execute</computeroutput> method. For most of the standard
dialogs <computeroutput>execute</computeroutput> returns the user's input if
the OK button is clicked and the null string if the Cancel button is clicked to
terminate the dialog. If there is more than one return value, execute returns
the value 1 and stores the results in an attribute.  Exceptions to the general
rule are noted in the documentation for the individual dialog.
</para></listitem></varlistentry>
<varlistentry><term>Functions:</term>
<listitem><para>Each standard dialog is also available as a callable function.
These functions are described in the <link linkend="sctPublicRoutines">Public
Routines</link> section of this chapter.
</para></listitem></varlistentry>
</variablelist>

<section id="clsCheckList"><title>CheckList Class</title>
<indexterm><primary>CheckList</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>CheckList</secondary></indexterm>
<para>The CheckList class is a dialog with a group of
one or more check boxes. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns 1 (if OK was clicked). The check boxes
selected by the user are marked in a stem variable with the value 1.
</para></listitem></varlistentry>
</variablelist>
<para>The method listed below is defined by this class.</para>

<section id="initCheckList"><title>init</title>
<indexterm><primary>init</primary>
<secondary>CheckList class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aCheckList~init(--message--,--title--,--labels.--,--datas.-->

>---+------------------------+--)-----------------------------><
    +-,--+-----+--+--------+-+
         +-len-+  +-,--max-+


]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the check box group.  Use
it to give the user advice on what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string for the dialog's title
</para></listitem></varlistentry>
<varlistentry><term>labels.</term>
<listitem><para>A stem variable (do not forget the trailing period) containing all the
labels for the check boxes
</para></listitem></varlistentry>
<varlistentry><term>datas.</term>
<listitem><para>This argument is a stem variable (do not forget the trailing period)
that you can use to preselect the check boxes. The first check box relates
to stem item 101, the second to 102, and so forth. A value of 1 indicates selected, and a value of 0 indicates deselected.</para>
<para>For example, Datas.103=1 indicates
that there is a check mark on the third box.</para>
</listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>Determines the length of the check boxes and labels. If omitted, the
size is calculated to fit the largest label.
</para></listitem></varlistentry>
<varlistentry><term>max</term>
<listitem><para>The maximum number of check boxes in one column. If there are more check
boxes than max - that is, labels. has more items than the value of max
- this method continues with a new column.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates and shows a dialog with seven check boxes:
</para></listitem></varlistentry>
</variablelist>

<programlisting>
<![CDATA[
lst.1 = "Monday";   lst.2 = "Tuesday"; lst.3 = "Wednesday"
lst.4 = "Thursday"; lst.5 = "Friday";  lst.6 = "Saturday"
lst.7 = "Sunday"

do i = 101 to 107
   chk.i = 0
end

dlg = .CheckList~new("Please select a day!","Day of week",lst., chk.)
if dlg~execute = 1 then do
   say "You selected the following day(s): "
   do i = 101 to 107
      a = i-100
      if chk.i = 1 then say lst.a
   end
end
]]>
</programlisting>
</section>
</section>

<section id="clsTimedMessage"><title>TimedMessage Class</title>
<indexterm><primary>TimedMessage</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>TimedMessage</secondary></indexterm>
<para>The TimeMessage class shows a message window for
a defined duration. </para>
<para>The methods listed below are defined by this class.</para>

<section id="initTimedMessage"><title>init</title>
<indexterm><primary>init</primary>
<secondary>TimedMessage class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTimedMessage~init(--msg--,--title--,--sleeping--+--------------+--)----><
                                                    +-,-earlyReply-+

]]>
</programlisting>

<para>The init method prepares the dialog. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A string that is displayed inside the window as a message. The length
of the message determines the horizontal size of all standard dialogs.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A string that is displayed as the window title in the title bar of the
dialog
</para></listitem></varlistentry>
<varlistentry><term>sleeping</term>
<listitem><para>A number that determines how long (in milliseconds) the window
is shown. If this number is 0 or greater, the message window is shown for that
time and automatically dismisses itself.  The programmer need take no further
action.
</para>
<para>If the number is less than 0 then the message window is shown
indefinitely.  The <computeroutput>execute</computeroutput> method returns
immediately.  In this case, the programmer needs to dismiss the window manually.
This is done by invoking the <computeroutput>ok</computeroutput> method. See
<emphasis role="bold">Example 2</emphasis> below.
</para></listitem></varlistentry>
<varlistentry><term>earlyReply</term>
<listitem><para>The optional early reply argument defaults to false.  If used
and if true, the <computeroutput>execute</computeroutput> method of the dialog
returns immediately.  This allows the code at the point where <computeroutput>
execute</computeroutput> was invoked to continue.  The message windows continues
to display for its specified duration and then dismisses itself automatically.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry id="example1TimedMessage"><term><emphasis role="bold">Example
  1:</emphasis></term>
<listitem><para>The following example shows a window with the title of <emphasis
role="italic">Infomation</emphasis> for a duration of 3 seconds:
<programlisting>
<![CDATA[
dlg = .TimedMessage~New("Application will be started, please wait", -
                        "Information", 3000)
dlg~execute
drop dlg
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry id="example2TimedMessage"><term><emphasis role="bold">Example
2:</emphasis></term>
<listitem><para>The following example shows an introductory window that displays
while an application is doing its time consuming start up routine.  Since this
start up process can vary in time depending on the individual system, the window
is set to display indefinitely.  When the start up process is finished, the
programmer dismisses the window and destroys the dialog manually.
<programlisting>
<![CDATA[
dlg = .TimedMessage~New("The WidgetCreator Application - loading ...", -
                        "The Widget Factory", -1)
dlg~execute
ret = doStartup()
dlg~ok
drop dlg
if ret <> 0 then do
  ...
end
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry id="example3TimedMessage"><term><emphasis role="bold">Example
3:</emphasis></term>
<listitem><para>The following example is a variation on <emphasis role="bold">
Example 2</emphasis>.  In this case the Widget Factory executives decided that
they want their WidgeCreator splash screen to always display for 2 seconds to
the customer and then close.  The early reply argument is used so that the start
up routine executes immediately.  After 2 seconds the splash screen dismisses
and the dialog is destroyed automatically.
</para>
<note><title>Note</title><para>It is not necessary to explicitly drop the dlg
variable.  That is shown in the other examples to emphasize the point that the
dialog has been destroyed.</para></note>
<programlisting> <![CDATA[
dlg = .TimedMessage~New("The WidgetCreator Application - loading ...", -
                        "The Widget Factory", 2000)
dlg~execute
if doStartup() <> 0 then do
  ...
end
]]>
</programlisting></listitem></varlistentry>
</variablelist>
</section>

<section id="defDlgTimedMessage"><title>defineDialog</title>
<indexterm><primary>Define</primary>
<secondary>TimedMessage</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTimedMessage~DefineDialog----------------------------------><

]]>
</programlisting>

<para>The defineDialog method is called by the create method of the parent
class, PlainUserDialog, which in turn is called at the very beginning of
Execute. You do not have to call it. However, you may want to over-ride it in
your subclass to add more dialog controls to the window.  If you over-ride it,
you have to forward the message to the parent class by using the keyword super.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example shows how to subclass the TimedMessage
class and how to add a background bitmap to the dialog window:
<programlisting>
<![CDATA[
::class MyTimedMessage subclass TimedMessage inherit DialogExtensions

::method defineDialog
   self~backgroundBitmap("mybackg.bmp", "USEPAL")
   self~DefineDialog:super()
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="h002097"><title>execute</title>
<indexterm><primary>execute</primary>
<secondary>TimedMessage class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTimedMessage~Execute---------------------------------------><
]]>
</programlisting>

<para>The execute method creates and shows the message window. If the specified
duration (see <link linkend="initTimedMessage">init</link> method) is not
negative, this method destroys the dialog automatically when the duration is up.
If the duration is less than 0, then the programmer must destroy the dialog
manually by invoking the <computeroutput>ok</computeroutput> method.  See
this <link linkend="example2TimedMessage">example</link> for a code snippet showing the
procedure.
</para>
</section>
</section>

<section id="clsInputBox"><title>InputBox Class</title>
<indexterm><primary>InputBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>InputBox</secondary></indexterm>
<para>The InputBox class provides a simple dialog with
a title, a message, one entry line, an OK, and a Cancel push button. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's input
</para></listitem></varlistentry>
</variablelist>
<para>The methods listed below are defined by this class.</para>

<section id="initInputBox"><title>init</title>
<indexterm><primary>init</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~init(--message--,--title--,--prevalue--,--len--)----><


]]>
</programlisting>

<para>The init method prepares the input dialog. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed in the dialog
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A string that is displayed as the dialog's title in the title bar
</para></listitem></varlistentry>
<varlistentry><term>prevalue</term>
<listitem><para>A string to initialize the entry line. If you do not want to put any
text in the entry line, just pass an empty string.
</para></listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>The width of the entry line in dialog units
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example shows an InputBox dialog with the title of
<emphasis role="italic">Input</emphasis> and an entry line:
<programlisting>
<![CDATA[
dlg = .InputBox~New("Please enter your email address", -
                    "Input", "user@host.domain", 150)
value = dlg~execute
say "You entered:" value
drop dlg
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="h002128"><title>defineDialog</title>
<indexterm><primary>defineDialog</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~DefineDialog--------------------------------------><


]]>
</programlisting>

<para>The defineDialog method is called by the create method of the parent
class, which in turn is called at the very beginning of
Execute. You do not have to call it. However, you may want to over-ride it in
your subclass to add more dialog controls to the window. If you over-ride it, you
have to forward the message to the parent class by using the keyword super.
</para>
</section>

<section id="h002138"><title>AddLine</title>
<indexterm><primary>AddLine</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~AddLine(--x--,--y--,--l--)------------------------><


]]>
</programlisting>

<para>The AddLine method is used internally to add one
entry line to the dialog.</para>
</section>

<section id="h002148"><title>execute</title>
<indexterm><primary>execute</primary>
<secondary>InputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aInputBox~Execute-------------------------------------------><


]]>
</programlisting>

<para>The execute method creates and shows the dialog. After termination, the
value of the entry line is returned if the user clicks the OK button; a null
string is returned if the user clicks on Cancel.</para>
</section>
</section>

<section id="clsIntegerBox"><title>IntegerBox Class</title>
<indexterm><primary>IntegerBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>IntegerBox</secondary></indexterm>
<para>The IntegerBox class is an <link linkend="clsInputBox">InputBox</link>
dialog whose entry line allows only numerical data. </para>
<variablelist>
<varlistentry><term>Subclass:</term>
<listitem><para>This class is a subclass of the <link linkend="clsInputBox">InputBox Class</link> class
</para></listitem></varlistentry>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's numeric input
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the <link linkend="clsInputBox">InputBox Class</link>
class, with the exception of Validate.</para>

<section id="h002189"><title>validate</title>
<indexterm><primary>validate</primary>
<secondary>IntegerBox function</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aIntegerBox~validate----------------------------------------><


]]>
</programlisting>

<para>The only method this subclass overrides is validate, which is one of the
automatically called methods of PlainUserDialog. It is invoked by the OK method,
which in turn is called in response to a push button event. This method checks
whether or not the entry line contains a valid numerical value. If the value is
invalid, a message window is displayed.
</para>
</section>
</section>

<section id="clsPasswordBox"><title>PasswordBox Class</title>
<indexterm><primary>PasswordBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>PasswordBox</secondary></indexterm>
<para>The PasswordBox class is an InputBox dialog with an entry line that echoes the keys with asterisks
(*) instead of characters. </para>
<variablelist>
<varlistentry><term>Subclass:</term>
<listitem><para>This class is a subclass of the <link linkend="clsInputBox">InputBox Class</link>
</para></listitem></varlistentry>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's password
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the <link linkend="clsInputBox">InputBox Class</link>,
with the exception of AddLine.</para>

<section id="h002166"><title>AddLine</title>
<indexterm><primary>AddLine</primary>
<secondary>PasswordBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aPasswordBox~AddLine(--x--,--y--,--l--)---------------------><

]]>
</programlisting>

<para>The AddLine overrides the same method of the parent
class, InputBox, by using a password entry line instead
of a simple entry line.</para>
</section>
</section>

<section id="clsMultiInputBox"><title>MultiInputBox Class</title>
<indexterm><primary>MultiInputBox</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>MultiInputBox</secondary></indexterm>
<para>The MultiInputBox class is a dialog that provides
a title, a message, and one or more entry lines. After execution of this dialog
you can access the values of the entry lines. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns 1 (if OK was clicked). The values entered
by the user are stored in attributes matching the labels of the entry lines.
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the <link linkend="clsInputBox">InputBox Class</link>
class, with the exception of Init.</para>

<section id="initMultiInputBox"><title>init</title>
<indexterm><primary>init</primary>
<secondary>MultiInputBox class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aMultiInputBox~init(--message--,--title--,--labels.--,--datas.-->

>--+--------+--)--------------------------------------------------><
   +-,--len-+


]]>
</programlisting>

<para>The init method is called automatically whenever
a new instance of this class is created.  It prepares the dialog. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the entry lines. Use it to
give the user advice on what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string that is displayed in the title bar.
</para></listitem></varlistentry>
<varlistentry><term>labels.</term>
<listitem><para>A stem variable containing strings that are used as labels on the left
side of the entry lines. Labels.1 becomes the label
for the first entry line, labels.2 for the second,
and so forth.
</para></listitem></varlistentry>
<varlistentry><term>datas.</term>
<listitem><para>A stem variable (do not forget the trailing period) containing strings
that are used to initialize the entry lines. The entries must start with 101
and continue in increments of 1.
</para></listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>The length of the entry lines. All entry lines get the same length.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a four-line input box. The data entered
is stored in the object attributes that are displayed after dialog execution.

<programlisting>
<![CDATA[
lab.1 = "First name"  ;     lab.2 = "Last name "
lab.3 = "Street and City" ; lab.4 = "Profession:"

addr.101 = "John" ; addr.102 = "Smith" ; addr.103 = ""
addr.104 = "Software Engineer"

dlg = .MultiInputBox~new("Please enter your address", ,
"Your Address", lab., addr.)
if dlg~execute = 1 then do
  say "The address is:"
  say dlg~firstname dlg~lastname
  say dlg~StreetandCity
  say dlg~Profession
end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>
</section>

<section id="clsListChoice"><title>ListChoice Class</title>
<indexterm><primary>ListChoice</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>ListChoice</secondary></indexterm>
<para>The ListChoice class provides a dialog with a list
box, an OK, and a Cancel button.
The selected item is returned if the OK push button
is used to terminate the dialog. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the user's choice or a null string
</para></listitem></varlistentry>
</variablelist>
<para>The method listed below is defined by this class.</para>

<section id="initListChoice"><title>init</title>
<indexterm><primary>init</primary>
<secondary>ListChoice class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListChoice~init(--message--,--title--,--input.-------------->

>--+---------------------------------------------------+-------><
   +-,--+------+--+-------------------------------+--)-+
        +-lenx-+  +-,--+------+--+--------------+-+
                       +-leny-+  +-,--preselect-+


]]>
</programlisting>

<para>The init method is used to initialize a newly created
instance of this class. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the list box. Use it to give
the user advice on what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string for the dialog's title
</para></listitem></varlistentry>
<varlistentry><term>input.</term>
<listitem><para>A stem variable (do not forget the trailing period) containing string
values that are inserted into the list box
</para></listitem></varlistentry>
<varlistentry><term>lenx, leny</term>
<listitem><para>The size of the list box in dialog units
</para></listitem></varlistentry>
<varlistentry><term>preselect</term>
<listitem><para>Entry that is selected when list pops up
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a list choice dialog box where the user
can select exactly one dessert:
</para></listitem></varlistentry>
</variablelist>
<programlisting>
<![CDATA[
lst.1 = "Cookies"; lst.2 = "Pie"; lst.3 = "Ice cream"; lst.4 = "Fruit"

dlg = .ListChoice~new("Select the dessert please","YourChoice",lst., , ,"Pie")
say "Your ListChoice data:" dlg~execute
]]>
</programlisting>
</section>
</section>

<section id="clsMultiListChoice"><title>MultiListChoice Class</title>
<indexterm><primary>MultiListChoice</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>MultiListChoice</secondary></indexterm>
<para>The MultiListChoice class is an extension of the ListChoice class. It makes it possible for the user to
select more than one line at a time. The execute method
returns the selected items' indexes separated by blank spaces.  The first
item has index 1. </para>
<variablelist>
<varlistentry><term>Subclass:</term>
<listitem><para>This class is a subclass of the <link linkend="clsListChoice">ListChoice Class</link>
</para></listitem></varlistentry>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the index numbers of the entries selected
</para></listitem></varlistentry>
<varlistentry><term>Preselect:</term>
<listitem><para>Indexes of entries, separated by a blank, that are to be preselected.
The first entry has index 1 and the rest are increments of one.
</para></listitem></varlistentry>
</variablelist>
<para>The methods are the same as for the <link linkend="clsListChoice">ListChoice Class</link>
class, except that execute returns the index numbers
of the selected entries. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates a multiple list choice box where the user
can select multiple entries:
</para></listitem></varlistentry>
</variablelist>
<programlisting>
<![CDATA[
lst.1 = "Monday" ;   lst.2 = "Tuesday" ; lst.3 = "Wednesday"
lst.4 = "Thursday" ; lst.5 = "Friday" ;  lst.6 = "Saturday"
lst.7 = "Sunday"

dlg = .MultiListChoice~new("Select the days you are working this week", ,
                           "YourMultipleChoice",lst., , ,"2 5")
s = dlg~execute
if s <> "" then do while s \= ""
                  parse var s res s
                  say lst.res
               end
]]>
</programlisting>
</section>

<section id="clsSingleSelection"><title>SingleSelection Class</title>
<indexterm><primary>SingleSelection</primary>
<secondary>class</secondary></indexterm>
<indexterm><primary>standard dialogs</primary>
<secondary>SingleSelection</secondary></indexterm>
<para>The SingleSelection class shows a dialog that has
a group of radio buttons. The user can select only one item of the group. </para>
<variablelist>
<varlistentry><term>Execute:</term>
<listitem><para>Returns the number of the radio button selected
</para></listitem></varlistentry>
</variablelist>
<para>The method listed below is defined by this class.</para>

<section id="initSingleSelection"><title>init</title>
<indexterm><primary>init</primary>
<secondary>SingleList class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aSingleSelection~init(--message--,--title--,--labels.--,--data-->

>--+------------------------+--)-------------------------------><
   +-,--+-----+--+--------+-+
        +-len-+  +-,--max-+


]]>
</programlisting>

<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the radio button group.  Use
it to give the user advice on what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string for the title bar
</para></listitem></varlistentry>
<varlistentry><term>labels.</term>
<listitem><para>This argument is a stem variable containing all labels for the radio
buttons
</para></listitem></varlistentry>
<varlistentry><term>data</term>
<listitem><para>You can use this argument to preselect one radio button. A value of
1 selects the first radio button, a value of 2 selects the second, and so
on.
</para></listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>Determines the length of the check boxes and labels. If omitted, the
size is calculated to fit the largest label.
</para></listitem></varlistentry>
<varlistentry><term>max</term>
<listitem><para>The maximum number of radio buttons in one column. If there are more
radio buttons than max - that is, labels. has more items than the value of max
- this method continues with a new column.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example creates and executes a dialog that contains a
two-column radio button group. The fifth radio button (the button with the
label May) is preselected.

<programlisting>
<![CDATA[
mon.1 = "January" ; mon.2 = "February" ; mon.3 = "March"
mon.4 = "April"   ; mon.5 = "May"      ; mon.6 = "June"
mon.7 = "July"    ; mon.8 = "August"   ; mon.9 = "September"
mon.10= "October" ; mon.11= "November" ; mon.12= "December"

dlg = .SingleSelection~new("Please select a month!", ,
                           "Single Selection", mon., 5, , 6)
s = dlg~execute
say  "You Selected the month: " mon.s
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

</section>

</section>


<section id="sctPublicRoutines"><title>Public Routines</title>
<indexterm><primary>ooDialog public routines</primary></indexterm>
<para>
  The routines listed in this section can be used in any Rexx program.  They are designed to be even easier to use than
  the standard dialogs. Simply add a requires directive for the <computeroutput>ooDialog.cls</computeroutput> file in
  a Rexx program to use any of these routines.
<programlisting>
<![CDATA[
::requires ooDialog.cls
]]>
</programlisting>
</para>

<section id="rtnMessageDialog"><title>MessageDialog</title>
<indexterm><primary>MessageDialog</primary></indexterm>
<indexterm><primary>public routines</primary><secondary>MessageDialog</secondary></indexterm>
<programlisting>
<![CDATA[
>>--MessageDialog(--msg-+--------+-+-------+-+------+-+--------+-+--------+-)---><
                        +-,-hwnd-+ +-,-cap-+ +-,-pb-+ +-,-icon-+ +-,-misc-+
]]>
</programlisting>

<para>
  Displays a message box on the screen with the options specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>msg [required]</term>
      <listitem>
      <para>
        The message text to be displayed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>hwnd [optional]</term>
      <listitem>
      <para>
        The window <link linkend="defHandle">handle</link> of the owner window for the message box. The owner window is
        disabled until the user closes the message box. If this argument is omitted, the ooDialog framework will use the
        last created, topmost, dialog as the owner window. To explicitly choose that there should be no owner window,
        specify <computeroutput>0</computeroutput> for this argument.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>cap [optional]</term>
      <listitem>
      <para>
        The caption, or title, of the message box. The default title when omitted is: <emphasis role="italic">ooDialog
        Application Message</emphasis>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>pb [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">pb</emphasis> argument specifies which push buttons the message box will have. The
        default if this argument is omitted is a single Ok button. Otherwise, use exactly one of the following keywords,
        case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>ABORTRETRYIGNORE </member>
          <member>CANCELTRYCONTINUE</member>
          <member>OK               </member>
          <member>OKCANCEL         </member>
          <member>RETRYCANCEL      </member>
          <member>YESNO            </member>
          <member>YESNOCANCEL      </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>ABORTRETRYIGNORE</term>
          <listitem>
          <para>
            The message box wil have three push buttons: <emphasis role="bold">Abort</emphasis>, <emphasis
            role="bold">Retry</emphasis>, and <emphasis role="bold">Ignore</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CANCELTRYCONTINUE</term>
          <listitem>
          <para>
            The message box wil have three push buttons: <emphasis role="bold">Cancel</emphasis>, <emphasis
            role="bold">Try Again</emphasis>, and <emphasis role="bold">Continue</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>OK</term>
          <listitem>
          <para>
            The message box wil have one push button: <emphasis role="bold">Ok</emphasis>. This is the default if the
            argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>OKCANCEL</term>
          <listitem>
          <para>
            The message box wil have two push buttons: <emphasis role="bold">Ok</emphasis> and <emphasis
            role="bold">Cancel</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RETRYCANCEL</term>
          <listitem>
          <para>
            The message box wil have two push buttons: <emphasis role="bold">Retry</emphasis> and <emphasis
            role="bold">Cancel</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>YESNO</term>
          <listitem>
          <para>
            The message box wil have two push buttons: <emphasis role="bold">Yes</emphasis> and <emphasis
            role="bold">No</emphasis>.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>YESNOCANCEL</term>
          <listitem>
          <para>
            The message box wil have three push buttons: <emphasis role="bold">Yes</emphasis>, <emphasis
            role="bold">No</emphasis>, and <emphasis role="bold">Cancel</emphasis>.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>icon [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">icon</emphasis> argument specifies the icon placed in the message box. If this
        argument is omitted then the message box will not display an icon. Note that several keywords may specify the
        same icon. To have an icon appear in the message box, use exactly one of the following keywords, case is not
        significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>EXCLAMATION</member>
          <member>WARNING    </member>
          <member>INFORMATION</member>
          <member>ASTERISK   </member>
          <member>QUESTION   </member>
          <member>STOP       </member>
          <member>ERROR      </member>
          <member>HAND       </member>
          <member>QUERY      </member>
          <member>NONE       </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>EXCLAMATION</term>
          <listitem>
          <para>
            The message box will have an exclamation-point icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>WARNING</term>
          <listitem>
          <para>
            The message box will have an exclamation-point icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>INFORMATION</term>
          <listitem>
          <para>
            The message box will have an icon consisting of a lowercase letter i in a circle.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ASTERISK</term>
          <listitem>
          <para>
            The message box will have an icon consisting of a lowercase letter i in a circle.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>QUESTION</term>
          <listitem>
          <para>
            The message box will have a question-mark icon. Microsoft recommends that this icon not be used any more for
            a number of reasons. If you want your Rexx programs to have the same look and feel of other Windows
            programs, then you should not use the question-mark icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>STOP</term>
          <listitem>
          <para>
            The message box will have a stop-sign icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ERROR</term>
          <listitem>
          <para>
            The message box will have a stop-sign icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HAND</term>
          <listitem>
          <para>
            The message box will have a stop-sign icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>QUERY</term>
          <listitem>
          <para>
            The message box will have a question-mark icon, same as the QUESTION keyword. Microsoft recommends not using
            this icon.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NONE</term>
          <listitem>
          <para>
            Used to allow the programmer to explicitly state that the message box should not have an icon. Omitting the
            <emphasis role="italic">icon</emphasis> argument altogether has the same effect.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>misc [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">misc</emphasis> argument specifies a number of other attributes that can be set for
        the message box. The argument consists of a blank separated string of keywords from the lists below. The
        default if this argument is omitted is <computeroutput>"DEFBUTTON1 APPLMODAL"</computeroutput>.
      </para>
      <para>
        The keywords are divided up into four groups. Except for the <emphasis role="italic">other
        miscellaneous</emphasis> group, only one keyword from each groupd should be used, case is not significant. If
        more than one keyword in a group is used, the behavior is undefined.
      </para>
      <para>
        These keywords are used to select the default push button when the message box is shown. Use only one keyword
        from this group.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>DEFBUTTON1</member>
          <member>DEFBUTTON2</member>
          <member>DEFBUTTON3</member>
          <member>DEFBUTTON4</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>DEFBUTTON1</term>
          <listitem>
          <para>
            The first button is the default button. This is the default value if none of the other default button
            keywords are used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFBUTTON2</term>
          <listitem>
          <para>
            The second button is the default button.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFBUTTON3</term>
          <listitem>
          <para>
            The third button is the default button.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFBUTTON4</term>
          <listitem>
          <para>
            The fourth button is the default button.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      <para>
        These keywords are used to indicate the <link linkend="defModalModeless">modality</link> of the message box.
        <emphasis role="bold">Note</emphasis> that the description of the modality behaviour here assumes that the
        window specified by the <emphasis role="italic">hwnd</emphasis> argument belongs to the programmer's Rexx
        application. Use only one keyword from this group.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>APPLMODAL  </member>
          <member>SYSTEMMODAL</member>
          <member>TASKMODAL  </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>APPLMODAL</term>
          <listitem>
          <para>
            Application Modal: The user must close the message box before continuing to work in the window specified by
            the <emphasis role="italic">hwnd</emphasis> argument. However, the user can move to windows on the desktop
            not part of the application and work in those windows.
          </para>
          <para>
            Depending on the hierarchy of windows in the application, the user may be able to move to other windows
            within the application. However, all child windows of the owner window of the message box are automatically
            disabled.
          </para>
          <para>
            APPLMODAL is the default if neither SYSTEMMODAL nor TASKMODAL are specified.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SYSTEMMODAL</term>
          <listitem>
          <para>
            System Modal: The modality for this keyword is the same as APPLMODAL except that the message box will have
            the topmost style. This means that the message box will stay on top of other windows not part of the
            application, if the user moves to those windows.
          </para>
          <para>
            Microsoft suggests that this type of message box be used to notify the user of serious, potentially
            damaging errors that require immediate attention. SYSTEMMODAL has no effect on the user's ability to
            interact with windows other than those associated with the <emphasis role="italic">hwnd</emphasis> argument.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TASKMODAL</term>
          <listitem>
          <para>
            Task Modal: This is the same as APPLMODAL except that all the top-level windows belonging to the current
            thread are disabled if the <emphasis role="italic">hwnd</emphasis> argument is 0. Use this keyword when the
            the programmer does not have a window handle available but still needs to prevent input to other windows in
            the application.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      <para>
        Other miscellaneous keywords. One or more keywords from this group can be used..
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>DEFAULTDESKTOP     </member>
          <member>RIGHT              </member>
          <member>RTLREADING         </member>
          <member>SETFOREGROUND      </member>
          <member>TOPMOST            </member>
          <member>SERVICENOTIFICATION</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>DEFAULTDESKTOP</term>
          <listitem>
          <para>
            Same as the desktop of the interactive window station. The programmer should consult the Windows <link
           linkend="defWindowsDoc">documentation</link> when considering to use this keyword.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RIGHT</term>
          <listitem>
          <para>
           The message text is right-justified.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RTLREADING</term>
          <listitem>
          <para>
            Displays the message and caption text using right-to-left reading order on Hebrew and Arabic systems.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SETFOREGROUND</term>
          <listitem>
          <para>
            The operating system, internally, sets the message box as the foreground window.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TOPMOST</term>
          <listitem>
          <para>
            The message box will have the topmost window style. This will keep the message box above all other windows
            on the desktop.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SERVICENOTIFICATION</term>
          <listitem>
          <para>
            The application dialog calling the <emphasis role="italic">MessageDialog</emphasis> routine is a service
            notifying the user of an event. The <emphasis role="italic">MessageDialog</emphasis> displays a message box
            on the current active desktop, even if there is no user logged on to the computer.
          </para>
          <para>
            ooDialog and Rexx programs in general are not particularly suited to implement Windows services. So it is
            unlikely that this keyword will be used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HELP</term>
          <listitem>
          <para>
            Adds a <emphasis role="bold">Help</emphasis> push button to the message box, in addition to the push buttons
            specifed in the <emphasis role="italic">pb</emphasis> argument. When the user clicks the <emphasis
            role="bold">Help</emphasis> button or presses F1, the operating system sends a HELP event <link
            linkend="ovvEvents">notification</link> to the window specified by the <emphasis
            role="italic">hwnd</emphasis> argument. If this window is an ooDialog dialog, the programmer can capture
            this notification using the <link linkend="mthConnectHelp">connectHelp</link> method.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="italic">MessageDialog</emphasis> returns the Microsoft defined resource ID of the button pushed by
    the user, and 0 on error. The programmer can use a <link linkend="sctMethodsDlgObject">constant</link> of the <link
    linkend="chpDialogObject">dialog object</link> to determine the return. The return values are:
    <variablelist>
      <varlistentry><term>0</term>
      <listitem>
      <para>
        An error ocurred. the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable will be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>1 IDOK</term>
      <listitem>
      <para>
        The <emphasis role="bold">Ok</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>2 IDCANCEL</term>
      <listitem>
      <para>
        The <emphasis role="bold">Cancel</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>3 IDABORT</term>
      <listitem>
      <para>
        The <emphasis role="bold">Abort</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>4 IDRETRY</term>
      <listitem>
      <para>
        The <emphasis role="bold">Retry</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>5 IDIGNORE</term>
      <listitem>
      <para>
        The <emphasis role="bold">Ignore</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>6 IDYES</term>
      <listitem>
      <para>
        The <emphasis role="bold">Yes</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>7 IDNO</term>
      <listitem>
      <para>
        The <emphasis role="bold">No</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>8 IDCLOSE</term>
      <listitem>
      <para>
        The <emphasis role="bold">Close</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>9 IDHELP</term>
      <listitem>
      <para>
        The <emphasis role="bold">Help</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>10 IDTRYAGAIN</term>
      <listitem>
      <para>
        The <emphasis role="bold">Try Again</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>11 IDCONTINUE</term>
      <listitem>
      <para>
        The <emphasis role="bold">Continue</emphasis> button was pushed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the message box has a <emphasis role="bold">Cancel</emphasis> button, IDCANCEL is also returned if the user
    uses the ESC key. If the message box does not have a <emphasis role="bold">Cancel</emphasis> button, then the user
    can not close the message box by using the ESC key.
  </para>
  <para>
    The <link linkend="rtnAskDialog">AskDialog</link>, <link linkend="rtnInfoDialog">InfoDialog</link>, and <link
    linkend="rtnErrorDialog">errorDialog</link> routines are all implemented using the
    <computeroutput>MessageDialog</computeroutput> routine. While they are simplier to use, they are not very flexible.
    In addition because of the way <link linkend="defModalModeless">modal</link> dialogs are implemented, it is possbile
    that those routines will not diable the correct dialog. If the programmer encounters problems with the wrong dialog
    being disabled, the solution is to use the <computeroutput>MessageDialog</computeroutput> routine and specify the
    proper window handle of the owner window.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from a Wizard 97 program that warns the user when she is about to change the page and has not
    completed all of the steps on the page she is on.
<programlisting>
<![CDATA[

::method wizNext unguarded
  expose selectedMovies movieTheaters movieCombo
  use arg propSheet

  do movie over selectedMovies
    if movieTheaters[movie] == .nil then do

      msg = "Warning.  You have not selected a movie" || .endOfLine ||           -
            "theater for all selected movies."        || .endOfLine~copies(2) || -
            "Are you sure you want to go to"          || .endOfLine ||           -
            "the next page?"

      title = "Theater Selection is not Complete"
      buttons = "YESNO"
      icon = "WARNING"
      style = "DEFBUTTON2 TASKMODAL"

      ans = MessageDialog(msg, propSheet~dlgHandle, title, buttons, icon, style)

      if ans == .PlainBaseDialog~IDYES then return 0

      movieCombo~select(movie)
      self~setRadioButtons(movie)
      return -1
    end
  end

  return 0
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End public routines::messageDialog() -->


<section id="rtnInfoDialog"><title>InfoDialog Routine</title>
<indexterm><primary>InfoDialog</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>InfoDialog</secondary></indexterm>
<para>Pops up a message box containing the specified text and an OK button.</para>
<programlisting>
<![CDATA[
>>-InfoDialog(--info_text--)----------------------------------><


]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Argument:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>info_text</term>
<listitem><para>Text to be displayed in the message box.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnErrorDialog"><title>ErrorDialog Routine</title>
<indexterm><primary>ErrorDialog</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>ErrorDialog</secondary></indexterm>
<para>Pops up a message box containing the specified text, an OK button, and
an error symbol.</para>
<programlisting>
<![CDATA[
>>-ErrorDialog(--error_text--)--------------------------------><
]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Argument:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>error_text</term>
<listitem><para>Text to be displayed in the message box.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnAskDialog"><title>AskDialog Routine</title>
<indexterm><primary>AskDialog</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>AskDialog</secondary></indexterm>
<para>Pops up a message box containing the specified text, a Yes button, and
a No Button.</para>
<programlisting>
<![CDATA[
>>-AskDialog(--question--+-------------------+--)-------------><
                         +--, defaultbutton--+

]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>question</term>
<listitem><para>Text to be displayed in the message box.
</para></listitem></varlistentry>
<varlistentry><term>defaultbutton</term>
<listitem><para>Specifies which button, the Yes or the No button, has the
default focus when the message box pops up. This argument can be Yes or No and
is optional. If the argument is omitted, the Yes button will be given the focus.
Only the first letter of the option is needed and case is not significant.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>Return Values:</term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The No button has been selected.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The Yes button has been selected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnFileNameDialog"><title>FileNameDialog Routine</title>
<indexterm><primary>FilenameDialog</primary></indexterm>
<indexterm><primary>public routines</primary><secondary>FileNameDialog</secondary></indexterm>
<programlisting>
<![CDATA[
>>-FileNameDialog(-+-----+-+----------+-+-------+-+--------+-+---------+-->
                   +-sel-+ +-,-parent-+ +-,-msk-+ +-,-type-+ +-,-title-+

>-----------------+----------+-+---------+-+-----------+--)---------------><
                  +-,-defExt-+ +-,-multi-+ +-,-sepChar-+


]]>
</programlisting>

<para>
  Causes a file selection dialog box to appear. File selection dialogs are used to allow the user to pick a file or set
  of files to open, or to pick a file to save to.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>sel [optional]</term>
    <listitem>
    <para>
      This argument can be used to pre-select a file and / or have the open or save dialog start in a specified
     directory.
    </para>
    <para>
      This argument initializes the open or save dialog by selecting the specified file and placing its name in the
      <emphasis role="italic">File</emphasis> edit control of the dialog. In addition this argument can also be used to
      specify the initial directory (folder) the dialog opens in.
    </para>
    <para>
      When this argument contains no path information, then the <emphasis role="italic">File</emphasis> name edit
      control will contain the argument and the initial directory is determined by the operating system.  Which
      directory the operating system picks varies slightly between versions of Windows. But, in general, it will be a
      directory previously used in one of the Windows common dialogs, or a directory in the users My Documents folder.
    </para>
    <para>
      If the argument contains file name and path information, the initial directory will be determined by the path
      information and the <emphasis role="italic">File</emphasis> name edit control will contain the file information.
      When the selfile argument contains only path information and no file name information, i.e. the
      argument ends with a back slash <emphasis role="italic">\</emphasis>, then the initial directory will be that
      path and the <emphasis role="italic">File</emphasis> name edit control will be left blank.
    </para>
    <para>
      In cases where the argument contains incorrect path information, the initial directory is determined as if no path
      information had been supplied and the entire value of the argument is placed in the File name field.
    </para>
    <para>
      <emphasis role="bold">Note</emphasis> that Windows treats normal wild card characters as valid for file names.
      Therefore, values such as <emphasis role="italic">C:\*.*</emphasis> or <emphasis
      role="italic">C:\Windows\*.exe</emphasis> are acceptable for this argument.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>parent [optional]</term>
    <listitem>
    <para>
      The window <link linkend="defHandle">handle</link> of a parent window for the open or save file dialog. Normally
      the programmer would use the handle of a dialog in her program. The operating system disables the parent window
      until the user closes the open or save dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>msk [optional]</term>
    <listitem>
    <para>
      This argument contsists of pairs of filter strings where each of the filter strings is separated with a
      <computeroutput>'0'x</computeroutput> character and the pairs of strings within a filter are also seperated with a
      <computeroutput>'0'x</computeroutput> charatcter. The first string in each pair describes the filter and the
      second string in the pair is a list of file patterns to use for the filter. For instance, if the file pattern
      filter is <computeroutput>*.txt</computeroutput> then only files with the extension of
      <computeroutput>.txt</computeroutput> are displayed in the dialog. The file pattern can consist of any valid file
      name characters and and the asterisk (*) wildcard character. But the pattern can not contain any space characters.
    </para>
    <para>
      An example of how to construct this string is as follows:

<programlisting>
<![CDATA[

  delimiter = '0'x

  pair1 = "DLL Files (*.dll)"delimiter"*.dll"delimiter
  pair2 = "Class Files (*.cls)"delimiter"*.cls"delimiter

  filter = pair1 || pair2

]]>
</programlisting>
      To specify multiple file extension patterns for a single display string, use a semicolon to separate the patterns,
      for example:

<programlisting>
<![CDATA[

  delimiter = '0'x

  pair1 = "Text Files (*.txt)"delimiter"*.txt;*.bak;*.doc"delimiter
  pair2 = "Class Files (*.cls)"delimiter"*.cls"delimiter

  filter = pair1 || pair2

]]>
</programlisting>

    </para>
    <para>
      The operating system does not change the order of the filters. In the open or save dialog the filters are
      dislpayed in the File Types combo box in the order specified in the <emphasis role="italic">mask</emphasis>
      argument.
    </para>
    <para>
      To have the dialog box not display any filters, use the empty string for this argument. The default filter string
      when this argument is omitted is:

<programlisting>
<![CDATA[

  delimiter = '0'x

  "Text Files (*.txt)"delimiter"*.txt"delimiter"All Files (*.*)"delimiter"*.*"delimiter

]]>
</programlisting>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>type [optional]</term>
    <listitem>
    <para>
      A keyword specifying if the <emphasis role="italic">File Open</emphasis> or <emphasis role="italic">File
      Save</emphasis> dialog is displayed. By default the <emphasis role="italic">File Open</emphasis> is used. The
      keyword can be <emphasis role="italic">LOAD</emphasis> for the file open dialog or <emphasis
      role="italic">SAVE</emphasis> for the file save dialog. Only the first letter of the argument is needed and case
      is not significant.
    </para>
    <para>
      If the <emphasis role="italic">File Save</emphasis> dialog is not explicitly requested, the <emphasis role="italic">File Open</emphasis>
      dialog is always presented.  For historic reasons this argument can also be <computeroutput>1</computeroutput> for
      the <emphasis role="italic">File Open</emphasis> dialog or <computeroutput>0</computeroutput> for the
      <computeroutput>File Save</computeroutput> dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>title [optional]</term>
    <listitem>
    <para>
      The window title for the save or open file idlaog. The default is <emphasis role="italic">Open a File</emphasis>
      or <emphasis role="italic">Save File As</emphasis>, depending on what is specified for the <emphasis
      role="italic">type</emphasis> argument.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>defExt [optional]</term>
    <listitem>
    <para>
      The default file extension. The <emphasis role="italic">File Open</emphasis> or <emphasis role="italic">File
      Save</emphasis> dialog append this extension if the user does not type an extension.  Although this extension can
      be any length, the opererating system only uses the first 3 characters. The string must not include the <emphasis
      role="italic">.</emphasis> character.
    </para>
    <para>
      If this argument is omitted, <emphasis role="italic">txt</emphasis> is used. To prevent the operating system from
      appending an extension, the programmer should use the empty string for this argument.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>multi [optional]</term>
    <listitem>
    <para>
      Specifies if the <emphasis role="italic">File Open</emphasis> dialog allows selection of multiple files. Normally,
      the open dialog allows the user to select one file only.  This can be changed by specifying the keyword <emphasis
      role="italic">MULTI</emphasis> for this option. Only the first letter is needed and case is not significant.
    </para>
    <para>
      This option is ignored for <emphasis role="italic">File Save</emphasis> dialogs. If the multiple file selection is
      enabled and the user selects multiple files, the returned result is then: <computeroutput>path file1 file2 file3
      ...</computeroutput>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>sepChar [optional]</term>
    <listitem>
    <para>
      Specifies the separation character for the returned path and file names. This is needed for file names with blank
      characters. If this argument is omitted, the separation character is a blank. If the argument is specified, the
      returned path and file name string uses this separation character. For example, if you specify <emphasis
      role="italic">#</emphasis>  as the separation character, the return string might look as follows:

<programlisting>
<![CDATA[
C:\WINNT#file with blank.ext#fileWithNoBlank.TXT
]]>
</programlisting>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the selected file name or 0 if the user cancels the dialog. Open file dialogs with multiple selection return
    <computeroutput>path file1 file2 file3 ...</computeroutput> when the user selects multiple files.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the user changes directory with the <emphasis role="italic">File Open</emphasis> or <computeroutput>File
    Save</computeroutput> dialog, then the current directory of the Rexx program will be changed.  This is the behavior
    of the underlying Windows dialog, which is designed to work that way.  The ooDialog programmer should be aware of
    this behavior and insert code to change the directory back if that is needed. For example:

<programlisting>
<![CDATA[
curdir = directory()
file = FileNameDialog("*.pdf", , "Adobe PDF Files"'0'x"*.pdf"'0'x)
call directory curdir
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="rtnTimedMessage"><title>TimedMessage Routine</title>
<indexterm><primary>TimedMessage</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>TimedMessage</secondary></indexterm>
<para>The TimedMessage routine provides a shortcut to invoke a <link
linkend="clsTimedMessage">TimedMessage</link> dialog as a function:
</para>
<programlisting>
<![CDATA[
ret = TimedMessage("We are starting...","Please wait",3000)
]]>
</programlisting><para> The parameters are the same as described in the
<link linkend="initTimedMessage">init</link> method of the <computeroutput>
TimedMessage</computeroutput> class.
</para>
<para>The function returns 0, always, when the duration is non-negative.  When
the duration is less than 0, the function returns a reference to the
<computeroutput>TimedMessage</computeroutput> dialog object.  This is needed in
order for the programmer to manually dismiss the dialog.  Below are the same 3
<link linkend="example1TimedMessage">examples</link> listed for the
<computeroutput>TimedMessage</computeroutput> dialog, modified to work with the
public routine:
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Example
 1:</emphasis></term>
<listitem><para>The following example shows a window with the title of <emphasis
role="italic">Infomation</emphasis> for a duration of 3 seconds:
<programlisting> <![CDATA[
ret = timedMessage("Application will be started, please wait", -
                   "Information", 3000)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example
2:</emphasis></term>
<listitem><para>The following example shows an introductory window that displays
while an application is doing its time consuming start up routine.  Since this
start up process can vary in time depending on the individual system, the window
is set to display indefinitely.  When the start up process is finished, the
programmer dismisses the window and destroys the dialog manually.  Note how a
reference to the <computeroutput>TimedMessage</computeroutput> dialog is
returned.  The programmer only needs to use this to dismiss / destroy the dialog
<programlisting>
<![CDATA[
dlg = timedMessage("The WidgetCreator Application - loading ...", -
                   "The Widget Factory", -1)
ret = doStartup()
dlg~ok
if ret <> 0 then do
  ...
end
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example
3:</emphasis></term>
<listitem><para>The following example is a variation on <emphasis role="bold">
Example 2</emphasis>.  In this case the Widget Factory executives decided that
they want their WidgeCreator splash screen to always display for 2 seconds to
the customer and then close.  The early reply argument is used so that the start
up routine executes immediately.  After 2 seconds the splash screen dismisses
and the dialog is destroyed automatically.
</para>
<programlisting> <![CDATA[
ret = timedMessage("The WidgetCreator Application - loading ...", -
                   "The Widget Factory", 2000)

if doStartup() <> 0 then do
  ...
end
]]>
</programlisting></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnInputBox"><title>InputBox Routine</title>
<indexterm><primary>InputBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>InputBox</secondary></indexterm>
<para>A shortcut function to invoke an
<link linkend="clsInputBox">InputBox</link> dialog as a function: </para>
<programlisting>
<![CDATA[
say "Your name:" InputBox("Please enter your name","Personal Data")
]]>
</programlisting><para> The parameters are described in the <link
linkend="initInputBox">init</link> method of the<computeroutput>
InputBox</computeroutput> class.</para>
</section>

<section id="rtnPasswordBox"><title>PasswordBox Routine</title>
<indexterm><primary>PasswordBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>PasswordBox</secondary></indexterm>
<para>A shortcut to invoke a <link linkend="clsPasswordBox">PasswordBox</link>
dialog as a function:
</para>
<programlisting>
<![CDATA[
pwd = PasswordBox("Please enter your password","Security")
]]>
</programlisting>
<para> The parameters are described in the <link
linkend="initInputBox">init</link> method of the <computeroutput>
InputBox</computeroutput>class.
</para>
</section>

<section id="rtnIntegerBox"><title>IntegerBox Routine</title>
<indexterm><primary>IntegerBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>IntegerBox</secondary></indexterm>
<para>A shortcut to invoke an <link linkend="clsIntegerBox">IntegerBox</link>
dialog as a function:
</para>
<programlisting>
<![CDATA[
say "Your age:" IntegerBox("Please enter your age","Personal Data")
]]>
</programlisting>
<para> The parameters are described in the <link
linkend="initInputBox">init</link> method of the <computeroutput>
InputBox</computeroutput>class.
</para>
</section>

<section id="rtnMultiInputBox"><title>MultiInputBox Routine</title>
<indexterm><primary>MultiInputBox</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>MultiInputBox</secondary></indexterm>
<para>Provides a shortcut function to invoke a <link
linkend="clsMultiInputBox">MultiInputBox</link> dialog:</para>
<programlisting>
<![CDATA[
res = MultiInputBox("Enter your address","Personal Data", ,
                    .array~of("&First name","Last &name","&City"), ,
                    .array~of("John","Smith","San Jose"), 100)
if res \= .Nil then do entry over res
                       say "Address-line[]= " entry
                    end
]]>
</programlisting>
<para> The parameters are described in the <link
linkend="initMultiInputbox">init</link> method of the <computeroutput>
MultiInputBox</computeroutput>class.  However, instead of using stems,
arrays are used for input.
</para>
<para>The user's input to the dialog is also returned in an array.  Note this
other difference from the MultiInputBox dialog: if the user cancels the dialog
<computeroutput>.nil</computeroutput> is returned rather than the empty string.
</para>
</section>

<section id="rtnListChoice"><title>ListChoice Routine</title>
<indexterm><primary>ListChoice</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>ListChoice</secondary></indexterm>
<para>The ListChoice function provides a shortcut to invoke a <link
linkend="clsListChoice">ListChoice</link> dialog:
</para>
<programlisting>
<![CDATA[
day = ListChoice("Select a day","My favorite day", ,
                 .array~of("Monday","Tuesday","Wednesday","Thursday", ,
                          "Friday","Saturday","Sunday") , , ,"Thursday")
say "Your favorite day is" day
]]>
</programlisting>
<para> The parameters are described in the <link
linkend="initListChoice">init</link> method of the <computeroutput>
ListChoice</computeroutput>class. However, instead of an input stem an array is
passed into the function.
</para>
<para>If the user cancels the dialog <computeroutput>.nil</computeroutput> is
returned rather than the empty string.
</para>
</section>

<section id="rtnMultiListChoice"><title>MultiListChoice Routine</title>
<indexterm><primary>MultiListChoice</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>MultiListChoice</secondary></indexterm>
<para>Provides a shortcut to invoke a <link
linkend="clsMultiListChoice">MultiListChoice</link> dialog as a function:
</para>
<programlisting>
<![CDATA[
days = MultiListChoice("Select days","My TV Days", ,
                       .array~of("Monday","Tuesday","Wednesday", ,
                              "Thursday","Friday","Saturday","Sunday"), , ,"2 5")
if days <> .Nil then do day over days
                       say "TV day =" day
                    end
]]>
</programlisting>
<para> The parameters are described in the <link
linkend="initListChoice">init</link> method of the <computeroutput>
MultiListChoice</computeroutput>class. However, instead of stems, arrays are
passed into the function.
</para>
<para>If the user cancels the dialog <computeroutput>.nil</computeroutput> is
returned rather than the empty string.
</para>
</section>

<section id="rtnCheckList"><title>CheckList Routine</title>
<indexterm><primary>CheckList</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>CheckList</secondary></indexterm>
<para>A shortcut function to invoke the <link linkend="clsCheckList">CheckList</link>
dialog: </para>

<programlisting>
<![CDATA[
>>--CheckList(--message--,--title--,--labels--,-+-----------+---->
                                                +-,--checks-+

>---+------------------------+--)-------------------------------><
    +-,--+-----+--+--------+-+
         +-len-+  +-,--max-+


]]>
</programlisting>

<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are similar to what is described in the <link
linkend="initCheckList">init</link> method of the <computeroutput>
CheckList</computeroutput>class. However, instead of stems, arrays are
passed into and returned from the function.
<variablelist>
<varlistentry><term>message</term>
<listitem><para>A text string that is displayed on top of the check box group.
It could be used, for example, to give the user a hint as to what to do.
</para></listitem></varlistentry>
<varlistentry><term>title</term>
<listitem><para>A text string for the dialog's title
</para></listitem></varlistentry>
<varlistentry><term>labels</term>
<listitem><para>An array containing the labels, in order, for each of the check
boxes.  The dialog will contain a check box for each label.
</para></listitem></varlistentry>
<varlistentry><term>checks</term>
<listitem><para>This argument is an array that allows you to pre-check any of
the check boxes. For each index in this array whose item is <computeroutput>
.true</computeroutput>, (or 1,) the check box at the corresponding index in the
<computeroutput>labels</computeroutput> array will be checked.  For any index
that is not <computeroutput>.true </computeroutput>, the corresponding check box
will not be checked.  This means that the programmer only needs to put a
<computeroutput>.true</computeroutput> at the indexes where he wants the check
boxes checked.  All the other indexes can be left empty.
</para></listitem></varlistentry>
<varlistentry><term>len</term>
<listitem><para>Determines the length (in dialog units) of the check boxes and
labels. If omitted, the size is calculated to fit the largest label.
</para></listitem></varlistentry>
<varlistentry><term>max</term>
<listitem><para>The maximum number of check boxes in one column. If there are
more check boxes than max, that is, if labels has more items than the value of
max, the check boxes will be put into columns.  Each column will contain no more
than the number of check boxes specified by max.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>If the user cancels the dialog, then <computeroutput>.nil
</computeroutput> is returned.  If the user clicks the okay button, then an
array is returned.  The array will be the same size as the input
<computeroutput>labels</computeroutput> array.  Each index of the returned array
will contain <computeroutput>.true</computeroutput> if the corresponding check
box was checked by the user or will contain <computeroutput>.false
</computeroutput> if the check box was not checked.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example</emphasis></term>
<listitem><para>The following example show how to use the
<computeroutput>CheckList</computeroutput> public routine:

<programlisting>
<![CDATA[

  weekdays = .array~of("Monday","Tuesday","Wednesday","Thursday", -
                       "Friday","Saturday","Sunday")

  -- Monday and Tuesday will be checked, all the rest will not be checked.
  checks = .array~of(.true, .true, .false)
  checks[5] = 0
  checks[7] = 'a'

  -- The labels will be 60 dialog units wide and there will be at most 4 check
  -- boxes in a column.  (Only 7 check boxes, so 2 columns, the first with 4
  -- check boxes, the second with 3.)

  days = CheckList("Check the days", "Working Days", weekdays, checks, 60, 4)

  if days <> .Nil then do i = 1 to days~items
    if days[i] then say "Working day =" weekdays[i]
  end

::requires "ooDialog.cls"

]]>
</programlisting>

</para></listitem></varlistentry>
</variablelist>
</section>

<section id="rtnSingleSelection"><title>SingleSelection Routine</title>
<indexterm><primary>SingleSelection</primary>
<secondary>function</secondary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>SingleSelection</secondary></indexterm>
<para>The SingleSelection function provides a shortcut means to invoke a
<link linkend="clsSingleSelection">SingleSelection</link> dialog
</para>
<programlisting>
<![CDATA[

months = .array~of("Jan","Feb","Mar","Apr","May","Jun",  -
                   "Jul","Aug","Sep","Oct","Nov","Dec")
title = "Month You Were Born"
groupBoxLabel = "Check your birth month"
selectedRadioButton = 3

m = SingleSelection(groupBoxLabel, title, months, selectedRadioButton, , 6)
if m == "" then
    say "The user canceled the dialog."
else
    say "Born in month" m "=" months[m]

::requires "ooDialog.cls"

]]>
</programlisting>
<para> The parameters are described in the <link
linkend="initSingleSelection">init</link> method of the <computeroutput>
SingleSelection</computeroutput>class. However, instead of an input stem an
array is passed into the function.
</para>
</section>

</section>

</section>


<!-- <section id="clsMouse"><title>Mouse Class</title>  START -->
&mouseClass;
<!-- <section id="clsMouse"><title>Mouse Class</title>  END   -->


</chapter>
