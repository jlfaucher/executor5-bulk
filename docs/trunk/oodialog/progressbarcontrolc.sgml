<!--#########################################################################
    #
    # Description: Open Object Rexx: OODialog Reference SGML file.
    #
    # Copyright (c) 2005-2006, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="progressbarcontrolc"><title>ProgressBarControl Class</title>
<indexterm><primary>ProgressBarControl class</primary></indexterm>
<para>A progress bar is a window that an application can use to indicate the
progress of a lengthy operation. It consists of a rectangle that is gradually
filled, from left to right, with the system highlight color as an operation
progresses. It has a range and a current position. The range represents the
entire duration of the operation, and the current position represents the
progress that the application has made toward completing the operation.</para>
<para>The ProgressBarControl class provides methods to
change the range and the current position of the progress bar. The window
procedure uses the range and the current position to determine the percentage
of the progress bar.  The highest possible range or current position value
is 65,535.</para>
<para>Refer to OODPBAR.REX and PROPDEMO.REX in the OODIALOG\SAMPLES directory
for an example.</para>
<para>The ProgressBarControl class does not send any
notification messages. For information about notification messages, refer
to <link linkend="connectlistnotify">ConnectListNotify</link>.</para>
<variablelist>
<varlistentry><term>Requires:</term>
<listitem><para>The ProgressBarControl class requires the class
definition file <computeroutput>oodwin32.cls</computeroutput>:
<programlisting>
<![CDATA[
::requires "oodwin32.cls"
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>Methods:</term>
<listitem><para>Instances of the ProgressBarControl class implement
the methods listed in the
<link linkend="t000029">ProgressBarControl Instance Methods</link> table.</para>

<table id="t000029" frame="all">
<title>ProgressBarControl Instance Methods</title>
<tgroup cols="2">
<thead>
<row>
<entry>Method...</entry>
<entry>...on page</entry>
</row>
</thead>
<tbody>
<row>
<entry>SetPos</entry>
<entry><link linkend="setpospbc">SetPos</link></entry>
</row>
<row>
<entry>SetRange</entry>
<entry><link linkend="setrangepbc">SetRange</link></entry>
</row>
<row>
<entry>SetStep</entry>
<entry><link linkend="setstep">SetStep</link></entry>
</row>
<row>
<entry>Step</entry>
<entry><link linkend="step">Step</link></entry>
</row>
</tbody></tgroup>
</table>
</listitem></varlistentry>
</variablelist>

<section id="step"><title>Step</title>
<indexterm><primary>Step</primary></indexterm>
<programlisting>
<![CDATA[
>>-aProgressBarControl~Step(--+-----------+--)-----------------><
                              +-increment-+


]]>
</programlisting>

<para>The Step method advances the current position of
a progress bar or the increment set with the SetStep method (see
<link linkend="setstep">SetStep</link>), and redraws the bar to reflect the new
position.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>increment</term>
<listitem><para>The value for advancing the current position. If you do not specify
this argument, the position is advanced by the value set with the SetStep
method. If the position exceeds the maximum range value, the progress indicator
starts at the beginning again.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The previous position.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="setpospbc"><title>SetPos</title>
<indexterm><primary>SetPos</primary>
<secondary>ProgressBarControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aProgressBarControl~SetPos(--newpos--)----------------------><


]]>
</programlisting>

<para>The SetPos method sets the new position for a progress
bar and redraws the bar to reflect the new position.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>newpos</term>
<listitem><para>The new position.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The previous position, or -1 if you do not specify
<emphasis role="italic">newpos</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="setstep"><title>SetStep</title>
<indexterm><primary>SetStep</primary></indexterm>
<programlisting>
<![CDATA[
                                 +-10------+
>>-aProgressBarControl~SetStep(--+---------+--)----------------><
                                 +-newstep-+


]]>
</programlisting>

<para>The SetStep method specifies the step increment
for a progress bar. The step increment is the amount by which the progress
bar increases its current position whenever the method is called.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>newstep</term>
<listitem><para>The new step increment. The default step increment is 10.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The previous position, or -1 if you do not specify
<emphasis role="italic">newpos</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="setrangepbc"><title>SetRange</title>
<indexterm><primary>SetRange</primary>
<secondary>ProgressBarControl class</secondary></indexterm>
<programlisting>
<![CDATA[
                                  +-0---+     +-100-+
>>-aProgressBarControl~SetRange(--+-----+--,--+-----+--)-------><
                                  +-min-+     +-max-+


]]>
</programlisting>

<para>The SetRange method sets the minimum and maximum
values for a progress bar and redraws the bar to reflect the new range.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>min</term>
<listitem><para>The minimum range value. The default is 0.
</para></listitem></varlistentry>
<varlistentry><term>max</term>
<listitem><para>The maximum range value. The default is 100.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A string containing the minimum and maximum value of the
previous range, separated by a blank, or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>
</chapter>
