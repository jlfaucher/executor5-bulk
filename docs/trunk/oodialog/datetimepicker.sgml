<!--#########################################################################
    #
    # Description: Open Object Rexx: OODialog Reference SGML file.
    #
    # Copyright (c) 2009-2010, Rexx Language Association. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="clsDateTimePicker"><title>Date Time Picker Controls</title>
<indexterm><primary>DateTimePicker class</primary></indexterm>
<para>
   A date and time picker (DTP) control provides a simple interface with which to exchange date and time information
   with a user. For example, with a DTP control you can ask the user to enter a date and then easily retrieve the
   selection.
</para>
<note><title>Note</title><para>
  Windows does not support dates prior to 1601. Trying to set a date prior to 1601, programmatically, will raise a
  syntax condition.
</para>
<para>
  The control is based on the Gregorian calendar, which was introduced in 1753. The date and time picker control will
  not calculate dates that are consistent with the Julian calendar.
</para></note>
<para>
  The client area of a date and time picker (DTP) control displays date or time information, or both, and acts as the
  interface through which users modify the information. The date can be selected from a calendar, or by using an up-down
  control. The time can be changed by typing in fields that are defined by the control's <link
  linkend="paraDTPFormatStrings">Format Strings</link>. The control can optionally display a check box. When it is
  checked, the value in the control is condisdered valid and can be retrieved.  When not checked, the control's date and
  time is not valid.
</para>
<para id="paraDTPFormatStrings">
  xx
</para>
<para>
  The DateTimePicker class provides methods to get and set the date and time in the DTP control, along with methods to
  manipulate the control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Requires:</emphasis></term>
  <listitem>
  <para>
  The DateTimePicker class requires the class definition file <computeroutput>ooDialog.cls</computeroutput>:
<programlisting>
<![CDATA[
::requires "ooDialog.cls"
]]>
</programlisting>
  </para></listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Subclass of:</emphasis></term>
  <listitem>
  <para>
    The date and time picker class is a subclass of the <link linkend="chpDialogControlObject">DialogControl</link> class
    and therefore inherits all methods of that class.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Mixin Class Inherits:</emphasis></term>
  <listitem>
  <para>
    The date and time picker class inherits from the following mixin classes, (indirectly through the DialogControl
    class.)
  </para>
  <para>
    The <link linkend="clsWindowBase">WindowBase</link>
  </para>
  <para>
    The <link linkend="clsWindowExtensions">WindowExtensions</link>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Instantiation:</emphasis></term>
  <listitem>
  <para>
    Use the <link linkend="mthNewClsDateTimePicker">newDateTimePicker</link>() method of the <link
    linkend="chpDialogObject">dialog</link> to retrieve a date and time picker object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Dynamic Definition:</emphasis></term>
  <listitem>
  <para>
    To dynamically add a date and time picker to a <link linkend="clsUserDialog">UserDialog</link>, use the
    <link linkend="mthCreateDateTimePicker">createDateTimePicker</link>() method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Notification</emphasis></term>
  <listitem>
  <para>
    To recieve notification of date and time picker events use the <link
    linkend="mthConnectDateTimePickerEvent">connectDateTimePickerEvent</link>)() method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Important Methods:</emphasis></term>
  <listitem>
  <para>
    The following table provides links to the documentation for the primary methods and attributes used in working with
    date and time picker objects. These include all the methods and attributes implemented by the DateTimePicker class,
    and the methods to connect to event notifications from the DTP, get a date and time picker object, and dynamically
    create a date and time picker control in a dialog:
  </para>
  <table id="tblDateTimePickerMethods" frame="all">
  <title>DateTimePicker Methods and Attributes</title>
  <tgroup cols="2">
  <thead>
  <row>
  <entry>Method...</entry>
  <entry>...Documentation</entry>
  </row>
  </thead>
  <tbody>
  <row>
    <entry><link linkend="dtpMthNewClsDateTimePicker">newDateTimePicker</link></entry>
    <entry>Gets a DateTimePicker object that represents a control in a dialog</entry> </row>
  <row>
    <entry><link linkend="tmthCreateDateTimePicker">createDateTimePicker</link></entry>
    <entry>Creates a DateTimePicker control in an <link linkend="clsUserDialog">UserDialog</link></entry>
  </row>
  <row>
    <entry><link linkend="tmthConnectDateTimePickerEvent">connectDateTimePickerEvent</link></entry>
    <entry>Connectes DateTimePicker events to a dialog method</entry>
  </row>
  <row>
    <entry><link linkend="mthCloseMonthCal">closeMonthCal</link></entry>
    <entry>Close the drop down month calendar if it is dropped down</entry>
  </row>
  </tbody></tgroup> </table>
  </listitem></varlistentry>
</variablelist>


<section id="dtpMthNewClsDateTimePicker"><title>newDateTimePicker [Dialog method]</title>
<para>
  DateTimePicker objects can not be instantiated by the programmer from Rexx code using a <emphasis
  role="italic">new</emphasis>() method. Rather, a date and time picker object is obtained by using the <link
  linkend="mthNewClsDateTimePicker">newDateTimePicker</link>() method of the <link
  linkend="chpDialogObject">dialog</link>.  The syntax is:
<programlisting>
<![CDATA[
>>-newDateTimePicker(--id--+-------------+--)---------------------><
                           +-,--category-+

]]>
</programlisting>
</para>
</section>  <!-- End Dialog::newDateTimePicker() [Dialog method] -->


<section id="tmthCreateDateTimePicker"><title>createDateTimePicker [UserDialog method]</title>
<para>
  A date and time picker control can be added to a <link linkend="clsUserDialog">UserDialog</link> dialog
  through the <link linkend="mthCreateDateTimePicker">createDateTimePicker</link>() method. The basic syntax is:
<programlisting> <![CDATA[
>>-createDateTimePicker(-id-,--x-,--y-,--cx-,--cy-+----------+-+-------------+--><
                                                  +-,--style-+ +-,--attrName-+

]]>
</programlisting>
</para>
</section>  <!-- End UserDialog::createDateTimePicker() [UserDialog method] -->


<section id="tmthConnectDateTimePickerEvent"><title>connectDateTimePickerEvent [EventNotification method]</title>
<para>
  To connect event notifications from a DTP control use the <link
  linkend="mthConnectDateTimePickerEvent">connectDateTimePickerEvent</link>() method of the <link
  linkend="clsEventNotification"></link> class. The basic syntax is:

<programlisting> <![CDATA[
>>-connectDateTimePickerEvent(--id--,--event--+----------------+--)------------><
                                              +--,-methodName--+

]]>
</programlisting>
</para>
</section>  <!-- End EventNotification::connectDateTimePickerEvent() [EventNotification method] -->


<section id="mthCloseMonthCal"><title>closeMonthCal</title>
<indexterm><primary>closeMonthCal</primary>
<secondary>DateTimePicker class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--closeMonthCal----------------------------------------------><

]]>
</programlisting>

<para>
  Closes the drop down month calendar control of the date time picker.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
    <para>
      Requires <link linkend="ovvRequiredWindows">Windows Vista</link> or later. Raises syntax errors when incorrect
      arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      The method takes no arguments.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The method always returns 0.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method causes the date time picker to destroy the month calendar control and to send a DTN_CLOSEUP notification
    (the CLOSEUP event notification) that the control is closing.
  </para></listitem></varlistentry>
</variablelist>
</section>  <!-- End DateTimePicker::closeMonthCal() -->

</chapter>  <!-- End DateTimePicker class -->

