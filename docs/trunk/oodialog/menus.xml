<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference SGML file.
    #
    # Copyright (c) 2005-2012 Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="chpMenus"><title>Menus</title>
<indexterm><primary>Menus</primary></indexterm>

<para>
  Menus are lists of items that specify options for an application.  Groups of related options are usually placed in
  submenus. Clicking a menu item either opens a submenu or causes the application to carry out a command.
</para>
<para>
  Menus are arranged as a hierarchy. A <emphasis role="italic">menu bar</emphasis> is the top of the hiearchy for menus
  attached to an application window.  The menu bar will contain a list of <emphasis role="italic">menus</emphasis>, and
  menus can contain <emphasis role="italic">submenus</emphasis>.  Menu bars are often called <emphasis
  role="italic">top-level</emphasis> menus, while the menus and submenus are also known as
  <emphasis role="italic">pop-up</emphasis> menus.
</para>
<para>
  A menu <emphasis role="italic">item</emphasis> either carries out a command, opens a submenu, or is special type of
  menu item called a <emphasis role="italic">separator</emphasis>.  Menu items that do not open a submenu are called
  <emphasis role="italic">command</emphasis> items or simply commands. Menu items that open a submenu are sometimes
  called <emphasis role="italic">menu names</emphasis>. Separators appear as a horizontal line. They are used to divide
  a menu into groups of related items. A separator cannot be used in a menu bar, and the user cannot select a separator.
</para>
<para>
  Only top-level windows can have menu bars. Child windows can not have a menu bar. If the window has a title bar the
  system positions a menu bar underneath it. All menus must have an owner window.
</para>
<para>
   The system also provides <emphasis role="italic">shortcut menus</emphasis> and the <emphasis
   role="italic">window</emphasis> menu.  A shortcut menu is not attached to a menu bar and can appear anywhere on the
   screen.  Shortcut menus are typically activated by the user right-clicking on a specific portion of the screen and
   the menu items are usually only relevant to what the user clicked on.  For this reason, shortcut menus are often
   called <emphasis role="italic">contetxt</emphasis> menus.  The window menu is also knows as the <emphasis
   role="italic">System</emphasis> menu or the <emphasis role="italic">Control</emphasis> menu.  The  System menu is
   usually managed exclusively by the system.  The user activates the System menu by clicking on the icon in the upper
   left corner of a window, or by right-clicking anywhere on the title bar. Unlike menu bars, child windows can have a
   System menu.  It is unusual for a top-level window to not have a System menu.
</para>
<para>
  The menu related classes in the following table are described in this chapter.  The primary classes that the ooDialog
  programmer will use are the <computeroutput>BinaryMenuBar, UserMenuBar, ScriptMenuBar</computeroutput>, and
  <computeroutput>PopupMenu</computeroutput>. The other classes are mixin classes that implement the functionality
  common to all types of menus. The binary, user, and script menu bar classes all have the same essential functionality.
  They just differ in how they are initially created.  The popup menu class is similar to the menu bar classes, it just
  does not have any methods that are only relevant to a menu bar.
<table id="tblMenuClasses" frame="all">
<title>ooDialog Menu Classes</title>
<tgroup cols="2">
<colspec colwidth="2.75in">
<thead>
<row>
<entry>Class</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="clsBinaryMenuBar">BinaryMenuBar</link></entry>
<entry>A menu bar created from a menu resource, or created as an empty menu bar.</entry>
</row>
<row>
<entry><link linkend="clsMenu">Menu (Mixin Class) The Menu Object</link></entry>
<entry>The basis for the menu object.</entry>
</row>
<row>
<entry><link linkend="clsMenuBar">MenuBar (Mixin Class) The Menu Bar Object</link></entry>
<entry>The basis for the menu bar object.</entry>
</row>
<row>
<entry><link linkend="clsPopupMenu">PopupMenu</link></entry>
<entry>A menu or a shortcut menu, also known as a submenu or a context menu.</entry>
</row>
<row>
<entry><link linkend="clsScriptMenuBar">ScriptMenuBar</link></entry>
<entry>A menu bar created from a resource script file.</entry>
</row>
<row>
<entry><link linkend="clsSystemMenu">SystemMenu</link></entry>
<entry>A system menu, also known as the window menu or the control menu.</entry>
</row>
<row>
<entry><link linkend="clsUserMenuBar">UserMenuBar</link></entry>
<entry>
  A menu bar created dynamically by the programmer in a fashion similar to a <link linkend="clsUserDialog">UserDialog</link>.
</entry>
</row>
</tbody></tgroup>
</table>
</para>

<section id="sctMenuItemIDs"><title>Menu Item IDs</title>
<para>
  Each menu item in a menu can be uniquely identified. This documentation generically refers to a menu item <emphasis
  role="italic">ID</emphasis>, but there are really two ways of identifying a menu item.
</para>

<variablelist>
  <varlistentry id="entMenuItemIdentifier"><term><emphasis role="bold">Menu Item Identifier</emphasis></term>
  <listitem>
  <para>
    Each menu item has a unique, non-negative, integer assigned to it by the programmer, called a menu item identifier.
    These numbers are essentially the same as any other resource <link linkend="defResourceID">ID</link> used in
    ooDialog. The Rexx programmer can use numeric or <link linkend="itmMenuSymbolicIDs">symbolic</link> IDs for menu
    item identifier's, in the same way as for other resource IDs.
  </para>
  <para>
    All menus assign menu item identifiers to command items and submenus. ooDialog uses what the Windows operating
    system calls <emphasis role="italic">extended</emphasis> menus. Extended menus also assign identifiers to
    separators. Identifiers are used for menu command <link linkend="sctMenuCommandEvents">events</link>. In addition, a
    menu item can be specified using its identifier in method invocations. For example, to <link
    linkend="mthEnableClsMenu">enable</link> or <link linkend="mthDisableClsMenu">disable</link> a menu item.
  </para>
  <para>
    Identifiers allow the programmer to specify any menu item anywhere in the menu hiearchy. The <link
    linkend="mthGetIDClsMenu">getID</link>() method can be used to retrieve the identifier of the menu item at a
    specified position
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Menu Item Position</emphasis></term>
  <listitem>
  <para>
    In addition to having a unique identifier, each menu item in a menu bar or menu has a unique position value.
    Although the operating system uses zero-based position numbering, ooDialog uses one-based position numbering to
    conform to general Rexx practice. The leftmost item in a menu bar, or the top item in a menu, has position one. The
    position value is incremented for subsequent menu items. A position value is assigned to all items in a menu,
    including separators.
  </para>
  <para>
    Position values can be used in method invocations that require specifying a menu item. Note that since the top item
    in a menu, or the leftmost menu item in a menu bar, always has a position of one, it is not possible to uniquely
    specify any menu item in a menu hiearchy. Rather, you can only use a position to specify an item in a specific
    submenu.
  </para>
  </listitem></varlistentry>
  <varlistentry id="itmMenuSymbolicIDs"><term><emphasis role="bold">Symbolic Menu Item IDs</emphasis></term>
  <listitem>
  <para>
    Menu <emphasis role="italic">item identifiers</emphasis> are essentially resource <link
    linkend="defResourceID">IDs</link>. The programmer can use symbolic <link linkend="defSymbolicID">IDs</link> for
    menu item identifiers rather than numeric IDs for any argument in a menu object method that uses a menu item
    identifier. However, to do so, the programmer <emphasis role="italic">must</emphasis> use the global <link
    linkend="dotConstDir">.constDir</link>. If the global <computeroutput>.constDir</computeroutput> is not used, then
    all menu item identifier arguments <emphasis role="bold">must</emphasis> be numeric.
  </para> </listitem></varlistentry>
</variablelist>
<para>
  Except in a few methods where it simply does not make any sense, all menu methods that require specifying a menu item,
  accept either a menu item identifier or a menu item position. The menu item specifier is refered to as the menu
  item ID. Since both identifiers and positions are numbers, the programmer needs to specify which is being used.
  However, by default, the ID is assumed to be an indetifier. Therefore, the programmer only need indicate when the ID
  is a position ID.
</para>
</section>




<section id="sctMenuCommandItems"><title>Menu Command Items</title>
<indexterm><primary>menu object</primary><secondary>command items</secondary></indexterm>
<para>
  Menu items that are not separators and do not open a submenu are called menu command items.
</para>

<section id="sctMenuCommandEvents"><title>Menu Command Events</title>
<indexterm><primary>menu object</primary><secondary>command events</secondary></indexterm>
<para>
  When a user selects a menu command item, an <link linkend="ovvEvents">event</link> is generated and the operating
  system sends a notification to the owner window of the menu. The ooDialog framework provides methods to connect this
  menu command notification to a method in the Rexx dialog object in a similar manner to connecting dialog control <link
  linkend="sctConnectingEvents">notifications</link>. The event connection methods are contained within the various menu
  objects and are similar to the event connection methods of the dialog object.
</para>
<para>
  However, there are some specific details when dealing with menus that should be understood. The menu command event is
  connected using the menu item <link linkend="sctMenuItemIDs">identifier</link> of the command item, just as dialog
  control events are connected using the resource ID of the dialog control. Event notifications are always connected to
  a specific Rexx dialog object, the dialog object that represents the <link linkend="ovvUnderlying">underlying</link>
  dialog that the notification is expected to be sent to.
</para>
<para>
  A Rexx dialog control object has one, and only one, underlying dialog. But, a Rexx <link linkend="clsMenuBar">menu bar
  </link> object can be attached to one dialog, then detached and attached to a different dialog. Likewise, the same
  <link linkend="clsPopupMenu">context</link> menu could be used by any number of different dialogs. Because of this, it
  may be necessary to connect a menu command item notification to more than one dialog.
</para>
<para>
  For example, the same context menu object could be used by the programmer in several different dialogs. In this case,
  it is not sufficient to connect each of the menu items once, to one dialog. Rather, the menu items need to be
  connected to each dialog where the context menu is used. When the programmer <link
  linkend="mthShowClsPopupMenu">shows</link> the context menu, it will have one and only one owner dialog. When the user
  selects a menu item, the notification is sent to that owner dialog.
</para>
<para>
  Another example would be a program that shows different dialogs at various times. The dialogs are different, but all
  have a menu bar that contains the same items. One approach would be to create a single menu bar, that is attached to
  each dialog when it is shown. The menu items of the menu bar would then need to be connected to each dialog that the
  menu bar is attached to during the program.
</para>
<para>
  One last point the programmer should be aware of. Both a regular menu item selection and a <link
  linkend="clsButton">button</link> click generate the same event notification. <emphasis role="bold">Note</emphasis>
  that a <emphasis role="italic">system</emphasis> menu command event uses a different type of notification than buttons
  or regular menus. A system menu command event notification will never be the same as a button click notification.
</para>
<para>
  Sometimes the action to take when a button is clicked and the action to take when a menu item is selected are the
  same. In these cases, it is a common practice in Windows programming to use the same resource ID for both the button
  and the menu item and then use the same event handler for both the button push and the menu item selection. To use
  this method in ooDialog, the programmer would need to only connect the event once.
</para>
<para>
  E.g., take the case of an OK push button and an Exit menu item. Many times the action to take for both is exactly the
  same. Here the ooDialog programmer would use the same resource ID for both the button and the menu item. OK buttons
  normally use the resource ID of <computeroutput>IDOK</computeroutput>, which the ooDialog framework <link
  linkend="sctStandardEventMethods">automatically</link> connects to the <link linkend="mthOk">OK</link> method. If the
  programmer also uses the IDOK id for the Exit menu item, then nothing else need be done. Whether the user selects the
  Exit menu item, or clicks the OK button, the same method in the Rexx dialog object will be invoked.
</para>
<para>
  Notice that, since a button click and a menu item selection generate the same notification, it is not possible to
  connect a menu item and a button click to separate methods if the they both have the same resource ID. However, in the
  event <link linkend="sctCodingEventHandlers">handling</link> method it is possible to tell whether the event
  originated from the user clicking a button or from selecting a menu item. The first argument to the method will be the
  resource ID of the button or menu item. The second argument will always be 0 if the user selected a menu item and
  non-zero if the user pushed a button. For button controls, the second argument is the window <link
  linkend="defHandle">handle</link> of the button.
</para>

</section>  <!-- End Section::Menu Command Events -->

<section id="sctMenuCommandEventConnections"><title>Menu Command Event Connections</title>
<indexterm><primary>menu object</primary><secondary>command event connections</secondary></indexterm>
<para>
  Menus are separate objects from dialog objects and can be instantiated with no reference to any dialog. In addition,
  menus can be assigned different owner dialogs during an application's life time. Because of this, unlike connecting
  dialog control envents, there are several different strategies that can be used when connecting menu command events.
</para>
<para>
  The menu classes provide a number of ways, and a number of methods, to connect menu command events to methods in the
  Rexx dialog. There are three basic types of ways to make command event connections, <emphasis role="italic">auto
  connection</emphasis>, <emphasis role="italic">connect request</emphasis>, and <emphasis role="italic">direct
  connection</emphasis>.
</para>

<variablelist>
  <varlistentry><term><emphasis role="bold">Auto Connection</emphasis></term>
  <listitem>
  <para>
    When auto connection is on, <emphasis role="italic">each</emphasis> time a menu bar is attached to a dialog, or a
    context menu is assigned to an owner dialog, every menu command item is automatically connected to a method in that
    dialog. The programmer can specify if every command item is connected to the same method, or if every command item
    is connect to a unique method. When every command item is connected to an unique method, ooDialog automatically
    generates the method name based on the text of the command item.
  </para>
  <para>
    Note that if auto connection is on, the automatic connection of menu items is <emphasis
    role="italic">always</emphasis> done when a menu bar is attached to a dialog or a context menu is assigned its
    owner dialog. This is true even if the <emphasis role="italic">connection request</emphasis> way of connecting
    command items is also in use.
  </para>
  <para>
    Auto connection can be explicitly turned on by using the <link
    linkend="mthSetAutoConnection">setAutoConnection</link> <emphasis role="italic">before</emphasis> a menu bar is
    attached, or a context menu is assigned, to a dialog. <emphasis role="italic">setAutoConnection</emphasis> can also
    be used to turn auto connection off at any time.
  </para>
  <para>
    The following is some specific details regarding auto connection for the different menu classes and menu class
    methods:
    <variablelist>
      <varlistentry><term><emphasis role="bold">BinaryMenuBar class</emphasis></term>
      <listitem>
      <para>
        Auto connection can also be turned on explicity in the <link linkend="mthNewClsBinaryMenuBar">new</link> method
        of the <computeroutput>BinaryMenuBar</computeroutput>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">insertItem method</emphasis></term>
      <listitem>
      <para>
        If auto connection is turned on in the menu bar that the item is inserted into, and the menu bar is already
        attached to a dialog, then the item will be automatically connected. The method name that is used for the
        connected method is based on the current auto connection status (<link linkend="mthGetAutoConnectStatus">get
        AutoConnectionStatus</link> can be used to determine the current auto connection status.)
      </para>
      <para>
        This will <emphasis role="italic">only</emphasis> be done if the item is being inserted by item identifier, not
        if it is being inserted by item position. It is only done if the item is being inserted into a menu bar, not if
        it is being inserted into a popup menu.
      </para>
      <para>
        <emphasis role="bold">Note</emphasis> that the arguments to the <link linkend="mthInsertItem">insertItem</link>
        method, the <emphasis role="italic">connect</emphasis> argument, can also be used to specify a <emphasis
        role="italic">connection request</emphasis> type of connection. If a connection request is made using the
        <emphasis role="italic">connect</emphasis> argument and auto connection is turned on, both connections will be
        made. This should <emphasis role="italic">not</emphasis> be done, the result is non-deterministic.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">PopupMenu class</emphasis></term>
      <listitem>
      <para>
        When a popup menu is used as a submenu of a menu bar, auto connection is meaningless. A submenu can not be
        attached or assigned to a dialog. When a popup menu is used as a context menu, auto connection can be turned on,
        either explicitly by using the <link linkend="mthSetAutoConnection">setAutoConnection</link> method, or by using
        the <emphasis role="italic">autoConnect</emphasis> option in the <link linkend="mthAssignTo">assignTo</link>
        method.
      </para>
      <para>
        Note that <emphasis role="italic">setAutoConnection</emphasis> has to be invoked on the top-level menu of the
        context menu. Invoking it on a submenu of the context menu would have no effect. When the <link
        linkend="mthTrack">track</link> or <link linkend="mthShowClsPopupMenu">show</link> methods are used with a
        popup menu, auto connection is ignored.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ScriptMenuBar class</emphasis></term>
      <listitem>
      <para>
        Auto connection can  be turned on explicitly using the <link
        linkend="mthSetAutoConnection">setAutoConnection</link> method <emphasis role="italic">after</emphasis> the
        <computeroutput>ScriptMenuBar</computeroutput> is instantiated, but <emphasis role="italic">before</emphasis> it
        is attached to a dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">UserMenuBar class</emphasis></term>
      <listitem>
      <para>
        Auto connection can be turned on in the <link linkend="mthNewClsUserMenuBar">new</link> method of the
        <computeroutput>UserMenuBar</computeroutput>.
      </para>
      <para>
        Auto connection can  be turned on explicitly using the <link
        linkend="mthSetAutoConnection">setAutoConnection</link> method <emphasis role="italic">after</emphasis> the
        <computeroutput>UserMenuBar</computeroutput> is instantiated, but <emphasis role="italic">before</emphasis> it
        is attached to a dialog.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Connection Request</emphasis></term>
  <listitem>
  <para>
    A <emphasis role="italic">connection request</emphasis> is made when a menu command item is to be connected to a
    specific method name in a dialog, before the menu bar has been attached to a dialog. Obviously it is impossible to
    connect the item to a dialog method, before it is known what dialog the menu bar is going to be connected to. All
    connection requests are fulfilled the <emphasis role="italic">first</emphasis> time the menu bar is connected to a
    dialog. The requests are then discarded.
  </para>
  <para>
    Connection requests are made by specifying a method to invoke when adding a command item to a
    <computeroutput>UserMenuBar</computeroutput> through the <link linkend="mthAddItem">addItem</link> method, or by
    specifying <computeroutput>.true</computeroutput> for the <emphasis role="italic">connect</emphasis> argument in the
    <link linkend="mthNewClsScriptMenuBar">new</link> method of the <computeroutput>ScriptMenuBar</computeroutput>. The
    request can also, possibly, be made by specifying a method to inovke when inserting a command item through the <link
    linkend="mthInsertItem">insertItem</link> method.
  </para>
  <para>
    The following is some specific details regarding connection requests for the different menu classes and menu class
    methods:
    <variablelist>
      <varlistentry><term><emphasis role="bold">BinaryMenuBar class</emphasis></term>
      <listitem>
      <para>
        Connection requests are not used in <computeroutput>BinaryMenuBar</computeroutput> class, except possibly though
        the <emphasis role="italic">insertItem</emphasis> method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">insertItem method</emphasis></term>
      <listitem>
      <para>
        A connection request can be made through the <link linkend="mthInsertItem">insertItem</link> method under these
        specific conditions.  The <emphasis role="italic">insertItem</emphasis> method is invoked on a menu bar, not
        using by position, and the menu bar is not currently attached to a dialog.  Then a connection request is made by
        using the last arguments to the method, the <emphasis role="italic">connect</emphasis> and possibly the
        <emphasis role="italic">mName</emphasis> methods. If the menu bar is already attached to a dialog, then those
        last two arguments connect the item immediately, which in this discussion is considered the <emphasis
        role="italic">direct connect</emphasis> type of making event connections.
      </para>
      <para>
        <emphasis role="bold">Note</emphasis> that if auto connection is turned and a connection request is made using
        the <emphasis role="italic">insertItem</emphasis> method, then both connections will be made. This should
        <emphasis role="italic">not</emphasis> be done, the result is non-deterministic.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">PopupMenu class</emphasis></term>
      <listitem>
      <para>
        Connection requests have no meaning in a popup menu, there is no such thing.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ScriptMenuBar class</emphasis></term>
      <listitem>
      <para>
        Connection requests are made by using the <emphasis role="italic">connnect</emphasis> argument in the <link
        linkend="mthNewClsScriptMenuBar">new</link> method of the class. If <emphasis role="italic">connect</emphasis>
        is true, then a connection request is made for each command item found in the resource script, using a method
        name constructed from the text of the command item.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">UserMenuBar class</emphasis></term>
      <listitem>
      <para>
        In a <computeroutput>UserMenuBar</computeroutput>, a connection request can be made in the <link
        linkend="mthAddItem">addItem</link> method by specifying a method name as the last argument, the <emphasis
        role="italic">mName</emphasis> argument.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    As can be seen from the discussion above. the connection request type of making connections is primarily meant to
    allow the programmer to automatically connect the menu items in a resourece script when the script is parsed
    (<computeroutput>ScriptMenuBar</computeroutput>), or when the <emphasis role="italic">addItem</emphasis> method is
    used (<computeroutput>UserMenuBar</computeroutput>.)
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Direct Connection</emphasis></term>
  <listitem>
  <para>
    The direct connection type of connecting command item events is an explicit, connect <emphasis
    role="italic">this</emphasis> command item to a method in <emphasis role="italic">this</emphasis> dialog. This is
    relatively simple to understand. Directly connecting menu command events is done through the following methods:
    <itemizedlist>
    <listitem>
    <para>
      <link linkend="mthConnectCommandEventCls">connectCommandEvent (Class method)</link>
    </para>
    </listitem>
    <listitem>
    <para>
      <link linkend="mthConnectAllCommandEvents">connectAllCommandEvents</link>
    </para>
    </listitem>
    <listitem>
    <para>
      <link linkend="mthConnectCommandEvent">connectCommandEvent (Instance method)</link>
    </para>
    </listitem>
    <listitem>
    <para>
      <link linkend="mthConnectSomeCommandEvents">connectSomeCommandEvents</link>
    </para>
    </listitem>
    </itemizedlist>
  </para>
  </listitem></varlistentry>
</variablelist>
<para>
  In general, only one type of making command event connections should be used in any one menu. Auto connection should
  never be used with the other two types of making connections. Mixing the 3 types of connecting command items to
  methods can result in unpredicatable results.
  <itemizedlist>
  <listitem>
  <para>
    The same command item can end up connected to different methods, which method is invoked is non-deterministic.
  </para>
  </listitem>
  <listitem>
  <para>
    Numerous entries in the dialog's message table for the same command item connected to the same method can happen.
  </para>
  </listitem>
  <listitem>
  <para>
    Both of the above can result in the message table becoming far larger than necessary.
  </para>
  </listitem>
  </itemizedlist>
</para>
<para>
  At first glance, making menu command event connections may seem a little complex. However, <emphasis role="bold">in
  practice</emphasis>, in ooDialog programs, it is relatively straight forward. The complexity only arises when multiple
  menus are used with multiple dialogs in a single application and the programmer <emphasis
  role="italic">chooses</emphasis> to mix the different types of making connections. <emphasis
  role="italic">Most</emphasis> ooDialog programs contain a single dialog with a single menu bar and / or a single
  context menu. If the programmer picks one type of making the menu item connection for her menu(s), things are really
  pretty simple:

<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar = .BinaryMenuBar~new("menuResourceEx.dll", IDR_MENU1, , self, .true, onMenuSelect)

]]>
</programlisting>

  The above creates a menu bar from a binary resource, attaches it to the dialog, and automatically connects all the
  menu items in the menu to the <emphasis role="italic">onMenuSelect</emphasis> method, in one step. Which is pretty
  simple.
</para>

</section>  <!-- End Section::Menu Command Event Connections -->

<section id="sctMenuCommandEventHandlers"><title>Menu Command Event Handlers</title>
<indexterm><primary>menu command event handlers</primary></indexterm>
<para>
  There are only two types of event handlers that the ooDialog programmer will need to code. Although similar, there are
  a few differences between the two. One <link linkend="sctSystemMenuCommandEventHandler">handler</link> is exclusively
  for menu command event notifications generated by the system menu. The other handler, described first, is for all
  other menu command event notifications.
</para>

<section id="sctMenuObjectCommandEventHandler"><title>Menu Object Command Event Handler</title>
<indexterm><primary>menu object</primary><secondary>command event handler</secondary></indexterm>
<para>
  Non-system menu command <link linkend="ovvEvents">event</link> notifications are actually the same notifications as
  the <link linkend="mthConnectButtonEvent">button</link> CLICK event. This makes the event handler for a menu command
  event pretty simple. The event handler is invoked when the user selects a menu command item. The programmer should
  return 0 from the event handler, however the interpreter does not <link linkend="sctCodingEventHandlers">wait</link>
  for the return.
</para>

<programlisting>
<![CDATA[
::method onMenuSelect unguarded
  use arg id, hMenu

  return 0
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The menu command event handling method receives 2 arguments:
  </para>
  <variablelist>
    <varlistentry><term>id</term>
    <listitem>
    <para>
      The numeric menu item identifier of the command item the user selected.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hMenu</term>
    <listitem>
    <para>
      The Windows <link linkend="defHandle">handle</link> to the menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    Return 0, although, since the interpreter does not wait for the reply, the value returned is ignored. However, it is
    good practice to always return a value from an event handler and 0 is the proper value for this notification.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Since the event handler for the menu command event is sent the ID of the menu item selected, there are two equally
    valid ways of coding the event handler. One way would be to connect all menu command items to one method. In that
    method check the menu item ID to determine which item the user selected and take the appropriate action. The other
    way would be to connect each menu item to its own method and ignore the arguments, simply take the action for that
    menu item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example connects the <emphasis role="italic">File Open</emphasis> menu item with a method and then
    opens a file when the user selects that menu item:

<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar~attachTo(self)
  ...
  menuBar~connectCommandEvent(IDM_OPEN, onFileOpen)
  ...

::method onFileOpen unguarded
  use arg id, hMenu

  self~openFile
  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End Section::Menu Object Command Event Handler -->

<section id="sctSystemMenuCommandEventHandler"><title>SystemMenu Command Event Handler</title>
<indexterm><primary>SystemMenu class</primary><secondary>command event handler</secondary></indexterm>
<para>
  System menu command <link linkend="ovvEvents">event</link> notifications are generated when the user clicks on a menu
  command item in the system menu. The interpreter <link linkend="sctCodingEventHandlers">waits</link> for the return
  from the Rexx method and the method must return either <computeroutput>.true</computeroutput> or
  <computeroutput>.false</computeroutput>.
</para>

<programlisting>
<![CDATA[
::method onMenuSelect unguarded
  use arg id, arg2

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The menu command event handling method receives 3 arguments:
  </para>
  <variablelist>
    <varlistentry><term>id</term>
    <listitem>
    <para>
      The identifier of the system menu command item the user selected. If this is one of the standard system menu
      command items, id will be a keyword identifying the item. The keywords correspond to the system menu command item
      <link linkend="sctSystemMenuConstantMethods">constants</link>, with the <emphasis role="italic">SC_</emphasis>
      removed. For example, if the menu item selected was the SC_CLOSE item, the keyword will be <emphasis
      role="italic">CLOSE</emphasis>. For non-standard system menu command items inserted into the menu by the
      application, <emphasis role="italic">id</emphasis> will be the numeric value of the item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>x</term>
    <listitem>
    <para>
      If the menu command item was selected using the mouse, <emphasis role="italic">x</emphasis> will be the horizontal
      position of the mouse cursor. When the user selects the item in some other manner, <emphasis
      role="italic">x</emphasis> will be 0.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>y</term>
    <listitem>
    <para>
      If the menu command item was selected using the mouse, <emphasis role="italic">y</emphasis> will be the vertical
      position of the mouse cursor. <emphasis role="italic">y</emphasis> will be â€“1 if the item was chosen using a
      system accelerator, or zero if chosen using a mnemonic.

    </para> </listitem></varlistentry>
  </variablelist> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    Return <computeroutput>.true</computeroutput> to indicate the system command was handled by the ooDialog program.
    Return <computeroutput>.false</computeroutput> to pass the command on to the operating system so that the default
    processing of the command item is done. For the standard system menu items, most Windows programs have the system
    process the selection. If the menu item selected was on inserted by the ooDialog application, then the event handler
    <emphasis role="italic">should</emphasis> return <computeroutput>.true</computeroutput>. Note that the Microsoft
    documentation says <emphasis role="italic">must</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example instantiates a <link linkend="SystemMenu">object</link> and uses it to insert an <emphasis
    role="italic">Edit</emphasis> menu into the system menu for the application. The new menu items are connected to
    appropriate event handlers. Note that the event handlers shown in the example are just stubs. Real code to handle
    the event would need to be added:

<programlisting>
<![CDATA[

::method initDialog
  expose sysMenu

  -- Get the system menu.
  sysMenu = .SystemMenu~new(self)

  -- Modify the system menu by inserting an "Edit" menu into it
  popup = .PopupMenu~new(IDM_EDIT_MENU)
  popup~insertItem(IDM_PASTE, IDM_PASTE, "Paste")
  popup~insertItem(IDM_PASTE, IDM_COPY, "Copy")
  popup~insertItem(IDM_PASTE, IDM_CUT, "Cut")

  sysMenu~insertPopup(SC_MOVE, IDM_EDIT_MENU, popup, "Edit")
  sysMenu~insertSeparator(SC_MOVE, IDM_SYS_SEP2)

  itemIDs = .set~of(IDM_COPY, IDM_CUT, IDM_PASTE)
  sysMenu~connectSomeCommandEvents(itemIDs)

  ...

::method copy
  use arg id, x, y

  say 'In SystemMenu->Edit->Copy, do a copy action id:' id 'x:' x 'y:' y
  return .true


::method cut
  use arg id, x, y

  say 'In SystemMenu->Edit->Cut, do a cut action id:' id 'x:' x 'y:' y
  return .true


::method paste
  use arg id, x, y

  say 'In SystemMenu->Edit->Paste, do a paste action id:' id 'x:' x 'y:' y
  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End Section::SystemMenu Command Event Handler -->

</section>  <!-- End Section::Menu Command Event Handlers -->

</section>  <!-- End Section::Menu Command Items -->


<section id="clsMenu"><title>The Menu Object</title>
<indexterm><primary>Menu class</primary></indexterm>
<indexterm><primary>The Menu Object</primary></indexterm>
<indexterm><primary>menu object</primary></indexterm>
<para>
  All the menu classes in ooDialog are similar. Menus have a large number of methods that are common to all types of
  menus. These common methods are contained in the <computeroutput>Menu</computeroutput> class, a mixin class inherited
  by all menu classes. This document treats the menu object in the same way it does the dialog <link
  linkend="chpDialogObject">object</link> and the dialog control <link linkend="chpDialogControlObject">object</link>,
  as an abstract concept. However, in this case the abstract menu object and the <computeroutput>Menu</computeroutput>
  mixin class are essentially the same.
</para>
<para>
  The methods listed in this chapter are all methods of the <computeroutput>Menu</computeroutput> class and all ooDialog
  menus have these methods.
</para>

<section id="sctMethodsMenuObject"><title>Method Table</title>
<para>
  The following table lists the class methods, attributes, and instance methods that all menus have in common:
<table id="tblMethodsMenuObject" frame="all"> <title>Menu Object Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1.80in">
<thead>
<row>
<entry>Menu Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="mthConnectCommandEventCls">connectCommandEvent</link></entry>
<entry>Connects a menu command event notification from a menu to a method in a Rexx dialog.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="atrHMenu">hMenu</link></entry>
<entry>The Windows handle of the menu.</entry>
</row>
<row>
<entry><link linkend="atrWID">wID</link></entry>
<entry>The resource ID of the menu.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="mthCheckClsMenu">check</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthcheckRadio">checkRadio</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthConnectAllCommandEvents">connectAllCommandEvents</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthConnectCommandEvent">connectCommandEvent</link></entry>
<entry>Connects a menu command event notification from a menu to a method in a Rexx dialog.</entry>
</row>
<row>
<entry><link linkend="mthConnectMenuEvent">connectMenuEvent</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthConnectSomeCommandEvents">connectSomeCommandEvents</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthDeletePopup">deletePopup</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthDestroyClsMenu">destroy</link></entry>
<entry>Releases the system resources used by the menu.</entry>
</row>
<row>
<entry><link linkend="mthDisableClsMenu">disable</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthEnableClsMenu">enable</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetAutoConnectStatus">getAutoConnectStatus</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetCountClsMenu">getCount</link></entry>
<entry>Returns the number of items in the menu.</entry>
</row>
<row>
<entry><link linkend="mthGetHandle">getHandle</link></entry>
<entry>Returns the value of the hMenu attribute of the menu.</entry>
</row>
<row>
<entry><link linkend="mthGetHelpID">getHelpID</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetIDClsMenu">getID</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetItemState">getItemState</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetMaxHeight">getMaxHeight</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetMenuHandle">getMenuHandle</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetPopup">getPopup</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetTextClsMenu">getText</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGetType">getType</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthGray">gray</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthHilite">hilite</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthInsertItem">insertItem</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthInsertPopup">insertPopup</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthInsertSeparator">insertSeparator</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsChecked">isChecked</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsCommandItem">isCommandItem</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsDisabled">isDisabled</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsEnabledClsMenu">isEnabled</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsGrayed">isGrayed</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsPopup">isPopup</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsSeparator">isSeparator</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsValidItemID">isValidItemID</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsValidMenu">isValidMenu</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthIsValidMenuHandle">isValidMenuHandle</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthItemTextToMethodName">itemTextToMethodName</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthReleaseMenuHandle">releaseMenuHandle</link></entry>
<entry>Converts the specified text to a method name as if it where the text of a menu command item.</entry>
</row>
<row>
<entry><link linkend="mthRemoveItem">removeItem</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthRemovePopup">removePopup</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthRemoveSeparator">removeSeparator</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthSetAutoConnection">setAutoConnection</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthSetHelpID">setHelpID</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthSetID">setID</link></entry>
<entry>Sets the resource ID of the menu.</entry>
</row>
<row>
<entry><link linkend="mthSetMaxHeight">setMaxHeight</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthSetTextClsMenu">setText</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthUncheckClsMenu">uncheck</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthUnhilite">unhilite</link></entry>
<entry>.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthConnectCommandEventCls"><title>connectCommandEvent (Class method)</title>
<indexterm><primary>connectCommandEvent</primary><secondary>menu object</secondary><tertiary>class method</tertiary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectCommandEvent</secondary><tertiary>class method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectCommandEvent(--id-,--methodName-,--dlg--)------------><

]]>
</programlisting>

<para>
  Connects a menu command item <link linkend="ovvEvents">event</link> notification with a method in the specified Rexx
  dialog. The notification is sent to the Windows dialog when a command item in a menu is selected by the user.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the menu item, may be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName [required]</term>
    <listitem>
    <para>
      The name of the method in the Rexx dialog to connect the notification to. This can not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The Rexx dialog to connect the notification to.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, <computeroutput>.false</computeroutput> on error. On
    error the <computeroutput>.systemErrorCode</computeroutput> will be set as described in the Details section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using the <emphasis role="italic">connectCommandEvent</emphasis> class method to connect menu command events,
    the programmer must use a menu item <link linkend="sctMenuItemIDs">identifier</link>, not a menu item <emphasis
    role="italic">position</emphasis> identifier.
  </para>
  <para>
    The <emphasis role="italic">connectCommandEvent</emphasis> class method is used for all types of menus. However, the
    programmer should be aware of the differences in coding event <link
    linkend="sctMenuCommandEventHandlers">handlers</link> for <link linkend="clsSystemMenu">SystemMenus</link> and other
    types of menus.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_PARAMETER (87)</emphasis></term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">methodName</emphasis> argument can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example disables the ability of the user to move the position of the dialog at certain times. It does this by
    connecting the system menu's move command event to a method in the Rexx dialog. In the event handler, if the
    position of the dialog is <emphasis role="italic">frozen</emphasis>, then the method returns
    <computeroutput>.true</computeroutput> indicating that the event has been handled by the application.  The operating
    system then takes no further action and the dialog can not be moved by the user.
  </para>
  <para>
    The example is complete and can be copy-pasted into a program file and executed as:

<programlisting>
<![CDATA[

  dlg = .FreezePositionDlg~new
  dlg~execute('ShowTop')

::requires 'ooDialog.cls'

::class 'FreezePositionDlg' subclass Userdialog

::method init
  forward class (super) continue
  self~createCenter(180, 100, 'A Freezable Dialog')

::method defineDialog
  expose isFrozen

  self~createPushButton(100,  30, 65, 55, 15, , "Take Action",   onStartAction)
  self~createPushButton(101, 100, 65, 55, 15, , "Cancel Action", onCancelAction)

  .SystemMenu~connectCommandEvent(.SystemMenu~SC_MOVE, onSCMove, self)
  isFrozen = .false

::method onSCMove unguarded
  expose isFrozen
  use arg id, x, y

  if isFrozen then return .true
  else return .false

::method onStartAction unguarded
  expose isFrozen
  isFrozen = .true

::method onCancelAction unguarded
  expose isFrozen
  isFrozen = .false

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::connectCommandEvent() -->

<section id="atrHMenu"><title>hMenu (Attribute)</title>
<indexterm><primary>hMenu</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>hMenu</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hMenu--------------------------------------------><

]]>
</programlisting>

<para>
  The Windows <link linkend="defHandle">handle</link> of the menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">hMenu get:</emphasis></term>
  <listitem>
  <para>
    The returned handle, if it is not null, can be used in any ooDialog method that takes a menu handle as an argument.
    The <link linkend="mthGetHandle">getMenuHandle</link>() also returns the value of this attribute.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">hMenu set:</emphasis></term>
  <listitem>
  <para>
    This is a <emphasis role="italic">get</emphasis> only attribute. The programmer can not set the attribute through
    assignment. I.e.,
<programlisting>
<![CDATA[
  menuObj~hMenu = handle
]]>
</programlisting>
    is not valid.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If a menu is released through the <link linkend="mthDestroyClsMenu">destroy</link>() method, the menu handle will
    then be null and is no longer valid. The menu handle is a Rexx <computeroutput>Pointer</computeroutput> object and
    therefore has the methods of that class. Specifically it has the <emphasis role="italic">isNull</emphasis>() method,
    which can be used to test if the handle is still valid.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::hMenu() [attribute]  -->

<section id="atrWID"><title>wID (Attribute)</title>
<indexterm><primary>wID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>wID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--wID----------------------------------------------><

]]>
</programlisting>

<para>
  The resource ID of this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">wID get:</emphasis></term>
  <listitem>
  <para>
    The resource ID may be -1 if the ID was not set when the menu was created.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">wID set:</emphasis></term>
  <listitem>
  <para>
    This is a <emphasis role="italic">get</emphasis> only attribute. The programmer can not set the attribute through
    assignment. I.e.,
<programlisting>
<![CDATA[
  menuObj~wID = 110
]]>
</programlisting>
    is not valid.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Although the programmer can not set the <emphasis role="italic">wID</emphasis> attribute directly, it can be set
    when menu is instantiated, for instance see the <computeroutput>BinaryMenuBar</computeroutput> <link
    linkend="mthNewClsBinaryMenuBar">new</link> method or the <computeroutput>PopupMenu</computeroutput> <link
    linkend="mthNewClsPopupMenu">new</link> method. In addition, the <link linkend="mthSetID">setID</link> method can be
    used to set or change the ID of a <emphasis role="italic">submenu</emphasis>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::wID() [attribute]  -->


<section id="mthCheckClsMenu"><title>check</title>
<indexterm><primary>check</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>check</secondary></indexterm>
<programlisting>
<![CDATA[
>>--check(--+--------+--)---------------------------------------------><
            +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::check() -->

<section id="mthCheckRadio"><title>checkRadio</title>
<indexterm><primary>checkRadio</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>checkRadio</secondary></indexterm>
<programlisting>
<![CDATA[
>>--checkRadio(--+--------+--)---------------------------------------------><
                 +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::checkRadio() -->

<section id="mthConnectAllCommandEvents"><title>connectAllCommandEvents</title>
<indexterm><primary>connectAllCommandEvents</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectAllCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectAllCommandEvents(--+-------+--+-------+--)-----------><
                              +--mth--+  +-,-dlg-+
]]>
</programlisting>

<para>
  Connects every command item in the menu to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object.  The default is to connect the command
      items to the owner dialog of this menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog <link
        linkend="chpDialogObject">dialog</link> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects every menu command item in the menu to the <emphasis role="italic">onMenuSelect</emphasis>
    method in the dialog:
<programlisting>
<![CDATA[

::method connectMenu unguarded private
  use strict arg menu

  if \ menu~connectAllCommandEvents(onMenuSelect) then self~error('Connect All Items Failed')

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::connectAllCommandEvents() -->

<section id="mthConnectCommandEvent"><title>connectCommandEvent</title>
<indexterm><primary>connectCommandEvent</primary><secondary>menu object</secondary><tertiary>instance method</tertiary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectCommandEvent</secondary><tertiary>instance method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectCommandEvent(--id--,--methodName--+--------+--)---------------------><
                                             +-,-dlg--+
]]>
</programlisting>

<para>
  Connects a menu command item <link linkend="ovvEvents">event</link> notification with a method in a Rexx dialog. The
  notification is sent to the Windows dialog when a command item in a menu is selected by the user.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the menu item, may be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>methodName [required]</term>
      <listitem>
      <para>
        The name of the method in the Rexx dialog to connect the notification to. This can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>dlg [optional]</term>
      <listitem>
      <para>
        A Rexx dialog to connect the notification to. By default, the notification is is connected to the Rexx dialog that
        the menu is <link linkend="mthAttachTo">attached</link> or <link linkend="mthAssignTo">assinged</link> to. If
        omitted and there is no assigned or attached dialog, no connection is made and the <link
        linkend="dotSystemErrorCode">.systemErrorCode</link> is set as described in the Details section. (To connect a
        menu item command event, there must be a dialog to connect it to.)
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, otherwise <computeroutput>.false</computeroutput>. If
    there is an error, the <computeroutput>.systemErrorCode</computeroutput> is set as described in the Details section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using the <emphasis role="italic">connectCommandEvent</emphasis> method to connect menu command events, the
    programmer must use a menu item <link linkend="sctMenuItemIDs">identifier</link>, not a menu item <emphasis
    role="italic">position</emphasis> identifier.
  </para>
  <para>
    The <emphasis role="italic">connectCommandEvent</emphasis> method is used for all types of menus. However, the
    programmer should be aware of the differences in coding event <link
    linkend="sctMenuCommandEventHandlers">handlers</link> for <link linkend="clsSystemMenu">SystemMenus</link> and other
    types of menus.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_PARAMETER (87)</emphasis></term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">methodName</emphasis> argument can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example example connects the <emphasis role="italic">Open</emphasis> menu item in the <emphasis
    role="italic">File</emphasis> submenu of the menu bar to the <emphasis role="italic">onFileOpen</emphasis> method in
    the dialog. Then the <emphasis role="italic">Close</emphasis>, <emphasis role="italic">Save</emphasis>, etc., menu
    items are connected. Since the menu bar has already been attached to the dialog, the third optional argument to
    <emphasis role="italic">connectCommandEvent</emphasis> is left out:
<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar~attachTo(self)

  menuBar~connectCommandEvent(IDM_OPEN, onFileOpen)
  menuBar~connectCommandEvent(IDM_CLOSE, onFileClose)
  menuBar~connectCommandEvent(IDM_SAVE, onFileSave)
  menuBar~connectCommandEvent(IDM_SAVEAS, onFileSaveAs)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::connectCommandEvent() -->

<section id="mthConnectMenuEvent"><title>connectMenuEvent</title>
<indexterm><primary>connectMenuEvent</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectMenuEvent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectMenuEvent(--+--------+--)---------------------------------------------><
                       +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::connectMenuEvent() -->

<section id="mthConnectSomeCommandEvents"><title>connectSomeCommandEvents</title>
<indexterm><primary>connectSomeCommandEvents</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectSomeCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectSomeCommandEvents(--ids-+-------+-+--------------+-+-------+--)-----><
                                   +-,-mth-+ +-,-byPosition-+ +-,-dlg-+
]]>
</programlisting>

<para>
  Connects a collection of menu command items to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>ids [required]</term>
    <listitem>
    <para>
      A <computeroutput>Collection</computeroutput> object containing the menu item <link
      linkend="sctMenuItemIDs">IDs</link> to connect.  The IDs can be by position IDs or resource IDs,
      depending on the value of the <emphasis role="italic">byPosition</emphasis> argument. However, they must be all
      the same type, all resource IDs or all by position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the IDS are by positional IDs, otherwise the are resource IDs. The default is false, they are resource
      IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object. The default is to connect the command items to
      the owner dialog of this menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">ids</emphasis> argument can be any ooRexx collection with a <emphasis
    role="italic">makeArray</emphasis> method that returns an array whose <emphasis role="italic">items</emphasis> are
    the menu item IDs to connnect.
  </para>
  <para>
    This method quits when an error is detected. This implies that on an error return some menu items may have been
    connected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_PARAMETER (87)</term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> One or more of the specified item IDs is
        not a menu command item.  Or the msg argument was used, but it is the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog <link
        linkend="chpDialogObject">dialog</link> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects four menu command items in the menu bar, by their sybmolic IDs, to 4 methods in the dialog.
    The method names will be constructed from the text of the menu item:
<programlisting>
<![CDATA[

::method enuConnectItems
  expose menuBar
  use strict arg

  ids = .array~of(IDM_EDIT_COPY, IDM_EDIT_PASTE, IDM_EDIT_CUT, IDM_EDIT_DELETE)

  if \ menuBar~connectSomeCommandEvents(ids) then self~error('Connect Some Menu Items Failed')


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::connectSomeCommandEvents() -->

<section id="mthDeletePopup"><title>deletePopup</title>
<indexterm><primary>deletePopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>deletePopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deletePopup(--+--------+--)---------------------------------------------><
                  +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::deletePopup() -->

<section id="mthDestroyClsMenu"><title>destroy</title>
<indexterm><primary>destroy</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>destroy</secondary></indexterm>
<programlisting>
<![CDATA[
>>--destroy(--+--------+--)---------------------------------------------><
              +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::destroy() -->

<section id="mthDisableClsMenu"><title>disable</title>
<indexterm><primary>disable</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>disable</secondary></indexterm>
<programlisting>
<![CDATA[
>>--disable(--+--------+--)---------------------------------------------><
              +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::disable() -->

<section id="mthEnableClsMenu"><title>enable</title>
<indexterm><primary>enable</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>enable</secondary></indexterm>
<programlisting>
<![CDATA[
>>--enable(--+--------+--)---------------------------------------------><
             +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::enable() -->

<section id="mthGetAutoConnectStatus"><title>getAutoConnectStatus</title>
<indexterm><primary>getAutoConnectStatus</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getAutoConnectStatus</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getAutoConnectStatus(--+--------+--)---------------------------------------------><
                           +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getAutoConnectStatus() -->

<section id="mthGetCountClsMenu"><title>getCount</title>
<indexterm><primary>getCount</primary><secondary>Menu class</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>getCount</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCount-----------------------------------------><

]]>
</programlisting>

<para>
  Determines the number of menu items in this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The number of menu items in the menu, or -1 on error.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The number of items in a menu will include the separator and submenu items, but not the count of items in the
    submeneus. In other words, it is not a recursive count, just a count of the single menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
<programlisting>
<![CDATA[
  count = menuObj~count
  if count \== -1 then do
    say 'The menu has' count 'items.'
  end
  else do
    say 'Error getting count of menu items:'
    say '  Error Code:' .systemErrorCode SysGetErrortext(.systemErrorCode)
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetHandle"><title>getHandle</title>
<indexterm><primary>getHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getHandle----------------------------------------><

]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::getHandle() -->

<section id="mthGetHelpID"><title>getHelpID</title>
<indexterm><primary>getHelpID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getHelpID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getHelpID(--+--------+--)---------------------------------------------><
                +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getHelpID() -->

<section id="mthGetIDClsMenu"><title>getID</title>
<indexterm><primary>getID</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>getID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getID(--+--------+--)---------------------------------------------><
            +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getID() -->

<section id="mthGetItemState"><title>getItemState</title>
<indexterm><primary>getItemState</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getItemState</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemState(--+--------+--)---------------------------------------------><
                   +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getItemState() -->

<section id="mthGetMaxHeight"><title>getMaxHeight</title>
<indexterm><primary>getMaxHeight</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getMaxHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMaxHeight(--+--------+--)---------------------------------------------><
                   +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getMaxHeight() -->

<section id="mthGetMenuHandle"><title>getMenuHandle</title>
<indexterm><primary>getMenuHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getMenuHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMenuHandle(--+--------+--)---------------------------------------------><
                    +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getMenuHandle() -->

<section id="mthGetPopup"><title>getPopup</title>
<indexterm><primary>getPopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getPopup(--+--------+--)---------------------------------------------><
               +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getPopup() -->

<section id="mthGetTextClsMenu"><title>getText</title>
<indexterm><primary>getText</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>getText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getText(--+--------+--)---------------------------------------------><
              +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getText() -->

<section id="mthGetType"><title>getType</title>
<indexterm><primary>getType</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getType</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getType(--+--------+--)---------------------------------------------><
              +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getType() -->

<section id="mthGray"><title>gray</title>
<indexterm><primary>gray</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>gray</secondary></indexterm>
<programlisting>
<![CDATA[
>>--gray(--+--------+--)---------------------------------------------><
           +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::gray() -->

<section id="mthHilite"><title>hilite</title>
<indexterm><primary>hilite</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>hilite</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hilite(--+--------+--)---------------------------------------------><
             +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::hilite() -->

<section id="mthIsChecked"><title>isChecked</title>
<indexterm><primary>isChecked</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isChecked</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isChecked----------------------------------------><
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isChecked() -->

<section id="mthIsCommandItem"><title>isCommandItem</title>
<indexterm><primary>isCommandItem</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isCommandItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isCommandItem(--+--------+--)---------------------------------------------><
                    +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isCommandItem() -->

<section id="mthIsDisabled"><title>isDisabled</title>
<indexterm><primary>isDisabled</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isDisabled</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isDisabled(--+--------+--)---------------------------------------------><
                 +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isDisabled() -->

<section id="mthIsEnabledClsMenu"><title>isEnabled</title>
<indexterm><primary>isEnabled</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>isEnabled</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isEnabled(--+--------+--)---------------------------------------------><
                +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isEnabled() -->

<section id="mthIsGrayed"><title>isGrayed</title>
<indexterm><primary>isGrayed</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isGrayed</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isGrayed(--+--------+--)---------------------------------------------><
               +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isGrayed() -->

<section id="mthIsPopup"><title>isPopup</title>
<indexterm><primary>isPopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isPopup(--id--+---------------+--)-----------><
                  +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is a submenu (a pop up menu.)
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <link linkend="sctMenuItemIDs">ID</link> of the menu item to be queried. This can be a position ID or a
      resource ID, depending on the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if the menu item is a pop up menu item, otherwise
    <computeroutput>.false</computeroutput> .
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A syntax condition is raised if <emphasis role="italic">id</emphasis> is not a valid menu item id. The <link
    linkend="mthIsValidItemID">isValidItemID</link> method can be used to check if the item id is valid prior to
    invoking this method, or the condition could be trapped.  If the condition is trapped or if isValidItemID() returns
    false, <link linkend="dotSystemErrorCode">.systemErrorCode</link> can then be examined for the reason why the item
    ID is not valid.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
    </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isPopup() -->

<section id="mthIsSeparator"><title>isSeparator</title>
<indexterm><primary>isSeparator</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isSeparator(--+--------+--)---------------------------------------------><
                  +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isSeparator() -->

<section id="mthIsValidItemID"><title>isValidItemID</title>
<indexterm><primary>isValidItemID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isValidItemID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isValidItemID(--id--+---------------+--)---------><
                        +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if a specific menu item <link linkend="sctMenuItemIDs">ID</link> is valid for this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The menu item ID to check.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If the item ID is a resource ID or a positional ID. The default is false, a resource ID. Use true if the ID is a
      positional ID.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True if the id is valid for the menu, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isValidItemID() -->

<section id="mthIsValidMenu"><title>isValidMenu</title>
<indexterm><primary>isValidMenu</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isValidMenu</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isValidMenu--------------------------------------><

]]>
</programlisting>

<para>
  Checks if the menu is valid. The menu would not be valid if it has been <link
  linkend="mthDestroyClsMenu">destroyed</link> or <link linkend="mthReleaseMenuHandle">released</link>. In addition, the
  menu could no longer be valid for some operating system reason, although this is highly unlikely.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu is valid, otherwise false.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::isValidMenu() -->

<section id="mthIsValidMenuHandle"><title>isValidMenuHandle</title>
<indexterm><primary>isValidMenuHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isValidMenuHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isValidMenuHandle(--handle--)--------------------><

]]>
</programlisting>

<para>
  Given a handle, determines if the handle is a menu handle and, if it is, if the menu is still valid.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>handle</term>
    <listitem>
    <para>
      The handle to check if it is a valid menu handle.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True if <emphasis role="italic">handle</emphasis> is the handle of a valid menu, otherwise false.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isValidMenuHandle() -->

<section id="mthInsertItem"><title>insertItem</title>
<indexterm><primary>insertItem</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>insertItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertItem(--+--------+--)---------------------------------------------><
                 +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::insertItem() -->

<section id="mthInsertPopup"><title>insertPopup</title>
<indexterm><primary>insertPopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>insertPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertPopup(--+--------+--)---------------------------------------------><
                  +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::insertPopup() -->

<section id="mthInsertSeparator"><title>insertSeparator</title>
<indexterm><primary>insertSeparator</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>insertSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertSeparator(--+--------+--)---------------------------------------------><
                      +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::insertSeparator() -->

<section id="mthItemTextToMethodName"><title>itemTextToMethodName</title>
<indexterm><primary>itemTextToMethodName</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>itemTextToMethodName</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemTextToMethodName(--text--)---------------><

]]>
</programlisting>

<para>
  Converts <emphasis role="italic">text</emphasis> to a method name as if <emphasis role="italic">text</emphasis> were
  the text of a menu command item. This method can be used as a debugging helper if the programmer has difficulty in
  determining what method name the ooDialog framework is constructing when automatically <link
  linkend="sctMenuCommandEventConnections">connecting</link> menu command items.
</para>
<para>
  The ooDialog framework constructs a method name from a string in this way: All space, tab, ampersand, colon, and plus
  characters are removed from the string. In addition any trailing periods are remove from the string. The remaining
  string is used as the method name.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text string to be converted to a method name. This can not be the empty string.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The method name the ooDialog framework would construct from <emphasis role="italic">text</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In the menu classes there are a number of methods that connect menu command <link
    linkend="sctMenuCommandEvents">events</link> to a method in the Rexx dialog. Most of these methods will
    automatically construct the connected method name if the programmer does not specify a method name. The name is
    constructed based on the text of the menu command item that is being connected.
  </para>
  <para>
    Sometimes, it may be difficult for the programmer to know what the constructed name is going to be. For instance,
    with a compiled binary menu, the programmer might need to look at the original resource script. Or, the programmer
    may not recall exactly what the rules are for constructing the name. This method can help in those situations by
    returning the method name that would be constructed. The programmer could add some quick debug code that printed the
    name to the screen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a debugging method that could be temporarily added to a dialog with a menu to determine what
    method name would be constructed for any menu command item:
<programlisting>
<![CDATA[

  ::method printMethodName private
    use strict arg menu, itemID

    text = menu~getText(itemID)
    name = menu~itemTextToMethodName(text)

    say 'The constructed method name for this menu item:'
    say '  Item ID:  ' itemID
    say '  Item Text:' text
    say '  Method:   ' name
    say

  return name

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::itemTextToMethodName() -->

<section id="mthReleaseMenuHandle"><title>releaseMenuHandle</title>
<indexterm><primary>releaseMenuHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>releaseMenuHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--releaseMenuHandle(--handle--)---------------------------------------------><

]]>
</programlisting>

<para>
  Releases (frees) the operating system resources used by a menu. The menu is specified by its Windows <link
  linkend="defHandle">handle</link>. To release the operating system resources for an ooDialog
  <computeroutput>Menu</computeroutput> object, use the <link linkend="mthDestroyClsMenu">destroy</link>() method.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>handle [required]</term>
    <listitem>
    <para>
      The handle of the menu to release. The handle must not be null.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true for success, false for failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::releaseMenuHandle() -->

<section id="mthRemoveItem"><title>removeItem</title>
<indexterm><primary>removeItem</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>removeItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removeItem(--+--------+--)---------------------------------------------><
                 +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::removeItem() -->

<section id="mthRemovePopup"><title>removePopup</title>
<indexterm><primary>removePopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>removePopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removePopup(--+--------+--)---------------------------------------------><
                  +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::removePopup() -->

<section id="mthRemoveSeparator"><title>removeSeparator</title>
<indexterm><primary>removeSeparator</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>removeSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removeSeparator(--+--------+--)---------------------------------------------><
                      +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::removeSeparator() -->

<section id="mthSetAutoConnection"><title>setAutoConnection</title>
<indexterm><primary>setAutoConnection</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setAutoConnection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setAutoConnection(--+--------+--)---------------------------------------------><
                        +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setAutoConnection() -->

<section id="mthSetHelpID"><title>setHelpID</title>
<indexterm><primary>setHelpID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setHelpID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setHelpID(--+--------+--)---------------------------------------------><
                +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setHelpID() -->

<section id="mthSetID"><title>setID</title>
<indexterm><primary>setID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setID(--+--------+--)----------------------------><
            +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::setID() -->

<section id="mthSetMaxHeight"><title>setMaxHeight</title>
<indexterm><primary>setMaxHeight</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setMaxHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setMaxHeight(--+--------+--)---------------------------------------------><
                   +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setMaxHeight() -->

<section id="mthSetTextClsMenu"><title>setText</title>
<indexterm><primary>setText</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>setText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setText(--+--------+--)---------------------------------------------><
              +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setText() -->

<section id="mthUncheckClsMenu"><title>uncheck</title>
<indexterm><primary>uncheck</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>uncheck</secondary></indexterm>
<programlisting>
<![CDATA[
>>--uncheck(--+--------+--)---------------------------------------------><
              +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::uncheck() -->

<section id="mthUnhilite"><title>unhilite</title>
<indexterm><primary>unhilite</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>unhilite</secondary></indexterm>
<programlisting>
<![CDATA[
>>--unhilite(--+--------+--)---------------------------------------------><
               +--type--+
]]>
</programlisting>

<para>
  xx
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    xx
  <variablelist>
    <varlistentry><term>TERM</term>
    <listitem>
    <para>
      xx
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::unhilite() -->

</section>  <!-- End Menu class -->


<section id="clsMenuBar"><title>The Menu Bar Object</title>
<indexterm><primary>MenuBar class</primary></indexterm>
<indexterm><primary>The MenuBar Object</primary></indexterm>
<indexterm><primary>menu bar object</primary></indexterm>
<para>
  A menu bar is often called the top-level menu. It is the bar poisitioned just below the title bar of an application
  window or a dialog. The menu bar object is used, like the <link linkend="clsMenu">menu</link>, <link
  linkend="chpDialogObject">dialog</link>, and dialog <link linkend="chpDialogControlObject">control</link> objects as an
  abstract concept to document the ooDialog menu objects that represent menu bars. The menu bar classes in ooDialog are
  the <link linkend="clsBinaryMenuBar">BinaryMenuBar</link>, <link linkend="clsUserMenuBar">UserMenuBar</link>, and
  <link linkend="clsScriptMenuBar">ScriptMenuBar</link> classes.
</para>
<para>
  The menu bar object is implemented through the <computeroutput>MenuBar</computeroutput> mixin classs and all menu bars
  have the methods of the <computeroutput>MenuBar</computeroutput> class. Similar to the the menu object, the menu bar
  object is essentially the <computeroutput>MenuBar</computeroutput> mixin class. Note that menu bars <emphasis
  role="italic">are</emphasis> menus. All menu bar objects have all the methods of the <link
  linkend="clsMenu">menu</link> object in addition to the methods specific to the menu bar.
</para>

<section id="sctMethodsMenuBar"><title>Method Table</title>
<para>
  The following table lists the instance methods of the menu bar object.
<table id="tblMethodsMenuBar" frame="all"> <title>MenuBar Object Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="mthAttachTo">attachTo</link></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><link linkend="mthDetach">detach</link></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><link linkend="mthIsAttached">isAttached</link></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><link linkend="mthRedrawClsMenu">redraw</link></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><link linkend="mthReplace">replace</link></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthAttachTo"><title>attachTo</title>
<indexterm><primary>attachTo</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>attachTo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--attachTo(--dlg--)--------------------------------><

]]>
</programlisting>

<para>
  Attaches this menu bar to the specified dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>The only argument is:
  <variablelist>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The Rexx dialog the menu bar is to be attached to.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      True on success, false for failure.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If <link linkend="sctMenuCommandEventConnections">auto</link> connection is turned on (<link
    linkend="mthGetAutoConnectStatus">getAutoConnectStatus</link>) then all menu command items are connected to a
    method in the <emphasis role="italic">dlg</emphasis> dialog at this time.
  </para>
  <para>
    A menu bar can only be attached to a dialog after the <link linkend="ovvUnderlying">underlying</link> dialog exists.
    A menu bar can only be attached to one dialog, and a dialog can only have one menu bar attached to it. If any of
    these conditions are not met, this method fails.
  </para>
  <para>
    If this menu bar is already attached to a dialog and needs to be attached to a differnt dialog, first use the <link
    linkend="mthDetach">detach</link> method to detach it. Then attach it to the other dialog. On the other hand, if the
    dialog already has a menu bar attached to it and this menu bar needs to be attached to that dialog get a reference
    to the dialog's current menu bar and use the <link linkend="mthReplace">replace</link> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu is already attached to a dlg.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> Some menu
        items were not connected because the message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_HANDLE (1400)</term>
      <listitem>
      <para>
        Invalid window handle. <emphasis role="bold">Meaning:</emphasis> The underlying Windows dialog does not exist
        for the specified <emphasis role="italic">dlg</emphasis> argument.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis>  This menu has been destroyed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a dialog object.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_STYLE (2002)</term>
      <listitem>
      <para>
        The window style or class attribute is invalid for this operation. <emphasis role="bold">Meaning:</emphasis>
        The <emphasis role="italic">dlg</emphasis> argument is already attached to a menu bar.
      </para>
      <para>
        When this method returns false, the menu is not attached to a dialog, except in one circumstance. If the
        <computeroutput>.systemErrorCode</computeroutput> is ERROR_NOT_ENOUGH_MEMORY, then the menu is attached to the
        dialog, but some menu items were not connected.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example attaches a dialog's menu bar in the <emphasis role="italic">initDialog</emphasis> method. In the
    example, the menu bar was instantiated previously, and saved in an instance variable:
<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar~attachTo(self)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MenuBar::attachTo() -->

<section id="mthDetach"><title>detach</title>
<indexterm><primary>detach</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>detach</secondary></indexterm>
<programlisting>
<![CDATA[
>>--detach---------------------------------------><

]]>
</programlisting>

<para>
  Detaches this menu bar from its assigned dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu bar is not attached to a dialog.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example detaches the menu bar from the dialog and destroys it as it is no longer needed in the application:
<programlisting>
<![CDATA[

  ...
  menuBar~detach
  menuBar~destroy
  ...
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu bar object::detach() -->

<section id="mthIsAttached"><title>isAttached</title>
<indexterm><primary>isAttached</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>isAttached</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isAttached-----------------------------------><

]]>
</programlisting>

<para>
  Determines if this menu bar is currently attached to a dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if this menu bar is attached to a dialog, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable. There are no errors that could changes
    the value from 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu  bar object::isAttached() -->

<section id="mthRedrawClsMenu"><title>redraw</title>
<indexterm><primary>redraw</primary><secondary>menu bar object</secondary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>redraw</secondary></indexterm>
<programlisting>
<![CDATA[
>>--redraw---------------------------------------><

]]>
</programlisting>

<para>
  Tells the dialog this menu bar is attached to, to redraw the menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu bar is not attached to a dialog.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu bar object::redraw() -->

<section id="mthReplace"><title>replace</title>
<indexterm><primary>replace</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>replace</secondary></indexterm>
<programlisting>
<![CDATA[
>>--replace(--newMenuBar--)----------------------><

]]>
</programlisting>

<para>
  If this menu bar is attached to a dialog, the menu bar for the dialog is replaced by the specified menu bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>newMenuBar [required]</term>
    <listitem>
    <para>
      The new menu bar for the dialog this menu bar is attached to.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the menu bar that was previously attached to the dialog, which of course is this menu bar. On
    error the <computeroutput>.Nil</computeroutput> object is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on error. In addition to error codes set by the
    operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu bar is not attached to a dialog.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from a program that uses 2 completely different menu bars depending on if the application is in
    edit or view mode. When the mode is switched, the menu bar is replaced by the appropriate one for the mode:
<programlisting>
<![CDATA[

::method onToggleMode
  expose fileMenu viewMenu currentMode

  if currentMode == 'Edit' then do
    fileMenu~replace(viewMenu)
    currentMode = 'View'
  end
  else do
    viewMenu~replace(fileMenu)
    currentMode = 'Edit'
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu bar Object::replace() -->

</section>  <!-- End MenuBar class -->


<section id="clsBinaryMenuBar"><title>BinaryMenuBar Class</title>
<indexterm><primary>BinaryMenuBar class</primary></indexterm>
<para>
  A <computeroutput>BinaryMenuBar</computeroutput> is a menu <link linkend="clsMenuBar">bar</link> whose menu template
  comes from a compiled binary resource, or whose menu template is constructed as an empty menu.
</para>
<para>
  The ooDialog framework provides three basic types of menu bars. The only difference in the three types is the source
  of the menu template for the menu bar. In a <link linkend="clsScriptMenuBar">ScriptMenuBar</link> the source of the
  menu template is a <link linkend="defResourceScript">resource</link> file (usually a .rc file) that ooDialog parses
  and uses to construct the menu template. For an <link linkend="clsUserMenuBar">UserMenuBar</link>, ooDialog constructs
  the menu template dynamically from method invocations in the program code.
</para>
<para>
  In general it is much easier to dynamically construct the menu template by starting with an empty
  <computeroutput>BinaryMenuBar</computeroutput> and inserting the desired menu items than it is to define the menu
  template in an <computeroutput>UserMenuBar</computeroutput>.
</para>

<section id="sctMethodsBinaryMenuBar"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>BinaryMenuBar</computeroutput>. For
  convenience, the inherited methods from the <link linkend="clsMenuBar">MenuBar</link> mixin class are also listed
  here. Note that the <computeroutput>BinaryMenuBar</computeroutput> <emphasis role="italic">is</emphasis> a menu and
  therefore also contains all the methods of the <link linkend="clsMenu">Menu</link> class.
<table id="tblMethodsBinaryMenuBar" frame="all"> <title>Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="mthNewClsBinaryMenuBar">new (Class)</link></entry>
<entry>Instantiates a new binary menu bar object.</entry>
</row>
<row>
<entry><link linkend="mthAttachTo">attachTo</link></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><link linkend="mthDetach">detach</link></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><link linkend="mthIsAttached">isAttached</link></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><link linkend="mthRedrawClsMenu">redraw</link></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><link linkend="mthReplace">replace</link></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="mthNewClsBinaryMenuBar"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>BinaryMenuBar class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(-+----------+-+------+-+-------+-+------------+-+--------+-+---------+-)--><
         +--menuSrc-+ +-,-id-+ +-,-hID-+ +-,-attachTo-+ +-,-auto-+ +-,-mName-+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>BinaryMenuBar</computeroutput> object.
</para>
<para>
  The new menu bar is initiallly empty if <emphasis role="italic">menuSrc</emphasis> is omitted. If <emphasis
  role="italic">menuSrc</emphasis> is not omitted, the menu template is obtained from the compiled binary resource
  pointed to by <emphasis role="italic">menuSrc</emphasis>.
</para>
<para>
  When an empty menu bar is instantiated, the programmer can add to the menu dynamically using menu object methods such
  as <link linkend="mthInsertPopup">insertPopup</link>, <link linkend="mthInsertItem">insertItem</link>, etc..
  Dynamically constructing a menu in this way is much less error prone than using the <link
  linkend="clsUserMenuBar">UserMenuBar</link> class.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>menuSrc [optional]</term>
    <listitem>
    <para>
      The source of the menu template.  If this argument is omitted an empty menu template is constructed in memory.
      When not omitted, the argument can be one of the following objects:
    </para>
    <variablelist>
      <varlistentry><term><emphasis role="bold">.nil:</emphasis></term>
      <listitem>
      <para>
        Constructs an empty menu template in memory. This is identical to omitting the arugment altogether.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">.ResDialog:</emphasis></term>
      <listitem>
      <para>
        The menu template is located in the resource only DLL of the <link linkend="clsResDialog">ResDialog</link>
        object specified. In this case, the resource <emphasis role="italic">id</emphasis> argument is required.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">.String:</emphasis></term>
      <listitem>
      <para>
        The file name of an executable module containing the menu template. When this source of the menu template is
        used, the resource <emphasis role="italic">id</emphasis> argument is required.  An executable module is either a
        DLL, or a .exe file, both of which can contain compiled resources.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">.Pointer</emphasis></term>
      <listitem>
      <para>
        A Rexx <computeroutput>.Pointer</computeroutput> object. If used, this argument must be a
        <computeroutput>.Pointer</computeroutput> object that represents a valid menu handle. Currently this source of
        the menu template is limited. The only way to get a menu handle is through the <link
        linkend="mthGetMenuHandle">getMenuHandle</link> method. However, future enhancements to ooDialog will likey have
        other ways to get a menu handle.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
    <varlistentry><term>id [optional]</term>
    <listitem>
    <para>
      The resource ID of the menu bar, may be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric. This
      argument is required if <emphasis role="italic">menuSrc</emphasis> is either a
      <computeroutput>.ResDialog</computeroutput> or <computeroutput>.String</computeroutput> object.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hID [optional]</term>
    <listitem>
    <para>
      The context help resource ID of the menu bar, may be <link linkend="itmMenuSymbolicIDs">symbolic</link> or
      numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>attachTo [optional]</term>
    <listitem>
    <para>
      If specified, attach this menu bar to the specified dialog. If used, <emphasis role="italic">attachTo</emphasis>
      has to be a <link linkend="chpDialogObject">dialog</link> object and the dialog must be in a valid state to attach
      the menu bar. That is, the <link linkend="ovvUnderlying">underlying</link> dialog must exist and the dialog must
      not already have a menu bar attached. If any of these conditions are not met, an exception is raised.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>auto [optional]</term>
    <listitem>
    <para>
      If true, turn on <emphasis role="italic">auto connection</emphasis>. The default is false. Refer to the
      discussion on command event <link linkend="sctMenuCommandEventConnections">connections</link> to understand the
      details of <emphasis role="italic">auto connection</emphasis>. When auto connection is on, <emphasis
      role="italic">each</emphasis> time this menu bar is attached to a dialog, all menu command <link
      linkend="sctMenuCommandEvents">events</link> are connected to a method in the dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mName [optional]</term>
    <listitem>
    <para>
      This argument is ignored unless <emphasis role="italic">auto</emphasis> is true. If so <emphasis
      role="italic">mName</emphasis> is used as the auto connection method name for all menu command events. When
      <emphasis role="italic">auto</emphasis> is true and this argument is omitted, the name of the connected method for
      each menu command item is composed from the menu item <link linkend="mthItemTextToMethodName">text</link>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>BinaryMenuBar</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Raises conditions for all failures. If no condition is raised then the menu has been created successfully.
  </para>
  <para>
    To use <link linkend="itmMenuSymbolicIDs">symbolic</link> IDs with menu objects the programmer must use the global
    <link linkend="dotConstDir">.constDir</link>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected, or other errors in instantiating the menu object have
    occurred.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable. However, it will only be non-zero if
    the help ID is set and there is a Windows API failure. It is unlikely that this could happen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example loads a menu bar from a DLL, immediately attaches it to the dialog, and connects all menu comand item
    events to the <emphasis role="italic">onMenuSelect</emphasis> even handler method:
<programlisting>
<![CDATA[

  .application~useGlobalConstDir('O', 'resource.h')

  dlg = .BinaryDialog~new("menuResourceEx.dll", IDD_DLGMENU)
  ...

::method initDialog
  expose menuBar
  ...

  menuBar = .BinaryMenuBar~new("menuResourceEx.dll", IDR_MENU1, , self, .true, onMenuSelect)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End BinaryMenuBar::new() -->

</section>  <!-- End BinaryMenuBar class -->

<section id="clsScriptMenuBar"><title>ScriptMenuBar Class</title>
<indexterm><primary>ScriptMenuBar class</primary></indexterm>
<para>
  The <emphasis role="italic">ScriptMenuBar</emphasis> is a menu <link linkend="clsMenuBar">bar</link> where the menu
  template is obtained from a resource script <link linkend="defResourceScript">file</link>.
</para>
<para>
  The class has all the methods of the <computeroutput>MenuBar</computeroutput> and the <link
  linkend="clsMenu">Menu</link> classes.  The only difference between the
  <computeroutput>ScriptMenuBar</computeroutput> and the other menu bar classes such as the <link
  linkend="clsBinaryMenuBar">BinaryMenubar</link> or <link linkend="clsUserMenuBar">UserMenuBar</link> is in the
  <emphasis role="italic">new</emphasis> method.
</para>

<section id="sctMethodsScriptMenuBar"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>ScriptMenuBar</computeroutput>. For
  convenience, the inherited methods from the <link linkend="clsMenuBar">MenuBar</link> mixin class are also listed
  here. Note that the <computeroutput>ScriptMenuBar</computeroutput> <emphasis role="italic">is</emphasis> a menu and
  therefore also contains all the methods of the <link linkend="clsMenu">Menu</link> class.
<table id="tblMethodsScriptMenuBar" frame="all"> <title>ScriptMenuBar Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="mthNewClsScriptMenuBar">new (Class)</link></entry>
<entry>Returns a new <computeroutput>ScriptMenuBar</computeroutput> object.</entry>
</row>
<row>
<entry><link linkend="mthAttachTo">attachTo</link></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><link linkend="mthDetach">detach</link></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><link linkend="mthIsAttached">isAttached</link></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><link linkend="mthRedrawClsMenu">redraw</link></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><link linkend="mthReplace">replace</link></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsScriptMenuBar"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>ScriptMenuBar class</secondary></indexterm>
<indexterm><primary>ScriptMenuBar class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--rcFile--+------+-+----------+-+---------+-+-----------+-+------------+-)--><
                  +-,-id-+ +-,-helpID-+ +-,-count-+ +-,-connect-+ +-,-attachTo-+

]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>ScriptMenuBar</computeroutput> object. The menu template is obtained from the
  resource script specified by the <emphasis role="italic">rcFile</emphasis> argument.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>rcFile [required]</term>
      <listitem>
      <para>
        The <link linkend="defResourceScript">resource</link> script file containing the menu definition for this script menu
        bar.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>id [optional]</term>
      <listitem>
      <para>
        The resource ID of the menu definition in the resource script. May be <link
        linkend="itmMenuSymbolicIDs">symbolic</link> or numeric. If this argument is omitted, the first menu definition
        found in the resource script is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>helpID [optional]</term>
      <listitem>
      <para>
        The context help ID for this menu. May be numeric or <link linkend="itmMenuSymbolicIDs">symbolic</link>. If
        omitted, the menu will not have a help ID.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>count [optional]</term>
      <listitem>
      <para>
        The (approximate) count of menu items the menu will contain. The default when omitted is 200. This number is
        used to allocate the resources for the in-memory menu template. It is only approximate because the actual size
        of the template will vary with the length of the labels for the menu items.
      </para>
      <para>
        When the template is being constructed, if the allocated resource is too small a syntax condition specifying the
        resource is too small will be raised. In this case, the programmer should use the <emphasis
        role="italic">count</emphasis> argument to specify a larger number of menu items.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>connect [optional]</term>
      <listitem>
      <para>
        If true, each menu command item in the menu is connected to a method in a Rexx dialog object the <emphasis
        role="italic">first</emphasis> time the menu is attached to a dialog. This is a connection <link
        linkend="sctMenuCommandEventConnections">request</link> type of connection. If the <emphasis
        role="italic">attachTo</emphasis> argument is used, then the menu command items are connected immediately.
        Otherwise the requests for connections are queued and the connections are made when the menu bar is actually
        attached to a dialog. The name of the connected method for each menu command item is composed from the menu item
        <link linkend="mthItemTextToMethodName">text</link>. The default for this argument is false.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>attachTo [optional]</term>
      <listitem>
      <para>
        Specifies a Rexx dialog object for the menu to attach to immediately. This argument must be a <link
        linkend="chpDialogObject">dialog</link> object, the <link linkend="ovvUnderlying">underlying</link> Windows
        dialog must exist and that dialog must not already have a menu bar attached. If those conditions are not met,
        then a syntax condition is raised.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a new <computeroutput>ScriptMenuBar</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Raises conditions for all failures. If no condition is raised then the menu has been created successfully.
  </para>
  <para>
    To use <link linkend="itmMenuSymbolicIDs">symbolic</link> IDs with menu objects the programmer must use the global
    <link linkend="dotConstDir">.constDir</link>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected, or other errors in instantiating the menu object have
    occurred.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable. However, it will only be non-zero if
    the help ID is set and there is a Windows API failure. It is unlikely that this could happen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example creates a script menu bar and attaches it immediately to the dialog. Methods in the Rexx dialog are
    automatically connected to the menu command events, no help ID is assigned, and the menu item count is left at the
    default:
<programlisting>
<![CDATA[

  .application~useGlobalConstDir("O", "ScriptMenuBar.h")

  dlg = .SimpleDialog~new("ScriptMenuBar.rc", IDD_SCRIPTMENUBAR_DLG)
  ...

::method initDialog
  expose menuBar

  menuBar = .ScriptMenuBar~new("ScriptMenuBar.rc", IDR_MENU_LV, , , .true, self)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

</section>  <!-- End ScriptMenuBar class -->

<section id="clsUserMenuBar"><title>UserMenuBar Class</title>
<indexterm><primary>UserMenuBar class</primary></indexterm>
<para>
  A <computeroutput>UserMenuBar</computeroutput> is a menu <link linkend="clsMenuBar">bar</link> whose menu template
  comes from statements in the program code.
</para>
<para>
  The ooDialog framework provides three basic types of menu bars. The only difference in the three types is the source
  of the menu template for the menu bar. In a <link linkend="clsScriptMenuBar">ScriptMenuBar</link> the source of the
  menu template is a <link linkend="defResourceScript">resource</link> file (usually a .rc file) that ooDialog parses
  and uses to construct the menu template. For a <link linkend="clsBinaryMenuBar">BinaryMenuBar</link> the menu template
  comes from a compiled binary resource, or the menu template is constructed as an empty menu.
</para>
<para>
  In general it is much easier to dynamically construct the menu template by starting with an empty <link
  linkend="clsBinaryMenuBar">BinaryMenuBar</link> and inserting the desired menu itmes than it is to define the menu
  template in an <computeroutput>UserMenuBar</computeroutput>.
</para>

<section id="sctMethodsUserMenuBar"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>UserMenuBar</computeroutput>. For convenience, the inherited methods from the <link
  linkend="clsMenuBar">MenuBar</link> mixin class are also listed here. Note that the
  <computeroutput>UserMenuBar</computeroutput> <emphasis role="italic">is</emphasis> a menu and therefore also contains
  all the methods of the <link linkend="clsMenu">Menu</link> class.
<table id="tblMethodsUserMenuBar" frame="all"> <title>UserMenuBar Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="mthNewClsUserMenuBar">new (Class)</link></entry>
<entry>Returns a new <computeroutput>UserMenuBar</computeroutput>object.</entry>
</row>
<row>
<entry><link linkend="mthAddItem">addItem</link></entry>
<entry>Adds a command menu item to the menu template.</entry>
</row>
<row>
<entry><link linkend="mthAddPopup">addPopuup</link></entry>
<entry>Adds a popup menu, a submenu, to the menu template.</entry>
</row>
<row>
<entry><link linkend="mthAddSeparator">addSeparator</link></entry>
<entry>Adds a separator menu item to the menu template.</entry>
</row>
<row>
<entry><link linkend="mthAttachTo">attachTo</link></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><link linkend="mthComplete">complete</link></entry>
<entry>Finializes the in-memory template and converts it to an actual menu bar.</entry>
</row>
<row>
<entry><link linkend="mthDetach">detach</link></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><link linkend="mthIsComplete">isComplete</link></entry>
<entry>Tests if the menu template has been finished and converted to a menu.</entry>
</row>
<row>
<entry><link linkend="mthIsAttached">isAttached</link></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><link linkend="mthRedrawClsMenu">redraw</link></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><link linkend="mthReplace">replace</link></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsUserMenuBar"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>UserMenuBar class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--+-----+-+----------+-+---------+-+--------+-+---------+--)-----------><
          +--id-+ +-,-helpID-+ +-,-count-+ +-,-auto-+ +-,-mName-+


]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>UserMenuBar</computeroutput> object. The menu template of a user menu bar is
  created dynamically in the program code, using the methods of the <computeroutput>UserMenuBar</computeroutput> class.
  This is similar to the creation of the dialog template in a <link linkend="clsUserDialog">UserDialog</link>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [optional]</term>
    <listitem>
    <para>
      The resource ID for the menu bar. May be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric. If this
      argument is omitted or is -1, the menu bar will not have a resource ID.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>helpID [optional]</term>
    <listitem>
    <para>
      The context help ID for this menu. May be numeric or <link linkend="itmMenuSymbolicIDs">symbolic</link>. If
      omitted, the menu will not have a help ID.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>count [optional]</term>
    <listitem>
    <para>
      The (approximate) count of menu items the menu will contain. The default when omitted is 200. This number is
      used to allocate the resources for the in-memory menu template. It is only approximate because the actual size
      of the template will vary with the length of the labels for the menu items.
    </para>
    <para>
      When the template is being constructed, if the allocated resource is too small a syntax condition specifying the
      resource is too small will be raised. In this case, the programmer should use the <emphasis
      role="italic">count</emphasis> argument to specify a larger number of menu items.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>auto [optional]</term>
    <listitem>
    <para>
      If true, turn on <emphasis role="italic">auto connection</emphasis>. The default is false. Refer to the
      discussion on command event <link linkend="sctMenuCommandEventConnections">connections</link> to understand the
      details of <emphasis role="italic">auto connection</emphasis>. When auto connection is on, <emphasis
      role="italic">each</emphasis> time this menu bar is attached to a dialog, all menu command <link
      linkend="sctMenuCommandEvents">events</link> are connected to a method in the dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mName [optional]</term>
    <listitem>
    <para>
      This argument is ignored unless <emphasis role="italic">auto</emphasis> is true. If so <emphasis
      role="italic">mName</emphasis> is used as the auto connection method name for all menu command events. When
      <emphasis role="italic">auto</emphasis> is true and this argument is omitted, the name of the connected method for
      each menu command item is composed from the menu item <link linkend="mthItemTextToMethodName">text</link>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>UserMenuBar</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Properly constructing a menu template using the <computeroutput>UserMenuBar</computeroutput> is somewhat difficult
    to do correctly, making it prone to error. It is much simpler to construct the menu template using an empty <link
    linkend="clsBinaryMenuBar">BinaryMenuBar</link>. ooDialog programmers are encouraged to use the
    <computeroutput>BinaryMenuBar</computeroutput> class rather than the <computeroutput>UserMenuBar</computeroutput>
    class.
  </para>
  <para>
    Raises conditions for all failures. If no condition is raised then the menu has been created successfully.
  </para>
  <para>
    To use <link linkend="itmMenuSymbolicIDs">symbolic</link> IDs with menu objects the programmer must use the global
    <link linkend="dotConstDir">.constDir</link>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected, or other errors in instantiating the menu object have
    occurred.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable. However, it will only be non-zero if
    the help ID is set and there is a Windows API failure. It is unlikely that this could happen.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleNewUserMenuBar"><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the creation of a user menu bar in a private method of the dialog. The application use symbolic
    menu IDs. The default count of menu items is changed to 20 when the user menu bar is instantiated and auto
    connection is turned on. Since no method name is provided, each menu command event will be connected to a separate
    method.
<programlisting>
<![CDATA[

  -- All resource IDs are symbolic and are defined in userMenu.h
  .application~useGlobalConstDir('O', "userMenu.h")
  ...

::method defineMenu private
  expose menuBar statusText

  count = 20
  menuBar = .UserMenuBar~new(IDH_MENU1, , count, .true)

  menuBar~addPopup(IDM_POP_FILES, "Files", "END", IDH_FILES)
    menuBar~addItem(ID_FILES_COPY, "Copy", "RADIO")
    menuBar~addItem(ID_FILES_MOVE, "Move", "DEFAULT CHECK RADIO")
    menuBar~addItem(ID_FILES_DELETE, "Delete", "RADIO")
    menuBar~addSeparator(IDM_SEP_FILES)
    menuBar~addPopup(IDM_POP_RENAME, "Rename", , IDH_RENAME)
      menuBar~addItem(ID_RENAME_LOWERCASE, "Lower case")
      menuBar~addItem(ID_RENAME_UPPERCASE, "Upper case", "CHECK END")
    menuBar~addSeparator(IDM_SEP_FILES)
    menuBar~addItem(ID_EXIT, "Exit", "END")

  if \ menuBar~complete then do
    statusText = 'User menu bar completion error: ' || -
                 .SystemErrorCode SysGetErrortext(.SystemErrorCode)
    return .false
  end

  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddItem"><title>addItem</title>
<indexterm><primary>addItem</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>addItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addItem(--id-,-text--+---------+--+---------+--)------------><
                         +-,-opts--+  +-,-mName-+
]]>
</programlisting>

<para>
  Adds a menu command item to the menu template. This method is only valid after the
  <computeroutput>UserMenuBar</computeroutput> has been instantiated and before the menu template is <link
  linkend="mthComplete">completed</link>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID for the menu command item. May be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text, the label, for the menu item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. The keywords set the
      state and type of the popup menu, and specify when the popup menu is the last item at the current level in the
      menu.
    </para>
    <para>
      The keywords: ENABLED UNHILITE NOTDEFAULT UNCHECKED, although valid keywords, are simply ignored for this method.
      By default the state will be ENABLED UNHILITE NOTDEFAULT UNCHECKED, with no special type. The keywords are:
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>CHECKED      </member>
      <member>DEFAULT      </member>
      <member>DISABLED     </member>
      <member>GRAYED       </member>
      <member>HILITE       </member>
      <member>MENUBARBREAK </member>
      <member>MENUBREAK    </member>
      <member>RADIO        </member>
      <member>RIGHTJUSTIFY </member>
      <member>END          </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>CHECKED</term>
      <listitem>
      <para>
        A menu item state specification. Checks the menu item. If the item also has the RADIO type, the check is a
        bullet, otherwise it is a normal check mark.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DEFAULT</term>
      <listitem>
      <para>
        A menu item state specification. Specifies that the menu item is the default. A menu can contain only one
        default menu item, which is displayed in bold.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DISABLE</term>
      <listitem>
      <para>
        A menu item state specification. Disables the menu item and grays it so that it cannot be selected. DISABLED and
        GRAYED are exactly the same.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>GRAYED</term>
      <listitem>
      <para>
        A menu item state specification. Disables the menu item and grays it so that it cannot be selected. DISABLED and
        GRAYED are exactly the same.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>HILITE</term>
      <listitem>
      <para>
        A menu item state specification. Highlights the menu item. Although the menu item can be created with this
        state, it would not normally be done. It gives the user the appearance the menu is selected, but it is not
        actually selected.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBARBREAK</term>
      <listitem>
      <para>
        A menu item type specification. Places the menu item on a new line (for a menu bar) or in a new column (for a
        drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or shortcut menu, a vertical line
        separates the new column from the old.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBREAK</term>
      <listitem>
      <para>
        A menu item type specification. Places the menu item on a new line (if in the top level of a menu bar) or in a
        new column (for a menu item in a drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or
        shortcut menu, the columns are <emphasis role="italic">not</emphasis> separated by a vertical line.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTJUSTIFY</term>
      <listitem>
      <para>
        A menu item type specification. Right-justifies the menu item and any subsequent popup menus. This value is
        valid only if the menu item is in the top level of a menu bar. (Although it is not common to put a menu item in
        the top level of a menu bar, it can be done.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term>END</term>
      <listitem>
      <para>
        Indicates that this is the last menu item at the current level of the menu. The END keyword <emphasis
        role="italic">must</emphasis> be present if the item is the last menu item at the current level, and can
        <emphasis role="italic">not</emphasis> be present otherwise. Incorrect placement of the END keyword is the most
        common problem programmers have when using the <computeroutput>UserMenuBar</computeroutput> class.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term>mName [optional]</term>
  <listitem>
  <para>
    A method name to connect the menu command event to. The default is to not connect the menu command item. This is a
    connection <link linkend="sctMenuCommandEventConnections">request</link> type of connection. If this argument is
    used it can not be the empty string.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    It is suggested that the ooDialog programmer create an empty <link linkend="clsBinaryMenuBar">BinaryMenuBar</link>
    and add the menu items to the menu bar using the <emphasis role="italic">insert</emphasis> methods, such as <link
    linkend="mthInsertPopup">insertPopup</link>. This provides all the functionality of the
    <computeroutput>UserMenuBar</computeroutput>, but is easier to use.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The <computeroutput>UserMenuBar</computeroutput>
        has already been <link linkend="mthIsComplete">completed</link>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_PARAMETER (87)</term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> When the <emphasis
      role="italic">mName</emphasis> argument is used, it can not be the empty string.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    There is a good example of using the <emphasis role="italic">addItem</emphasis> method in the <link
    linkend="exampleNewUserMenuBar">example</link> for the <emphasis role="italic">new</emphasis> method of the
    <computeroutput>UserMenuBar</computeroutput> class.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::addItem() -->

<section id="mthAddPopup"><title>addPopup</title>
<indexterm><primary>addPopup</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>addPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addPopup(--id--,--name--+--------+--+----------+--)----><
                            +-,-opts-+  +-,-helpID-+
]]>
</programlisting>

<para>
  Adds a popup menu, a submenu, to the menu template. This method is only valid after the
  <computeroutput>UserMenuBar</computeroutput> has been instantiated and before the menu template is <link
  linkend="mthComplete">completed</link>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID for the popup menu. May be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>name [required]</term>
    <listitem>
    <para>
      The text label of the popup menu.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. The keywords set the
      state and type of the popup menu, and specify when the popup menu is the last item at the current level in the
      menu.
    </para>
    <para>
      The keywords: ENABLED UNHILITE NOTDEFAULT, although valid keywords, are simply ignored for this method. By default
      the state will be ENABLED UNHILITE NOTDEFAULT, with no special type. The keywords are:
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>DEFAULT      </member>
      <member>DISABLED     </member>
      <member>GRAYED       </member>
      <member>HILITE       </member>
      <member>MENUBARBREAK </member>
      <member>MENUBREAK    </member>
      <member>RIGHTJUSTIFY </member>
      <member>RIGHTORDER   </member>
      <member>END          </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>DEFAULT</term>
      <listitem>
      <para>
        A popup menu state specification. Specifies that the popup menu is the default. A menu can contain only one
        default menu item, which is displayed in bold.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DISABLE</term>
      <listitem>
      <para>
        A popup menu state specification. Disables the popup menu and grays it so that it cannot be selected. DISABLED
        and GRAYED are exactly the same
      </para>
      </listitem></varlistentry>
      <varlistentry><term>GRAYED</term>
      <listitem>
      <para>
        A popup menu state specification. Disables the popup menu and grays it so that it cannot be selected. DISABLED
        and GRAYED are exactly the same
      </para>
      </listitem></varlistentry>
      <varlistentry><term>HILITE</term>
      <listitem>
      <para>
        A popup menu state specification. Highlights the popup menu. Although the popup menu can be created with this
        state, it would not normally be done. It gives the user the appearance the popup menu is selected, but it is not
        actually selected.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBARBREAK</term>
      <listitem>
      <para>
        A popup menu type specification. Places the popup menu on a new line (for a menu bar) or in a new column (for a
        drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or shortcut menu, a vertical line
        separates the new column from the old.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBREAK</term>
      <listitem>
      <para>
        A popup menu type specification. Places the popupt menu on a new line (for a menu bar) or in a new column (for
        a drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or shortcut menu, the columns are
        <emphasis role="italic">not</emphasis> separated by a vertical line.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTJUSTIFY</term>
      <listitem>
      <para>
        A popup menu type specification. Right-justifies the popup menu and any subsequent popup menus. This value is
        valid only if the popup menu is in a menu bar.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTORDER</term>
      <listitem>
      <para>
        A popup menu type specification.  Specifies that menus cascade right-to-left (the default is left-to-right).
        This is used to support right-to-left languages, such as Arabic and Hebrew.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>END</term>
      <listitem>
      <para>
        Indicates that this is the last menu item at the current level of the menu. The END keyword <emphasis
        role="italic">must</emphasis> be present if the popup menu is the last menu item at the current level, and can
        <emphasis role="italic">not</emphasis> be present otherwise. Incorrect placement of the END keyword is the most
        common problem programmers have when using the <computeroutput>UserMenuBar</computeroutput> class.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>helpID [optional]</term>
    <listitem>
    <para>
      The context help ID for the popup menu. May be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    It is suggested that the ooDialog programmer create an empty <link linkend="clsBinaryMenuBar">BinaryMenuBar</link>
    and add the menu items to the menu bar using the <emphasis role="italic">insert</emphasis> methods, such as <link
    linkend="mthInsertPopup">insertPopup</link>. This provides all the functionality of the
    <computeroutput>UserMenuBar</computeroutput>, but is easier to use.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The <computeroutput>UserMenuBar</computeroutput>
        has already been <link linkend="mthIsComplete">completed</link>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    There is a good example of using the <emphasis role="italic">addPopup</emphasis> method in the <link
    linkend="exampleNewUserMenuBar">example</link> for the <emphasis role="italic">new</emphasis> method of the
    <computeroutput>UserMenuBar</computeroutput> class.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddSeparator"><title>addSeparator</title>
<indexterm><primary>addSeparator</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>addSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addSeparator(--id--+---------+--)------------><
                       +-,-opts--+
]]>
</programlisting>

<para>
  Adds a separator, which is a horizontal line, to the menu template. This method is only valid after the
  <computeroutput>UserMenuBar</computeroutput> has been instantiated and before the menu template is <link
  linkend="mthComplete">completed</link>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID for the separator. May be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric. -1 is
      accepted to indicate no ID is desired, however, there are many advantages to assigning valid IDs to separators.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. The keywords set the
      few valid types of the separator, and specify when the separator is the last item at the current level in the
      menu. The keywords are:
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>MENUBARBREAK </member>
      <member>MENUBREAK    </member>
      <member>RIGHTJUSTIFY </member>
      <member>END          </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>MENUBARBREAK</term>
      <listitem>
      <para>
        A separator type specification. Places the separator, and all menu items following it, on a new line (for a menu
        bar) or in a new column (for a drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or
        shortcut menu, a vertical line separates the new column from the old.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBREAK</term>
      <listitem>
      <para>
        A separator type specification. Places the separator, and all menu items following it, on a new line (for a menu
        bar) or in a new column (for a drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or
        shortcut menu, the columns are <emphasis role="italic">not</emphasis> separated by a vertical line.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTJUSTIFY</term>
      <listitem>
      <para>
        A separator type specification. Right-justifies the separator and any subsequent menu items. This value is
        valid only if the separator is in a menu bar.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>END</term>
      <listitem>
      <para>
        Indicates that this is the last menu item at the current level of the menu. The END keyword <emphasis
        role="italic">must</emphasis> be present if the separator is the last menu item at the current level, and can
        <emphasis role="italic">not</emphasis> be present otherwise. Incorrect placement of the END keyword is the most
        common problem programmers have when using the <computeroutput>UserMenuBar</computeroutput> class.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success and false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The Microsoft documentation indicates that a separator can not be used in a menu bar, only in a submenu. However, on
    Windows 7 at least, separators can be used in the menu bar. No vertical line is shown, but the separator will take
    up a little space. The separator <emphasis role="italic">type</emphasis> keywords work as expected. I.e., if the
    separtor is given the RIGHTJUSTIFY type, it and all subsequent menut items are right justified in the menu bar.
  </para>
  <para>
    It is suggested that the ooDialog programmer create an empty <link linkend="clsBinaryMenuBar">BinaryMenuBar</link>
    and add the menu items to the menu bar using the <emphasis role="italic">insert</emphasis> methods, such as <link
    linkend="mthInsertPopup">insertPopup</link>. This provides all the functionality of the
    <computeroutput>UserMenuBar</computeroutput>, but is easier to use.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The <computeroutput>UserMenuBar</computeroutput>
        has already been <link linkend="mthIsComplete">completed</link>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    There is a good example of using the <emphasis role="italic">addSeparator</emphasis> method in the <link
    linkend="exampleNewUserMenuBar">example</link> for the <emphasis role="italic">new</emphasis> method of the
    <computeroutput>UserMenuBar</computeroutput> class.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::addSeparator() -->

<section id="mthComplete"><title>complete</title>
<indexterm><primary>complete</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>complete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--complete-------------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">complete</emphasis> method finializes the in-memory template and converts it to an actual
  menu bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The menu bar can not be attached to a dialog prior to invoking the <emphasis role="italic">complete</emphasis>
    method. Likewise, no menu items can be added to the template using the <link linkend="mthAddItem">addItem</link>,
    <link linkend="mthAddPopup">addPopup</link>, or <link linkend="mthAddSeparator">addSeparator</link> methods after
    the <emphasis role="italic">complete</emphasis> method is invoked. However, once the menu bar is complete, the
    <emphasis role="italic">insert</emphasis> methods of the menu object, such as the <link
    linkend="mthInsertPopup">insertPopup</link> method can all be used to insert menu items.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu template has already been finialized.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The <link linkend="exampleNewUserMenuBar">example</link> for the <emphasis role="italic">new</emphasis> method of
    the <computeroutput>UserMenuBar</computeroutput> class uses the <emphasis role="italic">complete</emphasis> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::complete() -->

<section id="mthIsComplete"><title>isComplete</title>
<indexterm><primary>isComplete</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>isComplete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isComplete-----------------------------------><

]]>
</programlisting>

<para>
  Tests if the menu template has been finished and converted to a menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu template has already been finished and converted to a menu, otherwise returns false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Once the menu template has been finalized and converted to an actual menu, menu items can not longer be added to the
    template.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a method that adds a separator to the menu template when invoked. It first checks that the menu
    template is still available to add menu items
<programlisting>
<![CDATA[

::method maybeAddSeparator private
  use strict arg id, isEnd

  if self~isComplete then return .false

  if isEnd the do
    self~addSeparator(id, 'END')
  end
  else do
    self~addSeparator(id)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::isComplete() -->

</section>  <!-- End UserMenuBar class -->

<section id="clsPopupMenu"><title>PopupMenu Class</title>
<indexterm><primary>PopupMenu class</primary></indexterm>
<para>
  A popup menu is a <emphasis role="italic">menu</emphasis> as opposed to a <emphasis role="italic">menu
  bar</emphasis>. Menus are arranged in a hierarchy with the menu bar being the top-level of the hierarchy. Popup menus
  go by a variety of names depending on where they are located in the hierarchy, and their use. But, they are all the
  same no matter the name used.
</para>
<para>
  When a popup menu is in the menu bar, it is often called a drop-down menu. When a popup menu is within another popup
  menu it is usually called a submenu. Menus can also exist that are not attached to a menu bar, in which case they are
  often called shortcut menus, context menus, or popup menus. This documentation tries to be
  consistent and use the term popup menu in all cases. Method names in the Menu classes always use <emphasis
  role="italic">popup</emphasis>.
</para>

<section id="evtPopupMenuCONTEXT"><title>ContextMenu Event Handler</title>
<indexterm><primary>PopupMenu Event</primary><secondary>CONTEXTMENU</secondary></indexterm>
<para>
  The event handler for the context menu event is invoked when the user right-mouse clicks on a window, types SHIFT-F10
  on the keyboard, or types the VK_APPS key on the keyboard. The VK_APPS key is the <emphasis
  role="italic">Applications</emphasis> key on a Natural keyboard. Use the <link
  linkend="mthConnectContextMenuCls">connectContextMenu</link> class method, or the <link
  linkend="mthConnectContextMenu">connectContextMenu</link> instance method to connect the context menu event.
</para>
<para>
  The interpreter does not wait for the return from the event handler, so the method does not need to return a value.
  However, good practice would be to always return a value from an event handler. 0 would be a good value to return.
</para>

<programlisting>
<![CDATA[
::method onContextMenu unguarded
  use arg hwnd, x, y

  return 0
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method recieves 3 arguments:
  </para>
  <variablelist>
    <varlistentry><term>hwnd</term>
    <listitem>
    <para>
      The window <link linkend="defHandle">handle</link> of the window the user clicked the mouse on, or the window
      that has the focus if the user generated the context menu event with the keyboard. Note that this will only be
      the dialog window handle of the user clicks on the dialog background. Quite often it is going to be one of the
      dialog controls.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>x</term>
    <listitem>
    <para>
      The X coordinate of the mouse position, in <link linkend="defScreenCoordinates">screen</link> coordinates, at the
      time of the mouse click. Or, -1 if the user generated the context menu event by using the keyboard.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>y</term>
    <listitem>
    <para>
      The Y coordinate of the mouse position, in <link linkend="defScreenCoordinates">screen</link> coordinates, at the
      time of the mouse click. Or, -1 if the user generated the context menu event by using the keyboard.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    0 makes a good return value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example shows the event handler method that is only invoked for a list view in the application. Note
    that since the application uses the <link linkend="mthShowClsPopupMenu">show</link> method to put up the context
    menu, the handling of the menu command item selection is done in a menu command event
    <link linkend="sctMenuCommandEventHandlers">handler</link>.

<programlisting>
<![CDATA[

  if \ lvPopup~connectContextMenu(onListViewContext, self~newListView(IDC_LV)~hwnd) then do
    say 'Error conecting context menu. SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end
  ...

::method onListViewContext
  expose lvPopup listView
  use arg hwnd, x, y

  if x == -1, y == -1 then do
    -- The keyboard was used, not the mouse.  Position the context menu as
    -- at the lower right of the list view.
    rect = listView~windowRect
    x = rect~right - .SM~cxVScroll + 15
    y = rect~bottom - 15
  end

  -- pos is the point on the screen, in pixels, to place the context menu.
  pos = .Point~new(x, y)

  -- Show the menu.
  ret = lvPopup~show(pos)
  if ret == -1 then do
    say 'lvPopup~show() failed SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End context Event Handler -->


<section id="sctMethodsPopupMenu"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>PopupMenu</computeroutput>.
<table id="tblMethodsPopupMenu" frame="all"> <title>PopupMenu Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="mthConnectContextMenuCls">connectContextMenu</link></entry>
<entry>Connects the Windows context menu event with a method in the Rexx dialog.</entry>
</row>
<row>
<entry><link linkend="mthNewClsPopupMenu">new</link></entry>
<entry>Returns a new <computeroutput>PopupMenu</computeroutput>object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="mthAssignTo">assignTo</link></entry>
<entry>Assigns this popup menu to a dialog.</entry>
</row>
<row>
<entry><link linkend="mthConnectContextMenu">connectContextMenu</link></entry>
<entry>Connects the Windows context menu event with a method in the Rexx dialog.</entry>
</row>
<row>
<entry><link linkend="mthIsAssigned">isAssigned</link></entry>
<entry>Determines if this menu has an assigned owner.</entry>
</row>
<row>
<entry><link linkend="mthShowClsPopupMenu">show</link></entry>
<entry>Shows a popup menu as a context menu and returns immediately.</entry>
</row>
<row>
<entry><link linkend="mthTrack">track</link></entry>
<entry>Shows a popup menu as a context menu and returns when the menu is dismissed</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthConnectContextMenuCls"><title>connectContextMenu (Class)</title>
<indexterm><primary>connectContextMenu</primary><secondary>PopupMenu class</secondary><tertiary>class method</tertiary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>connectContextMenu</secondary><tertiary>class method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectContextMenu(--dlg--,--methodName--+---------+--+-----------+--)-----><
                                             +-,-hwnd--+  +-,-handles-+
]]>
</programlisting>

<para>
  Connects the context menu <link linkend="ovvEvents">event</link> notification to a method in a Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The Rexx dialog the notification is being connect to.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName [required]</term>
    <listitem>
    <para>
      The method in the Rexx dialog to be invoked when the event happens.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hwnd [optional]</term>
    <listitem>
    <para>
      A window handle to filter the right-clicks on. This can be the window handle of any control in the dialog being
      connnected, or even the dialog window handle itself. If used, only right-clicks on the specified window will be
      received. If omitted, all right-clicks on the dialog are received.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The context menu event is generated when the user right-mouse clicks on a window. The event can also be generated by
    the keyboard by using SHIFT-F10 or the VK_APPS key (the Applications key on a Natural keyboard.) The <emphasis
    role="italic">ContextMenu Event Handler</emphasis> <link linkend="evtPopupMenuCONTEXT">section</link> has
    information on how to code the event handler.
  </para>
  <para>
    In many cases, the <link linkend="mthConnectContextMenu">connectContextMenu</link> instance method will be more
    convenient to use. This class method is provided for times when the menu object itself is not available. For
    instance, some Windows applications dynamically create a context menu when receiving the event notification and then
    discard the menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on error. The system error code is set this way
    by ooDialog, in addition to error codes the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    If the programmer does not provide a method named <emphasis role="italic">methodName</emphasis> in the Rexx dialog,
    a syntax condition will be raised if any context menu events happen.
  </para>
  <para>
    The underlying dialog receives the WM_CONTEXTMENU message as the notification for this event.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example the application creates the context menus after receiving the event notification. It needs to
    connect the event before the menu objects actually exist.
<programlisting>
<![CDATA[
::method initDialog
  ...

  lvHwnd = self~newListView(IDC_LV_EMPLOYEES)
  .PopupMenu~connectContextMenu(self, "onListViewContext", lvHwnd)

  .PopupMenu~connectContextMenu(self, "onDialogContext", self~hwnd)

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::connectContextMenu()::ClassMehtod -->

<section id="mthNewClsPopupMenu"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>PopupMenu class</secondary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--+----+--+-----------+--)---------------><
          +-id-+  +-,-helpID--+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>PopupMenu</computeroutput> object. Initially the menu is empty.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [optional]</term>
    <listitem>
    <para>
      The resource ID for the popup menu. May be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric. If this
      argument is omitted or is -1, the popup menu will not have a resource ID.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>helpID [optional]</term>
    <listitem>
    <para>
      The context help ID for this menu. May be numeric or <link linkend="itmMenuSymbolicIDs">symbolic</link>. If
      omitted, the popup menu will not have a help ID.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>PopupMenu</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using a popup menu as a context menu, it is often convenient to simply get the menu from an existing menu
    through the <link linkend="mthGetPopup">getPopup</link> method. This is particularly true when the application is
    based on resource script files or binary compiled resources. In those types of applications, the menus are created
    in the resource script file. Within the resource script, all menus have to be defined as menu bars. To define a
    popup menu that is only used as a context menu, simply define a menu bar that only contains one menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable. However, the variable will only be
    non-zero if the Windows API used to set the help ID fails. This is unlikely to happen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a popup menu and then adds a few menu items to it:
<programlisting>
<![CDATA[

  m = .PopupMenu~new(IDM_LV_BAR)

  m~insertItem(IDM_LV_RESTORE, IDM_LV_RESTORE, "Restore Original Order")
  m~insertItem(IDM_LV_RESTORE, IDM_LV_PROFESSION, "Order by Profession")
  m~insertItem(IDM_LV_PROFESSION, IDM_LV_FNAME, "Order by First Name")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAssignTo"><title>assignTo</title>
<indexterm><primary>assignTo</primary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>assignTo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--assignTo(--dlg--+-------+-+----------+--)----><
                    +-,-auto+ +-,-mName--+
]]>
</programlisting>

<para>
  Assigns this popup menu to a dialog. This is only used when the menu is used as a context, or shortcut, menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The owner dialog to assign this menu to. See the Remarks section below.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>auto [optional]</term>
    <listitem>
    <para>
      If true, turn on auto <link linkend="sctMenuCommandEventConnections">connection</link>. The default is false.
      When <emphasis role="italic">auto connection</emphasis> is on, <emphasis role="italic">each</emphasis> time this
      popup menu is assigned to a dialog, all menu command <link linkend="sctMenuCommandEvents">events</link> are
      connected to a method in the dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mName [optional]</term>
    <listitem>
    <para>
      Only used if <emphasis role="italic">auto</emphasis> true. If <emphasis role="italic">auto</emphasis> is true and
      this argument is not omitted, then <emphasis role="italic">mName</emphasis> is used to set, or reset, the auto
      connection method name. Note that this implies that if <emphasis role="italic">auto connection</emphasis> is
      already turned on for this menu, then <emphasis role="italic">mName</emphasis> can be used to change the auto
      connection method name.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a popup menu is used as a shortcut (context) menu it sends messages to its owner dialog when menu items are
    selected. Even if the short cut menu is only used with the <link linkend="mthTrack">track</link> method, (where
    selecting a menu item does not send a message to its owner dialog,) the operating system still requires that the
    short cut menu have an owner dialog.
  </para>
  <para>
    It is not neccessary to assign a short cut menu to a dialog, it just may be more convenient.  If the shortcut menu
    does not have an assigned dialog, then the owner dialog must be specified each time the <link
    linkend="mthTrack">track</link> or <link linkend="mthShowClsPopupMenu">show</link> methods are invoked.
  </para>
  <para>
    A short cut menu can only be assigned to one dialog, if this menu is already assigned to a dialog, the owner dialog
    is replaced by the specified dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis> This menu has been destroyed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> <emphasis
        role="italic">dlg</emphasis> is not a <link linkend="chpDialogObject">dialog</link> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example calls a function that creates a context menu and then assigns the menu to the dialog object:
<programlisting>
<![CDATA[

  contextMenu = createListViewMenu()

  if \ contexMenu~assignTo(self, .true) then do
    say 'Error assigning the context menu. SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::assignTo() -->

<section id="mthConnectContextMenu"><title>connectContextMenu</title>
<indexterm><primary>connectContextMenu</primary><secondary>PopupMenu class</secondary><tertiary>instance method</tertiary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>connectContextMenu</secondary><tertiary>instance method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectContextMenu(--methodName--+--------+--+---------+--)----------------><
                                     +-,-dlg--+  +-,-hwnd--+
]]>
</programlisting>

<para>
  Connects the context menu <link linkend="ovvEvents">event</link> notification to a method in a Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>methodName [required]</term>
    <listitem>
    <para>
      The method in the Rexx dialog to be invoked when the event happens.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      By default, the notification is connected to the owner dialog of the menu. However, the programmer can specify any
      Rexx dialog here to connect the notification to. If the menu does not have an owner dialog then the programmer
      must specify the Rexx dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hwnd [optional]</term>
    <listitem>
    <para>
      A window handle to filter the right-clicks on. This can be the window handle of any control in the dialog being
      connnected, or even the dialog window handle itself. If used, only right-clicks on the specified window will be
      received. If omitted, all right-clicks on the dialog are received.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The context menu event is generated when the user right-mouse clicks on a window. The event can also be generated by
    the keyboard by using SHIFT-F10 or the VK_APPS key (the Applications key on a Natural keyboard.) The <emphasis
    role="italic">ContextMenu Event Handler</emphasis> <link linkend="evtPopupMenuCONTEXT">section</link> has
    information on how to code the event handler.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    If the programmer does not provide a method named <emphasis role="italic">methodName</emphasis> in the Rexx dialog,
    a syntax condition will be raised if any context menu events happen.
  </para>
  <para>
    The underlying dialog receives the WM_CONTEXTMENU message as the notification for this event.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example the context menu notification is connected to the method, <emphasis
    role="italic">onContextMenu</emphasis>. All
<programlisting>
<![CDATA[
::method initDialog
  ...

  lvHwnd = self~newListView(IDC_LV_EMPLOYEES)~hwnd
  .PopupMenu~connectContextMenu(self, "onListViewContext", lvHwnd)

  .PopupMenu~connectContextMenu(self, "onDialogContext", self~hwnd)

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::connectContextMenu()::InstanceMethod -->

<section id="mthIsAssigned"><title>isAssigned</title>
<indexterm><primary>isAssigned</primary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>isAssigned</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isAssigned-----------------------------------><

]]>
</programlisting>

<para>
  Determines if this menu has an assigned owner.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if this menu has been assigned to an owner dialog, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Only popup menus can be assigned to a dialog, menu bars are <emphasis role="italic">attached</emphasis> to dialogs.
    Only popup menus that are used as context menus need to be <link linkend="mthAssignTo">assigned</link> to a dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Resets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable to 0. There are no operating system
    errors that would change that.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example checks if the context menu is already assigned to a dialog before assigning it to the current dialog
    object:
<programlisting>
<![CDATA[

  if \ contextMenu~isAssigned then do
    if \ contexMenu~assignTo(self, .true) then do
      say 'Error assigning the context menu. SystemErrorCode:' || -
      .SystemErrorCode SysGetErrortext(.SystemErrorCode)
    end
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::isAssigned() -->

<section id="mthShowClsPopupMenu"><title>show</title>
<indexterm><primary>show</primary><secondary>PopupMenu class</secondary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>show</secondary></indexterm>
<programlisting>
<![CDATA[
>>--show(--p--+-------+--+--------+--+--------------+--+---------------+--)----><
              +-,-dlg-+  +-,-opts-+  +-,-bothButons-+  +-,-excludeRect-+
]]>
</programlisting>

<para>
  Displays a contex menu and returns after the user has selected an item or canceled the menu.  When the user selects an
  item, a menu <link linkend="sctMenuCommandEvents">command</link> event notification, using the id of the menu item
  selected, is generated. If the user cancels, nothing happens.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>p [required]</term>
    <listitem>
    <para>
      A <link linkend="clsPoint">Point</link> object specifying the location for the shortcut menu, in <link
      linkend="defScreenCoordinates">screen</link> co-ordinates.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      The Rexx dialog object that the menu should be assigned to. If the menu has already been assigned an owner dialog
      this argument can be omitted. If there is no already assigned dialog, this argument is required. Any menu
      displayed on the screen is required by the operating system to have an assigned dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, specifying additional options for the shortcut
      menu, case is not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>LEFT           </member>
        <member>HCENTER        </member>
        <member>RIGHT          </member>
        <member>TOP            </member>
        <member>VCENTER        </member>
        <member>BOTTOM         </member>
        <member>HORNEGANIMATION</member>
        <member>HORPOSANIMATION</member>
        <member>NOANIMATION    </member>
        <member>VERNEGANIMATION</member>
        <member>VERPOSANIMATION</member>
        <member>HORIZONTAL     </member>
        <member>VERTICAL       </member>
        <member>RECURSE        </member>
        <member>LAYOUTRTL      </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>LEFT</term>
        <listitem>
        <para>
          Centers the shortcut menu horizontally relative to the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HCENTER</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its left side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RIGHT</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its right side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the LEFT, HCENTER, or RIGHT keywords. RIGHT is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TOP</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its top side is aligned with the Y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VCENTER</term>
        <listitem>
        <para>
          Centers the shortcut menu vertically relative to the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>BOTTOM</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its bottom side is aligned with the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the TOP, VCENTER, or BOTTOM keywords. BOTTOM is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from right to left.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from left to right.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOANIMATION</term>
        <listitem>
        <para>
          Displays menu without animation.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from bottom to top.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from top to bottom.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORIZONTAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested horizontal alignment before the requested vertical alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERTICAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested vertical alignment before the requested horizontal alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RECURSE</term>
        <listitem>
        <para>
          Used to display a menu when another menu is already displayed. This is intended to support context menus
          within a menu.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LAYOUTRTL</term>
        <listitem>
        <para>
          Requires <link linkend="ovvComctl32">Common Control Library</link> version 6.0 or later. Use right to left
          text layout. By default left to right text layout is used.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>bothButtons [optional]</term>
    <listitem>
    <para>
      If true, the user can use either the right or the left buttons to select a menu item. If false only the left
      button can be used. The defualt if omitted is false.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>excludeRect [optional]</term>
    <listitem>
    <para>
      A <link linkend="clsRect">Rect</link> object that specifies an area of the screen the menu should not overlap.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success and <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">show</emphasis> and the <link linkend="mthTrack">track</link> methods are both used to
    display a shortcut menu. The only difference is that when the <emphasis role="italic">show</emphasis> method is
    used, a menu command event is generated when the user selects a menu command item, but the <emphasis
    role="italic">track</emphasis> method directly returns the ID of the menu item selected.
  </para>
  <para>
    For any animation to occur, the System Parameters Information menu animation must be on. (<link
    linkend="clsSPI">SPI</link> class, <link linkend="atrMenuAnimation">menuAnimation</link> attribute.) In addition,
    all the animation flags, except NOANIMATION, are ignored if menu fade animation is on. (<link
    linkend="clsSPI">SPI</link> class, <link linkend="atrMenuFade">menuFade</link> attribute.)
  </para>
  <para>
    Microsoft says that it is essential that the System Metric, menu drop alignment (<link linkend="clsSM">SM</link>
    class, <link linkend="atrMenuDropAlignment">menuAnimation</link> attribute,) be checked to determine the correct
    horizontal alignment flag (LEFT or RIGHT) and/or horizontal animation direction flag (HORPOSANIMATION or
    HORNEGANIMATION) to use. The say it is essential for creating the optimal user experience, especially when
    developing Microsoft Tablet PC applications.
  </para>
  <para>
    Microsoft also notes that to display a context menu for a notification icon, the current window must be the
    foreground window before invoking the <emphasis role="italic">show</emphasis> or <link
    linkend="mthTrack">track</link> methods. Otherwise, the menu will not disappear when the user clicks outside of the
    menu or the window that created the menu (if it is visible).
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_HANDLE (1400)</term>
      <listitem>
      <para>
        Invalid window handle. <emphasis role="bold">Meaning:</emphasis> The window handle for the dialog could not be
        obtained.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis> This menu has been destroyed, or is no longer
        valid for some reason.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument was specified, but the object is not a <link
        linkend="chpDialogObject">dialog</link> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a context menu:
<programlisting>
<![CDATA[

  pos = .Point~new(x, y)

  ret = dlgPopup~show(pos, self)
  if ret == -1 then do
    say 'dlgPopup~show() failed SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end

  return 0
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::show() -->

<section id="mthTrack"><title>track</title>
<indexterm><primary>track</primary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>track</secondary></indexterm>
<programlisting>
<![CDATA[
>>--track(--p--+-------+--+--------+--+--------------+--+---------------+--)---><
               +-,-dlg-+  +-,-opts-+  +-,-bothButons-+  +-,-excludeRect-+
]]>
</programlisting>

<para>
  Displays a contex menu and returns the menu ID that the user has selected.  When the user selects an item, <emphasis
  role="italic">no</emphasis> menu <link linkend="sctMenuCommandEvents">command</link> event notification is generated.
  If the user cancels the menu 0 is returned.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>p [required]</term>
    <listitem>
    <para>
      A <link linkend="clsPoint">Point</link> object specifying the location for the shortcut menu, in <link
      linkend="defScreenCoordinates">screen</link> co-ordinates.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      The Rexx dialog object that the menu should be assigned to. If the menu has already been assigned an owner dialog
      this argument can be omitted. If there is no already assigned dialog, this argument is required. Any menu
      displayed on the screen is required by the operating system to have an assigned dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, specifying additional options for the shortcut
      menu, case is not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>LEFT           </member>
        <member>HCENTER        </member>
        <member>RIGHT          </member>
        <member>TOP            </member>
        <member>VCENTER        </member>
        <member>BOTTOM         </member>
        <member>HORNEGANIMATION</member>
        <member>HORPOSANIMATION</member>
        <member>NOANIMATION    </member>
        <member>VERNEGANIMATION</member>
        <member>VERPOSANIMATION</member>
        <member>HORIZONTAL     </member>
        <member>VERTICAL       </member>
        <member>RECURSE        </member>
        <member>LAYOUTRTL      </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>LEFT</term>
        <listitem>
        <para>
          Centers the shortcut menu horizontally relative to the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HCENTER</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its left side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RIGHT</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its right side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the LEFT, HCENTER, or RIGHT keywords. RIGHT is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TOP</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its top side is aligned with the Y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VCENTER</term>
        <listitem>
        <para>
          Centers the shortcut menu vertically relative to the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>BOTTOM</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its bottom side is aligned with the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the TOP, VCENTER, or BOTTOM keywords. BOTTOM is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from right to left.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from left to right.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOANIMATION</term>
        <listitem>
        <para>
          Displays menu without animation.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from bottom to top.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from top to bottom.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORIZONTAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested horizontal alignment before the requested vertical alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERTICAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested vertical alignment before the requested horizontal alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RECURSE</term>
        <listitem>
        <para>
          Used to display a menu when another menu is already displayed. This is intended to support context menus
          within a menu.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LAYOUTRTL</term>
        <listitem>
        <para>
          Requires <link linkend="ovvComctl32">Common Control Library</link> version 6.0 or later. Use right to left
          text layout. By default left to right text layout is used.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>bothButtons [optional]</term>
    <listitem>
    <para>
      If true, the user can use either the right or the left buttons to select a menu item. If false only the left
      button can be used. The defualt if omitted is false.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>excludeRect [optional]</term>
    <listitem>
    <para>
      A <link linkend="clsRect">Rect</link> object that specifies an area of the screen the menu should not overlap.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a non-negative number on success, -1 on error.  On success, the return is either 0, meaning the user
    canceled the menu, or the id of the menu item selected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">track</emphasis> and the <link linkend="mthShowClsPopupMenu">show</link> methods are both used
    to display a shortcut menu. The only difference is that when the <emphasis role="italic">show</emphasis> method is
    used, a menu command event is generated when the user selects a menu command item and when the <emphasis
    role="italic">track</emphasis> method directly returns the ID of the menu item selected.
  </para>
  <para>
    For any animation to occur, the System Parameters Information menu animation must be on. (<link
    linkend="clsSPI">SPI</link> class, <link linkend="atrMenuAnimation">menuAnimation</link> attribute.) In addition,
    all the animation flags, except NOANIMATION, are ignored if menu fade animation is on. (<link
    linkend="clsSPI">SPI</link> class, <link linkend="atrMenuFade">menuFade</link> attribute.)
  </para>
  <para>
    Microsoft says that it is essential that the System Metric, menu drop alignment (<link linkend="clsSM">SM</link>
    class, <link linkend="atrMenuDropAlignment">menuAnimation</link> attribute,) be checked to determine the correct
    horizontal alignment flag (LEFT or RIGHT) and/or horizontal animation direction flag (HORPOSANIMATION or
    HORNEGANIMATION) to use. The say it is essential for creating the optimal user experience, especially when
    developing Microsoft Tablet PC applications.
  </para>
  <para>
    Microsoft also notes that to display a context menu for a notification icon, the current window must be the
    foreground window before invoking the <emphasis role="italic">show</emphasis> or <link
    linkend="mthTrack">track</link> methods. Otherwise, the menu will not disappear when the user clicks outside of the
    menu or the window that created the menu (if it is visible).
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_HANDLE (1400)</term>
      <listitem>
      <para>
        Invalid window handle. <emphasis role="bold">Meaning:</emphasis> The window handle for the dialog could not be
        obtained.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis> This menu has been destroyed, or is no longer
        valid for some reason.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument was specified, but the object is not a <link
        linkend="chpDialogObject">dialog</link> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a context menu using the <emphasis role="italic">track</emphasis> method:
<programlisting>
<![CDATA[

  pos = .Point~new(x, y)

  id = dlgPopup~track(pos, self)
  if id == -1 then do
    say 'dlgPopup~track() failed SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end
  else do
    return self~doMenuCommand(ret
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::track() -->

</section>  <!-- End PopupMenu class -->

<section id="clsSystemMenu"><title>SystemMenu Class</title>
<indexterm><primary>SystemMenu class</primary></indexterm>
<para>
  The System menu is also known as the <emphasis role="italic">Window</emphasis> or <emphasis
  role="italic">Control</emphasis> menu. The System menu is normally defined and managed completely by the operating
  system. It is a pop-up menu that the user can open by clicking on the application icon in the title bar, or by right
  clicking anywhere on the title bar. The <computeroutput>SystemMenu</computeroutput> class provides methods for the
  programmer to work with and manipulate the Windows System menu.
</para>
<para>
  The OS provides a standard set of menu items on the System menu that the user can choose to size or move a window,
  close a window, etc..  Menu items can be added, removed, and modified, but most applications just leave the System
  menu alone. A dialog window can have a System menu. For normal windows it is unusual to not have a System menu, but
  many simple dialogs do not use a System menu.
</para>
<para>
  When a user selects a System menu item an <link linkend="ovvEvents">event</link> notification is sent to the owner
  window of the menu. However, most applications don't process the notification, but rather let the OS handle the
  notification with the default processing. The ooDialog programmer can connect the event notification to a method in
  her Rexx dialog in the same manner as other event notifications are connected. If the programmer adds menu command
  items to the System menu, the the event notification for the item should be connected and processed by the
  application.
</para>

<section id="sctMethodsSystemMenu"><title>Method Table</title>
<para>
  The following table lists the constant, class, attribute, and instance methods of the SystemMenu.
<table id="tblMethodsSystemMenu" frame="all"> <title>Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1.80in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="sctSystemMenuConstantMethods">Constant Methods</link></entry>
<entry>The SystemMenu object provides a number of <emphasis role="italic">constant</emphasis> values through the <computeroutput>::constant</computeroutput>directive.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="mthNewClsSystemMenu">new (Class)</link></entry>
<entry>Instantiates and returns a new system menu object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="mthConnectAllCommandEventsClsSystemMenu">connectAllCommandEvents</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthConnectCommandEventClsSystemMenu">connectCommandEvent</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthConnectSomeCommandEventsClsSystemMenu">connectSomeCommandEvents</link></entry>
<entry>.</entry>
</row>
<row>
<entry><link linkend="mthRevert">revert</link></entry>
<entry>.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="sctSystemMenuConstantMethods"><title>Constant Methods</title>
<indexterm><primary>constant methods</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>constant methods</secondary></indexterm>
<para>
  The <computeroutput>SystemMenu</computeroutput> object provides a number of <emphasis
  role="italic">constant</emphasis> values through the use of the <computeroutput>::constant</computeroutput> directive.
  The constants are listed and documented in this section. These constants are the <emphasis role="italic">menu item
  <link linkend="sctMenuItemIDs">identifiers</link></emphasis> for all System menu command items.
</para>
<para>
  Recall that the constant methods defined by the <computeroutput>::constant</computeroutput> directive are both class
  and instance methods of the class they are defined in. The constants listed here are defined in the
  <computeroutput>SystemMenu</computeroutput> class. Therefore to access the constant value, the programmer uses either
  the <computeroutput>SystemMenu</computeroutput> class object, or an instantiated system menu object.
</para>
<para>
  Note that for completeness, all the known system menu command items are defined and listed here. Microsoft does not
  explain what some of the command items are for. The constants can be used where ever a system menu command item
  identifier is needed. The constants provided by the system menu object are listed in the table below. The number in
  parentheses is the decimal value of the constant:
</para>
<table id="tblConstantsSystemMenu" frame="all"> <title>SystemMenu Object Constant Reference</title>
<tgroup cols="2">
<colspec colwidth="1.75in">
<thead>
<row>
<entry>Constant Symbol</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry>SC_ARRANGE</entry>
<entry>Not explained. (61712)</entry>
</row>
<row>
<entry>SC_CLOSE</entry>
<entry>Closes the window. (61536)</entry>
</row>
<row>
<entry>SC_CONTEXTHELP</entry>
<entry>Changes the cursor to a question mark with a pointer. If the user then clicks a control in the dialog box, the control receives a WM_HELP message. (61824)</entry>
</row>
<row>
<entry>SC_DEFAULT</entry>
<entry>Selects the default item; the user double-clicked the window menu. (61792)</entry>
</row>
<row>
<entry>SC_HOTKEY</entry>
<entry>Activates the window associated with the application-specified hot key. (61776)</entry>
</row>
<row>
<entry>SC_HSCROLL</entry>
<entry>Scrolls horizontally. (61568)</entry>
</row>
<row>
<entry>SC_KEYMENU</entry>
<entry>Retrieves the window menu as a result of a keystroke. (61696)</entry>
</row>
<row>
<entry>SC_MAXIMIZE</entry>
<entry>Maximizes the window. (61488)</entry>
</row>
<row>
<entry>SC_MINIMIZE</entry>
<entry>Minimizes the window.. (61472)</entry>
</row>
<row>
<entry>SC_MONITORPOWER</entry>
<entry>Sets the state of the display. This command supports devices that have power-saving features, such as a battery-powered personal computer. (61808)</entry>
</row>
<row>
<entry>SC_MOVE</entry>
<entry>Moves the window. (61456)</entry>
</row>
<row>
<entry>SC_MOUSEMENU</entry>
<entry>Retrieves the window menu as a result of a mouse click. (61584)</entry>
</row>
<row>
<entry>SC_NEXTWINDOW</entry>
<entry>Moves to the next window. (61504)</entry>
</row>
<row>
<entry>SC_PREVWINDOW</entry>
<entry>Moves to the previous window. (61520)</entry>
</row>
<row>
<entry>SC_RESTORE</entry>
<entry>Restores the window to its normal position and size. (61728)</entry>
</row>
<row>
<entry>SC_SCREENSAVE</entry>
<entry>Executes the screen saver application specified in the [boot] section of the System.ini file. (61760)</entry>
</row>
<row>
<entry>SC_SEPARATOR</entry>
<entry>ID of the menu separator item. (61455)</entry>
</row>
<row>
<entry>SC_SIZE</entry>
<entry>Sizes the window. (61440)</entry>
</row>
<row>
<entry>SC_TASKLIST</entry>
<entry>Activates the Start menu. (61744)</entry>
</row>
<row>
<entry>SC_VSCROLL</entry>
<entry>Scrolls vertically. (61552)</entry>
</row>
</tbody></tgroup>
</table>
</section>

<section id="mthNewClsSystemMenu"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>SystemMenu class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--dlg--)---------------------------------><

]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>SystemMenu</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>dlg</term>
    <listitem>
    <para>
      The Rexx dialog object that contains the System menu. To be explicit, the dialog must have a System menu. A
      <computeroutput>SystemMenu</computeroutput> object can not be initialized if the dialog does not already have a
      System menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>SystemMenu</computeroutput> objec.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The underlying menu object is a copy of the System menu of the specified dialog.  Once the copy is made, the System
    menu can be manipulated and modified just like other menu objects.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected. Raises errors for all failures. If no errors are raised,
    the system menu object is valid.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a new <computeroutput>SystemMenu</computeroutput> object and then adds a couple of menu
    items to the system menu:
<programlisting>
<![CDATA[

::method initDialog
  expose menu sysMenu

  -- Attach our menu bar to this dialog.
  if \ menu~attachTo(self) then self~error('Failed to attach menu')

  -- Get the system menu.
  sysMenu = .SystemMenu~new(self)

  -- Modify the system menu by inserting 3 menu items.  Each item is inserted
  -- before the fist item in the menu.  The .true arg specifies that the menu
  -- item ID (the first arg) is by position, rather than the default of a
  -- resource ID.
  sysMenu~insertSeparator(1, IDM_SYS_SEP1, .true)
  sysMenu~insertItem(1, IDM_SYS_REMOVE_EDIT, 'Remove Edit Menu', , , .true)
  sysMenu~insertItem(1, IDM_SYS_ADD_EDIT, 'Add Edit Menu', , , .true)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::new() -->

<section id="mthConnectAllCommandEventsClsSystemMenu"><title>connectAllCommandEvents</title>
<indexterm><primary>connectAllCommandEvents</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>connectAllCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectAllCommandEvents(--+-------+--+-------+--)-----------><
                              +--mth--+  +-,-dlg-+
]]>
</programlisting>

<para>
  Connects every command item in the system menu to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object.  The default is to connect the command
      items to the owner dialog of this menu. Since <computeroutput>SystemMenu</computeroutput> objects already have an
      owner dialog, there is no need to use this argument.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog <link
        linkend="chpDialogObject">dialog</link> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects every menu command item in the system menu to the <emphasis
    role="italic">onMenuSelect</emphasis> method in the dialog:
<programlisting>
<![CDATA[

::method connectSystemMenu unguarded private
  use strict arg sysMenu

  if \ sysMenu~connectAllCommandEvents(onMenuSelect) then self~error('Connect All Items Failed')

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::connectAllCommandEvents() -->

<section id="mthConnectCommandEventClsSystemMenu"><title>connectCommandEvent</title>
<indexterm><primary>connectCommandEvent</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>connectCommandEvent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectCommandEvent(--id--,--methodName--+--------+--)---------------------><
                                             +-,-dlg--+
]]>
</programlisting>

<para>
  Connects a system menu command item <link linkend="ovvEvents">event</link> notification with a method in a Rexx
  dialog. The notification is sent to the Windows dialog when a command item in a system menu is selected by the user.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the menu item, may be <link linkend="itmMenuSymbolicIDs">symbolic</link> or numeric. The
        <link linkend="sctSystemMenuConstantMethods">constants</link> provided by the
        <computeroutput>SystemMenu</computeroutput> class can be used for the default items in a system menu.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>methodName [required]</term>
      <listitem>
      <para>
        The name of the method in the Rexx dialog to connect the notification to. This can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>dlg [optional]</term>
      <listitem>
      <para>
        A Rexx dialog to connect the notification to. By default, the notification is is connected to the Rexx dialog that
        the menu is <link linkend="mthAttachTo">attached</link> or <link linkend="mthAssignTo">assinged</link> to. If
        omitted and there is no assigned or attached dialog, no connection is made and the <link
        linkend="dotSystemErrorCode">.systemErrorCode</link> is set as described in the Details section. (To connect a
        menu item command event, there must be a dialog to connect it to.)
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, otherwise <computeroutput>.false</computeroutput>. If
    there is an error, the <computeroutput>.systemErrorCode</computeroutput> is set as described in the Details section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using the <emphasis role="italic">connectCommandEvent</emphasis> method to connect menu command events, the
    programmer must use a menu item <link linkend="sctMenuItemIDs">identifier</link>, not a menu item <emphasis
    role="italic">position</emphasis> identifier.
  </para>
  <para>
    The <emphasis role="italic">connectCommandEvent</emphasis> method is used for all types of menus. However, the
    programmer should be aware of the differences in coding event <link
    linkend="sctMenuCommandEventHandlers">handlers</link> for <computeroutput>SystemMenu</computeroutput> events and
    other types of menus. See the <link linkend="sctSystemMenuCommandEventHandler">section</link> exaplaining the event
    handler for system menu command events.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_PARAMETER (87)</emphasis></term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">methodName</emphasis> argument can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::connectCommandEvent() -->
r
<section id="mthRevert"><title>revert</title>
<indexterm><primary>revert</primary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>revert</secondary></indexterm>
<programlisting>
<![CDATA[
>>--revert---------------------------------------><

]]>
</programlisting>

<para>
  Reverts the system menu for the dialog back to the standard system menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a <computeroutput>SystemMenu</computeroutput> object is instantiated, it receives a copy of the system menu
    for the dialog. (The operating system maintains the standard system menu.) This method reverses that process. The
    operating system removes the copied system menu and replaces it with the standard system menu.
  </para>
  <para>
    This object will then no loger be valid.  <emphasis role="italic">Note</emphasis> however that any of the
    pre-defined System Command menu items that were connected to methods, will remain connected. Currently in ooDialog
    there is no way to 'unconnect' a method connection once it is made.
  </para>
  <para>
    The operating system will only revert back to the standard system menu. A dialog that does not have minimize and
    maximize buttons is originally given a standard system menu, where the operating system has removed the menu items
    that are not applicable. Namely, the Restore, Size, Maximize and Minimize menu items.
  </para>
  <para>
    When the operating system reverts back to the standard system menu on these dialogs, it does not remove these menu
    items. There is nothing the programmer can do about this, because only the operating system has access to the
    standard system menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example reverts the system menu for the dialog back to the standard system menu.
<programlisting>
<![CDATA[

::method onRevert
  expose sysMenu

  if \ sysMenu~revert then say 'revert() failed' .SystemErrorCode SysGetErrortext(.SystemErrorCode)
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::revert() -->

<section id="mthConnectSomeCommandEventsClsSystemMenu"><title>connectSomeCommandEvents</title>
<indexterm><primary>connectSomeCommandEvents</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>connectSomeCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectSomeCommandEvents(--ids-+-------+-+--------------+-+-------+--)-----><
                                   +-,-mth-+ +-,-byPosition-+ +-,-dlg-+
]]>
</programlisting>

<para>
  Connects a collection of menu command items to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>ids [required]</term>
    <listitem>
    <para>
      A <computeroutput>Collection</computeroutput> object containing the menu item <link
      linkend="sctMenuItemIDs">IDs</link> to connect.  The IDs can be by position IDs or resource IDs,
      depending on the value of the <emphasis role="italic">byPosition</emphasis> argument. However, they must be all
      the same type, all resource IDs or all by position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the IDS are by positional IDs, otherwise the are resource IDs. The default is false, they are resource
      IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object.  The default is to connect the command
      items to the owner dialog of this menu. Since <computeroutput>SystemMenu</computeroutput> objects already have an
      owner dialog, there is no need to use this argument.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">ids</emphasis> argument can be any ooRexx collection with a <emphasis
    role="italic">makeArray</emphasis> method that returns an array whose <emphasis role="italic">items</emphasis> are
    the menu item IDs to connnect.
  </para>
  <para>
    This method quits when an error is detected. This implies that on an error return some menu items may have been
    connected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.systemErrorCode</link> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_PARAMETER (87)</term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> One or more of the specified item IDs is
        not a menu command item.  Or the msg argument was used, but it is the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog <link
        linkend="chpDialogObject">dialog</link> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects the Close, Size, and Move command items in the System menu to 3 methods in the dialog. Note
    that those methods will be: closeAltF4(), size(), and move()
<programlisting>
<![CDATA[

::method systemMenuConnectItems
  expose sysMenu
  use strict arg

  ids = .array~of(self~SC_CLOSE, self~SC_SIZE, self~SC_MOVE)

  if \ sysMenu~connectSomeCommandEvents(ids) then self~error('Connect Some Items Failed')


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::connectSomeCommandEvents() -->

</section>  <!-- End SystemMenu class -->

</chapter>
