<!--#########################################################################
    #
    # Description: Open Object Rexx: OODialog Reference SGML file.
    #
    # Copyright (c) 2005-2010, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->


<section id="sctConnectingEvents"><title>Connecting Events</title>
<indexterm><primary>connecting events</primary></indexterm>
<indexterm><primary>dialog object</primary>
<secondary>connect event methods</secondary></indexterm>
<indexterm><primary>connect event methods</primary>
<secondary>dialog object</secondary></indexterm>
<para>
  The dialog object methods that create a connection between a <link linkend="ovvEvents">Windows event</link> and a
  method of the Rexx dialog object are all implemented in the <link
  linkend="clsEventNotification">EventNotification</link> class. These methods are documented here.
</para>

<section id="mthConnectResize"><title>ConnectResize</title>
<indexterm><primary>ConnectResize</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectResize(--msgToRaise--)-------------------><


]]>
</programlisting>

<para>The ConnectResize method connects a dialog resize
event with a method. It is called each time the size of the dialog is changed.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent each time the dialog is resized. Provide
a method with a matching name.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>This method does not return a value.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example 1:</emphasis></term>
<listitem><para>

<programlisting>
<![CDATA[
  dlg = .ResizingDialog~new
  dlg~createCenter(100, 60, "Resize Me", "THICKFRAME")
  dlg~execute("SHOWTOP")

::requires 'ooDialog.cls'

::class 'ResizingDialog' subclass UserDialog

::method init
  forward class (super) continue

  self~connectResize("onSize")

::method onSize
  use arg sizeEvent, sizeInfo

  -- Wait until the last size event message, in a series of messages, arrives.
  msg = self~peekDialogMessage
  if msg~left(6) = "ONSIZE" then return

  -- sizeInfo contains information about the new width and height in pixels.
  w = .DlgUtil~loWord(sizeinfo) / self~factorX
  h = .DlgUtil~hiWord(sizeinfo) / self~factorY
  say "New width=" w ", new height=" h

]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example 2:</emphasis></term>
<listitem><para>This example is pulled from the <link
linkend="exampleFileViewer">File Viewer</link> example at the end of the
&quot;Appearance and Behavior Methods&quot; section. A complete working example
is presented there that uses a number of the base dialog methods.

<programlisting>
<![CDATA[

::method defineDialog
  expose wasMinimized

  wasMinimized = .false
  style = "VSCROLL HSCROLL MULTILINE READONLY"
  self~addEntryLine(IDC_MULTILINE, "cEntry", 0, 0, 170, 180, style)
  self~connectResize("onSize")
  ...

/* The first arg, sizeEvent, is a flag that the OS sends specifying the type of
 * size event.  We are only interested in these 3 flags:
 *
 * SIZE_RESTORED   = 0
 * SIZE_MINIMIZED  = 1
 * SIZE_MAXIMIZED  = 2
 */
::method onSize
  expose wasMinimized
  use arg sizeEvent sizeInfo

  if sizeEvent = 1 then wasMinimized = .true

  if sizeEvent = 0 |  sizeEvent = 2 then do
    if \ wasMinimized then self~resizeEditControl
    wasMinimized = .false
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods
are defined, use Init as the place for this connection - but not before init:super has been called.
</para></note>
</section>

<section id="connectmove"><title>ConnectMove</title>
<indexterm><primary>ConnectMove</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectMove(--msgToRaise--)---------------------><


]]>
</programlisting>

<para>The ConnectMove method connects a dialog move event
with a method. It is called each time the position of the dialog is changed.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent each time the dialog is moved. Provide
a method with a matching name.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>This method does not return a value.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>

<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method init
  forward class (super) continue

  self~connectMove(onMove)

::method onMove
  use arg unUsed, posInfo

  -- Look at our message queue to see if the next message in the queue is also
  -- onMove.  If so, just return.
  msg = self~peekDialogMessage
  if msg~left(6) = "ONMOVE" then return

  -- Now, we should be done moving, print out where we are.
  x = .DlgUtil~loWord(posInfo)
  y = .DlgUtil~hiWord(posInfo)
  say 'At coordinate (' x',' y' ) on the screen. (In pixels.)'

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods
are defined, use Init as the place for this connection - but not before init:super has been called.
</para></note>
</section>

<section id="connectposchanged"><title>ConnectPosChanged</title>
<indexterm><primary>ConnectPosChanged</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectPosChanged(--msgToRaise--)---------------><


]]>
</programlisting>

<para>The ConnectPosChanged method connects a change
regarding the dialog coordinates with a method. It is called each time the
size, position, or place in the Z order of the dialog is changed.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent each time the coordinates of the dialog
are changed. Provide a method with a matching name.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>This method does not return a value.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>

<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method Init
  self~init:super(...)
  self~ConnectPosChanged("OnNewPos")

::method OnNewPos
  say "The new rectangle is" self~GetWindowRect(self~DlgHandle)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods
are defined, use Init as the place for this connection - but not before init:super has been called.
</para></note>
</section>

<section id="connectmousecapture"><title>ConnectMouseCapture</title>
<indexterm><primary>ConnectMouseCapture</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectMouseCapture(--msgToRaise--)-------------><


]]>
</programlisting>

<para>The ConnectMouseCapture method connects a method
with the lose-mouse-capture event. It is called each time the dialog loses
the mouse capture. This can happen, for example, when you move a dialog with
the mouse and release the left mouse button.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent each time the mouse capture is lost in
the dialog. Provide a method with a matching name.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>This method does not return a value.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthConnectHelp"><title>ConnectHelp</title>
<indexterm><primary>ConnectHelp</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectHelp(--msgToRaise--)-----------------------><


]]>
</programlisting>

<para>The <computeroutput>ConnectHelp</computeroutput> method connects the
Windows Help event with a method in the dialog class. The Windows Help event
occurs when the user presses the F1 key.  (Only the Help events generated when
the dialog is the active window are connected.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The name of the method that is to be invoked.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>An (internal) error prevented the message from being connected
to a method.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Event Method Arguments
</emphasis></term>
<listitem><para>The ooDialog method connected to the Help event will receive the
following four arguments in the order listed:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The resource ID of the dialog, dialog control, or menu item that
had the focus when the F1 key was pressed.
</para></listitem></varlistentry>
<varlistentry><term>type</term>
<listitem><para>Specifies if the ID in argument 1 was from a window (a dialog or
dialog control) or from a menu item.  This argument will either be
<computeroutput>WINDOW</computeroutput> or <computeroutput>MENU
</computeroutput>.
</para></listitem></varlistentry>
<varlistentry><term>mouseX</term>
<listitem><para>The x coordinate of the mouse at the time the F1 key was
pressed.  This value is an absolute screen coordinate (pixel) and note that the
mouse will not necessarily be over the dialog.
</para></listitem></varlistentry>
<varlistentry><term>mouseY</term>
<listitem><para>The y coordinate of the mouse at the time the F1 key was
pressed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>

<programlisting>
<![CDATA[

::method Init
    self~init:super
    ...
    self~connectResize(onResize)
    self~connectHelp(onHelp)
    ...

::method onHelp
    use arg id, type, mouseX, mouseY
    if type == "MENU" then w = 'Menu id' id; else w = 'Dialog id' id
    say "Help request:"
    say " " w
    say "  Mouse position x:" mouseX "y:" mouseY

/* As the user presses the F1 key at various times when the dialog has the focus
 * the output might be as follows:
 */

Help request:
  Dialog id 12
  Mouse position x: 420 y: 106
Help request:
  Menu id 60
  Mouse position x: 204 y: 93
Help request:
  Menu id 65
  Mouse position x: 203 y: 166
Help request:
  Dialog id 14
  Mouse position x: 218 y: 410
Help request:
  Dialog id 80
  Mouse position x: 387 y: 462
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthConnectKeyPressBaseDialog"><title>ConnectKeyPress</title>
<indexterm><primary>ConnectKeyPress</primary>
<secondary>BaseDialog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectKeyPress(--msgToRaise--,--keys-+------------+--)----><
                                                     +-,--filter--+

]]>
</programlisting>

<para>The <computeroutput>ConnectKeyPress</computeroutput> method connects a key
press event with a method in the dialog class. A single key or multiple keys can
be connected to the same method.  Multiple methods can be connected for key
press events, but only 1 method can be connected to any single key.
</para>
<para>The underlying Windows dialog must exist before this method can be used.
That means it can be used in <link linkend="mthInitDialog">InitDialog</link> or any
time thereafter.  There is a maximum limit of 63 methods, per dialog, that can
be connected to key press events.  Connections can be removed (see the <link
linkend="mthDisconnectKeyPressBaseDialog">DisconnectKeyPress</link> method) if
there is no longer a need for a notification of a key press.
</para>
<para>A similar <link linkend="mthConnectKeyPressDialogcontrol">method</link>
is a member of the <computeroutput>DialogControl</computeroutput> class.  It is
important to note this distinction between the two methods.  The method of the
<computeroutput>BaseDialog</computeroutput> (this method) will capture any key
press event when the dialog is the active window.  The method of the
<computeroutput>DialogControl</computeroutput> class will only capture a key
press when the control has the keyboard focus.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The name of the method that is to be invoked when the key press
event happens.
</para></listitem></varlistentry>
<varlistentry><term>keys</term>
<listitem><para>The key (or keys) for which the key press event is to be
connected. A single key or multiple keys can be specified. A range of keys can
be used.  Each single key or range of keys is separated by a comma.  A range of
keyes is denoted by using the dash character &quot;-&quot;.  White space within
the <computeroutput>keys</computeroutput> argument is ignored.
</para>
<para>The keys are specified by the numeric value defined by Microsoft for its
virtual key set.  These numeric values are 0 through 255, although both 0 and
255 are not used.  The <link linkend="clsVirtualKeyCodes">VirtualKeyCodes</link>
class can be used to make a program more readable.
</para>
<note><title>Note</title>
<para>The programmer can use the <link linkend="defWindowsDoc">Windows
documentation</link> and <link linkend="defPlatformSDK">Platform SDK</link> to
obtain the full list of the virtual key numbers.
</para></note>
<para>In addition there are a few keywords that can be used to specify some
common key ranges. These keywords are:
<variablelist>
<varlistentry><term>ALL</term>
<listitem><para>All keys.
</para></listitem></varlistentry>
<varlistentry><term>FKEYS</term>
<listitem><para>All Function keys, other than F1.  (In Windows the F1 key is the
help key and the <link linkend="mthConnectHelp">ConnectHelp</link> method should
be used for F1.)
</para></listitem></varlistentry>
<varlistentry><term>ALPHA</term>
<listitem><para>The keys A though Z.
</para></listitem></varlistentry>
<varlistentry><term>NUMERIC</term>
<listitem><para>The keys 0 through 9.  Note that these are the normal number
keys, not the keypad numbers on an enhanced keyboard.
</para></listitem></varlistentry>
<varlistentry><term>ALPHANUMERIC</term>
<listitem><para>The keys A through Z and 0 through 9.
</para></listitem></varlistentry>
</variablelist></para>
<note><title>Note</title><para>Case is insignificant for these keywords as is the
order of the keywords. A keyword not in the list will result in a return of -1.
However, if the argument contains other valid key tokens, those keys will be
connected to the method.  If there are no other valid key tokens, then no
connection is made.
</para></note></listitem></varlistentry>
<varlistentry><term>filter</term>
<listitem><para>A (simplistic) filter that is applied to the key press event for
the key(s) specified.  The filter is a string of keywords separated by blanks.
(Case is not significant, neither is the order of the words.  Any words other
than the specified keywords are ignored.) The possible keywords are:
<computeroutput>SHIFT, CONTROL, ALT, AND, NONE.</computeroutput>
</para>
<para>Shift, control, and alt specify that the corresponding key must be down at
the time of the key press event. These keywords are combined in a boolean
expression.  The default is an OR expression. If the AND keyword is present then
the boolean expression is an AND expression. If the NONE keyword is used, it
means that none of the shift, control, or alt keys can be down at the time of
the key press event.  (When NONE is used, all other words in the string are
ignored.)
</para>
<para> Some examples may make this more clear:
<programlisting>
<![CDATA[

::method initDialog

  -- Using the below, the onAltCD method would be invoked when the user types
  -- Alt-Shift-C or Alt-Shift-D.  But the method would not be invoked for Alt-C
  -- or Shift-D (or any other key press event.)

  keys = self~vCode('C') "," self~vCode('D')
  self~connectKeyPress(onAltCD, keys, "ALT AND SHIFT")

  -- The below would invoke the onAltCD method any time a C or a D was typed
  -- with either the Alt or the Control key down.  This would include Alt-C,
  -- Alt-Shift-C, Ctrl-Alt-Shift-C, etc..

  self~connectKeyPress(onAltCD, keys, "ALT CONTROL")

  -- The below would invoke the onAltCD method only when Alt-C or Alt-D was
  -- typed.

  self~connectKeyPress(onAltCD, keys, "ALT AND")

  -- The below would invoke the onF4 method only when the F4 key was pressed by
  -- itself. Alt-F4, Ctrl-F4, etc., would not invoke the method.

  self~connectKeyPress(onF4, self~vCode('F4'), "NONE")
]]>
</programlisting>

</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para> The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>A problem with one of the arguments, such as skipping a required
argument, using an incorrect format for the <computeroutput>keys
</computeroutput> or the <computeroutput>filter</computeroutput> arguments,
etc..  Note that it is possible to get a return of -1 but still have some keys
connected.  For instance in the following example the C and D keys would be
connected and the filter applied.  The &quot;"dog&quot;" token would result in
-1 being returned:
<programlisting>
<![CDATA[

  keys = self~vCode('C') ", dog," self~vCode('D')
  ret = self~connectKeyPress('onAltCD', keys, "ALT AND SHIFT")
  say 'Got a return of:' ret
  say "Have connection to onAltCD?" self~hasKeyPressConnection('onAltCD')

  -- The output would be:
  Got a return of: -1
  Have connection to onAltCD? 1

]]>
</programlisting>

</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The underlying mechanism in the Windows API that is used to
capture key events failed.
</para></listitem></varlistentry>
<varlistentry><term>-4</term>
<listitem><para>An (internal) problem with the dialog window.
</para></listitem></varlistentry>
<varlistentry><term>-5</term>
<listitem><para>Memory allocation error in the underlying Windows API.
</para></listitem></varlistentry>
<varlistentry><term>-6</term>
<listitem><para>The maximum number of connections has been reached.
</para></listitem></varlistentry>
<varlistentry><term>-7</term>
<listitem><para>The <computeroutput>msgToRaise</computeroutput> method is
already connected to a key down event for this dialog.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Event Method Arguments
</emphasis></term>
<listitem><para>The ooDialog method connected to the key press event will
receive the following five arguments in the order listed:
<variablelist>
<varlistentry><term>keyCode</term>
<listitem><para>The numeric code of the key pressed.
</para></listitem></varlistentry>
<varlistentry><term>shift</term>
<listitem><para>A boolean (true or false) that denotes whether a shift key
was down or up at the time of the key press.  It will be true if a shift key
was down and false if the shift key was not down.
</para></listitem></varlistentry>
<varlistentry><term>control</term>
<listitem><para>True if a control key was down at the time of the key press,
false if it was not.
</para></listitem></varlistentry>
<varlistentry><term>alt</term>
<listitem><para>True if an alt key was down at the time of the key press, false
if it was not.
</para></listitem></varlistentry>
<varlistentry><term>extraInfo</term>
<listitem><para>This argument is a string containing keywords.  It supplies
extra information about the keyboard state at the time of a key press event.
The string will contain some combination of these keywords
<variablelist>
<varlistentry><term>numOn</term>
<listitem><para>Num Lock was on at the time of the key press event.
</para></listitem></varlistentry>
<varlistentry><term>numOff</term>
<listitem><para>Num Lock was off.
</para></listitem></varlistentry>
<varlistentry><term>capsOn</term>
<listitem><para>Caps Lock was on at the time of the key press event.
</para></listitem></varlistentry>
<varlistentry><term>capsOff</term>
<listitem><para>Caps Lock was off.
</para></listitem></varlistentry>
<varlistentry><term>scrollOn</term>
<listitem><para>Scroll Lock was on at the time of the key press event.
</para></listitem></varlistentry>
<varlistentry><term>scrollOff</term>
<listitem><para>Scroll Lock was off.
</para></listitem></varlistentry>
<varlistentry><term>lShift</term>
<listitem><para>The left shift key was down at the time of the key press event.
</para></listitem></varlistentry>
<varlistentry><term>rShift</term>
<listitem><para>The right shift key was down.
</para></listitem></varlistentry>
<varlistentry><term>lControl</term>
<listitem><para>The left control key was down at the time of the key press
event.
</para></listitem></varlistentry>
<varlistentry><term>rControl</term>
<listitem><para>The right control key was down.
</para></listitem></varlistentry>
<varlistentry><term>lAlt</term>
<listitem><para>The left alt key was down at the time of the key press event.
</para></listitem></varlistentry>
<varlistentry><term>rAlt</term>
<listitem><para>The right alt key was down.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry id="connectKeyPressExample"><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a fictitious customer order
system.  As the user is filling out a customer order using the customer order
dialog, he has the F2 through F5 short cut keys available.  F2 brings up a
customer look up dialog.  F3 looks up info on the product number entered in an
edit control.  F4 resets the form by clearing all the fields.  F5 is used to
print out the finished invoice.
<programlisting>
<![CDATA[
::method initDialog

  ...

  -- Capture F2 key presses, but not Ctrl-F2 or Alt-F2, etc..
  self~connectKeyPress(onF2, self~vCode('F2'), "NONE")

  -- Same idea for F3, F4, and F5.  This uses the actual numeric value for the
  -- keys without bothering to use the VirtualKeyCodes class to translate.
  self~connectKeyPress(onF3, 114, "NONE")
  self~connectKeyPress(onF4, 115, "NONE")
  self~connectKeyPress(onF5, 116, "NONE")

  ...

::method onF2
  self~showCustomerLookupDialog

::method onF3

  prodNum = self~getEditControl(IDC_EDIT_PRODUCT)~getText
  if prodNum \== "" then self~showProductInfo(prodNum)

::method onF4
  self~resetAllFields

::method onF5
  self~printInvoice

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

</section>

<section id="mthConnectFKeyPressBaseDialog"><title>ConnectFKeyPress</title>
<indexterm><primary>ConnectFKeyPress</primary>
<secondary>BaseDialog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aDialogControl~ConnectFKeyPress(--msgToRaise--)-------------><


]]>
</programlisting>

<para>The <computeroutput>ConnectFKeyPress</computeroutput> method connects a
function key press to a method in the dialog instance.  This works for function
keys F2 through F24, without the shift, control, or alt keys also being pressed.
The underlying Windows dialog must exist before this method can be invoked.
This is a convenience method and is exactly equivalent to:
<programlisting>
<![CDATA[
::method initDialog
  ...
  keys = self~vCode('F2') "-" self~vCode('F24')
  self~connectKeyPress(msgToRaise, keys, "NONE")
]]>
</programlisting>
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The required argument is:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The method to be invoked for the F key press event.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para> The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The underlying mechanism in the Windows API that is used to
capture key events failed.
</para></listitem></varlistentry>
<varlistentry><term>-4</term>
<listitem><para>An (internal) problem with the dialog window.
</para></listitem></varlistentry>
<varlistentry><term>-5</term>
<listitem><para>Memory allocation error in the underlying Windows API.
</para></listitem></varlistentry>
<varlistentry><term>-6</term>
<listitem><para>The maximum number of connections has been reached.
</para></listitem></varlistentry>
<varlistentry><term>-7</term>
<listitem><para>The <computeroutput>msgToRaise</computeroutput> method is
already connected to a key down event for this dialog.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is a variation on the <link
linkend="connectKeyPressExample">example</link> shown for the <link
linkend="mthConnectKeyPressBaseDialog">ConnectKeyPress</link> method. It
connects all the function keys to the same method and then determines what
action to take by examining which key was pressed.
<programlisting>
<![CDATA[
::method initDialog

  ...

  -- Capture all function key presses.
  self~connectFKeyPress(onFKey)

  ...

::method onFKey
  use arg keyPressed

  select
    when self~keyName(keyPressed) == 'F2' then self~showCustomerLookupDialog

    when keyPressed = 114 then do
      prodNum = self~getEditControl(IDC_EDIT_PRODUCT)~getText
      if prodNum \== "" then self~showProductInfo(prodNum)
    end

    when keyPressed = 115 then self~resetAllFields
    when keyPressed = 116 then self~printInvoice

    otherwise do
      -- Not interested in any other function keys
      nop
    end
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthDisconnectKeyPressBaseDialog"><title>DisconnectKeyPress</title>
<indexterm><primary>DisconnectKeyPress</primary>
<secondary>BaseDialog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~DisconnectKeyPress(--+--------------+--)--------><
                                    +--methodName--+

]]>
</programlisting>

<para>The <computeroutput>DisconnectKeyPress</computeroutput> method disconnects
a key press event from a method that was previously connected using <link
linkend="mthConnectKeyPressBaseDialog">ConnectKeyPress</link>.  If no
method name is specified than all key press event connections are removed.
Otherwise, only the key press events connected to the specific method are
removed.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The single optional argument is:
<variablelist>
<varlistentry><term>methodName</term>
<listitem><para>If <computeroutput>methodName</computeroutput> is specified,
only the key press events connected to that method are disconnected.  If the
argument is omitted, then all key press events for the dialog will be
disconnected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The specified <computeroutput>methodName</computeroutput> is not
connected to any key press events for this dialog.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>This return code can only occur when removing the connection for
a single <computeroutput>methodName</computeroutput>.  It indicates that after
removing the connection, the underlying mechanism in the Windows API that
captures the key press events could not be re-initialized.  (It is doubtful this
error would ever occur.)
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is a variation on the <link
linkend="connectKeyPressExample">example</link> shown for the <link
linkend="mthConnectKeyPressBaseDialog">ConnectKeyPress</link> method. It builds
on the fictitious customer order system.  The F7 key saves the completed invoice
into the system and enters a different phase of the companies business process.
At this point (for whatever fictitious business reason) the fields can no longer
be cleared and the user is not allowed to look up customer or product
information.  But, the user may still need to print the invoice.  To prevent the
accidental press of the hot keys causing the wrong action, those key presses are
disconnected.
</para>
<para>To demonstrate how key press connections can be added and removed through
out the live time of the dialog, this example adds the F9 hot key.  F9 starts a
new order entry cycle and re-connects the hot keys used during the creation of
a customer invoice.  When the user then saves the next completed invoice, key
press connections are removed, when she starts a new invoice key press
connections are restored.  This cycle could continue though out the day without
the user ever closing the main dialog.
<programlisting>
<![CDATA[

::method initDialog

  ...

  -- Capture F2 key presses, but not Ctrl-F2 or Alt-F2, etc..
  self~connectKeyPress(onF2, self~vCode('F2'), "NONE")

  -- Same idea for F3, F4, F5, and F7.  This uses the actual numeric value for
  -- the keys without bothering to use the VirtualKeyCodes class to translate.
  self~connectKeyPress(onF3, 114, "NONE")
  self~connectKeyPress(onF4, 115, "NONE")
  self~connectKeyPress(onF5, 116, "NONE")
  self~connectKeyPress(onF7, 118, "NONE")
  self~connectKeyPress(onF9, 120, "NONE")

  ...

::method onF2
  self~showCustomerLookupDialog

::method onF3

  prodNum = self~getEditControl(IDC_EDIT_PRODUCT)~getText
  if prodNum \== "" then self~showProductInfo(prodNum)

::method onF4
  self~resetAllFields

::method onF5
  self~printInvoice

::method onF7

  self~saveToDataBase
  self~disconnectKeyPress(onF2)
  self~disconnectKeyPress(onF3)
  self~disconnectKeyPress(onF4)

::method onF9

  self~resetAllFields
  self~connectKeyPress(onF2, 112, "NONE")
  self~connectKeyPress(onF3, 114, "NONE")
  self~connectKeyPress(onF4, 115, "NONE")

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

</section>

<section id="mthHasKeyPressConnectionBaseDialog"><title>HasKeyPressConnection</title>
<indexterm><primary>HasKeyPressConnection</primary>
<secondary>BaseDialog class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~HasKeyPressConnection(--+--------------+--)--------><
                                       +--methodName--+

]]>
</programlisting>

<para>This method is used to query if a connection to a key press event already
exists.  It returns true or false so it can always be used in a boolean
expression.  If no argument is specified the method returns true if any key
press events have been connected for the dialog and false otherwise.  When the
<computeroutput>methodName</computeroutput> argument is used, the query is only
if there are key press events connected to the specified method.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The single optional argument is:
<variablelist>
<varlistentry><term>methodName</term>
<listitem><para>Query if any key press events are connected to this method.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The returned value is always <computeroutput>true
</computeroutput> or <computeroutput>false</computeroutput>.
<variablelist>
<varlistentry><term>true</term>
<listitem><para>A connection exists.
</para></listitem></varlistentry>
<varlistentry><term>false</term>
<listitem><para>No connection exists.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example could come from a dialog where the user
has the option to use hot keys or not.  When the reset button is pushed the
state of the dialog fields are reset.  The hot keys enabled check box is
set to reflect whether hot keys are currently enabled or not.
<programlisting>
<![CDATA[

::method defineDialog

  ...
  self~addCheckBox(IDC_CHECK_FKEYSENABlED, , 30, 60, , , "Hot Keys Enabled")
  ...
  self~addButton(IDC_PB_RESET, 60, 135, 45, 15, "Reset", onReset)
  ...

::method onReset

  ...
  if self~hasKeyPressConnection then
    self~getCheckControl(IDC_CHECK_FKEYSENABlED)~check
  else
    self~getCheckControl(IDC_CHECK_FKEYSENABlED)~uncheck
  ...

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>


</section>

<section id="mthConnectCommandEvents"><title>connectCommandEvents</title>
<indexterm><primary>connectCommandEvents</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>connectCommandEvents</secondary></indexterm>
<indexterm><primary>EventNotification</primary><secondary>connectCommandEvents</secondary></indexterm>

<programlisting>
<![CDATA[
>>--connectCommandEvents(--id--,--methodName--)----------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">connectCommandEvents</emphasis> method connects a Rexx dialog method to the command <link
  linkend="ovvEvents">event</link> notifications sent by a Windows dialog control to its parent dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      The <emphasis role="italic">connectCommandEvents</emphasis> method is a member of the <link
      linkend="clsEventNotification">EventNotification</link> mixin class.
    </para>
  <para>
    Syntax errors are raised when incorrect usage is detected.
  </para>
  <para>
    If the programmer does not provide a matching method in the Rexx dialog, a syntax condition will be raised if any
    command events happen.
  </para>
  <para>
    In Windows itself, command events are sent to the parent dialog using the WM_COMMAND message.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the dialog control, may be symbolic or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName [required]</term>
    <listitem>
    <para>
      The name of the method to be invoked in the Rexx dialog object each time a command event occurs in the dialog
      control. The method name can not be the empty string.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <variablelist>
    <varlistentry><term>-1</term>
    <listitem>
    <para>
      The specified symbolic ID could not be resolved.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>0</term>
    <listitem>
    <para>
      No error.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>1</term>
    <listitem>
    <para>
      An error. Most likely, either the message table is full, or the interpreter is out of usable memory.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Two arguments are sent to the connected method.  The first contains the notification code in the high word and the
    ID of the control in the low word. The second argument is the window handle of the control.
  </para>
  <para>
    The number of different notification codes and the meanings of the notifications are dependent on the type of dialog
    control specified. Therefore, it is more advisable to use the specific connectXXXEvent() method for the control.
    Such as the <link linkend="mthConnectListBoxEvent">connectListBoxEvent</link>() method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects a list box command event notifications to the <emphasis role="italic">onCommand</emphasis>()
    method of the dialog. Note that the notification code 1 corresponds to the list box SELCHANGE event, 4 is the
    SETFOCUS, and 5 is KILLFOCUS events.
<programlisting>
<![CDATA[

::method initDialog
  ...
  self~connectCommandEvents(IDC_LB_FILES, onCommand)

::method onCommand
  use arg cmdCode, hwnd
  say 'cmdCode:                  ' cmdCode
  say 'hwnd:                     ' hwnd
  say 'hi word notification code:' .DlgUtil~hiWord(cmdCode)
  say 'lo word resource ID:      ' .DlgUtil~loWord(cmdCode)
  say '(List box resource ID)    ' self~constDir[IDC_LB_FILES]
  say

/* Output might be:
cmdCode:                   263147
hwnd:                      1772350
hi word notification code: 4
lo word resource ID:       1003
(List box resource ID)     1003

cmdCode:                   66539
hwnd:                      1772350
hi word notification code: 1
lo word resource ID:       1003
(List box resource ID)     1003

cmdCode:                   328683
hwnd:                      1772350
hi word notification code: 5
lo word resource ID:       1003
(List box resource ID)     1003
*/

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="h111111"><title>ConnectDraw</title>
<indexterm><primary>ConnectDraw</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectDraw--(--id--+---------------+--)--------><
                                   +-,--msgToRaise-+


]]>
</programlisting>

<para>The ConnectDraw method connects the WM_DRAWITEM
event with a method. A WM_DRAWITEM message is sent for owner-drawn buttons
each time they are to be redrawn. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the dialog control. If the ID is omitted, all drawing events
of all owner-drawn buttons are routed to the method.
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent each time the WM_DRAWITEM event occurs.
Provide a method with the matching name. You can use <computeroutput>USE ARG ID</computeroutput> to
retrieve the ID of the item that is to be redrawn.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>-1</term>
<listitem><para>The specified symbolic ID could not be resolved.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>No error.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="h000132"><title>ConnectList</title>
<indexterm><primary>ConnectList</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectList(--id--+---------------+--)----------><
                                 +-,--msgToRaise-+


]]>
</programlisting>

<para>The ConnectList method connects a list box, multiple
list box, or combo box with a method. The method is called each time the user
selects a new item from the list. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the dialog element.
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent each time the button is pressed. Provide
a method with the matching name.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>-1</term>
<listitem><para>The specified symbolic ID could not be resolved.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>No error.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="clldcm"><title>ConnectListLeftDoubleClick</title>
<indexterm><primary>ConnectListLeftDoubleClick</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectListLeftDoubleClick(--id--,--msgToRaise--)-><


]]>
</programlisting>

<para>The ConnectListLeftDoubleClick method combines
a left double-click within the list box with a method. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the list box.
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The name of the method that is to be called.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>-1</term>
<listitem><para>The specified symbolic ID could not be resolved.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>No error.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="h000802"><title>ConnectScrollBar</title>
<indexterm><primary>ConnectScrollBar</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectScrollBar(--id--,--msgWhenUp--,--msgWhenDown-->

>--+--------------------------------------------------------------------+-->
   +-,--+-------------+--+--------------------------------------------+-+
        +-msgWhenDrag-+  +-,--+-----+--+----------------------------+-+
                              +-min-+  +-,--+-----+--+------------+-+
                                            +-max-+  +-,--+-----+-+
                                                          +-pos-+

>--+----------------------------------------------------------+-->
   +-,--+----------+--+-------------------------------------+-+
        +-progpgup-+  +-,--+----------+--+----------------+-+
                           +-progpgdn-+  +-,--+---------+-+
                                              +-progtop-+

>--+-------------------+--+------------------------------------+-->
   +-,--+------------+-+  +-,--+-----------+--+--------------+-+
        +-progbuttom-+         +-progtrack-+  +-,--progendsc-+


>--)-----------------------------------------------------------><


]]>
</programlisting>

<para>The ConnectScrollBar method initializes and connects
a scroll bar to an Object Rexx object. Use this method in the <link linkend="mthInitDialog">InitDialog</link> method. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Protected:</emphasis></term>
<listitem><para>This method is protected.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the scroll bar.
</para></listitem></varlistentry>
<varlistentry><term>msgWhenUp</term>
<listitem><para>The method that is called each time the scroll bar is incremented.
</para></listitem></varlistentry>
<varlistentry><term>msgWhenDown</term>
<listitem><para>The method that is called each time the scroll bar is decremented.
</para></listitem></varlistentry>
<varlistentry><term>msgWhenDrag</term>
<listitem><para> The method that is called each time the scroll bar is dragged with
the mouse.
</para></listitem></varlistentry>
<varlistentry><term>min, max</term>
<listitem><para> The minimum and maximum values for the scroll bar.
</para></listitem></varlistentry>
<varlistentry><term>pos</term>
<listitem><para>The current or preselected value.
</para></listitem></varlistentry>
<varlistentry><term>progpgup</term>
<listitem><para>The method that is called each time the scroll bar is focused and the
PgUp key is pressed.
</para></listitem></varlistentry>
<varlistentry><term>progpgdn</term>
<listitem><para>The method that is called each time the scroll bar is focused and the
PgDn key is pressed.
</para></listitem></varlistentry>
<varlistentry><term>progtop</term>
<listitem><para>The method that is called each time the scroll bar is focused and the
Home key is pressed.
</para></listitem></varlistentry>
<varlistentry><term>progbottom</term>
<listitem><para>The method that is called each time the scroll bar is focused and the
End key is pressed.
</para></listitem></varlistentry>
<varlistentry><term>progtrack</term>
<listitem><para>The method that is called each time the scroll box is dragged.
</para></listitem></varlistentry>
<varlistentry><term>progendsc</term>
<listitem><para>The method that is called each time the scroll box is released after
the dragging.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>-1</term>
<listitem><para>The specified symbolic ID could not be resolved.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>No error.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>In the following example, scroll bar 255 is connected to three methods
and initialized with 1 as the minimum, 20 as the maximum, and 6 as the current
value:

<programlisting>
<![CDATA[
::class MyDialog subclass UserDialog
     .
     .
     .
::method DefineDialog
self~ConnectScrollBar(255,"Increase","Decrease","Drag",1,20,6)
     .
     .
     .
::method Increase
     .
     .
     .
::method Decrease
     .
     .
     .
::method Drag
     .
     .
     .
/* see CombineElWithSB below for continuation */
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="allsbe"><title>ConnectAllSBEvents</title>
<indexterm><primary>ConnectAllSBEvents</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~ConnectAllSBEvents(--id--,--Prog----------------->

>--+----------------------------------------+--)---------------><
   +-,--+-----+--+------------------------+-+
        +-min-+  +-,--+-----+--+--------+-+
                      +-max-+  +-,--pos-+


]]>
</programlisting>

<para>Connects all scroll bar events to one method. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Protected:</emphasis></term>
<listitem><para>This method is protected.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:</para>
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the scroll bar
</para></listitem></varlistentry>
<varlistentry><term>Prog</term>
<listitem><para>The method that is called for all events sent by the scroll bar.
</para></listitem></varlistentry>
<varlistentry><term>min, max</term>
<listitem><para> The minimum and maximum values for the scroll bar.
</para></listitem></varlistentry>
<varlistentry><term>pos</term>
<listitem><para>The current or preselected value.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem>
<variablelist>
<varlistentry><term>-1</term>
<listitem><para>The specified symbolic ID could not be resolved.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>No error.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddUserMsg"><title>addUserMsg</title>
<indexterm><primary>addUserMsg</primary></indexterm>
<programlisting>
<![CDATA[
>>-aBaseDialog~addUserMsg(--msgToRaise--,--msgWindows----------->

>--+--------------------------------------------------------------------+-->
   +-,--filt1--+------------------------------------------------------+-+
               +-,--wParam--+---------------------------------------+-+
                            +-,--filt2--+-------------------------+-+
                                        +-,--lParam--+----------+-+
                                                     +-,--filt3-+

>--)-----------------------------------------------------------><


]]>
</programlisting>

<para>The addUserMsg method connects a Windows message with an Object Rexx
method. This method is designed to be used by ooDialog programmers who are
familiar with the Windows API.
</para>
<para>You have to pass the Windows message ID and the two message parameters
(wParam and lParam) to specify the exact event you want to catch. In addition,
you can specify filters for each parameter. Filters are useful for catching more
than one message or one parameter with one method.
</para>
<para>Details for all Windows messages and their parameters are available in the
<link linkend="defWindowsDoc">Windows documentation</link>.  The numeric value of
the message IDs (and possibly the message parameters) can be looked up in the
<link linkend="defPlatformSDK">Windows platform SDK</link>.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Protected:</emphasis></term>
<listitem><para>This method is protected. You can use it only within the scope of the
BaseDialog class or its subclasses.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent to the Object Rexx dialog object each time
the specified Windows message is caught. Provide a method with the
same name. The maximum size for a message is limited to 256 characters.
</para></listitem></varlistentry>
<varlistentry><term>msgWindows</term>
<listitem><para>The message in the Windows environment that is to be caught.
</para></listitem></varlistentry>
<varlistentry><term>filt1</term>
<listitem><para>This filter is used to binary AND the incoming Windows message.
</para></listitem></varlistentry>
<varlistentry><term>wParam</term>
<listitem><para>This is the first parameter that must be passed with the Windows message.
</para></listitem></varlistentry>
<varlistentry><term>filt2</term>
<listitem><para>This filter is used to binary AND the <emphasis role="italic">wParam</emphasis> argument.
</para></listitem></varlistentry>
<varlistentry><term>lParam</term>
<listitem><para>This is the second message parameter.
</para></listitem></varlistentry>
<varlistentry><term>filt3</term>
<listitem><para>This is the filter for <emphasis role="italic">lParam</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example shows an implementation of the
ConnectList method:</para>

<programlisting>
<![CDATA[
::class BaseDialog
      .
      .
      .
::method ConnectList
  use arg msgToRaise, id
  self~addUserMsg(msgToRaise, "0x00000111", "0xFFFFFFFF", ,
                 "0x0001"||id~d2x(4), "0xFFFFFFFF", 0, 0)
]]>
</programlisting>
<para>Assume that this method is called with ID=254 and msgToRaise=&quot;ListChanged&quot;.
After the <link linkend="h000132">ConnectList</link> is executed, the ListChanged
message is sent to the Object Rexx dialog object if the following conditions are
true: </para>
<itemizedlist>
<listitem><para>Message &quot;0x00000111&quot; (WM_COMMAND) is generated by Windows in
answer to an event (for example, a button is clicked or a list has changed).
The filter &quot;0xFFFFFFFF&quot; ensures that only that message is caught;
if the filter were &quot;0xFFFFEFFF&quot;, the message &quot;0x00001111&quot;
would be caught as well.</para></listitem>
<listitem><para>The first message parameter is &quot;0x000100FF&quot;. The first part, &quot;0x0001&quot;,
specifies the event, and the second part, &quot;0x00FE&quot; (equals decimal
254), specifies the dialog control where the event occurred. By using another
filter it is possible to make more than one event a trigger for the ListChanged method; for example, filter &quot;0xFFFFFFFE&quot; would ignore
the last bit of the ID, and this the same event for dialog item 255 would
call ListChanged as well.</para></listitem>
<listitem><para>The second message parameter and its filter are ignored.</para></listitem></itemizedlist>
<para>The following example invokes a user-defined method <computeroutput>DoubleClick</computeroutput> each time the left mouse button is double-clicked: </para>
<programlisting>
<![CDATA[
self~addUserMsg("DoubleCick","0x00000203","0xFFFFFFFF",0,0,0,0)
]]>
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>

<section id="mthConnectNotifyEvent"><title>connectNotifyEvent</title>
<indexterm><primary>connectNotifyEvent</primary></indexterm>
<programlisting>
<![CDATA[
>>-aMessageExtensions~connectNotifyEvent(--id--,--"--+-OUTOFMEMORY-+-->
                                                      +-CLICK-------+
                                                      +-DBLCLK------+
                                                      +-ENTER-------+
                                                      +-RCLICK------+
                                                      +-RDBLCLK-----+
                                                      +-GOTFOCUS----+
                                                      +-LOSTFOCUS---+

>--"--+---------------+--)-------------------------------------><
      +-,--msgToRaise-+


]]>
</programlisting>

<para>The connectNotifyEvent method connects a particular
WM_NOTIFY message for a dialog control with a method. The WM_NOTIFY
message informs the dialog that an event has occurred with regard to a dialog
control.</para>
<para>If a specific Connect...Notify method exists for the dialog control, use
this method instead of the connectNotifyEvent method because the system might
send a specific notification instead of a common one.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the dialog control of which a notification is to be connected
to a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem><para>The event to be connected with a method:
<variablelist>
<varlistentry><term>OUTOFMEMORY</term>
<listitem><para>The dialog control went out of memory.
</para></listitem></varlistentry>
<varlistentry><term>CLICK</term>
<listitem><para>The left mouse button was clicked on the dialog control.
</para></listitem></varlistentry>
<varlistentry><term>DBLCLK</term>
<listitem><para>The left mouse button was double-clicked on the dialog control.
</para></listitem></varlistentry>
<varlistentry><term>ENTER</term>
<listitem><para>The return key was pressed in the dialog item.
</para></listitem></varlistentry>
<varlistentry><term>RCLICK</term>
<listitem><para>The right mouse button was clicked on the dialog item.
</para></listitem></varlistentry>
<varlistentry><term>RDBLCLK</term>
<listitem><para>The right mouse button was double-clicked on the dialog control.
</para></listitem></varlistentry>
<varlistentry><term>GOTFOCUS</term>
<listitem><para>The dialog item got the input focus.
</para></listitem></varlistentry>
<varlistentry><term>LOSTFOCUS</term>
<listitem><para>The dialog item lost the input focus.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent whenever the specified notification is
received. Provide a method with a matching name. If you omit this argument,
the event is preceded by <computeroutput>On</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error detected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The message was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example connects the double-click of the left mouse button
on dialog control DLGITEM1 with method OnDblClk:
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method Init
  self~init:super(...)
  self~connectNotifyEvent(DLGITEM1, "DBLCLK")

::method OnDblClk
  use arg id
  say "Item" id " has been double-clicked!"
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods
are defined, use init as the place for this connection -
but not before init:super has been called.
</para></note>
</section>

<section id="mthConnectListViewEvent"><title>connectListViewEvent</title>
<indexterm><primary>connectListViewEvent</primary></indexterm>
<programlisting>
<![CDATA[
>>-connectListViewEvent(--id--,--event--+---------------+--)-------------------><
                                        +-,--methodName-+


]]>
</programlisting>

<para>
  The connectListViewEvent method connects a particular <link linkend="ovvEvents">event</link> for a list view control
  with an event handling method in the dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The ID of the list view control for which a notification is to be connected.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>event [required]</term>
    <listitem>
    <para>
      The event keyword. Use one of the following keywords, case is not significant:
    <variablelist>
      <varlistentry><term>ACTIVATE</term>
      <listitem>
      <para>
        An item is activated by double-clicking the left mouse button.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>BEGINDRAG</term>
      <listitem>
      <para>
        A drag-and-drop operaton was initiated. See <link linkend="mthDefListDragHandler">defListDragHandler</link> for
        information on how to implement a drag-and-drop handler.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>BEGINRDRAG</term>
      <listitem>
      <para>
        A drag-and-drop operaton involving the right mouse button was initiated. See <link
        linkend="mthDefListDragHandler">defListDragHandler</link> for information on how to implement a drag-and-drop
        handler.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>BEGINEDIT</term>
      <listitem>
      <para>
        Editing a label has been started. Do not connect this event if you are using the DEFAULTEDIT keyword.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ENDEDIT</term>
      <listitem>
      <para>
        Label editing has ended. Do not connect this event if you are using the DEFAULTEDIT keyword.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DEFAULTEDIT</term>
      <listitem>
      <para>
        This keyword connects the event that label editing has been started and the ended event with event handling
        methods supplied by the ooDialog framework. The supplied methods extract the newly entered text from the
        notification and modifies the item label which was edited. If this keyword is not used you must provide your own
        event-handling methods and connect them with the begin edit and end edit events. Otherwise, the edited text is
        lost and the item label remains unchanged.
      </para>
      <para>
        When you specify this event, omit the <emphasis role="italic">methodName</emphasis> argument. This keyword
        tells the ooDialog framework to use the <emphasis role="italic">defListDragHandler</emphasis>() method for both
        the begin and end edit events.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CHANGING</term>
      <listitem>
      <para>
        An item is about to change. The notification for this event is sent before the item is changed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CHANGED</term>
      <listitem>
      <para>
        An item has changed. The notification for this event is sent after the item changed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CHECKBOXCHANGED</term>
      <listitem>
      <para>
        The check box state of an item changed.  (The check box was checked or unchecked.) This event can only occur if
        the list view has the check box <link linkend="mthAddExtendedStyle">extended</link> list view style.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CLICK</term>
      <listitem>
      <para>
        An item, (not a column,) was clicked with the left mouse button.  Connecting the CLICK event is a replacement
        for the <computeroutput>connectNotifyEvent</computeroutput> method's CLICK event.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>COLUMNCLICK</term>
      <listitem>
      <para>
        A column has been clicked.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DELETE</term>
      <listitem>
      <para>
        An item has been deleted.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DELETEALL</term>
      <listitem>
      <para>
        All items have been deleted.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>FOCUSCHANGED</term>
      <listitem>
      <para>
        The focus state of an item changed.  (The item gained or lost the focus.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term>INSERTED</term>
      <listitem>
      <para>
        A new item has been inserted.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>KEYDOWN</term>
      <listitem>
      <para>
        A key was pressed inside the list view. This notification is not sent while a label is being edited.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SELECTCHANGED</term>
      <listitem>
      <para>
        The selection state of an item changed.  (The item was selected or unselected.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SELECTFOCUSCHANGED</term>
      <listitem>
      <para>
        The selection state or the focus state of an item changed.  This event argument combines the selection changed
        and the focus changed event into one connection.  When this event is connected, separate selection changed and
        focus changed events can not be connected.  This keyword can be abbreviated to &quot;SELECTFOCUS&quot;.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName</term>
    <listitem>
    <para>
      The name of the event handling method. This method is invoked each time the specified event occurs for the list
      view control. If you omit this argument, the event handler method name is generated for you. This name will be the
      event keyword, preceded by <computeroutput>On</computeroutput>. For example: <emphasis
      role="italic">onColumnClick</emphasis>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
  <variablelist>
    <varlistentry><term>0</term>
    <listitem>
    <para>
      No error detected.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>-1</term>
    <listitem>
    <para>
      The resource ID could not be resolved or the event argument is incorrect.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>1</term>
    <listitem>
    <para>
      The event was not connected correctly. The error is likely caused by the message table being full, but could also
      indicate the interpreter is out of memory.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Microsoft continually enhances the Windows User Interface and therefore the dialog controls evolve over time. The
    <computeroutput>connectListViewEvent</computeroutput> method is similar to the <link
    linkend="mthConnectListViewEvent">connectListViewEvent</link> method, but it is designed to take advantage of new
    features in the list-view control.  It connects notification message sent by a list view control to its parent
    dialog with a method, provided by the programmer, in an ooDialog class. These notifications inform the dialog that
    an event has occurred in the list view.
  </para>
  <para>
    The <computeroutput>connectListViewEvent</computeroutput> method is designed to provide more information to the
    invoked method than the <computeroutput>connectListViewEvent</computeroutput> or
    <computeroutput>connectNotifyEvent</computeroutput> methods.  Connecting an event through the
    <computeroutput>connectListViewEvent</computeroutput> method is used as a replacement for connecting the same event
    through the <computeroutput>connectListViewEvent</computeroutput> method or the
    <computeroutput>connectNotifyEvent</computeroutput> method.
  </para>
  <note><title>Note</title>
  <para>
    If the same event, for the same control, is connected using two different ConnectXXX methods, only one connection
    will be in effect.  This will be the connection whose ConnectXXX method is invoked first.  For example, take a
    dialog that has a list view control with resource ID of 109.  If the mouse click event is connected for that control
    using the <computeroutput>connectNotifyEvent</computeroutput> method and then the mouse click event is also
    connected using the <computeroutput>connectListViewEvent</computeroutput> method, only one connection will be
    active.  Which one is active is dependent on the order of invocation of the ConnectXXX methods.
  </para>
  </note>
  <note><title>Note</title>
  <para>
    When using <computeroutput>connectListViewEvent</computeroutput> a separate method can be connected to each of the
    checkbox changed, selection changed, and focus changed events.  These event connectionss are all replacements for
    the <link linkend="mthConnectListViewEvent">connectListViewEvent</link> method's CHANGED event.
  </para>
  </note>
  <para>
    Each of the events that can be connected through the <computeroutput>connectListViewEvent</computeroutput> method is
    a replacement for connecting that event through one of the other ConnectXXX methods. The argument documentation
    provides more detail on this.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example connects the column-clicked event for the list view EMPLOYEES with method ColumnAction and
    changes the style of the list view from REPORT to SMALLICON:
  </para>
  <programlisting>
  <![CDATA[
  ::class MyDlgClass subclass UserDialog

  ::method Init
    self~init:super(...)
    self~connectListViewEvent("EMPLOYEES", "COLUMNCLICK", "ColumnAction")

  ::method ColumnAction
    use arg id, column
    lc = self~GetListControl("EMPLOYEES")
    lc~ReplaceStyle("REPORT", "SMALLICON EDIT SINGLESEL ASCENDING")
    if column > 0 then ...
  ]]>
  </programlisting>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Methods</emphasis></term>
  <listitem><para>The following details the method signature for each of the
  <computeroutput>connectListViewEvent</computeroutput> events:
  <variablelist>
  <varlistentry><term>CLICK</term>
  <listitem><para>The method invoked for the left mouse click event recieves four
  arguments.
  <programlisting>
  <![CDATA[
  ::method onClick
  use arg id, itemIndex, columnIndex, keyState

  ]]>
  </programlisting>
  <variablelist>
  <varlistentry><term>id</term>
  <listitem><para>The resource ID of the list view control whose item was clicked.
  </para></listitem></varlistentry>
  <varlistentry><term>itemIndex</term>
  <listitem><para>The index of the item that was clicked.
  </para></listitem></varlistentry>
  <varlistentry><term>columnIndex</term>
  <listitem><para>The index of the subitem that was clicked.  This will be the
  column clicked on if the list view is in report view.  In other views it will be
  0.
  </para></listitem></varlistentry>
  <varlistentry><term>keyState</term>
  <listitem><para>This argument reports the state of the shift, control, and alt
  keys at the time of the mouse click.  The argument is a string of keywords
  separated by blanks.  The keywords consist of: SHIFT, CONTROL, ALT, or NONE.
  The presence of a keyword indicates the key was held down when the user clicked
  on the list view control.  NONE of course indicates that none of the keys were
  down.  If the user managed to hold all three of the keys down at the time of the
  mouse click, the argument would be the string: &quot;SHIFT CONTROL ALT&quot;
  </para></listitem></varlistentry>
  </variablelist>
  </para></listitem></varlistentry>
  <varlistentry><term>CHECKBOXCHANGED</term>
  <listitem><para>The method invoked for the checkbox changed event recieves
  three arguments. The method signature will look as follows:
  <programlisting>
  <![CDATA[
  ::method onCheckboxChanged
    use arg id, itemIndex, state

  ]]>
  </programlisting>
  <variablelist>
  <varlistentry><term>id</term>
  <listitem><para>The resource ID of the list view control whose item had the
  checkbox state changed.
  </para></listitem></varlistentry>
  <varlistentry><term>itemIndex</term>
  <listitem><para>The index of the item whose checkbox was changed.
  </para></listitem></varlistentry>
  <varlistentry><term>state</term>
  <listitem><para>This argument reports whether the check box was checked or
  unchecked.  Its value will be either &quot;CHECKED&quot; or &quot;UNCHECKED&quot;
  </para></listitem></varlistentry>
  </variablelist>
  </para></listitem></varlistentry>
  <varlistentry><term>SELECTCHANGE</term>
  <listitem><para>The method invoked when the selection changes will recieve three
  arguments.  The method signature will look as follows:
  <programlisting>
  <![CDATA[
  ::method onSelectChanged
    use arg id, itemIndex, state

  ]]>
  </programlisting>
  <variablelist>
  <varlistentry><term>id</term>
  <listitem><para>The resource ID of the list view control whose item had the
  selection changed.
  </para></listitem></varlistentry>
  <varlistentry><term>itemIndex</term>
  <listitem><para>The index of the item whose selection was changed.
  </para></listitem></varlistentry>
  <varlistentry><term>state</term>
  <listitem><para>This argument reports whether the item was selected or
  unselected.  Its value will be either &quot;SELECTED&quot; or
  &quot;UNSELECTED&quot;
  </para></listitem></varlistentry>
  </variablelist>
  </para></listitem></varlistentry>
  <varlistentry><term>FOCUSCHANGED</term>
  <listitem><para>The method invoked for the focus changed event recieves three
  arguments. The method signature will look as follows:
  <programlisting>
  <![CDATA[
  ::method onFocusChanged
    use arg id, itemIndex, state

  ]]>
  </programlisting>
  <variablelist>
  <varlistentry><term>id</term>
  <listitem><para>The resource ID of the list view control whose item had the
  focus changed.
  </para></listitem></varlistentry>
  <varlistentry><term>itemIndex</term>
  <listitem><para>The index of the item which gained or lost the focus.
  </para></listitem></varlistentry>
  <varlistentry><term>state</term>
  <listitem><para>This argument reports whether the focus was gained or lost.  Its
  value will be either &quot;FOCUSED&quot; or &quot;UNFOCUSED&quot;
  </para></listitem></varlistentry>
  </variablelist>
  </para></listitem></varlistentry>
  <varlistentry><term>SELECTFOCUSCHANGED</term>
  <listitem><para>The method invoked for the selection or focus changed event
  recieves three arguments. The method signature will look as follows:
  <programlisting>
  <![CDATA[
  ::method onSelectFocusChanged
    use arg id, itemIndex, state

  ]]>
  </programlisting>
  <variablelist>
  <varlistentry><term>id</term>
  <listitem><para>The resource ID of the list view control whose item had the
  either the focus or the selection changed.
  </para></listitem></varlistentry>
  <varlistentry><term>itemIndex</term>
  <listitem><para>The index of the item where the state was changed.
  </para></listitem></varlistentry>
  <varlistentry><term>state</term>
  <listitem><para>This argument reports whether the focus was gained or lost and
  whether the selection was gained or lost.  Its value will contain at least one
  of the keywords: &quot;SELECTED&quot;, &quot;UNSELECTED&quot;,
  &quot;FOCUSED&quot; or &quot;UNFOCUSED&quot;.  It is possible for both the
  selection and focus changed to be reported at once, however sometimes each
  change is reported separately. (This has nothing to do with ooDialog, it is how
  the operating system sends the messages.)
  </para></listitem></varlistentry>
  </variablelist>
  </para></listitem></varlistentry>
  </variablelist>
  </para></listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem><para>The following example is from an address book application.  A
  list view control is filled with the information from the address book, one item
  for each entry.  The check box changed event is connected to the
  onCheckboxChanged method. The onCheckboxChanged method will receive 3
  arguments: the resource ID of the control, the index of the item whose check box
  changed, and the changed state. If the user checks the check box, that entry is
  added to a mail merge being constructed.  If the user unchecks the box, the
  entry is removed from the mail merge.
  </para>
  <programlisting>
  <![CDATA[
  ::class MailingListDlg subclass UserDialog

  ::method initDialog
    expose mailList

    ...
    mailList = self~getListControl(IDC_LV_ADDRESSES)
    ...

    -- Since the methodName argument is omitted, ooDialog will construct a default
    -- name of 'onCheckboxChanged'
    self~connectListViewEvent(IDC_LV_ADDRESSES, "CHECKBOXCHANGED")
    ...

  ::method onCheckboxChanged
    expose mailList
    use arg id, itemIndex, state

    if state == "CHECKED" then
      self~addToMailMerge(mailList, itemIndex)
    else
      self~removeFromMailMerge(mailList, itemIndex)

  ]]>
  </programlisting>
  </listitem></varlistentry>
</variablelist>

<note><title>Notes</title>
<orderedlist>
<listitem><para>Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods are defined, use init as the place for this connection - but not
before init:super has been called.</para></listitem>
<listitem><para>The event-handling method connected to ENDEDIT receives two arguments:
the item ID of which the label has been edited and the newly entered text.</para>
<para><emphasis role="bold">Example:</emphasis></para>
<programlisting>
<![CDATA[
::method OnEndEdit
  use arg item, newText
]]>
</programlisting></listitem>
<listitem><para>The event-handling method connected to COLUMNCLICK receives two arguments:
the control ID of the list view control and the zero-based column number of
which the header button was pressed.</para>
<para><emphasis role="bold">Example:</emphasis></para>
<programlisting>
<![CDATA[
::method OnColumnClick
  use arg id, column
]]>
</programlisting></listitem>
<listitem><para>The event-handling method connected to KEYDOWN receives two arguments:
the control ID of the list view control and the virtual key code pressed.
Use the method <link linkend="keyname">KeyName</link> of the VirtualKeyCodes class to get
the name of the key. Note that your class must inherit from the VirtualKeyCodes
class to use the KeyName method.</para>
<para><emphasis role="bold">Example:</emphasis></para>
<programlisting>
<![CDATA[
::method OnKeyDown
  use arg id, vkey
  say "Key" self~KeyName(vkey) "was pressed."
]]>
</programlisting></listitem>
<listitem><para>The event-handling method connected to BEGINDRAG or BEGINRDRAG receives
three arguments: the control ID of the list view control, the index of the
list item to be dragged, and the point where the mouse cursor was pressed
(x and y positions, separated by a blank).</para>
<para><emphasis role="bold">Example:</emphasis></para>
<programlisting>
<![CDATA[
::method OnBeginDrag
  use arg id, item, where
  say "Item at index" item "is in drag-and-drop mode"
  parse var where x y
  say "The drag operation started at point ("x","y")"
]]>
</programlisting></listitem>
</orderedlist>
</note>
</section>

<section id="mthConnectTreeViewEvent"><title>connectTreeViewEvent</title>
<indexterm><primary>connectTreeViewEvent</primary></indexterm>
<programlisting>
<![CDATA[
>>-connectTreeViewEvent(--id--,--event--+----------------+--)------------------><
                                        +-,--methodName--+

]]>
</programlisting>

<para>
  The <emphasis role="italic">connectTreeViewEvent</emphasis> method connects a method in a Rexx dialog to a particular
  tree view <link linkend="ovvEvents">event</link>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      The <emphasis role="italic">connectTreeViewEvent</emphasis> method is a member of the <link
      linkend="clsEventNotification">EventNotification</link> mixin class.
    </para>
  <para>
    Syntax errors are raised when incorrect usage is detected.
  </para>
  <para>
    If the programmer does not provide a matching method in the Rexx dialog, a syntax condition will be raised if any
    command events happen.
  </para>
  <para>
    In Windows itself, tree view event notifications are sent to the parent dialog using the WM_NOTIFY message.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem><para>The arguments are:</para>
  <variablelist>
    <varlistentry><term>id</term>
    <listitem>
    <para>
      The resource ID of the tree view control. This can be the numeric or symbolic ID.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>event</term>
    <listitem>
    <para>
      A keyword indicating which event is to be connected. The keyword must be one of the following:
      <variablelist>
        <varlistentry><term>BEGINDRAG</term>
        <listitem>
        <para>
          A drag-and-drop operaton using the left mouse button was initiated. The documentation for the <link
          linkend="mthDefTreeDragHandler">defTreeDragHandler</link>() method contains further information on how to
          implement a drag-and-drop handler.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>BEGINRDRAG</term>
        <listitem>
        <para>
          A drag-and-drop operaton involving the right mouse button was initiated. The documentation for the <link
          linkend="mthDefTreeDragHandler">defTreeDragHandler</link>() method contains further information on how to
          implement a drag-and-drop handler.
        handler.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>BEGINEDIT</term>
        <listitem><para>Editing a label has been started.
        </para></listitem></varlistentry>
        <varlistentry><term>ENDEDIT</term>
        <listitem><para>Label editing has ended.
        </para></listitem></varlistentry>
        <varlistentry><term>DEFAULTEDIT</term>
        <listitem><para>This event connects the notification that label editing has been started
        and ended with a predefined event-handling method. This method extracts the
        newly entered text from the notification and modifies the item of which the
        label was edited. If this event is not connected you must provide your own
        event-handling method and connect it with the BEGINEDIT and ENDEDIT events.
        Otherwise, the edited text is lost and the item remains unchanged.</para>
        <para>When
        you specify this event, omit the <emphasis role="italic">msgToRaise</emphasis> argument.</para>
        </listitem></varlistentry>
        <varlistentry><term>EXPANDING</term>
        <listitem><para>An item is about to expand or collapse. This notification is sent before
        the item has expanded or collapsed.
        </para></listitem></varlistentry>
        <varlistentry><term>EXPANDED</term>
        <listitem><para>An item has expanded or collapsed. This notification is sent after the
        item expanded or collapsed.
        </para></listitem></varlistentry>
        <varlistentry><term>DELETE</term>
        <listitem><para>An item has been deleted.
        </para></listitem></varlistentry>
        <varlistentry><term>KEYDOWN</term>
        <listitem><para>A key was pressed inside the tree view. This notification is not sent
        while a label is being edited.
        </para></listitem></varlistentry>
        <varlistentry><term>SELCHANGING</term>
        <listitem><para>Another item is about to be selected. This notification is sent before
        the selection has changed.
        </para></listitem></varlistentry>
        <varlistentry><term>SELCHANGED</term>
        <listitem><para>Another item was selected. This notification is sent after the selection
        was changed.
        </para></listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName</term>
    <listitem>
    <para>
      The name of the event handling method. This method is invoked each time the specified event occurs for the tree
      view control. If you omit this argument, the method name is generated for you. This name will be the event
      keyword, preceded by <computeroutput>on</computeroutput>. For example: <emphasis
      role="italic">onExpanded</emphasis>.
    </para>
    </listitem></varlistentry>
  </variablelist> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
  <variablelist>
    <varlistentry><term>0</term>
    <listitem>
    <para>
      No error detected.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>-1</term>
    <listitem>
    <para>
      The resource ID was symbolic and it could not be resolved, or the event keyword is not correct.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>1</term>
    <listitem>
    <para>
      Some other error and the message was not connected correctly. This may indicate the message table is full, or the
      interpreter is out of usable memory.
    </para>
    </listitem></varlistentry>
  </variablelist> </para></listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem><para>The following example connects the selection-changed event for the tree
  view FileTree with method NewTreeSelection and displays the text of the new
  selection:
  <programlisting>
  <![CDATA[
  ::class MyDlgClass subclass UserDialog

  ::method Init
    self~init:super(...)
    self~connectTreeViewEvent("FileTree", "SELCHANGED", "NewTreeSelection")

  ::method NewTreeSelection
    tc = self~GetTreeControl("FileTree")
    info. = tc~ItemInfo(tc~Selected)
    say "New selection is:" info.!text
  ]]>
  </programlisting>
  </para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
<orderedlist>
<listitem><para>Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods are defined, use init as the place for this connection - but not
before init:super has been called.</para></listitem>
<listitem><para>The event-handling method connected to ENDEDIT receives two arguments:
the item handle of which the label has been edited and the newly entered text.
Example:
<programlisting>
<![CDATA[
::method OnEndEdit
  use arg item, newText
]]>
</programlisting></para></listitem>
<listitem><para>The event-handling method connected to KEYDOWN receives two arguments:
the control ID of the tree view control and the virtual key code pressed.
Use the method <link linkend="keyname">KeyName</link> of the VirtualKeyCodes class to get
the name of the key. Note that your class must inherit from the VirtualKeyCodes
class to use the KeyName method. Example:
<programlisting>
<![CDATA[
::method OnKeyDown
  use arg id, vkey
  say "Key" self~KeyName(vkey) "was pressed."
]]>
</programlisting></para></listitem>
<listitem><para>The event-handling method connected to EXPANDED or EXPANDING receives
three arguments: the control ID of the tree view control, the tree item expanded
or collapsed, and a string that indicates whether the item was expanded or
collapsed. Example:
<programlisting>
<![CDATA[
::method OnExpanding
  use arg id, item, what
  say "Item with handle" item "is going to be" what
]]>
</programlisting></para></listitem>
<listitem><para>The event-handling method connected to BEGINDRAG or BEGINRDRAG receives
three arguments: the control ID of the tree view control, the tree item to
be dragged, and the point where the mouse cursor was pressed (x and y positions,
separated by a blank). Example:
<programlisting>
<![CDATA[
::method OnBeginDrag
  use arg id, item, where
  say "Item with handle" item "is in drag-and-drop mode"
  parse var where x y
  say "The drag operation started at point ("x","y")"
]]>
</programlisting></para></listitem>
</orderedlist>
</para></note>

</section>

<section id="mthConnectMonthCalendarNotify"><title>connectMonthCalendarNotify</title>
<indexterm><primary>connectMonthCalendarNotify</primary></indexterm>
<programlisting>
<![CDATA[
>>--connectStaticNotify(--id--,--"event"--,-+---------------+--)--------><
                                            +-,--methodName-+

]]>
</programlisting>

<para>
  PLEASE FIXE ME TODO
  The connectStaticNotify connects a notification message from a static control to a method, defined by
  the programmer, of the dialog.  Normally, static controls do not send notification messages.  A static
  control will only send the messages when it has the SS_NOTIFY style.  The notification messages inform
  the dialog that an event has occurred with regard to the static control.
</para>
<para>
  For user defined dialogs use the NOTIFY style keyword in the <link
  linkend="sctAddStaticControls">Add...</link> static control methods when the control is defined. For
  dialogs created from a compiled resource or a resource script file use the SS_NOTIFY style when
  defining the control in a resource editor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
    <varlistentry><term>id</term>
    <listitem>
      <para>
        The resource ID of the static control.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>event</term>
    <listitem>
      <para>
        A keyword specifying the event to be connected with a method:
        <variablelist>
          <varlistentry><term>CLICK</term>
          <listitem>
            <para>
              The static control has been clicked with the mouse.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DBLCLK</term>
          <listitem>
            <para>
              The static control has been double-clicked with the mouse.
            </para>
          </listitem></varlistentry>
          <varlistentry><term>DISABLE</term>
          <listitem>
            <para>
              The static control has been disabled.
            </para>
          </listitem></varlistentry>
          <varlistentry><term>ENABLE</term>
          <listitem>
            <para>
              The static control has been enabled.
            </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName</term>
    <listitem>
      <para>
        The method that is to be invoked whenever the specified notification is received from the static
        control. The programmer defines this method. If this argument is omitted, a method name is
        automatically generated that consists of the event keyword preceded by
        <computeroutput>on</computeroutput>. For instance, <computeroutput>onClick</computeroutput>.
      </para>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The return codes are:
      <variablelist>
      <varlistentry><term>0</term>
      <listitem>
        <para>
          No error detected.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>-1</term>
      <listitem>
        <para>
          The resource ID could not be resolved or the event argument is incorrect.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>1</term>
      <listitem>
        <para>
          The message was not connected correctly.
        </para>
      </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Additional Notes:</emphasis></term>
  <listitem>
    <orderedlist>
    <listitem>
      <para>
        The invocation of connectStaticNotify() can be placed in the <link linkend="h000025">init</link>
        or <link linkend="mthInitDialog">initDialog</link> method.  (Indeed the invocation can be done
        anywhere. But, it makes most sense to have the connection made before the dialog starts
        executing.) If the connection is made in the init() method, be sure that the super class init()
        is invoked first.
      </para>
    </listitem>
    <listitem>
      <para>
        The defined event-handling methods will receive two arguments. The first arg contains information
        about the specific control and its event. The second arg is the window handle of the static
        control.
      </para>
      <para>
        The low word of the first arg is the control ID and the high word is the event ID.
      </para>
    </listitem>
    </orderedlist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      The following example comes from an application that displays employee statistics.  A single click
      on the employee number field advances the display to the next employee.  A double click on either
      the employee name or employee job duties alllows those fields to be edited.
    </para>
<programlisting>
<![CDATA[
::method initDialog

  self~connectStaticNotify(IDC_ST_EMPNO, "CLICK", empLookup)

  self~connectStaticNotify(IDC_ST_EMPJOB, "DBLCLK", editStats)
  self~connectStaticNotify(IDC_ST_EMPNAME, "DBLCLK", editStats)

  first = self~initDatabase
  self~setStats(first)
]]>
</programlisting>
      <para>
        In this example, (a continuation of the above example,) the control ID determines if the user has
        double clicked on the employee job duties field, or the employee name field.  The event ID is not
        used, or needed. Its purpose in the code snippet is simply an example. The same thing applies to
        the window handle.
      </para>
<programlisting>
<![CDATA[
::method editStats
  use arg ctrlInfo, ctrlHwnd

  ctrlID = .DlgUtil~loWord(ctrlInfo)
  eventID = .DlgUtil~hiWord(ctrlInfo)

  rec = self~getCurrentRecord

  if self~userUpdate(ctrlID, rec) then self~setStats(rec)
]]>
</programlisting>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthConnectButtonEvent"><title>connectButtonEvent</title>
<indexterm><primary>connectButtonEvent</primary></indexterm>
<programlisting>
<![CDATA[
>>--connectButtonEvent(--id--,--event--+---------------+--)---------><
                                       +-,--msgToRaise-+

]]>
</programlisting>

<para>
  The connectButtonEvent method connects a particular WM_NOTIFY message for a button control (push
  button, radio button, or check box) with a method. The WM_NOTIFY message informs the dialog that an
  event has occurred with regard to the button.
</para>
<note><title>Note</title><para>
  In order to recieve the GOTFOCUS, LOSTFOCUS, and DBLCLK events, the button control has to have the
  NOTIFY (BS_NOTIFY) style.  For user defined dialogs use the NOTIFY style keyword in the <link
  linkend="sctCreateMethods">create ...</link> method when the button is defined.  For dialogs created from a
  compiled resource or a resource script file use the BS_NOTIFY style for the button resource.  The other events
  are always sent and it is not necessary to add the NOTIFY style.
</para></note>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the button control of which a notification is to be connected
to a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem>
<para>
  A keyword specifying the event to be connected with a method. This can be exactly one of the follwoing:
<variablelist>
<varlistentry><term>CLICKED</term>
<listitem><para>The button has been clicked.
</para></listitem></varlistentry>
<varlistentry><term>DBLCLK</term>
<listitem><para>The button has been double-clicked.
</para></listitem></varlistentry>
<varlistentry><term>DISABLE</term>
<listitem><para>The button has been disabled.
</para></listitem></varlistentry>
<varlistentry><term>GOTFOCUS</term>
<listitem><para>The button got the input focus.
</para></listitem></varlistentry>
<varlistentry><term>LOSTFOCUS</term>
<listitem><para>The button lost the input focus.
</para></listitem></varlistentry>
<varlistentry><term>HILITE</term>
<listitem><para>The button has been selected.
</para></listitem></varlistentry>
<varlistentry><term>UNHILITE</term>
<listitem><para>The highlighting is to be removed (lost selection).
</para></listitem></varlistentry>
<varlistentry><term>HOTITEM</term>
<listitem>
  <para>
    Notifies the dialog that the mouse has moved over the button, or that the mouse is leaving the area
    over the button.
  </para>
</listitem></varlistentry>
<varlistentry><term>PAINT</term>
<listitem><para>The button is to be repainted. This notification is only sent for owner-drawn
buttons.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem>
<para>
  The message that is to be sent whenever the specified notification is received from the button control.
  Provide a method with a matching name. If you omit this argument, a message name is generated
  automatically. The name consists of the event keyword preceded by <computeroutput>On</computeroutput>.
  For instance: <computeroutput>onGotFocus</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error detected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The message was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Additional Notes:</emphasis></term>
  <listitem>
    <orderedlist>
    <listitem>
      <para>
        The invocation of connectButtonEvent() can be placed in the <link linkend="h000025">init</link>
        or <link linkend="mthInitDialog">initDialog</link> method.  (Indeed the invocation can be done
        anywhere. But, it makes most sense to have the connection made before the dialog starts
        executing.) If the connection is made in the init() method, be sure that the super class init()
        is invoked first.
      </para>
    </listitem>
    <listitem>
      <para>
        For all events other than the HOTITEM event, the event-handling methods will receive two
        arguments. The first arg contains information about the specific control and its event. The
        second arg is the window handle of the button control.
      </para>
      <para>
        The low word of the first arg is the control ID and the high word is the event ID. Example:
<programlisting>
<![CDATA[
::method handler
  use arg info, handle
  id = .DlgUtil~loWord(info)
  ...
]]>
</programlisting>
      </para>
    </listitem>
    <listitem>
      <para>
        The method for the HOTITEM event also receives two arguments. The first arg is the control id.
        The second arg is .true or .false. True if the mouse moved over the button, false if it left the
        area over the button. Example:
<programlisting>
<![CDATA[
::method onHover
  use arg id, entering
  say 'onHover id:' id 'entering:' entering
  ...

/* Output might be:

  onHover id: 1044 entering: 1
  onHover id: 1044 entering: 0
  onHover id: 1001 entering: 1
  onHover id: 1001 entering: 0

*/
]]>
</programlisting>
      </para>
    </listitem>
    </orderedlist>
  </listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays a message whenever the OK button is selected:</para>
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method Init
  self~init:super(...)
  self~connectButtonEvent("OK", "HILITE")

::method OnHilite
  say "The OK button has been selected"
]]>
</programlisting>
</listitem></varlistentry>
</variablelist>

</section>

<section id="mthConnectStaticNotify"><title>connectStaticNotify</title>
<indexterm><primary>connectStaticNotify</primary></indexterm>
<programlisting>
<![CDATA[
>>--connectStaticNotify(--id--,--"event"--,-+---------------+--)--------><
                                            +-,--methodName-+

]]>
</programlisting>

<para>
  The connectStaticNotify connects a notification message from a static control to a method, defined by
  the programmer, of the dialog.  Normally, static controls do not send notification messages.  A static
  control will only send the messages when it has the SS_NOTIFY style.  The notification messages inform
  the dialog that an event has occurred with regard to the static control.
</para>
<para>
  For user defined dialogs use the NOTIFY style keyword in the <link
  linkend="sctAddStaticControls">Add...</link> static control methods when the control is defined. For
  dialogs created from a compiled resource or a resource script file use the SS_NOTIFY style when
  defining the control in a resource editor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
    <varlistentry><term>id</term>
    <listitem>
      <para>
        The resource ID of the static control.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>event</term>
    <listitem>
      <para>
        A keyword specifying the event to be connected with a method:
        <variablelist>
          <varlistentry><term>CLICK</term>
          <listitem>
            <para>
              The static control has been clicked with the mouse.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DBLCLK</term>
          <listitem>
            <para>
              The static control has been double-clicked with the mouse.
            </para>
          </listitem></varlistentry>
          <varlistentry><term>DISABLE</term>
          <listitem>
            <para>
              The static control has been disabled.
            </para>
          </listitem></varlistentry>
          <varlistentry><term>ENABLE</term>
          <listitem>
            <para>
              The static control has been enabled.
            </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName</term>
    <listitem>
      <para>
        The method that is to be invoked whenever the specified notification is received from the static
        control. The programmer defines this method. If this argument is omitted, a method name is
        automatically generated that consists of the event keyword preceded by
        <computeroutput>on</computeroutput>. For instance, <computeroutput>onClick</computeroutput>.
      </para>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The return codes are:
      <variablelist>
      <varlistentry><term>0</term>
      <listitem>
        <para>
          No error detected.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>-1</term>
      <listitem>
        <para>
          The resource ID could not be resolved or the event argument is incorrect.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>1</term>
      <listitem>
        <para>
          The message was not connected correctly.
        </para>
      </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Additional Notes:</emphasis></term>
  <listitem>
    <orderedlist>
    <listitem>
      <para>
        The invocation of connectStaticNotify() can be placed in the <link linkend="h000025">init</link>
        or <link linkend="mthInitDialog">initDialog</link> method.  (Indeed the invocation can be done
        anywhere. But, it makes most sense to have the connection made before the dialog starts
        executing.) If the connection is made in the init() method, be sure that the super class init()
        is invoked first.
      </para>
    </listitem>
    <listitem>
      <para>
        The defined event-handling methods will receive two arguments. The first arg contains information
        about the specific control and its event. The second arg is the window handle of the static
        control.
      </para>
      <para>
        The low word of the first arg is the control ID and the high word is the event ID.
      </para>
    </listitem>
    </orderedlist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      The following example comes from an application that displays employee statistics.  A single click
      on the employee number field advances the display to the next employee.  A double click on either
      the employee name or employee job duties alllows those fields to be edited.
    </para>
<programlisting>
<![CDATA[
::method initDialog

  self~connectStaticNotify(IDC_ST_EMPNO, "CLICK", empLookup)

  self~connectStaticNotify(IDC_ST_EMPJOB, "DBLCLK", editStats)
  self~connectStaticNotify(IDC_ST_EMPNAME, "DBLCLK", editStats)

  first = self~initDatabase
  self~setStats(first)
]]>
</programlisting>
      <para>
        In this example, (a continuation of the above example,) the control ID determines if the user has
        double clicked on the employee job duties field, or the employee name field.  The event ID is not
        used, or needed. Its purpose in the code snippet is simply an example. The same thing applies to
        the window handle.
      </para>
<programlisting>
<![CDATA[
::method editStats
  use arg ctrlInfo, ctrlHwnd

  ctrlID = .DlgUtil~loWord(ctrlInfo)
  eventID = .DlgUtil~hiWord(ctrlInfo)

  rec = self~getCurrentRecord

  if self~userUpdate(ctrlID, rec) then self~setStats(rec)
]]>
</programlisting>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthConnectDateTimePickerEvent"><title>connectDateTimePickerEvent</title>
<indexterm><primary>connectDateTimePickerEvent</primary></indexterm>
<programlisting>
<![CDATA[
>>--connectDateTimePickerEvent(--id--,--event--+---------------+--)------------><
                                               +-,--methodName-+

]]>
</programlisting>

<para>
  PLEASE FIXE ME TODO
  The connectStaticNotify connects a notification message from a static control to a method, defined by
  the programmer, of the dialog.  Normally, static controls do not send notification messages.  A static
  control will only send the messages when it has the SS_NOTIFY style.  The notification messages inform
  the dialog that an event has occurred with regard to the static control.
</para>
<para>
  For user defined dialogs use the NOTIFY style keyword in the <link
  linkend="sctAddStaticControls">Add...</link> static control methods when the control is defined. For
  dialogs created from a compiled resource or a resource script file use the SS_NOTIFY style when
  defining the control in a resource editor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
    <varlistentry><term>id</term>
    <listitem>
      <para>
        The resource ID of the static control.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>event</term>
    <listitem>
      <para>
        A keyword specifying the event to be connected with a method:
        <variablelist>
          <varlistentry><term>CLICK</term>
          <listitem>
            <para>
              The static control has been clicked with the mouse.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DBLCLK</term>
          <listitem>
            <para>
              The static control has been double-clicked with the mouse.
            </para>
          </listitem></varlistentry>
          <varlistentry><term>DISABLE</term>
          <listitem>
            <para>
              The static control has been disabled.
            </para>
          </listitem></varlistentry>
          <varlistentry><term>ENABLE</term>
          <listitem>
            <para>
              The static control has been enabled.
            </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName</term>
    <listitem>
      <para>
        The method that is to be invoked whenever the specified notification is received from the static
        control. The programmer defines this method. If this argument is omitted, a method name is
        automatically generated that consists of the event keyword preceded by
        <computeroutput>on</computeroutput>. For instance, <computeroutput>onClick</computeroutput>.
      </para>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The return codes are:
      <variablelist>
      <varlistentry><term>0</term>
      <listitem>
        <para>
          No error detected.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>-1</term>
      <listitem>
        <para>
          The resource ID could not be resolved or the event argument is incorrect.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>1</term>
      <listitem>
        <para>
          The message was not connected correctly.
        </para>
      </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Additional Notes:</emphasis></term>
  <listitem>
    <orderedlist>
    <listitem>
      <para>
        The invocation of connectStaticNotify() can be placed in the <link linkend="h000025">init</link>
        or <link linkend="mthInitDialog">initDialog</link> method.  (Indeed the invocation can be done
        anywhere. But, it makes most sense to have the connection made before the dialog starts
        executing.) If the connection is made in the init() method, be sure that the super class init()
        is invoked first.
      </para>
    </listitem>
    <listitem>
      <para>
        The defined event-handling methods will receive two arguments. The first arg contains information
        about the specific control and its event. The second arg is the window handle of the static
        control.
      </para>
      <para>
        The low word of the first arg is the control ID and the high word is the event ID.
      </para>
    </listitem>
    </orderedlist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      The following example comes from an application that displays employee statistics.  A single click
      on the employee number field advances the display to the next employee.  A double click on either
      the employee name or employee job duties alllows those fields to be edited.
    </para>
<programlisting>
<![CDATA[
::method initDialog

  self~connectStaticNotify(IDC_ST_EMPNO, "CLICK", empLookup)

  self~connectStaticNotify(IDC_ST_EMPJOB, "DBLCLK", editStats)
  self~connectStaticNotify(IDC_ST_EMPNAME, "DBLCLK", editStats)

  first = self~initDatabase
  self~setStats(first)
]]>
</programlisting>
      <para>
        In this example, (a continuation of the above example,) the control ID determines if the user has
        double clicked on the employee job duties field, or the employee name field.  The event ID is not
        used, or needed. Its purpose in the code snippet is simply an example. The same thing applies to
        the window handle.
      </para>
<programlisting>
<![CDATA[
::method editStats
  use arg ctrlInfo, ctrlHwnd

  ctrlID = .DlgUtil~loWord(ctrlInfo)
  eventID = .DlgUtil~hiWord(ctrlInfo)

  rec = self~getCurrentRecord

  if self~userUpdate(ctrlID, rec) then self~setStats(rec)
]]>
</programlisting>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="connecteditnotify"><title>ConnectEditNotify</title>
<indexterm><primary>ConnectEditNotify</primary></indexterm>
<programlisting>
<![CDATA[
>>-aMessageExtensions~ConnectEditNotify(--id--,--"--+-CHANGE----+--"-->
                                                    +-UPDATE----+
                                                    +-ERRSPACE--+
                                                    +-MAXTEXT---+
                                                    +-HSCROLL---+
                                                    +-VSCROLL---+
                                                    +-GOTFOCUS--+
                                                    +-LOSTFOCUS-+

>--+---------------+--)----------------------------------------------><
   +-,--msgToRaise-+


]]>
</programlisting>

<para>The ConnectEditNotify method connects a particular
WM_NOTIFY message for an edit control with a method. The WM_NOTIFY message
informs the dialog that an event has occurred with regard to the edit control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the edit control of which a notification is to be connected
to a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem><para>The event to be connected with a method:
<variablelist>
<varlistentry><term>CHANGE</term>
<listitem><para>The text has been altered. This notification is sent after the screen
has been updated.
</para></listitem></varlistentry>
<varlistentry><term>UPDATE</term>
<listitem><para>The text has been altered. This notification is sent before the screen
is updated.
</para></listitem></varlistentry>
<varlistentry><term>ERRSPACE</term>
<listitem><para>An out-of-memory problem has occurred.
</para></listitem></varlistentry>
<varlistentry><term>MAXTEXT</term>
<listitem><para>The text inserted exceeds the specified number of characters for the
edit control. This notification is also sent when:
<itemizedlist>
<listitem><para>An edit control does not have the ES_AUTOHSCROLL or AUTOSCROLLH style
and the number of characters to be inserted would exceed the width of the
edit control.</para></listitem></itemizedlist>
<itemizedlist>
<listitem><para>The ES_AUTOVSCROLL or AUTOSCROLLV style is not set and the total number
of lines resulting from a text insertion would exceed the height of the edit
control.</para></listitem></itemizedlist>
</para></listitem></varlistentry>
<varlistentry><term>HSCROLL</term>
<listitem><para>The horizontal scroll bar has been used.
</para></listitem></varlistentry>
<varlistentry><term>VSCROLL</term>
<listitem><para>The vertical scroll bar has been used.
</para></listitem></varlistentry>
<varlistentry><term>GOTFOCUS</term>
<listitem><para>The edit control got the input focus.
</para></listitem></varlistentry>
<varlistentry><term>LOSTFOCUS</term>
<listitem><para>The edit control lost the input focus.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent whenever the specified notification is
received from the edit control. Provide a method with a matching name. If
you omit this argument, the event is preceded by <computeroutput>On</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error detected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The message was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example verifies the input of entry line AMOUNT and resets
it to 0 when a nonnumeric value was entered:
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method Init
  self~init:super(...)
  self~ConnectEditNotify("AMOUNT", "CHANGE")

::method OnChange
  ec = self~GetEditControl("AMOUNT")
  if ec~GetText~Space(0) \= "" & ec~GetText~DataType("N") = 0 then do
    ec~SetModified(0)
    ec~Select
    ec~ReplaceSelText("0")
   end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Notes</title>
<orderedlist>
<listitem><para>Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods are defined, use init as the place for this connection - but not
before init:super has been called.</para></listitem>
<listitem><para>The event-handling methods receive two arguments: the ID of the edit control
(extract the low-order word) and the handle to the edit control.</para>
<para><emphasis role="bold">Example:</emphasis></para>
<programlisting>
<![CDATA[
::method Handler
  use arg ev_id, handle
  id = .DlgUtil~loWord(ev_id)
  ...
]]>
</programlisting></listitem>
</orderedlist>
</note>
</section>

<section id="mthConnectListBoxEvent"><title>connectListBoxEvent</title>
<indexterm><primary>connectListBoxEvent</primary></indexterm>
<programlisting>
<![CDATA[
>>-aMessageExtensions~connectListBoxEvent(--id--,--"--+-DBLCLK----+--"-->
                                                       +-ERRSPACE--+
                                                       +-GOTFOCUS--+
                                                       +-LOSTFOCUS-+
                                                       +-SELCANCEL-+
                                                       +-SELCHANGE-+

>--+---------------+--)-------------------------------------------------><
   +-,--msgToRaise-+


]]>
</programlisting>

<para>The connectListBoxEvent method connects a particular
WM_NOTIFY message for a list box with a method. The WM_NOTIFY message
informs the dialog that an event has occurred in the list box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the list box of which a notification is to be connected to
a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem><para>The event to be connected with a method:
<variablelist>
<varlistentry><term>DBLCLK</term>
<listitem><para>An entry in the list box has been selected with a double click.
</para></listitem></varlistentry>
<varlistentry><term>ERRSPACE</term>
<listitem><para>An out-of-memory problem has occurred.
</para></listitem></varlistentry>
<varlistentry><term>GOTFOCUS</term>
<listitem><para>The list box got the input focus.
</para></listitem></varlistentry>
<varlistentry><term>LOSTFOCUS</term>
<listitem><para>The list box lost the input focus.
</para></listitem></varlistentry>
<varlistentry><term>SELCANCEL</term>
<listitem><para>The selection in the list box has been canceled.
</para></listitem></varlistentry>
<varlistentry><term>SELCHANGE</term>
<listitem><para>Another list box entry has been selected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent whenever the specified notification is
received from the list box. Provide a method with a matching name. If you
omit this argument, the event is preceded by <computeroutput>On</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error detected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The message was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the text of the selected list box entry:
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method Init
  self~init:super(...)
  self~connectListBoxEvent("MYLIST", "SELCHANGE", "SelectionChanged")

::method SelectionChanged
  li = self~GetListBox("MYLIST")
  say "New selection is:" li~Selected
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>


<note><title>Notes</title><para>
<orderedlist>
<listitem><para>Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods are defined, use init as the place for this connection - but not
before init:super has been called.</para></listitem>
<listitem><para>The event-handling methods receive two arguments: the ID of the list box
(extract the low-order word) and the handle to the list box. Example:
<programlisting>
<![CDATA[
::method Handler
  use arg ev_id, handle
  id = .DlgUtil~loWord(ev_id)
  ...
]]>
</programlisting></para></listitem>
</orderedlist>
</para></note>
</section>

<section id="mthConnectComboBoxEvent"><title>connectComboBoxEvent</title>
<indexterm><primary>connectComboBoxEvent</primary></indexterm>
<programlisting>
<![CDATA[
>>-aMessageExtensions~connectComboBoxEvent(--id--,--"--+-CHANGE-------+--"-->
                                                        +-UPDATE-------+
                                                        +-CLOSEUP------+
                                                        +-DROPDOWN-----+
                                                        +-DBLCLK-------+
                                                        +-ERRSPACE-----+
                                                        +-GOTFOCUS-----+
                                                        +-LOSTFOCUS----+
                                                        +-SELCHANGE----+
                                                        +-SELENDOK-----+
                                                        +-SELENDCANCEL-+

>--+---------------+--)----------------------------------------------------><
   +-,--msgToRaise-+


]]>
</programlisting>

<para>The connectComboBoxEvent method connects a particular
WM_NOTIFY message for a combo box with a method. The WM_NOTIFY message
informs the dialog that an event has occurred in the combo box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The <link linkend="defResourceId">resource ID</link> of the combo
box for which a notification is to be connected to a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem><para>The event to be connected with a method:
<variablelist>
<varlistentry><term>CHANGE</term>
<listitem><para>The text in the edit control has been altered. This notification is
sent after Windows updated the screen.
</para></listitem></varlistentry>
<varlistentry><term>UPDATE</term>
<listitem><para>The text in the edit control has been altered. This notification is
sent before Windows updates the screen.
</para></listitem></varlistentry>
<varlistentry><term>CLOSEUP</term>
<listitem><para>The list of the combo box has been closed.
</para></listitem></varlistentry>
<varlistentry><term>DROPDOWN</term>
<listitem><para>The list of the combo box is about to be made visible.
</para></listitem></varlistentry>
<varlistentry><term>DBLCLK</term>
<listitem><para>An entry in the combo box list has been selected with a double click.
</para></listitem></varlistentry>
<varlistentry><term>ERRSPACE</term>
<listitem><para>An out-of-memory problem has occurred.
</para></listitem></varlistentry>
<varlistentry><term>GOTFOCUS</term>
<listitem><para>The combo box got the input focus.
</para></listitem></varlistentry>
<varlistentry><term>LOSTFOCUS</term>
<listitem><para>The combo box lost the input focus.
</para></listitem></varlistentry>
<varlistentry><term>SELCHANGE</term>
<listitem><para>Another entry in the combo box list has been selected.
</para></listitem></varlistentry>
<varlistentry><term>SELENDOK</term>
<listitem><para>The list was closed after another entry was selected.
</para></listitem></varlistentry>
<varlistentry><term>SELENDCANCEL</term>
<listitem><para>After the selection of another entry, another control or dialog was
selected, which canceled the selection of the entry.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent whenever the specified notification is
received from the combo control. Provide a method with a matching name. If
you omit this argument, the event is preceded by <computeroutput>On</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>No errors were detected.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The message was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example invokes method PlaySong whenever the list
of the combo box with the resource ID of PROFESSIONS is about to be made
visible.  In this case PROFESSIONS is a <link linkend="defSymbolicId">symbolic
ID</link> that has been added to the <link linkend="atrConstDir">constDir</link>
directory of the MyDlgClass in another part of the program:
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method InitDialog
  self~init:super(...)
  self~connectComboBoxEvent("PROFESSIONS", "DROPDOWN", "PlaySong")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Notes</title><para>
<orderedlist>
<listitem><para>Connections are usually placed in the <link
linkend="h000025">Init</link>  or <link linkend="mthInitDialog">InitDialog</link>
method. If both methods are defined, use init as the place for this connection -
but not before init:super has been called.</para></listitem>
<listitem><para>The event-handling methods receive two arguments: the first is a
combination of the ID of the combo box and the ID of the notification messages.
(Extract the low-order word to get the combo box ID.)  The second argument is
the window handle of the combo box. Example:
<programlisting>
<![CDATA[
::method PlaySong
  use arg eventID, handle
  id = .DlgUtil~loWord(eventID)
  if id == self~constDir["PROFESSIONS"] then
    -- take some action
  ...
]]>
</programlisting></para></listitem>
</orderedlist>
</para></note>
</section>

<section id="connectscrollbarnotify"><title>ConnectScrollBarNotify</title>
<indexterm><primary>ConnectScrollBarNotify</primary></indexterm>
<programlisting>
<![CDATA[
>>-aMessageExtensions~ConnectScrollBarNotify(--id--,--"--+-UP--------+--"-->
                                                         +-DOWN------+
                                                         +-TOP-------+
                                                         +-BOTTOM----+
                                                         +-PAGEUP----+
                                                         +-PAGEDOWN--+
                                                         +-DRAG------+
                                                         +-ENDSCROLL-+
                                                         +-POSITION--+

>--+---------------+--)---------------------------------------------------><
   +-,--msgToRaise-+


]]>
</programlisting>

<para>The ConnectScrollBarNotify method connects a particular
WM_NOTIFY message for a scroll bar with a method. The WM_NOTIFY message
informs the dialog that an event has occurred with regard to the scroll bar.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the scroll bar of which a notification is to be connected
to a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem><para>The event to be connected with a method:
<variablelist>
<varlistentry><term>UP</term>
<listitem><para>The scroll bar was scrolled to the left or up by one unit.
</para></listitem></varlistentry>
<varlistentry><term>DOWN</term>
<listitem><para>The scroll bar was scrolled to the right or down by one unit.
</para></listitem></varlistentry>
<varlistentry><term>TOP</term>
<listitem><para>The scroll bar was scrolled to the upper left.
</para></listitem></varlistentry>
<varlistentry><term>BOTTOM</term>
<listitem><para>The scroll bar was scrolled to the lower right.
</para></listitem></varlistentry>
<varlistentry><term>PAGEUP</term>
<listitem><para>The scroll bar was scrolled to the left or up by one page size.
</para></listitem></varlistentry>
<varlistentry><term>PAGEDOWN</term>
<listitem><para>The scroll bar was scrolled to the right or down by one page size.
</para></listitem></varlistentry>
<varlistentry><term>DRAG</term>
<listitem><para>The scroll bar has been dragged.
</para></listitem></varlistentry>
<varlistentry><term>ENDSCROLL</term>
<listitem><para>Scrolling has been ended, that is, the appropriate key or mouse button
has been released.
</para></listitem></varlistentry>
<varlistentry><term>POSITION</term>
<listitem><para>The scroll bar was scrolled to an absolute position (the left mouse
button has been released).
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent whenever the specified notification is
received from the scroll bar. Provide a method with a matching name. If you
omit this argument, the event is preceded by <computeroutput>On</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error detected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The messages was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example connects the POSITION event with method OnPosition,
which extracts the new position from the notification arguments and stores
it for the scroll bar. It also displays the new position and the event type
for POSITION, which is to be 4:
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method InitDialog
  self~InitDialog:super(...)
  self~ConnectScrollBarNotify("MYSCROLL", "POSITION")

::method OnPosition
  use arg ev_pos, hnd
  pos = .DlgUtil~hiWord(ev_pos)

  -- redraw scroll bar with new position
  self~GetScrollBar("MYSCROLL")~setPos(pos,1)

  say "Pos:" pos
  say "Verify event code (should be 4):" .DlgUtil~loWord(ev_pos)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Notes</title>
<orderedlist>
<listitem><para>The method can only be called after the scroll bar was created by Windows. A good location for this connection is the InitDialog method.</para></listitem>
<listitem><para>The event-handling methods receive two arguments: an event-position pair
and the handle to the scroll bar. You can retrieve the scroll bar position
by extracting the high-order word.</para>
<para><emphasis role="bold">Example:</emphasis></para>
<programlisting>
<![CDATA[
::method Handler
  use arg ev_pos, handle
  position = .DlgUtil~hiWord(ev_pos)
]]>
</programlisting>
<para>If the user changed the
scroll bar position, you must set the scroll bar position with <link linkend="setpos">setPos</link> to
keep the selected position.</para></listitem>
</orderedlist>
</note>
</section>

<section id="connecttabnotify"><title>ConnectTabNotify</title>
<indexterm><primary>ConnectTabNotify</primary></indexterm>
<programlisting>
<![CDATA[
>>-aMessageExtensions~ConnectTabNotify(--id--,--"--+-KEYDOWN-----+--"-->
                                                   +-SELCHANGE---+
                                                   +-SELCHANGING-+

>--+---------------+--)-----------------------------------------------><
   +-,--msgToRaise-+


]]>
</programlisting>

<para>The ConnectTabNotify method connects a particular
WM_NOTIFY message for a tab control with a method. The WM_NOTIFY message
informs the dialog that an event has occurred with regard to the tab control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the tab control of which a notification is to be connected
to a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem><para>The event to be connected with a method:
<variablelist>
<varlistentry><term>KEYDOWN</term>
<listitem><para>A key has been pressed while the tab control was focused.
</para></listitem></varlistentry>
<varlistentry><term>SELCHANGE</term>
<listitem><para>Another tab has been selected in the tab control. This method is called
after the selection was changed.
</para></listitem></varlistentry>
<varlistentry><term>SELCHANGING</term>
<listitem><para>Another tab has been selected in the tab control. This method is called
before the selection is changed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent whenever the specified notification is
received from the tab control. Provide a method with a matching name. If you
omit this argument, the event is preceded by <computeroutput>On</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error detected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The messages was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example invokes method OnSelChange whenever another tab
is selected in the tab control PAGE:
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method Init
  self~init:super(...)
  self~ConnectTabNotify("PAGE", "SELCHANGE")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Notes</title><para>
<orderedlist>
<listitem><para>Connections are usually placed in the <link linkend="h000025">Init</link> or <link linkend="mthInitDialog">InitDialog</link> method. If both methods are defined, use init as the place for this connection - but not
before init:super has been called.</para></listitem>
<listitem><para>The event-handling method that is connected to KEYDOWN receives two arguments:
the control ID of the tab control and the virtual key code that has been pressed.
Use the method <link linkend="keyname">KeyName</link> of the VirtualKeyCodes class to get
the name of the key. Note that your class must inherit from the VirtualKeyCodes
class to use the KeyName method. Example:
<programlisting>
<![CDATA[
::method OnKeyDown
  use arg id, vkey
  say "Key" self~KeyName(vkey) "was pressed."
]]>
</programlisting></para></listitem>
<listitem><para>All other event-handling methods receive two arguments: the ID of the
tab control (extract the low-order word) and the handle to the tab control.
Example:
<programlisting>
<![CDATA[
::method Handler
  use arg ev_id, handle
  id = .DlgUtil~loWord(ev_id)
]]>
</programlisting></para></listitem>
</orderedlist>
</para></note>
</section>

<section id="connectslidernotify"><title>ConnectSliderNotify</title>
<indexterm><primary>ConnectSliderNotify</primary></indexterm>
<programlisting>
<![CDATA[
>>-aMessageExtensions~ConnectSliderNotify(--id--,--"--+-UP-------+--"-->
                                                      +-DOWN-----+
                                                      +-TOP------+
                                                      +-BOTTOM---+
                                                      +-PAGEUP---+
                                                      +-PAGEDOWN-+
                                                      +-DRAG-----+
                                                      +-POSITION-+
                                                      +-ENDTRACK-+

>--+---------------+--)----------------------------------------><
   +-,--msgToRaise-+


]]>
</programlisting>

<para>The ConnectSliderNotify method connects a particular
WM_NOTIFY message for a slider control, which is also called a track bar,
with a method. The WM_NOTIFY message informs the dialog that an event has
occurred with regard to the slider control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the slider control of which a notification is to be connected
to a method.
</para></listitem></varlistentry>
<varlistentry><term>event</term>
<listitem><para>The event to be connected with a method:
<variablelist>
<varlistentry><term>UP</term>
<listitem><para>The Up or right key has been pressed.
</para></listitem></varlistentry>
<varlistentry><term>DOWN</term>
<listitem><para>The Down or left key has been pressed.
</para></listitem></varlistentry>
<varlistentry><term>TOP</term>
<listitem><para>The Home key has been pressed.
</para></listitem></varlistentry>
<varlistentry><term>BOTTOM</term>
<listitem><para>The End key has been pressed.
</para></listitem></varlistentry>
<varlistentry><term>PAGEUP</term>
<listitem><para>The PgUp key has been pressed.
</para></listitem></varlistentry>
<varlistentry><term>PAGEDOWN</term>
<listitem><para>The PgDn key has been pressed.
</para></listitem></varlistentry>
<varlistentry><term>DRAG</term>
<listitem><para>The slider has been moved.
</para></listitem></varlistentry>
<varlistentry><term>POSITION</term>
<listitem><para>The left mouse button has been released, following a DRAG notification.
</para></listitem></varlistentry>
<varlistentry><term>ENDTRACK</term>
<listitem><para>The slider movement is completed, that is, the appropriate key or mouse
button has been released.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>msgToRaise</term>
<listitem><para>The message that is to be sent whenever the specified notification is
received from the slider control. Provide a method with a matching name. If
you omit this argument, the event is preceded by <computeroutput>On</computeroutput>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return codes are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>No error detected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>The resource ID could not be resolved or the event argument is
incorrect.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>The messages was not connected correctly.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example connects the POSITION event (release mouse button
after dragging) with method PosSet, which extracts the new slider position
from the notification arguments and displays it together with the event type
for POSITION, which should be 4:
<programlisting>
<![CDATA[
::class MyDlgClass subclass UserDialog

::method InitDialog
  self~InitDialog:super(...)
  self~ConnectSliderNotify("MYSLIDER", "POSITION", PosSet)

::method PosSet
  use arg ev_pos, hnd
  pos = .DlgUtil~hiWord(ev_pos)

  say "Verify event code (should be 4):" .DlgUtil~loWord(ev_pos)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>

<note><title>Notes</title><para>
<orderedlist>
<listitem><para>The method can only be called after the slider was created by Windows.
A good location for this connection is the InitDialog method.</para></listitem>
<listitem><para>The event-handling methods receive two arguments: an event-position pair
and the handle to the slider control. For some events, you can retrieve the
slider position by extracting the high-oder word. Example:
<programlisting>
<![CDATA[
::method Handler
  use arg ev_pos, handle
  position = .DlgUtil~hiWord(ev_pos)
]]>
</programlisting></para></listitem>
</orderedlist>
</para></note>
</section>

<section id="mthDefListDragHandler"><title>defListDragHandler</title>
<indexterm><primary>defListDragHandler</primary></indexterm>
<programlisting>
<![CDATA[
>>-defListDragHandler(--id--,--item--,--point--)---------------><


]]>
</programlisting>

<para>
  A list view control does not handle a drag-and-drop operation itself. It defers that handling to the programmer by
  sending a BEGINGDRAG, (left mouse drag,) or a BEGINRDRAG, (right mouse drag,) event notification. The programmer can
  code his own <link linkend="ovvEvents">event</link> handling method and use <link
  linkend="mthConnectListViewEvent">connectListViewEvent</link>() method to connect the method to the drag-and-drop
  operation.
</para>
<para>
  The <emphasis role="italic">defListDragHandler</emphasis> method is an event handling method supplied by the ooDialog
  framework and the programmer can use this method rather than code his own.
</para>
<para>
  This method implementation allows the user to drag an item from one location to another within an icon view and
  a small icon view. The cursor shape is changed to a crosshair during the drag operation. The user can cancel the drag
  operation by clicking the other mouse button while holding the button that started the drag operation. Note that the
  final icon position is not flexible when the list view control has the AUTOARRANGE style.
</para>
<para>
  If the programmer wants to implement her own drag-and-drop event handler, she may want to examine the how the
  <emphasis role="italic">defListDragHandler</emphasis> method in the <computeroutput>ooDialog.cls</computeroutput>
  file. In addition the <computeroutput>oodlist.rex</computeroutput> example progam uses the <emphasis
  role="italic">defListDragHandler</emphasis>. Running the example program will show the behavior of the current
  <emphasis role="italic">defListDragHandler</emphasis> implementation.
</para>
<para>
  <emphasis role="bold">Example:</emphasis>
<programlisting>
<![CDATA[
::method initDialog

  ...

  self~connectListViewEvent(ID_LV_ICON, "BEGINDRAG", "defListDragHandler")
  -- Drag and drop operations are not automatically handled.
]]>
</programlisting>
</para>
</section>

<section id="mthDefTreeDragHandler"><title>defTreeDragHandler</title>
<indexterm><primary>defTreeDragHandler</primary></indexterm>
<programlisting>
<![CDATA[
>>-defTreeDragHandler(--id--,--item--,--point--)---------------><


]]>
</programlisting>

<para>
  A tree view control does not handle a drag-and-drop operation itself. It defers that handling to the programmer by
  sending a BEGINGDRAG, (left mouse drag,) or a BEGINRDRAG, (right mouse drag,) event notification. The programmer can
  code his own <link linkend="ovvEvents">event</link> handling method and use <link
  linkend="mthConnectTreeViewEvent">connectTreeViewEvent</link>() method to connect the method to the drag-and-drop
  operation.
</para>
<para>
  The <emphasis role="italic">defTreeDragHandler</emphasis> method is an event handling method supplied by the ooDialog
  framework and the programmer can use this method rather than code his own.
</para>
<para>
  This method implementation allows the user to move an item, or a node with all its subitems, from one parent node to
  another within the tree view. The cursor shape is changed to a crosshair during the drag operation. If the cursor is
  moved over the item dragged, the cursor shape is changed to a slashed circle. The user can cancel the drag operation
  by clicking the other mouse button while holding the button that started the drag operation.
</para>
<para>
  If the programmer wants to implement her own drag-and-drop event handler, she may want to examine the how the
  <emphasis role="italic">defTreeDragHandler</emphasis> method in the <computeroutput>ooDialog.cls</computeroutput>
  file. In addition both the <computeroutput>oodtree.rex</computeroutput> and
  <computeroutput>propdemo.rex</computeroutput> example progams uses the <emphasis
  role="italic">defTreeDragHandler</emphasis>. Running these example programs will show the behavior of the current
  <emphasis role="italic">defTreeDragHandler</emphasis> implementation.
</para>
<para>
  <emphasis role="bold">Example:</emphasis>
<programlisting>
<![CDATA[
::method initDialog

  ...

  self~connectTreeViewEvent("IDC_TREE","BEGINDRAG", "defTreeDragHandler")
  -- Drag and drop operations are not automatically handled.
]]>
</programlisting>
</para>
</section>

<section id="deprecatedEventNotification"><title>Deprecated Methods</title>
<indexterm><primary>Deprecated</primary><secondary>EventNotification methods</secondary></indexterm>
<para>
  Earlier versions of ooDialog used a confusing array of method names with the word <emphasis
  role="italic">connect</emphasis> in them. After the release of ooRexx 4.0.0, an effort was made to unify the method
  names in ooDialog. The methods listed in this section are all <link linkend="ovvDeprecated">deprecated</link>. They
  all forward to the method that has taken their place. You can remove this level of indirection in your programs by
  replacing all of the deprecated methods.
</para>

<section><title>connectButtonNotify</title>
<indexterm><primary>Deprecated</primary><secondary>connectButtonNotify</secondary></indexterm>
<indexterm><primary>Deprecated</primary><secondary>EventNotification</secondary><tertiary>connectButtonNotify</tertiary></indexterm>
<para>
  This method is <link linkend="ovvDeprecated">deprecated</link>. Replace this method with the <link
  linkend="mthConnectButtonEvent">connectButtonEvent</link>() method.
</para>
</section>

<section><title>connectListNotify</title>
<indexterm><primary>Deprecated</primary><secondary>connectListNotify</secondary></indexterm>
<indexterm><primary>Deprecated</primary><secondary>EventNotification</secondary><tertiary>connectListNotify</tertiary></indexterm>
<para>
  This method is <link linkend="ovvDeprecated">deprecated</link>. Replace this method with the <link
  linkend="mthConnectListViewEvent">connectListViewEvent</link>() method.
</para>
</section>

<section><title>connectListViewNotify</title>
<indexterm><primary>Deprecated</primary><secondary>connectListViewNotify</secondary></indexterm>
<indexterm><primary>Deprecated</primary><secondary>EventNotification</secondary><tertiary>connectListViewNotify</tertiary></indexterm>
<para>
  This method is <link linkend="ovvDeprecated">deprecated</link>. Replace this method with the <link
  linkend="mthConnectListViewEvent">connectListViewEvent</link>() method.
</para>
</section>

</section>

</section>
