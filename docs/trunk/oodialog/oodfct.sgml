<!--#########################################################################
    #
    # Description: Open Object Rexx: OODialog Reference SGML file.
    #
    # Copyright (c) 2005-2007, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="oodfct"><title>OODialog External Functions</title>
<indexterm><primary>OODialog external functions</primary></indexterm>
<para>OODialog provides the following callable functions that can be used in
your Object Rexx programs. </para>
<variablelist>
<varlistentry><term>InfoMessage
<indexterm><primary>InfoMessage</primary></indexterm>
</term>
<listitem><para>Displays an information message window:
<programlisting>
<![CDATA[
call InfoMessage "some message text"
ret = InfoMessage("another text")
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>ErrorMessage
<indexterm><primary>ErrorMessage</primary></indexterm>
</term>
<listitem><para>Displays an error message window:
<programlisting>
<![CDATA[
call ErrorMessage "some error message text"
ret = ErrorMessage("another error message")
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>YesNoMessage
<indexterm><primary>YesNoMessage</primary></indexterm>
</term>
<listitem><para>Displays a message and ask the user for a YES or NO answer:
<programlisting>
<![CDATA[
ret = YesNoMessage("Delete these files?", "No")
if ret=1 then /* this is yes */
]]>
</programlisting>
</para>
<para>The second argument is optional and can have a value of either Yes or
No. An argument of Yes gives the Yes button the default focus, No gives the No
button the default focus. If the argument is omitted the Yes button is given
the default focus. Only the first letter of the argument is significant
and case is not significant. See also the function
<link linkend="askdialog">AskDialog</link>.
</para></listitem></varlistentry>
<varlistentry><term>GetScreenSize
<indexterm><primary>GetScreenSize</primary></indexterm>
</term>
<listitem><para>Queries the monitor size in dialog units and pixels:
<programlisting>
<![CDATA[
val = GetScreenSize()
parse var val dunitx dunity pixelx pixely
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>PlaySoundFile
<indexterm><primary>PlaySoundFile</primary></indexterm>
</term>
<listitem><para>Plays a sound file (.WAV):</para>
<programlisting>
<![CDATA[
call PlaySoundFile "d:\wav\sound.wav"
ret = PlaySoundFile("d:\wav\sound.wav","YES")
]]>
</programlisting>
<para>The optional second
parameter YES plays the file asynchronously, that is the program continues
execution. See also the routine <link linkend="h001666">Play</link>.
</para></listitem></varlistentry>
<varlistentry><term>PlaySoundFileInLoop
<indexterm><primary>PlaySoundFileInLoop</primary></indexterm>
</term>
<listitem><para>Plays a sound file (.WAV) continuously and asynchronously:
<programlisting>
<![CDATA[
call PlaySoundFileInLoop "d:\wav\sound.wav"
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>StopSoundFile
<indexterm><primary>StopSoundFile</primary></indexterm>
</term>
<listitem><para>Stops playing an asynchronous sound file (.WAV):
<programlisting>
<![CDATA[
call StopSoundFile
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>GetFileNameWindow
<indexterm><primary>GetFileNameWindow</primary></indexterm>
</term>
<listitem><para>Displays an Open File window:</para>
<programlisting>
<![CDATA[
file = GetFileNameWindow(filename,handle,filter,loadorsave,title, ,
                         defExtension,multiSelect,sepChar)
]]>
</programlisting>
<para>Parameters (optional):</para>
<variablelist>
<varlistentry><term><emphasis role="italic">filename</emphasis></term>
<listitem><para>A preselected name.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">handle</emphasis></term>
<listitem><para>The parent window handle.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">filter</emphasis></term>
<listitem><para>A file mask specification.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">loadorsave</emphasis></term>
<listitem><para>If you specify 1, which is the default, you get the file name for a
load operation. If you specify 0, you get the file name for a save operation.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">title</emphasis></term>
<listitem><para>The window title. The default is &quot;Open a File&quot; or &quot;Save
File As&quot;, depending on what you specify for <emphasis role="italic">loadorsave</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">defExtension</emphasis></term>
<listitem><para>The default extension that is added if no extension was specified. The
default is TXT.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">multiSelect</emphasis></term>
<listitem><para>If you specify 1, you can select several files. In this case,
<emphasis role="italic">loadorsave</emphasis> must also be 1. The result is
then <emphasis role="italic">path file1 file2 file3 ...</emphasis>.</para>
<para>If you specify 0 or omit this parameter, you get the selected file name or
an empty string when the Open File window is canceled.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="italic">sepChar</emphasis></term>
<listitem><para>Specifies which character should be used for separating the file names
when <emphasis role="italic">multiSelect</emphasis> = 1.</para>
<para>This is needed for file names with blank
characters. If this argument is omitted, the separation character is a blank.
If the argument is specified, the returned path and file name
uses this separation character. For example, if you specify "#" as the separation
character, the return string might look as follows: </para>
<programlisting>
<![CDATA[
C:\WINNT#file with blank.ext#fileWithNoBlank.TXT
]]>
</programlisting>
</listitem></varlistentry>
</variablelist>
<para><emphasis role="bold">Example:</emphasis></para>
<programlisting>
"Text files (*.txt)"&apos;0&apos;x"*.TXT"&apos;0&apos;x ,
"All files (*.*)"&apos;0&apos;x"*.*"
</programlisting>
</listitem></varlistentry>
<varlistentry><term>SleepMS
<indexterm><primary>SleepMS</primary></indexterm>
</term>
<listitem><para>Sleeps for a given time interval, in milliseconds:
<programlisting>
<![CDATA[
call SleepMS(3000) /* 3 seconds */
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>WinTimer
<indexterm><primary>WinTimer</primary></indexterm>
</term>
<listitem><para>Starts, stops, and waits for a windows timer:
<programlisting>
<![CDATA[
tid = WinTimer("START",300)   /* 0,3 seconds */
call  WinTimer("WAIT,tid)     /* wait... */
ret = WinTimer("STOP",tid)    /* stop premature */
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
<para>OODialog functions are registered automatically when the first dialog is
initialized. If no dialog has been created, register individual functions
with: </para>
<programlisting>
<![CDATA[
call RxFuncAdd functionname, "OODialog", functionname
]]>
</programlisting>
<para>To register all OODialog functions: </para>
<programlisting>
<![CDATA[
call RxFuncAdd InstMMFuncs, "OODialog", InstMMFuncs
call InstMMFuncs
]]>
</programlisting>
<para>A more convenient way to call these functions is provided by the <link linkend="man6666">Public Routines</link>.</para>
<para>The standard dialog classes can also be executed as callable functions.
These functions are described with their respective classes in <link linkend="man0099">Standard Dialog Classes and Functions</link>.</para>
</chapter>
