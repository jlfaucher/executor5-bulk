<!--#########################################################################
    #
    # Description: Open Object Rexx: OODialog Reference SGML file.
    #
    # Copyright (c) 2005-2007, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="treecontrolc"><title>TreeControl Class</title>
<indexterm><primary>TreeControl class</primary></indexterm>
<para>The tree view control is a dialog that displays a hierarchical list of
items, such as the headings in a document, the entries in an index, or the
files and directories on a disk. Each item consists of a label and an optional
image bitmap, and can have a list of subitems associated with it. By clicking
on an item, the user can expand and collapse the associated list of subitems.</para>
<para>Refer to OODTREE.REX in the OODIALOG\SAMPLES directory for an example.</para>
<variablelist>
<varlistentry><term>Requires:</term>
<listitem><para>The TreeControl class requires the class definition
file <computeroutput>oodwin32.cls</computeroutput>:
<programlisting>
<![CDATA[
::requires "oodwin32.cls"
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>Methods:</term>
<listitem><para>Instances of the TreeControl class implement
the methods listed in the
<link linkend="t000032">TreeControl Instance Methods</link> table.</para>

<table id="t000032" frame="all">
<title>TreeControl Instance Methods</title>
<tgroup cols="2">
<thead>
<row>
<entry>Method...</entry>
<entry>...on page</entry>
</row>
</thead>
<tbody>
<row>
<entry>Add</entry>
<entry><link linkend="addtrc">Add</link></entry>
</row>
<row>
<entry>Child</entry>
<entry><link linkend="child">Child</link></entry>
</row>
<row>
<entry>Collapse</entry>
<entry><link linkend="collapse">Collapse</link></entry>
</row>
<row>
<entry>CollapseAndReset</entry>
<entry><link linkend="collapseandreset">CollapseAndReset</link></entry>
</row>
<row>
<entry>Delete</entry>
<entry><link linkend="deletetrc">Delete</link></entry>
</row>
<row>
<entry>DeleteAll</entry>
<entry><link linkend="deletealltrc">DeleteAll</link></entry>
</row>
<row>
<entry>DropHighlight</entry>
<entry><link linkend="drophighlight">DropHighlight</link></entry>
</row>
<row>
<entry>DropHighlighted</entry>
<entry><link linkend="drophighlightedtrc">DropHighlighted</link></entry>
</row>
<row>
<entry>Edit</entry>
<entry><link linkend="edittrc">Edit</link></entry>
</row>
<row>
<entry>EndEdit</entry>
<entry><link linkend="endedittrc">EndEdit</link></entry>
</row>
<row>
<entry>EnsureVisible</entry>
<entry><link linkend="ensurevisibletrc">EnsureVisible</link></entry>
</row>
<row>
<entry>Expand</entry>
<entry><link linkend="expand">Expand</link></entry>
</row>
<row>
<entry>FirstVisible</entry>
<entry><link linkend="firstvisibletrc">FirstVisible</link></entry>
</row>
<row>
<entry>HitTest</entry>
<entry><link linkend="hittest">HitTest</link></entry>
</row>
<row>
<entry>Indent</entry>
<entry><link linkend="indent">Indent</link></entry>
</row>
<row>
<entry>Indent=</entry>
<entry><link linkend="indentnew">Indent=</link></entry>
</row>
<row>
<entry>Insert</entry>
<entry><link linkend="inserttrc">Insert</link></entry>
</row>
<row>
<entry>IsAncestor</entry>
<entry><link linkend="isancestor">IsAncestor</link></entry>
</row>
<row>
<entry>ItemInfo</entry>
<entry><link linkend="iteminfotrc">ItemInfo</link></entry>
</row>
<row>
<entry>Items</entry>
<entry><link linkend="itemstrc">Items</link></entry>
</row>
<row>
<entry>MakeFirstVisible</entry>
<entry><link linkend="makefirstvisibletrc">MakeFirstVisible</link></entry>
</row>
<row>
<entry>Modify</entry>
<entry><link linkend="modifytrc">Modify</link></entry>
</row>
<row>
<entry>MoveItem</entry>
<entry><link linkend="moveitem">MoveItem</link></entry>
</row>
<row>
<entry>Next</entry>
<entry><link linkend="nexttrc">Next</link></entry>
</row>
<row>
<entry>NextVisible</entry>
<entry><link linkend="nextvisible">NextVisible</link></entry>
</row>
<row>
<entry>Parent</entry>
<entry><link linkend="parent">Parent</link></entry>
</row>
<row>
<entry>Previous</entry>
<entry><link linkend="previoustrc">Previous</link></entry>
</row>
<row>
<entry>PreviousVisible</entry>
<entry><link linkend="previousvisible">PreviousVisible</link></entry>
</row>
<row>
<entry>RemoveImages <emphasis role="bold">(deprecated)</emphasis></entry>
<entry><link linkend="removeimagestrc">RemoveImages</link> <emphasis role="bold">(deprecated)</emphasis></entry>
</row>
<row>
<entry>RestoreEditClass</entry>
<entry><link linkend="restoreeditclasstrc">RestoreEditClass</link></entry>
</row>
<row>
<entry>Root</entry>
<entry><link linkend="root">Root</link></entry>
</row>
<row>
<entry>Select</entry>
<entry><link linkend="selecttrc">Select</link></entry>
</row>
<row>
<entry>Selected</entry>
<entry><link linkend="selectedtrc">Selected</link></entry>
</row>
<row>
<entry>SetImages <emphasis role="bold">(deprecated)</emphasis></entry>
<entry><link linkend="setimagestrc">SetImages</link> <emphasis role="bold">(deprecated)</emphasis></entry>
</row>
<row>
<entry>SortChildren</entry>
<entry><link linkend="sortchildren">SortChildren</link></entry>
</row>
<row>
<entry>SubclassEdit</entry>
<entry><link linkend="subclassedittrc">SubclassEdit</link></entry>
</row>
<row>
<entry>Toggle</entry>
<entry><link linkend="toggle">Toggle</link></entry>
</row>
<row>
<entry>VisibleItems</entry>
<entry><link linkend="visibleitems">VisibleItems</link></entry>
</row>
</tbody></tgroup>
</table>
</listitem></varlistentry>
</variablelist>

<section id="treecmeth"><title>Methods of the TreeControl Class</title>
<para>The following sections describe the individual methods of the TreeControl
class.</para>

<section id="inserttrc"><title>Insert</title>
<indexterm><primary>Insert</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
                                    +-"LAST"--+     +-""---+     +-0-----+
>>-aTreeControl~Insert(--parent--,--+-after---+--,--+------+--,--+-------+--,-->
                                    +-"FIRST"-+     +-text-+     +-image-+
                                    +-"SORT"--+

                                                   +-"0"-+
>--+----------+--,--+------------------------+--,--+-----+--)--><
   +-selImage-+     |    +--------------+    |     +-"1"-+
                    |    V              |    |
                    +-"----+-EXPANDED-+-+--"-+
                           +-BOLD-----+


]]>
</programlisting>

<para>The Insert method inserts a new item in a tree
view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:</para>
<variablelist>
<varlistentry><term>parent</term>
<listitem><para>The handle to the parent item. If you specify &quot;ROOT&quot;,
the item is inserted at the root of the tree view control.
</para></listitem></varlistentry>
<varlistentry><term>after</term>
<listitem><para>The handle to the item after which the new item is to be inserted or
one of the following values:</para>
<variablelist>
<varlistentry><term>&quot;FIRST&quot;</term>
<listitem><para>Inserts the item at the beginning of the list.
</para></listitem></varlistentry>
<varlistentry><term>&quot;LAST&quot;</term>
<listitem><para>Inserts the item at the end of the list. This is the default.
</para></listitem></varlistentry>
<varlistentry><term>&quot;SORT&quot;</term>
<listitem><para>Inserts the item into the list in alphabetical order.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>The text for the item. If you omit this argument, &quot;&quot; is assumed.
</para></listitem></varlistentry>
<varlistentry><term>image</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
to be used when the item is in the non-selected state. If you omit this argument,
the icon with index 0 is used.
</para></listitem></varlistentry>
<varlistentry><term>selImage</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
to be used when the item is in the selected state. If you omit this argument,
the icon specified for <emphasis role="italic">image</emphasis> is used.
</para></listitem></varlistentry>
<varlistentry><term>state</term>
<listitem><para>Specifies the appearance and functionality of the item. It can be a
combination of the following values, separated by a blank:</para>
<variablelist>
<varlistentry><term>EXPANDED</term>
<listitem><para>The item is currently expanded with all child items visible. This only
applies to parent items.
</para></listitem></varlistentry>
<varlistentry><term>BOLD</term>
<listitem><para>The item is shown in bold.</para>
</listitem></varlistentry>
</variablelist>
<para>If you omit this argument, the item is inserted in collapsed and normal
form.</para>
</listitem></varlistentry>
<varlistentry><term>children</term>
<listitem><para>Indicates whether the item has child items associated with it:</para>
<variablelist>
<varlistentry><term>&quot;0&quot;</term>
<listitem><para>The item has no child items, which is the default.
</para></listitem></varlistentry>
<varlistentry><term>&quot;1&quot;</term>
<listitem><para>The item has one or more child items.</para>
<para>You can use this argument to
show an item that does not have any child items, with an expand button. This
allows you to save memory usage by dynamically loading and displaying the
child items only when the user expands the item.</para>
</listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the new item, or 0 for all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example inserts child items when a specific root item
is expanded. The text strings for the items are loaded from a file.
<programlisting>
<![CDATA[
::method OnExpanding_IDC_TREE
  use arg tree, item
  itemFile = "root6.inp"
  curTree = self~GetTreeControl("IDC_TREE")
  itemInfo. = curTree~ItemInfo(item)

  if itemInfo.!TEXT = "Root 6" & \itemInfo.!STATE~POS("EXPANDED") then
  do
    do while lines(itemFile)
      line = linein(itemFile)
      command = "curTree~Insert(item, ,"||line||")"
      interpret command
    end
    curTree~Expand(item)
  end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="addtrc"><title>Add</title>
<indexterm><primary>Add</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
                      +-------+
                      V       |     +-""---+     +-0-----+
>>-aTreeControl~Add(----+---+-+--,--+------+--,--+-------+--,--->
                        +-,-+       +-text-+     +-image-+

                                                   +-"0"-+
>--+----------+--,--+------------------------+--,--+-----+--)--><
   +-selImage-+     |    +--------------+    |     +-"1"-+
                    |    V              |    |
                    +-"----+-EXPANDED-+-+--"-+
                           +-BOLD-----+


]]>
</programlisting>

<para>The Add method adds a new item to a tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:</para>
<variablelist>
<varlistentry><term>,</term>
<listitem><para>The number of commas specifies at which parent the item is to be inserted.
If you omit this argument, the item is inserted as a root item. Each additional
comma inserts the item one level deeper than the item inserted previously.
See the example in the following.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>The text for the item. If you omit this argument, &quot;&quot; is assumed.
</para></listitem></varlistentry>
<varlistentry><term>image</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
to be used when the item is in the non-selected state. If you omit this argument,
the icon with index 0 is used.
</para></listitem></varlistentry>
<varlistentry><term>selImage</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
to be used when the item is in the selected state. If you omit this argument,
the icon specified for <emphasis role="italic">image</emphasis> is used.
</para></listitem></varlistentry>
<varlistentry><term>state</term>
<listitem><para>Specifies the appearance and functionality of the item. It can be a
combination of the following values, separated by a blank:</para>
<variablelist>
<varlistentry><term>EXPANDED</term>
<listitem><para>The item is currently expanded with all child items visible. This only
applies to parent items.</para>
</listitem></varlistentry>
<varlistentry><term>BOLD</term>
<listitem><para>The item is shown in bold.</para>
</listitem></varlistentry>
</variablelist>
<para>If you omit this argument, the item is inserted in collapsed and normal
form.</para>
</listitem></varlistentry>
<varlistentry><term>children</term>
<listitem><para>Indicates whether the item has child items associated with it:</para>
<variablelist>
<varlistentry><term>&quot;0&quot;</term>
<listitem><para>The item has no child items, which is the default.
</para></listitem></varlistentry>
<varlistentry><term>&quot;1&quot;</term>
<listitem><para>The item has one or more child items.</para>
<para>You can use this argument to
show an item that does not have any child items, with an expand button. This
allows you to save memory usage by dynamically loading and displaying the
child items only when the user expands the item.</para>
</listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the new item, or 0 for all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>To get the following tree view:</para>
<itemizedlist>
<listitem><para>Peter</para>
<itemizedlist>
<listitem><para>Mike</para>
<itemizedlist>
<listitem><para>George</para></listitem>
<listitem><para>Monique</para>
<itemizedlist>
<listitem><para>John</para></listitem></itemizedlist></listitem>
<listitem><para>Chris</para></listitem></itemizedlist></listitem>
<listitem><para>Maud</para></listitem>
<listitem><para>Ringo</para></listitem></itemizedlist></listitem>
<listitem><para>Paul</para>
<itemizedlist>
<listitem><para>Dave</para></listitem>
<listitem><para>Sam</para></listitem>
<listitem><para>Jeff</para></listitem></itemizedlist></listitem>
<listitem><para>Mary</para>
<itemizedlist>
<listitem><para>Helen</para></listitem>
<listitem><para>Michelle</para></listitem>
<listitem><para>Diana</para></listitem></itemizedlist>
</listitem></itemizedlist>
<para>your example must look as follows:</para>
<programlisting>
<![CDATA[
::method InitDialog
  InitDlgRet = self~InitDialog:super
  curTree = self~GetTreeControl("IDC_TREE")
  if curTree \= .Nil then
  do
    curTree~Add("Peter", , ,"BOLD EXPANDED")
    curTree~Add(,"Mike", , ,"EXPANDED")
    curTree~Add(, ,"George")
    curTree~Add(, ,"Monique")
    curTree~Add(, , ,"John")
    curTree~Add(, ,"Chris")
    curTree~Add(,"Maud")
    curTree~Add(,"Ringo")
    curTree~Add("Paul", , ,"BOLD EXPANDED")
    curTree~Add(,"Dave")
    curTree~Add(,"Sam")
    curTree~Add(,"Jeff")
    curTree~Add("Mary", , ,"BOLD EXPANDED")
    curTree~Add(,"Helen")
    curTree~Add(,"Michelle")
    curTree~Add(,"Diana")
end

]]>
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>

<section id="modifytrc"><title>Modify</title>
<indexterm><primary>Modify</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
                                   +-""---+     +-0-----+
>>-aTreeControl~Modify(--hItem--,--+------+--,--+-------+--,--+----------+--,-->
                                   +-text-+     +-image-+     +-selImage-+

                                         +-"0"-+
>--+-------------------------------+--,--+-----+--)------------><
   |    +---------------------+    |     +-"1"-+
   |    V                     |    |
   +-"----+-BOLD------------+-+--"-+
          +-NOTBOLD---------+
          +-DROP------------+
          +-NOTDROP---------+
          +-SELECTED--------+
          +-NOTSELECTED-----+
          +-CUT-------------+
          +-NOTCUT----------+
          +-EXPANDEDONCE----+
          +-NOTEXPANDEDONCE-+
          +-EXPANDED--------+
          +-NOTEXPANDED-----+


]]>
</programlisting>

<para>The Modify method sets some or all attributes of
an item of a tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:</para>
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be modified.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>The text for the item. If you omit this argument, &quot;&quot; is assumed.
</para></listitem></varlistentry>
<varlistentry><term>image</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
to be used when the item is in the non-selected state. If you omit this argument,
the icon with index 0 is used.
</para></listitem></varlistentry>
<varlistentry><term>selImage</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
to be used when the item is in the selected state. If you omit this argument,
the icon specified for <emphasis role="italic">image</emphasis> is used.
</para></listitem></varlistentry>
<varlistentry><term>state</term>
<listitem><para>Specifies the appearance and functionality of the item. It can be one
or more of the following values, separated by blanks:
<variablelist>
<varlistentry><term>BOLD</term>
<listitem><para>The item is shown in bold.
</para></listitem></varlistentry>
<varlistentry><term>NOTBOLD</term>
<listitem><para>The item is not bold.
</para></listitem></varlistentry>
<varlistentry><term>DROP</term>
<listitem><para>The item is selected as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>NOTDROP</term>
<listitem><para>The item is not selected as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected. Its appearance depends on whether it has the focus
and whether the system colors are used for the selection.
</para></listitem></varlistentry>
<varlistentry><term>NOTSELECTED</term>
<listitem><para>The item is not selected.
</para></listitem></varlistentry>
<varlistentry><term>CUT</term>
<listitem><para>The item is selected as part of a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>NOTCUT</term>
<listitem><para>The item is not selected as part of a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>EXPANDEDONCE</term>
<listitem><para>The item's list of child items has been expanded at least once.
</para></listitem></varlistentry>
<varlistentry><term>NOTEXPANDEDONCE</term>
<listitem><para>The item's list of child items has not been expanded at least once.
</para></listitem></varlistentry>
<varlistentry><term>EXPANDED</term>
<listitem><para>The item's list is currently expanded with all child items visible.
This only applies to parent items.
</para></listitem></varlistentry>
<varlistentry><term>NOTEXPANDED</term>
<listitem><para>The item's list is currently not expanded.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>children</term>
<listitem><para>Indicates whether the item has child items associated with it:
<variablelist>
<varlistentry><term>&quot;0&quot;</term>
<listitem><para>The item has no child items, which is the default.
</para></listitem></varlistentry>
<varlistentry><term>&quot;1&quot;</term>
<listitem><para>The item has one or more child items.</para>
<para>You can use this argument to
show an item that does not have any child items, with an expand button. This
allows you to save memory usage by dynamically loading and displaying the
child items only when the user expands the item.</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item has been modified.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example changes the text of the item to bold
when it is selected:</para>
<programlisting>
<![CDATA[
::method OnSelChanging_IDC_TREE
  curTree = self~GetTreeControl("IDC_TREE")
  curTree~Modify(curTree~selected, , , ,"BOLD")
]]>
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>

<section id="iteminfotrc"><title>ItemInfo</title>
<indexterm><primary>ItemInfo</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~ItemInfo(--hItem--)----------------------------><


]]>
</programlisting>

<para>The ItemInfo method retrieves some or all attributes
of an item of a tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item of which attributes are to be retrieved.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A compound variable that stores the attributes of the item, or -1
in all other cases. The compound variable can be:
<variablelist>
<varlistentry><term>RetStem.!TEXT</term>
<listitem><para>The text of the item.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!CHILDREN</term>
<listitem><para>
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The item has children.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The item has no children.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!IMAGE</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
used when the item is in the non-selected state.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!SELECTEDIMAGE</term>
<listitem><para>The index of the icon image in the tree view control's bitmap file
used when the item is in the selected state.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!STATE</term>
<listitem><para>An empty string or one or more of the following strings, separated by
blanks:
<variablelist>
<varlistentry><term>EXPANDED</term>
<listitem><para>The item's list is currently expanded with all child items visible.
This only applies to parent items.
</para></listitem></varlistentry>
<varlistentry><term>BOLD</term>
<listitem><para>The item is in bold.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected.
</para></listitem></varlistentry>
<varlistentry><term>EXPANDEDONCE</term>
<listitem><para>The item's list has been expanded at least once. This only applies
to parent items.
</para></listitem></varlistentry>
<varlistentry><term>INDROP</term>
<listitem><para>The item is selected as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term></term>
<listitem><para>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the attributes of the selected item:
<programlisting>
<![CDATA[
::method Info
  curTree = self~GetTreeControl("IDC_TREE")
  itemInfo. = curTree~ItemInfo(curTree~Selected)
  say itemInfo.!TEXT
  say itemInfo.!CHILDREN
  say itemInfo.!IMAGE
  say itemInfo.!STATE
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="itemstrc"><title>Items</title>
<indexterm><primary>Items</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Items------------------------------------------><


]]>
</programlisting>

<para>The Items method retrieves the number of items
in a tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of items.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example counts all items in a tree view control:
<programlisting>
<![CDATA[
::method Count
  curTree = self~GetTreeControl("IDC_TREE")
  say curTree~Items
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="visibleitems"><title>VisibleItems</title>
<indexterm><primary>VisibleItems</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~VisibleItems-----------------------------------><


]]>
</programlisting>

<para>The VisibleItems method obtains the number of items
that can be fully visible in a tree view control. This number can be greater
than the number of items in the control. The control calculates this value
by dividing the height of the client window by the height of an item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of items that can be fully visible. For example, if you can
see all of 19 items and part of another item, the return value is 19, not
20.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example returns the number of items that can be fully
visible:
<programlisting>
<![CDATA[
::method Visible
  curTree = self~GetTreeControl("IDC_TREE")
  say curTree~VisibleItems
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="root"><title>Root</title>
<indexterm><primary>Root</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Root-------------------------------------------><


]]>
</programlisting>

<para>The Root method retrieves the first or topmost
item of the tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the first item, or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the name of the root item:
<programlisting>
<![CDATA[
::method RootName
  curTree = self~GetTreeControl("IDC_TREE")
  itemInfo. = curTree~ItemInfo(curTree~Root)
  say ItemInfo.!Text
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="parent"><title>Parent</title>
<indexterm><primary>Parent</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Parent(--hItem--)------------------------------><


]]>
</programlisting>

<para>The Parent method retrieves the parent of the specified
item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item for which the parent is to be retrieved.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the parent item, or -1 if
<emphasis role="italic">hItem</emphasis> is not
specified or is 0, or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the name of the selected item's parent:
<programlisting>
<![CDATA[
::method Parent
  curTree = self~GetTreeControl("IDC_TREE")
  itemInfo. = curTree~ItemInfo(curTree~Parent(curTree~Selected))
  say ItemInfo.!Text
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="child"><title>Child</title>
<indexterm><primary>Child</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Child(--hItem--)-------------------------------><


]]>
</programlisting>

<para>The Child method retrieves the first child item
of <emphasis role="italic">hItem</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item of which the first child is to be
retrieved.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the first child item, or -1 if you omitted
<emphasis role="italic">hItem</emphasis>, or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the name of parent of the selected item:
<programlisting>
<![CDATA[
::method Child
  curTree = self~GetTreeControl("IDC_TREE")
  itemInfo. = curTree~ItemInfo(curTree~Child(curTree~Selected))
  say ItemInfo.!Text
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="selectedtrc"><title>Selected</title>
<indexterm><primary>Selected</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Selected---------------------------------------><


]]>
</programlisting>

<para>The Selected method retrieves the currently selected
item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the currently selected item, or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the name of the selected item:
<programlisting>
<![CDATA[
::method SelectedName
  curTree = self~GetTreeControl("IDC_TREE")
  itemInfo. = curTree~ItemInfo(curTree~Selected)
  say ItemInfo.!Text
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="drophighlightedtrc"><title>DropHighlighted</title>
<indexterm><primary>DropHighlighted</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~DropHighlighted--------------------------------><


]]>
</programlisting>

<para>The DropHighlighted method retrieves the item that
is the target of a drag-and-drop operation.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the item, or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="firstvisibletrc"><title>FirstVisible</title>
<indexterm><primary>FirstVisible</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~FirstVisible-----------------------------------><


]]>
</programlisting>

<para>The FirstVisible method retrieves the first visible
item in the client window of a tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the first visible item, or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the name of the first visible item:
<programlisting>
<![CDATA[
::method FirstVisibleName
  curTree = self~GetTreeControl("IDC_TREE")
  itemInfo. = curTree~ItemInfo(curTree~FirstVisible)
  say ItemInfo.!Text
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="nexttrc"><title>Next</title>
<indexterm><primary>Next</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Next(--hItem--)--------------------------------><


]]>
</programlisting>

<para>The Next method retrieves the sibling item next
to <emphasis role="italic">hItem</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item next to the sibling item to be retrieved.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the next sibling item, or -1 if you omitted
<emphasis role="italic">hItem</emphasis>, or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the name of the selected item and its
siblings:
<programlisting>
<![CDATA[
::method SiblingNames
  curTree = self~GetTreeControl("IDC_TREE")
  nextItem = curTree~Selected
  do while nextItem \= 0
    itemInfo. = curTree~ItemInfo(nextItem)
    say ItemInfo.!Text
    nextItem = curTree~Next(nextItem)
  end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="nextvisible"><title>NextVisible</title>
<indexterm><primary>NextVisible</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~NextVisible(--hItem--)-------------------------><


]]>
</programlisting>

<para>The NextVisible method retrieves the visible item
following <emphasis role="italic">hItem</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item that precedes the visible item to be
retrieved. <emphasis role="italic">hItem</emphasis> must also be visible.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the next visible item, or -1 if you omitted
<emphasis role="italic">hItem</emphasis>, or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="previoustrc"><title>Previous</title>
<indexterm><primary>Previous</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Previous(--hItem--)----------------------------><


]]>
</programlisting>

<para>The Previous method retrieves the sibling item
preceding <emphasis role="italic">hItem</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item that follows the sibling item to be retrieved.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the previous sibling item, or -1 if
<emphasis role="italic">hItem</emphasis>
is not specified or is 0, or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="previousvisible"><title>PreviousVisible</title>
<indexterm><primary>PreviousVisible</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~PreviousVisible(--hItem--)---------------------><


]]>
</programlisting>

<para>The PreviousVisible method retrieves the visible
item preceding <emphasis role="italic">hItem</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item that follows the visible child item to be retrieved.
 <emphasis role="italic">hItem</emphasis> must also be visible.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the previous visible child item, or -1 if
<emphasis role="italic">hItem</emphasis> is not specified or is 0, or 0
in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="deletetrc"><title>Delete</title>
<indexterm><primary>Delete</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Delete(--hItem--)------------------------------><


]]>
</programlisting>

<para>The Delete method removes an item from a tree view
control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be deleted.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was deleted.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>An error occurred.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> is 0 or is not a
valid value.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example deletes the selected item and all its children,
if any:
<programlisting>
<![CDATA[
::method IDC_PB_DELETE
  curTree = self~GetTreeControl("IDC_TREE")
  curTree~Delete(curTree~Selected)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="deletealltrc"><title>DeleteAll</title>
<indexterm><primary>DeleteAll</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~DeleteAll--------------------------------------><


]]>
</programlisting>

<para>The DeleteAll method removes all items from a tree
view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were removed.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="collapse"><title>Collapse</title>
<indexterm><primary>Collapse</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Collapse(--hItem--)----------------------------><


]]>
</programlisting>

<para>The Collapse method collapses the list of child
items associated with the specified parent item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the parent item to collapse.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The list of child items has collapsed.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> is not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example collapses the selected item:
<programlisting>
<![CDATA[
::method CollapseSelected
  curTree = self~GetTreeControl("IDC_TREE")
  curTree~Collapse(curTree~Selected)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="collapseandreset"><title>CollapseAndReset</title>
<indexterm><primary>CollapseAndReset</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~CollapseAndReset(--hItem--)--------------------><


]]>
</programlisting>

<para>The CollapseAndReset method collapses the list
of child items associated with the specified parent item and removes the child
items.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the parent item to collapse.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The list of child items has collapsed and the child items have been
removed.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> is not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example collapses the selected item and removes
all its child items:
<programlisting>
<![CDATA[
::method CollapseSelectedAndReset
  curTree = self~GetTreeControl("IDC_TREE")
  curTree~CollapseAndReset(curTree~Selected)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="expand"><title>Expand</title>
<indexterm><primary>Expand</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Expand(--hItem--)------------------------------><


]]>
</programlisting>

<para>The Expand method expands the list of child items
associated with the specified parent item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the parent item to be expanded.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The parent item was expanded.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> is not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example expands the selected item:
<programlisting>
<![CDATA[
::method ExpandSelected
  curTree = self~GetTreeControl("IDC_TREE")
  curTree~Expand(curTree~Selected)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="toggle"><title>Toggle</title>
<indexterm><primary>Toggle</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Toggle(--hItem--)------------------------------><


]]>
</programlisting>

<para>The Toggle method collapses the list of the specified
item if it was expanded, or expands it if it was collapsed.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be expanded or collapsed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was expanded or collapsed.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> is not specified
or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example toggles between expanding and
collapsing a selected item:
<programlisting>
<![CDATA[
::method ToggleSelected
  curTree = self~GetTreeControl("IDC_TREE")
  curTree~Toggle(curTree~Selected)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="ensurevisibletrc"><title>EnsureVisible</title>
<indexterm><primary>EnsureVisible</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~EnsureVisible(--hItem--)-----------------------><


]]>
</programlisting>

<para>The EnsureVisible method ensures that a tree view
item is visible, expanding the parent item or scrolling the tree view control,
if necessary.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be visible.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items in the tree view control were scrolled to ensure that the
specified item is visible.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> is not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="indent"><title>Indent</title>
<indexterm><primary>Indent</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Indent-----------------------------------------><


]]>
</programlisting>

<para>The Indent method retrieves the amount, in pixels,
by which the child items are indented relative to their parent item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The amount indented, in pixels.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="indentnew"><title>Indent=</title>
<indexterm><primary>Indent=</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Indent=--indent--------------------------------><


]]>
</programlisting>

<para>The Indent= method sets the width of indentation
for a tree view control and redraws the control to reflect the new width.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>indent</term>
<listitem><para>The width of the indentation, in pixels. If you specify a width that
is smaller than the system-defined minimum, it is set to the system-defined
minimum.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>-1 if <emphasis role="italic">indent</emphasis> is 0.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="edittrc"><title>Edit</title>
<indexterm><primary>Edit</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Edit(--hItem--)--------------------------------><


]]>
</programlisting>

<para>The Edit method starts editing the text of the
specified item by replacing the text with a single-line edit control containing
this text. It implicitly selects and focuses the specified item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be edited.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the edit control used to edit the item text, or -1
if <emphasis role="italic">hItem</emphasis> is not specified or is 0, or 0
in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="endedittrc"><title>EndEdit</title>
<indexterm><primary>EndEdit</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~EndEdit(--+--------+--)------------------------><
                          +-cancel-+


]]>
</programlisting>

<para>The EndEdit method ends the editing of the item
label of the tree view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>cancel</term>
<listitem><para>Indicates whether editing is canceled without being saved to the label.
If you specify &quot;1&quot; or &quot;YES&quot;, editing is canceled. Otherwise,
the changes are saved to the label, which is the default.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Editing has ended successfully.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="subclassedittrc"><title>SubclassEdit</title>
<indexterm><primary>SubclassEdit</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~SubclassEdit-----------------------------------><


]]>
</programlisting>

<para>The SubclassEdit method is used by the DefTreeEditHandler
to correct the problem occurring when Esc or the Enter key is pressed in an
active edit item.</para>
</section>

<section id="restoreeditclasstrc"><title>RestoreEditClass</title>
<indexterm><primary>RestoreEditClass</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~RestoreEditClass-------------------------------><


]]>
</programlisting>

<para>The RestoreEditClass method is used by the DefTreeEditHandler
to correct the problem occurring when Esc or the Enter key is pressed in an
active edit item.</para>
</section>

<section id="selecttrc"><title>Select</title>
<indexterm><primary>Select</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~Select(--hItem--)------------------------------><


]]>
</programlisting>

<para>The Select method selects a specific item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be selected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was selected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> was not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="makefirstvisibletrc"><title>MakeFirstVisible</title>
<indexterm><primary>MakeFirstVisible</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~MakeFirstVisible(--hItem--)--------------------><


]]>
</programlisting>

<para>The MakeFirstVisible method ensures that
<emphasis role="italic">hItem</emphasis> is visible and displays
it at the top of the control's dialog, if
possible. If the specified item is near the end of the control's hierarchy
of items, it might not become the first visible item depending on how many
items fit in the dialog.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be visible first.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item is visible first.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis> was not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="drophighlight"><title>DropHighlight</title>
<indexterm><primary>DropHighlight</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~DropHighlight(--hItem--)-----------------------><


]]>
</programlisting>

<para>The DropHighlight method redraws <emphasis role="italic">hItem</emphasis>
in the style used to indicate the target of a drag-and-drop operation.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle of the item to be redrawn.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was redrawn.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis>
was not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="sortchildren"><title>SortChildren</title>
<indexterm><primary>SortChildren</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~SortChildren(--hItem--)------------------------><


]]>
</programlisting>

<para>The SortChildren method sorts the child items of
the specified parent item in a tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the parent item the child items of which are to be sorted.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The child items were sorted.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para><emphasis role="italic">hItem</emphasis>
was not specified or is 0.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthSetImageListClsTreeControl"><title>setImageList</title>
<indexterm><primary>setImageList</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setImageList(--newImageList--+----------+--)--------------------><
                                 +--,-type--+
]]>
</programlisting>

<para>
  Assigns, or removes, an image list for the tree-view control. Using
  <computeroutput>.nil</computeroutput> for the first argument removes the current image list. Tree-view
  controls can have two image lists. The normal image list, which contains selected, nonselected, and
  overlay images for the items of a tree-view control. And, the state image list. The state images can be
  used by the programmer to indicate application-defined item states. A state image is displayed to the
  left of an item's selected or nonselected image.
</para>
<para>
  The tree-view control does not destroy an image list that is associated with it. The programmer must
  destroy the image list separately, if desired. This is useful if the same image list is assigned to
  multiple tree-view controls. In essence, the ownership of the image list remains with the programmer.
  The <link linkend="clsImageList">ImageList</link> and <link linkend="clsImage">Image</link> classes are
  used to manage image lists and images in ooDialog. The documentation on both classes discusses when and
  why the programmer may want to release image lists. The Image class documentation has the most detail
  on this subject.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
    <para>
      Raises syntax errors when incorrect arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>newImageList</term>
      <listitem>
        <para>
          The <link linkend="clsImageList">image list</link> to assign to the tree-view. If this argument
          is <computeroutput>.nil</computeroutput> the existing image list, if any, is removed.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>type</term>
      <listitem>
        <para>
          Optional. Specifies which image list to assign, (or remove.) You can use <link
          linkend="mthIdClsImage">.Image~id()</link> to get the correct numeric value for one of the
          following symbols:
          <simplelist type='horiz' columns='2'>
          <member>TVSIL_NORMAL</member>
          <member>TVSIL_STATE </member>
          </simplelist>
          or use the correct numeric value itself.
        </para>
        <para>
          The default is TVSIL_NORMAL.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The existing image list is returned, if there is one. Otherwise,
      <computeroutput>.nil</computeroutput> is returned.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example creates an image list and assigns it to the tree-view control for use as the normal
      image list.
<programlisting>
<![CDATA[

  /* set images for the items */
  image = .Image~getImage("bmp\psdemotv.bmp")
  imageList = .ImageList~create(.Size~new(32, 32), .Image~id(ILC_COLOR8), 10, 0)
  if \image~isNull,  \imageList~isNull then do
     imageList~add(image)
     tc~setImageList(imageList, .Image~id(TVSIL_NORMAL))
     image~release
  end

]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End TreeControl::setImageList() -->

<section id="mthGetImageListClsTreeControl"><title>getImageList</title>
<indexterm><primary>getImageList</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getImageList(--+--------+--)------------------------------------><
                   +--type--+
]]>
</programlisting>

<para>
  Retrieves the current image list for the type specified. The default is to retrieve the tree-views
  normal image list.  See the <link linkend="mthSetImageListClsTreeControl"></link>() method for
  infomation on assigning an image list to a tree-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
    <para>
      Raises syntax errors when incorrect arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The single optional argument is:
    <variablelist>
      <varlistentry><term>type</term>
      <listitem>
        <para>
          Optional. Specifies which image list to retrieve. You can use <link
          linkend="mthIdClsImage">.Image~id()</link> to get the correct numeric value for one of the
          following symbols:
          <simplelist type='horiz' columns='2'>
          <member>TVSIL_NORMAL</member>
          <member>TVSIL_STATE </member>
          </simplelist>
          or use the correct numeric value itself.
        </para>
        <para>
          The default is TVSIL_NORMAL.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns the current <link linkend="clsImageList">image list</link>, if there is one.
      <computeroutput>.nil</computeroutput> is returned if there is no current image list of the type
      specified.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example releases the tree-view's image lists, if they exist, when the dialog ends.
<programlisting> <![CDATA[ ::method ok
  self~doImageLists return self~ok:super

::method cancel
  self~doImageLists
  return self~cancel:super

::method odImageLists
  expose treeView

  types = .array~of(TVSIL_NORMAL, TVSIL_STATE)

  do type over types
    il = treeView~getImageList(type)
    if il \== .nil then il~release
  end

]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End TreeControl::getImageList() -->


<section id="setimagestrc"><title>setImages <emphasis role="bold">(deprecated)</emphasis></title>
<indexterm>
  <primary>deprecated</primary>
  <secondary>TreeControl class</secondary>
  <tertiary>setImages</tertiary>
</indexterm>
<note><title>Note</title><para>
  This method is deprecated.  It is replaced by the functionally equivalent <link
  linkend="mthSetImageListClsTreeControl">setImageList()</link> method.  Do not use this method in new
  code. Try to migrate existing code to to the <computeroutput>setImageList()</computeroutput> method.
  This method may not exist in future versions of ooDialog.
</para></note>
</section>

<section id="removeimagestrc"><title>removeImages <emphasis role="bold">(deprecated)</emphasis></title>
<indexterm>
  <primary>deprecated</primary>
  <secondary>TreeControl class</secondary>
  <tertiary>removeImages</tertiary>
</indexterm>
<note><title>Note</title><para>
  This method is deprecated.  It is replaced by the functionally equivalent <link
  linkend="mthSetImageListClsTreeControl">setImageList()</link> method.  Do not use this method in new
  code. Try to migrate existing code to to the <computeroutput>setImageList()</computeroutput> method.
  This method may not exist in future versions of ooDialog.
</para></note>
</section>

<section id="hittest"><title>HitTest</title>
<indexterm><primary>HitTest</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~HitTest(--x--,--y--)---------------------------><


]]>
</programlisting>

<para>The HitTest method determines the location of the
specified point relative to the client area of a tree view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>x</term>
<listitem><para>The x-coordinate of the point.
</para></listitem></varlistentry>
<varlistentry><term>y</term>
<listitem><para>The y-coordinate of the point.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if no item occupies the point, or one or more of the
following strings if an item occupies the specified point:
<variablelist>
<varlistentry><term>handle</term>
<listitem><para>The handle to the item that occupies the specified point.
</para></listitem></varlistentry>
<varlistentry><term>ABOVE</term>
<listitem><para>Above the client area.
</para></listitem></varlistentry>
<varlistentry><term>BELOW</term>
<listitem><para>Below the client area.
</para></listitem></varlistentry>
<varlistentry><term>NOWHERE</term>
<listitem><para>In the client area but below the last item.
</para></listitem></varlistentry>
<varlistentry><term>ONITEM</term>
<listitem><para>On the bitmap or label associated with an item.
</para></listitem></varlistentry>
<varlistentry><term>ONBUTTON</term>
<listitem><para>On the button associated with an item.
</para></listitem></varlistentry>
<varlistentry><term>ONICON</term>
<listitem><para>On the icon associated with an item.
</para></listitem></varlistentry>
<varlistentry><term>ONINDENT</term>
<listitem><para>In the indentation associated with an item.
</para></listitem></varlistentry>
<varlistentry><term>ONLABEL</term>
<listitem><para>On the label (string) associated with an item.
</para></listitem></varlistentry>
<varlistentry><term>ONRIGHT</term>
<listitem><para>In the area to the right of an item.
</para></listitem></varlistentry>
<varlistentry><term>ONSTATEICON</term>
<listitem><para>On the state icon for a tree view item that is in a user-defined state.
</para></listitem></varlistentry>
<varlistentry><term>TOLEFT</term>
<listitem><para>To the left of the client area.
</para></listitem></varlistentry>
<varlistentry><term>TORIGHT</term>
<listitem><para>To the right of the client area.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="moveitem"><title>MoveItem</title>
<indexterm><primary>MoveItem</primary>
<secondary>TreeControl class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~MoveItem(--hItem--,--hNewParent--,--redraw--+---------------+--)-><
                                                            +-,--"NODELETE"-+
                                                            +-,--"SIBLINGS"-+


]]>
</programlisting>

<para>The MoveItem method moves an item to a new location.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>hItem</term>
<listitem><para>The handle to the item to be moved.
</para></listitem></varlistentry>
<varlistentry><term>hNewParent</term>
<listitem><para>The handle to the new parent to which the item is to be moved.
</para></listitem></varlistentry>
<varlistentry><term>redraw</term>
<listitem><para>The tree view control is updated.
</para></listitem></varlistentry>
<varlistentry><term>options</term>
<listitem><para>One of the following options:
<variablelist>
<varlistentry><term>&quot;NODELETE&quot;</term>
<listitem><para>The item is copied to another location.
</para></listitem></varlistentry>
<varlistentry><term>&quot;SIBLINGS&quot;</term>
<listitem><para>Siblings are moved together with the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle to the new parent, or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="isancestor"><title>IsAncestor</title>
<indexterm><primary>IsAncestor</primary></indexterm>
<programlisting>
<![CDATA[
>>-aTreeControl~IsAncestor(--hParent--,--hItem--)--------------><


]]>
</programlisting>

<para>The IsAncestor method checks if an item is an ancestor
of another item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>hParent</term>
<listitem><para>The ancestor.
</para></listitem></varlistentry>
<varlistentry><term>hItem</term>
<listitem><para>The item to be checked.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>1 if <emphasis role="italic">hParent</emphasis> is an ancestor
of <emphasis role="italic">hItem</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</section>
</section>

<section id="notifmsgtrc"><title>Notification Messages</title>
<indexterm><primary>notification messages</primary>
<secondary>TreeControl class</secondary></indexterm>
<para>The tree view control sends notification messages to notify about events.
For more information on notification messages, refer to
<link linkend="connectlistnotify">ConnectListNotify</link>.</para>
<para>The following example shows how to connect the tree view notification messages
with the corresponding message:</para>
<programlisting>
<![CDATA[
::method Init
  use arg InitStem.
  if Arg(1,"o") = 1 then
     InitRet = self~Init:super
  else
     InitRet = self~Init:super(InitStem.)

  if self~Load("tree.rc", ) \= 0 then do
     self~InitCode = 1
    return
  end

  /* Connect dialog control items to class methods */
  self~ConnectTreeNotify("IDC_TREE","SelChanging","OnSelChanging_IDC_TREE")
  self~ConnectTreeNotify("IDC_TREE","SelChanged","OnSelChanged_IDC_TREE")
  self~ConnectTreeNotify("IDC_TREE","Expanding","OnExpanding_IDC_TREE")
  self~ConnectTreeNotify("IDC_TREE","Expanded","OnExpanded_IDC_TREE")
  self~ConnectTreeNotify("IDC_TREE","DefaultEdit")
  self~ConnectTreeNotify("IDC_TREE","Delete","OnDelete_IDC_TREE")
  self~ConnectTreeNotify("IDC_TREE","KeyDown","OnKeyDown_IDC_TREE")
  self~ConnectButton("IDC_PB_NEW","IDC_PB_NEW")
  self~ConnectButton("IDC_PB_DELETE","IDC_PB_DELETE")
  self~ConnectButton(2,"Cancel")
  self~ConnectButton(9,"Help")
  self~ConnectButton(1,"OK")
  return InitRet
]]>
</programlisting>
</section>
</chapter>
