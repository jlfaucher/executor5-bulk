<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference SGML file.
    #
    # Copyright (c) 2005-2011, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="clsListView"><title>List View Controls</title>
<indexterm><primary>ListView class</primary></indexterm>
<para>
  A list-view control is a window that displays a collection of items, with each item consisting of an icon and a label.
  It provides several ways of arranging and displaying items. Refer to the <computeroutput>oodlist.rex</computeroutput>
  program in the <computeroutput>samples\oodialog</computeroutput> directory for an example.
</para>
<para>
  The <computeroutput>ListView</computeroutput> class is the ooDialog interface to the Windows <emphasis
  role="italic">List-View</emphasis> control.  This should not be confused with the Windows <emphasis role="italic">List
  Box</emphasis> control. The ooDialog <link linkend="clsListBox">ListBox</link> class provides the interface to the
  Windows List Box control.  In general, the List-View control is more powerful than the List Box control.
</para>
<para id="listControlExtendedStyles">
  List-View <emphasis role="bold">Extended Styles</emphasis>: The List-View control has been updated by Microsoft to
  include a number of <emphasis role="italic">extended</emphasis> styles. These styles are similar to the styles that
  can be used to create a ListView, (see the <link linkend="mthCreateListView">createListView</link> method,) like the
  <computeroutput>NOHEADER</computeroutput> or <computeroutput>SINGLESEL</computeroutput> styles.  However, the way that
  they are added or removed from the ListView is different.  For instance, the extended styles can not be added to a
  ListView at the time of creation.  They can only be added after the underlying Windows control has been created.  For
  all practical purposes this means in the <link linkend="mthInitDialog">InitDialog</link> method, or at some point in
  the life cycle of the dialog after that.
</para>
<para>
  Some of the extended styles are only available on later versions of the Windows OS.  As an example, the
  <computeroutput>LABELTIP</computeroutput> and <computeroutput>SIMPLESELECT</computeroutput> styles are only available
  on Windows XP.  The documentation on the extended styles will note any requirements for each style.  To work with the
  extended List-View styles, use the <link linkend="mthAddExtendedStyle">addExtendedStyle</link>, the <link
  linkend="mthRemoveExtendedStyle">removeExtendedStyle</link>, or the <link
  linkend="mthReplaceExtendedStyle">replaceExtendedStyle</link> methods.
</para>
<para>
  There are a number of nuances to the behavior of the different extended styles on the different versions of Windows,
  far too many to try and detail in this documentation.  The behavior documented here is the general behavior on Windows
  XP with service pack 2.
</para>
<para>
  If there is a need for detailed information concerning the subtle differences in behavior on earlier versions of
  Windows, the programmer should consult the <link linkend="defWindowsDoc">Windows documentation.</link>
</para>

<para>
  In addition to the methods of the class itself, the following methods from other classes in the ooDialog framework are
  needed, or are useful, when working with list-view controls:
<variablelist>
  <varlistentry><term><emphasis role="bold">Instantiation:</emphasis></term>
  <listitem>
  <para>
    Use the <link linkend="mthNewListView">newListView</link> method of the <link
    linkend="chpDialogObject">dialog</link> object to retrieve a list-view object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Dynamic Definition:</emphasis></term>
  <listitem>
  <para>
    To dynamically create a list-view in the dialog template of a <link linkend="clsUserDialog">UserDialog</link> use
    the <link linkend="mthCreateListView">createListView</link> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Notification</emphasis></term>
  <listitem>
  <para>
    To connect the <link linkend="ovvEvents">event</link> notifications sent by the underlying list-view control to a
    method in the Rexx dialog object use the <link linkend="mthConnectListViewEvent">connectListViewEvent</link>
    method.
  </para>
  </listitem></varlistentry>
</variablelist>
</para>

<section id="sctMethodsListView"><title>Method Table</title>
<para>
  The following table provides links to the documentation for the primary methods and attributes used in working
  with list-view objects, including the pertinent methods from other classes:
</para>

<table id="tblListViewMethods" frame="all">
<title>ListView Instance Methods</title>
<tgroup cols="2">
<colspec colwidth="1.5in">
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Useful</emphasis></entry>
<entry align="center"><emphasis role="bold">External Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="tmthNewListView">newListView</link></entry>
<entry>Returns a <computeroutput>ListView</computeroutput> object for the control with the specified ID.</entry>
</row>
<row>
<entry><link linkend="tmthCreateListView">createListView</link></entry>
<entry>Creates a list-view control in the dialog template of a <link linkend="clsUserDialog">UserDialog</link>.</entry>
</row>
<row>
<entry><link linkend="tmthConnectListViewEvent">connectListViewEvent</link></entry>
<entry>Connects list-view event notifications to a method in the Rexx dialog object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="addlc">add</link></entry>
<entry>Adds a new item to a list-view or defines the text for a subitem.</entry>
</row>
<row>
<entry><link linkend="mthAddExtendedStyle">addExtendedStyle</link></entry>
<entry>adds one or more of the extended list-view styles to a list-view control.</entry>
</row>
<row>
<entry><link linkend="mthAddRow">addRow</link></entry>
<entry>Adds a new item to a list-view.</entry>
</row>
<row>
<entry><link linkend="addstyle">addStyle</link></entry>
<entry>Adds new window styles to a list-view control.</entry>
</row>
<row>
<entry><link linkend="alignleft">alignLeft</link></entry>
<entry>Aligns items along the left window border.</entry>
</row>
<row>
<entry><link linkend="aligntop">alignTop</link></entry>
<entry>Aligns items along the upper window border.</entry>
</row>
<row>
<entry><link linkend="arrange">arrange</link></entry>
<entry>Aligns items according to the current alignment style of the list-view control.</entry>
</row>
<row>
<entry><link linkend="bkcolor">bkColor</link></entry>
<entry>Retrieves the background color for a list-view control.</entry>
</row>
<row>
<entry><link linkend="bkcolornew">bkColor=</link></entry>
<entry>Sets the background color of a list view-control.</entry>
</row>
<row>
<entry><link linkend="mthCheckClsListControl">check</link></entry>
<entry>Sets the check mark for a list-view item.</entry>
</row>
<row>
<entry><link linkend="mthCheckAll">checkAll</link></entry>
<entry>Sets the check mark for every list-view item.</entry>
</row>
<row>
<entry><link linkend="columninfo">columnInfo</link></entry>
<entry>Retrieves information for a column of a list-view control in a <computeroutput>Stem</computeroutput> object. <emphasis  role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="columnwidth">columnWidth</link></entry>
<entry>Retrieves the width, in dialog units, of a column in a list-view when it is has the list or report view style. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthColumnWidthPX">columnWidthPX</link></entry>
<entry>Retrieves the width, in pixels, of a column in a list-view when it is has the list or report view style.</entry>
</row>
<row>
<entry><link linkend="deletelc">delete</link></entry>
<entry>Removes an item from a list-view control.</entry>
</row>
<row>
<entry><link linkend="deletealllc">deleteAll</link></entry>
<entry>Removes all times from a list-view control.</entry>
</row>
<row>
<entry><link linkend="deletecolumn">deleteColumn</link></entry>
<entry>Removes a column from a list-view control.</entry>
</row>
<row>
<entry><link linkend="deselect">deselect</link></entry>
<entry>Deselects an item.</entry>
</row>
<row>
<entry><link linkend="drophighlighted">dropHighlighted</link></entry>
<entry>Retrieves the item that is highlighted as a drag-and-drop target.</entry>
</row>
<row>
<entry><link linkend="edit">edit</link></entry>
<entry>Begins the editing of the text of the specified list-view item.</entry>
</row>
<row>
<entry><link linkend="endedit">endEdit</link></entry>
<entry>Cancels the editing of the list-view item being edited.</entry>
</row>
<row>
<entry><link linkend="ensurevisible">ensureVisible</link></entry>
<entry>Ensures that a list-view item is entirely or partially visible by scrolling the list-view control, if necessary.</entry>
</row>
<row>
<entry><link linkend="findlc">find</link></entry>
<entry>Searches for a list-view item containing the specified text.</entry>
</row>
<row>
<entry><link linkend="findnearestxy">findNearestXY</link></entry>
<entry>Searches, in the specified direction, for the item nearest to the specified position.</entry>
</row>
<row>
<entry><link linkend="findpartial">findPartial</link></entry>
<entry>Searches for a list-view item beginning with the specified text.</entry>
</row>
<row>
<entry><link linkend="firstvisible">firstVisible</link></entry>
<entry>Retrieves the index of the first item visible in list-view control with the report or list style.</entry>
</row>
<row>
<entry><link linkend="focus">focus</link></entry>
<entry>Assigns the focus to the specified item,</entry>
</row>
<row>
<entry><link linkend="focused">focused</link></entry>
<entry>Retrieves the index of the item that currently has the focus.</entry>
</row>
<row>
<entry><link linkend="mthGetCheck">getCheck</link></entry>
<entry>Determines if the item at the specified index has a checked, check box.</entry>
</row>
<row>
<entry><link linkend="mthGetColumnInfo">getColumnInfo</link></entry>
<entry>Retrieves the attributes of a list-view column in a <computeroutput>Directory</computeroutput> object.</entry>
</row>
<row>
<entry><link linkend="mthGetColumnCount">getColumnCount</link></entry>
<entry>Returns the number of columns in the list-view control when it has the report style.</entry>
</row>
<row>
<entry><link linkend="mthGetColumnCount">getColumnOrder</link></entry>
<entry>Retrieves the current column order of the list-view when it has the  report style.</entry>
</row>
<row>
<entry><link linkend="mthGetExtendedStyle">getExtendedStyle</link></entry>
<entry>Returns the extended styles of a list-view control.</entry>
</row>
<row>
<entry><link linkend="mthGetExtendedStyleRaw">getExtendedStyleRaw</link></entry>
<entry>Returns the extended styles of a list-view cont control as the numeric value of the extended style flags.</entry>
</row>
<row>
<entry><link linkend="mthGetHoverTime">getHoverTime</link></entry>
<entry>Retrieves the current hover time in miliseconds.</entry>
</row>
<row>
<entry><link linkend="mthGetImageList">getImageList</link></entry>
<entry>Retrieves the current image list for the image list type specified.</entry>
</row>
<row>
<entry><link linkend="mthGetItemInfo">getItemInfo</link></entry>
<entry>Retrieves the attributes of a list-view item in a <computeroutput>Directory</computeroutput> object.</entry>
</row>
<row>
<entry><link linkend="mthGetItemPos">getItemPos</link></entry>
<entry>Retrieves the client area coordinates of an item in a list-view control as a <computeroutput>Point</computeroutput> object.</entry>
</row>
<row>
<entry><link linkend="mthHasCheckBoxes">hasCheckBoxes</link></entry>
<entry>Determines if a list-view control has the CHECKBOXES extened list-view style.</entry>
</row>
<row>
<entry><link linkend="mthInsertClsListControl">insert</link></entry>
<entry>Inserts a new item into the list-view, or inserts a new subitem into in an existing list-view item.</entry>
</row>
<row>
<entry><link linkend="mthInsertColumn">insertColumn</link></entry>
<entry>Inserts a new column into the list-view control using dialog units for the width. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthInsertColumnPX">insertColumnPX</link></entry>
<entry>Inserts a new column into a list-view control using pixels for the width</entry>
</row>
<row>
<entry><link linkend="mthIsCheckedClsListControl">isChecked</link></entry>
<entry>Determines if a check box for a list-view item is checked or not.</entry>
</row>
<row>
<entry><link linkend="iteminfo">itemInfo</link></entry>
<entry>Retrieves the attributes of a list-view item in a <computeroutput>Stem</computeroutput> object.</entry>
</row>
<row>
<entry><link linkend="itempos">itemPos</link></entry>
<entry>Retrieves the client area coordinates of an item in a list-view control as a <computeroutput>String</computeroutput> object.</entry>
</row>
<row>
<entry><link linkend="itemslc">items</link></entry>
<entry>Retrieves the number of items in a list-view control.</entry>
</row>
<row>
<entry><link linkend="itemstate">itemState</link></entry>
<entry>Retrieves the state of a list-view item, focused, selected, etc.</entry>
</row>
<row>
<entry><link linkend="itemtext">itemText</link></entry>
<entry>Retrieves the text of a list-view item or subitem.</entry>
</row>
<row>
<entry><link linkend="itemsperpage">itemsPerPage</link></entry>
<entry>Calculates the number of items that vertically fit the visible area of a list-view control that has the report or list style.</entry>
</row>
<row>
<entry><link linkend="last">last</link></entry>
<entry>Retrieves the index of the last item in a list-view control.</entry>
</row>
<row>
<entry><link linkend="lastselected">lastSelected</link></entry>
<entry>Returns the index of the selected item with the highest index in a list-view control.</entry>
</row>
<row>
<entry><link linkend="mthModify">modify</link></entry>
<entry>Modifies the text or icon for an item, or the text for a subitem, for a list-view item</entry>
</row>
<row>
<entry><link linkend="modifycolumn">modifyColumn</link></entry>
<entry>Sets new attributes for a column of a list-view control when it has the report or list style. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthModifyColumnPX">modifyColumnPX</link></entry>
<entry>Sets new attributes for a column of a list-view control when it has the report or list style.</entry>
</row>
<row>
<entry><link linkend="next">next</link></entry>
<entry>Retrieves the item that follows, or is to the right of, the specified item.</entry>
</row>
<row>
<entry><link linkend="nextleft">nextLeft</link></entry>
<entry>Retrieves the item to the left of the specified item.</entry>
</row>
<row>
<entry><link linkend="nextright">nextRight</link></entry>
<entry>Retrieves the item to the right of the specified item.</entry>
</row>
<row>
<entry><link linkend="nextselected">nextSelected</link></entry>
<entry>Retrieves the next selected item that follows, or is to the right of, the specified item.</entry>
</row>
<row>
<entry><link linkend="prepare4nitems">prepare4nItems</link></entry>
<entry>Informs the list-view control to prepare for the addition of a large number of items.</entry>
</row>
<row>
<entry><link linkend="previous">previous</link></entry>
<entry>Retrieves the index of the item that precedes, or is to the left of, the specified item.</entry>
</row>
<row>
<entry><link linkend="previousselected">previousSelected</link></entry>
<entry>Retrieves the first selected item that precedes, or is to the left of, the specified item.</entry>
</row>
<row>
<entry><link linkend="redrawitems">redrawItems</link></entry>
<entry>Forces a list-view control to redraw a range of items.</entry>
</row>
<row>
<entry><link linkend="mthRemoveExtendedStyle">removeExtendedStyle</link></entry>
<entry>Removes one or more extended styles of a list-view control.</entry>
</row>
<row>
<entry><link linkend="removestyle">removeStyle</link></entry>
<entry>Removes one or more window styles of a list-view control.</entry>
</row>
<row>
<entry><link linkend="mthReplaceExtendedStyle">replaceExtendedStyle</link></entry>
<entry>Removes some or all of the list-view control's extended styles and adds new extended styles</entry>
</row>
<row>
<entry><link linkend="replacestyle">replaceStyle</link></entry>
<entry>Removes some of the window styles of a list-view control and sets new styles.</entry>
</row>
<row>
<entry><link linkend="restoreeditclass">restoreEditClass</link></entry>
<entry>Used internally to correct an operating system problem.</entry>
</row>
<row>
<entry><link linkend="scrolllc">scroll</link></entry>
<entry>Scrolls the content of a list view control.</entry>
</row>
<row>
<entry><link linkend="selectlc">select</link></entry>
<entry>Selects an item.</entry>
</row>
<row>
<entry><link linkend="selectedlc">selected</link></entry>
<entry>Returns the index of the first selected item.</entry>
</row>
<row>
<entry><link linkend="selecteditemslc">selectedItems</link></entry>
<entry>Determines the count of selected items in a list-view control.</entry>
</row>
<row>
<entry><link linkend="mthSetColumnOrder">setColumnOrder</link></entry>
<entry>Changes the column order of a list-view control to some other order.</entry>
</row>
<row>
<entry><link linkend="setcolumnwidth">setColumnWidth</link></entry>
<entry>Sets the width, in dialog units, of a column in a list-view control that has the report or list style. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthSetColumnWidthPX">setColumnWidthPX</link></entry>
<entry>Sets the width, in pixels, of a column in a list-view control that has the report or list style.</entry>
</row>
<row>
<entry><link linkend="mthSetHoverTime">setHoverTime</link></entry>
<entry>Used to change the hover time.</entry>
</row>
<row>
<entry><link linkend="mthSetImageListClsListView">setImageList</link></entry>
<entry>Assigns, or removes, an image list for the list-view control.</entry>
</row>
<row>
<entry><link linkend="setitempos">setItemPos</link></entry>
<entry>Moves an item to a specified position in a list-view control that has the icon or small-icon style.</entry>
</row>
<row>
<entry><link linkend="setitemstate">setItemState</link></entry>
<entry>Sets the state of a list-view item.</entry>
</row>
<row>
<entry><link linkend="mthSetItemText">setItemText</link></entry>
<entry>Changes the text of an item, or the text of a subitem, of a list-view item.</entry>
</row>
<row>
<entry><link linkend="smallspacing">smallSpacing</link></entry>
<entry>Determines the spacing between items in a list-view control when it has the  small-icon style.</entry>
</row>
<row>
<entry><link linkend="snaptogrid">snapToGrid</link></entry>
<entry>Snaps all icons to the nearest grid position.</entry>
</row>
<row>
<entry><link linkend="spacing">spacing</link></entry>
<entry>Determines the spacing between items in an icon list-view control.</entry>
</row>
<row>
<entry><link linkend="stringwidth">stringWidth</link></entry>
<entry>Determines the width, in dialog units, of a specified string using the current font of the list-view control. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><link linkend="mthStringWidthPX">stringWidthPX</link></entry>
<entry>Determines the width, in pixels, of a specified string using the current font of the list-view control.</entry>
</row>
<row>
<entry><link linkend="subclassedit">subclassEdit</link></entry>
<entry>Used internally to correct an operating system problem.</entry>
</row>
<row>
<entry><link linkend="textbkcolor">textBkColor</link></entry>
<entry>Retrieves the background color of the text in a list-view control.</entry>
</row>
<row>
<entry><link linkend="textbkcolornew">textBkColor=</link></entry>
<entry>Sets the background color for the text in a list-view control.</entry>
</row>
<row>
<entry><link linkend="textcolor">textColor</link></entry>
<entry>Retrieves the text color of a list-view control.</entry>
</row>
<row>
<entry><link linkend="textcolornew">textColor=</link></entry>
<entry>Sets the text color of a list-view control.</entry>
</row>
<row>
<entry><link linkend="mthUncheckClsListControl">uncheck</link></entry>
<entry>Removes the check mark for the specified list-view item.</entry>
</row>
<row>
<entry><link linkend="mthUncheckAll">uncheckAll</link></entry>
<entry>Clears the check mark for every list-view item.</entry>
</row>
<row>
<entry><link linkend="updateitem">updateItem</link></entry>
<entry>Updates a list-view item.</entry>
</row>
</tbody></tgroup>
</table>

</section>

<section id="viewstyles"><title>View Styles</title>
<indexterm><primary>view styles</primary></indexterm>
<para>List view controls can display their contents in different views. The current
view is specified by the window style of the control. Additional window styles
define the alignment of the items and the functionality of the list-view control.
The different views are:</para>
<variablelist>
<varlistentry><term>Icon view</term>
<listitem><para>Each item appears as a full-sized icon with a label below it. The user
can drag the items to any location in the list view.
</para></listitem></varlistentry>
<varlistentry><term>Small-icon view</term>
<listitem><para>Each item appears as a small icon with a label to the left of it. The
user can drag the items to any location.
</para></listitem></varlistentry>
<varlistentry><term>List view</term>
<listitem><para>Each item appears as a small icon with a label to the left of it. The
user cannot drag the items.
</para></listitem></varlistentry>
<varlistentry><term>Report view</term>
<listitem><para>Each item appears on a separate line with information arranged in columns.
The leftmost column contains the small icon and the label. All following columns
contain subitems as specified by the application.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="tmthNewListView"><title>newListView (dialog object method)</title>
<para>
  List view objects can not be instantiated by the programmer from Rexx code. Rather a list-view object is obtained
  by using the <link linkend="mthNewListView">newListView</link> method of the dialog <link
  linkend="chpDialogObject">object</link>. The syntax is:
<programlisting>
<![CDATA[
>>--newListView(--id--)--------------------------><

]]>
</programlisting>
</para>
</section>  <!-- End newListView() [PlainBaseDialog method] -->


<section id="tmthCreateListView"><title>createListView (UserDialog method)</title>
<para>
  A list-view object can be created in the dialog template for a <link linkend="clsUserDialog">UserDialog</link>
  dialog through the <link linkend="mthCreateListview">createListView</link> method. The basic syntax is:
<programlisting>
<![CDATA[
>>--createListView(-id-,--x-,--y-,--cx-,--cy-+---------+--+------------+--)----><
                                             +-,-style-+  +-,-attrName-+

]]>
</programlisting>
</para>
</section>  <!-- End UserDialog::createListView() [UserDialog method] -->


<section id="tmthConnectListViewEvent"><title>connectListViewEvent (dialog object method)</title>
<para>
  To connect event notifications from a list-view object use the <link
  linkend="mthConnectListViewEvent">connectListViewEvent</link> method of the <link
  linkend="chpDialogObject">dialog</link> object. The basic syntax is:

<programlisting> <![CDATA[
>>-connectListViewEvent(--id--,--event--+---------------+--)-------------------><
                                        +-,--methodName-+

]]>
</programlisting>
</para>
</section>  <!-- End connectListViewEvent() [EventNotification method] -->

<section id="replacestyle"><title>replaceStyle</title>
<indexterm><primary>replaceStyle</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                               +-------------------+
                                               V                   |
>>-aListControl~replaceStyle(--oldStyle--,--"----+-ICON----------+-+--"--)-><
                                                 +-SMALLICON-----+
                                                 +-LIST----------+
                                                 +-REPORT--------+
                                                 +-ALIGNLEFT-----+
                                                 +-ALIGNTOP------+
                                                 +-AUTOARRANGE---+
                                                 +-ASCENDING-----+
                                                 +-DESCENDING----+
                                                 +-EDIT----------+
                                                 +-HSCROLL-------+
                                                 +-VSCROLL-------+
                                                 +-NOSCROLL------+
                                                 +-NOHEADER------+
                                                 +-NOSORTHEADER--+
                                                 +-NOWRAP--------+
                                                 +-SINGLESEL-----+
                                                 +-SHOWSELALWAYS-+
                                                 +-SHAREIMAGES---+
                                                 +-GROUP---------+
                                                 +-HIDDEN--------+
                                                 +-NOTAB---------+
                                                 +-NOBORDER------+


]]>
</programlisting>

<para>The replaceStyle method removes a window style
of a list-view control and sets new styles.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>oldStyle</term>
<listitem><para>The window style to be removed.
</para></listitem></varlistentry>
<varlistentry><term>newStyle</term>
<listitem><para>The new window styles to be set, which is one or more of the styles
listed in the syntax diagram, separated by blanks. For an explanation
of the different styles, refer to <link linkend="mthCreateListView">createListView</link>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if this method fails.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>
  The following example comes from a program where the user can switch between the different view styles
  in a list-view.  The list-view is assigned an image list for both the small and normal icons.  Radio
  buttons for the different views are connected to methods.  When the user clicks one of the radio
  buttons, the method for that radio button uses <computeroutput>replaceStyle</computeroutput>() to
  remove all of the other view styles and add the specified style.
<programlisting>
<![CDATA[

::method initDialog
  expose list

  self~newRadioButton(IDC_RB_ICON)~check
  self~connectButtonEvent(IDC_RB_REPORT, "CLICKED", onReport)
  self~connectButtonEvent(IDC_RB_LIST, "CLICKED", onList)
  self~connectButtonEvent(IDC_RB_ICON, "CLICKED", onIcon)
  self~connectButtonEvent(IDC_RB_SMALL_ICON, "CLICKED", onSmallIcon)

  list  = self~newListView(IDC_LV_VIEWS)

  flags = .Image~toID(ILC_COLOR24)
  imageList = .ImageList~create(.Size~new(16), flags, 7, 0)

  imageList~add(.Image~getImage("iconList_16.bmp"))
  list~setImageList(imageList, .Image~toID(LVSIL_SMALL))

  imageList = .ImageList~create(.Size~new(32), flags, 7, 0)

  imageList~add(.Image~getImage("iconList_32.bmp"))
  list~setImageList(imageList, .Image~toID(LVSIL_NORMAL))

  self~populateList(list)

::method onReport
  expose list
  list~replaceStyle("LIST ICON SMALLICON", "REPORT")

::method onList
  expose list
  list~replaceStyle("REPORT ICON SMALLICON", "LIST")

::method onIcon
  expose list
  list~replaceStyle("LIST REPORT SMALLICON", "ICON")

::method onSmallIcon
  expose list
  list~replaceStyle("LIST ICON REPORT", "SMALLICON")

::method populateList private
  use strict arg list

  list~InsertColumnEx(0, "Title", 150)
  ...

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="addstyle"><title>addStyle</title>
<indexterm><primary>addStyle</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                              +-------------------+
                              V                   |
>>-aListControl~addStyle(--"----+-ICON----------+-+--"--)------><
                                +-SMALLICON-----+
                                +-LIST----------+
                                +-REPORT--------+
                                +-ALIGNLEFT-----+
                                +-ALIGNTOP------+
                                +-AUTOARRANGE---+
                                +-ASCENDING-----+
                                +-DESCENDING----+
                                +-EDIT----------+
                                +-HSCROLL-------+
                                +-VSCROLL-------+
                                +-NOSCROLL------+
                                +-NOHEADER------+
                                +-NOSORTHEADER--+
                                +-NOWRAP--------+
                                +-SINGLESEL-----+
                                +-SHOWSELALWAYS-+
                                +-SHAREIMAGES---+
                                +-GROUP---------+
                                +-HIDDEN--------+
                                +-NOTAB---------+
                                +-NOBORDER------+


]]>
</programlisting>

<para>The addStyle method adds new window styles to a
list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>style</term>
<listitem><para>The window styles to be added, which is one or more of the styles listed
in the syntax diagram, separated by blanks. For an explanation of the different
styles, refer to <link linkend="mthCreateListView">createListView</link>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if this method fails.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="removestyle"><title>removeStyle</title>
<indexterm><primary>removeStyle</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                 +-------------------+
                                 V                   |
>>-aListControl~removeStyle(--"----+-ICON----------+-+--"--)---><
                                   +-SMALLICON-----+
                                   +-LIST----------+
                                   +-REPORT--------+
                                   +-ALIGNLEFT-----+
                                   +-ALIGNTOP------+
                                   +-AUTOARRANGE---+
                                   +-ASCENDING-----+
                                   +-DESCENDING----+
                                   +-EDIT----------+
                                   +-HSCROLL-------+
                                   +-VSCROLL-------+
                                   +-NOSCROLL------+
                                   +-NOHEADER------+
                                   +-NOSORTHEADER--+
                                   +-NOWRAP--------+
                                   +-SINGLESEL-----+
                                   +-SHOWSELALWAYS-+
                                   +-SHAREIMAGES---+
                                   +-GROUP---------+
                                   +-HIDDEN--------+
                                   +-NOTAB---------+
                                   +-NOBORDER------+


]]>
</programlisting>

<para>The removeStyle method removes one or more window
styles of a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>style</term>
<listitem><para>The window styles to be removed, which is one or more of the styles
listed in the syntax diagram, separated by blanks. For an explanation of the
different styles, refer to <link linkend="mthCreateListView">createListView</link>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if this method fails.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddExtendedStyle"><title>addExtendedStyle</title>
<indexterm><primary>addExtendedStyle</primary></indexterm>
<programlisting>
<![CDATA[
                                     +--------------------+
                                     V                    |
>>-aListControl~addExtendedStyle(--"---+-BORDERSELECT-----+--"--)------------><
                                       +-CHECKBOXES-------+
                                       +-DOUBLEBUFFER-----+
                                       +-FLATSB-----------+
                                       +-FULLROWSELECT----+
                                       +-GRIDLINES--------+
                                       +-HEADERDRAGDROP---+
                                       +-INFOTIP----------+
                                       +-LABELTIP---------+
                                       +-MULTIWORKAREAS---+
                                       +-ONECLICKACTIVATE-+
                                       +-REGIONAL---------+
                                       +-SIMPLESELECT-----+
                                       +-SUBITEMIMAGES----+
                                       +-TRACKSELECT------+
                                       +-TWOCLICKACTIVATE-+
                                       +-UNDERLINECOLD----+
                                       +-UNDERLINEHOT-----+

]]>
</programlisting>

<para>The <computeroutput>addExtendedStyle</computeroutput> method adds one or
more of the <link linkend="listControlExtendedStyles">extended
</link> List-View styles to a ListControl.  These styles can not be added until
the underlying Windows List-View control has been created.  They can be added in
the <computeroutput>InitDialog</computeroutput> method or any time thereafter.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>style</term>
<listitem><para>The extended styles to be added.  This argument is a list
containing one or more of the following style keywords, separated by blanks.
Invalid words in the list are ignored.  If there are no valid keywords at all in
the list, then an error is returned.
<variablelist>
<varlistentry><term>BORDERSELECT</term>
<listitem><para>When an item is selected the border color of the item changes
rather than the item being highlighted.
</para></listitem></varlistentry>
<varlistentry><term>CHECKBOXES</term>
<listitem><para>Check boxes are visible and functional in all list-view modes
except tile mode.
</para></listitem></varlistentry>
<varlistentry><term>DOUBLEBUFFER</term>
<listitem><para>Windows XP or later only.  The list-view control is painted
using double buffering.  This reduces flicker.
</para></listitem></varlistentry>
<varlistentry><term>FLATSB</term>
<listitem><para>Enables flat scroll bars.
</para></listitem></varlistentry>
<varlistentry><term>FULLROWSELECT</term>
<listitem><para>Report view only.  When a row is selected, the whole row is
highlighted rather than just the first column.
</para></listitem></varlistentry>
<varlistentry><term>GRIDLINES</term>
<listitem><para>Report view only.  Gridlines are drawn around all items and
sub-items.  This gives a spreadsheet-like appearance to the list-view control.
</para></listitem></varlistentry>
<varlistentry><term>HEADERDRAGDROP</term>
<listitem><para>Report view only. The user can drag and drop the headers to
rearrange the columns.
</para></listitem></varlistentry>
<varlistentry><term>INFOTIP</term>
<listitem><para>With this style a notification is sent to the parent window
before displaying an item's tooltip.  (The current version of ooDialog can not
take advantage of this style.  It is planned for a future enhancement.)
</para></listitem></varlistentry>
<varlistentry><term>LABELTIP</term>
<listitem><para>Windows XP or later only.  In any list-view mode, if an item's
label is only partially visible, the complete label will be displayed in a
fashion similar to a tool tip.
</para></listitem></varlistentry>
<varlistentry><term>MULTIWORKAREAS</term>
<listitem><para>The current version of ooDialog can not take advantage of this
style.  It is planned for a future enhancement.
</para></listitem></varlistentry>
<varlistentry><term>ONECLICKACTIVATE</term>
<listitem><para>Enables the list-view control to send an item activate
notification when the user clicks one time on an item.  It also enables hot
tracking in the list-view control. Both the underline cold and the underline hot
styles need either one click activate or two click activate styles to be
enabled.
</para></listitem></varlistentry>
<varlistentry><term>REGIONAL</term>
<listitem><para>Icon view only.  Sets the window region to only include an
item's icon and text.
</para></listitem></varlistentry>
<varlistentry><term>SIMPLESELECT</term>
<listitem><para>Windows XP and later only.  Icon view only.  Moves the state
image to the top right of the icon image. If the user changes the state using
the space bar, all the selected items cycle, not just the item with the focus.
</para></listitem></varlistentry>
<varlistentry><term>SUBITEMIMAGES</term>
<listitem><para>Report view only.  Allows images to be displayed for subitems.
</para></listitem></varlistentry>
<varlistentry><term>TRACKSELECT</term>
<listitem><para>Enables hot track selection.  The user can select an item by
leaving the mouse over an item for a certain period of time, the
&quot;hover&quot; time.  This period of time can be changed from the default by
using the <link linkend="mthSetHoverTime">setHoverTime</link>  method.
</para></listitem></varlistentry>
<varlistentry><term>TWOCLICKACTIVATE</term>
<listitem><para>Enables the list-view control to send an item activate
notification when the user clicks on an item after it has been selected. When
the user clicks on an item it will be selected. At that point, if the user
clicks on the item a second time, the item will be activated. Note that this is
different from double-clicking to activate.  Any amount of time can pass between
the click that selects the item and the click that activates the item.
(Provided the item remains selected of course.)
</para>
<para> It also works with track select. If track select is enabled, the user can
select an item by pausing the mouse over the item.  At that point, if the user
then clicks on the item it will be activated.
</para></listitem></varlistentry>
<varlistentry><term>UNDERLINECOLD</term>
<listitem><para>Underlining gives the user a visual clue that a single click on
an item will activate it.  Underlining requires either
<computeroutput>ONECLICKACTIVATE</computeroutput> or
<computeroutput>TWOCLICKACTIVE</computeroutput> to also be enabled.  An item
becomes hot when the mouse is over it.  Underline cold underlines all the cold
items when a single click will activate them.  When one click activate is
enabled, this would then be all items.  When two click activate is enabled this
would then be only those items that were selected.
</para></listitem></varlistentry>
<varlistentry><term>UNDERLINEHOT</term>
<listitem><para>The underline hot style is similar to the underline cold style.
See that style above for the explanation of some of the terms.  With underline
hot, the item is underlined when the mouse is over it, if one click will
activate the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The style argument did not contain any of the extended style
keywords.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example shows how to initially add the extended
styles to a list-view control.  This is done in the
<computeroutput>InitDialog</computeroutput> method, which executes after the
underlying Windows dialog has been created, but before it is displayed on the
screen.  This is the earliest point in time that the extended style methods can
be used.  The list-view is in the report view and will have check boxes and grid
lines.  The user will be able to use drag and drop to rearrange the columns.
When a row is selected, the full row will be highlighted rather than just the
first column.
<programlisting> <![CDATA[

::method initDialog
  expose listView

  ...
  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~addExtendedStyle("CHECKBOXES GRIDLINES FULLROWSELECT HEADERDRAGDROP")
  ...

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthRemoveExtendedStyle"><title>removeExtendedStyle</title>
<indexterm><primary>removeExtendedStyle</primary></indexterm>
<programlisting>
<![CDATA[
                                         +--------------------+
                                         V                    |
>>-aListControl~removeExtendedStyle(--"----+-BORDERSELECT-----+--"--)-------><
                                           +-CHECKBOXES-------+
                                           +-DOUBLEBUFFER-----+
                                           +-FLATSB-----------+
                                           +-FULLROWSELECT----+
                                           +-GRIDLINES--------+
                                           +-HEADERDRAGDROP---+
                                           +-INFOTIP----------+
                                           +-LABELTIP---------+
                                           +-MULTIWORKAREAS---+
                                           +-ONECLICKACTIVATE-+
                                           +-REGIONAL---------+
                                           +-SIMPLESELECT-----+
                                           +-SUBITEMIMAGES----+
                                           +-TRACKSELECT------+
                                           +-TWOCLICKACTIVATE-+
                                           +-UNDERLINECOLD----+
                                           +-UNDERLINEHOT-----+

]]>
</programlisting>

<para>The <computeroutput>removeExtendedStyle</computeroutput> method removes
one or more <link linkend="listControlExtendedStyles">extended</link> styles of
a List-View control.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>style</term>
<listitem><para>The extended style(s) to be removed.  This is one or more of the
styles listed in the syntax diagram, separated by blanks. For an explanation
of the different styles, refer to the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The style argument did not contain any of the extended style
keywords.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example removes the check box style from the list
view.
<programlisting>
<![CDATA[

  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~removeExtendedStyle("CHECKBOXES")

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthReplaceExtendedStyle"><title>replaceExtendedStyle</title>
<indexterm><primary>replaceExtendedStyle</primary></indexterm>
<programlisting>
<![CDATA[
                                                     +--------------------+
                                                     V                    |
>>-aListControl~replaceExtendedStyle(-oldStyle--,--"---+-BORDERSELECT-----+--"-)-><
                                                       +-CHECKBOXES-------+
                                                       +-DOUBLEBUFFER-----+
                                                       +-FLATSB-----------+
                                                       +-FULLROWSELECT----+
                                                       +-GRIDLINES--------+
                                                       +-HEADERDRAGDROP---+
                                                       +-INFOTIP----------+
                                                       +-LABELTIP---------+
                                                       +-MULTIWORKAREAS---+
                                                       +-ONECLICKACTIVATE-+
                                                       +-REGIONAL---------+
                                                       +-SIMPLESELECT-----+
                                                       +-SUBITEMIMAGES----+
                                                       +-TRACKSELECT------+
                                                       +-TWOCLICKACTIVATE-+
                                                       +-UNDERLINECOLD----+
                                                       +-UNDERLINEHOT-----+


]]>
</programlisting>

<para>The <computeroutput>replaceExtendedStyle</computeroutput> method removes
some of the List-View control's <link linkend="listControlExtendedStyles">extended
</link> styles and adds new extended styles. This is the equivalent of first
using the <computeroutput>RemoveExtendeStyle</computeroutput> method and then
using the <computeroutput>addExtendedStyle</computeroutput> method.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>oldStyle</term>
<listitem><para>The extended style(s) to be removed.  This is one or more of the
styles listed in the syntax diagram, separated by blanks. For an explanation
of the different styles, refer to the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method.
</para></listitem></varlistentry>
<varlistentry><term>newStyle</term>
<listitem><para>The extended style(s) to be added.  Again, this is one or more
of the styles listed in the syntax diagram, separated by blanks. See the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method for the style
descriptions.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>One, or both, of the style arguments had none of the extended
style keywords.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example removes the cold and hot underlining and
adds check boxes to the list view.
<programlisting>
<![CDATA[

  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  removeStyle = "UNDERLINECOLD UNDERLINEHOT"
  addStyle = "CHECKBOXES"

  listView~replaceExtendedStyle(removeStyle, addStyle)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetExtendedStyle"><title>getExtendedStyle</title>
<indexterm><primary>getExtendedStyle</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~GetExtendedStyle---------------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>getExtendedStyle</computeroutput> method returns
the <link linkend="listControlExtendedStyles">extended</link> styles of a
<computeroutput>ListView</computeroutput>.  The styles are returned as a
string of blank delimited style keywords.  These are the same keywords as those
used to set the styles.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The returned string can contain one or more of the following
style keywords. See the <link linkend="mthAddExtendedStyle">addExtendedStyle</link>
method for the style descriptions:
<itemizedlist>
<listitem><para>BORDERSELECT</para></listitem>
<listitem><para>CHECKBOXES</para></listitem>
<listitem><para>DOUBLEBUFFER</para></listitem>
<listitem><para>FLATSB</para></listitem>
<listitem><para>FULLROWSELECT</para></listitem>
<listitem><para>GRIDLINES</para></listitem>
<listitem><para>HEADERDRAGDROP</para></listitem>
<listitem><para>INFOTIP</para></listitem>
<listitem><para>LABELTIP</para></listitem>
<listitem><para>MULTIWORKAREAS</para></listitem>
<listitem><para>ONECLICKACTIVATE</para></listitem>
<listitem><para>REGIONAL</para></listitem>
<listitem><para>SIMPLESELECT</para></listitem>
<listitem><para>SUBITEMIMAGES</para></listitem>
<listitem><para>TRACKSELECT</para></listitem>
<listitem><para>TWOCLICKACTIVATE</para></listitem>
<listitem><para>UNDERLINECOLD</para></listitem>
<listitem><para>UNDERLINEHOT</para></listitem>
</itemizedlist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example comes from a fictious application where
the user can elect to use the track select style, or not.  With this style, an
item can be selected by pausing the mouse over it for a period of time specified
by the hover time.  The application also allows the user to increase or decrease
the hover time.  In this example when the methods to increment or decrement the
hover time are invoked, the application first checks to see if the list-view
control has the track select style.  Then the change is only made if the list
view control does have the style.
<programlisting> <![CDATA[

::method initDialog
  expose listView

  ...
  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~addExtendedStyle("CHECKBOXES FULLROWSELECT TRACKSELECT")
  ...

::method onCheckboxClick
  expose listView

  chkBox = self~newCheckBox(IDC_CHECK_USETRACKSELECT)
  if chkBox~checked then
    listView~addExtendedStyle("TRACKSELECT")
  else
    listView~removeExtendedStyle("TRACKSELECT")

::method onDecrement
  expose listView

  styles = listView~getExtendedStyle
  if styles~wordpos("TRACKSELECT") == 0 then return

  time = listView~getHoverTime - 100
  if time > 0 then listView~setHoverTime(time)

::method onIncrement
  expose listView

  styles = listView~getExtendedStyle
  if styles~wordpos("TRACKSELECT") == 0 then return

  -- Let the user increase the hover time to any length they want.
  listView~setHoverTime(list~getHoverTime + 100)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetExtendedStyleRaw"><title>getExtendedStyleRaw</title>
<indexterm><primary>getExtendedStyleRaw</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~GetExtendedStyleRaw------------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>getExtendedStyleRaw</computeroutput> method returns
the <link linkend="listControlExtendedStyles">extended</link> styles of a
<computeroutput>ListView</computeroutput> as the numeric value of the
extended style flags.  This method is provided for programmers familiar with the
Windows API who may wish to know, or to work with, the actual value of the
flags.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The returned value is the numeric value of the extended style
flags currently in effect for the list-view control.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is the same example as the <link
linkend="mthGetExtendedStyle">getExtendedStyle</link> example.  It simply
replaces the <computeroutput>getExtendedStyle</computeroutput> invocation with a
<computeroutput>getExtendedStyleRaw</computeroutput> invocation.
<programlisting> <![CDATA[

::method initDialog
  expose listView

  ...
  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~addExtendedStyle("CHECKBOXES FULLROWSELECT TRACKSELECT")
  ...

::method onCheckboxClick
  expose listView

  chkBox = self~newCheckBox(IDC_CHECK_USETRACKSELECT)
  if chkBox~checked then
    listView~addExtendedStyle("TRACKSELECT")
  else
    listView~removeExtendedStyle("TRACKSELECT")

::method onDecrement
  expose listView

  if .DlgUtil~and(listView~getExtendedStyleRaw, "0x00000008") == 0 then return

  time = listView~getHoverTime - 100
  if time > 0 then listView~setHoverTime(time)

::method onIncrement
  expose listView

  if .DlgUtil~and(listView~getExtendedStyleRaw, "0x00000008") == 0 then return

  -- Let the user increase the hover time to any length they want.
  listView~setHoverTime(list~getHoverTime + 100)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetHoverTime"><title>getHoverTime</title>
<indexterm><primary>getHoverTime</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~GetHoverTime-----------------------------------><

]]>
</programlisting>

<para>This method retrieves the current hover time.  The hover time is expressed
as milliseconds.  The hover time only affects list-view controls that have the
track select, one click activate, or two click activate extended list-view
styles. See the
<link linkend="mthAddExtendedStyle">addExtendedStyle
</link> for a description of these
styles.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The hover time.  A value of -1 indicates the hover time is the
system default hover time.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example comes from a program where the one click
activate and track select styles are enabled.  Orignally the hover time is set
to .4 seconds.  However the application allows the users to increase or decrease
this time to match their preference.  A menu item (or a button could be used) is
connected to the <computeroutput>onIncrement</computeroutput> and
<computeroutput>onDecrement</computeroutput> methods.  When either of the
methods is invoked, the current hover time is examined and then either
incremented or decremented by .1 of a second.
<programlisting> <![CDATA[

::method initDilaog
  expose list

  ...
  list = self~newListView(IDC_LIST)
  list~addExtendedStyle("ONECLICKACTIVATE TRACKSELECT FULLROWSELECT")
  list~setHoverTime(400)
  ...

::method onDecrement
  expose list

  time = list~getHoverTime - 100
  if time > 0 then list~setHoverTime(time)

::method onIncrement
  expose list

  -- Let the user increase the hover time to any length they want.
  list~setHoverTime(list~getHoverTime + 100)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetHoverTime"><title>setHoverTime</title>
<indexterm><primary>setHoverTime</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~setHoverTime(--+------+--)---------------------><
                               +-time-+

]]>
</programlisting>

<para>This method is used to change the <emphasis role="italic">hover</emphasis>
time.  The hover time only affects list-view controls that have the track
select, one click activate, or two click activate extended list-view styles. See
the <link linkend="mthAddExtendedStyle">addExtendedStyle</link> for a
description of these styles.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only optional argument is:
<variablelist>
<varlistentry><term>time</term>
<listitem><para>Specify the hover time in milliseconds.  If this argument is
omitted, the hover time is set to the system default.  A negative number will
also set the hover time back to the system defualt.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The previous hover time.  A value of -1 indicates the previous
hover time was the system default.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example adds the one click activate, the track
select, and the full row select extended list-view styles to a
<computeroutput>ListView</computeroutput>.  The hover time is set to .4
seconds. If the user pauses his mouse over a row in the list-view for .4 of a
second the row is automatically selectd.
<programlisting> <![CDATA[
::method initDilaog

  ...
  list = self~newListView(IDC_LIST)
  list~addExtendedStyle("ONECLICKACTIVATE FULLROWSELECT TRACKSELECT")

  oldTime = list~setHoverTime(400)
  ...

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthCheckClsListControl"><title>check</title>
<indexterm><primary>check</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~check(--index--)--------------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>check</computeroutput> method sets the check mark for
a list-view item.  This method is only valid for list-view controls that have
the check boxes extended style.  (See the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item for which to set the check mark.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The index is invalid.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a mailing list application.  The
user selects which entries to include in any mailing.  All items in a list-view
that have their check boxes checked are included in the mailing.  The
application has a feature that allows the user to automatically select all items
with a specified zip code.
<programlisting>
<![CDATA[

::method onUseZip

  text = self~newEdit(IDC_EDIT_ZIPCODE)~getText
  if self~validateZip(text) then do
     list = self~newListView(IDC_LIST)
     do i = 0 to addresses~items - 1
       infoTable = address[i + 1]
       if infoTable['zip'] == text then list~check(i)
     end
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthUncheckClsListControl"><title>uncheck</title>
<indexterm><primary>uncheck</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~uncheck(--index--)------------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>uncheck</computeroutput> method removes the check mark
for a list-view item.  This method is only valid for list-view controls that
have the check boxes extended style.  (See the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item where the check box check is to be
removed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The index is invalid.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a doctor's office custom
accounting application.  A list box is filled with information for every
patient.  One button in the application checks every patient with an outstanding
balance, they will be mailed a statement for that balance.  The doctor does not
believe in sending billing statements to patients that have a very low balance.
However what a &quot;low&quot; balance is depends on how he is feeling at
statement time. Therefore the application allows the office manager to
dynamically remove some patients from the statement list.
<programlisting>
<![CDATA[

::method onDeferBilling
  expose billingList

  text = self~newEdit(IDC_EDIT_MINAMOUNT)~getText
  minimun = self~decimalNumber(text)

  if minimum > 0 then do i = 0 to billingList~items
    if billingList~isChecked(i) then do

      -- Column 6 in the list is the patient's current balance.
      owes = billingList~itemText(i, 6)
      if self~decimalNumber(owes) <= minimum then billingList~uncheck(i)

    end
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthCheckAll"><title>checkAll</title>
<indexterm><primary>checkAll</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~CheckAll----------------------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>checkAll</computeroutput> method sets the check mark
for every list-view item.  This method is only valid for list-view controls that
have the check boxes extended style.  (See the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a program that has a push button
that allows the user to check all the check boxes:
<programlisting>
<![CDATA[

::method onCheckAll

  list = self~newListView(IDC_LIST_REPUBLICANS)
  list~checkAll

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthUncheckAll"><title>uncheckAll</title>
<indexterm><primary>uncheckAll</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~UncheckAll--------------------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>uncheckAll</computeroutput> method clears the check
mark for every list-view item.  This method is only valid for list-view controls
that have the check boxes extended style.  (See the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a program that has a push button
that allows the user to remove the check mark from all the check boxes:
<programlisting>
<![CDATA[

::method onUncheckAll

  list = self~newListView(IDC_LIST_REPUBLICANS)
  list~uncheckAll

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthHasCheckBoxes"><title>hasCheckBoxes</title>
<indexterm><primary>hasCheckBoxes</primary></indexterm>
<indexterm><primary>Listview class</primary><secondary>hasCheckBoxes</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hasCheckBoxes--------------------------------><

]]>
</programlisting>

<para>
  Determines if the list-view has the CHECKBOXES extended style.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if the list-view has the CHECKBOXES extended style, otherwise
    <computeroutput>.false</computeroutput> .
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Listview::hasCheckBoxes() -->


<section id="mthGetCheck"><title>getCheck</title>
<indexterm><primary>getCheck</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~getCheck(--index--)-----------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>getCheck</computeroutput> method determines if the
item at the specified list index has a checked check box. This method will
return a code indicating that the list-view control does not have the check
boxes extended style, if appropriate.  (See the <link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item to query.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The item has a check box that is checked.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The item has a check box, and it is not checked.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The index is invalid.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example could be used as a shortcut method to
determine if a list-view control currently has the check box extended style.
<programlisting>
<![CDATA[

  ...
  list = self~newListView(IDC_LV_DOCTORS)
  if list~getCheck(0) == -2 then
    return   -- The list-view does not currently have the check box style in effect

  do i = 0 to list~items - 1
    ...
  end


]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthIsCheckedClsListControl"><title>isChecked</title>
<indexterm><primary>isChecked</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~isChecked(--index--)----------------------------------------><

]]>
</programlisting>

<para>The <computeroutput>isChecked</computeroutput> method determines if a
check box for a list-view item is checked or not.  This method will always
return true or false.  It can be used if the list-view control has or does not
have the check boxes extended style. (See the<link
linkend="mthAddExtendedStyle">addExtendedStyle</link> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item to query.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>true</term>
<listitem><para>The list-view item has a check box and it is checked.
</para></listitem></varlistentry>
<varlistentry><term>false</term>
<listitem><para>There is no check mark for the list-view item.  Either the list
view has check boxes and the check box is not checked, the index is out of range
or not valid, or the list-view does not have the check box extended style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a doctor's office custom
accounting application.  A list box is filled with information for every
patient.  After the office mananger has finished working with the accounts a
mail merge is done to produce statements for all patients that are to receive
statements for the month.  For every patient item in the list-view, if the item
has a check mark, then that patient is mailed a statement.
<programlisting> <![CDATA[

::method onCreateMailMerge
  expose patientList

  do i = 0 to patientList~items
    if billingList~isChecked(i) then do
      self~addToMailMerge(billingList, i)
    end
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthInsertColumnPX"><title>insertColumnPX</title>
<indexterm><primary>insertColumnPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>insertColumnPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertColumnPX(--+----------+--,--text--,--width--+--------+--)------------><
                     +--colNum--+                     +-,-fmt--+
]]>
</programlisting>

<para>
  Inserts a new column into the list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>colNum [optional]</term>
      <listitem>
      <para>
        The zero-based index for the column being inserted. Columns are numbered from the left to the right. The default
        if this arugment is omitted is column 0.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>text [required]</term>
      <listitem>
      <para>
        The text (label) for the column.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>width [required]</term>
      <listitem>
      <para>
        The width of the column being inserted, specified in pixels.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fmt [optional]</term>
      <listitem>
      <para>
        One of the following keywords, case is not significant. The keyword specifies the format for the column being
        inserted. At this time not all formats for the column are recognized. Other format keywords may be added in the
        future.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>LEFT  </member>
          <member>CENTER</member>
          <member>RIGHT </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>LEFT</term>
          <listitem>
          <para>
            Text in the column is aligned to the left. This is the default if this argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CENTER</term>
          <listitem>
          <para>
            The text for the column is centered.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RIGHT</term>
          <listitem>
          <para>
            The text for the column is aligned right.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the index of the newly inserted column on success, otherwise -1.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The text for the column must be less than 256 characters long. The inserted columns are only visible when the
    list-view is in report view, but, columns can be inserted into the list-view control when it is in any view.
  </para>
  <para>
    This method and the <link linkend="mthInsertColumn">insertColumn</link> method are virtually the same, except that
    in this method the width of the column is specified in pixels. The <emphasis role="italic">insertColumn</emphasis>
    method takes dialog units for the width and then converts them to pixels using <link
    linkend="ovvInaccurate">factorX</link>. This makes the width used by the <emphasis
    role="italic">insertColumn</emphasis> method inaccurate.
  </para>
  <para>
    <emphasis role="bold">Note</emphasis> that previous versions of this documentation incorrectly stated that the
    <emphasis role="italic">insertColumn</emphasis> used pixels to specify the width.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example inserts 3 columns into the list-view control. Each column will be 50 pixels wide and left aligned.
<programlisting>
<![CDATA[

::method initReportView
  lv = self~newListView(IDC_LV_STATS)

  lv~insertColumnPX(0, "First Name", 50)
  lv~insertColumnPX(1, "Last Name", 50)
  lv~insertColumnPX(2, "Age", 50)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::insertColumnPX() -->


<section id="mthInsertColumn"><title>insertColumn</title>
<indexterm><primary>insertColumn</primary></indexterm>
<programlisting>
<![CDATA[
                               +-0------+
>>-aListControl~insertColumn(--+--------+--,--text--,-->
                               +-column-+

>--,--width--+---------------------+--)---------------><
             |       +-LEFT---+    |
             +-,--"--+-CENTER-+--"-+
                     +-RIGHT--+


]]>
</programlisting>

<para>The insertColumn method sets the attributes of
a report list-view column.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column. 0 is the first column and the default.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>The text of the column heading.
</para></listitem></varlistentry>
<varlistentry><term>width</term>
<listitem><para>The width of the column, in dialog units.
</para></listitem></varlistentry>
<varlistentry><term>align</term>
<listitem><para>The alignment of the column heading and the subitem text within the
column. It can be one of the following values:
<variablelist>
<varlistentry><term>CENTER</term>
<listitem><para>The text is centered.
</para></listitem></varlistentry>
<varlistentry><term>LEFT</term>
<listitem><para>The text is left-aligned, which is the default.
</para></listitem></varlistentry>
<varlistentry><term>RIGHT</term>
<listitem><para>The text is right-aligned.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the new column, or 0 if this method fails.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="deletecolumn"><title>deleteColumn</title>
<indexterm><primary>deleteColumn</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~deleteColumn(--column--)-----------------------><


]]>
</programlisting>

<para>The deleteColumn method removes a column from a
list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column to be deleted. The first column must be deleted
last.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The column was deleted.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">column</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthModifyColumnPX"><title>modifyColumnPX</title>
<indexterm><primary>modifyColumnPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>modifyColumnPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modifyColumnPX(--index--+---------+--+----------+--+--------+--)-----------><
                            +-,-text--+  +-,-width--+  +-,-fmt--+
]]>
</programlisting>

<para>
  Modifies some, or all, of the attributes of an exsiting column in a list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index for the column being modified. Columns are numbered from the left to the right.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>text [optional]</term>
      <listitem>
      <para>
        If this argument is included, the text for the column is changed to the text specified.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>width [optiona]</term>
      <listitem>
      <para>
        The new width of the column, in pixels. If the argument is omitted, the width is left unchanged.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fmt [optional]</term>
      <listitem>
      <para>
        One of the following keywords separated by spaces, case is not significant. The keyword specifies the new format
        for the column being modified. If the <emphasis role="italic">fmt</emphasis> argument is omitted, the alignment
        is left unchanged. At this time not all formats for the column are recognized. Other format keywords may be
        added in the future.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>LEFT  </member>
          <member>CENTER</member>
          <member>RIGHT </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>LEFT</term>
          <listitem>
          <para>
            Text in the column is aligned to the left.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CENTER</term>
          <listitem>
          <para>
            The text for the column is centered.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RIGHT</term>
          <listitem>
          <para>
            The text for the column is aligned right.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    0 is returned on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the title, size, and alignment of the first three columns in a list-view control.  The columns
    are only visible when the list-view is in report view.
<programlisting>
<![CDATA[

::method changeColumn
  lv = self~newListView(IDC_LV_AVAILABLE_AUTOS)
  lv~modifyColumn(0, "Make", 100, "RIGHT")
  lv~modifyColumn(1, "Model", 150, "RIGHT")
  lv~modifyColumn(1, "Color", 80, "CENTER")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::modifyColumnPX() -->


<section id="modifycolumn"><title>modifyColumn</title>
<indexterm><primary>modifyColumn</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~modifyColumn(--column--,--+------+--,--width---->
                                          +-text-+

>--+---------------------+--)----------------------------------><
   |       +-LEFT---+    |
   +-,--"--+-CENTER-+--"-+
           +-RIGHT--+


]]>
</programlisting>

<para>The modifyColumn method sets new attributes for
a column of a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column. 0 is the first column.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>The text of the column heading. If you omit this argument, the heading
is not changed.
</para></listitem></varlistentry>
<varlistentry><term>width</term>
<listitem><para>The width of the column, in pixels.
</para></listitem></varlistentry>
<varlistentry><term>align</term>
<listitem><para>The alignment of the column heading and the subitem text within the
column. It can be one of the following values:
<variablelist>
<varlistentry><term>CENTER</term>
<listitem><para>The text is centered.
</para></listitem></varlistentry>
<varlistentry><term>LEFT</term>
<listitem><para>The text is left-aligned, which is the default.
</para></listitem></varlistentry>
<varlistentry><term>RIGHT</term>
<listitem><para>The text is right-aligned.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The column was modified.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">column</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetColumnInfo"><title>getColumnInfo</title>
<indexterm><primary>getColumnInfo</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getColumnInfo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColumnInfo(--index--,--directory--)-------><

]]>
</programlisting>

<para>
  Retrieves information for the column specified in a <computeroutput>Directory</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index of the column to retrieve information for. Columns are numbered from the left to the right.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>directory [required]</term>
      <listitem>
      <para>
        A <computeroutput>Directory</computeroutput> object whose indexes will be filled with the returned column
        information. On success, the <computeroutput>Directory</computeroutput> object will have the following indexes
        with the corresponding information:

        <variablelist>
          <varlistentry><term><emphasis role="bold">text</emphasis></term>
          <listitem>
          <para>
            The text (label) for the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">subitem</emphasis></term>
          <listitem>
          <para>
            The index of the subitem associated with the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">width</emphasis></term>
          <listitem>
          <para>
            The width, in pixels, of the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">fmt</emphasis></term>
          <listitem>
          <para>
            A series of blank separted key words specifying the format for the column. See the remarks.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success and <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    No other indexes in the <emphasis role="italic">directory</emphasis> object will be touched other than those noted.
    On error, the value of the noted indexes is undefined.
  </para>
  <para>
    The <computeroutput>fmt</computeroutput> index, at this time, will contain exactly one keyword, either LEFT, RIGHT,
    or CENTER denoting the alignment of the text for the column. However, the underlying list-view control has a number
    of other format attributes. These other attributes are currently ignored by the ooDialog framework. Future versions
    of ooDialog may be enhanced to include more keywords.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example displays information about the column when the user clicks on it:
<programlisting>
<![CDATA[

::method onColumnClick
  use arg id, column
  listView = self~newListView(IDC_LV_PROPERTIES)

  d = .Directory~new
  if listView~getClumnInfo(column, d) then do

    msg = "Column Title : " d~text    || .endOfLine || -
          "Column Number: " d~subitem || .endOfLine || -
          "Column Width : " d~width   || .endOfLine || -
          "Alignment    : " d~fmt

    j = MessageDialog(msg, self~hwnd, "List View Column Information")
  end
  else do
    j = MessageDialog("Failed to get column information.", self~hwnd, "Windows API Error")
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getColumnInfo() -->


<section id="columninfo"><title>columnInfo</title>
<indexterm><primary>columnInfo</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~columnInfo(--column--)-------------------------><


]]>
</programlisting>

<para>The columnInfo method retrieves the attributes
of a column of a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column of which the attributes are to be retrieved.
0 is the first column.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A compound variable that stores the attributes of the item.
If attributes for a column are not available or an error occurs, then the
RetStem.!WIDTH variable will be set to 0.
<variablelist>
<varlistentry><term>RetStem.!TEXT</term>
<listitem><para>The heading of the column.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!COLUMN</term>
<listitem><para>The column number.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!WIDTH</term>
<listitem><para>The width of the column.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!ALIGN</term>
<listitem><para>The alignment of the column: &quot;LEFT&quot;, &quot;RIGHT&quot;, or &quot;CENTER&quot;.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthColumnWidthPX"><title>columnWidthPX</title>
<indexterm><primary>columnWidthPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>columnWidthPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--columnWidthPX(--colIndex--)------------------><

]]>
</programlisting>

<para>
  Gets the width, in pixels, of the specified column in a list-view control when it has the list or report view styles.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The singel argument is:
    <variablelist>
      <varlistentry><term>colIndex [required]</term>
      <listitem>
      <para>
        The zero-based index of the column to query.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The width of the column, in pixels, on success or zero on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">colIndex</emphasis> argument is ignored when the list-view has the list style.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::columnWidthPX() -->

<section id="columnwidth"><title>columnWidth</title>
<indexterm><primary>columnWidth</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~columnWidth(--column--)------------------------><


]]>
</programlisting>

<para>The columnWidth method retrieves the width of a
column in a report or list view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column of which the width is to be retrieved. 0 is
the first column.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The column width, or -1 if you did not specify <emphasis role="italic">column</emphasis>,
or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the column width in an information box
when the column is clicked on:
<programlisting>
<![CDATA[
::method onColumnClick
  use arg id, column
  listView = self~newListView(102)
  call infoDialog listView~columnWidth(column)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetColumnWidthPX"><title>setColumnWidthPX</title>
<indexterm><primary>setColumnWidth</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>setColumnWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setColumnWidthPX(--colIndex--+-----------+--)---------------><
                                 +--,-width--+
]]>
</programlisting>

<para>
  Sets the width, in pixels, of a column in a list-view control that has the report or list style.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>colIndex [required]</term>
      <listitem>
      <para>
        The zero-based index of the column whose width is to be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>width [optional]</term>
      <listitem>
      <para>
        A positive whole number specifying the width in pixels for the column. If, the list-view is in report view, one
        of the following keywords are also valid:
        <variablelist>
          <varlistentry><term><emphasis role="bold">AUTO:</emphasis></term>
          <listitem>
          <para>
            The list-view will automatically size the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">AUTOHEADER:</emphasis></term>
          <listitem>
          <para>
            Automatically sizes the column to fit the column text. When this value for the last column, its width is set
            to fill the remaining width of the list-view control.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    Provided that the list-view is in report view, this example has the list-view automatically size the first two
    columns, and then size the last column to take up all the rest of the width in the control.
<programlisting>
<![CDATA[

  list = self~newListView(IDC_LV_SALES)

  list~setColumnWidthPX(0, "AUTO")
  list~setColumnWidthPX(1, "AUTO")
  list~setColumnWidthPX(2, "AUTOHEADER")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::setColumnWidthPX() -->


<section id="setcolumnwidth"><title>setColumnWidth</title>
<indexterm><primary>setColumnWidth</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~setColumnWidth(--column--+----------+--)-------><
                                         +-,--width-+


]]>
</programlisting>

<para>The setColumnWidth method sets the width of a column
in a report or list view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column of which the width is to be set. 0 is the first
column.
</para></listitem></varlistentry>
<varlistentry><term>width</term>
<listitem><para>The width of the column, in pixels. If you omit this argument, the column
is sized automatically.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The column width was set.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">column</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example enlarges the selected column by 10:
<programlisting>
<![CDATA[
::method OnColumnClick
  use arg id, column
  curList = self~newListView(102)
  curList~setColumnWidth(column,curList~columnWidth(column)+10)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetColumnCount"><title>getColumnCount</title>
<indexterm><primary>getColumnCount</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColumnCount----------------------------------------------------><

]]>
</programlisting>

<para>
  This method returns the number of columns in the list-view control when it is in report view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      There are no arguments.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns the number of colunms, or -1 on some error. An error is unlikely.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This method is straight forward to use:
<programlisting>
<![CDATA[
colCount = list~getColumnCount
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::getColumnCount() -->


<section id="mthGetColumnOrder"><title>getColumnOrder</title>
<indexterm><primary>getColumnOrder</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColumnOrder----------------------------------------------------><

]]>
</programlisting>

<para>
  Retrieves the current column order of the list-view when in report view. The order of the columns can
  be changed programmatically by using  the <link linkend="mthSetColumnOrder">setColumnOrder</link>()
  method. In XP and later there is also an <link linkend="mthAddExtendedStyle">extended</link> style
  which lets the user rearrange the order of the columns. If the list-view control has not had the
  columns rearranged, then the column order will always be 0, 1, 2, ... of course.
</para>
<para>
  One practical use of this method would be in conjuction with the <link
  linkend="mthSetColumnOrder">setColumnOrder</link>() method. In an application where the user can
  rearrange the column order, the programmer could get the order when a dialog closes, save it, and then
  restore the order to the user's preference when the application is restarted.
</para>
<para>
  Note that the list-view control does not have to have the HEADERDRAGDROP style for the get and set
  column order methods to work. That style is only needed to allow the user to rearrange the columns
  using drag and drop. The programmer can use <link linkend="mthSetColumnOrder">setColumnOrder</link>()
  to change the order of the columns whether or not the list-view has the HEADERDRAGDROP style, or not.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      There are no arguments.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>an <computeroutput>.Array</computeroutput> object</term>
        <listitem>
          <para>
            An array is returned with the index numbers of the columns. The number at the first position
            in the array is the column index of the left-most column. The number in the second position
            in the array is the index of the second left-most column, etc..
          </para>
        </listitem></varlistentry>
        <varlistentry><term><computeroutput>.nil</computeroutput></term>
        <listitem>
          <para>
            <computeroutput>.nil</computeroutput> is returned for some unexpected error.  This is
            unlikely.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example prints out the column order when the dialog is first initialized, and then prints out
      the order when the dialog closes.
<programlisting>
<![CDATA[
  ...
  list = self~newListView(100)

  columnNames = .array~of("Occupation", "Name", "Age", "Sex")
  list~addExtendedStyle("FULLROWSELECT GRIDLINES CHECKBOXES HEADERDRAGDROP")

  list~insertColumn(0, columnNames[1], 95)
  list~insertColumn(1, columnNames[2], 95)
  list~insertColumn(2, columnNames[3], 95)
  list~insertColumn(3, columnNames[4], 35)

  self~printColumnOrder
  ...

::method close

  self~printColumnOrder
  return self~ok:super

::method printColumnOrder private
  expose list columnNames

  cols = list~getColumnOrder
  say 'cols:' cols
  say 'Column count: ' list~getColumnCount
  say 'Current order:'
  if cols~isA(.array) then do c over cols
    -- Column indexes are zero-based
    c += 1
    say " " columnNames[c]
  end

/* Output might be, (assuming the user changed the order):

cols: an Array
Column count:  4
Current order:
  Occupation
  Name
  Age
  Sex

cols: an Array
Column count:
Current order:
  Age
  Name
  Sex
  Occupation

*/
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::getColumnOrder() -->


<section id="mthSetColumnOrder"><title>setColumnOrder</title>
<indexterm><primary>setColumnOrder</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setColumnOrder(--order--)-----------------------------------------><

]]>
</programlisting>

<para>
  Changes the column order of a list-view control to some other order. Typically this method might be
  used along with the <link linkend="mthGetColumnOrder">getColumnOrder</link>() method to save and
  restore the user's column order. But, it can also be used to programmatically change the column order
  for any reason.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      The single required argument is:
    <variablelist>
      <varlistentry><term>order</term>
      <listitem>
        <para>
          An array containing the index numbers of the columns in their new order. The number at the
          first position in the array is the column index of the column that should be the left-most. The
          number at the second position in the array, and so on.
        </para>
        <para>
          The array has to contain the same number of items as the number of columns with no empty
          indexes.
        </para>
        <para>
          If non-valid column indexes are intermingled with valid column indexes, then the columns are
          re-ordered, but with no easily predictable pattern.  If all the number are invalid column
          indexes, then the order of the columns remains unchanged. This behavior is the behavior of the
          underlying control, ooDialog has no control over it.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term><computeroutput>.true</computeroutput></term>
        <listitem>
          <para>
            The method succeeded.
          </para>
        </listitem></varlistentry>
        <varlistentry><term><computeroutput>.false</computeroutput></term>
        <listitem>
          <para>
            Some error occurred. This is unlikely.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      Raises syntax errors when incorrect arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      In this example an application has two modes. One mode emphasizes the occupation of the people in a
      database, the other mode emphasizes the people. The order of the columns is occupation, name, ...
      for the first mode and name, occupation, ... for the second mode. When the mode of the application
      changes, the order of the columns also changes.
<programlisting>
<![CDATA[
  ...
  list = self~newListView(100)

  columnNames = .array~of("Occupation", "Name", "Age", "Sex")
  list~addExtendedStyle("FULLROWSELECT GRIDLINES CHECKBOXES")

  list~insertColumn(0, columnNames[1], 95)
  list~insertColumn(1, columnNames[2], 95)
  list~insertColumn(2, columnNames[3], 95)
  list~insertColumn(3, columnNames[4], 35)
  ...

::method toggleColumnOrder private
  expose list

  order = list~getColumnOrder
  tmp = order[1]
  order[1] = order[2]
  order[2] = tmp
  list~setColumnOrder(order)
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::setColumnOrder() -->

<section id="mthStringWidthPX"><title>stringWidthPX</title>
<indexterm><primary>stringWidthPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>stringWidthPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--stringWidthPX(--text--)----------------------><

]]>
</programlisting>

<para>
  Determines the width, in pixels, of the specified string using the list-view's current font.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single arguments is:
    <variablelist>
      <varlistentry><term>text</term>
      <listitem>
      <para>
        The text whose width is desired.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the exact width of the text in pixels, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">stringWidthPx</emphasis> method returns the exact width, in pixels, of the specified
    string. If the returned width is used as the column width in the <link
    linkend="mthSetColumnWidthPX">setColumnWidthPX</link> method, the string will be truncated. To get the column width
    that can contain the string without truncating it, the programmer must add padding to the returned width.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::stringWidthPX() -->


<section id="stringwidth"><title>stringWidth</title>
<indexterm><primary>stringWidth</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~stringWidth(--text--)--------------------------><


]]>
</programlisting>

<para>The stringWidth method determines the width of
a specified string using the current font of the list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text string of which the width is to be determined.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The string width, or -1 if you did not specify a <emphasis role="italic">text</emphasis>,
or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthInsertClsListControl"><title>insert</title>
<indexterm><primary>insert</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insert(--+------+--,--+---------+--,--text--+--------+--)------------------><
             +-item-+     +-subitem-+           +-,-icon-+

]]>
</programlisting>

<para>
  The <computeroutput>insert</computeroutput> method inserts a new item into the list-view control, or
  inserts the text of a subitem.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem>
<para>
  The index of the item to insert or the item whose subitem text is inserted.
</para>
<para>
  When this argument is omitted <emphasis role="bold">and</emphasis> <emphasis
  role="italic">subitem</emphasis> is omitted or 0, ooDialog uses the index of the last item added to the
  list-view control, plus 1, as the item index. If the argument is omitted and <emphasis
  role="italic">subitem</emphasis> is greater than 0, then the index of the last item added is used. If
  no items have yet been added, then 0 is used.
</para>
</listitem></varlistentry>
<varlistentry><term>subitem</term>
<listitem>
<para>
  The subitem number. This argument is used to insert the text for a subitem of the item. In report view,
  the label (text) for the item is placed in column 0. The text for subitem 1 is placed in column 1, the
  text for subitem 2 is placed in column 2, and so on. If you omit this argument, or use 0, the the
  <emphasis role="italic">text</emphasis> argument is assigned as the label (text) of the item. If you
  use this argument and it is greater than 0, then the <emphasis role="italic">text</emphasis> argument
  is assigned as the text of that subitem. <emphasis role="bold">Note</emphasis> that when this argument
  is greater than 0, no new item is inserted into the list-view. Rather, the text of the subitem is
  inserted into an existing list-view item.
</para>
</listitem></varlistentry>
<varlistentry><term>text</term>
<listitem>
  <para>
    The text of the item, or of the subitem, depending on the <emphasis role="italic">subitem</emphasis>
    argument.
</para>
</listitem></varlistentry>
<varlistentry><term>icon</term>
<listitem>
<para>
  The index of the icon within the image list for this item. Use the <link
  linkend="mthSetImageListClsListView">setImageList</link>() method to assign an image list to the
  list-view control. With <computeroutput>setImageList</computeroutput>(), use the LVSIL_SMALL type to
  set the image list for the small icons and the LVSIL_NORMAL type for the normal size icon image list.
</para>
<para>
  The normal size icons are used for the icon view and the small icons are used for the list, report, and
  small-icon views. Note that there is only one index for each list-view item. This implies that the
  normal icon for an item must be at the same index in the normal image list as the small icon is at in
  the small icon image list.
</para>
<para>
  Use -1 or simply omit this argument to indicate there is no icon for the item being inserted. This
  argument is ignored completely if <emphasis role="italic">subitem</emphasis> is greater than 0.
</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The index of the new item, or -1 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example inserts items in a list:
<programlisting>
<![CDATA[
::method initReport
  curList = self~newListView(102)
  if curList \= .nil then
  do
    curList~insert(, ,"First")
    curList~insert(, ,"Second")
    curList~insert(, ,"Third")
  end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthModify"><title>modify</title>
<indexterm><primary>modify</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modify(--+------+--,--+---------+--,--text--+--------+--)------------------><
             +-item-+     +-subitem-+           +-,-icon-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">modify</emphasis> method modifies or sets the text for the item label, or
  the text for a subitem, for a list-view item. Optionally, it sets or modifies the icon index for a
  list-view item.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>
  The index of the item to be modified. If you omit this argument, the selected item is used.
</para></listitem></varlistentry>
<varlistentry><term>subitem</term>
<listitem><para>
  This method works in a similar manner as the <link linkend="mthInsertClsListControl">insert</link>()
  method. The use of the <emphasis role="italic">subitem</emphasis> argument controls whether the
  <emphasis role="italic">text</emphasis> argument applies to the label of the item or the text of a
  subitem. When <emphasis role="italic">subitem</emphasis> is omitted or 0, then the label of the item is
  set to <emphasis role="italic">text</emphasis>. When <emphasis role="italic">subitem</emphasis> is
  greater than 0, then the text of that subitem is set to <emphasis role="italic">text</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>
  The new text for the item label, or the new text for the subitem of the item, depending on the value of
  <emphasis role="italic">subitem</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>icon</term>
<listitem><para>
  The new index of the icon for the item within the image list assigned to the list-view. Image lists are
  assigned with the <link linkend="mthSetImageListClsListView">setImageList</link>() method. When
  assigning the image list with <computeroutput>setImageList</computeroutput>(), use the LVSIL_NORMAL
  flag for the icon view icons and the LVSIL_SMALL flag for the list, report, and small-icon view icons.
</para>
<para>
  Use -1 or simply omit this argument to leave the icon index unchanged. If <emphasis
  role="italic">subitem</emphasis> is greater than 0, this argument is ignored.
</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The modification was successful.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>
  The following example modifies the icon for an item when it is activated. A method,
  <computeroutput>onActivate</computeroutput>, is connected to the ACTIVATE notification. When an item is
  activated it also gains the focus. The <computeroutput>onActivate</computeroutput>() method is invoked
  when an item is activated, and the example determines which item was activated by seeing which item has
  the focus.
<programlisting>
<![CDATA[

::method initDialog
  expose list

  list  = self~newListView(IDC_LV_VIEWS)
  self~connectListViewEvent(IDC_LV_VIEWS, 'ACTIVATE', 'onActivate')

  ...

::method onActivate
  expose list

  focusedItem = list~focused
  text = list~itemText(focusedItem)

  list~modify(focusedItem, , text, 2)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetItemInfo"><title>getItemInfo</title>
<indexterm><primary>getItemInfo</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getItemInfo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemInfo(--index--,--directory--+------------+--)--------><
                                       +-,-subItem--+
]]>
</programlisting>

<para>
  Returns the attributes of an item, or one of its subitems, in a <computeroutput>Directory</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index</term>
      <listitem>
      <para>
        The zero-based index of the item whose information is to be retrieved. If the <emphasis
        role="italic">subItem</emphasis> argument is specified, then the information for the subitem of this item is
        returned.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>directory [required]</term>
      <listitem>
      <para>
        A <computeroutput>Directory</computeroutput> object whose indexes will be filled with the returned item
        information. On success, the <computeroutput>Directory</computeroutput> object will have the following
        indexes with the corresponding information:
        <variablelist>
          <varlistentry><term><emphasis role="bold">text</emphasis></term>
          <listitem>
          <para>
            The text of the item, or subitem.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">image</emphasis></term>
          <listitem>
          <para>
            The index in the image list for the icon, (both big and small,) for the item. If the item does not have an
            icon in image list, the value will be -1.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">state</emphasis></term>
          <listitem>
          <para>
            Zero or more blank separated keywords indicating the state of the item. The possible state keywords are:
            <variablelist>
              <varlistentry><term><emphasis role="bold">CUT</emphasis></term>
              <listitem>
              <para>
                The item is marked for a cut-and-paste operation.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">DROP</emphasis></term>
              <listitem>
              <para>
                The item is highlighted as a drag-and-drop target.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">FOCUSED</emphasis></term>
              <listitem>
              <para>
                The item has the focus, so it is surrounded by a standard focus rectangle. Although more than one item
                may be selected, only one item can have the focus.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">SELECTED</emphasis></term>
              <listitem>
              <para>
                The item is selected. The appearance of a selected item depends on whether it has the focus and also on
                the system colors used for selection.
              </para>
              </listitem></varlistentry>
            </variablelist>
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>subitem [optional]</term>
      <listitem>
      <para>
        The one-based index of a subitem. If <emphasis role="italic">subitem</emphasis> is omitted, or zero, the
        information for the item with the <emphasis role="italic">index</emphasis> specified is retrieved. If a subitem
        index is specified, the information for the item's specified subitem is retrieved instead.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success and <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example displays information on a selected item in the list-view:
<programlisting>
<![CDATA[

::method displayItemInfo

  listView = self~newListView(IDC_LV_JOBS_PER_STATE)

  title = "Selected Item Information"
  buttons = "ok"
  icon = "information"

  item = listView~selected
  if item == -1 then do
    msg = "No item is selected."
    buttons = "cancelTryContinue"
  end
  else do
    d = .Directory~new
    if listView~getItemInfo(item, d) then do
      msg = "Item Text  : "d~text   || .endOfLine || -
            "Image Index: "d~image  || .endOfLine || -
            "Item State : "d~state
    end
    else do
      msg = "Windows API error. No information available."
      buttons = "abortRetryIgnore"
      icon = "error"
    end
  end

  return MessageDialog(msg, self~hwnd, title, buttons, icon)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getItemInfo() -->

<section id="iteminfo"><title>itemInfo</title>
<indexterm><primary>itemInfo</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[

>>--itemInfo(--item--,--+--------+--)------------><
                        +-column-+


]]>
</programlisting>

<para>
  The itemInfo method retrieves the attributes of a list-view item as a <computeroutput>Stem</computeroutput> object.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>column</term>
<listitem><para>The number of the column. If you omit this argument, 0 is assumed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
  A compound variable that stores the attributes of the item, or -1 in all other cases. The compound
  variable can be:
<variablelist>
<varlistentry><term>RetStem.!TEXT</term>
<listitem><para>The item text.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!IMAGE</term>
<listitem><para>
  The index of the icon in the image list this for item. Image lists are assigned to list-views using the
  <link linkend="mthSetImageListClsListView">setImageList</link>() method.
</para>
<para>
  In report view, this index is only used for the icon for the first column. ooDialog does not yet
  support setting the icon index for the other columns in a report view.
</para>
</listitem></varlistentry>
<varlistentry><term>RetStem.!STATE</term>
<listitem><para>One or more of the following values:
<variablelist>
<varlistentry><term>CUT</term>
<listitem><para>The item is marked for a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>DROPPED</term>
<listitem><para>The item is highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>FOCUSED</term>
<listitem><para>The item has the focus and is therefore surrounded by the standard focus
rectangle. Only one item can have the focus.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected. Its appearance depends on whether it has the focus
and on the system colors used for a selection.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetItemText"><title>setItemText</title>
<indexterm><primary>setItemText</primary></indexterm>
<programlisting>
<![CDATA[
>>--setItemText(--item--,--+-----------+--,--text--)--><
                           +--subitem--+

]]>
</programlisting>

<para>
  The setItemText method changes the text of a label, or the text of a subitem, of a list-view item.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The index of the item.
</para></listitem></varlistentry>
<varlistentry><term>subitme</term>
<listitem><para>
  This method works in a similar manner as the <link linkend="mthInsertClsListControl">insert</link>()
  method. The use of the <emphasis role="italic">subitem</emphasis> argument controls whether the
  <emphasis role="italic">text</emphasis> argument applies to the label of the item or the text of a
  subitem. When <emphasis role="italic">subitem</emphasis> is omitted or 0, then the label of the item is
  set to <emphasis role="italic">text</emphasis>. When <emphasis role="italic">subitem</emphasis> is
  greater than 0, then the text of that subitem is set to <emphasis role="italic">text</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>
  The text for the item or a subitem, depending on the value of <emphasis
  role="italic">subitem</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The change was successful.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="setitemstate"><title>setItemState</title>
<indexterm><primary>setItemState</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~setItemState(--item--+------------------------------+--)-><
                                     |       +-----------------+    |
                                     |       V                 |    |
                                     +-,--"----+-CUT---------+-+--"-+
                                               +-NOTCUT------+
                                               +-DROP--------+
                                               +-NOTDROP-----+
                                               +-FOCUSED-----+
                                               +-NOTFOCUSED--+
                                               +-SELECTED----+
                                               +-NOTSELECTED-+


]]>
</programlisting>

<para>The setItemState method sets the state of a list
view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>state</term>
<listitem><para>The state of the item, which can be one or more of the following values,
separated by blanks:
<variablelist>
<varlistentry><term>CUT</term>
<listitem><para>The item is marked for a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>NOTCUT</term>
<listitem><para>The item cannot be used for a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>DROP</term>
<listitem><para>The item is highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>NOTDROP</term>
<listitem><para>The item is not highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>FOCUSED</term>
<listitem><para>The item has the focus and is therefore surrounded by the standard focus
rectangle. Only one item can have the focus.
</para></listitem></varlistentry>
<varlistentry><term>NOTFOCUSED</term>
<listitem><para>The item does not have the focus.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected. Its appearance depends on whether it has the focus
and on the system colors used for a selection.
</para></listitem></varlistentry>
<varlistentry><term>NOTSELECTED</term>
<listitem><para>The item is not selected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The state was set successfully.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="addlc"><title>add</title>
<indexterm><primary>add</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
          +-------+
          V       |
>>--add(----+-----+--text--+--------+--)-------><
            +--,--+        +-,-icon-+

]]>
</programlisting>

<para>
  The <emphasis role="italic">add</emphasis> method adds a new item to a list-view, or defines the text
  for a subitem. It can be used to fill a list-view sequentially.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<para>
  The number of commas preceding the <emphasis role="italic">text</emphasis> argument determines whether a
  new item is added to the list-view or the text for a subitem is being defined. When there is no comma
  preceding <emphasis role="italic">text</emphasis> then a new item is added to the list-view.
</para>
<para>
  When 1 or more commas precede <emphasis role="italic">text</emphasis>, then no item is added to the
  list-view. Rather, the text for a subitem is defined. When 1 comma precedes <emphasis
  role="italic">text</emphasis>, then the text for subitem 1 is being defined. When 2 commas precedes the
  <emphasis role="italic">text</emphasis> argument, then the text for subitem 2 is being defined, and so
  on.
</para>
<para>
  When an item is added, it is always added directly <emphasis role="italic">after</emphasis> the last
  item to be placed in the list-view. Or as item 0 if the list-view currently has no items. When the text
  of a subitem is being defined, then the text is defined for the subitem of last item placed in the
  list-view.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>,</term>
<listitem><para>
  As explained above, this argument determines if an item is added to the list-view, or if the text of a
  subitem is defined.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>
  The text for the item label, or the text for the subitem of a item, depending on whether an item is
  being added or the text for a subitem is being defined.
</para></listitem></varlistentry>
<varlistentry><term>icon</term>
<listitem><para>
  Specifies the index within the image list for the icon for this item. Image lists are assigned to a
  list-view by using the <link linkend="mthSetImageListClsListView">setImageList</link>() method. With
  the <computeroutput>setImageList</computeroutput>() method, use the LVSIL_NORMAL flag for the icon view
  icons and the LVSIL_SMALL flag for the list, report, and small-icon view icons.
</para>
<para>
  Use -1 or simply omit this arugment to indicate there is no icon for the item being added. This
  argument is ignored completely when the text for a subitem is being defined.
</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>
  The following example adds three columns and two items to a report list control. To get the following
  result:
</para>
<informaltable frame="all">
<tgroup cols="3">
<thead>
<row>
<entry>First Name</entry>
<entry>Last Name</entry>
<entry>Age</entry>
</row>
</thead>
<tbody>
<row>
<entry>Mike</entry>
<entry>Miller</entry>
<entry>30</entry>
</row>
<row>
<entry>Sue</entry>
<entry>Thaxtor</entry>
<entry>29</entry>
</row>
</tbody></tgroup>
</informaltable>
<para>
  using the <computeroutput>add</computeroutput>() method you must specify something similar to the
  following:
</para>
<programlisting>
<![CDATA[
::method initDialog

  curList = self~newListView(IDC_LIST_REP)
  if curList \= .nil then do
    imageList = .ImageList~create(.Size~new(16), .Image~toID(ILC_COLOR24), 9, 0)
    imageList~add(.Image~getImage("E:\oodlist\oodlist.BMP"))
    list~setImageList(imageList, .Image~toID(LVSIL_SMALL))

    curList~insertColumn(0,"First Name",50)
    curList~insertColumn(1,"Last Name",50)
    curList~insertColumn(2,"Age",50)

    -- 3 is the index in the image list for the icon for item 0
    curList~add("Mike", 3)
    curList~add(,"Miller")
    curList~add(, ,"30")

    -- 0 is the index in the image list for the icon for item 1
    curList~~add("Sue", 0)~~add(,"Thaxton")~~add(, ,"29")
  end

]]>
</programlisting>
</listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddRow"><title>addRow</title>
<indexterm><primary>addRow</primary></indexterm>
<programlisting>
<![CDATA[
                                   +-,----+
                                   V      |
>>--addRow(--+------+--,--icon--,----text-+--)-----><
             +-item-+

]]>
</programlisting>

<para>
  The <emphasis role="italic">addRow</emphasis> method adds a new item to a list-view. This method is
  most useful when adding items that have subitems to the list-view. But, despite its name, it can be
  used to add any item, with or without subitems, to a list-view.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>
  The index of the item. If you omit this argument, the item is added immediately after the last item
  added or inserted in the list-view. That is, the index defaults to the index of the last item added
  plus 1. If there are no items in the list-view then the item is added at index 0.
</para></listitem></varlistentry>
<varlistentry><term>icon</term>
<listitem><para>
  The index within the image list for the icon for this item. Image lists are assigned to a list-view by
  using the <link linkend="mthSetImageListClsListView">setImageList</link>() method. With the
  <computeroutput>setImageList</computeroutput>() method, use the LVSIL_NORMAL flag for the icon view
  icons and the LVSIL_SMALL flag for the list, report, and small-icon views icons.
</para>
</listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>
  Any number of text strings. The first text string is used for the label of the item. Successive strings
  are used for the text of subitems of the item. For example, the text of the second string is used for
  the text of subitem 1. The text of the third string is used for the text of subitem 2, and so on. If
  the first string is omitted, then the empty string is used for the item label. If other strings are
  omitted, than no text is set for the corresponding subitem. If you specify more text entries than there
  are columns, the extra entries are ignored.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The index of the new item, or -1 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example adds three items to a report list with two columns:
<programlisting>
<![CDATA[
::method InitList
  curList = self~newListView(101)
  curList~addRow(, ,"Mike","Miller")
  curList~addRow(, ,"Sue","Muller")
  curList~addRow(, ,"Chris","Watson")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="deletelc"><title>delete</title>
<indexterm><primary>delete</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~delete(--item--)-------------------------------><


]]>
</programlisting>

<para>The delete method removes an item from a list-view
control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was deleted.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example deletes the selected item in a list control:
<programlisting>
<![CDATA[
::method DeleteSelectedItem
  curList = self~newListView(102)
  curList~delete(curList~selected)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="deletealllc"><title>deleteAll</title>
<indexterm><primary>deleteAll</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~DeleteAll--------------------------------------><


]]>
</programlisting>

<para>The deleteAll method removes all items from a list
view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were deleted.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>No item was available.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="itemslc"><title>items</title>
<indexterm><primary>items</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Items------------------------------------------><


]]>
</programlisting>

<para>The items method retrieves the number of items
in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="last"><title>last</title>
<indexterm><primary>last</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Last-------------------------------------------><


]]>
</programlisting>

<para>The last method retrieves the number of the last
item in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the last item.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="prepare4nitems"><title>prepare4nItems</title>
<indexterm><primary>prepare4nItems</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~prepare4nItems(--items--)----------------------><


]]>
</programlisting>

<para>The prepare4nItems method prepares a list-view
control for adding a large number of items.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>items</term>
<listitem><para>The number of the items to be added later.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The list-view control was prepared.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">items</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="selecteditemslc"><title>selectedItems</title>
<indexterm><primary>selectedItems</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~SelectedItems----------------------------------><


]]>
</programlisting>

<para>The selectedItems method determines the number
of selected items in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of selected items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="itemtext"><title>itemText</title>
<indexterm><primary>itemText</primary></indexterm>
<programlisting>
<![CDATA[
                                    +-0------+
>>-aListControl~itemText(--item--,--+--------+--)--------------><
                                    +-column-+


]]>
</programlisting>

<para>The itemText method retrieves the text of a list
view item or a column.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>column</term>
<listitem><para>The number of the column. If you omit this argument, 0 is assumed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The item or column text, or -1 if you did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="itemstate"><title>itemState</title>
<indexterm><primary>itemState</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~itemState(--item--)----------------------------><


]]>
</programlisting>

<para>The itemState method retrieves the state of a list
view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The state of the item, which can be one or more of the following values:
<variablelist>
<varlistentry><term>CUT</term>
<listitem><para>The item can be used in a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>DROPPED</term>
<listitem><para>The item is highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>FOCUSED</term>
<listitem><para>The item has the focus and is therefore surrounded by the standard focus
rectangle. Only one item can have the focus.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected. Its appearance depends on whether it has the focus
and on the system colors used for a selection.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="selectlc"><title>select</title>
<indexterm><primary>select</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~select(--item--)-------------------------------><


]]>
</programlisting>

<para>The select method selects an item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was selected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="deselect"><title>deselect</title>
<indexterm><primary>deselect</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~deselect(--item--)-----------------------------><


]]>
</programlisting>

<para>The deselect method deselects an item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was selected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="selectedlc"><title>selected</title>
<indexterm><primary>selected</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Selected---------------------------------------><


]]>
</programlisting>

<para>The selected method returns the number of the selected
item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item selected last, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="lastselected"><title>lastSelected</title>
<indexterm><primary>lastSelected</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~LastSelected-----------------------------------><


]]>
</programlisting>

<para>The lastSelected method returns the number of the
item selected last.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item selected last, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="focused"><title>focused</title>
<indexterm><primary>focused</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Focused----------------------------------------><


]]>
</programlisting>

<para>The focused method retrieves the number of the
item that has currently the focus.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item with the focus, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="focus"><title>focus</title>
<indexterm><primary>focus</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~focus(--item--)--------------------------------><


]]>
</programlisting>

<para>The focus method assigns the focus to the specified
item, which is then surrounded by the standard focus rectangle. Although more
than one item can be selected, only one item can have the focus.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item to receive the focus.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The specified item received the focus.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="drophighlighted"><title>dropHighlighted</title>
<indexterm><primary>dropHighlighted</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~DropHighlighted--------------------------------><


]]>
</programlisting>

<para>The dropHighlighted method retrieves the item that
is highlighted as a drag-and-drop target.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the selected item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="firstvisible"><title>firstVisible</title>
<indexterm><primary>firstVisible</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~FirstVisible-----------------------------------><


]]>
</programlisting>

<para>The firstVisible method retrieves the number of
the first item visible in a list or report view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the first item visible, or 0 if the list-view control
is in icon or small-icon view.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="nextselected"><title>nextSelected</title>
<indexterm><primary>nextSelected</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~nextSelected(--item--)-------------------------><


]]>
</programlisting>

<para>The nextSelected method retrieves the selected
item that follows, or is to the right of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the selected item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="previousselected"><title>previousSelected</title>
<indexterm><primary>previousSelected</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~previousSelected(--item--)---------------------><


]]>
</programlisting>

<para>The previousSelected method retrieves the selected
item that precedes, or is to the left of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the selected item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="next"><title>next</title>
<indexterm><primary>next</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~next(--item--)---------------------------------><


]]>
</programlisting>

<para>The next method retrieves the item that follows,
or is to the right of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the following item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="previous"><title>previous</title>
<indexterm><primary>previous</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~previous(--item--)-----------------------------><


]]>
</programlisting>

<para>The previous method retrieves the item that precedes,
or is to the left of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the previous item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="nextleft"><title>nextLeft</title>
<indexterm><primary>nextLeft</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~nextLeft(--item--)-----------------------------><


]]>
</programlisting>

<para>The nextLeft method retrieves the item left to <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the next item to the left, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="nextright"><title>nextRight</title>
<indexterm><primary>nextRight</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~nextRight(--item--)----------------------------><


]]>
</programlisting>

<para>The nextRight method retrieves the item right to <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the next item to the right, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="smallspacing"><title>smallSpacing</title>
<indexterm><primary>smallSpacing</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~SmallSpacing-----------------------------------><


]]>
</programlisting>

<para>The smallSpacing method determines the spacing
between items in a small-icon list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The amount of spacing between the items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="spacing"><title>spacing</title>
<indexterm><primary>spacing</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Spacing----------------------------------------><


]]>
</programlisting>

<para>The spacing method determines the spacing between
items in an icon list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The amount of spacing between the items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="redrawitems"><title>redrawItems</title>
<indexterm><primary>redrawItems</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~RedrawItems--+--------------------------+------><
                             +-(--first--+---------+--)-+
                                         +-,--last-+


]]>
</programlisting>

<para>The redrawItems method forces a list-view control
to redraw a range of items.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>first</term>
<listitem><para>The number of the first item to be redrawn. The default is 0.
</para></listitem></varlistentry>
<varlistentry><term>last</term>
<listitem><para>The number of the last item to be redrawn. The default is 0.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The specified range of items was redrawn.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="updateitem"><title>updateItem</title>
<indexterm><primary>updateItem</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~updateItem(--item--)---------------------------><


]]>
</programlisting>

<para>The updateItem method updates a list-view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item to be updated.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was updated.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="ensurevisible"><title>ensureVisible</title>
<indexterm><primary>ensureVisible</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                         +-0-+
>>-aListControl~ensureVisible(--item--,--+---+--)--------------><
                                         +-1-+


]]>
</programlisting>

<para>The ensureVisible method ensures that a list-view
item is entirely or partially visible by scrolling the list-view control,
if necessary.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item visible.
</para></listitem></varlistentry>
<varlistentry><term>partial</term>
<listitem><para>Specifies whether the item must be entirely visible:
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The list-view control is not scrolled if the item is at least partially
visible.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The list-view control is scrolled if the item is only partially visible.
This is the default.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item is visible.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetImageListClsListView"><title>setImageList</title>
<indexterm><primary>setImageList</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setImageList(--src-+---------------+-+----------+-+----------+-)-----------><
                       +-,-typeOrWidth-+ +-,-height-+ +-,-ilType-+
]]>
</programlisting>

<para>
  Assigns, or removes, an image list for the list-view control. Using
  <computeroutput>.nil</computeroutput> for the first argument removes the current image list.
</para>
<para>
  The list-view control uses image lists for a number of things, the large icons, the small icons, the
  state images, and the group header images. (ooDialog does not yet support list-view groups.) The
  <emphasis role="italic">src</emphasis> argument can be either an <link
  linkend="clsImageList">ImageList</link> object, or a single bitmap.
</para>
<para>
  Using an image list object is the most flexible option. The programmer creates the image list in the
  manner most suitable to the program. When the program is enhanced or changed it is easy to change the
  image list.
</para>
<para>
  When <emphasis role="italic">src</emphasis> is a single bitmap it is used in this way: A single bitmap
  is created that consists of all the images for the image list. All the images must be the same width
  and height. The images are arranged in the bitmap in a row, side-by-side, in the order they should
  appear in the image list. ooDialog uses this bitmap to create a <emphasis
  role="italic">.ImageList</emphasis> object and assigns it to the list-view. The <emphasis
  role="italic">src</emphasis> argument can be either the file name of the bitmap or a bitmap <link
  linkend="clsImage">Image</link> object.
</para>
<para>
  Although using a single bitmap will allow the programmer to save a couple of lines of code, it has a
  number of disadvantages. The image list is created with the exact number of images in the bitmap and no
  extra room to add images. The image list is created as an unmasked image list, with a color of 8 bit
  per pixel. If the program is enhanced or changed in a way that requires even a slight change
  to the image list, the single bitmap would need to be re-created.
</para>
<para>
  When using a single bitmap, if the system fails to create the image list from the details supplied by
  ooDialog, the method of informing the programmer of the error is not as robust as it is when the
  programmer creates the image list herself. However, ooDialog will set the <link
  linkend="dotSystemErrorCode">.SystemErrorCode</link> variable for any cases where the operating system
  reports an error. Also note that when using a single bitmap, ooDialog will instantiate a <emphasis
  role="italic">.ImageList</emphasis> object. The programmer can retrieve this object using the <link
  linkend="mthGetImageListClsListControl">getImageList</link>() method and then manipulate it using the
  methods of the <link linkend="clsImageList">ImageList</link> class.
</para>
<para>
  Unless a list-view has the LVS_SHAREIMAGELISTS style, (corresponds to the SHAREIMAGES style in the
  <link linkend="mthCreateListView">addListControl</link>() method,) the list-view control will handle
  releasing the image list(s). When the share image lists style is used, ownership of the image list
  remains with the programmer. The <link linkend="clsImageList">ImageList</link> and <link
  linkend="clsImage">Image</link> classes are used to manage image lists and images in ooDialog. The
  documentation on both classes discusses when and why the programmer may want to release image lists.
  The Image class documentation has the most detail on this subject.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
    </para>
    <para>
      Raises syntax errors when incorrect arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The arguments are:
    <variablelist>
      <varlistentry><term>src</term>
      <listitem>
        <para>
          The source for the image list. The most flexible way to use this method is to provide an <link
          linkend="clsImageList">image list</link> object to assign to the list-view.
        </para>
        <para>
          However, as explained above, this argument can also be a single bitmap from which the image
          list is to be created. In this case, the argument can be either the file name of the bitmap or
          a bitmap <link linkend="clsImage">Image</link> object.
        </para>
        <para>
          If this argument is <computeroutput>.nil</computeroutput> the existing image list, if any, is
          removed.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>typeOrWidth</term>
      <listitem>
        <para>
          Optional.
        </para>
        <para>
          <emphasis role="bold">type</emphasis>: When <emphasis role="italic">src</emphasis> is an
          <computeroutput>ImageList</computeroutput> object, this argument specifies which image list to
          assign, (or remove.) You can use <link linkend="mthToIDClsImage">.Image~toID()</link> to get the
          correct numeric value for one of the following symbols:
          <simplelist type='horiz' columns='2'>
          <member>LVSIL_NORMAL</member>
          <member>LVSIL_SMALL </member>
          <member>LVSIL_STATE </member>
          </simplelist>
          or use the correct numeric value itself.  Note that there is also a LVSIL_GROUPHEADER symbol,
          but ooDialog does not yet support it. The default is LVSIL_NORMAL.
        </para>
        <para>
          <emphasis role="bold">width</emphasis>: When <emphasis role="italic">src</emphasis> is a
          single bitmap, this argument can be used to specify the width of a single image in the bitmap.
          The default is the actual height of the bitmap.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>height</term>
      <listitem>
        <para>
          Optional. This argument is only used when <emphasis role="italic">src</emphasis> is a single
          bitmap. In that case <emphasis role="italic">height</emphasis> specifies the height of an image
          in the bitmap. The default is to use the actual height of the bitmap.
        </para>
      </listitem></varlistentry>
      <varlistentry><term>ilType</term>
      <listitem>
        <para>
          Optional. This argument is only used when <emphasis role="italic">src</emphasis> is a single
          bitmap. It is used to specify which image list is being assigned. Its usage is exactly the same
          as is documented for the <emphasis role="italic">type</emphasis> role of the <emphasis
          role="italic">typeOrWidth</emphasis> argument above. If omitted, the default is LVSIL_NORMAL.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The existing image list is returned, if there is one. Otherwise,
      <computeroutput>.nil</computeroutput> is returned.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This is a complete working example. It creates an image list using the application icons that
      ooDialog makes available for general use. The image list is assigned as the normal icon image list.
<programlisting>
<![CDATA[

  dlg = .ImageDisplay~new
  if dlg~initCode = 0 then do
    dlg~constDir[IDC_LV_IMAGES] = 100
    dlg~create(30, 30, 320, 155, "ooDialog Icon Resources", , , "Tahoma")
    dlg~execute("SHOWTOP", IDI_DLG_OOREXX)
  end

::requires "OODWIN32.CLS"

::class 'ImageDisplay' subclass UserDialog inherit AdvancedControls

::method defineDialog

  self~addListControl(IDC_LV_IMAGES, , 10, 10, 300, 135, "ICON SINGLESEL");

::method initDialog

  names = .array~new()
  names[1] = "IDI_DLG_OODIALOG"
  names[2] = "IDI_DLG_APPICON"
  names[3] = "IDI_DLG_APPICON2"
  names[4] = "IDI_DLG_OOREXX"

  ids = .array~new()
  ids[1] = self~constDir[IDI_DLG_OODIALOG]
  ids[2] = self~constDir[IDI_DLG_APPICON]
  ids[3] = self~constDir[IDI_DLG_APPICON2]
  ids[4] = self~constDir[IDI_DLG_OOREXX]

  SM_CXICON = 11
  SM_CYICON = 12

  size = .Size~new(.DlgUtil~getSystemMetrics(SM_CXICON), .DlgUtil~getSystemMetrics(SM_CYICON))

  oodModule = .ResourceImage~new("oodialog.dll", self)
  icons = oodModule~getImages(ids, .Image~toID(IMAGE_ICON), size)

  flags = .DlgUtil~or(.Image~toID(ILC_COLOR24), .Image~toID(ILC_MASK))
  imageList = .ImageList~create(size, flags, 4, 0)
  imageList~addImages(icons)

  list = self~newListView(IDC_LV_IMAGES)
  list~setImageList(imageList, .Image~toID(LVSIL_NORMAL))

  do i = 1 to ids~items
    list~add(names[i] '('ids[i]')', i - 1)
  end
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::setImageList() -->

<section id="mthGetImageListClsListControl"><title>getImageList</title>
<indexterm><primary>getImageList</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getImageList(--+--------+--)------------------------------------><
                   +--type--+
]]>
</programlisting>

<para>
  Retrieves the current image list for the type specified. The default is to retrieve the image list for
  the normal icons. See the <link linkend="mthSetImageListClsListView"></link>() method for infomation
  on assigning an image list to a list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>The single optional argument is:
    <variablelist>
      <varlistentry><term>type</term>
      <listitem>
        <para>
          Optional. Specifies which image list to retrieve. You can use <link
          linkend="mthToIDClsImage">.Image~toID()</link> to get the correct numeric value for one of the
          following symbols:
          <simplelist type='horiz' columns='2'>
          <member>LVSIL_NORMAL</member>
          <member>LVSIL_SMALL </member>
          <member>LVSIL_STATE </member>
          </simplelist>
          or use the correct numeric value itself. Note that there is also a LVSIL_GROUPHEADER symbol,
          but ooDialog does not yet support it.
        </para>
        <para>
          The default is LVSIL_NORMAL.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns the current <link linkend="clsImageList">image list</link>, if there is one.
      <computeroutput>.nil</computeroutput> is returned if there is no current image list of the type
      specified.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      Raises syntax errors when incorrect arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example comes from a complex application that opens and closes a large number of dialogs and
      uses many list-view controls. All the list-view controls share the same image lists. When the last
      dialog is closed, the shared image lists are released to free up system resources as the
      application enters its next phase.
<programlisting>
<![CDATA[
::method ok
  self~checkImageLists
  return self~ok:super

::method cancel
  self~checkImageLists
  return self~cancel:super

::method checkImageLists
  expose list

  if self~amLastDialog then do
    types = .array~of(LVSIL_NORMAL, LVSIL_SMALL, LVSIL_STATE)

    do type over types
      il = list~getImageList(type)
      if il \== .nil then il~release
    end
  end

]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::getImageList() -->

<section id="findlc"><title>find</title>
<indexterm><primary>find</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                +- -1--+     +-0-+
>>-aListControl~find(--text--,--+------+--,--+---+--)----------><
                                +-item-+     +-1-+


]]>
</programlisting>

<para>The find method searches for a list-view item containing <emphasis role="italic">text</emphasis>. The text of this item must exactly match <emphasis role="italic">text</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text of the item to be searched for.
</para></listitem></varlistentry>
<varlistentry><term>item</term>
<listitem><para>Specify the number of the item at which the search is to be started.
Specify -1 or omit this argument to start the search at the beginning.
</para></listitem></varlistentry>
<varlistentry><term>wrap</term>
<listitem><para>Specify 1 if the search is to be continued at the beginning if no match
is found. Specify 0 or omit this argument if the search is to stop at the
end of the list.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="findpartial"><title>findPartial</title>
<indexterm><primary>findPartial</primary></indexterm>
<programlisting>
<![CDATA[
                                       +- -1--+     +-0-+
>>-aListControl~findPartial(--text--,--+------+--,--+---+--)---><
                                       +-item-+     +-1-+


]]>
</programlisting>

<para>The findPartial method searches for a list-view
item containing <emphasis role="italic">text</emphasis>. An item matches if its text begins with <emphasis role="italic">text</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text of the item to be searched for.
</para></listitem></varlistentry>
<varlistentry><term>item</term>
<listitem><para>Specify the number of the item at which the search is to be started.
Specify -1 or omit this argument to start the search at the beginning.
</para></listitem></varlistentry>
<varlistentry><term>wrap</term>
<listitem><para>Specify 1 if the search is to be continued at the beginning if no match
is found. Specify 0 or omit this argument if the search is to stop at the
end of the list.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="findnearestxy"><title>findNearestXY</title>
<indexterm><primary>findNearestXY</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~findNearestXY(--x--,--y--+--------------------+--)-><
                                         |       +-DOWN--+    |
                                         +-,--"--+-UP----+--"-+
                                                 +-LEFT--+
                                                 +-RIGHT-+


]]>
</programlisting>

<para>The findNearestXY method searches, in the specified
direction, for the item nearest to the specified position.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>x</term>
<listitem><para>The x-coordinate of the position at which the search is to be started.
</para></listitem></varlistentry>
<varlistentry><term>y</term>
<listitem><para>The y-coordinate of the position at which the search is to be started.
</para></listitem></varlistentry>
<varlistentry><term>direction</term>
<listitem><para>The direction in which the search should proceed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The index of the item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="arrange"><title>arrange</title>
<indexterm><primary>arrange</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Arrange----------------------------------------><


]]>
</programlisting>

<para>The arrange method aligns items according to the
current alignment style of the list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were aligned.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="snaptogrid"><title>snapToGrid</title>
<indexterm><primary>snapToGrid</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~SnapToGrid-------------------------------------><


]]>
</programlisting>

<para>The snapToGrid method snaps all icons to the nearest
grid position.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were snapped.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="alignleft"><title>alignLeft</title>
<indexterm><primary>alignLeft</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~AlignLeft--------------------------------------><


]]>
</programlisting>

<para>The alignLeft method aligns items along the left
window border.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were aligned.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="aligntop"><title>alignTop</title>
<indexterm><primary>alignTop</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~AlignTop---------------------------------------><


]]>
</programlisting>

<para>The alignTop method aligns items along the upper
window border.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were aligned.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetItemPos"><title>getItemPos</title>
<indexterm><primary>getItemPos</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getItemPos</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemPos(--index--)-------------------------><

]]>
</programlisting>

<para>
  Retrieves the <link linkend="defClientArea">client</link> area coordinates of an item in a list-view control as a
  <computeroutput>Point</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single arguments is:
    <variablelist>
      <varlistentry><term>index</term>
      <listitem>
      <para>
        The zero-based index of the item whose postition is needed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns a <link linkend="clsPoint">point</link> object containing the position of the upper left corner
    of the item specified, relative to the client area of the list-view.
  </para>
  <para>
    On error, 0 is returned. See the remarks
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Since quite often list-view controls contain more items than can fit in the client area of the list-view, the
    position returned by <emphasis role="italic">getItemPos</emphasis> may be outside of the client area rectangle. This
    implies that both the x and y coordinates in the returned postion may be negative. For instance, take a list-view
    that has 400 items and more columns than fit in the list-view. If the user has scrolled the list-view all the way
    to the bottom right and <emphasis role="italic">getItemPos</emphasis> is used to get the position of item 5, both
    the x and y position will be negative.
  </para>
  <para>
    Experimentation has shown that if the <emphasis role="italic">index</emphasis> specified is larger than the actual
    number items in the list-view, the list-view still returns a position. The position seems to be correct for the
    <emphasis role="italic">index</emphasis>, if the list-view did have that item. Because of this, it seems unlikely
    this method will ever fail.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getItemPos() -->


<section id="itempos"><title>itemPos</title>
<indexterm><primary>itemPos</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~itemPos(--item--)------------------------------><


]]>
</programlisting>

<para>The itemPos method retrieves the position of the
upper left corner of the item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The x- and y-coordinates of the upper left corner of the item, or -1
if you did not specify <emphasis role="italic">item</emphasis>, or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Use <link linkend="mthDefListDragHandler">defListDragHandler</link> to support default dragging:
</para></note>
<programlisting>
<![CDATA[
self~connectListViewEvent(104,"BEGINDRAG","mthDefListDragHandler")
]]>
</programlisting>
</section>

<section id="setitempos"><title>setItemPos</title>
<indexterm><primary>setItemPos</primary></indexterm>
<programlisting>
<![CDATA[
                                      +-0-+     +-0-+
>>-aListControl~setItemPos(--item--,--+---+--,--+---+--)-------><
                                      +-x-+     +-y-+


]]>
</programlisting>

<para>The setItemPos method moves an item to a specified
position in a list-view control, which must be in icon or small-icon view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>x</term>
<listitem><para>The x-coordinate of the new position of the upper left corner of the
item, in view coordinates. The default is 0.
</para></listitem></varlistentry>
<varlistentry><term>y</term>
<listitem><para>The y-coordinate of the new position of the upper left corner of the
item, in view coordinates. The default is 0.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was moved.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Use <link linkend="mthDefListDragHandler">defListDragHandler</link> to support default dragging:
</para></note>
<programlisting>
<![CDATA[
self~connectListViewEvent(104,"BEGINDRAG","mthDefListDragHandler")
]]>
</programlisting>
</section>

<section id="edit"><title>edit</title>
<indexterm><primary>edit</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~edit(--item--)---------------------------------><


]]>
</programlisting>

<para>The edit method begins editing of the text of the
specified list-view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle of the edit control used to edit the item text, or 0 in all
other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="endedit"><title>endEdit</title>
<indexterm><primary>endEdit</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~EndEdit----------------------------------------><


]]>
</programlisting>

<para>The endEdit method cancels editing of the list
view item that is being edited.</para>
</section>

<section id="subclassedit"><title>subclassEdit</title>
<indexterm><primary>subclassEdit</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~SubclassEdit-----------------------------------><


]]>
</programlisting>

<para>The subclassEdit method is used by the DefListEditHandler
to correct an operating system problem if the Esc or Enter key was pressed
in an active edit control.</para>
</section>

<section id="restoreeditclass"><title>restoreEditClass</title>
<indexterm><primary>restoreEditClass</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~RestoreEditClass-------------------------------><


]]>
</programlisting>

<para>The restoreEditClass method is used by the DefListEditHandler
to correct an operating system problem if the Esc or Enter key was pressed
in an active edit item.</para>
</section>

<section id="itemsperpage"><title>itemsPerPage</title>
<indexterm><primary>itemsPerPage</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~ItemsPerPage-----------------------------------><


]]>
</programlisting>

<para>The itemsPerPage method calculates the number of
items that vertically fit the visible area of a list-view control that is
in list or report view. Only fully visible items are counted.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of fully visible items. If the current view is an icon or
small-icon view, the return value is the total number of items in the list
view control.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="scrolllc"><title>scroll</title>
<indexterm><primary>scroll</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                         +-0-+     +-0-+
>>-aListControl~scroll(--+---+--,--+---+--)--------------------><
                         +-x-+     +-y-+


]]>
</programlisting>

<para>The Scroll method scrolls the content of a list
view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>x</term>
<listitem><para>An integer value specifying the amount of horizontal scrolling. If the
control is in icon, small-icon, or report view, this value specifies the number
of pixels to be scrolled. If it is in list-view, this value specifies the
number of columns to be scrolled. The default value is 0.
</para></listitem></varlistentry>
<varlistentry><term>y</term>
<listitem><para>An integer value specifying the amount of vertical scrolling. If the
control is in icon, small-icon, or report view, this value specifies the number
of pixels to be scrolled. If it is in list-view, this value specifies the
number of lines to be scrolled. The default value is 0.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Scrolling was successful.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>Scrolling failed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="bkcolor"><title>bkColor</title>
<indexterm><primary>bkColor</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~BkColor----------------------------------------><


]]>
</programlisting>

<para>The bkColor method retrieves the background color
for a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The color-palette index specifier (0 to 18). For more information on
color palettes, refer to <link linkend="sctTermDefs">Definition of Terms</link>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="bkcolornew"><title>bkColor=</title>
<indexterm><primary>bkColor=</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~bkColor=(--color--)----------------------------><


]]>
</programlisting>

<para>The bkColor= method sets the background color of
a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>color</term>
<listitem><para>The new background color. Specify the color-palette index specifier
(0 to 18).  For more information on color palettes, refer to <link linkend="sctTermDefs">Definition of Terms</link>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets the background color of a list control to
yellow:
<programlisting>
<![CDATA[
::method Yellow
  curList = self~newListView(104)
  curList~bkColor = 15
  curList~update
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="textcolor"><title>textColor</title>
<indexterm><primary>textColor</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~TextColor--------------------------------------><


]]>
</programlisting>

<para>The textColor method retrieves the text color of
a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The color-palette index specifier (0 to 18). For more information on
color palettes, refer to <link linkend="sctTermDefs">Definition of Terms</link>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="textcolornew"><title>textColor=</title>
<indexterm><primary>textColor=</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~textColor=(--color--)--------------------------><


]]>
</programlisting>

<para>The textColor= method sets the text color of a
list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>color</term>
<listitem><para>The new text color. Specify the color-palette index specifier (0 to
18). For more information on color palettes, refer to <link linkend="sctTermDefs">Definition of Terms</link>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets the text color of a list control to light
blue:
<programlisting>
<![CDATA[
::method LightBlue
  curList = self~newListView(104)
  curList~bkColor = 9
  curList~update
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="textbkcolor"><title>textBkColor</title>
<indexterm><primary>textBkColor</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~TextBkColor------------------------------------><


]]>
</programlisting>

<para>The textBkColor method retrieves the background
color of the text in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The color-palette index specifier (0 to 18). For more information on
color palettes, refer to <link linkend="sctTermDefs">Definition of Terms</link>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="textbkcolornew"><title>textBkColor=</title>
<indexterm><primary>textBkColor=</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~textBkColor=(--color--)------------------------><


]]>
</programlisting>

<para>The textBkColor= method sets the background color
for the text in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>color</term>
<listitem><para>The new background color for text. Specify the color-palette index specifier
(0 to 18). For more information on color palettes, refer to <link linkend="sctTermDefs">Definition of Terms</link>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="notifmsg"><title>Notification Messages</title>
<indexterm><primary>modification messages</primary>
<secondary>ListView class</secondary></indexterm>
<para>The list-view control sends notification messages to its parent (the
dialog) when certain events happen. For more information on notification
messages, refer to <link linkend="mthConnectListViewEvent">connectListViewEvent</link>.
</para>
<para>The following example shows how to connect the list-view notification messages
with the corresponding message:</para>
<programlisting>
<![CDATA[
::method init
  use arg InitStem.
  if Arg(1,"o") = 1 then
     InitRet = self~Init:super
  else
     InitRet = self~Init:super(InitStem.)

  if self~load("list.rc", ) \= 0 then do
     self~InitCode = 1
    return
  end

  /* Connect dialog control items to class methods */
  self~connectListViewEvent("IDC_LIST","Changing","OnChanging_IDC_LIST")
  self~connectListViewEvent("IDC_LIST","Changed","OnChanged_IDC_LIST")
  self~connectListViewEvent("IDC_LIST","DefaultEdit")
  self~connectListViewEvent("IDC_LIST","Delete","OnDelete_IDC_LIST")
  self~connectListViewEvent("IDC_LIST","KeyDown","OnKeyDown_IDC_LIST")
  self~connectButtonEvent("IDC_PB_NEW", "CLICKED","IDC_PB_NEW")
  self~connectButtonEvent("IDC_PB_DELETE", "CLICKED","IDC_PB_DELETE")
  return InitRet
]]>
</programlisting>
</section>
</chapter>
