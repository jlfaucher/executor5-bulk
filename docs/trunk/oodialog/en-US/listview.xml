<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "https://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2005-2025, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # https://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter id="clsListView" xreflabel="ListView"><title>List View Controls</title>
<indexterm><primary>ListView class</primary></indexterm>
<para>
  A list-view control is a window that displays a collection of items, with each item consisting of an icon and a label.
  It provides several ways of arranging and displaying items. Refer to the <computeroutput>oodlist.rex</computeroutput>
  program in the <computeroutput>samples\oodialog</computeroutput> directory for an example.
</para>
<para>
  The <computeroutput>ListView</computeroutput> class is the ooDialog interface to the Windows <emphasis
  role="italic">List-View</emphasis> control.  This should not be confused with the Windows <emphasis role="italic">List
  Box</emphasis> control. The ooDialog <xref linkend="clsListBox"/> class provides the interface to the
  Windows List Box control.  In general, the List-View control is more powerful than the List Box control.
</para>
<variablelist>
  <varlistentry id="varListControlExtendedStyles"><term><emphasis role="bold">Extended Styles</emphasis></term>
  <listitem>
  <para>
    The List-View control has been updated by Microsoft to include a number of <emphasis role="italic">extended</emphasis>
    styles. These styles are similar to the styles that can be used to create a ListView, (see the <xref
    linkend="mthCreateListView"/> method,) like the <computeroutput>NOHEADER</computeroutput> or
    <computeroutput>SINGLESEL</computeroutput> styles.  However, the way that they are added or removed from the ListView is
    different.  For instance, the extended styles can not be added to a ListView at the time of creation.  They can only be
    added after the underlying Windows control has been created.  For all practical purposes this means in the <xref
    linkend="mthInitDialog"/> method, or at some point in the life cycle of the dialog after that.
  </para>
  <para>
    Some of the extended styles are only available on later versions of the Windows OS.  As an example, the
    <computeroutput>LABELTIP</computeroutput> and <computeroutput>SIMPLESELECT</computeroutput> styles are only available
    on Windows XP.  The documentation on the extended styles will note any requirements for each style.  To work with the
    extended List-View styles, use the <xref linkend="mthAddExtendedStyle"/>, the
   <xref linkend="mthRemoveExtendedStyle"/>, or the
   <xref linkend="mthReplaceExtendedStyle"/> methods.
  </para>
  <para>
    There are a number of nuances to the behavior of the different extended styles on the different versions of Windows,
    far too many to try and detail in this documentation.  The behavior documented here is the general behavior on Windows
    XP with service pack 2.
  </para>
  <para>
    If there is a need for detailed information concerning the subtle differences in behavior on earlier versions of
    Windows, the programmer should consult the Windows <xref linkend="defWindowsDoc"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
<para>
  In addition to the methods of the class itself, the following methods from other classes in the ooDialog framework are
  needed, or are useful, when working with list-view controls:
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Instantiation:</emphasis></term>
  <listitem>
  <para>
    Use the <xref linkend="mthNewListView"/> method of the dialog <xref linkend="chpDialogObject"/> to retrieve a list-view
    object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Dynamic Definition:</emphasis></term>
  <listitem>
  <para>
    To dynamically create a list-view in the dialog template of a <xref linkend="clsUserDialog"/> use the <xref
    linkend="mthCreateListView"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Notification</emphasis></term>
  <listitem>
  <para>
    To connect the <xref linkend="ovvEvents"/> notifications sent by the underlying list-view control to a method in the Rexx
    dialog object use the <xref linkend="mthConnectListViewEvent"/> method.
  </para>
  </listitem></varlistentry>
</variablelist>

<section id="sctViewStyles"><title>View Styles</title>
<indexterm><primary>view styles</primary></indexterm>
<para>
  List view controls can display their contents in different views. The current view is specified by the window style of the
  control. Additional window styles define the alignment of the items and the functionality of the list-view control. The
  different views are:
</para>
<variablelist>
  <varlistentry><term>Icon view</term>
  <listitem>
  <para>
    Each item appears as a full-sized icon with a label below it. The user can drag the items to any location in the list
    view.
  </para>
  </listitem></varlistentry>
  <varlistentry><term>Small-icon view</term>
  <listitem>
  <para>
    Each item appears as a small icon with a label to the left of it. The user can drag the items to any location.
  </para>
  </listitem></varlistentry>
  <varlistentry><term>List view</term>
  <listitem>
  <para>
    Each item appears as a small icon with a label to the left of it. The user cannot drag the items.
  </para>
  </listitem></varlistentry>
  <varlistentry><term>Report view</term>
  <listitem>
  <para>
    Each item appears on a separate line with information arranged in columns. The leftmost column contains the small icon
    and the label. All following columns contain subitems as specified by the application.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="sctMethodsListView"><title>Method Table</title>
<para>
  The following table provides links to the documentation for the primary methods and attributes used in working
  with list-view objects, including the pertinent methods from other classes:
</para>

<table id="tblListViewMethods" frame="all">
<title>ListView Instance Methods</title>
<tgroup cols="2">
<colspec colwidth="7*" />
<colspec colwidth="21*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Useful</emphasis></entry>
<entry align="center"><emphasis role="bold">External Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="tmthNewListView"/></entry>
<entry>Returns a <computeroutput>ListView</computeroutput> object for the control with the specified ID.</entry>
</row>
<row>
<entry><xref linkend="tmthCreateListView"/></entry>
<entry>Creates a list-view control in the dialog template of a <xref linkend="clsUserDialog"/>.</entry>
</row>
<row>
<entry><xref linkend="tmthConnectListViewEvent"/></entry>
<entry>Connects list-view event notifications to a method in the Rexx dialog object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">ListView</emphasis></entry>
<entry align="center"><emphasis role="bold">Helper Classes</emphasis></entry>
</row>
<row>
<entry><link linkend="clsLvFullRow">LvFullRow</link></entry>
<entry>The <computeroutput>LvFullRow</computeroutput> class represents a single item and its subitems in a list-view and contains the complete set of data pertaining to that item.</entry>
</row>
<row>
<entry><link linkend="clsLvItem">LvItem</link></entry>
<entry>The <computeroutput>LvItem</computeroutput> class represents a list-view item and the data for that item.</entry>
</row>
<row>
<entry><link linkend="clsLvSubItem">LvSubItem</link></entry>
<entry>The <computeroutput>LvSubItem</computeroutput> class represents a single subitem of a list-view item and the data for that subitem.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Constant Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Constant Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="sctListViewConstantMethods">Constant Methods</link></entry>
<entry>The <computeroutput>ListView</computeroutput> class provides several <emphasis role="italic">constant</emphasis> values through the <computeroutput>::constant</computeroutput>directive.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthAddClsListview"/></entry>
<entry>Adds a new item to this list-view or defines the text for a subitem.</entry>
</row>
<row>
<entry><xref linkend="mthAddExtendedStyle"/></entry>
<entry>Adds one or more of the extended list-view styles to this list-view control.</entry>
</row>
<row>
<entry><link linkend="mthAddFullRow">addFullRow</link></entry>
<entry>Adds a new item to this list-view at the end of the list using a <link linkend="clsLvFullRow">LvFullRow</link> object.</entry>
</row>
<row>
<entry><xref linkend="mthAddRow"/></entry>
<entry>Adds a new item to this list-view.</entry>
</row>
<row>
<entry><xref linkend="mthAddRowFromArray"/></entry>
<entry>Inserts an item into this list-view from an array of values.  The string value of each item in the array is used as the text for the item and subitem(s).</entry>
</row>
<row>
<entry><xref linkend="mthAddStyleClsListView"/></entry>
<entry>Adds new window styles to this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthAlignLeft"/></entry>
<entry>Aligns items along the left window border.</entry>
</row>
<row>
<entry><xref linkend="mthAlignTop"/></entry>
<entry>Aligns items along the upper window border.</entry>
</row>
<row>
<entry><xref linkend="mthArrange"/></entry>
<entry>Aligns items according to the current alignment style of the list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthBkColor"/></entry>
<entry>Retrieves the background color for this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthBkColorEquals"/></entry>
<entry>Sets the background color of this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthCheckClsListControl"/></entry>
<entry>Sets the check mark for a single list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthCheckAll"/></entry>
<entry>Sets the check mark for every list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthColumnInfo"/></entry>
<entry>Retrieves information for a column of this list-view control in a <computeroutput>Stem</computeroutput> object. <emphasis  role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthColumnWidth"/></entry>
<entry>Retrieves the width, in dialog units, of a column in this list-view when it is has the list or report view style. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthColumnWidthPX"/></entry>
<entry>Retrieves the width, in pixels, of a column in this list-view when it is has the list or report view style.</entry>
</row>
<row>
<entry><xref linkend="mthDeleteClsListView"/></entry>
<entry>Removes an item from this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthDeleteAllClsListview"/></entry>
<entry>Removes all times from this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthDeleteColumn"/></entry>
<entry>Removes a column from this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthDeselect"/></entry>
<entry>Deselects an item in this list-view.</entry>
</row>
<row>
<entry><xref linkend="mthDeselectAll"/></entry>
<entry>Deselects all items in this list-view.</entry>
</row>
<row>
<entry><xref linkend="mthDropHighLighted"/></entry>
<entry>Retrieves the item that is highlighted as a drag-and-drop target.</entry>
</row>
<row>
<entry><xref linkend="mthEdit"/></entry>
<entry>Begins the editing of the text of the specified list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthEndEdit"/></entry>
<entry>Cancels the editing of the list-view item being edited.</entry>
</row>
<row>
<entry><xref linkend="mthEnsureVisible"/></entry>
<entry>Ensures that a list-view item is entirely or partially visible by scrolling this list-view control, if necessary.</entry>
</row>
<row>
<entry><xref linkend="mthFindClsListView"/></entry>
<entry>Searches for a list-view item containing the specified text.</entry>
</row>
<row>
<entry><xref linkend="mthFindNearestXY"/></entry>
<entry>Searches, in the specified direction, for the item nearest to the specified position.</entry>
</row>
<row>
<entry><xref linkend="mthFindPartial"/></entry>
<entry>Searches for a list-view item beginning with the specified text.</entry>
</row>
<row>
<entry><xref linkend="mthFirstVisible"/></entry>
<entry>Retrieves the index of the topmost visible item when in this list-view is in list or report view.</entry>
</row>
<row>
<entry><xref linkend="mthFixFullRowColumns"/></entry>
<entry>A convenience method used to adjust the subitem columns in the <xref linkend="clsLvFullRow"/> objects used for <link linkend="sctInternalSorting">internal</link> sorting when a column has been deleted or inserted in this list-view.</entry>
</row>
<row>
<entry><xref linkend="mthFocus"/></entry>
<entry>Assigns the focus to the specified item,</entry>
</row>
<row>
<entry><xref linkend="mthFocused"/></entry>
<entry>Retrieves the index of the item that currently has the focus.</entry>
</row>
<row>
<entry><xref linkend="mthGetCheck"/></entry>
<entry>Determines if the item at the specified index has a checked, check box.</entry>
</row>
<row>
<entry><xref linkend="mthGetColumnInfo"/></entry>
<entry>Retrieves the attributes of this list-view column in a <computeroutput>Directory</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthGetColumnCount"/></entry>
<entry>Returns the number of columns in the list-view control when it has the report style.</entry>
</row>
<row>
<entry><xref linkend="mthGetColumnOrder"/></entry>
<entry>Retrieves the current column order of the list-view when it has the  report style.</entry>
</row>
<row>
<entry><xref linkend="mthGetColumnText"/></entry>
<entry>Retrieves the column header text for this list-view when it is in report view.</entry>
</row>
<row>
<entry><xref linkend="mthGetExtendedStyleClsListView"/></entry>
<entry>Returns the extended styles of this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthGetExtendedStyleRaw"/></entry>
<entry>Returns the extended styles of this list-view control as the numeric value of the extended style flags.</entry>
</row>
<row>
<entry><xref linkend="mthGetFullRow"/></entry>
<entry>Returns a <link linkend="clsLvFullRow">LvFullRow</link> object for the specified item in this list view.</entry>
</row>
<row>
<entry><xref linkend="mthGetHoverTime"/></entry>
<entry>Retrieves the current hover time in milliseconds.</entry>
</row>
<row>
<entry><xref linkend="mthGetImageListClsListView"/></entry>
<entry>Retrieves the current image list for the image list type specified.</entry>
</row>
<row>
<entry><xref linkend="mthGetItem"/></entry>
<entry>Returns some, or all, of the information this list-view maintains on the specified item. The information is returned as a <link linkend="clsLvItem">LvItem</link> object. The item is specified by either a <computeroutput>LvItem</computeroutput> object or by the item's index.</entry>
</row>
<row>
<entry><xref linkend="mthGetItemDataClsListView"/></entry>
<entry>Retrieves the item data associated with the specified list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthGetItemInfo"/></entry>
<entry>Retrieves the attributes of a list-view item in a <computeroutput>Directory</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthGetItemPos"/></entry>
<entry>Retrieves the client area coordinates of an item in this list-view control as a <computeroutput>Point</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthGetItemRect"/></entry>
<entry>Gets the bounding <xref linkend="ovvRectangleCoordinates"/> for all or part of an item in the current view.</entry>
</row>
<row>
<entry><xref linkend="mthGetSubitem"/></entry>
<entry>Receives some, or all, of the information of a subitem of a list-view item. The information is returned as a <link linkend="clsLvSubItem">LvSubItem</link> object.</entry>
</row>
<row>
<entry><xref linkend="mthGetSubitemRect"/></entry>
<entry>Gets the bounding <xref linkend="ovvRectangleCoordinates"/> for all or part of a subitem in the current view of this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthGetToolTipsClsListview"/></entry>
<entry>Retrieves the child <link linkend="clsToolTip">ToolTip</link> control used by this list-view.</entry>
</row>
<row>
<entry><xref linkend="mthGetView"/></entry>
<entry>Gets the current view of this list-view.</entry>
</row>
<row>
<entry><xref linkend="mthHasCheckBoxes"/></entry>
<entry>Determines if this list-view control has the CHECKBOXES extended list-view style.</entry>
</row>
<row>
<entry><xref linkend="mthHitTestInfoClsListView"/></entry>
<entry>Determines which list-view item, if any, is at the specified position.</entry>
</row>
<row>
<entry><xref linkend="mthInsertClsListControl"/></entry>
<entry>Inserts a new item into this list-view, or inserts a new subitem into in an existing list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthInsertColumn"/></entry>
<entry>Inserts a new column into this list-view control using dialog units for the width. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthInsertColumnPX"/></entry>
<entry>Inserts a new column into this list-view specifying the column width in pixels.</entry>
</row>
<row>
<entry><link linkend="mthInsertFullRow">insertFullRow</link></entry>
<entry>Adds a new item to this list-view at the position specified using a <link linkend="clsLvFullRow">LvFullRow</link> object.</entry>
</row>
<row>
<entry><xref linkend="mthIsCheckedClsListControl"/></entry>
<entry>Determines if a check box for this list-view item is checked or not.</entry>
</row>
<row>
<entry><xref linkend="mthItemInfo"/></entry>
<entry>Retrieves the attributes of this list-view item in a <computeroutput>Stem</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthItemPos"/></entry>
<entry>Retrieves the client area coordinates of an item in this list-view control as a <computeroutput>String</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthItemsClsListView"/></entry>
<entry>Retrieves the number of items in this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthItemState"/></entry>
<entry>Retrieves the state of this list-view item, focused, selected, etc.</entry>
</row>
<row>
<entry><xref linkend="mthItemText"/></entry>
<entry>Retrieves the text of this list-view item or subitem.</entry>
</row>
<row>
<entry><xref linkend="mthItemsPerPage"/></entry>
<entry>Calculates the number of items that vertically fit the visible area of this list-view control that has the report or list style.</entry>
</row>
<row>
<entry><xref linkend="mthLast"/></entry>
<entry>Retrieves the index of the last item in this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthLastSelected"/></entry>
<entry>Returns the index of the selected item with the highest index in this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthModify"/></entry>
<entry>Modifies the text or icon for an item, or the text for a subitem, for this list-view item</entry>
</row>
<row>
<entry><xref linkend="mthModifyColumn"/></entry>
<entry>Sets new attributes for a column of this list-view control when it has the report or list style. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthModifyColumnPX"/></entry>
<entry>Sets new attributes for a column of this list-view control when it has the report or list style.</entry>
</row>
<row>
<entry><xref linkend="mthModifyFullRow"/></entry>
<entry>Modifies the information for an item, and all its subitems, in a list-view using a <xref linkend="clsLvFullRow"/> object.</entry>
</row>
<row>
<entry><xref linkend="mthModifyItem"/></entry>
<entry>Modifies some or all of the data this list-view maintains for an item using a <xref linkend="clsLvItem"/> object.</entry>
</row>
<row>
<entry><xref linkend="mthModifySubitem"/></entry>
<entry>Modifies some or all of the data this list-view maintains for a subitem of an item using a <xref linkend="clsLvSubItem"/> object.</entry>
</row>
<row>
<entry><xref linkend="mthNext"/></entry>
<entry>Retrieves the item that follows, or is to the right of, the specified item.</entry>
</row>
<row>
<entry><xref linkend="mthNextLeft"/></entry>
<entry>Retrieves the item to the left of the specified item.</entry>
</row>
<row>
<entry><link linkend="mthNextRight">nextRight</link></entry>
<entry>Retrieves the item to the right of the specified item.</entry>
</row>
<row>
<entry><xref linkend="mthNextSelected"/></entry>
<entry>Retrieves the next selected item that follows, or is to the right of, the specified item.</entry>
</row>
<row>
<entry><xref linkend="mthPrepare4nItems"/></entry>
<entry>Informs the list-view control to prepare for the addition of a large number of items.</entry>
</row>
<row>
<entry><link linkend="mthPrependFullRow">prependFullRow</link></entry>
<entry>Adds an item to this list-view at the first position in the list using a <xref linkend="clsLvFullRow"/> object.</entry>
</row>
<row>
<entry><xref linkend="mthPrevious"/></entry>
<entry>Retrieves the index of the item that precedes, or is to the left of, the specified item.</entry>
</row>
<row>
<entry><xref linkend="mthPreviousSelected"/></entry>
<entry>Retrieves the first selected item that precedes, or is to the left of, the specified item.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawItems"/></entry>
<entry>Forces this list-view control to redraw a range of items.</entry>
</row>
<row>
<entry><xref linkend="mthRemoveItemDataClsListView"/></entry>
<entry>Removes and returns the item data associated with the specified list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthRemoveExtendedStyle"/></entry>
<entry>Removes one or more extended styles of this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthRemoveStyleClsListView"/></entry>
<entry>Removes one or more window styles of this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthReplaceExtendedStyle"/></entry>
<entry>Removes some or all of the list-view control's extended styles and adds new extended styles</entry>
</row>
<row>
<entry><xref linkend="mthReplaceStyleClsListView"/></entry>
<entry>Removes some of the window styles of this list-view control and sets new styles.</entry>
</row>
<row>
<entry><xref linkend="mthScrollClsListview"/></entry>
<entry>Scrolls the content of a list view control.</entry>
</row>
<row>
<entry><xref linkend="mthSelectClsListView"/></entry>
<entry>Selects an item.</entry>
</row>
<row>
<entry><xref linkend="mthSelectedClsListView"/></entry>
<entry>Returns the index of the first selected item.</entry>
</row>
<row>
<entry><xref linkend="mthSelectedItemsClsListView"/></entry>
<entry>Determines the count of selected items in this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthSetColumnOrder"/></entry>
<entry>Changes the column order of this list-view control to some other order.</entry>
</row>
<row>
<entry><xref linkend="mthSetColumnWidth"/></entry>
<entry>Sets the width, in dialog units, of a column in this list-view control that has the report or list style. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthSetColumnWidthPX"/></entry>
<entry>Sets the width, in pixels, of a column in this list-view control that has the report or list style.</entry>
</row>
<row>
<entry><xref linkend="mthSetFullRowText"/></entry>
<entry>Modifies all, or some, of the text for a list-view item and its subitems using a <xref linkend="clsLvFullRow"/> object.</entry>
</row>
<row>
<entry><xref linkend="mthSetHoverTime"/></entry>
<entry>Used to change the hover time.</entry>
</row>
<row>
<entry><xref linkend="mthSetImageListClsListView"/></entry>
<entry>Assigns, or removes, an image list for the list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthSetItemDataClsListView"/></entry>
<entry>Sets the item data associated for the specified list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthSetItemPos"/></entry>
<entry>Moves an item to a specified position in this list-view control that has the icon or small-icon style.</entry>
</row>
<row>
<entry><xref linkend="mthSetItemState"/></entry>
<entry>Sets the state of this list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthSetItemText"/></entry>
<entry>Changes the text of an item, or the text of a subitem, of this list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthSetView"/></entry>
<entry>Sets the view of this list-view.</entry>
</row>
<row>
<entry><xref linkend="mthSetToolTipsClsListView"/></entry>
<entry>Sets the child <link linkend="clsToolTip">ToolTip</link> control used by this tree-view.</entry>
</row>
<row>
<entry><xref linkend="mthSmalSpacing"/></entry>
<entry>Determines the spacing between items in this list-view control when it has the  small-icon style.</entry>
</row>
<row>
<entry><xref linkend="mthSnapToGrid"/></entry>
<entry>Snaps all icons to the nearest grid position.</entry>
</row>
<row>
<entry><xref linkend="mthSortItems"/></entry>
<entry>The <emphasis role="italic">sortItems</emphasis> method causes the list-view control to sort its items using the specified comparison method in the Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthSpacing"/></entry>
<entry>Determines the spacing between items in an icon list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthStringWidth"/></entry>
<entry>Determines the width, in dialog units, of a specified string using the current font of the list-view control. <emphasis role="bold">(Inaccurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthStringWidthPX"/></entry>
<entry>Determines the width, in pixels, of a specified string using the current font of the list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthTextBkColor"/></entry>
<entry>Retrieves the background color of the text in this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthTextBkColorEquals"/></entry>
<entry>Sets the background color for the text in this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthTextColor"/></entry>
<entry>Retrieves the text color of this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthTextColorEquals"/></entry>
<entry>Sets the text color of this list-view control.</entry>
</row>
<row>
<entry><xref linkend="mthUncheckClsListControl"/></entry>
<entry>Removes the check mark for the specified list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthUncheckAll"/></entry>
<entry>Clears the check mark for every list-view item.</entry>
</row>
<row>
<entry><xref linkend="mthUpdateItem"/></entry>
<entry>Updates this list-view item.</entry>
</row>
</tbody></tgroup>
</table>

</section>

<section id="sctListViewConstantMethods"><title>Constant Methods</title>
<indexterm><primary>constant methods</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>constant methods</secondary></indexterm>
<para>
  The <computeroutput>ListView</computeroutput> class provides the following <emphasis role="italic">constant</emphasis>
  values through the use of the <computeroutput>::constant</computeroutput> directive.
</para>
<table id="tblConstantsListview" frame="all"> <title>ListView Class Constant Reference</title>
<tgroup cols="2">
<colspec colwidth="5*" /><colspec colwidth="7*" />
<thead>
<row>
<entry>Constant Symbol</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry>GROUPIDCALLBACK</entry>
<entry>A group ID index value that indicates the list-view control should send the GETDISPINFO notification message to retrieve the item's group index.</entry>
</row>
<row>
<entry>GROUPIDNONE</entry>
<entry>A group ID value that indicates the list-view item does not belong to a group.</entry>
</row>
<row>
<entry>IMAGECALLBACK</entry>
<entry>An index value for the item's icon in the control's image list that indicates the list-view control should send the GETDISPINFO notification message to retrieve the item's icon index when it needs to display the image.</entry>
</row>
<row>
<entry>IMAGENONE</entry>
<entry>An index value for the item's icon in the control's image list that indicates the list-view item does not have an icon.</entry>
</row>
<row>
<entry>LVCFMT_FILL</entry>
<entry>A column format flag, fill the remainder of the tile area. Might have a title. Only valid in extended tile view. The LVCFMT_FILL flag forces the column to fill the remainder of the tile area. <emphasis role="bold">Requires Windows Vista or later</emphasis>.</entry>
</row>
<row>
<entry>LVCFMT_LINE_BREAK</entry>
<entry>A column format flag, move to the top of the next list of columns. Only valid in extend tile view, The LVCFMT_LINE_BREAK flag forces the column to wrap to the top of the next list of columns. <emphasis role="bold">Requires Windows Vista or later</emphasis>.</entry>
</row>
<row>
<entry>LVCFMT_NO_TITLE</entry>
<entry>A column format flag, this subitem does not have a title. Only valid in extended tile view. The LVCFMT_NO_TITLE flag indicates that the column should not display a title. <emphasis role="bold">Requires Windows Vista or later</emphasis>.</entry>
</row>
<row>
<entry>LVCFMT_TILE_PLACEMENTMASK</entry>
<entry>A column format flag, this is a combination of the LVCFMT_LINE_BREAK and LVCFMT_FILL constants. Only valid in extended tile view. <emphasis role="bold">Requires Windows Vista or later</emphasis>.</entry>
</row>
<row>
<entry>LVCFMT_WRAP</entry>
<entry>A column format flag, this subitem can be wrapped. Only valid in extended tile view. The LVCFMT_WRAP flag allows the column to wrap within the remaining space in its list of columns. <emphasis role="bold">Requires Windows Vista or later</emphasis>.</entry>
</row>
</tbody></tgroup>
</table>
</section>

<section id="tmthNewListView" xreflabel="newListview"><title>newListView (dialog object method)</title>
<para>
  List view objects can not be instantiated by the programmer from Rexx code. Rather a list-view object is obtained
  by using the <xref linkend="mthNewListView"/> method of the <xref linkend="chpDialogObject"/> object. The syntax is:
<programlisting>
<![CDATA[
>>--newListView(--id--)--------------------------><
]]>
</programlisting>
</para>
</section>  <!-- End newListView() [PlainBaseDialog method] -->


<section id="tmthCreateListView" xreflabel="createListView"><title>createListView (UserDialog method)</title>
<para>
  A list-view object can be created in the dialog template for a <xref linkend="clsUserDialog"/>
  dialog through the <xref linkend="mthCreateListView"/> method. The basic syntax is:
<programlisting>
<![CDATA[
>>--createListView(-id-,--x-,--y-,--cx-,--cy-+---------+--+------------+--)----><
                                             +-,-style-+  +-,-attrName-+
]]>
</programlisting>
</para>
</section>  <!-- End UserDialog::createListView() [UserDialog method] -->


<section id="tmthConnectListViewEvent" xreflabel="connectListViewEvent">
<title>connectListViewEvent (dialog object method)</title>
<para>
  To connect event notifications from a list-view object use the <xref linkend="mthConnectListViewEvent"/> method of the
  <xref linkend="chpDialogObject"/> object. The basic syntax is:

<programlisting> <![CDATA[
>>-connectListViewEvent(--id--,--event--+---------------+--)----><
                                        +-,--methodName-+
]]>
</programlisting>
</para>
</section>  <!-- End connectListViewEvent() [EventNotification method] -->

<section id="mthAddClsListview" xreflabel="add"><title>add</title>
<indexterm><primary>add</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>add</secondary></indexterm>
<programlisting>
<![CDATA[
          +-------+
          V       |
>>--add(----+-----+--text--+--------+--)---------><
            +--,--+        +-,-icon-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">add</emphasis> method adds a new item to a list-view, or defines the text
  for a subitem. It can be used to fill a list-view sequentially.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<para>
  The number of commas preceding the <emphasis role="italic">text</emphasis> argument determines whether a
  new item is added to the list-view or the text for a subitem is being defined. When there is no comma
  preceding <emphasis role="italic">text</emphasis> then a new item is added to the list-view.
</para>
<para>
  When 1 or more commas precede <emphasis role="italic">text</emphasis>, then no item is added to the
  list-view. Rather, the text for a subitem is defined. When 1 comma precedes <emphasis
  role="italic">text</emphasis>, then the text for subitem 1 is being defined. When 2 commas precedes the
  <emphasis role="italic">text</emphasis> argument, then the text for subitem 2 is being defined, and so
  on.
</para>
<para>
  When an item is added, it is always added directly <emphasis role="italic">after</emphasis> the last
  item to be placed in the list-view. Or as item 0 if the list-view currently has no items. When the text
  of a subitem is being defined, then the text is defined for the subitem of last item placed in the
  list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>, [optional]</term>
    <listitem>
    <para>
      As explained above, this argument determines if an item is added to the list-view, or if the text of a
      subitem is defined.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text for the item label, or the text for the subitem of a item, depending on whether an item is
      being added or the text for a subitem is being defined.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>icon [optional]</term>
    <listitem>
    <para>
      Specifies the index within the image list for the icon for this item. Image lists are assigned to a
      list-view by using the <xref linkend="mthSetImageListClsListView"/>() method. With
      the <computeroutput>setImageList</computeroutput>() method, use the LVSIL_NORMAL flag for the icon view
      icons and the LVSIL_SMALL flag for the list, report, and small-icon view icons.
    </para>
    <para>
      Use -1 or simply omit this argument to indicate there is no icon for the item being added. This
      argument is ignored completely when the text for a subitem is being defined.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem><para>
    The following example adds three columns and two items to a report list control. To get the following
    result:
  </para>
  <informaltable frame="all">
  <tgroup cols="3">
  <thead>
  <row>
  <entry>First Name</entry>
  <entry>Last Name</entry>
  <entry>Age</entry>
  </row>
  </thead>
  <tbody>
  <row>
  <entry>Mike</entry>
  <entry>Miller</entry>
  <entry>30</entry>
  </row>
  <row>
  <entry>Sue</entry>
  <entry>Thaxtor</entry>
  <entry>29</entry>
  </row>
  </tbody></tgroup>
  </informaltable>
  <para>
    using the <emphasis role="italic">add</emphasis> method you must specify something similar to the following:
  </para>
<programlisting>
<![CDATA[
::method initDialog

  list = self~newListView(IDC_LIST_REP)
  if list \= .nil then do
    imageList = .ImageList~create(.Size~new(16), COLOR24, 9, 0)
    imageList~add(.Image~getImage("E:\oodlist\oodlist.BMP"))
    list~setImageList(imageList, SMALL)

    list~insertColumn(0,"First Name",50)
    list~insertColumn(1,"Last Name",50)
    list~insertColumn(2,"Age",50)

    -- 3 is the index in the image list for the icon for item 0
    list~add("Mike", 3)
    list~add(,"Miller")
    list~add(, ,"30")

    -- 0 is the index in the image list for the icon for item 1
    list~~add("Sue", 0)~~add(,"Thaxtor")~~add(, ,"29")
  end

]]>
</programlisting>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddExtendedStyle" xreflabel="addExtendedStyle"><title>addExtendedStyle</title>
<indexterm><primary>addExtendedStyle</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>addExtendedStyle</secondary></indexterm>
<programlisting>
<![CDATA[
>>-addExtendedStyle(--style--)-------------------><
]]>
</programlisting>

<para>
  The <emphasis role="italic">addExtendedStyle</emphasis> method adds one or more of the <link
  linkend="varListControlExtendedStyles">extended</link> list-view styles to a list-view. These styles can not be added until
  the underlying Windows list-view control has been created. They can be added in the <xref linkend="mthInitDialog"/>
  method, or any time thereafter.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The only argument is:
  </para>
  <variablelist>
    <varlistentry><term>style [required]</term>
    <listitem>
    <para>
      The extended style to be added. A list of 1 or more of the following keywords separated by spaces, case is not
      significant. Invalid words in the list are ignored. If there are no valid keywords at all in the list, then an error
      is returned:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>BORDERSELECT    </member>
        <member>CHECKBOXES      </member>
        <member>DOUBLEBUFFER    </member>
        <member>FLATSB          </member>
        <member>FULLROWSELECT   </member>
        <member>GRIDLINES       </member>
        <member>HEADERDRAGDROP  </member>
        <member>INFOTIP         </member>
        <member>LABELTIP        </member>
        <member>MULTIWORKAREAS  </member>
        <member>ONECLICKACTIVATE</member>
        <member>REGIONAL        </member>
        <member>SIMPLESELECT    </member>
        <member>SUBITEMIMAGES   </member>
        <member>TRACKSELECT     </member>
        <member>TWOCLICKACTIVATE</member>
        <member>UNDERLINECOLD   </member>
        <member>UNDERLINEHOT    </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>BORDERSELECT</term>
        <listitem>
        <para>
          When an item is selected the border color of the item changes rather than the item being highlighted.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>CHECKBOXES</term>
        <listitem>
        <para>
          Check boxes are visible and functional in all list-view modes except tile mode.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DOUBLEBUFFER</term>
        <listitem>
        <para>
          Windows XP or later only.  The list-view control is painted using double buffering.  This reduces flicker.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>FLATSB</term>
        <listitem>
        <para>
          Enables flat scroll bars.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>FULLROWSELECT</term>
        <listitem>
        <para>
          Report view only.  When a row is selected, the whole row is highlighted rather than just the first column.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>GRIDLINES</term>
        <listitem>
        <para>
          Report view only. Gridlines are drawn around all items and sub-items. This gives a spreadsheet-like appearance to
          the list-view control.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HEADERDRAGDROP</term>
        <listitem>
        <para>
          Report view only. The user can drag and drop the headers to rearrange the columns.
        </para>
        </listitem></varlistentry>
        <varlistentry id='styListViewInfoTip'><term>INFOTIP</term>
        <listitem>
        <para>
          With this style the list-view control sends the <link linkend="kywListViewGETINFOTIP">GETINFOTIP</link>
          notification to the dialog before displaying an item's tooltip. This allows the program to add, enhance, or change
          the text displayed in the tip.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LABELTIP</term>
        <listitem>
        <para>
          Windows XP or later only. In any list-view mode, if an item's label is only partially visible, the complete label
          will be displayed in a fashion similar to a tool tip.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MULTIWORKAREAS</term>
        <listitem>
        <para>
          The current version of ooDialog can not take advantage of this style. It is planned for a future enhancement.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ONECLICKACTIVATE</term>
        <listitem>
        <para>
          Enables the list-view control to send an item activate notification when the user clicks one time on an item.  It
          also enables hot tracking in the list-view control. Both the underline cold and the underline hot styles need
          either one click activate or two click activate styles to be enabled.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>REGIONAL</term>
        <listitem>
        <para>
          Icon view only. Sets the window region to only include an item's icon and text.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SIMPLESELECT</term>
        <listitem>
        <para>
                    Windows XP and later only.  Icon view only.  Moves the state
        image to the top right of the icon image. If the user changes the state using
        the space bar, all the selected items cycle, not just the item with the focus.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SUBITEMIMAGES</term>
        <listitem>
        <para>
          Report view only. Allows images to be displayed for subitems.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TRACKSELECT</term>
        <listitem>
        <para>
          Enables hot track selection. The user can select an item by leaving the mouse over an item for a certain period of
          time, the &quot;hover&quot; time.  This period of time can be changed from the default by using the <xref
          linkend="mthSetHoverTime"/> method.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TWOCLICKACTIVATE</term>
        <listitem>
        <para>
          Enables the list-view control to send an item activate notification when the user clicks on an item after it has
          been selected. When the user clicks on an item it will be selected. At that point, if the user
          clicks on the item a second time, the item will be activated. Note that this is different from double-clicking to
          activate.  Any amount of time can pass between the click that selects the item and the click that activates the
          item. (Provided the item remains selected of course.)
        </para>
        <para>
          It also works with track select. If track select is enabled, the user can select an item by pausing the mouse over
          the item.  At that point, if the user then clicks on the item it will be activated.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>UNDERLINECOLD</term>
        <listitem>
        <para>
          Underlining gives the user a visual clue that a single click on an item will activate it.  Underlining requires
          either ONECLICKACTIVATE or TWOCLICKACTIVE to also be enabled.  An item becomes hot when the mouse is over it.
          Underline cold underlines all the cold items when a single click will activate them.  When one click activate is
          enabled, this would then be all items.  When two click activate is enabled this would then be only those items that
          were selected.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>UNDERLINEHOT</term>
        <listitem>
        <para>
          The underline hot style is similar to the underline cold style. See that style above for the explanation of some of
          the terms.  With underline hot, the item is underlined when the mouse is over it, if one click will activate the
          item.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return values are:
  </para>
  <variablelist>
    <varlistentry><term>0</term>
    <listitem>
    <para>
      Success.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>-1</term>
    <listitem>
    <para>
      An (internal) problem with the control's window handle.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>-3</term>
    <listitem>
    <para>
      The style argument did not contain any of the extended style keywords.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example shows how to initially add the extended styles to a list-view control.  This is done in the
    <xref linkend="mthInitDialog"/> method, which executes after the underlying Windows dialog has been created, but before
    it is displayed on the screen.  This is the earliest point in time that the extended style methods can be used.  The
    list-view is in the report view and will have check boxes and grid lines.  The user will be able to use drag and drop to
    rearrange the columns. When a row is selected, the full row will be highlighted rather than just the first column.

<programlisting>
<![CDATA[

::method initDialog
  expose listView

  ...
  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~addExtendedStyle("CHECKBOXES GRIDLINES FULLROWSELECT HEADERDRAGDROP")
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddFullRow" xreflabel="addFullRow"><title>addFullRow</title>
<indexterm><primary>addFullRow</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>addFullRow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addFullRow(--row--)--------------------------><
]]>
</programlisting>

<para>
  Add an item to the list-view at the end of the list using a <link linkend="clsLvFullRow">LvFullRow</link> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
    <variablelist>
      <varlistentry><term>row [required]</term>
      <listitem>
      <para>
        A <link linkend="clsLvFullRow">LvFullRow</link> object that specifies the item to be added to the list-view.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the zero-based index of the added row. On error, -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a full row object is used to add an item to the list view, all the subitems are also added. The item is always
    added as the last item in the list. Because of this, the item index and subitem index values in the full row object
    are ignored. After the item is added, the item and subitem index are updated to the correct value of the newly added
    item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows part of an initDialog() method.  The private method createRows() returns an array of
    <computeroutput>LvFullRow</computeroutput> objects, which are then used to populate the list-view:
<programlisting>
<![CDATA[

::method initDialog
  expose list

  list = self~newListView(IDC_LV_EMPLOYEES)

  ...

  rows = self~createRows
  do r over rows
    list~addFullRow(r)
  end


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::addFullRow() -->

<section id="mthAddRow" xreflabel="addRow"><title>addRow</title>
<indexterm><primary>addRow</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>addRow</secondary></indexterm>
<programlisting>
<![CDATA[
                                     +-,----+
                                     V      |
>>--addRow(--+------+--,--------+--+--------+--)-><
             +-item-+  +-,-icon-+  +-,-text-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">addRow</emphasis> method adds a new item to a list-view. This method is
  most useful when adding items that have subitems to the list-view. But, despite its name, it can be
  used to add any item, with or without subitems, to a list-view.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>item [optional]</term>
    <listitem>
    <para>
      The index of the item. If you omit this argument, the item is added immediately after the last item added or inserted
      in the list-view. That is, the index defaults to the index of the last item added plus 1. If there are no items in the
      list-view then the item is added at index 0.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>icon [optional]</term>
    <listitem>
    <para>
      The index within the image list for the icon for this item. Image lists are assigned to a list-view by
      using the <xref linkend="mthSetImageListClsListView"/>() method. With the <emphasis
      role="italic">setImageList</emphasis> method, use the LVSIL_NORMAL flag for the icon view icons and the LVSIL_SMALL
      flag for the list, report, and small-icon views icons. If this argument is omitted, no icon index is assigned to the
      itme
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [optional]</term>
    <listitem>
    <para>
      Any number of text strings. The first text string is used for the label of the item. Successive strings are used for
      the text of subitems of the item. For example, the text of the second string is used for the text of subitem 1. The
      text of the third string is used for the text of subitem 2, and so on. If the first string is omitted, then the empty
      string is used for the item label. If other strings are omitted, than no text is set for the corresponding subitem. If
      you specify more text entries than there are columns, the extra entries are ignored.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The index of the new item, or -1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example adds three items to a report list with two columns:
<programlisting>
<![CDATA[
::method InitList
  lv = self~newListView(IDC_LV_CONTACTS)
  lv~addRow(, ,"Mike","Miller")
  lv~addRow(, ,"Sue","Muller")
  lv~addRow(, ,"Chris","Watson")
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddRowFromArray" xreflabel="addRowFromArray"><title>addRowFromArray</title>
<indexterm><primary>addRowFromArray</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>addRowFromArray</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addRowFromArray(--data--+--------------+--+-------------+--)--------------><
                            +-,-itemIndex--+  +-,-strIfNil--+
]]>
</programlisting>

<para>
  Inserts an item into this list-view from an array of values.  The string value of each item in the array is used as the
  text for the item and subitem(s).
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>data [required]</term>
    <listitem>
    <para>
      An array object. The string value of each item in the array is used as the text for the item and subitems of the
      list-view item. The item at index 1 of the array is used as the text for the list-view item. The item at index 2 is
      used as the text for the first subitem, the item at index 3 is used as the text for subitem 2, etc.. The array can
      not be sparse
    </para>
    </listitem></varlistentry>
    <varlistentry><term>itemIndex [optional]</term>
    <listitem>
    <para>
      The item index to use for the for the list-view item being added. If omitted, the new item is added after the last
      inserted item in the list-view.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>strIfNil [optional]</term>
    <listitem>
    <para>
      If the item at any index in <emphasis role="italic">data</emphasis> array is the <computeroutput>.nil</computeroutput>
      object, then the text for the item or subitem corresponding to that index will be the string value of the
      <computeroutput>.nil</computeroutput> object. Which is <emphasis role="italic">the NIL object</emphasis>. The <emphasis
      role="italic">strIfNil</emphasis> argument can be used to specify text to use instead of <emphasis role="italic">the
      NIL object</emphasis>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the index of the newly added list-view item on success. On error, -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example queries an ooSQLite database and then populates the list-view items with the returned result set:
<programlisting>
<![CDATA[

  dbConn = .ooSQLiteConnection~new(dbName, .ooSQLite~OPEN_READWRITE)

  sql  = 'SELECT * FROM foods ORDER BY name;'
  data = dbConn~exec(sql, .true)
  dbConn~close

  self~insertListViewColumns(list, data[1])
  do i = 2 to data~items
      list~addRowFromArray(data[i], , 'null')
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::addRowFromArray() -->

<section id="mthAddStyleClsListView" xreflabel="addStyle"><title>addStyle</title>
<indexterm><primary>addStyle</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                              +-------------------+
                              V                   |
>>-aListControl~addStyle(--"----+-ICON----------+-+--"--)-------><
                                +-SMALLICON-----+
                                +-LIST----------+
                                +-REPORT--------+
                                +-ALIGNLEFT-----+
                                +-ALIGNTOP------+
                                +-AUTOARRANGE---+
                                +-ASCENDING-----+
                                +-DESCENDING----+
                                +-EDIT----------+
                                +-HSCROLL-------+
                                +-VSCROLL-------+
                                +-NOSCROLL------+
                                +-NOHEADER------+
                                +-NOSORTHEADER--+
                                +-NOWRAP--------+
                                +-SINGLESEL-----+
                                +-SHOWSELALWAYS-+
                                +-SHAREIMAGES---+
                                +-GROUP---------+
                                +-HIDDEN--------+
                                +-NOTAB---------+
                                +-NOBORDER------+


]]>
</programlisting>

<para>The addStyle method adds new window styles to a
list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>style</term>
<listitem><para>The window styles to be added, which is one or more of the styles listed
in the syntax diagram, separated by blanks. For an explanation of the different
styles, refer to <xref linkend="mthCreateListView"/>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if this method fails.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthAlignLeft" xreflabel="alignLeft"><title>alignLeft</title>
<indexterm><primary>alignLeft</primary></indexterm>
<programlisting>
<![CDATA[
>>--alignLeft------------------------------------><
]]>
</programlisting>

<para>The alignLeft method aligns items along the left
window border.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were aligned.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthAlignTop" xreflabel="alignTop"><title>alignTop</title>
<indexterm><primary>alignTop</primary></indexterm>
<programlisting>
<![CDATA[
>>--alignTop-------------------------------------><
]]>
</programlisting>

<para>The alignTop method aligns items along the upper
window border.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were aligned.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthArrange" xreflabel="arrange"><title>arrange</title>
<indexterm><primary>arrange</primary></indexterm>
<programlisting>
<![CDATA[
>>--arrange--------------------------------------><
]]>
</programlisting>

<para>The arrange method aligns items according to the
current alignment style of the list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were aligned.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthBkColor" xreflabel="bkColor"><title>bkColor</title>
<indexterm><primary>bkColor</primary></indexterm>
<programlisting>
<![CDATA[
>>--bkColor--------------------------------------><
]]>
</programlisting>

<para>The bkColor method retrieves the background color
for a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The <xref linkend="defColorPalette"/> index specifier (0 to 18).
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthBkColorEquals" xreflabel="bkColor="><title>bkColor=</title>
<indexterm><primary>bkColor=</primary></indexterm>
<programlisting>
<![CDATA[
>>--bkColor = color------------------------------><
]]>
</programlisting>

<para>The bkColor= method sets the background color of
a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>color</term>
<listitem>
<para>
  The new background color. Specify the <xref linkend="defColorPalette"/> index specifier (0 to 18).
</para>
</listitem></varlistentry>
</variablelist>
</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets the background color of a list control to
yellow:
<programlisting>
<![CDATA[
::method Yellow
  curList = self~newListView(104)
  curList~bkColor = 15
  curList~update
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthCheckClsListControl" xreflabel="check"><title>check</title>
<indexterm><primary>check</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~check(--index--)-----------------><

]]>
</programlisting>

<para>The <computeroutput>check</computeroutput> method sets the check mark for
a list-view item.  This method is only valid for list-view controls that have
the check boxes extended style.  (See the
<xref linkend="mthAddExtendedStyle"/> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item for which to set the check mark.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The index is invalid.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a mailing list application.  The
user selects which entries to include in any mailing.  All items in a list-view
that have their check boxes checked are included in the mailing.  The
application has a feature that allows the user to automatically select all items
with a specified zip code.
<programlisting>
<![CDATA[

::method onUseZip

  text = self~newEdit(IDC_EDIT_ZIPCODE)~getText
  if self~validateZip(text) then do
     list = self~newListView(IDC_LIST)
     do i = 0 to addresses~items - 1
       infoTable = address[i + 1]
       if infoTable['zip'] == text then list~check(i)
     end
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthCheckAll" xreflabel="checkAll"><title>checkAll</title>
<indexterm><primary>checkAll</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~CheckAll-------------------------><

]]>
</programlisting>

<para>The <computeroutput>checkAll</computeroutput> method sets the check mark
for every list-view item.  This method is only valid for list-view controls that
have the check boxes extended style.  (See the
<xref linkend="mthAddExtendedStyle"/> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a program that has a push button
that allows the user to check all the check boxes:
<programlisting>
<![CDATA[

::method onCheckAll

  list = self~newListView(IDC_LIST_REPUBLICANS)
  list~checkAll

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthColumnInfo" xreflabel="columnInfo"><title>columnInfo</title>
<indexterm><primary>columnInfo</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~columnInfo(--column--)-----------><


]]>
</programlisting>

<para>The columnInfo method retrieves the attributes
of a column of a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column of which the attributes are to be retrieved.
0 is the first column.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>A compound variable that stores the attributes of the item.
If attributes for a column are not available or an error occurs, then the
RetStem.!WIDTH variable will be set to 0.
<variablelist>
<varlistentry><term>RetStem.!TEXT</term>
<listitem><para>The heading of the column.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!COLUMN</term>
<listitem><para>The column number.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!WIDTH</term>
<listitem><para>The width of the column.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!ALIGN</term>
<listitem><para>The alignment of the column: &quot;LEFT&quot;, &quot;RIGHT&quot;, or &quot;CENTER&quot;.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthColumnWidth" xreflabel="columnWidth"><title>columnWidth</title>
<indexterm><primary>columnWidth</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~columnWidth(--column--)----------><


]]>
</programlisting>

<para>The columnWidth method retrieves the width of a
column in a report or list view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column of which the width is to be retrieved. 0 is
the first column.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The column width, or -1 if you did not specify <emphasis role="italic">column</emphasis>,
or 0 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example displays the column width in an information box
when the column is clicked on:
<programlisting>
<![CDATA[
::method onColumnClick
  use arg id, column
  listView = self~newListView(102)
  call infoDialog listView~columnWidth(column)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthColumnWidthPX" xreflabel="columnWidthPX"><title>columnWidthPX</title>
<indexterm><primary>columnWidthPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>columnWidthPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--columnWidthPX(--colIndex--)------------------><

]]>
</programlisting>

<para>
  Gets the width, in pixels, of the specified column in a list-view control when it has the list or report view styles.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>colIndex [required]</term>
      <listitem>
      <para>
        The zero-based index of the column to query.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The width of the column, in pixels, on success or zero on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">colIndex</emphasis> argument is ignored when the list-view has the list style.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::columnWidthPX() -->

<section id="mthDeleteClsListView" xreflabel="delete"><title>delete</title>
<indexterm><primary>delete</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>delete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--delete(--index--)----------------------------><

]]>
</programlisting>

<para>
  Deletes the specified item from the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index of the item to delete.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example deletes the selected item.
<programlisting>
<![CDATA[
::method deleteSelectedItem
    list = self~newListView(IDC_LV_RACECARS)

    index = list~selected
    if index <> -1 then
        list~delete(index)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::delete() -->

<section id="mthDeleteAllClsListview" xreflabel="deleteAll"><title>deleteAll</title>
<indexterm><primary>deleteAll</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>deleteAll</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deleteAll------------------------------------><

]]>
</programlisting>

<para>
  Deletes all items from the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, 1 on error.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::deleteAll() -->

<section id="mthDeleteColumn" xreflabel="deleteColumn"><title>deleteColumn</title>
<indexterm><primary>deleteColumn</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>deleteColumn</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deleteColumn(--colIndex--+------------------+--)------------><
                             +-,-adjustFullRows-+
]]>
</programlisting>

<para>
  Deletes the specified column in this list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>colIndex [required]</term>
    <listitem>
    <para>
      The zero-based index of the column to delete.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>adjustFullRows [optional]</term>
    <listitem>
    <para>
      If true attempts to fix up the <xref linkend="clsLvFullRow"/> objects assigned to the item <link
      linkend="mthSetItemDataClsListView">data</link> of each list-view item. Does nothing if false. The default is false.
      This argument is only used to support <link linkend="sctInternalSorting">internal</link> sorting. If the application is
      not using internal sorting then this argument should just be ignored.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    <link linkend="defWindowsDoc">MSDN</link> says column 0 can not be deleted. If column 0 must be deleted, MSDN
    suggests inserting a dummy column at index 0 and then deleting column 1.
  </para>
  <para>
    However, this is not true, deleting column 0 will succeed if all the other columns are deleted first. What can not be
    deleted is the list-view item information for column 0. When a column for a subitem is deleted, the subitem information
    is deleted. But, when column 0 is deleted the item information is not deleted. If, after deleting column 0, the
    application switches the view from report to one of the other views, like icon, the information for each item will
    display. In report view, nothing will show if all columns have been deleted.
  </para>
  <para>
    Only use the <emphasis role="italic">adjustFullRows</emphasis> argument to <link
    linkend="sctInternalSorting">adjust</link> the <computeroutput>LvFullRow</computeroutput> objects if every list-view item
    has a <computeroutput>LvFullRow</computeroutput> item assigned as the item data, and the programmer has kept the full
    rows consistent with changes to the column count of this list-view. If these conditions are not met, this method will
    return an error code, even if the column was deleted successfully. However, no harm is done, it will just make it hard
    to tell between a successful execution of the method and an error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example deletes the column for the first subitem of the list-view items:
<programlisting>
<![CDATA[

  list = self~newListView(IDC_LV_CONTACTS)
  list~deleteColumn(1)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::deleteColumn() -->


<section id="mthDeselect" xreflabel="deselect"><title>deselect</title>
<indexterm><primary>deselect</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~deselect(--item--)---------------><


]]>
</programlisting>

<para>The deselect method deselects an item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was selected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthDeselectAll" xreflabel="deselectAll"><title>deselectAll</title>
<indexterm><primary>deselectAll</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>deselectAll</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deselectAll----------------------------------><

]]>
</programlisting>

<para>
  Deselects all items in the list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has not arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the number of items deselected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example deselects any selected items in the list-view.
<programlisting>
<![CDATA[

  self~newListView(IDC_LV_ADDRESSES)~deselectAll

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::deselectAll() -->

<section id="mthDropHighLighted" xreflabel="dropHighlighted"><title>dropHighlighted</title>
<indexterm><primary>dropHighlighted</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~DropHighlighted------------------><


]]>
</programlisting>

<para>The dropHighlighted method retrieves the item that
is highlighted as a drag-and-drop target.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the selected item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthEdit" xreflabel="edit"><title>edit</title>
<indexterm><primary>edit</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~edit(--item--)-------------------><


]]>
</programlisting>

<para>The edit method begins editing of the text of the
specified list-view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The handle of the edit control used to edit the item text, or 0 in all
other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthEndEdit" xreflabel="endEdit"><title>endEdit</title>
<indexterm><primary>endEdit</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~EndEdit--------------------------><


]]>
</programlisting>

<para>The endEdit method cancels editing of the list
view item that is being edited.</para>
</section>

<section id="mthEnsureVisible" xreflabel="ensureVisible"><title>ensureVisible</title>
<indexterm><primary>ensureVisible</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                         +-0-+
>>-aListControl~ensureVisible(--item--,--+---+--)---------------><
                                         +-1-+


]]>
</programlisting>

<para>The ensureVisible method ensures that a list-view
item is entirely or partially visible by scrolling the list-view control,
if necessary.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item visible.
</para></listitem></varlistentry>
<varlistentry><term>partial</term>
<listitem><para>Specifies whether the item must be entirely visible:
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The list-view control is not scrolled if the item is at least partially
visible.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The list-view control is scrolled if the item is only partially visible.
This is the default.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item is visible.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthFindClsListView" xreflabel="find"><title>find</title>
<indexterm><primary>find</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                +- -1--+     +-0-+
>>-aListControl~find(--text--,--+------+--,--+---+--)-----------><
                                +-item-+     +-1-+


]]>
</programlisting>

<para>The find method searches for a list-view item containing <emphasis role="italic">text</emphasis>. The text of this item must exactly match <emphasis role="italic">text</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text of the item to be searched for.
</para></listitem></varlistentry>
<varlistentry><term>item</term>
<listitem><para>Specify the number of the item at which the search is to be started.
Specify -1 or omit this argument to start the search at the beginning.
</para></listitem></varlistentry>
<varlistentry><term>wrap</term>
<listitem><para>Specify 1 if the search is to be continued at the beginning if no match
is found. Specify 0 or omit this argument if the search is to stop at the
end of the list.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthFindNearestXY" xreflabel="findNearestXY"><title>findNearestXY</title>
<indexterm><primary>findNearestXY</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~findNearestXY(--x--,--y--+--------------------+--)-------------><
                                         |       +-DOWN--+    |
                                         +-,--"--+-UP----+--"-+
                                                 +-LEFT--+
                                                 +-RIGHT-+


]]>
</programlisting>

<para>The findNearestXY method searches, in the specified
direction, for the item nearest to the specified position.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>x</term>
<listitem><para>The x-coordinate of the position at which the search is to be started.
</para></listitem></varlistentry>
<varlistentry><term>y</term>
<listitem><para>The y-coordinate of the position at which the search is to be started.
</para></listitem></varlistentry>
<varlistentry><term>direction</term>
<listitem><para>The direction in which the search should proceed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The index of the item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthFindPartial" xreflabel="findPartial"><title>findPartial</title>
<indexterm><primary>findPartial</primary></indexterm>
<programlisting>
<![CDATA[
                                       +- -1--+     +-0-+
>>-aListControl~findPartial(--text--,--+------+--,--+---+--)----><
                                       +-item-+     +-1-+


]]>
</programlisting>

<para>The findPartial method searches for a list-view
item containing <emphasis role="italic">text</emphasis>. An item matches if its text begins with <emphasis role="italic">text</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text of the item to be searched for.
</para></listitem></varlistentry>
<varlistentry><term>item</term>
<listitem><para>Specify the number of the item at which the search is to be started.
Specify -1 or omit this argument to start the search at the beginning.
</para></listitem></varlistentry>
<varlistentry><term>wrap</term>
<listitem><para>Specify 1 if the search is to be continued at the beginning if no match
is found. Specify 0 or omit this argument if the search is to stop at the
end of the list.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthFirstVisible" xreflabel="firstVisible"><title>firstVisible</title>
<indexterm><primary>firstVisible</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>firstVisible</secondary></indexterm>
<programlisting>
<![CDATA[
>>--firstVisible---------------------------------><
]]>
</programlisting>

<para>
  Retrieves the index of the topmost visible item when in this list-view is in list or report view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the zero-based index of the topmost visible item when the list-view is in list or report view. Returns 0 if the
    list-view is in icon or small icon view.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    There is no way to distinguish between a return of 0 because the list-view is not in list or report view and a 0 because
    the topmost visible item is index 0 when the list-view is in list or report view.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::firstVisible() -->


<section id="mthFixFullRowColumns" xreflabel="fixFullRowColumns"><title>fixFullRowColumns</title>
<indexterm><primary>fixFullRowColumns</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>fixFullRowColumns</secondary></indexterm>
<programlisting>
<![CDATA[
>>--fixFullRowColumns(--colIndex--+-------------+--)------------><
                                  +-,-inserted--+
]]>
</programlisting>

<para>
  A convenience method used to adjust the subitem columns in the <xref linkend="clsLvFullRow"/> objects used for <link
  linkend="sctInternalSorting">internal</link> sorting when a column has been deleted or inserted in this list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>colIndex [required]</term>
    <listitem>
    <para>
      The one-based index of the <emphasis role="italic">subitem</emphasis> column that was inserted or deleted.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>inserted [optional]</term>
    <listitem>
    <para>
      True or false to specify if the column was inserted or removed. The default is false, the column was deleted. Set this
      argument to true to specify the column was inserted.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    As explained in the <link linkend="sctInternalSorting">section</link> on internal sorting considerations, the ooDialog
    framework does its best to keep the full row objects assigned as the <link
    linkend="mthSetItemDataClsListView">item</link> data of each list-view item in sync with the actual item. However, when a
    column is deleted or inserted, the programmer needs to take some action to alert the framework that the full row objects
    need to be updated. The <emphasis role="italic">fixFullRowColumns</emphasis> is provided as one option the programmer can
    use to take action. The other options are to manually update the item data of each list-view item, or to use the
    <emphasis role="italic">adjustFullRows</emphasis> argument of the <xref linkend="mthDeleteColumn"/> or <xref
    linkend="mthInsertColumn"/> methods.
  </para>
  <para>
    The <emphasis role="italic">fixFullRowColumns</emphasis> method has to be used after each individual delete or insert of
    a column. I.e., the programmer can not delete 2 rows and then call <emphasis role="italic">fixFullRowColumns</emphasis>
    twice in a row. The <emphasis role="italic">colIndex</emphasis> argument value must be within a valid range. It can not
    be 0, or greater than the count of current columns plus 1.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example uses the <emphasis role="italic">fixFullRowColumns</emphasis> method to notify the ooDialog framework that
    a column has been deleted in the list-view. The framework then updates all the <computeroutput>LvFullRow</computeroutput>
    objects assigned as the item data of each list-view item:
<programlisting>
<![CDATA[

  list = self~newListView(IDC_LV_CONTACTS)
  list~deleteColumn(1)
  list~fixFullRowColumns(1)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::fixFullRowColumns() -->


<section id="mthFocus" xreflabel="focus"><title>focus</title>
<indexterm><primary>focus</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~focus(--item--)------------------><


]]>
</programlisting>

<para>The focus method assigns the focus to the specified
item, which is then surrounded by the standard focus rectangle. Although more
than one item can be selected, only one item can have the focus.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item to receive the focus.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The specified item received the focus.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthFocused" xreflabel="focused"><title>focused</title>
<indexterm><primary>focused</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Focused--------------------------><


]]>
</programlisting>

<para>The focused method retrieves the number of the
item that has currently the focus.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item with the focus, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetCheck" xreflabel="getCheck"><title>getCheck</title>
<indexterm><primary>getCheck</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~getCheck(--index--)--------------><

]]>
</programlisting>

<para>The <computeroutput>getCheck</computeroutput> method determines if the
item at the specified list index has a checked check box. This method will
return a code indicating that the list-view control does not have the check
boxes extended style, if appropriate.  (See the
<xref linkend="mthAddExtendedStyle"/> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item to query.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>1</term>
<listitem><para>The item has a check box that is checked.
</para></listitem></varlistentry>
<varlistentry><term>0</term>
<listitem><para>The item has a check box, and it is not checked.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The index is invalid.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example could be used as a shortcut method to
determine if a list-view control currently has the check box extended style.
<programlisting>
<![CDATA[

  ...
  list = self~newListView(IDC_LV_DOCTORS)
  if list~getCheck(0) == -2 then
    return   -- The list-view does not currently have the check box style in effect

  do i = 0 to list~items - 1
    ...
  end


]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetColumnCount" xreflabel="getColumnCount"><title>getColumnCount</title>
<indexterm><primary>getColumnCount</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColumnCount-------------------------------><

]]>
</programlisting>

<para>
  This method returns the number of columns in the list-view control when it is in report view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      There are no arguments.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      This method returns the number of columns, or -1 on some error. An error is unlikely.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This method is straight forward to use:
<programlisting>
<![CDATA[
colCount = list~getColumnCount
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::getColumnCount() -->


<section id="mthGetColumnInfo" xreflabel="getColumnInfo"><title>getColumnInfo</title>
<indexterm><primary>getColumnInfo</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getColumnInfo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColumnInfo(--index--,--directory--)-------><

]]>
</programlisting>

<para>
  Retrieves information for the column specified in a <computeroutput>Directory</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index of the column to retrieve information for. Columns are numbered from the left to the right.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>directory [required]</term>
      <listitem>
      <para>
        A <computeroutput>Directory</computeroutput> object whose indexes will be filled with the returned column
        information. On success, the <computeroutput>Directory</computeroutput> object will have the following indexes
        with the corresponding information:

        <variablelist>
          <varlistentry><term><emphasis role="bold">text</emphasis></term>
          <listitem>
          <para>
            The text (label) for the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">subitem</emphasis></term>
          <listitem>
          <para>
            The index of the subitem associated with the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">width</emphasis></term>
          <listitem>
          <para>
            The width, in pixels, of the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">fmt</emphasis></term>
          <listitem>
          <para>
            A series of blank separated key words specifying the format for the column. See the remarks.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success and <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    No other indexes in the <emphasis role="italic">directory</emphasis> object will be touched other than those noted.
    On error, the value of the noted indexes is undefined.
  </para>
  <para>
    The <computeroutput>fmt</computeroutput> index, at this time, will contain exactly one keyword, either LEFT, RIGHT,
    or CENTER denoting the alignment of the text for the column. However, the underlying list-view control has a number
    of other format attributes. These other attributes are currently ignored by the ooDialog framework. Future versions
    of ooDialog may be enhanced to include more keywords.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example displays information about the column when the user clicks on it:
<programlisting>
<![CDATA[

::method onColumnClick
  use arg id, column
  listView = self~newListView(IDC_LV_PROPERTIES)

  d = .Directory~new
  if listView~getColumnInfo(column, d) then do

    msg = "Column Title : " d~text    || .endOfLine || -
          "Column Number: " d~subitem || .endOfLine || -
          "Column Width : " d~width   || .endOfLine || -
          "Alignment    : " d~fmt

    j = MessageDialog(msg, self~hwnd, "List View Column Information")
  end
  else do
    j = MessageDialog("Failed to get column information.", self~hwnd, "Windows API Error")
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getColumnInfo() -->


<section id="mthGetColumnOrder" xreflabel="getColumnOrder"><title>getColumnOrder</title>
<indexterm><primary>getColumnOrder</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColumnOrder-------------------------------><

]]>
</programlisting>

<para>
  Retrieves the current column order of the list-view when in report view. The order of the columns can
  be changed programmatically by using  the <xref linkend="mthSetColumnOrder"/>()
  method. In XP and later there is also an <xref linkend="mthAddExtendedStyle"/> style
  which lets the user rearrange the order of the columns. If the list-view control has not had the
  columns rearranged, then the column order will always be 0, 1, 2, ... of course.
</para>
<para>
  One practical use of this method would be in conjunction with the
 <xref linkend="mthSetColumnOrder"/>() method. In an application where the user can
  rearrange the column order, the programmer could get the order when a dialog closes, save it, and then
  restore the order to the user's preference when the application is restarted.
</para>
<para>
  Note that the list-view control does not have to have the HEADERDRAGDROP style for the get and set
  column order methods to work. That style is only needed to allow the user to rearrange the columns
  using drag and drop. The programmer can use <xref linkend="mthSetColumnOrder"/>()
  to change the order of the columns whether or not the list-view has the HEADERDRAGDROP style, or not.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      There are no arguments.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term>an <computeroutput>.Array</computeroutput> object</term>
        <listitem>
          <para>
            An array is returned with the index numbers of the columns. The number at the first position
            in the array is the column index of the left-most column. The number in the second position
            in the array is the index of the second left-most column, etc..
          </para>
        </listitem></varlistentry>
        <varlistentry><term><computeroutput>.nil</computeroutput></term>
        <listitem>
          <para>
            <computeroutput>.nil</computeroutput> is returned for some unexpected error.  This is
            unlikely.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example prints out the column order when the dialog is first initialized, and then prints out
      the order when the dialog closes.
<programlisting>
<![CDATA[
  ...
  list = self~newListView(100)

  columnNames = .array~of("Occupation", "Name", "Age", "Sex")
  list~addExtendedStyle("FULLROWSELECT GRIDLINES CHECKBOXES HEADERDRAGDROP")

  list~insertColumn(0, columnNames[1], 95)
  list~insertColumn(1, columnNames[2], 95)
  list~insertColumn(2, columnNames[3], 95)
  list~insertColumn(3, columnNames[4], 35)

  self~printColumnOrder
  ...

::method close

  self~printColumnOrder
  return self~ok:super

::method printColumnOrder private
  expose list columnNames

  cols = list~getColumnOrder
  say 'cols:' cols
  say 'Column count: ' list~getColumnCount
  say 'Current order:'
  if cols~isA(.array) then do c over cols
    -- Column indexes are zero-based
    c += 1
    say " " columnNames[c]
  end

/* Output might be, (assuming the user changed the order):

cols: an Array
Column count:  4
Current order:
  Occupation
  Name
  Age
  Sex

cols: an Array
Column count:
Current order:
  Age
  Name
  Sex
  Occupation

*/
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::getColumnOrder() -->

<section id="mthGetColumnText" xreflabel="getColumnText"><title>getColumnText</title>
<indexterm><primary>getColumnText</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getColumnText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColumnText(--index--)---------------------><

]]>
</programlisting>

<para>
  Retrieves the column header text for a list-view when it is in report view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based column index for which to get the text.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the text for the specified column, or the empty string on error.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getColumnText() -->


<section id="mthGetExtendedStyleClsListView" xreflabel="getExtendedStyle"><title>getExtendedStyle</title>
<indexterm><primary>getExtendedStyle</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getExtendedStyle</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~GetExtendedStyle-----------------><

]]>
</programlisting>

<para>The <computeroutput>getExtendedStyle</computeroutput> method returns
the extended <link linkend="varListControlExtendedStyles">styles</link> of a
<computeroutput>ListView</computeroutput>.  The styles are returned as a
string of blank delimited style keywords.  These are the same keywords as those
used to set the styles.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The returned string can contain one or more of the following
style keywords. See the <xref linkend="mthAddExtendedStyle"/>
method for the style descriptions:
<itemizedlist>
<listitem><para>BORDERSELECT</para></listitem>
<listitem><para>CHECKBOXES</para></listitem>
<listitem><para>DOUBLEBUFFER</para></listitem>
<listitem><para>FLATSB</para></listitem>
<listitem><para>FULLROWSELECT</para></listitem>
<listitem><para>GRIDLINES</para></listitem>
<listitem><para>HEADERDRAGDROP</para></listitem>
<listitem><para>INFOTIP</para></listitem>
<listitem><para>LABELTIP</para></listitem>
<listitem><para>MULTIWORKAREAS</para></listitem>
<listitem><para>ONECLICKACTIVATE</para></listitem>
<listitem><para>REGIONAL</para></listitem>
<listitem><para>SIMPLESELECT</para></listitem>
<listitem><para>SUBITEMIMAGES</para></listitem>
<listitem><para>TRACKSELECT</para></listitem>
<listitem><para>TWOCLICKACTIVATE</para></listitem>
<listitem><para>UNDERLINECOLD</para></listitem>
<listitem><para>UNDERLINEHOT</para></listitem>
</itemizedlist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example comes from a fictious application where
the user can elect to use the track select style, or not.  With this style, an
item can be selected by pausing the mouse over it for a period of time specified
by the hover time.  The application also allows the user to increase or decrease
the hover time.  In this example when the methods to increment or decrement the
hover time are invoked, the application first checks to see if the list-view
control has the track select style.  Then the change is only made if the list
view control does have the style.
<programlisting> <![CDATA[

::method initDialog
  expose listView

  ...
  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~addExtendedStyle("CHECKBOXES FULLROWSELECT TRACKSELECT")
  ...

::method onCheckboxClick
  expose listView

  chkBox = self~newCheckBox(IDC_CHECK_USETRACKSELECT)
  if chkBox~checked then
    listView~addExtendedStyle("TRACKSELECT")
  else
    listView~removeExtendedStyle("TRACKSELECT")

::method onDecrement
  expose listView

  styles = listView~getExtendedStyle
  if styles~wordpos("TRACKSELECT") == 0 then return

  time = listView~getHoverTime - 100
  if time > 0 then listView~setHoverTime(time)

::method onIncrement
  expose listView

  styles = listView~getExtendedStyle
  if styles~wordpos("TRACKSELECT") == 0 then return

  -- Let the user increase the hover time to any length they want.
  listView~setHoverTime(list~getHoverTime + 100)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetExtendedStyleRaw" xreflabel="getExtendedStyleRaw"><title>getExtendedStyleRaw</title>
<indexterm><primary>getExtendedStyleRaw</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~GetExtendedStyleRaw--------------><

]]>
</programlisting>

<para>The <computeroutput>getExtendedStyleRaw</computeroutput> method returns
the extended <link linkend="varListControlExtendedStyles">styles</link> of a
<computeroutput>ListView</computeroutput> as the numeric value of the
extended style flags.  This method is provided for programmers familiar with the
Windows API who may wish to know, or to work with, the actual value of the
flags.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The returned value is the numeric value of the extended style
flags currently in effect for the list-view control.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is the same example as the
<xref linkend="mthGetExtendedStyleClsListView"/> example.  It simply
replaces the <computeroutput>getExtendedStyle</computeroutput> invocation with a
<computeroutput>getExtendedStyleRaw</computeroutput> invocation.
<programlisting> <![CDATA[

::method initDialog
  expose listView

  ...
  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~addExtendedStyle("CHECKBOXES FULLROWSELECT TRACKSELECT")
  ...

::method onCheckboxClick
  expose listView

  chkBox = self~newCheckBox(IDC_CHECK_USETRACKSELECT)
  if chkBox~checked then
    listView~addExtendedStyle("TRACKSELECT")
  else
    listView~removeExtendedStyle("TRACKSELECT")

::method onDecrement
  expose listView

  if .DlgUtil~and(listView~getExtendedStyleRaw, "0x00000008") == 0 then return

  time = listView~getHoverTime - 100
  if time > 0 then listView~setHoverTime(time)

::method onIncrement
  expose listView

  if .DlgUtil~and(listView~getExtendedStyleRaw, "0x00000008") == 0 then return

  -- Let the user increase the hover time to any length they want.
  listView~setHoverTime(list~getHoverTime + 100)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetFullRow" xreflabel="getFullRow"><title>getFullRow</title>
<indexterm><primary>getFullRow</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getFullRow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getFullRow(--itemIndex--+-----------------+--)--------------><
                            +-,-useForSorting-+
]]>
</programlisting>

<para>
  Returns a <link linkend="clsLvFullRow">LvFullRow</link> object for the specified item in this list view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
    <variablelist>
      <varlistentry><term>itemIndex [required]</term>
      <listitem>
      <para>
        The index of the list-view item to get the full row for.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>sortable [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">sortable</emphasis> argument must be true or false. If true, the ooDialog framework sets
        up some internal housekeeping that allows internal sorting of list-view items. If <emphasis
        role="italic">sortable</emphasis> is false, this internal housekeeping is skipped. The default if <emphasis
        role="italic">sortable</emphasis> is omitted is false. See the remarks section for more details.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns a <computeroutput>LvFullRow</computeroutput> object whose attributes are the attributes of the
    list-view item specified. On error the <computeroutput>.nil</computeroutput> object is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    <computeroutput>LvFullRow</computeroutput> objects reflect the attributes of a list-view item and all the subitems of
    that item. It is common to think of a row when the list-view is in report view. However, once the subitems are added to a
    list-view item, they exist even when the view of the list-view is changed to one of the other views, like icon, or small
    icon.
  </para>
  <para>
    The <xref linkend="mthSortItems"/> method is used to do custom sorting of list-view items. The sorting is dependent on
    the item <link linkend="mthSetItemDataClsListView">data</link> being set for each list-view item. In addition, the
    <emphasis role="italic">sortItems</emphasis> method can be used to signal the ooDialog framework to use native internal
    code for the sorting. For the internal sort to work, the item data item <link linkend="sctInternalSorting">must</link> be
    a <computeroutput>LvFullRow</computeroutput> object.
  </para>
  <para>
    The returned object from <emphasis role="italic">getFullRow</emphasis> can be set as the item data to allow the internal
    sorting. When invoking the <emphasis role="italic">setItemData</emphasis> method with a
    <computeroutput>LvFullRow</computeroutput> object as the argument, the internal house keeping that the ooDialog framework
    needs to do for internal sorts is done automatically. However, if the returned full row object is instead used to insert
    or add a new item into the list-view, this internal house keeping may be bypassed. For this case, the <emphasis
    role="italic">sortable</emphasis> argument should be used and set to true.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example loops through all the items in a list-view, gets a full row for each item, and uses the full row as the user
    item data. Once this is done, the list-view items can be sorted using ooDialog's internal method. <emphasis
    role="bold">Note</emphasis> that the <emphasis role="italic">sortable</emphasis> argument is not used here. Invoking
    <emphasis role="italic">setItemData</emphasis> using the full row object is sufficient:
<programlisting>
<![CDATA[

  list = self~newListView(IDC_LV_CONTACTS)

  do i = 1 to list~items
    j = i - 1
    row = list~getFullRow(j)
    list~setItemData(j, row)
  end

]]>
</programlisting>
  </para>
  <para>
    This example is similar to the first example, however, the full row object is used to insert a new item into the
    list-view. <emphasis role="bold">Note</emphasis> that the <emphasis role="italic">sortable</emphasis> argument is used
    here. Once the loop finishes, the entire list can be sorted using the ooDialog internal sort.
<programlisting>
<![CDATA[

  list = self~newListView(IDC_LV_CONTACTS)

  do i = 1 to list~items
    j = i - 1
    row = list~getFullRow(j, .true)
    list~addFullRow(row)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getFullRow() -->

<section id="mthGetHoverTime" xreflabel="getHoverTime"><title>getHoverTime</title>
<indexterm><primary>getHoverTime</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getFullRow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getHoverTime---------------------------------><
]]>
</programlisting>

<para>
  This method retrieves the current hover time.  The hover time is expressed as milliseconds.  The hover time only affects
  list-view controls that have the track select, one click activate, or two click activate extended list-view
  styles. See the <xref linkend="mthAddExtendedStyle"/> method for a description of these styles.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The hover time for the list-view. A value of -1 indicates the hover time is the system default hover time.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example comes from a program where the one click activate and track select styles are enabled. Originally
    the hover time is set to .4 seconds. However the application allows the users to increase or decrease this time to match
    their preference. A menu item (or a button could be used) is connected to the
    <computeroutput>onIncrement</computeroutput> and <computeroutput>onDecrement</computeroutput> methods. When either of
    the methods is invoked, the current hover time is examined and then either incremented or decremented by .1 of a second.

<programlisting>
<![CDATA[

::method initDialog
  expose list

  ...
  list = self~newListView(IDC_LIST)
  list~addExtendedStyle("ONECLICKACTIVATE TRACKSELECT FULLROWSELECT")
  list~setHoverTime(400)
  ...

::method onDecrement
  expose list

  time = list~getHoverTime - 100
  if time > 0 then list~setHoverTime(time)

::method onIncrement
  expose list

  -- Let the user increase the hover time to any length they want.
  list~setHoverTime(list~getHoverTime + 100)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End ListView::getHoverTime() -->

<section id="mthGetImageListClsListView" xreflabel="getImageList"><title>getImageList</title>
<indexterm><primary>getImageList</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getImageList(--+--------+--)-----------------><
                   +--type--+
]]>
</programlisting>

<para>
  Retrieves the current image list for the type specified. The default is to retrieve the image list for
  the normal icons. See the <xref linkend="mthSetImageListClsListView"/> method for information
  on assigning an image list to a list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>The single argument is:
  <variablelist>
    <varlistentry><term>type [optional]</term>
    <listitem>
    <para>
      Specifies which image list to retrieve. The list-view maintains 4 different image lists. One for the normal icons, one
      for the small icons, one for the state icons, and one for the group header icons. However, ooDialog does not yet have
      support for list-view groups, or the group header image list.
    </para>
    <para>
      The following keywords are used to specify which image list is to be retrieved, case is not significant:
      <simplelist type='horiz' columns='2'>
      <member>NORMAL for the normal icon image list.</member>
      <member>SMALL for the small icon image list.</member>
      <member>STATE for the state image list.</member>
      </simplelist>
    </para>
    <para>
      The default value if this argument is omitted is NORMAl.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method returns the current <xref linkend="clsImageList"/>, if there is one, or
    <computeroutput>.nil</computeroutput> if there is no current image list of the type specified.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from a complex application that opens and closes a large number of dialogs and
    uses many list-view controls. All the list-view controls share the same image lists. When the last
    dialog is closed, the shared image lists are released to free up system resources as the
    application enters its next phase.
<programlisting>
<![CDATA[
::method ok
  self~checkImageLists
  return self~ok:super

::method cancel
  self~checkImageLists
  return self~cancel:super

::method checkImageLists
  expose list

  if self~isLastDialog then do
    types = .array~of('NORMAL', 'SMALL', 'STATE')

    do type over types
      il = list~getImageList(type)
      if il \== .nil then il~release
    end
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::getImageList() -->

<section id="mthGetItem" xreflabel="getItem"><title>getItem</title>
<indexterm><primary>getItem</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItem(--_item--)---------------------------><
]]>
</programlisting>

<para>
  Returns some, or all, of the information the list-view maintains on the specified item. The information is returned as a
  <link linkend="clsLvItem">LvItem</link> object. The item is specified by either a <computeroutput>LvItem</computeroutput>
  object or by the item's index.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
    <variablelist>
      <varlistentry><term>_item [required]</term>
      <listitem>
      <para>
        Specifies the list-view item whose information is required. <emphasis role="italic">_item</emphasis> can either be a
        <xref linkend="clsLvItem"/> object, or the zero-based index of the item.
      </para>
      <para>
        When <emphasis role="italic">_item</emphasis> is a <computeroutput>LvItem</computeroutput> object then it can be
        used to only retrieve some of the list-view item's information. The value of the <xref linkend="atrMaskClsLvi"/>
        attribute determines which information is retrieved. The attributes of the <computeroutput>LvItem</computeroutput>
        specified by the mask are set to the current value of that information in the list-view's item. Attributes not
        specified by the mask are ignored.
      </para>
      <para>
        When <emphasis role="italic">_item</emphasis> is the index of a list-view item, then a new
        <computeroutput>LvItem</computeroutput> object is returned. The attributes of this object reflect all the information
        of the list-view's item.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    When <emphasis role="italic">_item</emphasis> is a <computeroutput>LvItem</computeroutput> object, this method returns
    true on success and false on error. On success the attributes of the <emphasis role="italic">_item</emphasis> object,
    which is a <computeroutput>LvItem</computeroutput> object reflect the information requested. On error, the value of the
    attributes are undefined.
  </para>
  <para>
    When <emphasis role="italic">_item</emphasis> is the index of a list-view item, then on success, this method returns a
    <computeroutput>LvItem</computeroutput> object whose attributes represent the attributes of the list-view item. On error,
    the <computeroutput>.nil</computeroutput> object is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
    <para>
      Whether to use a <computeroutput>LvItem</computeroutput> object or an item index for the <emphasis
      role="italic">_item</emphasis> argument is dependent on what the programmer sees as the most convenient. If the
      programmer only wishes to determine the group ID of the item and does not need any other information on the item, it
      may be more convenient to use a <computeroutput>LvItem</computeroutput> object with the <emphasis
      role="italic">mask</emphasis> attribute set to just <emphasis role="italic">GROUPID</emphasis>. On the other hand, if
      the programmer wants all the current information for a list-view item, it may be more convenient to specify the index
      of the item and get back a new <computeroutput>LvItem</computeroutput> object.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      This example shows a generic method in a dialog to get the group ID of any, arbitrary, item in a list-view:

<programlisting>
<![CDATA[

::method getGroupID private
    expose list
    use strict arg itemIndex

    lvItem = .LvItem~new(itemIndex, , , , 'GROUPID')

    if list~getItem(lvItem) then do
        return lvItem~groupID
    end
    else do
        -- Some error happened, very unlikely.
        -- Handle the error
    end

]]>
</programlisting>
    </para>
    <para>
      This example shows a generic method for producing a new <computeroutput>LvItem</computeroutput> object for any item in
      a list-view:

<programlisting>
<![CDATA[

::method getLvItem
    use strict arg listView, itemIndex

    lvItem = listView~getItem(itemIndex)

    if lvItem == .nil then do
        -- Some error happened, very unlikely.
        -- Handle the error
    end
    else do
        return lvItem
    end

]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getItem() -->

<section id="mthGetItemDataClsListView" xreflabel="getItemData"><title>getItemData</title>
<indexterm><primary>getItemData</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getItemData</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemData(--index--)-----------------------><

]]>
</programlisting>

<para>
  Gets the item data associated with the specified list-view item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index of the item to retrieve the item data from.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the item data associated with the specified item, or the <computeroutput>.nil</computeroutput> object if
    there is no data associated with the item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The list-view control allows the user (the Rexx programmer) to associate a data value with any, or all, of the
    list-view items. The data value can be any ooRexx object. The data value is set using the
    <xref linkend="mthSetItemDataClsListView"/> method. If needed the data value can be removed from a list-view item
    through the <xref linkend="mthRemoveItemDataClsListView"/> method.  Storing a user value for each item can
    be useful in any number of ways. One specific use is in the <xref linkend="mthSortItems"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example uses the data value stored for each item to display extra employee information when the user double
    clicks on an item in a list-view that displays each employee. Note that the Rexx object stored for each list-view
    item is a <computeroutput>Directory</computeroutput> object:
<programlisting>
<![CDATA[

::method onDoubleClick
  expose list
  use arg id, index, subitem, flags

  tab = '9'x

  if index <> -1 then do
    data = list~getItemData(index)

    msg = 'Extra Information for' data~fName data~lName || .endOfLine~copies(2)

    select
      when subItem == 0 then do
        msg ||= 'Employee ID:' || tab           || data~ID      || .endOfLine
        msg ||= 'Manager:'     || tab~copies(2) || data~manager || .endOfLine
      end
      when subitem == 1 then do
        msg ||= 'Telephone:' || tab || data~telephone || .endOfLine
        msg ||= 'Cellphone:' || tab || data~cell      || .endOfLine
      end
      when subitem == 2 then do
        msg ||= 'Pay scale:' || tab || data~scale     || .endOfLine
        msg ||= 'Status:'    || tab || data~empStatus || .endOfLine
      end
      otherwise do
        -- insurance, can't happen
        nop
      end
    end
    -- End select

    title = 'Acme Plumbing Employee Statistics'

    z = MessageDialog(msg, self~hwnd, title, 'OK')
  end

  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getItemData() -->


<section id="mthGetItemInfo" xreflabel="getItemInfo"><title>getItemInfo</title>
<indexterm><primary>getItemInfo</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getItemInfo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemInfo(--index--,--directory--+------------+--)--------><
                                       +-,-subItem--+
]]>
</programlisting>

<para>
  Returns the attributes of an item, or one of its subitems, in a <computeroutput>Directory</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index</term>
      <listitem>
      <para>
        The zero-based index of the item whose information is to be retrieved. If the <emphasis
        role="italic">subItem</emphasis> argument is specified, then the information for the subitem of this item is
        returned.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>directory [required]</term>
      <listitem>
      <para>
        A <computeroutput>Directory</computeroutput> object whose indexes will be filled with the returned item
        information. On success, the <computeroutput>Directory</computeroutput> object will have the following
        indexes with the corresponding information:
        <variablelist>
          <varlistentry><term><emphasis role="bold">text</emphasis></term>
          <listitem>
          <para>
            The text of the item, or subitem.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">image</emphasis></term>
          <listitem>
          <para>
            The index in the image list for the icon, (both big and small,) for the item. If the item does not have an
            icon in image list, the value will be -1.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">state</emphasis></term>
          <listitem>
          <para>
            Zero or more blank separated keywords indicating the state of the item. The possible state keywords are:
            <variablelist>
              <varlistentry><term><emphasis role="bold">CUT</emphasis></term>
              <listitem>
              <para>
                The item is marked for a cut-and-paste operation.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">DROP</emphasis></term>
              <listitem>
              <para>
                The item is highlighted as a drag-and-drop target.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">FOCUSED</emphasis></term>
              <listitem>
              <para>
                The item has the focus, so it is surrounded by a standard focus rectangle. Although more than one item
                may be selected, only one item can have the focus.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">SELECTED</emphasis></term>
              <listitem>
              <para>
                The item is selected. The appearance of a selected item depends on whether it has the focus and also on
                the system colors used for selection.
              </para>
              </listitem></varlistentry>
            </variablelist>
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>subitem [optional]</term>
      <listitem>
      <para>
        The one-based index of a subitem. If <emphasis role="italic">subitem</emphasis> is omitted, or zero, the
        information for the item with the <emphasis role="italic">index</emphasis> specified is retrieved. If a subitem
        index is specified, the information for the item's specified subitem is retrieved instead.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success and <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example displays information on a selected item in the list-view:
<programlisting>
<![CDATA[

::method displayItemInfo

  listView = self~newListView(IDC_LV_JOBS_PER_STATE)

  title = "Selected Item Information"
  buttons = "ok"
  icon = "information"

  item = listView~selected
  if item == -1 then do
    msg = "No item is selected."
    buttons = "cancelTryContinue"
  end
  else do
    d = .Directory~new
    if listView~getItemInfo(item, d) then do
      msg = "Item Text  : "d~text   || .endOfLine || -
            "Image Index: "d~image  || .endOfLine || -
            "Item State : "d~state
    end
    else do
      msg = "Windows API error. No information available."
      buttons = "abortRetryIgnore"
      icon = "error"
    end
  end

  return MessageDialog(msg, self~hwnd, title, buttons, icon)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getItemInfo() -->

<section id="mthGetItemPos" xreflabel="getItemPos"><title>getItemPos</title>
<indexterm><primary>getItemPos</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getItemPos</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemPos(--index--)------------------------><

]]>
</programlisting>

<para>
  Retrieves the <xref linkend="defClientArea"/> coordinates of an item in a list-view control as a
  <computeroutput>Point</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single arguments is:
    <variablelist>
      <varlistentry><term>index</term>
      <listitem>
      <para>
        The zero-based index of the item whose position is needed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns a <xref linkend="clsPoint"/> object containing the position of the upper left corner
    of the item specified, relative to the client area of the list-view.
  </para>
  <para>
    On error, 0 is returned. See the remarks
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Since quite often list-view controls contain more items than can fit in the client area of the list-view, the
    position returned by <emphasis role="italic">getItemPos</emphasis> may be outside of the client area rectangle. This
    implies that both the x and y coordinates in the returned position may be negative. For instance, take a list-view
    that has 400 items and more columns than fit in the list-view. If the user has scrolled the list-view all the way
    to the bottom right and <emphasis role="italic">getItemPos</emphasis> is used to get the position of item 5, both
    the x and y position will be negative.
  </para>
  <para>
    Experimentation has shown that if the <emphasis role="italic">index</emphasis> specified is larger than the actual
    number items in the list-view, the list-view still returns a position. The position seems to be correct for the
    <emphasis role="italic">index</emphasis>, if the list-view did have that item. Because of this, it seems unlikely
    this method will ever fail.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getItemPos() -->

<section id="mthGetItemRect" xreflabel="getItemRect"><title>getItemRect</title>
<indexterm><primary>getItemRect</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getItemRect</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemRect(--index--+---------+--)----------><
                         +-,-part--+
]]>
</programlisting>

<para>
  Gets the bounding <xref linkend="ovvRectangleCoordinates"/> for all or part of an item in the current view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>index [required]</term>
    <listitem>
    <para>
      The index of the list-view item that contains the subitem whose bounding rectangle is to be retrieved.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>part [optional]</term>
    <listitem>
    <para>
      Keyword indicating which part of the item rectangle is sought. Use exactly one of the following keywords, case is not
      significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>BOUNDS      </member>
        <member>ICON        </member>
        <member>LABEL       </member>
        <member>SELECTBOUNDS</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>BOUNDS</term>
        <listitem>
        <para>
          Returns the bounding rectangle of the entire item, including the icon and label. This is the default if this
          argument is omitted.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ICON</term>
        <listitem>
        <para>
          Returns the bounding rectangle of the icon or small icon.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LABEL</term>
        <listitem>
        <para>
          Returns the bounding rectangle of the item text.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SELECTBOUNDS</term>
        <listitem>
        <para>
          Returns the union of the ICON and LABEL rectangles, but excludes columns in report view.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The specified bounding rectangle, as a <xref linkend="clsRect"/> object, on success, the
    <computeroutput>nil</computeroutput> object on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Note that a bounding <xref linkend="ovvRectangleCoordinates"/> is different than a <emphasis
    role="italic">point / size</emphasis> rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is a snippet of code that overlays a combo box on top of a list-view. The combo box is sized to occupy the
    area of the label of the list-view item at <emphasis role="italic">itemIndex</emphasis>. Note that the combo box's height
    is set to 4 times the hit of the list-view item. When the combo box is first shown, it does not show the drop-down list
    and its height is very close to the height of the list-view item.  However, its height is restricted to the height of the
    item, the drop-down list will not show when the user clicks on the down arrow icon. Setting its height larger allows the
    drop-down list to open and show 3 items:
<programlisting>
<![CDATA[

  ...

  r = list~getItemRect(itemIndex, 'LABEL')
  ret = cb~setWindowPos(list~hwnd, r~left, r~top, r~right - r~left, 4 * (r~bottom - r~top), "SHOWWINDOW NOZORDERCHANGE")
  cbVisible = .true
  cb~assignFocus

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getItemRect() -->

<section id="mthGetSubitem" xreflabel="getSubitem"><title>getSubitem</title>
<indexterm><primary>getSubitem</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getSubitem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getSubitem(--_item--+----------------+--)----><
                        +-,-subItemIndex-+
]]>
</programlisting>

<para>
  Receives some, or all, of the information of a subitem of a list-view item. The information is returned as a <link
  linkend="clsLvSubItem">LvSubItem</link> object. The subitem is specified by either a
  <computeroutput>LvSubItem</computeroutput> object, or by a item index / subitem index combination.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
    <variablelist>
      <varlistentry><term>_item [required]</term>
      <listitem>
      <para>
        Specifies the item whose subitem information is to be retrieved.
      </para>
      <para>
        If <emphasis role="italic">_item</emphasis> is a <computeroutput>LvSubItem</computeroutput> object, then the
        <emphasis role="italic">item</emphasis> and <emphasis role="italic">subItem</emphasis> attributes of the
        <computeroutput>LvSubItem</computeroutput> object specify which subitem to query. The <emphasis
        role="italic">mask</emphasis> attribute specifies which information is desired.
      </para>
      <para>
        If the <emphasis role="italic">_item</emphasis> argument is not a <computeroutput>LvSubItem</computeroutput> object,
        then it must be the zero-based index of the item to query and the <emphasis role="italic">subItemIndex</emphasis>
        argument must be the one-based index of the subitem.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>subitemIndex [optional]</term>
      <listitem>
      <para>
        Specifies the index of the subitem. If <emphasis role="italic">_item</emphasis> is a
        <computeroutput>LvSubItem</computeroutput> object then the <emphasis role="italic">subitemIndex</emphasis> is
        ignored. If <emphasis role="italic">_item</emphasis> is not a <computeroutput>LvSubItem</computeroutput> object then
        <emphasis role="italic">subitemIndex</emphasis> is required and specifies the one-based index of the subitem to be
        queried.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    When the <emphasis role="italic">_item</emphasis> argument is a <computeroutput>LvSubItem</computeroutput> object then
    this method returns true on success and false on error. On success, the attributes of <emphasis
    role="italic">_item</emphasis> reflect the information queried of the subitem.  On error, the value of the attributes of
    <emphasis role="italic">_item</emphasis> are undefined.
  </para>
  <para>
    When the <emphasis role="italic">_item</emphasis> argument is not a <computeroutput>LvSubItem</computeroutput> object
    then, on success, this method returns a <computeroutput>LvItem</computeroutput> object whose attributes reflect the
    attributes of the list-view subitem. On error, the <computeroutput>.nil</computeroutput> object is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks</emphasis></term>
  <listitem>
  <para>
    The choice of whether to use a <computeroutput>LvItem</computeroutput> object or an item index / subitem index
    combination to specify which subitem to query is up to the programmer. It is dependent on which seems the most convenient
    to the programmer for the task.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example queries subitem 2 of the item at index 8 of the list-view for just its image index. On return, the <emphasis
    role="italic">imageIndex</emphasis> attribute of the <xref linkend="clsLvSubItem"/> object will reflect the image index
    of the specified subitem.  The value of the <emphasis role="italic">text</emphasis> attribute is undefined:

<programlisting>
<![CDATA[

  lvSubItem = .LvSubItem~new(8, 2, , , 'IMAGE')
  if list~getSubItem(lvSubItem) then do
      -- Do something with the information.
      ...
  end
]]>
</programlisting>
  </para>

<para>
  This example queries the same subitem by using the item / subitem indexes. On success a <xref linkend="clsLvSubItem"/>
  object is returned that reflects all the information for the subitem.

<programlisting>
<![CDATA[

  lvSubItem = list~getSubItem(8, 2)
  if lvSubItem \== .nil then do
      -- Do something with the LvSubItem object.
      ...
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getSubitem() -->

<section id="mthGetSubitemRect" xreflabel="getSubitemRect"><title>getSubitemRect</title>
<indexterm><primary>getSubitemRect</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getSubitemRect</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getSubitemRect(--index-,-subitemIdx--+---------+--)---------><
                                         +-,-part--+
]]>
</programlisting>

<para>
  Gets the bounding <xref linkend="ovvRectangleCoordinates"/> for all or part of a subitem in the current view
  of this list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>index [required]</term>
    <listitem>
    <para>
      The index of the list-view item that contains the subitem whose bounding rectangle is to be retrieved.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>subitemIdx [required]</term>
    <listitem>
    <para>
      The index of the list-view subitem that contains the subitem whose bounding rectangle is to be retrieved. This index,
      may be 0, in which case, the <emphasis role="italic">getSubitemRect</emphasis> method works exactly the same as the
      <xref linkend="mthGetItemRect"/>, except that the SELECTBOUNDS keyword is not accepted.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>part [optional]</term>
    <listitem>
    <para>
      Keyword indicating which part of the item rectangle is sought. Use exactly one of the following keywords, case is not
      significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>BOUNDS      </member>
        <member>ICON        </member>
        <member>LABEL       </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>BOUNDS</term>
        <listitem>
        <para>
          Returns the bounding rectangle of the entire subitem, including the icon and label. This is the default if this
          argument is omitted.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ICON</term>
        <listitem>
        <para>
          Returns the bounding rectangle of the icon or small icon of the subitem.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LABEL</term>
        <listitem>
        <para>
          Returns the bounding rectangle of the subitem text.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The specified bounding rectangle, as a <xref linkend="clsRect"/> object, on success, the
    <computeroutput>nil</computeroutput> object on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
      Note that a bounding <xref linkend="ovvRectangleCoordinates"/> is different than a <emphasis
      role="italic">point / size</emphasis> rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later. Or</emphasis>, if the Rexx program is running on an earlier
    version of Windows, the list-view <emphasis role="bold">must</emphasis> be in report view.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is a snippet of code that overlays a combo box on top of a list-view. The combo box is sized to occupy the
    area of the label of the list-view subitem at the specified item index and subitem index. Note that the combo box's
    height is set to 4 times the hit of the list-view subitem. When the combo box is first shown, it does not show the
    drop-down list and its height is very close to the height of the list-view subitem.  However, its height is restricted to
    the height of the subitem, the drop-down list will not show when the user clicks on the down arrow icon. Setting its
    height larger than the subitem allows the drop-down list to open and show 3 items:
<programlisting>
<![CDATA[

  ...

  if columnIndex > 0 then do
      r = list~getSubitemRect(itemIndex, columnIndex, 'LABEL')
      ret = cb~setWindowPos(list~hwnd, r~left, r~top, r~right - r~left, 4 * (r~bottom - r~top), "SHOWWINDOW NOZORDERCHANGE")
      cbVisible = .true
      cb~assignFocus
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getSubitemRect() -->

<section id="mthGetToolTipsClsListview" xreflabel="getToolTips"><title>getToolTips</title>
<indexterm><primary>getToolTips</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getToolTips</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getToolTips----------------------------------><
]]>
</programlisting>

<para>
  Retrieves the child <link linkend="clsToolTip">ToolTip</link> control used by this list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the child Rexx <computeroutput>ToolTip</computeroutput> object, or the <computeroutput>.nil</computeroutput>
    object if the list-view does not have a child tool tip control.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getToolTips() -->

<section id="mthGetView" xreflabel="getView"><title>getView</title>
<indexterm><primary>getView</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>getView</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getView--------------------------------------><
]]>
</programlisting>

<para>
  Retrieves the current view of this list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a keyword indicating the current view of this list-view.
  </para>
  <para>
    <simplelist type='vert' columns='3'>
      <member>ICON     </member>
      <member>SMALLICON</member>
      <member>LIST     </member>
      <member>REPORT   </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>ICON</term>
      <listitem>
      <para>
        The list-view is in icon view. Each item appears as a full-sized icon with a label below it.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SMALLICON</term>
      <listitem>
      <para>
        The list-view is in small icon view.  Each item appears as a small icon with the label to the right of it.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>LIST</term>
      <listitem>
      <para>
        The list-view is in list view. Each item appears as a small icon with a label to the right of it. Items are arranged
        in columns.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>REPORT</term>
      <listitem>
      <para>
        The list-view is in report view. Each item appears on its own line, with information arranged in columns.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Use the <xref linkend="mthSetView"/> method to change the current view in the list-view.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::getView() -->


<section id="mthHasCheckBoxes" xreflabel="hasCheckBoxes"><title>hasCheckBoxes</title>
<indexterm><primary>hasCheckBoxes</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>hasCheckBoxes</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hasCheckBoxes--------------------------------><

]]>
</programlisting>

<para>
  Determines if the list-view has the CHECKBOXES extended style.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if the list-view has the CHECKBOXES extended style, otherwise
    <computeroutput>.false</computeroutput> .
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Listview::hasCheckBoxes() -->

<section id="mthHitTestInfoClsListView" xreflabel="hitTestInfo"><title>hitTestInfo</title>
<indexterm><primary>hitTestInfo</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>hitTestInfo</secondary></indexterm>
<programlisting>
<![CDATA[

Form 1:

>>--hitTestInfo(--pos--+---------+--)------------><
                       +-,-info--+

Form 2:

>>--hitTestInfo(--x--,--y--+---------+--)--------><
                           +-,-info--+

Generic Form:

>>--hitTestInfo(--hitPoint--+---------+--)-------><
                            +-,-info--+

]]>
</programlisting>

<para>
  Determines which list-view item, if any, is at the specified position.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>hitPoint [required]</term>
      <listitem>
      <para>
        The point, in client <xref linkend="defScreenCoordinates"/>, to test.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>info [optional in / out]</term>
      <listitem>
      <para>
        A <computeroutput>.Directory</computeroutput> object in which additional information concerning the hit test
        will be returned. This argument can be omitted if the additional information is not needed. When the argument is
        used, on return <emphasis role="italic">info</emphasis> will contain some, or all, of the following indexes,
        depending on the version of Windows:
      </para>
      <variablelist>
        <varlistentry><term>INFO</term>
        <listitem>
        <para>
          A string of keywords containing information about the hit test. One or more of the following keywords will be
          present:
        </para>
        <para>
          <simplelist type='vert' columns='3'>
            <member>Above      </member>
            <member>Below      </member>
            <member>ToRight    </member>
            <member>ToLeft     </member>
            <member>Nowhere    </member>
            <member>OnIcon     </member>
            <member>OnLabel    </member>
            <member>OnStateIcon</member>
            <member>OnItem     </member>
          </simplelist>
          <variablelist>
            <varlistentry><term>Above</term>
            <listitem>
            <para>
              The position is above the list-view's client area.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>Below</term>
            <listitem>
            <para>
              The position is below the list-view's client area.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>ToRight</term>
            <listitem>
            <para>
              The position is to the right of the list-view's client area.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>ToLeft</term>
            <listitem>
            <para>
              The position is to the left of the list-view's client area.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>Nowhere</term>
            <listitem>
            <para>
              The position is inside the list-view control's client window, but it is not over a list item.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>OnIcon</term>
            <listitem>
            <para>
              The position is over a list-view item's icon.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>OnLabel</term>
            <listitem>
            <para>
              The position is over a list-view item's text.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>OnStateIcon</term>
            <listitem>
            <para>
              The position is over the state image of a list-view item.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>OnItem</term>
            <listitem>
            <para>
              The position is over a list-view item. This is a combination of <emphasis role="italic">OnIcon</emphasis>,
              or <emphasis role="italic">OnLabel</emphasis>, or <emphasis role="italic">OnStateIcon</emphasis>.
            </para>
            </listitem></varlistentry>
          </variablelist>
        </para>
        </listitem></varlistentry>
        <varlistentry><term>INFOEX</term>
        <listitem>
        <para>
          This index will only be present on Vista or later and is a string of keywords containing extended information
         about the hit test. The index may contain one or more of the following keywords:
        </para>
        <para>
          <simplelist type='vert' columns='3'>
            <member>Footer         </member>
            <member>Group          </member>
            <member>GroupBackground</member>
            <member>GroupCollapse  </member>
            <member>GroupFooter    </member>
            <member>GroupHeader    </member>
            <member>GroupStateIcon </member>
            <member>GroupSubsetLink</member>
            <member>OnContents     </member>
          </simplelist>
          <variablelist>
            <varlistentry><term>Footer</term>
            <listitem>
            <para>
              The point is within the footer of the list-view control.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>Group</term>
            <listitem>
            <para>
              The point is within a group. This is a combination of <emphasis role="italic">GroupBackground</emphasis>,
              or <emphasis role="italic">GroupCollapse</emphasis>, or <emphasis
              role="italic">GroupFooter</emphasis>, or <emphasis role="italic">GroupHeader</emphasis>, or <emphasis
              role="italic">GroupStateIcon</emphasis>, or <emphasis role="italic">GroupSubsetLink</emphasis>.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>GroupBackground</term>
            <listitem>
            <para>
              The point is within the area of the group where items are displayed.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>GroupCollapse</term>
            <listitem>
            <para>
              The point is within the collapse/expand button of the group.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>GroupFooter</term>
            <listitem>
            <para>
              The point is within the group footer.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>GroupHeader</term>
            <listitem>
            <para>
              The point is within the group header.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>GroupStateIcon</term>
            <listitem>
            <para>
              The point is within the state icon of the group.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>GroupSubsetLink</term>
            <listitem>
            <para>
              The point is within the subset link of the group.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>OnContents</term>
            <listitem>
            <para>
              The point is within the icon or text content of the item and not on the background.
            </para>
            </listitem></varlistentry>
          </variablelist>
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ITEM</term>
        <listitem>
        <para>
          The index of the item if the point hits an item or subitem. -1 if the point did not hit an item or subitem.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SUBITEM</term>
        <listitem>
        <para>
          The subitem index if the point hits a subitem, otherwise 0.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>GROUP</term>
        <listitem>
        <para>
          Vista or later only. The group index of the item hit. This is valid only for owner data. If the point is
          within an item that is displayed in multiple groups then GROUP will specify the group index of the item.
        </para>
        </listitem></varlistentry>
      </variablelist>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The index of the list-view item hit, or -1 if the point does not hit an item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Note</emphasis> that the values in the <computeroutput>Directory</computeroutput> object reflect
    what the operating system returns. Experimentation shows that the values returned can vary depending on the version of
    Windows a program is executing on. Some values also differ depending on the style(s) of the list-view. For instance, the
    presence or absence of the <link linkend="mthAddExtendedStyle">extended</link> FULLROWSELECT style changes some of the
    values when hit testing the exact same spot. In addition, Microsoft documents some values, such as ABOVE, that are never
    seen during testing.
  </para>
  <para>
    Sometimes the returned index of the hit spot is all that is needed. In these cases, there is no need to supply the
    optional <computeroutput>.Directory</computeroutput> object.  However, other times the complete hit test information
    may be desired.
  </para>
  <para>
    Any x, y coordinates will work.  I.e. -6000, -7000 will work. The item index will be -1 and location will be
    <emphasis role="italic">Above ToLeft</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from a program that allows the user to edit the text of subitems. The code snippet checks if the
    point p is over an item's subitem and if so invokes the editing method:
<programlisting>
<![CDATA[

  listView = self~newListView(IDC_LV_PLAYERS)

  d = .Directory~new
  index = listView~hitTestInfo(p, d)
  if index <> -1 & d~subItem <> 0 then do
    self~subItemEdit(index, d~subItem)
    ...
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::hitTestInfo() -->

<section id="mthInsertClsListControl" xreflabel="insert"><title>insert</title>
<indexterm><primary>insert</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insert(--+------+--,--+---------+--,--text--+--------+--)---><
             +-item-+     +-subitem-+           +-,-icon-+

]]>
</programlisting>

<para>
  The <computeroutput>insert</computeroutput> method inserts a new item into the list-view control, or
  inserts the text of a subitem.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem>
<para>
  The index of the item to insert or the item whose subitem text is inserted.
</para>
<para>
  When this argument is omitted <emphasis role="bold">and</emphasis> <emphasis
  role="italic">subitem</emphasis> is omitted or 0, ooDialog uses the index of the last item added to the
  list-view control, plus 1, as the item index. If the argument is omitted and <emphasis
  role="italic">subitem</emphasis> is greater than 0, then the index of the last item added is used. If
  no items have yet been added, then 0 is used.
</para>
</listitem></varlistentry>
<varlistentry><term>subitem</term>
<listitem>
<para>
  The subitem number. This argument is used to insert the text for a subitem of the item. In report view,
  the label (text) for the item is placed in column 0. The text for subitem 1 is placed in column 1, the
  text for subitem 2 is placed in column 2, and so on. If you omit this argument, or use 0, the
  <emphasis role="italic">text</emphasis> argument is assigned as the label (text) of the item. If you
  use this argument and it is greater than 0, then the <emphasis role="italic">text</emphasis> argument
  is assigned as the text of that subitem. <emphasis role="bold">Note</emphasis> that when this argument
  is greater than 0, no new item is inserted into the list-view. Rather, the text of the subitem is
  inserted into an existing list-view item.
</para>
</listitem></varlistentry>
<varlistentry><term>text</term>
<listitem>
  <para>
    The text of the item, or of the subitem, depending on the <emphasis role="italic">subitem</emphasis>
    argument.
</para>
</listitem></varlistentry>
<varlistentry><term>icon</term>
<listitem>
<para>
  The index of the icon within the image list for this item. Use the
 <xref linkend="mthSetImageListClsListView"/>() method to assign an image list to the
  list-view control. With <computeroutput>setImageList</computeroutput>(), use the LVSIL_SMALL type to
  set the image list for the small icons and the LVSIL_NORMAL type for the normal size icon image list.
</para>
<para>
  The normal size icons are used for the icon view and the small icons are used for the list, report, and
  small-icon views. Note that there is only one index for each list-view item. This implies that the
  normal icon for an item must be at the same index in the normal image list as the small icon is at in
  the small icon image list.
</para>
<para>
  Use -1 or simply omit this argument to indicate there is no icon for the item being inserted. This
  argument is ignored completely if <emphasis role="italic">subitem</emphasis> is greater than 0.
</para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The index of the new item, or -1 in all other cases.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example inserts items in a list:
<programlisting>
<![CDATA[
::method initReport
  curList = self~newListView(102)
  if curList \= .nil then
  do
    curList~insert(, ,"First")
    curList~insert(, ,"Second")
    curList~insert(, ,"Third")
  end
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthInsertColumn" xreflabel="insertColumn"><title>insertColumn</title>
<indexterm><primary>insertColumn</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>insertColumn</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertColumn(--+----------+-txt-,-width-+-------+-+------------------+--)--><
                   +--colIdx--+             +-,-fmt-+ +-,-adjustFullRows-+
]]>
</programlisting>

<para>
  Inserts a new column into this list-view, using <link linkend="defDialogUnit">dialog</link> units to specify the width.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>colIdx [optional]</term>
    <listitem>
    <para>
      The zero-based index of the column to insert. The default if this argument is omitted is 0.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>txt [required]</term>
    <listitem>
    <para>
      The text, the label, for the column. The text for the column must be less than 256 characters long.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>width [required]</term>
    <listitem>
    <para>
      The width, in dialog units, for the inserted column.
    </para>
    <para>
      The width value will usually produce <xref linkend="ovvInaccurate"/> results because it is converted to pixels using
      <xref linkend="atrFactorX"/>. The operating system requires the width be specified in pixels. The programmer is advised
      to use the <xref linkend="mthInsertColumnPX"/> method instead, which will correctly assign the width.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>ftn [optional]</term>
    <listitem>
    <para>
      A keyword specifying the format for the column. Use exactly one of the following keywords:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>CENTER</member>
        <member>LEFT  </member>
        <member>RIGHT </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>CENTER</term>
        <listitem>
        <para>
          Text of the column is center aligned
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LEFT</term>
        <listitem>
        <para>
          Text of the column is left aligned. This is the default if the <emphasis role="italic">fmt</emphasis> argument is
          omitted.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RIGHT</term>
        <listitem>
        <para>
          Text of the column is right aligned.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>adjustFullRows [optional]</term>
    <listitem>
    <para>
      If <emphasis role="italic">adjustFullRows</emphasis> is true, the ooDialog framework attempts to fix up the <xref
      linkend="clsLvFullRow"/> objects assigned to the item <link linkend="mthSetItemDataClsListView">data</link> of each
      list-view item. Nothing is done if the arguemnt is false. The default is false. This argument is only used to support
      <link linkend="sctInternalSorting">internal</link> sorting. If the application is not using internal sorting then this
      argument should just be ignored.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the column index of the inserted column on success, -1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If <emphasis role="italic">colIdx</emphasis> is greater than the current number of columns then the method does not
    fail. Rather, the operating system adds the column as the last column rather that at the index specified. I.e., if
    there currently are 2 columns, (column 0 and column 1,) and <emphasis role="italic">colIndex</emphasis> is 3, the
    operating system adds the column at index 2 rather than index 3.
  </para>
  <para>
    Only use the <emphasis role="italic">adjustFullRows</emphasis> argument to adjust the
    <computeroutput>LvFullRow</computeroutput> objects if every list-view item has a
    <computeroutput>LvFullRow</computeroutput> item assigned as the item data, and the programmer has kept the full rows
    consistent with changes to the column count of this list-view. If these conditions are not met, this method will return
    an error code, even if the column was inserted successfully. However, no harm is done, it will just make it hard to tell
    between a successful execution of the method and an error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::insertColumn() -->


<section id="mthInsertColumnPX" xreflabel="insertColumnPX"><title>insertColumnPX</title>
<indexterm><primary>insertColumnPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>insertColumnPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertColumnPX(-+--------+-,-txt-,-width-+-------+-+------------------+-)--><
                    +-colIdx-+               +-,-fmt-+ +-,-adjustFullRows-+
]]>
</programlisting>

<para>
  Inserts a new column into the list-view specifying the column width in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
    <variablelist>
      <varlistentry><term>colIdx [optional]</term>
      <listitem>
      <para>
        The zero-based index for the column being inserted. Columns are numbered from the left to the right. The default
        if this argument is omitted is column 0.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>txt [required]</term>
      <listitem>
      <para>
        The text (label) for the column. The text for the column must be less than 256 characters long.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>width [required]</term>
      <listitem>
      <para>
        The width of the column being inserted, specified in pixels.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fmt [optional]</term>
      <listitem>
      <para>
        One of the following keywords, case is not significant. The keyword specifies the format for the column being
        inserted. At this time not all formats for the column are recognized. Other format keywords may be added in the
        future.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>LEFT  </member>
          <member>CENTER</member>
          <member>RIGHT </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>LEFT</term>
          <listitem>
          <para>
            Text in the column is aligned to the left. This is the default if this argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CENTER</term>
          <listitem>
          <para>
            The text for the column is centered.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RIGHT</term>
          <listitem>
          <para>
            The text for the column is aligned right.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>adjustFullRows [optional]</term>
      <listitem>
      <para>
        If <emphasis role="italic">adjustFullRows</emphasis> is true, the ooDialog framework attempts to fix up the <xref
        linkend="clsLvFullRow"/> objects assigned to the item <link linkend="mthSetItemDataClsListView">data</link> of each
        list-view item. Nothing is done if the arguemnt is false. The default is false. This argument is only used to support
        <link linkend="sctInternalSorting">internal</link> sorting. If the application is not using internal sorting then this
        argument should just be ignored.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the index of the newly inserted column on success, otherwise -1.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
     The inserted columns are only visible when the list-view is in report view, but, columns can be inserted into the
     list-view control when it is in any view.
  </para>
  <para>
    This method and the <xref linkend="mthInsertColumn"/> method are virtually the same, except that
    in this method the width of the column is specified in pixels. The <emphasis role="italic">insertColumn</emphasis>
    method takes dialog units for the width and then converts them to pixels using an <xref linkend="ovvInaccurate"/> method.
    This makes the width used by the <emphasis role="italic">insertColumn</emphasis> method inaccurate.
  </para>
  <para>
    <emphasis role="bold">Note</emphasis> that previous versions of this documentation incorrectly stated that the
    <emphasis role="italic">insertColumn</emphasis> used pixels to specify the width.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example inserts 3 columns into the list-view control. Each column will be 50 pixels wide and left aligned.
<programlisting>
<![CDATA[

::method initReportView
  lv = self~newListView(IDC_LV_STATS)

  lv~insertColumnPX(0, "First Name", 50)
  lv~insertColumnPX(1, "Last Name", 50)
  lv~insertColumnPX(2, "Age", 50)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::insertColumnPX() -->


<section id="mthInsertFullRow" xreflabel="insertFullRow"><title>insertFullRow</title>
<indexterm><primary>insertFullRow</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>insertFullRow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertFullRow(--row--)-----------------------><
]]>
</programlisting>

<para>
  Adds an item to the list-view by inserting it into the list at the position specified by the <emphasis
  role="italic">row</emphasis> argument.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>row [required]</term>
      <listitem>
      <para>
        A <link linkend="clsLvFullRow">LvFullRow</link> object that specifies the item to be added to the list-view.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the zero-based index of the added row. On error, -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a full row object is used to add an item to the list view, all the subitems are also added. The <emphasis
    role="italic">insertFullRow</emphasis> method always inserts the item into the list at the position specified in the
    full row object. The item index in the subitems in the full row object are ignored. After the item is inserted, the
    item indexes in the subitems are updated to the correct value of the newly added item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example constructs a full row object and inserts it into the list-view. The row is inserted at index 120 of the
    list-view:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(120, "Business manager", 6)
  lvSub1 = .LvSubItem~new(120, 1, "Tom", 14)
  lvSub2  = .LvSubItem~new(120, 2, "Sawyer", 26)
  lvSub3  = .LvSubItem~new(120, 3, "ts@google.com", 11)
  lvFullRow = .LvFullRow~new(lvItem, lvSub1, lvSub2, lvSub3, .true)
  list~insertFullRow(lvFullRow)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::insertFullRow() -->

<section id="mthIsCheckedClsListControl" xreflabel="isChecked"><title>isChecked</title>
<indexterm><primary>isChecked</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>isChecked</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~isChecked(--index--)-------------><

]]>
</programlisting>

<para>The <computeroutput>isChecked</computeroutput> method determines if a
check box for a list-view item is checked or not.  This method will always
return true or false.  It can be used if the list-view control has or does not
have the check boxes extended style. (See the
<xref linkend="mthAddExtendedStyle"/> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item to query.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>true</term>
<listitem><para>The list-view item has a check box and it is checked.
</para></listitem></varlistentry>
<varlistentry><term>false</term>
<listitem><para>There is no check mark for the list-view item.  Either the list
view has check boxes and the check box is not checked, the index is out of range
or not valid, or the list-view does not have the check box extended style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a doctor's office custom
accounting application.  A list box is filled with information for every
patient.  After the office manager has finished working with the accounts a
mail merge is done to produce statements for all patients that are to receive
statements for the month.  For every patient item in the list-view, if the item
has a check mark, then that patient is mailed a statement.
<programlisting> <![CDATA[

::method onCreateMailMerge
  expose patientList

  do i = 0 to patientList~items
    if billingList~isChecked(i) then do
      self~addToMailMerge(billingList, i)
    end
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthItemInfo" xreflabel="itemInfo"><title>itemInfo</title>
<indexterm><primary>itemInfo</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[

>>--itemInfo(--item--,--+--------+--)------------><
                        +-column-+


]]>
</programlisting>

<para>
  The itemInfo method retrieves the attributes of a list-view item as a <computeroutput>Stem</computeroutput> object.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>column</term>
<listitem><para>The number of the column. If you omit this argument, 0 is assumed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
  A compound variable that stores the attributes of the item, or -1 in all other cases. The compound
  variable can be:
<variablelist>
<varlistentry><term>RetStem.!TEXT</term>
<listitem><para>The item text.
</para></listitem></varlistentry>
<varlistentry><term>RetStem.!IMAGE</term>
<listitem><para>
  The index of the icon in the image list this for item. Image lists are assigned to list-views using the
 <xref linkend="mthSetImageListClsListView"/>() method.
</para>
<para>
  In report view, this index is only used for the icon for the first column. ooDialog does not yet
  support setting the icon index for the other columns in a report view.
</para>
</listitem></varlistentry>
<varlistentry><term>RetStem.!STATE</term>
<listitem><para>One or more of the following values:
<variablelist>
<varlistentry><term>CUT</term>
<listitem><para>The item is marked for a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>DROPPED</term>
<listitem><para>The item is highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>FOCUSED</term>
<listitem><para>The item has the focus and is therefore surrounded by the standard focus
rectangle. Only one item can have the focus.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected. Its appearance depends on whether it has the focus
and on the system colors used for a selection.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthItemPos" xreflabel="itemPos"><title>itemPos</title>
<indexterm><primary>itemPos</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~itemPos(--item--)----------------><


]]>
</programlisting>

<para>The itemPos method retrieves the position of the
upper left corner of the item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The x- and y-coordinates of the upper left corner of the item, or -1
if you did not specify <emphasis role="italic">item</emphasis>, or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Use <xref linkend="mthDefListDragHandler"/> to support default dragging:
</para></note>
<programlisting>
<![CDATA[
self~connectListViewEvent(104,"BEGINDRAG","mthDefListDragHandler")
]]>
</programlisting>
</section>

<section id="mthItemsClsListView" xreflabel="items"><title>items</title>
<indexterm><primary>items</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Items----------------------------><


]]>
</programlisting>

<para>The items method retrieves the number of items
in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthItemsPerPage" xreflabel="itemsPerPage"><title>itemsPerPage</title>
<indexterm><primary>itemsPerPage</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~ItemsPerPage---------------------><


]]>
</programlisting>

<para>The itemsPerPage method calculates the number of
items that vertically fit the visible area of a list-view control that is
in list or report view. Only fully visible items are counted.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of fully visible items. If the current view is an icon or
small-icon view, the return value is the total number of items in the list
view control.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthItemState" xreflabel="itemState"><title>itemState</title>
<indexterm><primary>itemState</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~itemState(--item--)--------------><


]]>
</programlisting>

<para>The itemState method retrieves the state of a list
view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The state of the item, which can be one or more of the following values:
<variablelist>
<varlistentry><term>CUT</term>
<listitem><para>The item can be used in a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>DROPPED</term>
<listitem><para>The item is highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>FOCUSED</term>
<listitem><para>The item has the focus and is therefore surrounded by the standard focus
rectangle. Only one item can have the focus.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected. Its appearance depends on whether it has the focus
and on the system colors used for a selection.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthItemText" xreflabel="itemText"><title>itemText</title>
<indexterm><primary>itemText</primary></indexterm>
<programlisting>
<![CDATA[
                                    +-0------+
>>-aListControl~itemText(--item--,--+--------+--)---------------><
                                    +-column-+


]]>
</programlisting>

<para>The itemText method retrieves the text of a list
view item or a column.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>column</term>
<listitem><para>The number of the column. If you omit this argument, 0 is assumed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The item or column text, or -1 if you did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthLast" xreflabel="last"><title>last</title>
<indexterm><primary>last</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Last-----------------------------><


]]>
</programlisting>

<para>The last method retrieves the number of the last
item in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the last item.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthLastSelected" xreflabel="lastSelected"><title>lastSelected</title>
<indexterm><primary>lastSelected</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~LastSelected---------------------><


]]>
</programlisting>

<para>The lastSelected method returns the number of the
item selected last.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item selected last, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthModify" xreflabel="modify"><title>modify</title>
<indexterm><primary>modify</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modify(--+------+--,--+---------+--,--text--+--------+--)---><
             +-item-+     +-subitem-+           +-,-icon-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">modify</emphasis> method modifies or sets the text for the item label, or
  the text for a subitem, for a list-view item. Optionally, it sets or modifies the icon index for a
  list-view item.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>item [optional]</term>
    <listitem>
    <para>
      The index of the item to be modified. If this argument is omitted, the selected item is used.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>subitem [optional]</term>
    <listitem>
    <para>
      This method works in a similar manner as the <xref linkend="mthInsertClsListControl"/>()
      method. The use of the <emphasis role="italic">subitem</emphasis> argument controls whether the
      <emphasis role="italic">text</emphasis> argument applies to the label of the item or the text of a
      subitem. When <emphasis role="italic">subitem</emphasis> is omitted or 0, then the label of the item is
      set to <emphasis role="italic">text</emphasis>. When <emphasis role="italic">subitem</emphasis> is
      greater than 0, then the text of that subitem is set to <emphasis role="italic">text</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The new text for the item label, or the new text for the subitem of the item, depending on the value of
      <emphasis role="italic">subitem</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>icon [optional]</term>
    <listitem>
    <para>
      The new index of the icon for the item within the image list assigned to the list-view. Image lists are
      assigned with the <xref linkend="mthSetImageListClsListView"/>() method. When
      assigning the image list with <computeroutput>setImageList</computeroutput>(), use the LVSIL_NORMAL
      flag for the icon view icons and the LVSIL_SMALL flag for the list, report, and small-icon view icons.
    </para>
    <para>
      Use -1 or simply omit this argument to leave the icon index unchanged. If <emphasis
      role="italic">subitem</emphasis> is greater than 0, this argument is ignored.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, 1 for all errors.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example modifies the icon for an item when it is activated. A method,
    <computeroutput>onActivate</computeroutput>, is connected to the ACTIVATE notification. When an item is activated it also
    gains the focus. The <computeroutput>onActivate</computeroutput> method is invoked when an item is activated, and the
    example determines which item was activated by seeing which item has the focus:

  <programlisting>
  <![CDATA[

  ::method initDialog
    expose list

    list  = self~newListView(IDC_LV_VIEWS)
    self~connectListViewEvent(IDC_LV_VIEWS, 'ACTIVATE', 'onActivate')

    ...

  ::method onActivate
    expose list

    focusedItem = list~focused
    text = list~itemText(focusedItem)

    list~modify(focusedItem, , text, 2)

  ]]>
  </programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthModifyColumn" xreflabel="modifyColumn"><title>modifyColumn</title>
<indexterm><primary>modifyColumn</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~modifyColumn(--column--,--+------+--,--width---->
                                          +-text-+

>--+---------------------+--)-----------------------------------><
   |       +-LEFT---+    |
   +-,--"--+-CENTER-+--"-+
           +-RIGHT--+


]]>
</programlisting>

<para>The modifyColumn method sets new attributes for
a column of a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column. 0 is the first column.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>The text of the column heading. If you omit this argument, the heading
is not changed.
</para></listitem></varlistentry>
<varlistentry><term>width</term>
<listitem><para>The width of the column, in pixels.
</para></listitem></varlistentry>
<varlistentry><term>align</term>
<listitem><para>The alignment of the column heading and the subitem text within the
column. It can be one of the following values:
<variablelist>
<varlistentry><term>CENTER</term>
<listitem><para>The text is centered.
</para></listitem></varlistentry>
<varlistentry><term>LEFT</term>
<listitem><para>The text is left-aligned, which is the default.
</para></listitem></varlistentry>
<varlistentry><term>RIGHT</term>
<listitem><para>The text is right-aligned.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The column was modified.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">column</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthModifyColumnPX" xreflabel="modifyColumnPX"><title>modifyColumnPX</title>
<indexterm><primary>modifyColumnPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>modifyColumnPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modifyColumnPX(--index--+---------+--+----------+--+--------+--)-----------><
                            +-,-text--+  +-,-width--+  +-,-fmt--+
]]>
</programlisting>

<para>
  Modifies some, or all, of the attributes of an existing column in a list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index for the column being modified. Columns are numbered from the left to the right.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>text [optional]</term>
      <listitem>
      <para>
        If this argument is included, the text for the column is changed to the text specified.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>width [optional]</term>
      <listitem>
      <para>
        The new width of the column, in pixels. If the argument is omitted, the width is left unchanged.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fmt [optional]</term>
      <listitem>
      <para>
        One of the following keywords separated by spaces, case is not significant. The keyword specifies the new format
        for the column being modified. If the <emphasis role="italic">fmt</emphasis> argument is omitted, the alignment
        is left unchanged. At this time not all formats for the column are recognized. Other format keywords may be
        added in the future.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>LEFT  </member>
          <member>CENTER</member>
          <member>RIGHT </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>LEFT</term>
          <listitem>
          <para>
            Text in the column is aligned to the left.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CENTER</term>
          <listitem>
          <para>
            The text for the column is centered.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RIGHT</term>
          <listitem>
          <para>
            The text for the column is aligned right.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    0 is returned on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the title, size, and alignment of the first three columns in a list-view control.  The columns
    are only visible when the list-view is in report view.
<programlisting>
<![CDATA[

::method changeColumn
  lv = self~newListView(IDC_LV_AVAILABLE_AUTOS)
  lv~modifyColumn(0, "Make", 100, "RIGHT")
  lv~modifyColumn(1, "Model", 150, "RIGHT")
  lv~modifyColumn(1, "Color", 80, "CENTER")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::modifyColumnPX() -->

<section id="mthModifyFullRow" xreflabel="modifyFullRow"><title>modifyFullRow</title>
<indexterm><primary>modifyFullRow</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>modifyFullRow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modifyFullRow(--row--)-----------------------><
]]>
</programlisting>

<para>
  Modifies the information for an item, and all its subitems, in a list-view using a <xref linkend="clsLvFullRow"/> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>row [required]</term>
    <listitem>
    <para>
      The <emphasis role="italic">row</emphasis> argument must either be a <computeroutput>LvFullRow</computeroutput> object,
      or the zero-based index of the list-view item to be modified.
    </para>

    <variablelist>
      <varlistentry><term><emphasis role="bold">LvFullRow object:</emphasis></term>
      <listitem>
      <para>
        When the <emphasis role="italic">row</emphasis> argument is a <computeroutput>LvFullRow</computeroutput> object, the
        information in the list-view item is modified to match the information in the full row object.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">Item index:</emphasis></term>
      <listitem>
      <para>
        When the <emphasis role="italic">row</emphasis> argument is the index of the item to modify, the item <link
        linkend="mthSetItemDataClsListView">data</link> of the list-view item <emphasis role="italic">must</emphasis> have
        been assigned a <computeroutput>LvFullRow</computeroutput> object. The list-view item's information is then modified
        to match the information in the assigned full row object.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Using an item index for the <emphasis role="italic">row</emphasis> argument can be thought of as a <emphasis
    role="italic">sync</emphasis> operation. It is assumed that the programmer has changed the value of the attributes of the
    <computeroutput>LvFullRow</computeroutput> object that is assigned as the item data of the list-view item. Then, invoking
    the <emphasis role="italic">modifyFullRow</emphasis> method has the effect of syncing up the underlying list-view item's
    information with the full row object's information.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example modifies the information for the list-view item with index 3. The item has 4 subitems and uses subitem
    images. The application only wants to modify the text and image index for the item and the first subitem. The other
    information of the item is left alone. The first step of getting the full row object for item 3, ensures that all the
    information in the full row object matches the current state of the item. Then just the label and icon index for the item
    and first subitem is changed, and the full row object is used to modify the list-view item:
<programlisting>
<![CDATA[

  lvfull = list~getFullRow(3)

  lvFull~item~text = 'Nurse Practitioner'
  lvFull~item~imageIndex = 4
  lvFull~subitem(1)~text = 'Harry'
  lvFull~subitem(1)~imageIndex = 14

  list~modifyFullRow(lvFull)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::modifyFullRow() -->

<section id="mthModifyItem" xreflabel="modifyItem"><title>modifyItem</title>
<indexterm><primary>modifyItem</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>modifyItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modifyItem(--lvItem--)-----------------------><
]]>
</programlisting>

<para>
  Modifies some or all of the data this list-view maintains for an item using a <xref linkend="clsLvItem"/> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>lvItem [required]</term>
    <listitem>
    <para>
      A <computeroutput>LvItem</computeroutput> object that specifies which item to modify, what data to modify, and the new
      data for the item.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success and false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <xref linkend="atrIndexClsLvi"/> attribute of the <emphasis role="italic">lvItem</emphasis> object specifies which
    item to modify. The <xref linkend="atrMaskClsLvi"/> and <xref linkend="atrItemStateMaskClsLvi"/> attributes specify
    which attributes are valid, and the value of those attributes specifies the new data for the list-view item.
  </para>
  <para>
    For instance to modify the group ID and image index only of the list-view item at index 17, the programmer would use a
    <computeroutput>LvItem</computeroutput> object and set the <emphasis role="italic">index</emphasis> attribute to 17, set
    the <emphasis role="italic">mask</emphasis> attribute to GROUPID IMAGE, set the GroupID attribute to the new value for
    the group ID, and set the <emphasis role="italic">imageIndex</emphasis> to the new index for the image.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the process outlined in the remarks section for changing some information for the list-view item at
    index 17:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(17)
  lvItem~imageIndex = 8
  lvItem~groupID    = 101
  lvItem~mask       = "GROUPID IMAGE"

  list = self~newListView(IDC_LV_CLIENTS)

  list~modifyItem(lvItem)

]]>
</programlisting>
    Note that the <computeroutput>LvItem</computeroutput> class will automatically set the <emphasis
    role="italic">mask</emphasis> attribute correctly as the attribute values are added. So, the above code could have simply
    been:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(17)
  lvItem~imageIndex = 8
  lvItem~groupID    = 101

  list = self~newListView(IDC_LV_CLIENTS)

  list~modifyItem(lvItem)
]]>
</programlisting>
    The <emphasis role="italic">mask</emphasis> attribute was set explicitly in the first example for clarity, to show that
    only the image index and group ID would be modified.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::modifyItem() -->


<section id="mthModifySubitem" xreflabel="modifySubitem"><title>modifySubitem</title>
<indexterm><primary>modifySubitem</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>modifySubitem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modifySubitem(--lvSubitem--)-----------------><
]]>
</programlisting>

<para>
  Modifies some or all of the data this list-view maintains for a subitem of an item using a <xref linkend="clsLvSubItem"/>
  object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>lvSubitem [required]</term>
    <listitem>
    <para>
      A <computeroutput>LvSubItem</computeroutput> object that specifies which subitem to modify, what data to modify, and
      the new data for the subitem.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success and false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To modify a subitem, set the <xref linkend="atrItemClsLvSi"/> and <xref linkend="atrSubItemClsLvSi"/> attributes of a
    <computeroutput>LvSubItem</computeroutput> object to identify which subitem is to be modified. Then set the <xref
    linkend="atrMaskClsLvSi"/> attribute to specify what values of the subitem are to be changed, and set either or both
    of the <xref linkend="atrTextClsLvSi"/> and <xref linkend="atrImageIndexClsLvSi"/> attributes to the new information.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example updates the image index of the second subitem in the list-view item with index 17.
<programlisting>
<![CDATA[

  lvSubitem = .LvSubItem~new(17, 2, , 16, 'IMAGE')

  list = self~newListView(IDC_LV_CLIENTS)

  list~modifySubitem(lvSubitem)
]]>
</programlisting>
    Note that the <xref linkend="mthNewClsLvSubItem"/> method of the <computeroutput>LvSubItem</computeroutput> will
    automatically set the <emphasis role="italic">mask</emphasis> attribute correctly. So, the above code could have simply
    been:
<programlisting>
<![CDATA[

  lvSubitem = .LvSubItem~new(17, 2, , 16)

  list = self~newListView(IDC_LV_CLIENTS)

  list~modifySubitem(lvSubitem)
]]>
</programlisting>
    The <emphasis role="italic">mask</emphasis> argument was used in the first example for clarity, to show that only the
    image index would be modified.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::modifySubitem() -->


<section id="mthNext" xreflabel="next"><title>next</title>
<indexterm><primary>next</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~next(--item--)-------------------><


]]>
</programlisting>

<para>The next method retrieves the item that follows,
or is to the right of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the following item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthNextLeft" xreflabel="nextLeft"><title>nextLeft</title>
<indexterm><primary>nextLeft</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~nextLeft(--item--)---------------><


]]>
</programlisting>

<para>The nextLeft method retrieves the item left to <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the next item to the left, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthNextRight" xreflabel="nextRight"><title>nextRight</title>
<indexterm><primary>nextRight</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~nextRight(--item--)--------------><


]]>
</programlisting>

<para>The nextRight method retrieves the item right to <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the next item to the right, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthNextSelected" xreflabel="nextSelected"><title>nextSelected</title>
<indexterm><primary>nextSelected</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~nextSelected(--item--)-----------><


]]>
</programlisting>

<para>The nextSelected method retrieves the selected
item that follows, or is to the right of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the selected item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthPrepare4nItems" xreflabel="prepare4nItems"><title>prepare4nItems</title>
<indexterm><primary>prepare4nItems</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~prepare4nItems(--items--)--------><


]]>
</programlisting>

<para>The prepare4nItems method prepares a list-view
control for adding a large number of items.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>items</term>
<listitem><para>The number of the items to be added later.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The list-view control was prepared.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">items</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthPrependFullRow" xreflabel="prependFullRow"><title>prependFullRow</title>
<indexterm><primary>prependFullRow</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>prependFullRow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--prependFullRow(--row--)----------------------><
]]>
</programlisting>

<para>
  Adds an item to this list-view at the first position in the list using a <xref linkend="clsLvFullRow"/> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
    <variablelist>
      <varlistentry><term>row [required]</term>
      <listitem>
      <para>
        A <computeroutput>LvFullRow</computeroutput> object that specifies the item to be added to the list-view.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the zero-based index of the added row. On error, -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a full row object is used to add an item to the list view, all the subitems are also added. The <emphasis
    role="italic">prependFullRow</emphasis> method always inserts the new item as the first item in the list. Because of
    this, the item index in the item and in the subitems in the full row object are ignored. After the item is inserted, the
    item index is updated in the item and in the subitems is updated to the correct value of the newly added item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(0, "Business manager", 6)
  lvSub1 = .LvSubItem~new(0, 1, "Tom", 14)
  lvSub2 = .LvSubItem~new(0, 2, "Sawyer", 26)
  lvSub3 = .LvSubItem~new(0, 3, "ts@google.com", 11)

  lvFullRow = .LvFullRow~new(lvItem, lvSub1, lvSub2, lvSub3, .true)
  list~prependFullRow(lvFullRow)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::prependFullRow() -->

<section id="mthPrevious" xreflabel="previous"><title>previous</title>
<indexterm><primary>previous</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~previous(--item--)---------------><


]]>
</programlisting>

<para>The previous method retrieves the item that precedes,
or is to the left of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the previous item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthPreviousSelected" xreflabel="previousSelected"><title>previousSelected</title>
<indexterm><primary>previousSelected</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~previousSelected(--item--)-------><


]]>
</programlisting>

<para>The previousSelected method retrieves the selected
item that precedes, or is to the left of, <emphasis role="italic">item</emphasis>.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item at which the search is to start. The specified
item itself is excluded from the search.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the selected item, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthRedrawItems" xreflabel="redrawItems"><title>redrawItems</title>
<indexterm><primary>redrawItems</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~RedrawItems--+--------------------------+------><
                             +-(--first--+---------+--)-+
                                         +-,--last-+


]]>
</programlisting>

<para>The redrawItems method forces a list-view control
to redraw a range of items.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>first</term>
<listitem><para>The number of the first item to be redrawn. The default is 0.
</para></listitem></varlistentry>
<varlistentry><term>last</term>
<listitem><para>The number of the last item to be redrawn. The default is 0.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The specified range of items was redrawn.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthRemoveExtendedStyle" xreflabel="removeExtendedStyle"><title>removeExtendedStyle</title>
<indexterm><primary>removeExtendedStyle</primary></indexterm>
<programlisting>
<![CDATA[
                                         +--------------------+
                                         V                    |
>>-aListControl~removeExtendedStyle(--"----+-BORDERSELECT-----+--"--)-------><
                                           +-CHECKBOXES-------+
                                           +-DOUBLEBUFFER-----+
                                           +-FLATSB-----------+
                                           +-FULLROWSELECT----+
                                           +-GRIDLINES--------+
                                           +-HEADERDRAGDROP---+
                                           +-INFOTIP----------+
                                           +-LABELTIP---------+
                                           +-MULTIWORKAREAS---+
                                           +-ONECLICKACTIVATE-+
                                           +-REGIONAL---------+
                                           +-SIMPLESELECT-----+
                                           +-SUBITEMIMAGES----+
                                           +-TRACKSELECT------+
                                           +-TWOCLICKACTIVATE-+
                                           +-UNDERLINECOLD----+
                                           +-UNDERLINEHOT-----+

]]>
</programlisting>

<para>The <computeroutput>removeExtendedStyle</computeroutput> method removes
one or more extended <link linkend="varListControlExtendedStyles">styles</link> of
a List-View control.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>style</term>
<listitem><para>The extended style(s) to be removed.  This is one or more of the
styles listed in the syntax diagram, separated by blanks. For an explanation
of the different styles, refer to the
<xref linkend="mthAddExtendedStyle"/> method.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The style argument did not contain any of the extended style
keywords.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example removes the check box style from the list
view.
<programlisting>
<![CDATA[

  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  listView~removeExtendedStyle("CHECKBOXES")

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthRemoveItemDataClsListView" xreflabel="removeItemData"><title>removeItemData</title>
<indexterm><primary>removeItemData</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>removeItemData</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removeItemData(--index--)--------------------><

]]>
</programlisting>

<para>
  Removes and returns the item data associated with the specified list-view item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index of the item whose data value is being removed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the item data value associated with the specified item, or <computeroutput>.nil</computeroutput> if there is
    no data associated with the item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The list-view control allows the user (the Rexx programmer) to associate a data value with any, or all, of the
    list-view items. The data value can be any ooRexx object. The data value is set using the
 <xref linkend="mthSetItemDataClsListView"/> method. The data value can be retrieved without removing it from a
    list-view item through the <xref linkend="mthGetItemDataClsListView"/> method.  Storing a user value for each
    item can be useful in any number of ways. One specific use is in the <xref linkend="mthSortItems"/>
    method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from a program where the user can add items to a list-view and rearrange the items in any she
    wants. The user can also reset the order of the items to its original order when the program started up. To do that,
    the original index of each item is stored in the data value for each item when it is added to the list-view
  </para>
  <para>
    Since the list-view control associates the data value with the index of an item, when the items are reset to their
    original order, the data value is removed from the index it is currently at. When the items are added back to the
    list-view in their original order the data value is then associated with the new item index.
<programlisting> <![CDATA[

::method initDialog
  expose list

  list = self~newListView(IDC_LV)
  ...

  items = self~getItems
  index = 0

  do item over items
    list~addRow(index, , item~text, item~fName, item~lName)
    item~origIndex = index

    list~setItemData(index, item)
    index += 1
  end


::method onReset
  expose list

  countItems = list~items
  items = .array~new(countItems)

  do i = 1 to countItems
    data = list~removeItemData(i - 1)

    items[data~origIndex + 1] = data
  end

  list~deleteAll

  do i = 1 to countItems
    data = items[i]

    list~addRow(i - 1, , data~text, data~fName, data~lName)
    list~setItemData(i - 1, data)
  end

return 0
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::removeItemData() -->


<section id="mthRemoveStyleClsListView" xreflabel="removeStyle"><title>removeStyle</title>
<indexterm><primary>removeStyle</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                 +-------------------+
                                 V                   |
>>-aListControl~removeStyle(--"----+-ICON----------+-+--"--)----><
                                   +-SMALLICON-----+
                                   +-LIST----------+
                                   +-REPORT--------+
                                   +-ALIGNLEFT-----+
                                   +-ALIGNTOP------+
                                   +-AUTOARRANGE---+
                                   +-ASCENDING-----+
                                   +-DESCENDING----+
                                   +-EDIT----------+
                                   +-HSCROLL-------+
                                   +-VSCROLL-------+
                                   +-NOSCROLL------+
                                   +-NOHEADER------+
                                   +-NOSORTHEADER--+
                                   +-NOWRAP--------+
                                   +-SINGLESEL-----+
                                   +-SHOWSELALWAYS-+
                                   +-SHAREIMAGES---+
                                   +-GROUP---------+
                                   +-HIDDEN--------+
                                   +-NOTAB---------+
                                   +-NOBORDER------+


]]>
</programlisting>

<para>The removeStyle method removes one or more window
styles of a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>style</term>
<listitem><para>The window styles to be removed, which is one or more of the styles
listed in the syntax diagram, separated by blanks. For an explanation of the
different styles, refer to <xref linkend="mthCreateListView"/>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if this method fails.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthReplaceExtendedStyle" xreflabel="replaceExtendedStyle"><title>replaceExtendedStyle</title>
<indexterm><primary>replaceExtendedStyle</primary></indexterm>
<programlisting>
<![CDATA[
                                                     +--------------------+
                                                     V                    |
>>-aListControl~replaceExtendedStyle(-oldStyle--,--"---+-BORDERSELECT-----+--"-)-><
                                                       +-CHECKBOXES-------+
                                                       +-DOUBLEBUFFER-----+
                                                       +-FLATSB-----------+
                                                       +-FULLROWSELECT----+
                                                       +-GRIDLINES--------+
                                                       +-HEADERDRAGDROP---+
                                                       +-INFOTIP----------+
                                                       +-LABELTIP---------+
                                                       +-MULTIWORKAREAS---+
                                                       +-ONECLICKACTIVATE-+
                                                       +-REGIONAL---------+
                                                       +-SIMPLESELECT-----+
                                                       +-SUBITEMIMAGES----+
                                                       +-TRACKSELECT------+
                                                       +-TWOCLICKACTIVATE-+
                                                       +-UNDERLINECOLD----+
                                                       +-UNDERLINEHOT-----+


]]>
</programlisting>

<para>The <computeroutput>replaceExtendedStyle</computeroutput> method removes
some of the List-View control's
extended <link linkend="varListControlExtendedStyles">styles</link> and adds new
extended styles. This is the equivalent of first
using the <computeroutput>RemoveExtendeStyle</computeroutput> method and then
using the <computeroutput>addExtendedStyle</computeroutput> method.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>oldStyle</term>
<listitem><para>The extended style(s) to be removed.  This is one or more of the
styles listed in the syntax diagram, separated by blanks. For an explanation
of the different styles, refer to the
<xref linkend="mthAddExtendedStyle"/> method.
</para></listitem></varlistentry>
<varlistentry><term>newStyle</term>
<listitem><para>The extended style(s) to be added.  Again, this is one or more
of the styles listed in the syntax diagram, separated by blanks. See the
<xref linkend="mthAddExtendedStyle"/> method for the style
descriptions.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>One, or both, of the style arguments had none of the extended
style keywords.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example removes the cold and hot underlining and
adds check boxes to the list view.
<programlisting>
<![CDATA[

  listView = self~newListView(IDC_LIST)
  if listView == .nil then return

  removeStyle = "UNDERLINECOLD UNDERLINEHOT"
  addStyle = "CHECKBOXES"

  listView~replaceExtendedStyle(removeStyle, addStyle)

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthReplaceStyleClsListView" xreflabel="replaceStyle"><title>replaceStyle</title>
<indexterm><primary>replaceStyle</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                                               +-------------------+
                                               V                   |
>>-aListControl~replaceStyle(--oldStyle--,--"----+-ICON----------+-+--"--)-><
                                                 +-SMALLICON-----+
                                                 +-LIST----------+
                                                 +-REPORT--------+
                                                 +-ALIGNLEFT-----+
                                                 +-ALIGNTOP------+
                                                 +-AUTOARRANGE---+
                                                 +-ASCENDING-----+
                                                 +-DESCENDING----+
                                                 +-EDIT----------+
                                                 +-HSCROLL-------+
                                                 +-VSCROLL-------+
                                                 +-NOSCROLL------+
                                                 +-NOHEADER------+
                                                 +-NOSORTHEADER--+
                                                 +-NOWRAP--------+
                                                 +-SINGLESEL-----+
                                                 +-SHOWSELALWAYS-+
                                                 +-SHAREIMAGES---+
                                                 +-GROUP---------+
                                                 +-HIDDEN--------+
                                                 +-NOTAB---------+
                                                 +-NOBORDER------+


]]>
</programlisting>

<para>The replaceStyle method removes a window style
of a list-view control and sets new styles.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>oldStyle</term>
<listitem><para>The window style to be removed.
</para></listitem></varlistentry>
<varlistentry><term>newStyle</term>
<listitem><para>The new window styles to be set, which is one or more of the styles
listed in the syntax diagram, separated by blanks. For an explanation
of the different styles, refer to <xref linkend="mthCreateListView"/>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if this method fails.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>
  The following example comes from a program where the user can switch between the different view styles
  in a list-view.  The list-view is assigned an image list for both the small and normal icons.  Radio
  buttons for the different views are connected to methods.  When the user clicks one of the radio
  buttons, the method for that radio button uses <computeroutput>replaceStyle</computeroutput>() to
  remove all of the other view styles and add the specified style.
<programlisting>
<![CDATA[

::method initDialog
  expose list

  self~newRadioButton(IDC_RB_ICON)~check
  self~connectButtonEvent(IDC_RB_REPORT, "CLICKED", onReport)
  self~connectButtonEvent(IDC_RB_LIST, "CLICKED", onList)
  self~connectButtonEvent(IDC_RB_ICON, "CLICKED", onIcon)
  self~connectButtonEvent(IDC_RB_SMALL_ICON, "CLICKED", onSmallIcon)

  list  = self~newListView(IDC_LV_VIEWS)

  imageList = .ImageList~create(.Size~new(16), COLOR24, 7, 0)

  imageList~add(.Image~getImage("iconList_16.bmp"))
  list~setImageList(imageList, SMALL)

  imageList = .ImageList~create(.Size~new(32), flags, 7, 0)

  imageList~add(.Image~getImage("iconList_32.bmp"))
  list~setImageList(imageList, NORMAL)

  self~populateList(list)

::method onReport
  expose list
  list~replaceStyle("LIST ICON SMALLICON", "REPORT")

::method onList
  expose list
  list~replaceStyle("REPORT ICON SMALLICON", "LIST")

::method onIcon
  expose list
  list~replaceStyle("LIST REPORT SMALLICON", "ICON")

::method onSmallIcon
  expose list
  list~replaceStyle("LIST ICON REPORT", "SMALLICON")

::method populateList private
  use strict arg list

  list~InsertColumnEx(0, "Title", 150)
  ...

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthScrollClsListview" xreflabel="scroll"><title>scroll</title>
<indexterm><primary>scroll</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
                         +-0-+     +-0-+
>>-aListControl~scroll(--+---+--,--+---+--)------><
                         +-x-+     +-y-+


]]>
</programlisting>

<para>The Scroll method scrolls the content of a list
view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>x</term>
<listitem><para>An integer value specifying the amount of horizontal scrolling. If the
control is in icon, small-icon, or report view, this value specifies the number
of pixels to be scrolled. If it is in list-view, this value specifies the
number of columns to be scrolled. The default value is 0.
</para></listitem></varlistentry>
<varlistentry><term>y</term>
<listitem><para>An integer value specifying the amount of vertical scrolling. If the
control is in icon, small-icon, or report view, this value specifies the number
of pixels to be scrolled. If it is in list-view, this value specifies the
number of lines to be scrolled. The default value is 0.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Scrolling was successful.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>Scrolling failed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectClsListView" xreflabel="select"><title>select</title>
<indexterm><primary>select</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~select(--item--)-----------------><


]]>
</programlisting>

<para>The select method selects an item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was selected.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectedClsListView" xreflabel="selected"><title>selected</title>
<indexterm><primary>selected</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Selected-------------------------><


]]>
</programlisting>

<para>The selected method returns the number of the selected
item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of the item selected last, or -1 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectedItemsClsListView" xreflabel="selectedItems"><title>selectedItems</title>
<indexterm><primary>selectedItems</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~SelectedItems--------------------><


]]>
</programlisting>

<para>The selectedItems method determines the number
of selected items in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of selected items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetColumnOrder" xreflabel="setColumnOrder"><title>setColumnOrder</title>
<indexterm><primary>setColumnOrder</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setColumnOrder(--order--)--------------------><

]]>
</programlisting>

<para>
  Changes the column order of a list-view control to some other order. Typically this method might be
  used along with the <xref linkend="mthGetColumnOrder"/>() method to save and
  restore the user's column order. But, it can also be used to programmatically change the column order
  for any reason.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
    <para>
      The single required argument is:
    <variablelist>
      <varlistentry><term>order</term>
      <listitem>
        <para>
          An array containing the index numbers of the columns in their new order. The number at the
          first position in the array is the column index of the column that should be the left-most. The
          number at the second position in the array, and so on.
        </para>
        <para>
          The array has to contain the same number of items as the number of columns with no empty
          indexes.
        </para>
        <para>
          If non-valid column indexes are intermingled with valid column indexes, then the columns are
          re-ordered, but with no easily predictable pattern.  If all the number are invalid column
          indexes, then the order of the columns remains unchanged. This behavior is the behavior of the
          underlying control, ooDialog has no control over it.
        </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The possible return values are:
      <variablelist>
        <varlistentry><term><computeroutput>.true</computeroutput></term>
        <listitem>
          <para>
            The method succeeded.
          </para>
        </listitem></varlistentry>
        <varlistentry><term><computeroutput>.false</computeroutput></term>
        <listitem>
          <para>
            Some error occurred. This is unlikely.
          </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      Raises syntax errors when incorrect arguments are detected.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
    <para>
      In this example an application has two modes. One mode emphasizes the occupation of the people in a
      database, the other mode emphasizes the people. The order of the columns is occupation, name, ...
      for the first mode and name, occupation, ... for the second mode. When the mode of the application
      changes, the order of the columns also changes.
<programlisting>
<![CDATA[
  ...
  list = self~newListView(100)

  columnNames = .array~of("Occupation", "Name", "Age", "Sex")
  list~addExtendedStyle("FULLROWSELECT GRIDLINES CHECKBOXES")

  list~insertColumn(0, columnNames[1], 95)
  list~insertColumn(1, columnNames[2], 95)
  list~insertColumn(2, columnNames[3], 95)
  list~insertColumn(3, columnNames[4], 35)
  ...

::method toggleColumnOrder private
  expose list

  order = list~getColumnOrder
  tmp = order[1]
  order[1] = order[2]
  order[2] = tmp
  list~setColumnOrder(order)
]]>
</programlisting>
    </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListControl::setColumnOrder() -->

<section id="mthSetColumnWidth" xreflabel="setColumnWidth"><title>setColumnWidth</title>
<indexterm><primary>setColumnWidth</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~setColumnWidth(--column--+----------+--)--------><
                                         +-,--width-+


]]>
</programlisting>

<para>The setColumnWidth method sets the width of a column
in a report or list view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>column</term>
<listitem><para>The number of the column of which the width is to be set. 0 is the first
column.
</para></listitem></varlistentry>
<varlistentry><term>width</term>
<listitem><para>The width of the column, in pixels. If you omit this argument, the column
is sized automatically to the widest item in the list.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The column width was set.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">column</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example enlarges the selected column by 10:
<programlisting>
<![CDATA[
::method OnColumnClick
  use arg id, column
  curList = self~newListView(102)
  curList~setColumnWidth(column,curList~columnWidth(column)+10)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetColumnWidthPX" xreflabel="setColumnWidthPX"><title>setColumnWidthPX</title>
<indexterm><primary>setColumnWidth</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>setColumnWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setColumnWidthPX(--colIndex--+-----------+--)---------------><
                                 +--,-width--+
]]>
</programlisting>

<para>
  Sets the width, in pixels, of a column in a list-view control that has the report or list style.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>colIndex [required]</term>
      <listitem>
      <para>
        The zero-based index of the column whose width is to be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>width [optional]</term>
      <listitem>
      <para>
        A positive whole number specifying the width in pixels for the column. If, the list-view is in report view, one
        of the following keywords are also valid:
        <variablelist>
          <varlistentry><term><emphasis role="bold">AUTO:</emphasis></term>
          <listitem>
          <para>
            The list-view will automatically size the column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">AUTOHEADER:</emphasis></term>
          <listitem>
          <para>
            Automatically sizes the column to fit the column text. When this value for the last column, its width is set
            to fill the remaining width of the list-view control.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    Provided that the list-view is in report view, this example has the list-view automatically size the first two
    columns, and then size the last column to take up all the rest of the width in the control.
<programlisting>
<![CDATA[

  list = self~newListView(IDC_LV_SALES)

  list~setColumnWidthPX(0, "AUTO")
  list~setColumnWidthPX(1, "AUTO")
  list~setColumnWidthPX(2, "AUTOHEADER")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::setColumnWidthPX() -->

<section id="mthSetFullRowText" xreflabel="setFullRowText"><title>setFullRowText</title>
<indexterm><primary>setFullRowText</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>setFullRowText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setFullRowText(--row--)----------------------><
]]>
</programlisting>

<para>
  Modifies all, or some, of the text for a list-view item and its subitems using a <xref linkend="clsLvFullRow"/> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>row [required]</term>
    <listitem>
    <para>
      The <emphasis role="italic">row</emphasis> argument must either be a <computeroutput>LvFullRow</computeroutput> object,
      or the zero-based index of the list-view item whose text is to be modified.
    </para>

    <variablelist>
      <varlistentry><term><emphasis role="bold">LvFullRow object:</emphasis></term>
      <listitem>
      <para>
        When the <emphasis role="italic">row</emphasis> argument is a <computeroutput>LvFullRow</computeroutput> object, the
        text of the list-view item is modified to match the text in the full row object. For the item and each subitem, the
        text is only modified, if that item or subitem in the <emphasis role="italic">row</emphasis> full row object has its
        item <xref linkend="atrMaskClsLvi"/>, or subitem <xref linkend="atrMaskClsLvSi"/> attribute set to contain the TEXT
        keyword. If the item's, or subitem's, mask does not contain the TEXT keyword, the text in the list-view item is left
        unchanged.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">Item index:</emphasis></term>
      <listitem>
      <para>
        When the <emphasis role="italic">row</emphasis> argument is the index of the item to modify, the item <link
        linkend="mthSetItemDataClsListView">data</link> of the list-view item <emphasis role="italic">must</emphasis> have
        been assigned a <computeroutput>LvFullRow</computeroutput> object. The list-view item's text is then modified to
        match the text in the assigned full row object.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Using an item index for the <emphasis role="italic">row</emphasis> argument can be thought of as a <emphasis
    role="italic">sync</emphasis> operation. It is assumed that the programmer has changed the value of the text attributes
    of the <computeroutput>LvFullRow</computeroutput> object that is assigned as the item data of the list-view item. Then,
    invoking the <emphasis role="italic">modifyFullRow</emphasis> method has the effect of syncing up the underlying
    list-view item's text with the full row object's text attributes. In this case, the text of the item and the text of
    every subitem is set to the corresponding text value the item data's full row object.
  </para>
  <para>
    In contrast, when a <computeroutput>LvFullRow</computeroutput> object is used as the <emphasis
    role="italic">row</emphasis> argument, it is possible to only update the text for the item or subitems that need to be
    updated. The example below demonstrates this technique.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example constructs a full row object for a list-view that has 6 subitems. <emphasis
    role="italic">currentItem</emphasis> is the index of one of the list-view items, the item whose text might be modified.
    Note that the text and mask attributes of the item and subitems of the full row are not set. The current text in all the
    edit controls is collected and compared to the old values stored in the rec array. If it does not match, the text
    attribute in the full row is set to the value from the edit control. In this way, when !setFullRowText() is invoked, only
    the text of the item or subitems in the list-view that have actually changed are updated:
<programlisting>
<![CDATA[

  lNameText   = lNameEdit~getText~strip
  fNameText   = fNameEdit~getText~strip
  ...
  zipText     = zipEdit~getText~strip

  lvFullRow = .LvFullRow~new(.LvItem~new(currentItem))
  do i = 1 to 6
    lvFullRow~addSubitem(.LvSubItem~new(currentItem, i))
  end

  if lNameText \== rec[2] then do
    lvFullRow~item~text = lNameText
  end
  if fNameText \== rec[3] then do
    lvFullRow~subItem(1)~text = fNameText
  end
  ...
  if zipText \== rec[8] then do
    lvFullRow~subItem(6)~text = zipText
  end

  list~setFullRowText(lvFullRow)


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::setFullRowText() -->


<section id="mthSetHoverTime" xreflabel="setHoverTime"><title>setHoverTime</title>
<indexterm><primary>setHoverTime</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~setHoverTime(--+------+--)----------------------><
                               +-time-+

]]>
</programlisting>

<para>This method is used to change the <emphasis role="italic">hover</emphasis>
time.  The hover time only affects list-view controls that have the track
select, one click activate, or two click activate extended list-view styles. See
the <xref linkend="mthAddExtendedStyle"/> for a
description of these styles.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only optional argument is:
<variablelist>
<varlistentry><term>time</term>
<listitem><para>Specify the hover time in milliseconds.  If this argument is
omitted, the hover time is set to the system default.  A negative number will
also set the hover time back to the system default.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The previous hover time.  A value of -1 indicates the previous
hover time was the system default.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example adds the one click activate, the track
select, and the full row select extended list-view styles to a
<computeroutput>ListView</computeroutput>.  The hover time is set to .4
seconds. If the user pauses his mouse over a row in the list-view for .4 of a
second the row is automatically selected.
<programlisting> <![CDATA[
::method initDialog

  ...
  list = self~newListView(IDC_LIST)
  list~addExtendedStyle("ONECLICKACTIVATE FULLROWSELECT TRACKSELECT")

  oldTime = list~setHoverTime(400)
  ...

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetImageListClsListView" xreflabel="setImageList"><title>setImageList</title>
<indexterm><primary>setImageList</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setImageList(--src-+---------------+-+----------+-+----------+-)-----------><
                       +-,-typeOrWidth-+ +-,-height-+ +-,-ilType-+
]]>
</programlisting>

<para>
  Assigns, or removes, the specified image list for the list-view control. Using <computeroutput>.nil</computeroutput> for
  the first argument removes the current image list if any. The list-view control uses image lists for a number of things,
  the large icons, the small icons, the state images, and the group header images. (ooDialog does not yet support list-view
  groups.)
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>The arguments are:
  <variablelist>
    <varlistentry><term>src [required]</term>
    <listitem>
    <para>
      The source for the image list. This can be an <xref linkend="clsImageList"/> object to assign to the list-view, a
      bitmap <xref linkend="clsImage"/> object, or the file name of the bitmap. When <emphasis role="italic">src</emphasis>
      is a bitmap, the ooDialog framework internally creates an image list from the bitmap as explained in the Remarks
      section.
    </para>
    <para>
      If this argument is the <computeroutput>.nil</computeroutput> object, the existing image list, if any, is
      removed.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>typeOrWidth [optional]</term>
    <listitem>
    <para>
      <emphasis role="bold">type</emphasis>: When <emphasis role="italic">src</emphasis> is an
      <computeroutput>ImageList</computeroutput> object, this argument specifies which image list to
      assign, (or remove.) The following keywords are used to specify the type, case is not significant:
    </para>
    <para>
      <simplelist type='horiz' columns='2'>
      <member>NORMAL</member>
      <member>SMALL </member>
      <member>STATE </member>
      </simplelist>
    </para>
    <para>
      The default is NORMAL.
    </para>
    <para>
      <emphasis role="bold">width</emphasis>: When <emphasis role="italic">src</emphasis> is a
      single bitmap, this argument can be used to specify the width of a single image in the bitmap.
      The default is the actual height of the bitmap.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>height [optional]</term>
    <listitem>
    <para>
      This argument is only used when <emphasis role="italic">src</emphasis> is a single bitmap. In that case <emphasis
      role="italic">height</emphasis> specifies the height of an image in the bitmap. The default is to use the actual height
      of the bitmap.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>ilType [optional]</term>
    <listitem>
    <para>
      This argument is only used when <emphasis role="italic">src</emphasis> is a single bitmap. It is used to specify which
      image list is being assigned. Its usage is exactly the same as is documented for the <emphasis
      role="italic">type</emphasis> role of the <emphasis role="italic">typeOrWidth</emphasis> argument above. If omitted,
      the default is NORMAL.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The existing image list is returned, if there is one. Otherwise, the <computeroutput>.nil</computeroutput> object is
    returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks</emphasis></term>
  <listitem>
  <para>
    Note that the MSDN documentation states that the appropriate dimensions for the normal and small icons should be used. It
    has been observed that if the size of the small icons is not appropriate, there can be drawing problems with the icons in
    report view. Especially if check boxes are enabled. The <xref linkend="atrCxSmIcon"/> and <xref
    linkend="atrCySmIcon"/> attributes of the <xref linkend="clsSM"/> class reflect the dimensions that should be used
    for the small icons.  The <emphasis role="italic">cxIcon</emphasis> and <emphasis role="italic">cyIcon</emphasis>
    attributes of the same class reflect the appropriate dimensions for the normal icons.
  </para>
  <para>
    As noted above the <emphasis role="italic">src</emphasis> argument can be either an <xref linkend="clsImageList"/>
    object, or a single bitmap. Using an image list object is the most flexible option. The programmer creates the image list
    in the manner most suitable to the program. When the program is enhanced or changed it is easy to change the image list.
  </para>
  <para>
    When <emphasis role="italic">src</emphasis> is a single bitmap it is used in this way: A single bitmap is created that
    consists of all the images for the image list. All the images must be the same width and height. The images are arranged
    in the bitmap in a row, side-by-side, in the order they should appear in the image list. ooDialog uses this bitmap to
    create an <emphasis role="italic">.ImageList</emphasis> object and assigns it to the list-view. The <emphasis
    role="italic">src</emphasis> argument can be either the file name of the bitmap or a bitmap <xref linkend="clsImage"/>
    object.
  </para>
  <para>
    Although using a single bitmap will allow the programmer to save a couple of lines of code, it has a number of
    disadvantages. The image list is created with the exact number of images in the bitmap and no extra room to add images.
    The image list is created as an unmasked image list, with a color of 8 bit per pixel. If the program is enhanced or
    changed in a way that requires even a slight change to the image list, the single bitmap would need to be re-created.
  </para>
  <para>
    When using a single bitmap, if the system fails to create the image list from the details supplied by ooDialog, the
    method of informing the programmer of the error is not as robust as it is when the programmer creates the image list
    herself. However, ooDialog will set the <xref linkend="dotSystemErrorCode"/> for any cases where the operating system
    reports an error. Also note that when using a single bitmap, ooDialog will instantiate a <emphasis
    role="italic">.ImageList</emphasis> object. The programmer can retrieve this object using the
   <xref linkend="mthGetImageListClsListView"/>() method and then manipulate it using the methods of the <xref
   linkend="clsImageList"/> class.
  </para>
  <para>
    Unless a list-view has the LVS_SHAREIMAGELISTS style, (corresponds to the SHAREIMAGES style in the
   <xref linkend="mthCreateListView"/>() method,) the list-view control will handle releasing the image list(s). When the
    share image lists style is used, ownership of the image list remains with the programmer. The <xref
    linkend="clsImageList"/> and <xref linkend="clsImage"/> classes are used to manage image lists and images in ooDialog.
    The documentation on both classes discusses when and why the programmer may want to release image lists.
    The Image class documentation has the most detail on this subject.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This is a complete working example. It creates an image list using the application icons that ooDialog makes available
    for general use. The image list is assigned as the normal icon image list.
<programlisting>
<![CDATA[

  dlg = .ImageDisplay~new
  if dlg~initCode == 0 then do
    dlg~constDir[IDC_LV_IMAGES] = 100
    dlg~create(30, 30, 320, 155, "ooDialog Icon Resources", , , "Tahoma")
    dlg~execute("SHOWTOP", IDI_DLG_OOREXX)
  end

::requires "ooDialog.cls"

::class 'ImageDisplay' subclass UserDialog

::method defineDialog

  self~createListView(IDC_LV_IMAGES, 10, 10, 300, 135, "ICON SINGLESEL");

::method initDialog

  names = .array~new()
  names[1] = "IDI_DLG_OODIALOG"
  names[2] = "IDI_DLG_APPICON"
  names[3] = "IDI_DLG_APPICON2"
  names[4] = "IDI_DLG_OOREXX"

  ids = .array~new()
  ids[1] = self~constDir[IDI_DLG_OODIALOG]
  ids[2] = self~constDir[IDI_DLG_APPICON]
  ids[3] = self~constDir[IDI_DLG_APPICON2]
  ids[4] = self~constDir[IDI_DLG_OOREXX]

  size = .Size~new(.SM~cxIcon, .SM~cyIcon)

  oodModule = .ResourceImage~new(self)
  icons = oodModule~getImages(ids, 'ICON', size)

  imageList = .ImageList~create(size, 'COLOR24 MASK', 4, 0)
  imageList~addImages(icons)

  list = self~newListView(IDC_LV_IMAGES)
  list~setImageList(imageList, 'NORMAL')

  do i = 1 to ids~items
    list~add(names[i] '('ids[i]')', i - 1)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::setImageList() -->

<section id="mthSetItemDataClsListView" xreflabel="setItemData"><title>setItemData</title>
<indexterm><primary>setItemData</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>setItemData</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setItemData(--index--,--data--)--------------><

]]>
</programlisting>

<para>
  Sets the item data associated with the specified list-view item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The zero-based index of the item the data value is associated with.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>data [required]</term>
      <listitem>
      <para>
        The data value to store for the list-view item. This can be any Rexx object. (Recall that in ooRexx numbers and
        strings are also objects.)
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error. An error is unlikely.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The list-view control allows the user (the Rexx programmer) to associate a data value with any, or all, of the
    list-view items. The data value can be any ooRexx object. The data value can be retrieved without removing it from a
    list-view item through the <xref linkend="mthGetItemDataClsListView"/> method, or it can be retrieved and removed through
    the <xref linkend="mthRemoveItemDataClsListView"/>. Storing a user value for each item can be useful in any
    number of ways. One specific use is in the <xref linkend="mthSortItems"/> method.
  </para>
  <para>
    For the <emphasis role="italic">sortItems</emphasis> method to work, every list-view item must have the item data set.
    When <emphasis role="italic">sortItems</emphasis> is invoked to have the ooDialog framework do the sorting internally,
    the item data object must be a <xref linkend="clsLvFullRow"/> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example stores a <computeroutput>.Directory</computeroutput> object with each list-view item when the item is
    added to the list-view. The <computeroutput>.Directory</computeroutput> object contains the text for the item and
    its subitems and additional information not shown in the code snippet:
<programlisting>
<![CDATA[

::method initDialog
  expose list

  list = self~newListView(IDC_LV)
  ...

  items = self~getItems

  do item over items
    index = list~addRow(, , item~text, item~fName, item~lName)

    if index == -1 then do
      -- do some error routine
      return 0
    end

    list~setItemData(index, item)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::setItemData() -->


<section id="mthSetItemPos" xreflabel="setItemPos"><title>setItemPos</title>
<indexterm><primary>setItemPos</primary></indexterm>
<programlisting>
<![CDATA[
                                      +-0-+     +-0-+
>>-aListControl~setItemPos(--item--,--+---+--,--+---+--)--------><
                                      +-x-+     +-y-+


]]>
</programlisting>

<para>The setItemPos method moves an item to a specified
position in a list-view control, which must be in icon or small-icon view.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>x</term>
<listitem><para>The x-coordinate of the new position of the upper left corner of the
item, in view coordinates. The default is 0.
</para></listitem></varlistentry>
<varlistentry><term>y</term>
<listitem><para>The y-coordinate of the new position of the upper left corner of the
item, in view coordinates. The default is 0.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was moved.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>

<note><title>Note</title><para>
Use <xref linkend="mthDefListDragHandler"/> to support default dragging:
</para></note>
<programlisting>
<![CDATA[
self~connectListViewEvent(104,"BEGINDRAG","mthDefListDragHandler")
]]>
</programlisting>
</section>

<section id="mthSetItemState" xreflabel="setItemState"><title>setItemState</title>
<indexterm><primary>setItemState</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~setItemState(--item--+------------------------------+--)-><
                                     |       +-----------------+    |
                                     |       V                 |    |
                                     +-,--"----+-CUT---------+-+--"-+
                                               +-NOTCUT------+
                                               +-DROP--------+
                                               +-NOTDROP-----+
                                               +-FOCUSED-----+
                                               +-NOTFOCUSED--+
                                               +-SELECTED----+
                                               +-NOTSELECTED-+


]]>
</programlisting>

<para>The setItemState method sets the state of a list
view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item.
</para></listitem></varlistentry>
<varlistentry><term>state</term>
<listitem><para>The state of the item, which can be one or more of the following values,
separated by blanks:
<variablelist>
<varlistentry><term>CUT</term>
<listitem><para>The item is marked for a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>NOTCUT</term>
<listitem><para>The item cannot be used for a cut-and-paste operation.
</para></listitem></varlistentry>
<varlistentry><term>DROP</term>
<listitem><para>The item is highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>NOTDROP</term>
<listitem><para>The item is not highlighted as a drag-and-drop target.
</para></listitem></varlistentry>
<varlistentry><term>FOCUSED</term>
<listitem><para>The item has the focus and is therefore surrounded by the standard focus
rectangle. Only one item can have the focus.
</para></listitem></varlistentry>
<varlistentry><term>NOTFOCUSED</term>
<listitem><para>The item does not have the focus.
</para></listitem></varlistentry>
<varlistentry><term>SELECTED</term>
<listitem><para>The item is selected. Its appearance depends on whether it has the focus
and on the system colors used for a selection.
</para></listitem></varlistentry>
<varlistentry><term>NOTSELECTED</term>
<listitem><para>The item is not selected.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The state was set successfully.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetItemText" xreflabel="setItemText"><title>setItemText</title>
<indexterm><primary>setItemText</primary></indexterm>
<programlisting>
<![CDATA[
>>--setItemText(--item--,--+-----------+--,--text--)------------><
                           +--subitem--+

]]>
</programlisting>

<para>
  The setItemText method changes the text of a label, or the text of a subitem, of a list-view item.
</para>
<para>
  Remember that in a list-view, items and columns use a 0-based index. Subitems use a 1-based index.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The index of the item.
</para></listitem></varlistentry>
<varlistentry><term>subitem</term>
<listitem><para>
  This method works in a similar manner as the <xref linkend="mthInsertClsListControl"/>()
  method. The use of the <emphasis role="italic">subitem</emphasis> argument controls whether the
  <emphasis role="italic">text</emphasis> argument applies to the label of the item or the text of a
  subitem. When <emphasis role="italic">subitem</emphasis> is omitted or 0, then the label of the item is
  set to <emphasis role="italic">text</emphasis>. When <emphasis role="italic">subitem</emphasis> is
  greater than 0, then the text of that subitem is set to <emphasis role="italic">text</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>text</term>
<listitem><para>
  The text for the item or a subitem, depending on the value of <emphasis
  role="italic">subitem</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The change was successful.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthSetToolTipsClsListView" xreflabel="setToolTips"><title>setToolTips</title>
<indexterm><primary>setToolTips</primary><secondary>ListView class</secondary></indexterm>
<indexterm><primary>ListView class</primary><secondary>setToolTips</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setToolTips(--toolTip--)---------------------><
]]>
</programlisting>

<para>
  Sets the child <link linkend="clsToolTip">ToolTip</link> control used by this list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
    <variablelist>
      <varlistentry><term>toolTip [required]</term>
      <listitem>
      <para>
        The Rexx <computeroutput>ToolTip</computeroutput> object that represents the tool tip control the list-view should
        use.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous tool tip, as a Rexx <computeroutput>ToolTip</computeroutput> object, or the
    <computeroutput>.nil</computeroutput> object if there is no previous tool tip.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::setToolTips() -->


<section id="mthSetView" xreflabel="setView"><title>setView</title>
<indexterm><primary>setView</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>setView</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setView(--view--)----------------------------><
]]>
</programlisting>

<para>
  Sets the view of this list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>view [required]</term>
    <listitem>
    <para>
      Exactly one of the following keywords that specifies which view to set. Case in not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>ICON     </member>
        <member>SMALLICON</member>
        <member>LIST     </member>
        <member>REPORT   </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>ICON</term>
        <listitem>
        <para>
          Set the list-view to icon view. Each item appears as a full-sized icon with a label below it.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SMALLICON</term>
        <listitem>
        <para>
          Set the list-view to small icon view. Each item appears as a small icon with the label to the right of it.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LIST</term>
        <listitem>
        <para>
          Set the list-view to list view. Each item appears as a small icon with a label to the right of it. Items are
          arranged in columns.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>REPORT</term>
        <listitem>
        <para>
          Set the list-view to report view. Each item appears on its own line, with information arranged in columns.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the view of the list-view at the time this method was invoked. The view is returned as one of the keywords listed
    for the <emphasis role="italic">view</emphasis> argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a method that switches the view of the list-view to that specified by the index:
<programlisting>
<![CDATA[

::method refreshView unguarded
  expose lv
  use strict arg index

  select
    when index == 1 then lv~setView("LIST")
    when index == 2 then lv~setView("REPORT")
    when index == 3 then lv~setView("ICON")
    when index == 4 then lv~setView("SMALLICON")
    otherwise return .false
  end
  -- End select

  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::setView() -->


<section id="mthSmalSpacing" xreflabel="smallSpacing"><title>smallSpacing</title>
<indexterm><primary>smallSpacing</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~SmallSpacing---------------------><


]]>
</programlisting>

<para>The smallSpacing method determines the spacing
between items in a small-icon list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The amount of spacing between the items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSnapToGrid" xreflabel="snapToGrid"><title>snapToGrid</title>
<indexterm><primary>snapToGrid</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~SnapToGrid-----------------------><


]]>
</programlisting>

<para>The snapToGrid method snaps all icons to the nearest
grid position.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The items were snapped.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSortItems" xreflabel="sortItems"><title>sortItems</title>
<indexterm><primary>sortItems</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>sortItems</secondary></indexterm>
<programlisting>
<![CDATA[
>>--sortItems(--methodName--+----------+--)------><
                            +-,-param--+
]]>
</programlisting>

<para>
  The <emphasis role="italic">sortItems</emphasis> method causes the list-view control to sort its items using the
  specified comparison method. The comparison method can be a method in the Rexx dialog, or a method name that signals the
  ooDialog framework to use an internal comparison method written in the native API.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>methodName [required]</term>
      <listitem>
      <para>
        <emphasis role="italic">methodName</emphasis> is either the name of a method in the Rexx dialog, (referred to as a
        Rexx sort,) or the special method name of: <emphasis role="italic">InternalListViewSort</emphasis>, (referred to as
        an internal sort.)
      </para>
      <para>
        When <emphasis role="italic">methodName</emphasis> is <emphasis role="italic">InternalListViewSort</emphasis> then
        the ooDialog framework performs the sorting work internally. This can be significantly faster, for very large lists,
        but there are a number of restrictions to this sort. See the remarks section for the details.
      </para>
      <para>
        When <emphasis role="italic">methodName</emphasis> is not <emphasis role="italic">InternalListViewSort</emphasis>,
        then it names a comparison method in the Rexx dialog that is used by the list-view to sort its items. The details of
        how the Rexx method is implemented are in the remarks section.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>param [optional]</term>
      <listitem>
      <para>
        For the <emphasis role="bold">Rexx sort</emphasis>, the <emphasis role="italic">param</emphasis> argument can be any object the programmer
        wants to use. If the argument exists, it is passed as the third argument to the <emphasis
        role="italic">methodName</emphasis> comparison method. If it is not specified,
        <computeroutput>.nil</computeroutput> is passed as the third argument.
      </para>
      <para>
        For the <emphasis role="bold">internal sort</emphasis>, the <emphasis role="italic">param</emphasis> argument can be a
        <computeroutput>Directory</computeroutput> object that is used to change the internal sort parameters. If <emphasis
        role="italic">param</emphasis> is omitted in this case, the sort is performed on the list-view item text, as a
        case-sensitive ascending sort. If not omitted, the following indexes in the
        <computeroutput>Directory</computeroutput> object are checked and alter the sort as described:
      </para>

        <variablelist>
          <varlistentry><term><emphasis role="bold">ASCENDING:</emphasis></term>
          <listitem>
          <para>
            If present, the index must be true or false. When true, the sort is an ascending sort, if false the sort is a
            descending sort. The default if the index is missing, is true.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">CASELESS:</emphasis></term>
          <listitem>
          <para>
            If present, the index must be true or false. When true, the sort is case-insensitive, if false the sort is
            case-sensitive. The default if the index is missing, is false.
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">COLUMN:</emphasis></term>
          <listitem>
          <para>
            If present, the index must be a non-negative number, within the range of 0 to the number of subitem columns
            in the list-view. Recall that the first subitem is in column 1, the second subitem is in column 2, and so
            on. The value of the COLUMN index specifies which text the sort is performed on. A value of 0 specifies that
            the sort is performed on the item text. Non-zero values specify that the sort is performed on the text of
            the subitem specified. I.e., a value of 2 specifies the sort is performed on the text of subitem 2. If
            omitted, the default value is 0.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error. An error is unlikely.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The list-view control allows the user (the Rexx programmer) to associate a user
    <link linkend="mthSetItemDataClsListView">data</link> value with any, or all, of the list-view items. The data value can be any
    ooRexx object. For the <emphasis role="italic">sortItems</emphasis> method to work correctly, the programmer must
    associate a data value with each list-view item.
  </para>
  <para>
    The specifics on the item data value and what the programmer needs to do are dependent on the type of sort specified. See
    the relevant section below for a Rexx sort or an internal sort.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Rexx Sort</emphasis></term>
  <listitem>
  <para>
    When the Rexx sort is performed, as the list-view control needs to compare two items it will invoke, through the
    ooDialog framework, the comparison method named by the <emphasis role="italic">methodName</emphasis> argument in the
    Rexx dialog. The return from the Rexx method determines how the items are sorted.
  </para>
  <para>
    The comparison method must return a whole number and this value is passed on to the list-view control. While the
    list-view is sorting, the list is not stable and the comparison method must not invoke any
    <computeroutput>ListView</computeroutput> methods. If methods of the <computeroutput>ListView</computeroutput> object are
    invoked, the results of the sort are unpredictable. The comparison method should be coded as follows:
  </para>

<programlisting>
<![CDATA[
::method compare
  use arg data1, data2, param
]]>
</programlisting>

  <variablelist>
    <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
    <listitem>
    <para>
      The comparison method receives 3 arguments:
    </para>
    <variablelist>
      <varlistentry><term>data1</term>
      <listitem>
      <para>
        The <emphasis role="italic">data value</emphasis> assigned to the first list-view item to be compared. This data
        value is the value the programmer assigned to the item using the <xref linkend="mthSetItemDataClsListView"/> method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>data2</term>
      <listitem>
      <para>
        The <emphasis role="italic">data value</emphasis> assigned to the second list-view item to be compared.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>param</term>
      <listitem>
      <para>
        The <emphasis role="italic">param</emphasis> argument passed to the <emphasis role="italic">sortItems</emphasis>
        method, if it exists. If it was omitted, the param argument will be the <computeroutput>.nil</computeroutput>
        object.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
    <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
    <listitem>
    <para>
      The return must be a whole number. Less than 0 places the first list item before the second item, greater than 0
      places the first item after the second. Return 0 if the two items are equivalent. The programmer determines what number
      to return based on the 2 item data values passed to the method.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Internal Sort</emphasis></term>
  <listitem>
  <para>
    When an internal sort is used, the work of the sort is done in the native API implementation code. In essence, within
    the ooDialog framework. To use this sort, the item data assigned to each list-view item must be a <xref
    linkend="clsLvFullRow"/> object. The item data can be assigned to each item either through the <xref
    linkend="mthSetItemDataClsListView"/> method, or during the <link linkend="mthNewClsLvFullRow">instantiation</link> of the
    <computeroutput>LvFullRow</computeroutput> object. The sort will not work correctly if any item in the list-view does not
    have a <computeroutput>LvFullRow</computeroutput> object assigned as its item data value.
  </para>
  <para>
    The sort is performed on the text of the item, or the text of the subitems of the item. By default, the sort is an
    ascending, case-sensitive, sort of the text of the item. The <emphasis role="italic">param</emphasis> argument can be
    used to change this to a sort on the text of any of the subitems of the item, as explained above.  Ascending or
    descending sorts, as well as case-sensitive or case-insensitive sorts can also be specified using the <emphasis
    role="italic">param</emphasis> argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Rexx Sort Example:</emphasis></term>
  <listitem>
  <para>
    This example shows one approach to sorting the list items on either a first name or last name, and either ascending
    or descending using the Rexx sort:
<programlisting>
<![CDATA[

::method initDialog
  ...
  -- Get the list-view object
  list = self~newListView(IDC_LV)

  -- Get the data value for each list item.
  -- names is an array of .directory objects.
  -- Each .directory object has a fName and a
  -- lName index
  names = self~getFirstLastNames

  do i = 1 to names~items
    list~setItemData(i - 1, names[i])
  end
  ...

::method sortList unguarded
  use strict arg ascending, column, list

  -- column is the column to sort on. Column 1 is
  -- the first name, column 2 is the last name.

  if ascending then list~sortItems(sortUp, column)
  else list~sortItems(sortDown, column)

::method sortUp unguarded
  use arg data1, data2, param

  if param == 1 then return data1~fName~compareTo(data2~fName)
  else return data1~lName~compareTo(data2~lName)

::method sortDown unguarded
  expose field
  use arg data1, data2, param

  if param == 1 then return data2~fName~compareTo(data1~fName)
  else return data2~lName~compareTo(data1~lName)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Internal Sort Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the basic steps needed to set up an internal sort. In the example, a descending, case-insensitive sort
    is done on the text of subitem 3:
<programlisting>
<![CDATA[

::method initDialog
    expose list
    ...

    list = self~newListView(IDC_LV_CONTACTS)
    items = self~createRows

    do r over items
        list~addFullRow(r)
    end

::method createRows private

    ...
        -- As each full row object is instantiated, the last argument
        -- is set to .true to indicate the full row object should be
        -- set as the item data of the list-view item:

        rows[i] = .LvFullRow~new(lvi, lvsi1, lvsi2, lvsi3, .true)

    return rows

-- The onSort() method is connected to a 'Sort' push button
::method onSort unguarded
    expose list

    d = .directory~new
    d~column    = 3
    d~ascending = .false
    d~caseless  = .true

    list~sortItems('InternalListViewSort', d)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::sortItems() -->


<section id="mthSpacing" xreflabel="spacing"><title>spacing</title>
<indexterm><primary>spacing</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~Spacing--------------------------><


]]>
</programlisting>

<para>The spacing method determines the spacing between
items in an icon list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The amount of spacing between the items.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthStringWidth" xreflabel="stringWidth"><title>stringWidth</title>
<indexterm><primary>stringWidth</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~stringWidth(--text--)------------><


]]>
</programlisting>

<para>The stringWidth method determines the width of
a specified string using the current font of the list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>text</term>
<listitem><para>The text string of which the width is to be determined.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The string width, or -1 if you did not specify a <emphasis role="italic">text</emphasis>,
or 0 in all other cases.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthStringWidthPX" xreflabel="stringWidthPX"><title>stringWidthPX</title>
<indexterm><primary>stringWidthPX</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>stringWidthPX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--stringWidthPX(--text--)----------------------><

]]>
</programlisting>

<para>
  Determines the width, in pixels, of the specified string using the list-view's current font.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single arguments is:
    <variablelist>
      <varlistentry><term>text</term>
      <listitem>
      <para>
        The text whose width is desired.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the exact width of the text in pixels, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">stringWidthPx</emphasis> method returns the exact width, in pixels, of the specified
    string. If the returned width is used as the column width in the
 <xref linkend="mthSetColumnWidthPX"/> method, the string will be truncated. To get the column width
    that can contain the string without truncating it, the programmer must add padding to the returned width.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::stringWidthPX() -->


<section id="mthTextBkColor" xreflabel="textBkColor"><title>textBkColor</title>
<indexterm><primary>textBkColor</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~TextBkColor----------------------><


]]>
</programlisting>

<para>The textBkColor method retrieves the background
color of the text in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The <xref linkend="defColorPalette"/> index specifier (0 to 18).

</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthTextBkColorEquals" xreflabel="textBkColor="><title>textBkColor=</title>
<indexterm><primary>textBkColor=</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~textBkColor=(--color--)----------><


]]>
</programlisting>

<para>The textBkColor= method sets the background color
for the text in a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>color</term>
<listitem><para>
  The new background color for text. Specify the <xref linkend="defColorPalette"/>  index specifier (0 to 18).
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthTextColor" xreflabel="textColor"><title>textColor</title>
<indexterm><primary>textColor</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~TextColor------------------------><


]]>
</programlisting>

<para>The textColor method retrieves the text color of
a list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
  The <xref linkend="defColorPalette"/> index specifier (0 to 18).
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthTextColorEquals" xreflabel="textColor"><title>textColor=</title>
<indexterm><primary>textColor=</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~textColor=(--color--)------------><


]]>
</programlisting>

<para>The textColor= method sets the text color of a
list-view control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>color</term>
<listitem><para>
  The new text color. Specify the <xref linkend="defColorPalette"/> index specifier (0 to 18).
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets the text color of a list control to light
blue:
<programlisting>
<![CDATA[
::method LightBlue
  curList = self~newListView(104)
  curList~bkColor = 9
  curList~update
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthUncheckClsListControl" xreflabel="uncheck"><title>uncheck</title>
<indexterm><primary>uncheck</primary>
<secondary>ListView class</secondary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~uncheck(--index--)---------------><

]]>
</programlisting>

<para>The <computeroutput>uncheck</computeroutput> method removes the check mark
for a list-view item.  This method is only valid for list-view controls that
have the check boxes extended style.  (See the
<xref linkend="mthAddExtendedStyle"/> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index of the item where the check box check is to be
removed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
<varlistentry><term>-3</term>
<listitem><para>The index is invalid.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a doctor's office custom
accounting application.  A list box is filled with information for every
patient.  One button in the application checks every patient with an outstanding
balance, they will be mailed a statement for that balance.  The doctor does not
believe in sending billing statements to patients that have a very low balance.
However what a &quot;low&quot; balance is depends on how he is feeling at
statement time. Therefore the application allows the office manager to
dynamically remove some patients from the statement list.
<programlisting>
<![CDATA[

::method onDeferBilling
  expose billingList

  text = self~newEdit(IDC_EDIT_MINAMOUNT)~getText
  minimum = self~decimalNumber(text)

  if minimum > 0 then do i = 0 to billingList~items
    if billingList~isChecked(i) then do

      -- Column 6 in the list is the patient's current balance.
      owes = billingList~itemText(i, 6)
      if self~decimalNumber(owes) <= minimum then billingList~uncheck(i)

    end
  end

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthUncheckAll" xreflabel="uncheckAll"><title>uncheckAll</title>
<indexterm><primary>uncheckAll</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~UncheckAll-----------------------><

]]>
</programlisting>

<para>The <computeroutput>uncheckAll</computeroutput> method clears the check
mark for every list-view item.  This method is only valid for list-view controls
that have the check boxes extended style.  (See the
<xref linkend="mthAddExtendedStyle"/> method for a description
of the check boxes extended style.)
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>This method takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The return values are:
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Success.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>An (internal) problem with the control's window handle.
</para></listitem></varlistentry>
<varlistentry><term>-2</term>
<listitem><para>The list-view control does not have the check boxes extended
style.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example is from a program that has a push button
that allows the user to remove the check mark from all the check boxes:
<programlisting>
<![CDATA[

::method onUncheckAll

  list = self~newListView(IDC_LIST_REPUBLICANS)
  list~uncheckAll

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthUpdateItem" xreflabel="updateItem"><title>updateItem</title>
<indexterm><primary>updateItem</primary></indexterm>
<programlisting>
<![CDATA[
>>-aListControl~updateItem(--item--)-------------><


]]>
</programlisting>

<para>The updateItem method updates a list-view item.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>item</term>
<listitem><para>The number of the item to be updated.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>The item was updated.
</para></listitem></varlistentry>
<varlistentry><term>-1</term>
<listitem><para>You did not specify <emphasis role="italic">item</emphasis>.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>For all other cases.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="clsLvCustomDrawSimple" xreflabel="LvCustomDrawSimple"><title>LvCustomDrawSimple Class</title>
<indexterm><primary>LvCustomDrawSimple class</primary></indexterm>
<para>
  A <computeroutput>LvCustomDrawSimple</computeroutput> object is used when a <link
  linkend="clsListView">ListView</link> control is registered for <emphasis role="italic">simple</emphasis> <link
  linkend="clsCustomDraw">custom</link> draw. A <computeroutput>LvCustomDrawSimple</computeroutput> object is passed to the
  CUSTOMDRAW event handler. It supplies both information to the event handler and returns information back to the Windows
  control. The attributes of the object convey the information both ways.
</para>
<para>
  When the ooDialog framework receives information from the Windows custom draw control, it instantiates a
  <computeroutput>LvCustomDrawSimple</computeroutput>object, assigns values to the attributes of the object, and sends the
  object to the Rexx dialog's event handler. The programmer uses the assigned values to determine what action to take and
  then assigns values to the object's attributes to convey information back to the Windows control. The
  <computeroutput>LvCustomDrawSimple</computeroutput> object is specific to the <computeroutput>ListView</computeroutput>
  class. Other ooDialog controls that support custom draw have their own class that performs a similar function, but whose
  attributes are specific to that control. For instance, the <link linkend="clsTreeView">TreeView</link> class uses the <link
  linkend="clsTvCustomDrawSimple">TvCustomDrawSimple</link> for its CUSTOMDRAW event handler.
</para>

<section id="evtListViewCustomDraw" xreflabel="List-view CustomDraw Event Handler"><title>CustomDraw Event Handler</title>
<indexterm><primary>ListView class</primary><secondary>events</secondary><tertiary>CUSTOMDRAW</tertiary></indexterm>
<indexterm><primary>custom draw</primary><secondary>list-view control</secondary></indexterm>
<para>
  When the list-view control is registered for <xref linkend="sctSimpleCustomDraw"/> custom draw, the event handler is
  invoked when the draw stage is item prepaint. Depending on the response from the event handler to the item prepaint
  notification, the event handler will also be invoked when the draw stage is subitem prepaint. For simple custom draw, the
  ooDialog framework handles the other draw stages internally. It makes the appropriate response to the dialog control so
  that the dialog control will send the item prepaint notifications. It is then up to the programmer to request that the
  control send the subitem prepaint notifications.
</para>
<para>
  The single argument passed to the event handler is a <computeroutput>LvCustomDrawSimple</computeroutput> object. The event
  handler examines the values of the attributes of the object to determine the information sent by the underlying list-view
  control. The event handler then assigns values to the object that specify how the list-view control should draw the item,
  or subitem. Finally, the programmer returns true to have the updated information passed on to the list-view, or false to
  have the list-view draw the item as it normally would.
</para>

<programlisting>
<![CDATA[
::method onCustomDraw unguarded
  use arg lvcdSimple

  return boolean
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 1 argument:
  </para>
  <variablelist>
    <varlistentry><term>lvcdSimple</term>
    <listitem>
    <para>
      A <computeroutput>LvCustomDrawSimple</computeroutput> object whose attributes are used to convey information back and
      forth between the underlying list-view control and the event handler.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    Return true to indicate that the attributes in the <computeroutput>LvCustomDrawSimple</computeroutput> object are to be
    used by the list-view when drawing the item or subitem. Return false to indicate the list-view should draw the item
    itself. Returning false is the equivalent of using the <xref linkend="cnstCDRF_DODEFAULT"/> value for the response to the
    list-view.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The key to using custom draw is to examine the attributes of the <computeroutput>LvCustomDrawSimple</computeroutput>
    object sent as the argument to the event handler to determine which item is about to be drawn, and then set attributes in
    the object to customize the drawing of that item.
  </para>
  <para>
    As an example, say the goal was to shade every other row in the list-view when in report mode. The event handler will be
    invoked before each item is to be painted. The programmer would examine the <xref linkend="atrItem"/> attrbute to
    determine if it was an odd or even row. If the row was even, the color attributes, <xref linkend="atrClrTextBk"/> and
    <xref linkend="atrClrText"/>, would be set to the desired colors to shade the row. The <xref linkend="atrReplyLV"/>
    attribute would be set to a response value that indicates to the list-view is to use the information in the object to
    draw the item, and the event handler would return true. If the row was odd, the event handler would simply return false
    to indicate that the list-view should draw the item itself. The following code snippet demonstrates this:

<programlisting>
<![CDATA[

::method init
    expose rowYellow

    forward class (super) continue

    self~customDraw
    self~customDrawControl(IDC_LV_CUSTOM, 'ListView', onCustomDraw)

    rowYellow   = self~RGB(245, 245, 127)
    ...

::method onCustomDraw unguarded
    expose rowYellow
    use arg cdInfo

    item = cdInfo~item

    if (item // 2) == 0 then do
        cdInfo~clrText   = self~CLR_DEFAULT
        cdInfo~clrTextBk = rowYellow
        cdInfo~reply     = self~CDRF_NOTIFYITEMDRAW
        return .true
    end
    else do
        return .false
    end

]]>
</programlisting>

  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example is an expansion of the example in the remarks section. It has a list-view that has check boxes. If
    an item is checked then a new font is set for that row, along with different colors. Othewise, alternating rows are
    shaded with a different color:
<programlisting>
<![CDATA[

::method onCustomDraw unguarded
    expose list textRed textBlack textBlue rowGreen rowLiteBlue rowYellow checkedFont
    use arg cdInfo

    item = cdInfo~item

    if list~isChecked(item) then do
        cdInfo~clrText   = textBlue
        cdInfo~clrTextBk = rowLiteBlue
        cdInfo~font      = checkedFont
    end
    else if (item // 2) == 0 then do
        cdInfo~clrText   = textRed
        cdInfo~clrTextBk = rowYellow
    end
    else do
        cdInfo~clrText   = textBlack
        cdInfo~clrTextBk = rowGreen
    end

    cdInfo~reply = self~CDRF_NEWFONT
    return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End CustomDraw Event Handler -->

<section id="sctMethodsLvCustomDrawSimple"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>LvCustomDrawSimple</computeroutput> class:

<table id="tblMethodsLvCustomDrawSimple" frame="all"> <title>LvCustomDrawSimple Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*"/>
<colspec colwidth="4*"/>
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="mthNewClsLvCustomDrawSimple">new</link></entry>
<entry>The Rexx programmer can not instantiate a <computeroutput>LvCustomDrawSimple</computeroutput>object, the ooDialog framework instantiates these objects</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrClrText"/> </entry>
<entry>Reflects a custom color that the text of the list-view item should be drawn with.</entry>
</row>
<row>
<entry><xref linkend="atrClrTextBk"/> </entry>
<entry>Reflects a custom color that the text background of the list-view itme should be drawn with.</entry>
</row>
<row>
<entry><xref linkend="atrDrawStage"/> </entry>
<entry>Reflects the draw <link linkend="sctCustomDrawOverview">stage</link> of the current paint cycle.</entry>
</row>
<row>
<entry><xref linkend="atrFont"/> </entry>
<entry>Reflects a custom font that the list-view should use for the text.</entry>
</row>
<row>
<entry><xref linkend="atrIDLV"/> </entry>
<entry>Reflects the resource ID of the list-view control sending the custom draw event notification message.</entry>
</row>
<row>
<entry><xref linkend="atrItem"/> </entry>
<entry>Reflects the 0-based index of the list-view item that needs to be drawn.</entry>
</row>
<row>
<entry><xref linkend="atrItemDataClsLvCustomDrawSimple"/></entry>
<entry>Reflects the <emphasis role="italic">item data</emphasis> for the list-view item that needs to be drawn.</entry>
</row>
<row>
<entry><xref linkend="atrReplyLV"/> </entry>
<entry>Reflects the <link linkend="sctConstantsClsCustomDraw">CDRF_*</link> response value that is used to reply to the event notification.</entry>
</row>
<row>
<entry><xref linkend="atrSubItem"/> </entry>
<entry>Reflects the index of the subitem that needs to be drawn.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsLvCustomDrawSimple" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>LvCustomDrawSimple class</secondary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new------------------------------------------><

]]>
</programlisting>

<para>
  The <computeroutput>LvCustomDrawSimple</computeroutput> class can not be instantiated by the Rexx programmer. When
  needed, the ooDialog framework instantiates a <computeroutput>LvCustomDrawSimple</computeroutput> object and passes
  it to the dialog's custom draw <link linkend="evtListViewCustomDraw">event</link> handler.
</para>
</section>  <!-- End LvCustomDrawSimple::new() -->

<section id="atrClrText" xreflabel="clrText"><title>clrText (Attribute)</title>
<indexterm><primary>clrText</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>clrText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--clrText--------------------------------------><

>>--clrText-=-varName----------------------------><

]]>
</programlisting>

<para>
  Reflects a custom color that the text of the list-view item should be drawn with. This attribute is information sent back
  to the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">clrText get:</emphasis></term>
  <listitem>
  <para>
    This is a set-only attribute, it is information to be sent back to the list-view control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">clrText set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to the color value for the text of the item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To construct the proper color value use the <xref linkend="mthRGB"/> method of the
    <computeroutput>CustomDraw</computeroutput> class. The <xref linkend="cnstCLR_DEFAULT"/> value can also be used to have
    the item text be drawn in the default list-view color.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example snippet of code the <emphasis role="italic">clrText</emphasis> attribute is set to a reddish color and
    the background color is set to a yellowish color:
<programlisting>
<![CDATA[

  cdInfo~clrText   = self~RGB(247,   7,  59)
  cdInfo~clrTextBk = self~RGB(245, 245, 127)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::clrText() [attribute]  -->

<section id="atrClrTextBk" xreflabel="clrTextBk"><title>clrTextBk (Attribute)</title>
<indexterm><primary>clrTextBk</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>clrTextBk</secondary></indexterm>
<programlisting>
<![CDATA[
>>--clrTextBk------------------------------------><

>>--clrTextBk = varName--------------------------><

]]>
</programlisting>

<para>
  Reflects a custom color that the text background of the list-view itme should be drawn with. This attribute is information
  sent back to the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">clrTextBk get:</emphasis></term>
  <listitem>
  <para>
    This is a set-only attribute, it is information to be sent back to the list-view control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">clrTextBk set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to a custom color that should be used for the text background when the item is drawn.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To construct the proper color value use the <xref linkend="mthRGB"/> method of the
    <computeroutput>CustomDraw</computeroutput> class. The <xref linkend="cnstCLR_DEFAULT"/> value can also be used to have
    the item text background drawn in the default list-view color.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example snippet of code the <emphasis role="italic">clrText</emphasis> attribute is set to a reddish color and
    the background color is set to a yellowish color:
<programlisting>
<![CDATA[

  cdInfo~clrText   = self~RGB(247,   7,  59)
  cdInfo~clrTextBk = self~RGB(245, 245, 127)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::clrTextBk() [attribute]  -->

<section id="atrDrawStage" xreflabel="drawStage"><title>drawStage (Attribute)</title>
<indexterm><primary>drawStage</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>drawStage</secondary></indexterm>
<programlisting>
<![CDATA[
>>--drawStage------------------------------------><

>>--drawStage = varName--------------------------><

]]>
</programlisting>

<para>
  Reflects the draw <link linkend="sctCustomDrawOverview">stage</link> of the current paint cycle. This attribute is
  information sent from the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">drawStage get:</emphasis></term>
  <listitem>
  <para>
    Returns the draw stage constant value as sent by the list-view control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">drawStage set:</emphasis></term>
  <listitem>
  <para>
    This is a get-only attribute. It is information sent from the list-view control and can not be changed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In <link linkend="sctSimpleCustomDraw">simple</link> custom draw, the ooDialog framework handles many of draw stage
    notifications internally and the event handler only gets invoked for 2 of the draw stages. Because of this, the draw stage
    value will always be either <xref linkend="cnstCDDS_ITEMPREPAINT"/> or <xref linkend="cnstCDDS_SUBITEMPREPAINT"/>. In
    addition, the value will only be CDDS_SUBITEMPREPAINT if the programmer has requested subitem notifications by setting
    the <xref linkend="atrReplyLV"/> attribute to <xref linkend="cnstCDRF_NOTIFYSUBITEMDRAW"/> in response to an item prepaint
    notification.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from a program that uses a custom font and color for the entire row, if the item is checked. If not
    checked then it uses custom draw for each subitem. The draw stage will either be CDDS_ITEMPREPAINT or
    CDDS_SUBITEMPREPAINT. If it is CDDS_ITEMPREPAINT, then the event hander determines if the item is checked.
  </para>
  <para>
    When the item is checked, the event handler sets the custom color and font. Then, because it does not return
    CDRF_NOTIFYSUBITEMDRAW in the response, the list-view draws the entire row in the custom color and font, and does
    <emphasis role="italic">not</emphasis> send any subitem notifications. When the item is not checked, CDRF_NOTIFYSUBITEM
    is set in the response and this causes the list-view to send event notifications for each subitem:

<programlisting>
<![CDATA[

  ...

  if cdInfo~drawStage == self~CDDS_ITEMPREPAINT then do
      if list~isChecked(item) then do
          cdInfo~clrText   = textBlue
          cdInfo~clrTextBk = rowLiteBlue
          cdInfo~font      = checkedFont
          cdInfo~reply     = self~CDRF_NEWFONT
      end
      else do
          cdInfo~reply = self~CDRF_NOTIFYSUBITEMDRAW
      end
      return .true
  end

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::drawStage() [attribute]  -->

<section id="atrFont" xreflabel="font"><title>font (Attribute)</title>
<indexterm><primary>font</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>font</secondary></indexterm>
<programlisting>
<![CDATA[
>>--font-----------------------------------------><

>>--font = varName-------------------------------><

]]>
</programlisting>

<para>
  Reflects a custom font that the list-view should use for the text. This attribute is information sent back to the list-view
  control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">font get:</emphasis></term>
  <listitem>
  <para>
    This is a set-only attribute, it is information to be sent back to the list-view control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">font set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to the <xref linkend="defHandle"/> of a font to used for the text of the item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To have the font drawn in the default font of the list-view simply do not set the <emphasis role="italic">font</emphasis>
    attribute to anything. For example, if the color for the font should be changed, but not the font itself, then the
    programmer should not set this attribute.
  </para>
  <para>
    Use the <xref linkend="mthCreateFontEx"/> method to get the handle of a font. Microsoft recommends that the response code
    when a new font is to be used include <xref linkend="cnstCDRF_NEWFONT"/> value. If the programmer also needs subitem
    notifications and is changing the font, then the CDRF_NEWFONT code should be combined with the <xref
    linkend="cnstCDRF_NOTIFYSUBITEMDRAW"/> value. The <xref linkend="mthOrClsDlgUtil"/> method of the
    <computeroutput>DlgUtil</computeroutput> class can be used to combine the values.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the <emphasis role="italic">font</emphasis> attribute being set and the response codes for new font
    and subitem notify being combined:
<programlisting>
<![CDATA[

  checkedFont = self~createFontEx("Courier New", 10)

  ...

  item = cdInfo~item

  if list~isChecked(item) then do
      cdInfo~clrText   = self~RGB( 17,   5, 250)
      cdInfo~clrTextBk = self~RGB(115, 245, 186)
      cdInfo~font      = checkedFont
      cdInfo~reply     = .DlgUtil~or(self~CDRF_NEWFONT, self~CDRF_NOTIFYSUBITEMDRAW)
  end

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::font() [attribute]  -->

<section id="atrIDLV" xreflabel="id"><title>id (Attribute)</title>
<indexterm><primary>id</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>id</secondary></indexterm>
<programlisting>
<![CDATA[
>>--id-------------------------------------------><

>>--id = varName---------------------------------><

]]>
</programlisting>

<para>
  Reflects the resource ID of the list-view control sending the custom draw event notification message. This attribute is
  information sent from the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">id get:</emphasis></term>
  <listitem>
  <para>
    Returns the numeric <xref linkend="defResourceId"/> of the list-view control that sent the custom draw event
    notification.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">id set:</emphasis></term>
  <listitem>
  <para>
    This is a get-only attribute. It is information sent from the list-view control and can not be changed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example uses custom draw with a list-view and a tree-view. It uses the same event handler, <emphasis
    role="italic">onCustomDraw</emphasis> for both controls and then use the <emphasis role="italic">id</emphasis> attribute
    to determine which control has sent the event notification:
<programlisting>
<![CDATA[

  self~customDraw
  self~customDrawControl(IDC_LV_STATS, 'ListView', onCustomDraw)
  self~customDrawControl(IDC_TV_PLAYERS, 'TreeView', onCustomDraw)

  ...

::method onCustomDraw unguarded
    use arg customDrawInfo

    if customDrawInfo~ID == .constDir[IDC_LV_STATS] then
        return self~customDrawStats(customDrawInfo)
    else
        return self~customDrawPlayers(customDrawInfo)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::id() [attribute]  -->

<section id="atrItem" xreflabel="item"><title>item (Attribute)</title>
<indexterm><primary>item</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>item</secondary></indexterm>
<programlisting>
<![CDATA[
>>--item-----------------------------------------><

>>--item = varName-------------------------------><

]]>
</programlisting>

<para>
  Reflects the 0-based index of the list-view item that needs to be drawn. This attribute is information sent from the
  list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">item get:</emphasis></term>
  <listitem>
  <para>
    Returns the item index that the event notifications is for.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">item set:</emphasis></term>
  <listitem>
  <para>
    This is a get-only attribute. It is information sent from the list-view control and can not be changed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Use the item index to determine exactly which item or subitem is going to be painted.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shades every other row in the list-view. It uses the <emphasis role="italic">item</emphasis> attribute to
    determine if the row is an even or odd row:
<programlisting>
<![CDATA[

::method onCustomDraw unguarded
    expose rowYellow
    use arg cdInfo

    if (cdInfo~item // 2) == 0 then do
        cdInfo~clrText   = self~CLR_DEFAULT
        cdInfo~clrTextBk = rowYellow
        cdInfo~reply     = self~CDRF_NOTIFYITEMDRAW
        return .true
    end
    else do
        return .false
    end


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::item() [attribute]  -->

<section id="atrItemDataClsLvCustomDrawSimple" xreflabel="itemData"><title>itemData (Attribute)</title>
<indexterm><primary>itemData</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>itemData</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemData-------------------------------------><

>>--itemData = varName---------------------------><

]]>
</programlisting>

<para>
  Reflects the item <emphasis role="italic">data</emphasis> for the list-view item that needs to be drawn. This attribute is
  information sent from the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">itemData get:</emphasis></term>
  <listitem>
  <para>
    Returns the item data object for the item about to be drawn, or <computeroutput>.nil</computeroutput> if no item data was
    set for the item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">itemData set:</emphasis></term>
  <listitem>
  <para>
    This is a get-only attribute. It is information sent from the list-view control and can not be changed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The list-view allows the programmer to associate a value with any list-view item. This item data value is sent by the
    list-view in the event notification information. The programmer can set the item data for a list-view item in several
    ways. The <xref linkend="mthSetItemDataClsListView"/> of the <xref linkend="clsListView"/> class, the <emphasis
    role="italic">itemData</emphasis> argument of the <xref linkend="mthNewClsLvItem"/> method of the <xref
    linkend="clsLvItem"/> class, or the <xref linkend="atrItemDataClsLvi"/> attribute of the
    <computeroutput>LvItem</computeroutput> class are all used to set the item data value for an item.
  </para>
  <para>
    The <emphasis role="italic">itemData</emphasis> attribute could be used to help decide how to custom draw the list-view
    item or subitem, see the example below.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example the color to draw the text for each item is stored in the item data for the item. This makes for a very
    simple event handler, the text color is just set to whatever value the item data is:
<programlisting>
<![CDATA[

::method onCustomDraw unguarded
    use arg lvcds

    lvcds~clrText   = lvcds~itemData
    lvcds~clrTextBk = self~CLR_DEFAULT
    lvcds~reply     = self~CDRF_NEWFONT

    return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::itemData() [attribute]  -->


<section id="atrReplyLV" xreflabel="reply"><title>reply (Attribute)</title>
<indexterm><primary>reply</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>reply</secondary></indexterm>
<programlisting>
<![CDATA[
>>--reply----------------------------------------><

>>--reply = varName------------------------------><

]]>
</programlisting>

<para>
  Reflects the <link linkend="sctConstantsClsCustomDraw">CDRF_*</link> response value that is used to reply to the event
  notification. This attribute is information sent back to the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">reply get:</emphasis></term>
  <listitem>
  <para>
    This is a set-only attribute, it is information to be sent back to the list-view control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">reply set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">reply</emphasis> attribute should be set to one or a combination, of the CDRF_* constant
    values.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">reply</emphasis> attribute can be set to any valid combination of CDRF_* values. However, in
    <emphasis role="italic">simple</emphasis> custom draw only a few values make any sense. These are CDRF_NOTIFYITEMDRAW,
    CDRF_NOTIFYSUBITEMDRAW, and CDRF_NEWFONT.
  </para>
  <para>
    Rather than set <emphasis role="italic">reply</emphasis> to CDRF_DODEFAULT and returning true from the event handler, the
    programmer should just return false from the event handler. Using any of the other CDRF_* values, in simple custom draw,
    will have no effect in the Rexx program and will cause the list-view control to send unnecessary event notifications.
  </para>
  <para>
    The only combination of CDRF_* values that make sense is combining CDRF_NEWFONT and CDRF_NOTIFYSUBITEMDRAW. And, this is
    really only needed if the font is being changed and subitem notifications are desired. If only the colors are changed
    when subitem notifications are desired, then it is sufficient to use CDRF_NOTIFYSUBITEMDRAW by itself. Use the <xref
    linkend="mthOrClsDlgUtil"/> method to combine two values if needed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows setting the <emphasis role="italic">reply</emphasis> attribute using both the new font and notify
    subitem draw values:
<programlisting>
<![CDATA[

  customDraw~reply = .DlgUtil~or(self~CDRF_NEWFONT, self~CDRF_NOTIFYSUBITEMDRAW)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::reply() [attribute]  -->

<section id="atrSubItem" xreflabel="subItem"><title>subItem (Attribute)</title>
<indexterm><primary>subItem</primary></indexterm>
<indexterm><primary>LvCustomDrawSimple class</primary><secondary>subItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--subItem--------------------------------------><

>>--subItem = varName----------------------------><

]]>
</programlisting>

<para>
  Reflects the index of the subitem that needs to be drawn. This attribute is information sent from the list-view control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">subItem get:</emphasis></term>
  <listitem>
  <para>
    Returns the subitem index that needs to be drawn. The value only has meaning if the <xref linkend="atrDrawStage"/>
    attribute is <xref linkend="cnstCDDS_SUBITEMPREPAINT"/>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">subItem set:</emphasis></term>
  <listitem>
  <para>
    This is a get-only attribute. It is information sent from the list-view control and can not be changed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Experimentation has shown that when subitem notifications have been requested, when the CDDS_ITEMPREPAINT draw stage
    notification is sent, the <emphasis role="italic">subItem</emphasis> value is not always 0. This would indicate that the
    list-view control only bothers to set the <emphasis role="italic">subitem</emphasis> value for the CDDS_SUBITEMPREPAINT
    notification.
  </para>
  <para>
    When the draw stage is CDDS_SUBITEMPREPAINT, if the item itself is being drawn, then <emphasis
    role="italic">subItem</emphasis> will be 0. Otherwise, <emphasis role="italic">subItem</emphasis> will be 1 for the first
    subitem, 2 for the second subitem, and so on.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is a snippet of code from a program where the second subitem in a list-view is a number. If the number is
    negative, it is drawn in red text and if it is not negative, is is drawn in black text:
<programlisting>
<![CDATA[

  if customDrawInfo~subItem == 2 then do
      number = list~itemText(customDrawInfo~item, 2)
      if number < 0 then
          customDrawInfo~clrText = textRed
      else
          customDrawInfo~clrText = textBlack
  end

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvCustomDrawSimple::subItem() [attribute]  -->

</section> <!-- End LvCustomDrawSimple Class -->


<section id="clsLvFullRow" xreflabel="LvFullRow"><title>LvFullRow Class</title>
<indexterm><primary>LvFullRow class</primary></indexterm>
<para>
  A <computeroutput>LvFullRow</computeroutput> object is used in ooDialog to represent a list-view item and all subitems
  of that item. A <computeroutput>LvFullRow</computeroutput> object is composed of a <xref linkend="clsLvItem"/> object whose
  attributes reflect the list-view item and zero or more <xref linkend="clsLvSubItem"/> objects that reflect the subitems of
  the list-view item in the <link linkend="ovvUnderlying">underlying</link> list-view.
</para>
<para>
  Normally, the subitems of a list-view item are only thought about when the list-view is in report view. However, once added
  to an item, the subitems exist whatever view the list-view is in.  A full row object can be used to add or insert list-view
  items along with all the subitems of the item, or to query information about a list-view item and its subitems.
</para>
<para>
  <computeroutput>LvFullRow</computeroutput> objects also provide the infrastructure that allows the ooDialog framework to
  <link linkend="mthSortItems">internally</link> sort list-view items.
</para>


<section id="sctInternalSorting"><title>Internal Sorting Considerations</title>
<indexterm><primary>internal sorting</primary><secondary>LvFullRow Class</secondary></indexterm>
<indexterm><primary>internal sorting</primary><secondary>ListView Class</secondary></indexterm>
<para>
  The <xref linkend="mthSortItems"/> method is used to sort list-view items. One option of this method is to have the
  ooDialog framework implement the sort internally. The internal sort can be significantly faster, for large lists, than
  implementing the sort in Rexx. However, the internal sorting is dependent on the <computeroutput>LvFullRow</computeroutput>
  class. There are a few things the Rexx programmer needs to be aware of that effect the ability of the ooDialog framework to
  do an internal sort.
</para>
<para>
  Any sorting of the list-view items, whether it is through a sort implemented in Rexx or the internal sort, is dependent on
  <link linkend="mthSetItemDataClsListView">setting</link> a value for the item data of every list-view item. For the
  internal sort to work, the item data value must be a <computeroutput>LvFullRow</computeroutput> object. There are several
  approaches that could be used to assign a full row object to the item data of every list-view item. One approach would be
  to iterate through all the list-view items, for each item, instantiate a full row object for the item, and use the <xref
  linkend="mthSetItemDataClsListView"/> method to assign the object to the item.
</para>
<para>
  However, full row objects can also be used to add items to the list-view through one the <xref linkend="mthAddFullRow"/>,
  <xref linkend="mthInsertFullRow"/>, or <xref linkend="mthPrependFullRow"/> methods. A second approach is to add all
  list-view items using full row objects and have the ooDialog framework set the full row object as the item data when the
  item is added to the list-view. To use this technique, the programmer should set the <emphasis
  role="italic">sorting</emphasis> argument to true when <link linkend="mthNewClsLvFullRow">instantiating</link> the full row
  object.
</para>
<para>
  In a way, a full row object is a snapshot of the information the list-view control maintains about a specific item in the
  list. This information can change over time as the application is used. For instance, the text of an item could be changed.
  When a full row object is assigned as the item data of a list-view item, the ooDialog framework does its best to keep the
  full row object updated with any changes made to the information of the list-view item. But, there is one scenario where
  this is not always possible. The Rexx programmer needs to be aware of this and take the proper steps to keep the full row
  object in synch with the list-view item.
</para>
<para>
  When a subitem column in the list-view is <link linkend="mthInsertColumnPX">inserted</link>
  or <link linkend="mthDeleteColumn">deleted</link>, the list-view control adds or deletes the subitems of all
  items that corresponds to the column. Every item in a list-view always has the same number of subitems. If all items in the
  list-view have a <computeroutput>LvFullRow</computeroutput> object set as the item data, when a column is deleted, the full
  row object will have one too many subitems. The same if a column is added, the full row object will have no knowledge of
  the new subitem. <emphasis role="bold">Note</emphasis> that there is no problem the very first time a column is inserted
  in a list-view and this only applies to <emphasis role="italic">subitem</emphasis> columns. The information for a
  list-view item is not deleted by deleting its column, column 0. In addition, this discussion only concerns the case where
  <computeroutput>LvFullRow</computeroutput> objects have been assigned to the item data of each item to facilitate internal
  sorting.
</para>
<para>
  Most ooDialog programs that use a list-view do not involve inserting or removing columns after the list-view items have
  been added. But, for programs that do <emphasis role="italic">and</emphasis> use <computeroutput>LvFullRow</computeroutput>
  objects to allow internal sorting, the programmer must take an additional step when a column is inserted or deleted. This
  ensures the integrity of the full row objects. ooDialog provides 3 methods to ensure integrity when a column is inserted or
  deleted:
</para>

<variablelist>
  <varlistentry><term><emphasis role="bold">The fixFullRowColumns method:</emphasis></term>
  <listitem>
  <para>
    ooDialog provides the <xref linkend="mthFixFullRowColumns"/> method of the <computeroutput>ListView</computeroutput>
    which can be used to bring all the full row objects back in sync. It must be invoked after each individual column insert
    and delete to work correctly. That is, the programmer can not delete 2 columns and then invoke the <emphasis
    role="italic">fixFullRowColumns</emphasis> twice. The method is invoked with the column index that was removed or added
    and a second argument that signals whether the specified column was inserted. The following code snippet gives an
    example:
<programlisting>
<![CDATA[
    list~insertColumnPX(2, "Phone Numbers", 155, "RIGHT")
    list~fixFullRowColumns(2, .true)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">The adjustFullRows argument:</emphasis></term>
  <listitem>
  <para>
    The methods that insert or delete columns in the list-view have an optional second argument, <emphasis
    role="italic">adjustFullRows</emphasis>. If this argument is true, then the ooDialog framework is signaled to fix up the
    full row objects internally when the column is added or deleted. The default for the argument is false. This is perhaps
    the easiest process for the programmer to use. The above example would be altered like this:
<programlisting>
<![CDATA[
    list~insertColumnPX(2, "Phone Numbers", 155, "RIGHT", .true)

]]>
</programlisting>
    The reason that the default here is false is that with very large lists, the time to fix up the full row objects can be
    noticeable, .5 to 1.5 seconds for lists with over 10,000 items. Because of this, the programmer may not want the fix up
    to happen during the insertion or deletion of a column.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Manual update</emphasis></term>
  <listitem>
  <para>
    With this method, after the column insert or delete, the programmer iterates through all the list-view items, removes the
    old invalid item data, creates a valid full row object, and sets the item data to the new full row object. The following
    code snippet shows the procedure:
<programlisting>
<![CDATA[

    list~deleteColumn(delCol)

    do i = 0 to list~items - 1
      list~removeItemData(i)
      lvFullRow = list~getFullRow(i, .true)
      list~setItemData(i, lvFullRow)
    end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="sctMethodsLvFullRow"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>LvFullRow</computeroutput> class:

<table id="tblMethodsLvFullRow" frame="all"> <title>LvFullRow Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*"/>
<colspec colwidth="4*"/>
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class</emphasis></entry>
<entry align="center"><emphasis role="bold">Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthFromArray"/></entry>
<entry>Instantiates a new <computeroutput>LvFullRow</computeroutput> object from an array of values. The string value of each item in the array is used as the text for the item and subitem(s).</entry>
</row>
<row>
<entry><xref linkend="mthNewClsLvFullRow"/></entry>
<entry>Instantiates a new <computeroutput>LvFullRow</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attribute</emphasis></entry>
<entry align="center"><emphasis role="bold">Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrUserDataClsLvFr"/></entry>
<entry>The <emphasis role="italic">userData</emphasis> attribute allows the programmer to associate some data with a <computeroutput>LvFullRow</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance</emphasis></entry>
<entry align="center"><emphasis role="bold">Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthAddSubItem"/></entry>
<entry>Adds a subitem to this full row. Subitems are always added as the last subitem in the row.</entry>
</row>
<row>
<entry><xref linkend="mthInsertSubItem"/></entry>
<entry>Inserts a new subitem into this full row and adjusts the subitem indexes for  all existing subitems, when needed.</entry>
</row>
<row>
<entry><xref linkend="mthItem"/></entry>
<entry>Returns the <xref linkend="clsLvItem"/> object of this full row.</entry>
</row>
<row>
<entry><xref linkend="mthRemoveSubItem"/></entry>
<entry>Removes the specified subitem from this full row.</entry>
</row>
<row>
<entry><xref linkend="mthSubItem"/></entry>
<entry>Returns the subitem specified by <emphasis role="italic">index</emphasis> of this full row, or the <computeroutput>.nil</computeroutput> object if the subitem <emphasis role="italic">index</emphasis> is not valid.</entry>
</row>
<row>
<entry><xref linkend="mthSubItems"/></entry>
<entry>Returns the count of subitems in this full row.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthFromArray" xreflabel="fromArray"><title>fromArray (Class Method)</title>
<indexterm><primary>fromArray</primary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>fromArray</secondary></indexterm>
<programlisting>
<![CDATA[
>>--fromArray(--data--+-----------+--+-------------+--+------------------+--)--><
                      +-,-iIndex--+  +-,-strIfNil--+  +-,-useForSorting--+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>LvFullRow</computeroutput> object from an array of values. The string value of each item
  in the array is used as the text for the item and subitem(s).
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>data [required]</term>
    <listitem>
    <para>
      An array object. The string value of each item in the array is used as the text for the item and subitems of the
      list-view item. The item at index 1 of the array is used as the text for the list-view item. The item at index 2 is
      used as the text for the first subitem, the item at index 3 is used as the text for subitem 2, etc.. The array can
      not be sparse
    </para>
    </listitem></varlistentry>
    <varlistentry><term>iIndex [optional]</term>
    <listitem>
    <para>
      The item index to use for the full row. If omitted, 0 is used for the item index. See the remarks, depending on the
      use of the returned full row object, specifying an index is often not needed.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>strIfNil [optional]</term>
    <listitem>
    <para>
      If the item at any index in <emphasis role="italic">data</emphasis> array is the <computeroutput>.nil</computeroutput>
      object, then the text for the item or subitem corresponding to that index will be the string value of the
      <computeroutput>.nil</computeroutput> object. Which is <emphasis role="italic">the NIL object</emphasis>. The <emphasis
      role="italic">strIfNil</emphasis> argument can be used to specify text to use instead of <emphasis role="italic">the
      NIL object</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>useForSorting [optional]</term>
    <listitem>
    <para>
      This argument can be either true or false. Recall that the list-view control allows the programmer to <link
      linkend="mthSetItemDataClsListView">attach</link> an item data value to any or all of the list-view items. If the item
      data for every list-view item is a <computeroutput>LvFullRow</computeroutput> object, the ooDialog framework can
      perform internal <link linkend="mthSortItems">sorting</link> of the list-view items. Use true to specify that the
      <computeroutput>LvFullRow</computeroutput> object being instantiated should be set as the item data value for the
      list-view item the object represents. If false, the full row object is not set as the item data. The default is false.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A newly instantiated <computeroutput>LvFullRow</computeroutput> object on success, the
    <computeroutput>.nil</computeroutput> object on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The returned full row object is intended to be used to insert an item into a list-view.  Other uses of the full row
    object may cause unpredictable results. It is the responsibility of the programmer to determine if the full row object
    is suitable for some other use. The programmer should consider that only the text attribute of the full row item and its
    subitems is set.
  </para>
  <para>
    Recall that if the full row object is used in either the <xref linkend="mthAddFullRow"/> or <xref
    linkend="mthPrependFullRow"/> methods, the item index of the full row object is ignored.  For the
    <xref linkend="mthInsertFullRow"/> method, if  the item index is 0, the method will work fine, the full row will be
    inserted as the first item in the list-view. Therefore the optional <emphasis role="italic">itemIndex</emphasis> argument
    is never needed, and, depending on the use of the full row object, may be a waste of time.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example queries a ooSQLite database and then populates the list-view with the returned result set:
<programlisting>
<![CDATA[

  sql  = 'SELECT * FROM foods ORDER BY name;'
  data = dbConn~exec(sql, .true)
  dbConn~close

  self~insertListViewColumns(list, data[1])
  do i = 2 to data~items
      fRow = .LvFullRow~fromArray(data[i], , 'null', .true)
      list~addFullRow(fRow)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::fromArray() -->

<section id="mthNewClsLvFullRow" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>LvFullRow class</secondary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
                +--------------+
                V              |
>>--new(--item--+--------------+--+-----------+--)--------------><
                +--,--subItem--+  +-,-sorting-+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>LvFullRow</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>item [required]</term>
    <listitem>
    <para>
      A <link linkend="clsLvItem">LvItem</link> object that specifies the attributes of the list-view item being added.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>subItem [optional]</term>
    <listitem>
    <para>
      A <link linkend="clsLvSubItem">LvSubItem</link> object that specifies the attributes of a subitem of the list-view
      item being added. The argument can repeat has many times as needed to specify all the subitems of the item. The
      subitems are added to the item in the order of the arguments to the <emphasis role="italic">new</emphasis> method.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>sorting [optional]</term>
    <listitem>
    <para>
      The very last argument can optionally be <computeroutput>.true</computeroutput> or
      <computeroutput>.false</computeroutput> to signal that the <computeroutput>LvFullRow</computeroutput> object itself is
      to be assigned as the item data value of the list-view items. This usage is explained in the remarks section.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the new <computeroutput>LvFullRow</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Each subitem argument must be specified. If a subitem is omitted and a subitem argument follows it, a syntax
    condition is raised. That is, if a subitem is specified, its preceding subitem must not have been omitted. These
    statements are acceptable:

<programlisting>
<![CDATA[
     row = .LvFullRow~new(item)
     row = .LvFullRow~new(item, si1, si2)
     row = .LvFullRow~new(item, si1, si2, si3)
]]>
</programlisting>

    These statements will raise a syntax condition:

<programlisting>
<![CDATA[
     row = .LvFullRow~new(item, , si2)
     row = .LvFullRow~new(item, si1, , si3)
]]>
</programlisting>

  </para>
  <para>
    In addition to specifying <computeroutput>LvSubItem</computeroutput> objects, the last argument can be either true or
    false. Recall that the list-view control allows the programmer to <link linkend="mthSetItemDataClsListView">attach</link>
    an item data value to any or all of the list-view items. If the item data for every list-view item is a
    <computeroutput>LvFullRow</computeroutput> object, the ooDialog framework can perform internal <link
    linkend="mthSortItems">sorting</link> of the list-view items. The last argument can be true to specify that the
    <computeroutput>LvFullRow</computeroutput> object being instantiated should be set as the item data value for the
    list-view item the <computeroutput>LvFullRow</computeroutput> object represents.
  </para>
  <para>
    This feature is really only of use if the full row object is used to add or insert an item into the list-view. If the
    full row object is not to be used to add an item to the list-view, then there is no reason to use the last argument of
    true or false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a method that creates an array of list-view full rows from NFL football player data. The array is
    later used to insert the rows into a list-view control.
<programlisting>
<![CDATA[

::method getPlayers private

  players = .NFLPlayer~playersFromDataSource("nflPlayers.txt")

  self~masterList = .MasterPlayerList~new(players)

  playerRows = .array~new(players~items)
  do i = 1 to players~items
    j = i - 1
    p = players[i]
    lvi = .LvItem~new(j, , p~name, , p)
    lvsi1 = .LvSubItem~new(j, 1, p~team)
    lvsi2 = .LvSubItem~new(j, 2, p~position)
    lvsi3 = .LvSubItem~new(j, 3, p~rating)

    r = .LvFullRow~new(lvi, lvsi1, lvsi2, lvsi3)
    playerRows[i] = r
  end

  return playerRows


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::new() -->

<section id="atrUserDataClsLvFr" xreflabel="userData"><title>userData (Attribute)</title>
<indexterm><primary>userData</primary><secondary>LvFullRow class</secondary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>userData</secondary></indexterm>
<programlisting>
<![CDATA[
>>--userData----------------------------------------------------><

>>--userData = varName------------------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">userData</emphasis> attribute allows the programmer to associate some data with a
  <computeroutput>LvFullRow</computeroutput> object. The data assigned can be any Rexx object the programmer desires.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">userData get:</emphasis></term>
  <listitem>
  <para>
    Returns the user data object assigned to this full row object, or the <computeroutput>.nil</computeroutput> object if no
    user data has been associated with this full row.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">userData set:</emphasis></term>
  <listitem>
  <para>
    Assigns a user data object to this full row object. There is no restriction on what type of object this may be.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The Windows list-view control allows an <link linkend="mthSetItemDataClsListView">data</link> value to be associated with
    any or all items in the list-view. This is convenient for a number of things. However, if the ooDialog program is using
    <computeroutput>LvFullRow</computeroutput> objects for <link linkend="sctInternalSorting">internal</link> sorting, the
    full row object is assigned as the data value for each item. This prevents the programmer from using the list-view's item
    data for some other purpose. The <emphasis role="italic">userData</emphasis> attribute is provided for these
    circumstances. The programmer assigns a value to the <emphasis role="italic">userData</emphasis> attribute of the full
    row object that needs to be associated with the list-view item. Since the full row object is assigned to the list-view
    item data, the value assigned to the <emphasis role="italic">userData</emphasis> attribute is in effect assigned to the
    list-view item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example constructs a full row object to be displayed as an item in a list-view. The data for each item comes from
    records in a database. In order to keep track of which record in the database corresponds to each list-view item, the
    record ID is stored in the <emphasis role="italic">userData</emphasis> attribute of the full row object. The value at
    index 1 of the rec array is the rowid of the record:
<programlisting>
<![CDATA[

::method fullRowFromRecord unguarded
    use strict arg rec, index = 0

    lvItem = .LvItem~new(index, rec[2])
    lvSub1 = .LvSubItem~new(index, 1, rec[3])
    lvSub2 = .LvSubItem~new(index, 2, rec[4])
    lvSub3 = .LvSubItem~new(index, 3, rec[6])
    lvSub4 = .LvSubItem~new(index, 4, rec[7])
    lvSub5 = .LvSubItem~new(index, 5, rec[8])

    lvFullRow = .LvFullRow~new(lvItem, lvSub1, lvSub2, lvSub3, lvSub4, lvSub5, .true)
    lvFullRow~userData = rec[1]

    return lvFullRow



]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::userData() [attribute]  -->

<section id="mthAddSubItem" xreflabel="addSubItem"><title>addSubItem</title>
<indexterm><primary>addSubItem</primary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>addSubItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addSubItem(--subitem--)----------------------><
]]>
</programlisting>

<para>
  Adds a subitem to this full row. Subitems are always added as the last subitem in the row.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>subitem [required]</term>
      <listitem>
      <para>
        A <xref linkend="clsLvSubItem"/> object that specifies the subitem being added.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the index of the added subitem on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">addSubItem</emphasis> method allows the programmer to add subitems to the full row after the
    <computeroutput>LvFullRow</computeroutput> object has been instantiated. Typically, all subitems would be added to the
    full row at the time of instantiation through the <xref linkend="mthNewClsLvFullRow"/> method. In addition to the
    <emphasis role="italic">addSubItem</emphasis> method, the <xref linkend="mthInsertSubItem"/> method can be used to insert
    a subitem into the middle of the subitem list.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::addSubItem() -->

<section id="mthInsertSubItem" xreflabel="insertSubItem"><title>insertSubItem</title>
<indexterm><primary>insertSubItem</primary></indexterm>
<indexterm><primary>ListView class</primary><secondary>insertSubItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertSubItem(--subItem--,--colIndex--)------><
]]>
</programlisting>

<para>
  Inserts a new subitem into this full row and adjusts the subitem indexes for  all existing subitems, when needed.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>subitem [required]</term>
    <listitem>
    <para>
      A <xref linkend="clsLvSubItem"/> object that specifies the subitem being inserted.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>colIndex [required]</term>
    <listitem>
    <para>
      The one-based index that specifies which column the subitem is inserted at. The index can not be 0 and can not be
      greater than the current count of subitems + 1. That is, a subitem can not be inserted in a way that leaves the
      subitems non-contiguous.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">insertSubItem</emphasis> method allows the programmer to add subitems to the full row after
    the <computeroutput>LvFullRow</computeroutput> object has been instantiated. Typically, all subitems would be added to
    the full row at the time of instantiation through the <xref linkend="mthNewClsLvFullRow"/> method. In addition to the
    <emphasis role="italic">insertSubItem</emphasis> method, the <xref linkend="mthAddSubItem"/> method can be used to add a
    subitem to the end of the subitem list.
  </para>
  <para>
    Inserting a new column into the middle of the exsiting subitems, will of course make the subitem index in the subitems
    following the newly inserted subitem invalid. The ooDialog framework will automatically fix the subitem indexes where
    needed. In addition, both the <xref linkend="atrItemClsLvSi"/> and <xref linkend="atrSubItemClsLvSi"/> attributes in the
    newly inserted <emphasis role="italic">subitem</emphasis> object are set to the collect values automatically. Because of
    this, the <emphasis role="italic">subitem</emphasis> object argument does not necessarily have to have correct item and
    subitem index values.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example inserts a new subitem for column 3. Notice that when instantiating the
    <computeroutput>LvSubItem</computeroutput> object, the code does not bother with setting the <emphasis
    role="italic">item</emphasis> and <emphasis role="italic">subitem</emphasis> correctly. Rather it relies on the <emphasis
    role="italic">insertSubItem</emphasis> method to set them correctly:
<programlisting>
<![CDATA[

    lvSubItem = .LvSubItem~new(1, 1, 'Apartment #13', 2)
    lvFull~insertSubItem(lvSubItem, 3)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ListView::insertSubItem() -->


<section id="mthItem" xreflabel="item"><title>item</title>
<indexterm><primary>item</primary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>item</secondary></indexterm>
<programlisting>
<![CDATA[
>>--item-----------------------------------------><
]]>
</programlisting>

<para>
  Returns the <xref linkend="clsLvItem"/> object of this full row.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the <emphasis role="italic">LvItem</emphasis> object for this full row. All full rows must have an item object so
    there is no way for this method to fail.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the <computeroutput>LvFullRow</computeroutput> for the item at index 5 of the list-view. It then gets
    the <computeroutput>LvItem</computeroutput> object and prints its information out to the display
<programlisting>
<![CDATA[

    lvfull = list~getFullRow(5)
    lvitem = lvFull~item
    self~printItem(lvitem)

/* Output might be for example:

Item columnFormats:     an Array
Item columns:           an Array
Item columns count:     0
Item groupID:           -2
Item imageIndex:        3
Item indent:            0
Item index:             5
Item itemData:          a LvFullRow
Item itemState:         FOCUSED SELECTED
Item itemStateMask:
Item mask:              GROUPID IMAGE PARAM TEXT
Item overlayImageIndex: 0
Item stateImageIndex:   0
Item text:              Clerk

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::item() -->

<section id="mthRemoveSubItem" xreflabel="removeSubItem"><title>removeSubItem</title>
<indexterm><primary>removeSubItem</primary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>removeSubItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removeSubItem(--index--)---------------------><
]]>
</programlisting>

<para>
  Removes the specified subitem from this full row.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The index of the subitem to remove. This is the same as the column index for the subitem. <emphasis
        role="italic">index</emphasis> must be a valid, existing, subitem index. This means it can not be 0, or greater than
        the count of current subitems.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the removed <computeroutput>LvSubItem</computeroutput> object on success, or the
    <computeroutput>.nil</computeroutput> object on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">removeSubItem</emphasis> method allows the programmer to remove subitem from the full row
    after the <computeroutput>LvFullRow</computeroutput> object has been instantiated. Typically, all subitems would be set
    correctly in the full row at the time of instantiation through the <xref linkend="mthNewClsLvFullRow"/> method.
  </para>
  <para>
    Removing a column from the middle of the exsiting subitems, will of course make the subitem index in the subitems
    following the removed subitem invalid. The ooDialog framework will automatically fix the subitem indexes where needed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::removeSubItem() -->

<section id="mthSubItem" xreflabel="subItem"><title>subItem</title>
<indexterm><primary>subItem</primary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>subItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--subItem(--index--)---------------------------><
]]>
</programlisting>

<para>
  Returns the subitem specified by <emphasis role="italic">index</emphasis> of this full row, or the
  <computeroutput>.nil</computeroutput> object if the subitem <emphasis role="italic">index</emphasis> is not valid.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>index [required]</term>
      <listitem>
      <para>
        The one-based index of the subitem requested.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the requested <xref linkend="clsLvSubItem"/> object on success, or the <computeroutput>.nil</computeroutput>
    object on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the subitem in column 3 of the item at index 4 in the list-view and prints out its information:
<programlisting>
<![CDATA[


  lvfull  = list~getFullRow(4)
  subItem = lvFull~subItem(3)
  self~printSubItem(subItem)

/* Output might be:

Subitem imageIndex:        11
Subitem item:              4
Subitem mask:              IMAGE TEXT
Subitem subitem:           3
Subitem text:              ca@sharp.org

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::subItem() -->

<section id="mthSubItems" xreflabel="subItems"><title>subItems</title>
<indexterm><primary>subItems</primary></indexterm>
<indexterm><primary>LvFullRow class</primary><secondary>subItems</secondary></indexterm>
<programlisting>
<![CDATA[
>>--subItems-------------------------------------><
]]>
</programlisting>

<para>
  Returns the count of subitems in this full row.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the count of subitems in this full row.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example ...
<programlisting>
<![CDATA[

  lvfull  = list~getFullRow(4)
  if lvfull~subitems == 0 then do
      say 'No subitems for row at index 4'
      return
  end

  do i = 1 to lvfull~subitems
      subItem = lvFull~subItem(i)
      self~printSubItem(subItem)
  end

/* Output might be:

Item imageIndex:        13
Item item:              4
Item mask:              IMAGE TEXT
Item subitem:           1
Item text:              Cienna

Item imageIndex:        18
Item item:              4
Item mask:              IMAGE TEXT
Item subitem:           2
Item text:              Acer

Item imageIndex:        11
Item item:              4
Item mask:              IMAGE TEXT
Item subitem:           3
Item text:              ca@sharp.org

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvFullRow::subItems() -->

</section> <!-- End LvFullRow Class -->


<section id="clsLvItem" xreflabel="LvItem"><title>LvItem Class</title>
<indexterm><primary>LvItem class</primary></indexterm>
<para>
  A <computeroutput>LvItem</computeroutput> object represents a single item in a list-view control. List-view items can have
  a label, an icon, a current state, an application-defined value, a group ID, a set of columns to display in Tile view,
  column format definitions, a state icon, and an overlay icon. The attributes of the <computeroutput>LvItem</computeroutput>
  object reflect the values of the label, icon, state, etc., for the list-view item.
</para>
<para>
  <computeroutput>LvItem</computeroutput> objects can be used to set or modify the values of a list-view item, or to receive
  information about an item. In addition <computeroutput>LvItem</computeroutput> objects are used in <xref
  linkend="clsLvFullRow"/> objects. Each <computeroutput>LvFullRow</computeroutput> object is composed of at least one
  <computeroutput>LvItem</computeroutput> object.
</para>
<para>
  Note that ooDialog does not currently support some of the newer features in list-views. The
  <computeroutput>LvItem</computeroutput> class is part of the first steps to enhance ooDialog to support all the list-view
  features. The <computeroutput>LvItem</computeroutput> class has support for attributes that will become important in an
  enhanced <xref linkend="clsListView"/> class, but are not currently relevant. Support for list-view groups, Tile view, and
  columns, is part of a planned enhancement.
</para>

<section id="sctMethodsLvItem"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>LvItem</computeroutput> class:

<table id="tblMethodsLvItem" frame="all"> <title>LvItem Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*"/>
<colspec colwidth="4*"/>
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="mthNewClsLvItem">new</link></entry>
<entry>Instantiates a new <computeroutput>LvItem</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrColumnFormatsClsLvi"/></entry>
<entry>An array of column format values specifying the format of each item in a column in Tile view.</entry>
</row>
<row>
<entry><xref linkend="atrColumnsClsLvi"/></entry>
<entry>An array of column indexes specifying which columns are displayed for this item in Tile view, and the order of those columns.</entry>
</row>
<row>
<entry><xref linkend="atrGroupIDClsLvi"/></entry>
<entry>Reflects the group ID of this item.</entry>
</row>
<row>
<entry><xref linkend="atrImageIndexClsLvi"/></entry>
<entry>Reflects the index in the icon <link linkend="mthSetImageListClsListView">image</link> lists for this item.</entry>
</row>
<row>
<entry><xref linkend="atrIndentClsLvi"/></entry>
<entry>Reflects the number of image widths to indent this item.</entry>
</row>
<row>
<entry><xref linkend="atrIndexClsLvi"/></entry>
<entry>Reflects the index of this item in the list-view.</entry>
</row>
<row>
<entry><xref linkend="atrItemDataClsLvi"/></entry>
<entry>Reflects the item data value for this item.</entry>
</row>
<row>
<entry><xref linkend="atrItemStateClsLvi"/></entry>
<entry>Reflects this item's state.</entry>
</row>
<row>
<entry><xref linkend="atrItemStateMaskClsLvi"/></entry>
<entry>The <emphasis role="italic">itemStateMask</emphasis> attribute specifies which states in the <emphasis role="italic">itemState</emphasis> attribute are valid.</entry>
</row>
<row>
<entry><xref linkend="atrMaskClsLvi"/></entry>
<entry>The <emphasis role="italic">mask</emphasis> attribute is used to specify which values of the <computeroutput>LvItem</computeroutput> object are valid to set or receive information of the list-view item.</entry>
</row>
<row>
<entry><xref linkend="atrOverlayImageIndexClsLvi"/></entry>
<entry>Reflects the one-based index of the overlay image for this item.</entry>
</row>
<row>
<entry><xref linkend="atrStateImageIndexClsLvi"/></entry>
<entry>Reflects the one-based index of the state image for this item.</entry>
</row>
<row>
<entry><xref linkend="atrTextClsLvi"/></entry>
<entry>Reflects the text, the label, for this item.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsLvItem" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>LvItem class</secondary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--+--------+--+-------+--+--------------+--+------------+--+-------+---->
          +--indx--+  +-,-txt-+  +-,-imageIndex-+  +-,-itemData-+  +-,-msk-+

>---+-------------+-+----------------+-+----------+-+-----------+-+--------+--)--><
    +-,-itemState-+ +-,-itemStateMsk-+ +-,-indent-+ +-,-groupID-+ +-,-cols-+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>LvItem</computeroutput> object. <computeroutput>LvItem</computeroutput> objects can be
  used in some <link linkend="clsListView">Listview</link> methods such as <xref linkend="mthGetItem"/>.
  <computeroutput>LvItem</computeroutput> objects are used in <xref linkend="clsLvFullRow"/> . It is anticipated that future
  enhancements of ooDialog will make more use of <computeroutput>LvItem</computeroutput> objects.
</para>
<para>
  Some of the uses for <computeroutput>LvItem</computeroutput> objects are to set or retrieve some, or all, of the
  information the underlying list-view control maintains for each list-view item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>indx [optional]</term>
    <listitem>
    <para>
      The zero-based index of this item. The argument can not be less than 0. If this arugment is omitted it defaults to 0.
      The <emphasis role="italic">indx</emphasis> argument sets the <xref linkend="atrIndexClsLvi"/> attribute of this
      list-view item.
    </para>
    <para>
      Note that depending on the use of this list-view item, the ooDialog framework may modify the index attribute. For
      instance if the <computeroutput>LvItem</computeroutput> is contained in a <xref linkend="clsLvFullRow"/> object and the
      row is added to a list-view, the ooDialog framework will adjust the <emphasis role="italic">index</emphasis> attribute
      to reflect the actual index of the added item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>txt [optional]</term>
    <listitem>
    <para>
      Sets the text, or label, for this list-view item. The <emphasis role="italic">txt</emphasis> argument sets the <xref
      linkend="atrTextClsLvi"/> attribute of this list-view item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>imageIndex [optional]</term>
    <listitem>
    <para>
      The zero-based index of the item's icon in the control's <link linkend="mthSetImageListClsListView">image</link> list.
      For any item there is only 1 image index, so the index must be the same in both the large and small image lists. The
      <emphasis role="italic">imageIndex</emphasis> argument can also be one of the following list-view <link
      linkend="sctListViewConstantMethods">constants</link>. If this argument is omitted, the default is IMAGENONE:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>IMAGECALLBACK</member>
        <member>IMAGENONE    </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>IMAGECALLBACK</term>
        <listitem>
        <para>
          Indicates the list-view control should send the GETDISPINFO notification message to retrieve the icon index for the
          item.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>IMAGENONE</term>
        <listitem>
        <para>
          The item does not have an icon. This is the default if this argument omitted.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    <para>
      The <emphasis role="italic">imageIndex</emphasis> argument sets the <xref linkend="atrImageIndexClsLvi"/> attribute of
      this list-view item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>itemData[optional]</term>
    <listitem>
    <para>
      An item data value for this item. The list-view control allows the programmer to <link
      linkend="mthSetItemDataClsListView">assign</link> an item data value to any, or all, list-view items. The item data
      value can be any Rexx object.
    </para>
    <para>
      The <emphasis role="italic">itemData</emphasis> argument sets the <xref linkend="atrItemDataClsLvi"/> attribute of this
      list-view item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>msk [optional]</term>
    <listitem>
    <para>
      A list of blank separate keywords that specify which attributes of this <computeroutput>LvItem</computeroutput> object
      contain data to be set or which attributes are being requested. In general, the ooDialog framework will try to set the <xref
      linkend="atrMaskClsLvi"/> attribute correctly without the programmer having to worry about this argument. As each
      attribute of the <computeroutput>LvItem</computeroutput> object is set, the appropriate keyword is added to the
      <emphasis role="italic">mask</emphasis> attribute. However, if this object is going to be used to retrieve information
      about the underlying list-view item, the ooDialog framwork has no way to know what attributes the programmer wishes to
      retrieve. For this use of the <computeroutput>LvItem</computeroutput> object, the programmer should set the mask to the
      value that will retrieve the information she wants.
    </para>
    <para>
      The <emphasis role="italic">msk</emphasis> argument can have zero or more of the following keywords, case is not
      significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>ALL        </member>
        <member>COLFMT     </member>
        <member>COLUMNS    </member>
        <member>GROUPID    </member>
        <member>IMAGE      </member>
        <member>INDENT     </member>
        <member>NORECOMPUTE</member>
        <member>PARAM      </member>
        <member>STATE      </member>
        <member>TEXT       </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>ALL</term>
        <listitem>
        <para>
          A convenience keyword, the same as specifying a string with every keyword in it.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>COLFMT</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. The <xref linkend="atrColumnFormatsClsLvi"/>
          attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>COLUMNS</term>
        <listitem>
        <para>
          Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later. The <xref linkend="atrColumnsClsLvi"/>
          attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>GROUPID</term>
        <listitem>
        <para>
          Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later. The <xref linkend="atrGroupIDClsLvi"/>
          attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>IMAGE</term>
        <listitem>
        <para>
          The <xref linkend="atrImageIndexClsLvi"/> attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>INDENT</term>
        <listitem>
        <para>
          The <xref linkend="atrIndentClsLvi"/> attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NORECOMPUTE</term>
        <listitem>
        <para>
          Used when the <computeroutput>LvItem</computeroutput> object will be used to retrieve information through the <xref
          linkend="mthGetItem"/> method. Signals the list-view control not to generate a GETDISPINFO notification to retrieve
          the text. Rather, the <xref linkend="atrTextClsLvi"/> attribute will contain <emphasis
          role="italic">lpStrTextCallBack</emphasis>.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>PARAM</term>
        <listitem>
        <para>
          The <xref linkend="atrItemDataClsLvi"/> attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>STATE</term>
        <listitem>
        <para>
          The <xref linkend="atrItemStateClsLvi"/> attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TEXT</term>
        <listitem>
        <para>
          The <xref linkend="atrTextClsLvi"/> attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    <para>
      The <emphasis role="italic">msk</emphasis> argument sets the <xref linkend="atrMaskClsLvi"/> attribute of this
      list-view item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>itemState [optional]</term>
    <listitem>
    <para>
      A list of blank separate keywords that specify the state for the list-view item. An item's state determines its
      appearance and functionality. The list can contain zero or more of the following keywords:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>CUT        </member>
        <member>DROPHILITED</member>
        <member>FOCUSED    </member>
        <member>SELECTED   </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>CUT</term>
        <listitem>
        <para>
          The list-view item is marked for a cut-and-paste operation
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DROPHILITED</term>
        <listitem>
        <para>
          The list-view item is highlighted as a drag-and-drop target.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>FOCUSED</term>
        <listitem>
        <para>
          The list-view item has the focus, so it is surrounded by a standard focus rectangle. Although more than one item
          may be selected, only one item can have the focus.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SELECTED</term>
        <listitem>
        <para>
          The list-view item is selected. The appearance of a selected item depends on whether it has the focus and also on
          the system colors used for selection.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    <para>
      Sets the <xref linkend="atrItemStateClsLvi"/> attribute of this list-view item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>itemStateMsk [optional]</term>
    <listitem>
    <para>
      Sets the <xref linkend="atrItemStateMaskClsLvi"/> attribute of this list-view item.
    </para>
    <para>
      A string of blank separated keywords specifying which state values to retrieve or set. For example, if only the keyword
      SELECTED is used, only the value of the SELECTED state will be retrieved in the <emphasis
      role="italic">state</emphasis> attribute. This also allows the programmer to modify one or more state values without
      first retrieving the current state values. For instance, setting the item state mask to SELECTED and setting the item
      state attribute to the empty string will clear the SELECTED state without changing any of the other state value, if
      the <computeroutput>LvItem</computeroutput> object is used to modify a list-view item. If the <emphasis
      role="italic">itemStateMask</emphasis> is set to ALL and the <emphasis role="italic">itemState</emphasis> is set to the
      empty sting will clear the SELECTED, CUT, FOCUSED and HILITED states, if the <computeroutput>LvItem</computeroutput>
      object is used to modify a list-view item.
    </para>
    <para>
      The acceptable keywords are the same as those for the <emphasis role="italic">itemState</emphasis> argument, with the
      addition of the ALL keyword:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>ALL        </member>
        <member>CUT        </member>
        <member>DROPHILITED</member>
        <member>FOCUSED    </member>
        <member>SELECTED   </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>ALL</term>
        <listitem>
        <para>
          All keywords in the <emphasis role="italic">itemState</emphasis> attribute are valid.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>CUT</term>
        <listitem>
        <para>
          The CUT keyword is valid in the <emphasis role="italic">itemState</emphasis> attribute.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DROPHILITED</term>
        <listitem>
        <para>
          The DROPHILITED keyword is valid in the <emphasis role="italic">itemState</emphasis> attribute.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>FOCUSED</term>
        <listitem>
        <para>
          The FOCUSED keyword is valid in the <emphasis role="italic">itemState</emphasis> attribute.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SELECTED</term>
        <listitem>
        <para>
          The SELECTED keyword is valid in the <emphasis role="italic">itemState</emphasis> attribute.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>indent [optional]</term>
    <listitem>
    <para>
      The number of image widths to indent the item. A single indentation equals the width of an item image. Therefore, the
      value 1 indents the item by the width of one image, the value 2 indents by two images, and so on. If this argument is
      omitted, the indent is set to 0. The <emphasis role="italic">indent</emphasis>argument sets the <xref
      linkend="atrIndentClsLvi"/> attribute of this list-view item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>groupID [optional]</term>
    <listitem>
    <para>
      Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later.
    </para>
    <para>
      The group ID this item belongs to, or one of the following <computeroutput>LvItem</computeroutput> constants. If this
      argument is omitted, the default is the GROUPIDNONE constant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>GROUPIDCALLBACK</member>
        <member>GROUPIDNONE    </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>GROUPIDCALLBACK</term>
        <listitem>
        <para>
          Indicates the list-view control should send the GETDISPINFO notification message to retrieve the group index of the
          item.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>GROUPIDNONE</term>
        <listitem>
        <para>
          The item does not belong to a group. If you omit this argument, this is the default
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    <para>
      The <emphasis role="italic">groupID</emphasis> argument sets the <xref linkend="atrGroupIDClsLvi"/> attribute of this
      list-view item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>cols [optional]</term>
    <listitem>
    <para>
      Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later.
    </para>
    <para>
      The <emphasis role="italic">cols</emphasis> argument must be an array of subitem indexes. The indexes in the array
      specify which columns are displayed for this item, in <emphasis role="italic">Tile</emphasis> view, and the order of
      those columns. The array can not be sparse. The <emphasis role="italic">cols</emphasis> argument sets the <xref
      linkend="atrColumnsClsLvi"/> attribute of this list-view item.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a newly instantiated <computeroutput>LvItem</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Note that not all of the <computeroutput>LvItem</computeroutput> object's attributes can be set through the <emphasis
    role="italic">new</emphasis> method. The <xref linkend="atrOverlayImageIndexClsLvi"/>, <xref
    linkend="atrStateImageIndexClsLvi"/>, and <xref linkend="atrColumnFormatsClsLvi"/> attributes can be set through their
    attribute methods after the <computeroutput>LvItem</computeroutput> object has been instantiated.
  </para>
  <para>
    How the new <computeroutput>LvItem</computeroutput> object should be instantiated depends on how the object will be used.
    Typically, if the object is going to be used to retrieve information about a list-view item, only the <emphasis
    role="italic">indx</emphasis> and <emphasis role="italic">msk</emphasis> arguments would be used in the <emphasis
    role="italic">new</emphasis> method. The <emphasis role="italic">indx</emphasis> argument would be set to the index of
    the item and the <emphasis role="italic">msk</emphasis> argument would be set for all the information that was wanted to
    be retrieved.
  </para>
  <para>
    On the other hand, if the <computeroutput>LvItem</computeroutput> is going to be used to set the information for a
    list-view item, the typical process would be to set the index for the item using the <emphasis
    role="italic">indx</emphasis> argument and set the values for all the attributes needed to define the item. In this case,
    the <emphasis role="italic">msk</emphasis> argument can usually be omitted. For each attribute of the
    <computeroutput>LvItem</computeroutput> that is assigned a value, the proper keyword is added to the mask by the ooDialog
    framework.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a <computeroutput>LvItem</computeroutput> object that will be used in a <xref
    linkend="clsLvFullRow"/> object to insert an item into a list-view. Only the label of the item and the image index are
    needed for the purposes of the application, so the other attributes of the <computeroutput>LvItem</computeroutput> are
    not assigned values. The ooDialog framework will automatically set the proper mask value:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(2, "Mechanical Engineer", 0)
  ...
  lvFullRow = .LvFullRow~new(lvItem, lvSub1, lvSub2, lvSub3, .true)
  list~addFullRow(lvFullRow)

]]>
</programlisting>
    This example instantiates a <computeroutput>LvItem</computeroutput> object that will be used to query the information
    maintained by the list-view for the item at index 21. All information for the item is desired, so the masks are set
    to receive all information. Note that the value of the list-view <link
    linkend="sctListViewConstantMethods">constants</link> IMAGENONE and GROUPIDNONE are both -2:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(21, , , , 'ALL', , 'ALL')
  if list~getItem(lvItem) then do
      self~printItem(lvItem)
  end
  else do
      -- some unexpected error ...
      say 'Error'
  end

::method printItem
    use strict arg lvItem

    say 'Item columnFormats:    ' lvItem~columnFormats
    say 'Item columns:          ' lvItem~columns
    say 'Item columns count:    ' lvItem~columns~items
    say 'Item groupID:          ' lvItem~groupID
    say 'Item imageIndex:       ' lvItem~imageIndex
    say 'Item indent:           ' lvItem~indent
    say 'Item index:            ' lvItem~index
    say 'Item itemData:         ' lvItem~itemData
    say 'Item itemState:        ' lvItem~itemState
    say 'Item itemStateMask:    ' lvItem~itemStateMask
    say 'Item mask:             ' lvItem~mask
    say 'Item overlayImageIndex:' lvItem~overlayImageIndex
    say 'Item stateImageIndex:  ' lvItem~stateImageIndex
    say 'Item text:             ' lvItem~text
    say




/* Output might be:

Item columnFormats:     an Array
Item columns:           an Array
Item columns count:     0
Item groupID:           -2
Item imageIndex:        -2
Item indent:            0
Item index:             21
Item itemData:          a LvFullRow
Item itemState:
Item itemStateMask:     FOCUSED SELECTED CUT DROPHILITED
Item mask:              COLFMT COLUMNS GROUPID IMAGE INDENT NORECOMPUTE PARAM STATE TEXT
Item overlayImageIndex: 0
Item stateImageIndex:   1
Item text:              Line 22

*/

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::new() -->

<section id="atrColumnFormatsClsLvi" xreflabel="columnFormats"><title>columnFormats (Attribute)</title>
<indexterm><primary>columnFormats</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>columnFormats</secondary></indexterm>
<programlisting>
<![CDATA[
>>--columnFormats--------------------------------><

>>--columnFormats = varName----------------------><

]]>
</programlisting>

<para>
  An array of column format values specifying the format of each item in a column in Tile view. See the remarks.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">columnFormats get:</emphasis></term>
  <listitem>
  <para>
    Returns an array of column formats. Each index of the array specifies the format of the corresponding column in Tile
    view. The formats are specified by one of the LVCFVT_* <link
    linkend="sctListViewConstantMethods">constants</link> of the <computeroutput>ListView</computeroutput> class.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">columnFormats set:</emphasis></term>
  <listitem>
  <para>
    To specify the format for each column in Tile view assign an array to this attribute. The number of items in the array
    must be the same as the number of items in the array assigned to the <xref linkend="atrColumnsClsLvi"/> attribute. Each
    index of the array should contain a valid column format. Specify the format using one of the LVCFVT_* <link
    linkend="sctListViewConstantMethods">constants</link> of the <computeroutput>ListView</computeroutput> class.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In Tile view, the item label is displayed to the right of the icon. The programmer can specify additional subitems
    (corresponding to columns in Details view), to be displayed on lines below the item label. The <xref
    linkend="atrColumnsClsLvi"/> attribute must be an array that contains the indexes of the subitems to be displayed.
  </para>
  <para>
    The <emphasis role="italic">columnFormats</emphasis> attribute specifies the format for each subitem in the <emphasis
    role="italic">columns</emphasis> array. The <emphasis role="italic">columnFormats</emphasis> attribute does not have to
    be set if the <emphasis role="italic">columns</emphasis> attribute is set. In this case the default format for each
    column is used. But, if the <emphasis role="italic">columnFormats</emphasis> attribute is set, the <emphasis
    role="italic">columns</emphasis> attribute must also be set and the two arrays must be the same size.
  </para>
  <para>
    For each index in the <emphasis role="italic">columns</emphasis> array, the same index in the <emphasis
    role="italic">columnFormats</emphasis> array specifies the format for that column. The <emphasis
    role="italic">columnFormats</emphasis> attribute has no effect in standard Tile views. For extended Tile views, the
    LVCFMT_LINE_BREAK, LVCFMT_FILL, LVCFMT_WRAP, LVCFMT_NO_TITLE, and LVCFMT_TILE_PLACEMENTMASK formats are valid.
  </para>
  <para>
    ooDialog does not currently support Tile view, but it is likely that a future enhancement will. The <emphasis
    role="italic">columnFormats</emphasis> attribute is part of the first steps towards implementing the support for Tile
    view.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::columnFormats() [attribute]  -->

<section id="atrColumnsClsLvi" xreflabel="columns"><title>columns (Attribute)</title>
<indexterm><primary>columns</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>columns</secondary></indexterm>
<programlisting>
<![CDATA[
>>--columns--------------------------------------><

>>--columns = varName----------------------------><

]]>
</programlisting>

<para>
  An array of column indexes specifying which columns are displayed for this item in Tile view, and the order of those
  columns.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">columns get:</emphasis></term>
  <listitem>
  <para>
    Returns an array of column indexes. Each index in the array specifies the index of a column to be displayed in tile view.
    The order of the column indexes in the array specifies the order the columns are displayed in.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">columns set:</emphasis></term>
  <listitem>
  <para>
    To set which columns are displayed in Tile view, assign an array to this attribute. The number of items in the array
    specifies how many columns are displayed. The maximum is 20. The array can not be sparse. Each index of the array should
    contain the subitem index to be displayed. The subitems are displayed in the same order as their index appears in the
    array.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In Tile view, the item label is displayed to the right of the icon. The programmer can specify additional subitems
    (corresponding to columns in Details view), to be displayed on lines below the item label. The <emphasis
    role="italic">columns</emphasis> attribute must be assigned an array that contains the indexes of the subitems to be
    displayed.
  </para>
  <para>
    The <xref linkend="atrColumnFormatsClsLvi"/> attribute can be used to specify the format for each subitem in the
    <emphasis role="italic">columns</emphasis> array. The <emphasis role="italic">columnFormats</emphasis> attribute does not
    have to be set if the <emphasis role="italic">columns</emphasis> attribute is set. In this case the default format for
    each column is used. But, if the <emphasis role="italic">columnFormats</emphasis> attribute is set, the <emphasis
    role="italic">columns</emphasis> attribute must also be set and the two arrays must be the same size. For each index in
    the <emphasis role="italic">columns</emphasis> array, the same index in the <emphasis
    role="italic">columnFormats</emphasis> array specifies the format for that column.
  </para>
  <para>
    ooDialog does not currently support Tile view, but it is likely that a future enhancement will. The <emphasis
    role="italic">columnFormats</emphasis> attribute is part of the first steps towards implementing the support for Tile
    view.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::columns() [attribute]  -->

<section id="atrGroupIDClsLvi" xreflabel="groupID"><title>groupID (Attribute)</title>
<indexterm><primary>groupID</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>groupID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--groupID--------------------------------------><

>>--groupID = varName----------------------------><

]]>
</programlisting>

<para>
  Reflects the group ID of this item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">groupID get:</emphasis></term>
  <listitem>
  <para>
    Returns the group ID of this item. The ID can also be one of the group ID <link
    linkend="sctListViewConstantMethods">constants</link> supplied by the <computeroutput>ListView</computeroutput> class,
    GROUPIDNONE or GROUPIDCALLBACK.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">groupID set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to the value of the identifier of the group that this item belongs to, or to one of the group ID
    <link linkend="sctListViewConstantMethods">constants</link> supplied by the <computeroutput>ListView</computeroutput>
    class, either GROUPIDNONE or GROUPIDCALLBACK. Do <emphasis role="bold">not</emphasis> set this attribute to 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Setting the <emphasis role="italic">groupID</emphasis> attribute to 0 will cause some uses of the
    <computeroutput>LvItem</computeroutput> to fail unless the list-view has groups enabled. The best strategy to avoid
    failures is to new set the attribute to 0.
  </para>
  <para>
    ooDialog does not currently support list-view groups, but it is likely that a future enhancement will add this support.
    The <emphasis role="italic">groupID</emphasis> attribute is part of the first steps towards implementing the
    support for list-view groups.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::groupID() [attribute]  -->

<section id="atrImageIndexClsLvi" xreflabel="imageIndex"><title>imageIndex (Attribute)</title>
<indexterm><primary>imageIndex</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>imageIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--imageIndex-----------------------------------><

>>--imageIndex = varName-------------------------><

]]>
</programlisting>

<para>
  Reflects the index in the icon <link linkend="mthSetImageListClsListView">image</link> lists for this item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">imageIndex get:</emphasis></term>
  <listitem>
  <para>
    Returns this item's image index, or one of the image <link linkend="sctListViewConstantMethods">constants</link>
    supplied by the <computeroutput>ListView</computeroutput> class, IMAGENONE or IMAGECALLBACK.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">imageIndex set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to the index in the icon image lists for this item, or to one of the image <link
    linkend="sctListViewConstantMethods">constants</link> supplied by the <computeroutput>ListView</computeroutput> class,
    IMAGENONE or IMAGECALLBACK.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In general, if the programmer does not explicitly set this attribute, the ooDialog framework will set it to the IMAGENONE
    constant. When the <computeroutput>LvItem</computeroutput> object is used to retrieve information about an item, the
    list-view control will return the IMAGECALLBACK value unless the image index has been explicitly set by the application.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example will set, or change, the image index of the item at index 13 to 3. None of the other list-view item
    information will be changed.
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(13, , 3)
  list~modifyItem(lvItem)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::imageIndex() [attribute]  -->

<section id="atrIndentClsLvi" xreflabel="indent"><title>indent (Attribute)</title>
<indexterm><primary>indent</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>indent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--indent---------------------------------------><

>>--indent = varName-----------------------------><

]]>
</programlisting>

<para>
  Reflects the number of image widths to indent this item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">indent get:</emphasis></term>
  <listitem>
  <para>
    Returns the indent value for this item
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">indent set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to a non-negative whole number to set the indent for this item
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A single indentation equals the width of an item image. Therefore, the value 1 indents the item by the width of one
    image, the value 2 indents by two images, and so on.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::indent() [attribute]  -->

<section id="atrIndexClsLvi" xreflabel="index"><title>index (Attribute)</title>
<indexterm><primary>index</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>index</secondary></indexterm>
<programlisting>
<![CDATA[
>>--index----------------------------------------><

>>--index = varName------------------------------><

]]>
</programlisting>

<para>
  Reflects the index of this item in the list-view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">index get:</emphasis></term>
  <listitem>
  <para>
    Returns the zero-based index of this item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">index set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to a zero-based index to specify which item in the list-view this item represents.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::index() [attribute]  -->

<section id="atrItemDataClsLvi" xreflabel="itemData"><title>itemData (Attribute)</title>
<indexterm><primary>itemData</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>itemData</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemData-------------------------------------><

>>--itemData = varName---------------------------><

]]>
</programlisting>

<para>
  Reflects the item data value for this item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">itemData get:</emphasis></term>
  <listitem>
  <para>
    Returns the item data value of this item, or the <computeroutput>.nil</computeroutput> object if no item data has been
    set for this item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">itemData set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to any value the programmer wants to associate with this item. The list-view control allows the
    application, (the programmer) to assign a user value to any list-view item. The <xref
    linkend="mthSetItemDataClsListView"/> method can also be used to set the item data for an item. The value can be any Rexx
    object that the programmer wants to use.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example retrieves the current item data for list-view item 16:
<programlisting>
<![CDATA[

    lvItem = .LvItem~new(16, , , , 'PARAM')
    list~getItem(lvItem)
    say 'The item data for item 16 is:' lvItem~itemData

/* Output might be:

  The item data for item 16 is: a LvFullRow

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::itemData() [attribute]  -->

<section id="atrItemStateClsLvi" xreflabel="itemState"><title>itemState (Attribute)</title>
<indexterm><primary>itemState</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>itemState</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemState------------------------------------><

>>--itemState = varName--------------------------><

]]>
</programlisting>

<para>
  Reflects this item's state.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">itemState get:</emphasis></term>
  <listitem>
  <para>
    Returns a blank separated list of keywords that indicate the item's state. The possible keywords are listed in the
    remarks.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">itemState set:</emphasis></term>
  <listitem>
  <para>
    To set this item's state, assign a string containing a list of state keywords. The possible keywords are listed in the
    remarks.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The state string contains a list of blank separated keywords. When assigning the string to this attribute case is
    insignificant. When getting the value of this attribute, the returned keywords will be all upper-cased. The possible
    keywords are:
  </para>
  <para>
    <simplelist type='vert' columns='3'>
      <member>CUT        </member>
      <member>DROPHILITED</member>
      <member>FOCUSED    </member>
      <member>SELECTED   </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>CUT</term>
      <listitem>
      <para>
        The list-view item is marked for a cut-and-paste operation
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DROPHILITED</term>
      <listitem>
      <para>
        The list-view item is highlighted as a drag-and-drop target.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>FOCUSED</term>
      <listitem>
      <para>
        The list-view item has the focus, so it is surrounded by a standard focus rectangle. Although more than one item
        may be selected, only one item can have the focus.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SELECTED</term>
      <listitem>
      <para>
        The list-view item is selected. The appearance of a selected item depends on whether it has the focus and also on
        the system colors used for selection.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    Note that the <xref linkend="atrItemStateMaskClsLvi"/> attribute needs to be used in conjunction with this attribute. The
    <emphasis role="italic">itemStateMask</emphasis> specifies which states in the <emphasis
    role="italic">itemState</emphasis> are valid. If a state, say SELECTED, is specified in the <emphasis
    role="italic">itemStateMask</emphasis>, but not in the <emphasis role="italic">itemState</emphasis>, that state is turned
    off. If a state is specified in both the <emphasis role="italic">itemState</emphasis> and <emphasis
    role="italic">itemStateMask</emphasis> attributes, that state is turned on.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the state of the item at index 1 to selected and focused:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(1)
  lvItem~itemState = "SELECTED FOCUSED"
  lvItem~itemStateMask = "SELECTED FOCUSED"
  list~modifyItem(lvItem)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::itemState() [attribute]  -->

<section id="atrItemStateMaskClsLvi" xreflabel="itemStateMask"><title>itemStateMask (Attribute)</title>
<indexterm><primary>itemStateMask</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>itemStateMask</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemStateMask--------------------------------><

>>--itemStateMask = varName----------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">itemStateMask</emphasis> attribute specifies which states in the <xref
  linkend="atrItemStateClsLvi"/> attribute are valid.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">itemStateMask get:</emphasis></term>
  <listitem>
  <para>
    Returns a blank separated list of state keywords that indicate which states in the <emphasis
    role="italic">itemState</emphasis> attribute are valid. The possible keywords are listed in the remarks
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">itemStateMask set:</emphasis></term>
  <listitem>
  <para>
    To specify the valid state keywords in the <emphasis role="italic">itemState</emphasis> attribute, assign a list of blank
    separated keywords to this attribute. The possible keywords are listed in the remarks.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The state mask string contains a list of blank separated keywords. When assigning the string to this attribute case is
    insignificant. When getting the value of this attribute, the returned keywords will be all upper-cased. The possible
    keywords are:
  </para>
  <para>
    <simplelist type='vert' columns='3'>
      <member>ALL        </member>
      <member>CUT        </member>
      <member>DROPHILITED</member>
      <member>FOCUSED    </member>
      <member>SELECTED   </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>ALL</term>
      <listitem>
      <para>
        All keywords in the <emphasis role="italic">itemState</emphasis> attribute are valid.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CUT</term>
      <listitem>
      <para>
        The CUT keyword, or lack of, is valid in the <emphasis role="italic">itemState</emphasis> attribute.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DROPHILITED</term>
      <listitem>
      <para>
        The DROPHILITED keyword, or lack of, is valid in the <emphasis role="italic">itemState</emphasis> attribute.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>FOCUSED</term>
      <listitem>
      <para>
        The FOCUSED keyword, or lack of, is valid in the <emphasis role="italic">itemState</emphasis> attribute.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SELECTED</term>
      <listitem>
      <para>
        The SELECTED keyword, or lack of, is valid in the <emphasis role="italic">itemState</emphasis> attribute.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    Note that the <xref linkend="atrItemStateClsLvi"/> attribute is used in conjunction with this attribute. The
    <emphasis role="italic">itemStateMask</emphasis> specifies which states in the <emphasis
    role="italic">itemState</emphasis> are valid. If a state, say SELECTED, is specified in the <emphasis
    role="italic">itemStateMask</emphasis>, but not in the <emphasis role="italic">itemState</emphasis>, that state is turned
    off. If a state is specified in both the <emphasis role="italic">itemState</emphasis> and <emphasis
    role="italic">itemStateMask</emphasis> attributes, that state is turned on.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example uses the <emphasis role="italic">itemStateMask</emphasis> to turn off the FOCUSED state of the item without
    changing any of the other states of the item:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(10)
  lvItem~itemStateMask = "FOCUSED"
  list~modifyItem(lvItem)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::itemStateMask() [attribute]  -->

<section id="atrMaskClsLvi" xreflabel="mask"><title>mask (Attribute)</title>
<indexterm><primary>mask</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>mask</secondary></indexterm>
<programlisting>
<![CDATA[
>>--mask-----------------------------------------><

>>--mask = varName-------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">mask</emphasis> attribute is used to specify which values of the
  <computeroutput>LvItem</computeroutput> object are valid to set or receive the information of the list-view item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">mask get:</emphasis></term>
  <listitem>
  <para>
    Returns a blank separated list of keywords specifying which attributes of this item are valid. The possible keywords are
    listed in the remarks section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">mask set:</emphasis></term>
  <listitem>
  <para>
    To specify which attributes in this item are to be used to set or receive information, assign a list of blank separated
    keywords to this attribute. The possible keywords are listed in the remarks section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">mask</emphasis> attributed contains a list of blank separate keywords that specify which
    attributes of this <computeroutput>LvItem</computeroutput> object contain data to be set or which attributes are being
    requested. In general, when setting data, the ooDialog framework will try to set the <emphasis
    role="italic">mask</emphasis> attribute correctly without the programmer having to worry about this argument. As each
    attribute of the <computeroutput>LvItem</computeroutput> object is set, the appropriate keyword is added to the <emphasis
    role="italic">mask</emphasis> attribute.
  </para>
  <para>
    However, if this object is going to be used to retrieve information about the underlying list-view item, the ooDialog
    framwork has no way to know what attributes the programmer wishes to retrieve. For this use of the
    <computeroutput>LvItem</computeroutput> object, the programmer should set the mask to the value that will retrieve the
    information he wants.
  </para>
  <para>
    The <emphasis role="italic">mask</emphasis> attribute can have zero or more of the following keywords. When assigning the
    string to this attribute case is insignificant. When getting the value of this attribute, the returned keywords will be
    all upper-cased:
  </para>
  <para>
    <simplelist type='vert' columns='3'>
      <member>ALL        </member>
      <member>COLFMT     </member>
      <member>COLUMNS    </member>
      <member>GROUPID    </member>
      <member>IMAGE      </member>
      <member>INDENT     </member>
      <member>NORECOMPUTE</member>
      <member>PARAM      </member>
      <member>STATE      </member>
      <member>TEXT       </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>ALL</term>
      <listitem>
      <para>
        A convenience keyword, the same as specifying a string with every keyword in it.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>COLFMT</term>
      <listitem>
      <para>
        <emphasis role="bold">Requires Windows Vista or later</emphasis>. The <xref linkend="atrColumnFormatsClsLvi"/>
        attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>COLUMNS</term>
      <listitem>
      <para>
        Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later. The <xref linkend="atrColumnsClsLvi"/>
        attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>GROUPID</term>
      <listitem>
      <para>
        Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later. The <xref linkend="atrGroupIDClsLvi"/>
        attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>IMAGE</term>
      <listitem>
      <para>
        The <xref linkend="atrImageIndexClsLvi"/> attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>INDENT</term>
      <listitem>
      <para>
        The <xref linkend="atrIndentClsLvi"/> attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>NORECOMPUTE</term>
      <listitem>
      <para>
        Used when the <computeroutput>LvItem</computeroutput> object will be used to retrieve information through the <xref
        linkend="mthGetItem"/> method. Signals the list-view control not to generate a GETDISPINFO notification to retrieve
        the text. Rather, the <xref linkend="atrTextClsLvi"/> attribute will contain <emphasis
        role="italic">lpStrTextCallBack</emphasis>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>PARAM</term>
      <listitem>
      <para>
        The <xref linkend="atrItemDataClsLvi"/> attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>STATE</term>
      <listitem>
      <para>
        The <xref linkend="atrItemStateClsLvi"/> attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>TEXT</term>
      <listitem>
      <para>
        The <xref linkend="atrTextClsLvi"/> attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the text label, the icon index, the item data, and the indent for the item at index 11, without
    changing any other information of the item. In this example, the mask attribute is set explicitly to make a point. But
    it is not actually needed:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(11, 'Acme Clocks', 2, contactInfo, "TEXT IMAGE PARAM INDENT", , , 2)

  list~modifyItem(lvItem)

]]>
</programlisting>
    This code snippet will work exactly the same as the example above:
<programlisting>
<![CDATA[

  lvItem = .LvItem~new(11, 'Acme Clocks', 2, contactInfo, , , , 2)

  list~modifyItem(lvItem)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::mask() [attribute]  -->

<section id="atrOverlayImageIndexClsLvi" xreflabel="overlayImageIndex"><title>overlayImageIndex (Attribute)</title>
<indexterm><primary>overlayImageIndex</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>overlayImageIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--overlayImageIndex----------------------------><

>>--overlayImageIndex = varName------------------><

]]>
</programlisting>

<para>
  Reflects the one-based index of the overlay image for this item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">overlayImageIndex get:</emphasis></term>
  <listitem>
  <para>
    Returns the one-based index of the overlay image for this item. 0 indicates the item has no overlay image.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">overlayImageIndex set:</emphasis></term>
  <listitem>
  <para>
    To specify an overlay image for this item assign the one-based index of the overlay image in the image list. Assign 0 to
    indicate the item should not use an overlay image. Valid indexes are 0 through 15. This is a limitation imposed by the
    operating system.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Both the full-sized icon image list and the small icon image list can have overlay images. The overlay image is
    superimposed over the item's icon image. If the overlay index is zero, the item has no overlay image.
  </para>
  <para>
    The overlay image index is actually part of the state value for an item in the underlying list-view control. The ooDialog
    framework hides some of the complexity of separating the overlay index from the state value by making the index a
    separate attribute in the <computeroutput>LvItem</computeroutput> object. If the programmer wants to retrieve the overlay
    index only, it is necessary to set the STATE flag in the <xref linkend="atrMaskClsLvi"/> attribute.
  </para>
  <para>
    Currently, ooDialog does not have support for overlay images in the <xref linkend="clsImageList"/> class. However, it is
    anticipated that support may be added in a future enhancement. Support for overlay image indexes in the
    <computeroutput>LvItem</computeroutput> class is a first step towards implementing support for overlay images.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::overlayImageIndex() [attribute]  -->

<section id="atrStateImageIndexClsLvi" xreflabel="stateImageIndex"><title>stateImageIndex (Attribute)</title>
<indexterm><primary>stateImageIndex</primary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>stateImageIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--stateImageIndex------------------------------><

>>--stateImageIndex = varName--------------------><

]]>
</programlisting>

<para>
  Reflects the one-based index of the state image for this item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">stateImageIndex get:</emphasis></term>
  <listitem>
  <para>
    Returns the one-based index of the state image for this item. 0 indicates the item has no state image.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">stateImageIndex set:</emphasis></term>
  <listitem>
  <para>
    To specify a state image for this item assign the one-based index of the state image in the state image list. Assign 0 to
    indicate the item should not use an state image. Valid indexes are 0 through 15. This is a limitation imposed by the
    operating system.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The state image is displayed next to an item's icon to indicate an application-defined state. If the state image index is
    zero, the item has no state image.
  </para>
  <para>
    The state image index is actually part of the state value for an item in the underlying list-view control. The ooDialog
    framework hides some of the complexity of separating the state index from the state value by making the index a
    separate attribute in the <computeroutput>LvItem</computeroutput> object. If the programmer wants to retrieve the state
    image index only, it is necessary to set the STATE flag in the <xref linkend="atrMaskClsLvi"/> attribute.
  </para>
  <para>
    Currently, ooDialog does not have support for setting the state image list in the <xref
    linkend="mthSetImageListClsListView"/> method of the <computeroutput>ListView</computeroutput> class. However, it is
    anticipated that support may be added in a future enhancement. Support for state image indexes in the
    <computeroutput>LvItem</computeroutput> class is a first step towards implementing support for state images.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::stateImageIndex() [attribute]  -->

<section id="atrTextClsLvi" xreflabel="text"><title>text (Attribute)</title>
<indexterm><primary>text</primary><secondary>LvItem class</secondary></indexterm>
<indexterm><primary>LvItem class</primary><secondary>text</secondary></indexterm>
<programlisting>
<![CDATA[
>>--text-----------------------------------------><

>>--text = varName-------------------------------><

]]>
</programlisting>

<para>
  Reflects the text, the label, for this item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">text get:</emphasis></term>
  <listitem>
  <para>
    Returns the text for this item. If no text has been set for this item, the <computeroutput>.nil</computeroutput> object
    is returned. Note that setting the text to the empty string is different than not having the text set at all. In
    addition, the operating system uses a special value to indicate to the list-view that it should generate a GETDISPINFO
    notification to retrieve the text for the item from the application. If this value is set, the string <emphasis
    role="italic">lpStrTextCallBack</emphasis> is returned as the text for this item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">text set:</emphasis></term>
  <listitem>
  <para>
    Assign a string to this attribute to set the text for the item. The string must be less than or equal to 260 characters
    in length. In addition the special string, <emphasis role="italic">lpStrTextCallBack</emphasis>, can be used to set the
    text value for the item to the value that indicates the list-view should generate a GETDISPINFO notification. Case is not
    significant when using <emphasis role="italic">lpStrTextCallBack</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Currently, there is no support for the GETDISPINFO event notification in <xref linkend="mthConnectListViewEvent"/>
    method. It is anticipated that support for this event will be added in the future. Until then, using the <emphasis
    role="italic">lpStrTextCallBack</emphasis> value will simply result in the item appearing with no text.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the current text for an item, appends a string to the text, and sets the text for the item to the new
    value:
<programlisting>
<![CDATA[

::method addQualifier private
    expose list
    use strict arg itemIndex, additionalText

    lvItem = .LvItem~new(itemIndex, , , , 'TEXT')
    if list~getItem(lvItem) then do
        lvItem~text = lvItem~text additionalText

        list~modifyItem(lvItem)
        return .true
    end
    else do
        return .false
    end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvItem::text() [attribute]  -->

</section> <!-- End LvItem Class -->


<section id="clsLvSubItem" xreflabel="LvSubItem"><title>LvSubItem Class</title>
<indexterm><primary>LvSubItem class</primary></indexterm>
<para>
  A LvSubItem object represents a specific subitem of a single item within a list-view control. Each item in a list-view can
  have one or more subitems. Each subitem can have a text string and an icon. In report view, the text, and optionally the
  icon, is displayed in a column separate from the item's icon and label. To display the subitem's icon, the list-view must
  have the SUBITEMIMAGES <link linkend="mthAddExtendedStyle">extended</link> style.
</para>
<para>
  All items in a list-view control have the same number of subitems. The number of subitems is determined by the number of
  columns in the list-view control. When a column is <link linkend="mthInsertColumnPX">added</link> to a list-view control,
  its associated subitem index is specified. When a column is added to a list-view, the list-view control creates a subitem
  for every existing item with a default value of no text and no icon. When a column is removed from a list-view, the
  list-view deletes the information it maintains for every subitem of that column.
</para>
<para>
  The list-view does not have to be in report view to have subitems. It does not have to be in report view to have columns
  added or deleted, the list-view can be in any view mode.
</para>
<para>
  <computeroutput>LvSubItem</computeroutput> objects can be used to set the information for a subitem or to receive
  information concerning a subitem. In addition, <xref linkend="clsLvFullRow"/> objects can be composed of subitem objects in
  addition to a <xref linkend="clsLvItem"/> object.
</para>

<section id="sctMethodsLvSubItem"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>LvSubItem</computeroutput> class:

<table id="tblMethodsLvSubItem" frame="all"> <title>LvSubItem Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*"/>
<colspec colwidth="4*"/>
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><link linkend="mthNewClsLvSubItem">new</link></entry>
<entry>Instantiates a new <computeroutput>LvSubItem</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Attribute Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrImageIndexClsLvSi"/></entry>
<entry>Reflects the index in the small icon <link linkend="mthSetImageListClsListView">image</link> list for this subitem.</entry>
</row>
<row>
<entry><xref linkend="atrItemClsLvSi"/></entry>
<entry>Reflects the index of the item in the list-view that this subitem belongs to.</entry>
</row>
<row>
<entry><xref linkend="atrMaskClsLvSi"/></entry>
<entry>The <emphasis role="italic">mask</emphasis> attribute is used to specify which values of the <computeroutput>LvSubItem</computeroutput> object are valid to set or receive the information for a list-view item's subitem.</entry>
</row>
<row>
<entry><xref linkend="atrSubItemClsLvSi"/></entry>
<entry>Reflects the subitem index of this <computeroutput>LvSubItem</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="atrTextClsLvSi"/></entry>
<entry>Reflects the text, the label, for this subitem.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsLvSubItem"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>LvSubItem class</secondary></indexterm>
<indexterm><primary>LvSubItem class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--item-,-subItem--+---------+--+--------------+--+--------+--)---------><
                          +-,-text--+  +-,-imageIndex-+  +-,-mask-+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>LvSubItem</computeroutput> object with the parameters specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    Instantiates a new <computeroutput>LvSubItem</computeroutput> object.
  </para>
  <variablelist>
    <varlistentry><term>item [required]</term>
    <listitem>
    <para>
      The zero-based index of the item this subitem belongs to. The argument can not be less than 0.  The <emphasis
      role="italic">item</emphasis> argument sets the <xref linkend="atrItemClsLvSi"/> attribute of this subitem.
    </para>
    <para>
      Note that depending on the use of this subitem, the ooDialog framework may modify the index attribute. For
      instance if the <computeroutput>LvSubItem</computeroutput> is contained in a <xref linkend="clsLvFullRow"/> object and
      the row is added to a list-view, the ooDialog framework will adjust the <emphasis role="italic">index</emphasis>
      attribute to reflect the actual index of the added item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>subItem [required]</term>
    <listitem>
    <para>
      The one-based index of this subitem. The argument can not be less than 1. The <emphasis role="italic">subItem</emphasis>
      argument sets the <xref linkend="atrSubItemClsLvSi"/> attribute of this subitem.
    </para>
    <para>
      Note that depending on the use of this subitem, the ooDialog framework may modify the <emphasis
      role="italic">subItem</emphasis> attribute. For instance if the <computeroutput>LvSubItem</computeroutput> is placed
      into a <xref linkend="clsLvFullRow"/> object, the ooDialog framework will adjust
      the <emphasis role="italic">subItem</emphasis> attribute to reflect the actual index of the column of the subitem in
      the full row.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [optional]</term>
    <listitem>
    <para>
      Sets the text, or label, for this list-view subitem. The <emphasis role="italic">text</emphasis> argument sets the
      <xref linkend="atrTextClsLvSi"/> attribute of this list-view subitem.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>imageIndex [optional]</term>
    <listitem>
    <para>
      The zero-based index of the subitem's icon in the control's small icon <link
      linkend="mthSetImageListClsListView">image</link> list. Note that the image index has no meaning if the list-view does
      not have the SUBITEMIMAGES <link linkend="mthAddExtendedStyle">extended</link> style.
    </para>
    <para>
      The <emphasis role="italic">imageIndex</emphasis> argument can also be one of the following list-view <link
      linkend="sctListViewConstantMethods">constants</link>. If this argument is omitted, the default is IMAGENONE:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>IMAGECALLBACK</member>
        <member>IMAGENONE    </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>IMAGECALLBACK</term>
        <listitem>
        <para>
          Indicates the list-view control should send the GETDISPINFO notification message to retrieve the icon index for the
          subitem.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>IMAGENONE</term>
        <listitem>
        <para>
          The subitem does not have an icon. This is the default if this argument omitted.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    <para>
      The <emphasis role="italic">imageIndex</emphasis> argument sets the <xref linkend="atrImageIndexClsLvSi"/> attribute of
      this subitem.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mask [optional]</term>
    <listitem>
    <para>
      A list of blank separate keywords that specify which attributes of this <computeroutput>LvSubItem</computeroutput>
      object contain data to be set or which attributes are being requested. In general, the ooDialog framework will try to
      set the <xref linkend="atrMaskClsLvSi"/> attribute correctly without the programmer having to worry about this
      argument. As each attribute of the <computeroutput>LvSubItem</computeroutput> object is set, the appropriate keyword is
      added to the <emphasis role="italic">mask</emphasis> attribute. However, if this object is going to be used to retrieve
      information about the underlying list-view subitem, the ooDialog framwork has no way to know what attributes the
      programmer wishes to retrieve. For this use of the <computeroutput>LvSubItem</computeroutput> object, the programmer
      should set the mask to the value that will retrieve the information she wants.
    </para>
    <para>
      The <emphasis role="italic">mask</emphasis> argument can have zero or more of the following keywords, case is not
      significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>ALL        </member>
        <member>IMAGE      </member>
        <member>NORECOMPUTE</member>
        <member>TEXT       </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>ALL</term>
        <listitem>
        <para>
          A convenience keyword, the same as using the string: <emphasis role="italic">IMAGE NORECOMPUTE TEXT</emphasis>.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>IMAGE</term>
        <listitem>
        <para>
          The <xref linkend="atrImageIndexClsLvSi"/> attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NORECOMPUTE</term>
        <listitem>
        <para>
          Used when the <computeroutput>LvSubItem</computeroutput> object will be used to retrieve information through the
          <xref linkend="mthGetSubitem"/> method. Signals the list-view control should not generate a GETDISPINFO
          notification to retrieve the text. Rather, the <xref linkend="atrTextClsLvSi"/> attribute will contain <emphasis
          role="italic">lpStrTextCallBack</emphasis>.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TEXT</term>
        <listitem>
        <para>
          The <xref linkend="atrTextClsLvSi"/> attribute is valid or should be set.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    <para>
      The <emphasis role="italic">mask</emphasis> argument sets the <xref linkend="atrMaskClsLvSi"/> attribute of this
      subitem.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a newly instantiated and initialized <computeroutput>LvSubItem</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows <computeroutput>LvSubItem</computeroutput> objects being instantiated and used in a <xref
    linkend="clsLvFullRow"/> object, which in turn is used to add a new item to the list-view. Note that the list-view has the
    extended SUBITEMIMAGES style and the use of the <emphasis role="italic">imageIndex</emphasis> argument in the <emphasis
    role="italic">new</emphasis> method. Each column in the list-view will have its own icon:
<programlisting>
<![CDATA[

::method populateList private
    use strict arg list

    list~InsertColumnPx(0, "Title", 150)
    ret = list~InsertColumnPx(1, "Name", 75)
    ret = list~InsertColumnPx(2, "Last", 100)
    ret = list~InsertColumnPx(3, "e-mail", 150)

    list~addExtendedStyle("FULLROWSELECT UNDERLINEHOT ONECLICKACTIVATE SUBITEMIMAGES")

    lvItem = .LvItem~new(0, "Business manager", 6)
    lvSub1 = .LvSubItem~new(0, 1, "Tom", 14)
    lvSub2  = .LvSubItem~new(0, 2, "Sawyer", 26)
    lvSub3  = .LvSubItem~new(0, 3, "ts@google.com", 11)
    lvFullRow = .LvFullRow~new(lvItem, lvSub1, lvSub2, lvSub3, .true)
    list~addFullRow(lvFullRow)

    ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvSubItem::new() -->

<section id="atrImageIndexClsLvSi" xreflabel="imageIndex"><title>imageIndex (Attribute)</title>
<indexterm><primary>imageIndex</primary></indexterm>
<indexterm><primary>LvSubItem class</primary><secondary>imageIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--imageIndex-----------------------------------><

>>--imageIndex = varName-------------------------><

]]>
</programlisting>

<para>
  Reflects the index in the small icon <link linkend="mthSetImageListClsListView">image</link> list for this subitem.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">imageIndex get:</emphasis></term>
  <listitem>
  <para>
    Returns this subitem's icon image index, or one of the image <link linkend="sctListViewConstantMethods">constants</link>
    supplied by the <computeroutput>ListView</computeroutput> class, IMAGENONE or IMAGECALLBACK.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">imageIndex set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to the index in the small icon image list for this subitem, or to one of the image <link
    linkend="sctListViewConstantMethods">constants</link> supplied by the <computeroutput>ListView</computeroutput> class,
    IMAGENONE or IMAGECALLBACK.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In general, if the programmer does not explicitly set this attribute, the ooDialog framework will set it to the IMAGENONE
    constant. When the <computeroutput>LvSubItem</computeroutput> object is used to retrieve information about a subitem, the
    list-view control does not update the value for the index if the list-view does not have the SUBITEMIMAGES <link
    linkend="mthAddExtendedStyle">extended</link> style. Because of this, the value of this attribute is not well defined
    when the list-view does not have the SUBITEMIMAGES style.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example will set, or change, the image index for the subitem icon of the item at index 13, column 2 to 3. None of
    the other list-view item information will be changed.
<programlisting>
<![CDATA[

  lvSubItem = .LvSubItem~new(13, 2, , 3)
  list~modifyItem(lvItem)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End LvSubItem::imageIndex() [attribute]  -->

<section id="atrItemClsLvSi" xreflabel="item"><title>item (Attribute)</title>
<indexterm><primary>item</primary></indexterm>
<indexterm><primary>LvSubItem class</primary><secondary>item</secondary></indexterm>
<programlisting>
<![CDATA[
>>--item-----------------------------------------><

>>--item = varName-------------------------------><

]]>
</programlisting>

<para>
  Reflects the index of the item in the list-view that this subitem belongs to.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">index get:</emphasis></term>
  <listitem>
  <para>
    Returns the zero-based index of this subitem's item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">index set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to a zero-based index to specify which item in the list-view this subitem belongs to.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If this subitem is placed into a <xref linkend="clsLvFullRow"/> object, the ooDialog framework will update this attribute
    to reflect the actual item index of the full row the subitem is placed in.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvSubItem::item() [attribute]  -->

<section id="atrMaskClsLvSi" xreflabel="mask"><title>mask (Attribute)</title>
<indexterm><primary>mask</primary></indexterm>
<indexterm><primary>LvSubItem class</primary><secondary>mask</secondary></indexterm>
<programlisting>
<![CDATA[
>>--mask-----------------------------------------><

>>--mask = varName-------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">mask</emphasis> attribute is used to specify which values of the
  <computeroutput>LvSubItem</computeroutput> object are valid to set or receive the information for a list-view item's
  subitem.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">mask get:</emphasis></term>
  <listitem>
  <para>
    Returns a blank separated list of keywords specifying which attributes of this subitem are valid. The possible keywords
    are listed in the remarks section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">mask set:</emphasis></term>
  <listitem>
  <para>
    To specify which attributes in this item are to be used to set or receive information, assign a list of blank separated
    keywords to this attribute. The possible keywords are listed in the remarks section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">mask</emphasis> attributed contains a list of blank separate keywords that specify which
    attributes of this <computeroutput>LvSubItem</computeroutput> object contain data to be set or which attributes are being
    requested. In general, when setting data, the ooDialog framework will try to set the <emphasis
    role="italic">mask</emphasis> attribute correctly without the programmer having to worry about this argument. As each
    attribute of the <computeroutput>LvSubItem</computeroutput> object is set, the appropriate keyword is added to the
    <emphasis role="italic">mask</emphasis> attribute.
  </para>
  <para>
    However, if this object is going to be used to retrieve information about the underlying list-view item's subitem, the
    ooDialog framwork has no way to know what attributes the programmer wishes to retrieve. For this use of the
    <computeroutput>LvSubItem</computeroutput> object, the programmer should set the mask to the value that will retrieve the
    information he wants.
  </para>
  <para>
    The <emphasis role="italic">mask</emphasis> attribute can have zero or more of the following keywords. When assigning the
    string to this attribute case is insignificant. When getting the value of this attribute, the returned keywords will be
    all upper-cased:
  </para>
  <para>
    <simplelist type='vert' columns='3'>
      <member>ALL        </member>
      <member>IMAGE      </member>
      <member>NORECOMPUTE</member>
      <member>TEXT       </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>ALL</term>
      <listitem>
      <para>
        A convenience keyword, the same as using the string: <emphasis role="italic">IMAGE NORECOMPUTE TEXT</emphasis>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>IMAGE</term>
      <listitem>
      <para>
        The <xref linkend="atrImageIndexClsLvSi"/> attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>NORECOMPUTE</term>
      <listitem>
      <para>
        Used when the <computeroutput>LvSubItem</computeroutput> object will be used to retrieve information through the
        <xref linkend="mthGetSubitem"/> method. Signals the list-view control should not generate a GETDISPINFO notification
        to retrieve the text. Rather, the <xref linkend="atrTextClsLvSi"/> attribute will contain <emphasis
        role="italic">lpStrTextCallBack</emphasis>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>TEXT</term>
      <listitem>
      <para>
        The <xref linkend="atrTextClsLvSi"/> attribute is valid or should be set.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the icon index to 2, for the subitem in column 3 of the item at index 11. In this example, the mask
    attribute is set explicitly to make a point. But it is not actually needed:
<programlisting>
<![CDATA[

  subitem = .LvSubItem~new(11, 3, , 2, "IMAGE")

  list~modifySubItem(subitem)

]]>
</programlisting>
    This code snippet will work exactly the same as the example above:
<programlisting>
<![CDATA[

  subitem = .LvSubItem~new(11, 3, , 2)

  list~modifySubItem(subitem)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvSubItem::mask() [attribute]  -->

<section id="atrSubItemClsLvSi" xreflabel="subItem"><title>subItem (Attribute)</title>
<indexterm><primary>subItem</primary></indexterm>
<indexterm><primary>LvSubItem class</primary><secondary>subItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--subItem--------------------------------------><

>>--subItem = varName----------------------------><

]]>
</programlisting>

<para>
  Reflects the subitem index of the <computeroutput>LvSubItem</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">subItem get:</emphasis></term>
  <listitem>
  <para>
    Returns the one-based subitem index of this object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">subItem set:</emphasis></term>
  <listitem>
  <para>
    Set this attribute to the one-based index of the list-view subitem this object represents.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If this subitem is placed into a <xref linkend="clsLvFullRow"/> object, the ooDialog framework will update this attribute
    to reflect the actual column of the full row the subitem is placed at.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvSubItem::subItem() [attribute]  -->

<section id="atrTextClsLvSi" xreflabel="text"><title>text (Attribute)</title>
<indexterm><primary>text</primary><secondary>LvSubItem class</secondary></indexterm>
<indexterm><primary>LvSubItem class</primary><secondary>text</secondary></indexterm>
<programlisting>
<![CDATA[
>>--text-----------------------------------------><

>>--text = varName-------------------------------><

]]>
</programlisting>

<para>
  Reflects the text, the label, for this subitem.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">text get:</emphasis></term>
  <listitem>
  <para>
    Returns the text for this subitem. If no text has been set for this subitem, the <computeroutput>.nil</computeroutput>
    object is returned. Note that setting the text to the empty string is different than not having the text set at all. In
    addition, the operating system uses a special value to indicate to the list-view that it should generate a GETDISPINFO
    notification to retrieve the text for the subitem from the application. If this value is set, the string <emphasis
    role="italic">lpStrTextCallBack</emphasis> is returned as the text for this subitem.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">text set:</emphasis></term>
  <listitem>
  <para>
    Assign a string to this attribute to set the text for the subitem. The string must be less than or equal to 260
    characters in length. In addition the special string, <emphasis role="italic">lpStrTextCallBack</emphasis>, can be used
    to set the text value for the subitem to the value that indicates the list-view should generate a GETDISPINFO
    notification. Case is not significant when using <emphasis role="italic">lpStrTextCallBack</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Currently, there is no support for the GETDISPINFO event notification in <xref linkend="mthConnectListViewEvent"/>
    method. It is anticipated that support for this event will be added in the future. Until then, using the <emphasis
    role="italic">lpStrTextCallBack</emphasis> value will simply result in the subitem appearing with no text.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the current text for a subitem, appends a string to the text, and sets the text for the subitem to the
    new value:
<programlisting>
<![CDATA[

::method addQualifier private
    expose list
    use strict arg itemIndex, subitemIndex, additionalText

    lvSubItem = .LvSubItem~new(itemIndex, subitemIndex, , , 'TEXT')
    if list~getSubItem(lvSubItem) then do
        lvSubItem~text = lvSubItem~text additionalText

        list~modifySubItem(lvSubItem)
        return .true
    end
    else do
        return .false
    end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End LvSubItem::text() [attribute]  -->

</section> <!-- End LvSubItem Class -->


</chapter>
