<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2005-2024, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<section id="clsMouse" xreflabel="Mouse"><title>Mouse Class</title>
<indexterm><primary>Mouse class</primary></indexterm>
<para>
  In Windows the mouse is one of the important user input devices for programs. A program receives mouse input in the
  form of <xref linkend="ovvWindowMessages"/>s that are sent or posted to the windows of the program. In
  addition the operating system provides a number of functions to work with the mouse. These functions allow the
  programmer to change the mouse behavior, configure the mouse, change its appearence, etc..
</para>
<para>
  <emphasis role="bold">Mouse Cursor:</emphasis> As the user moves the mouse across the screen, the operating system
  paints a bitmap on the screen that gives the user feedback as to the position of the mouse. This bitmap is called the
  <emphasis role="italic">mouse cursor</emphasis>. The cursor has a single pixel point in the bitmap called the <emphasis
  role="italic">hot spot</emphasis>. The position of the hot spot is considered to be the position of the mouse. All
  mouse messages are, normally, sent to the window beneath the hot spot, whether or not that window is active or has the
  keyboard focus.
</para>
<para>
  In the ooDialog framework, the <computeroutput>Mouse</computeroutput> class provides all the methods to work with the
  mouse and the mouse cursor. Because all mouse messages are sent by the operating system to a single window, in
  ooDialog each instantiated mouse object is affiliated with a specific window object. I.e., a specific dialog or dialog
  control object.
</para>


<section id="sctHitTestKeywords"><title>Hit Test Keywords</title>
<indexterm><primary>Hit Test Keywords</primary></indexterm>

<para>
  Windows has defined a number of numeric codes that are used to determine where the mouse cursor is positioned. These codes
  are used for what is commonly called a <emphasis role="italic">hit test</emphasis>. ooDialog defines a keyword for each of
  these codes.
</para>

<table id="tblHitTestKeyWord" frame="all"> <title>Possible <emphasis role="italic">Hit Test</emphasis> Values</title>
<tgroup cols="2">
<colspec colwidth="1*" /><colspec colwidth="4*" />
<thead>
<row>
<entry>Keyword</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
  <entry>ERROR</entry>
  <entry>On the screen background or on a dividing line between windows (same as NOWHERE.)</entry>
</row>
<row>
  <entry>TRANSPARENT</entry>
  <entry>In a window currently covered by another window in the same thread.</entry>
</row>
<row>
  <entry>NOWHERE</entry>
  <entry>On the screen background or on a dividing line between windows.</entry>
</row>
<row>
  <entry>CLIENT</entry>
  <entry>In a client area.</entry>
</row>
<row>
  <entry>CAPTION</entry>
  <entry>In a title bar.</entry>
</row>
<row>
  <entry>SYSMENU</entry>
  <entry>In a window menu or in a Close button in a child window.</entry>
</row>
<row>
  <entry>GROWBOX</entry>
  <entry>In a size box.</entry>
</row>
<row>
  <entry>MENU</entry>
  <entry>In a menu.</entry>
</row>
<row>
  <entry>HSCROLL</entry>
  <entry>In a horizontal scroll bar.</entry>
</row>
<row>
  <entry>VSCROLL</entry>
  <entry>In the vertical scroll bar.</entry>
</row>
<row>
  <entry>MINBUTTON</entry>
  <entry>In a Minimize button.</entry>
</row>
<row>
  <entry>MAXBUTTON</entry>
  <entry>In a Maximize button.</entry>
</row>
<row>
  <entry>LEFT</entry>
  <entry>In the left border of a resizable window (the user can click the mouse to resize the window horizontally).</entry>
</row>
<row>
  <entry>RIGHT</entry>
  <entry>In the right border of a resizable window (the user can click the mouse to resize the window horizontally).</entry>
</row>
<row>
  <entry>TOP</entry>
  <entry>In the upper-horizontal border of a window.</entry>
</row>
<row>
  <entry>TOPLEFT</entry>
  <entry>In the upper-left corner of a window border.</entry>
</row>
<row>
  <entry>TOPRIGHT</entry>
  <entry>In the upper-right corner of a window border.</entry>
</row>
<row>
  <entry>BOTTOM</entry>
  <entry>In the lower-horizontal border of a resizable window (the user can click the mouse to resize the window vertically).</entry>
</row>
<row>
  <entry>BOTTOMLEFT</entry>
  <entry>In the lower-left corner of a border of a resizable window (the user can click the mouse to resize the window diagonally).</entry>
</row>
<row>
  <entry>BOTTOMRIGHT</entry>
  <entry>In the lower-right corner of a border of a resizable window (the user can click the mouse to resize the window diagonally).</entry>
</row>
<row>
  <entry>BORDER</entry>
  <entry>In the border of a window that does not have a sizing border.</entry>
</row>
<row>
  <entry>OBJECT</entry>
  <entry>Microsoft does not describe what this means.</entry>
</row>
<row>
  <entry>CLOSE</entry>
  <entry>In a Close button.</entry>
</row>
<row>
  <entry>HELP</entry>
  <entry>In a Help button.</entry>
</row>
</tbody></tgroup>
</table>

</section> <!-- End Hit Test Keywords section -->


<section id="sctMethodsMouse"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>Mouse</computeroutput> class:

<table id="tblMethodsMouse" frame="all"> <title>Mouse Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="sctMouseConstantMethods">Constant Methods</link></entry>
<entry>The <computeroutput>Mouse</computeroutput> class provides a single <emphasis role="italic">constant</emphasis> value through the <computeroutput>::constant</computeroutput>directive.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsMouse"/></entry>
<entry>Instantiates a new mouse object.</entry>
</row>
<row>
<entry><xref linkend="mthDoubleClickTime"/></entry>
<entry>Retrieves the current double-click time for the mouse.</entry>
</row>
<row>
<entry><xref linkend="mthLoadCursor"/></entry>
<entry>Returns one of the shared pre-defined system cursors.</entry>
</row>
<row>
<entry><xref linkend="mthLoadCursorFromFile"/></entry>
<entry>Creates a cursor based on data from a file.</entry>
</row>
<row>
<entry><xref linkend="mthSetDoubleClickTime"/></entry>
<entry>Sets the double-click time for the mouse.</entry>
</row>
<row>
<entry><xref linkend="mthSwapButton"/></entry>
<entry>Reverses or restores the meaning of the left and right mouse buttons.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthAppStarting"/></entry>
<entry>Sets the mouse cursor to the system's default <emphasis role="italic">application starting</emphasis> cursor, which is usually the standard arrow with a small hourglass.</entry>
</row>
<row>
<entry><xref linkend="mthArrow"/></entry>
<entry>Sets the mouse cursor to the system's <emphasis role="italic">default</emphasis> cursor, which is usually the arrow cursor.</entry>
</row>
<row>
<entry><xref linkend="mthCapture"/></entry>
<entry>Sets the mouse capture to the window of this mouse instance.</entry>
</row>
<row>
<entry><xref linkend="mthClipCursor"/></entry>
<entry>Restricts the cursor position to a rectangular area on the screen.</entry>
</row>
<row>
<entry><xref linkend="mthConnectEvent"/></entry>
<entry>Connects mouse related <xref linkend="ovvEvents"/> notifications to a method in the Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthCross"/></entry>
<entry>Sets the mouse cursor to the system's default <emphasis role="italic">high precision</emphasis> cursor, which is usually the crosshair cursor.</entry>
</row>
<row>
<entry><xref linkend="mthDragDetect"/></entry>
<entry>Used to determine if the user has started a drag operation.</entry>
</row>
<row>
<entry><xref linkend="mthGetCapture"/></entry>
<entry>Retrieves the window handle, if any, that currently has captured the mouse.</entry>
</row>
<row>
<entry><xref linkend="mthGetClipCursor"/></entry>
<entry>Retrieves the screen coordinates of the rectangular area to which the cursor is confined.</entry>
</row>
<row>
<entry><xref linkend="mthGetCursorPos"/></entry>
<entry>Retrieves the current cursor position in pixels as a <computeroutput>Point</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthIsButtonDown"/></entry>
<entry>Determines if a mouse button is pressed.</entry>
</row>
<row>
<entry><xref linkend="mthNo"/></entry>
<entry>Sets the mouse cursor to the system's default <emphasis role="italic">not allowed</emphasis> cursor, which is usually a circle with a slash across it.</entry>
</row>
<row>
<entry><xref linkend="mthReleaseClipCursor"/></entry>
<entry>Releases the cursor so that it is free to move anywhere on the screen.</entry>
</row>
<row>
<entry><xref linkend="mthReleaseCapture"/></entry>
<entry>Releases the mouse capture from the window which had previously captured the mouse.</entry>
</row>
<row>
<entry><xref linkend="mthRestoreCursor"/></entry>
<entry>Restores the cursor for the window of this mouse instance.</entry>
</row>
<row>
<entry><xref linkend="mthSetCursor"/></entry>
<entry>Sets the cursor for the window of this mouse instance.</entry>
</row>
<row>
<entry><xref linkend="mthSetCursorPos"/></entry>
<entry>Moves the mouse cursor to the specified position.</entry>
</row>
<row>
<entry><xref linkend="mthShowCursor"/></entry>
<entry>Displays or hides the cursor.</entry>
</row>
<row>
<entry><xref linkend="mthTrackEvent"/></entry>
<entry>Initiates, or queries, mouse tracking behavior.</entry>
</row>
<row>
<entry><xref linkend="mthWait"/></entry>
<entry>Sets the mouse cursor to the system's default <emphasis role="italic">busy</emphasis> cursor, which is usually the hourglass cursor.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="sctMouseConstantMethods"><title>Constant Methods</title>
<indexterm><primary>constant methods</primary><secondary>Mouse class</secondary></indexterm>
<para>
  The <computeroutput>Mouse</computeroutput> class provides a single <emphasis role="italic">constant</emphasis> value
  through the use of the <computeroutput>::constant</computeroutput> directive. The constant is listed in the following
  table.
</para>
<table id="tblConstantsMouse" frame="all"> <title>Mouse Class Constant Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" /><colspec colwidth="3*" />
<thead>
<row>
<entry>Constant Symbol</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry>HOVER_DEFAULT</entry>
<entry>The default hover time out. Can be used for the <emphasis role="italic">hoverTime</emphasis> argument in the <xref linkend="mthTrackEvent"/> method.</entry>
</row>
</tbody></tgroup>
</table>
</section>

<section id="mthNewClsMouse" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>Mouse class</secondary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--windowObj--)---------------------------><

]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>Mouse</computeroutput> object. Each mouse object is associated with a single
  <xref linkend="ovvUnderlying"/> window, the window of the Rexx object used to instantiate the mouse
  object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>windowObj [required]</term>
    <listitem>
    <para>
      A Rexx object that has an underlying Windows window. In all practical terms this is either a Rexx <xref
      linkend="chpDialogObject"/> object or a Rexx dialog <xref linkend="chpDialogControlObject"/> object.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a new <computeroutput>Mouse</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The operating system sends all mouse related <xref linkend="ovvWindowMessages"/>s to the window the
    mouse is over. Because of this, each Rexx mouse object is associated with a specific window. This is important for
    the programmer to understand, especially when connecting mouse event notifications. Since all dialog controls are
    windows, when the mouse is over a dialog, most messages go to one of the dialog controls that make up the dialog.
    Therefore, if the programmer is interested is the mouse event notifications, much of the time the programmer will
    need to use a mouse object associated with a dialog control, not a mouse associated with the dialog.
  </para>
  <para>
    All mouse event notifications are connected through the <xref linkend="mthConnectEvent"/> method
    of the <computeroutput>Mouse</computeroutput> class, not through one of the connect event methods of the dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example constructs a mouse object using the dialog object and then connects the double click mouse event to a
    method in the dialog. When the user double clicks the primary mouse button on the background of the dialog, not on a
    dialog control, the event handler is invoked:
<programlisting>
<![CDATA[

  ::method init
    ...

    mouse = .Mouse~new(self)
    mouse~connectEvent('LBUTTONDBLCLK', onDoubleClick)
    ...

  ::method onDoubleClick unguarded
    use arg state, position, mouse

    -- Do something ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::new() -->

<section id="mthDoubleClickTime" xreflabel="doubleClickTime"><title>doubleClickTime (Class Method)</title>
<indexterm><primary>doubleClickTime</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>doubleClickTime</secondary></indexterm>
<programlisting>
<![CDATA[
>>--doubleClickTime------------------------------><

]]>
</programlisting>

<para>
  Retrieves the current double-click time for the mouse.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is the current double-click time in milliseconds.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A double-click is a series of two clicks of the mouse button, the second occurring within a specified time after the
    first. The double-click time is the maximum number of milliseconds that may occur between the first and second click
    of a double-click. The double-click time is a system-wide parameter.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This simple example prints the double-click time to the screen:
<programlisting>
<![CDATA[

  ::method showDoubleClkTime

    say 'The system-wide mouse double-click time is:' .Mouse~doubleClickTime 'milliseconds.'

  /* Output might be:

  The system-wide mouse double-click time is: 340 milliseconds.

  /*

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::doubleClickTime() -->

<section id="mthLoadCursor" xreflabel="loadCursor"><title>loadCursor (Class Method)</title>
<indexterm><primary>loadCursor</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>loadCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--loadCursor(--cursorName--)-------------------><

]]>
</programlisting>

<para>
  Returns one of the shared pre-defined system cursors.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>cursorName [required]</term>
      <listitem>
      <para>
        Exactly one of the following keywords to indicate which system cursor is desired, case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>APPSTARTING</member>
          <member>ARROW      </member>
          <member>CROSS      </member>
          <member>HAND       </member>
          <member>HELP       </member>
          <member>IBEAM      </member>
          <member>NO         </member>
          <member>SIZEALL    </member>
          <member>SIZENESW   </member>
          <member>SIZENS     </member>
          <member>SIZENWSE   </member>
          <member>SIZEWE     </member>
          <member>UPARROW    </member>
          <member>WAIT       </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>APPSTARTING</term>
          <listitem>
          <para>
            Standard arrow and small hourglass.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ARROW</term>
          <listitem>
          <para>
            Standard arrow.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CROSS</term>
          <listitem>
          <para>
            Crosshair.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HAND</term>
          <listitem>
          <para>
            Hand.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HELP</term>
          <listitem>
          <para>
            Arrow and question mark.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>IBEAM</term>
          <listitem>
          <para>
            I-beam.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NO</term>
          <listitem>
          <para>
            Slashed circle.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZEALL</term>
          <listitem>
          <para>
            Four-pointed arrow pointing north, south, east, and west.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZENESW</term>
          <listitem>
          <para>
            Double-pointed arrow pointing northeast and southwest.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZENS</term>
          <listitem>
          <para>
            Double-pointed arrow pointing north and south.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZENWSE</term>
          <listitem>
          <para>
            Double-pointed arrow pointing northwest and southeast.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZEWE</term>
          <listitem>
          <para>
            Double-pointed arrow pointing west and east.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>UPARROW</term>
          <listitem>
          <para>
            Vertical arrow.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>WAIT</term>
          <listitem>
          <para>
            Hourglass.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The requested cursor as a <xref linkend="clsImage"/> object on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The returned <computeroutput>Image</computeroutput> object is a shared image and should not be released.  The
    ooDialog framework will ignore any requests to release the object.
  </para>
  <para>
    Note that the description for the system cursors is the description for the default pre-defined cursors. The user
    has the ability to change any of the default cursors to a custom cursor.
  </para>
  <para>
    The loaded cursor is suitable to use in the <xref linkend="mthSetCursor"/> method. Note that the
    system cursors can also be loaded directly using the <xref linkend="clsImage"/> class's
 <xref linkend="mthGetImageClsImage"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example loads the <emphasis role="italic">No</emphasis> system cursor and checks for error. In reality, there
    is almost no chance of failure provided the correct keyword is used.
<programlisting>
<![CDATA[

::method init
  ...

  noDropCursor = .Mouse~loadCursor("NO")
  if noDropCursor == 0 then do
    msg = 'Error loading No Drop Cursor, system error code: ' || -
          .systemErrorCode SysGetErrortext(.systemErrorCode)

    title = 'Drag N Drop Rexx - Unrecoverable Error'

    ret = MessageDialog(msg, , title, 'OK', "EXCLAMATION")

    self~initCode = 1
    return self~initCode
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::loadCursor() -->

<section id="mthLoadCursorFromFile" xreflabel="loadCursorFromFile"><title>loadCursorFromFile (Class Method)</title>
<indexterm><primary>loadCursorFromFile</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>loadCursorFromFile</secondary></indexterm>
<programlisting>
<![CDATA[
>>--loadCursorFromFile(--fileName--)-------------><

]]>
</programlisting>

<para>
  Creates a cursor based on data from a file.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>fileName [required]</term>
      <listitem>
      <para>
        The name of the file containing the cursor data. This argument can either be a fully qualified or a relative
        file name.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The requested cursor as a <xref linkend="clsImage"/> object on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Note</emphasis> that the source file for the cursor must actually be a cursor file or the OS
    will refuse to load it. E.g., the file can not be simply any image file, trying to load a bitmap, or even an icon
    file, as a cursor will fail.
  </para>
  <para>
    The returned <xref linkend="clsImage"/> object is not a shared image and can be released when no longer
    needed, if desired to free up some (small) amount of system resources.
  </para>
  <para>
    The loaded cursor is suitable to use in the <xref linkend="mthSetCursor"/> method. Note that the
    system cursors can also be loaded directly using the <xref linkend="clsImage"/> class's
 <xref linkend="mthGetImageClsImage"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is similar to the <xref linkend="mthLoadCursor"/>, but it loads a custom cursor from a
    file:
<programlisting>
<![CDATA[

::method init
  ...

  dropOkCursor = .Mouse~loadCursorFromFile("dragging.cur")
  if dropOkCursor == 0 then do
    msg = 'Error loading Drop Ok Cursor, system error code: ' || -
          .systemErrorCode SysGetErrortext(.systemErrorCode)

    title = 'Drag N Drop Rexx - Unrecoverable Error'

    ret = MessageDialog(msg, , title, 'OK', "EXCLAMATION")

    self~initCode = 1
    return self~initCode
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::loadCursorFromFile() -->

<section id="mthSetDoubleClickTime" xreflabel="setDoubleClickTime"><title>setDoubleClickTime (Class Method)</title>
<indexterm><primary>setDoubleClickTime</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>setDoubleClickTime</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setDoubleClickTime(--+------------+--)-------><
                         +-,-interval-+
]]>
</programlisting>

<para>
  Sets the double-click time for the mouse.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>interval [optional]</term>
      <listitem>
      <para>
        The time in milliseconds to set the double-click time to. If this is 0, the default system double-click time is
        restored, which is 500 milliseconds. If omitted the default for <emphasis role="italic">interval</emphasis> is
        0.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A double-click is a series of two clicks of the mouse button, the second occurring within a specified time after the
    first. The double-click time is the maximum number of milliseconds that may occur between the first and second click
    of a double-click. The double-click time is a system-wide parameter.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example checks the current double-click time and if it is below 500 milliseconds, it resets the time to the
    usual system default.
<programlisting>
<![CDATA[

::method resetDefaults private

  ...

  if .Mouse~doubleClickTime > 500 then .Mouse~setDoubleClickTime

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::setDoubleClickTime() -->

<section id="mthSwapButton" xreflabel="swapButton"><title>swapButton (Class Method)</title>
<indexterm><primary>swapButton</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>swapButton</secondary></indexterm>
<programlisting>
<![CDATA[
>>--swapButton(--+--------+--)-------------------><
                 +--swap--+
]]>
</programlisting>

<para>
  Reverses or restores the meaning of the left and right mouse buttons.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>swap [optional]</term>
      <listitem>
      <para>
        Specifies whether the meaning of the mouse buttons are reversed or restored.
      </para>
      <para>
        If true, the left button generates right-button messages and the right button generates left-button messages. If
        false, the buttons are restored to their original meanings. The default is true.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    If the buttons were swapped before this method is invoked, the return is true, if the buttons were not swapped, the
    return is false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Button swapping is provided by Windows as a convenience to people who use the mouse with their left hands. The
    button swapping functionality is usually done through the Control Panel only. Although any application is free to
    use this functionality, the mouse is a shared resource and reversing the meaning of its buttons affects the entire
    system.
  </para>
  <para>
    Note that the way the operating system handles button swapping makes this mostly transparent to the programmer. When
    the programmer is interested in receiving a mouse event notification, say the left mouse button clicked event, then
    he just needs to connect the LBUTTONDOWN event and not worry about whether the user has swapped buttons or not. If
    the user has swapped the mouse buttons, the operating system will generate the LBUTTONDOWN event when the user
    presses the right hand button.
  </para>
  <para>
    Arguably, it might be better to call the left physical mouse button the <emphasis role="italic">primary</emphasis>
    button or <emphasis role="italic">button1</emphasis>, Windows does not do this and this documentation uses the
    Windows naming conventions.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> to 0, but there are no system errors
    that would change the value from 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from a program my nephew wrote and set to automatically run at 12:01 am, April 1st on his
    brother's computer. He thought it was hilarious, his brother was not amused.
<programlisting>
<![CDATA[

/* aprilFools.rex */

  .Mouse~swapButton

  return 0

::requires 'ooDialog.cls'

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::swapButton() -->

<section id="mthAppStarting" xreflabel="appStarting"><title>appStarting</title>
<indexterm><primary>appStarting</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>appStarting</secondary></indexterm>
<programlisting>
<![CDATA[
>>--appStarting----------------------------------><

]]>
</programlisting>

<para>
  Sets the cursor for the window of this mouse instance to the operating system's predefined <emphasis
  role="italic">application starting</emphasis> cursor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous cursor on success, or 0 on error. An error is unlikely.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">appStarting</emphasis> method is convenience method. It is exactly equivalent to using
    the <xref linkend="mthSetCursor"/> method with the APPSTARTING keyword.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the cursor to the application starting cursor for 2 seconds, then restores it. This could be done,
    for instance, while the application is displaying a splash screen when it starts up. (A practice that used to be
    very common in Windows, but you don't see that often anymore.)
<programlisting>
<![CDATA[

::method initDialog
  self~startingUp

::method startingUp private unguarded

  reply 0

  mouse = .Mouse~new(self)

  -- This sets the mouse position to a point we know is
  -- not over a dialog control.  If the mouse is over a
  -- dialog control, changing the cursor will have no
  -- effect, unless the user moves it over the dialog
  -- background during the 2 seconds.
  p = .Point~new(30, 30)
  self~client2screen(p)

  mouse~setCursorPos(p)

  oldCursor = mouse~appStarting

  -- Jiggle the mouse so that it repaints immediately
  p = mouse~getCursorPos
  p~incr
  mouse~setCursorPos(p)

  j = SysSleep(2)

  mouse~setCursor(oldCursor)

  -- Jiggle ...
  p = mouse~getCursorPos
  p~decr
  mouse~setCursorPos(p)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::appStarting() -->

<section id="mthArrow" xreflabel="arrow"><title>arrow</title>
<indexterm><primary>arrow</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>arrow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--arrow----------------------------------------><

]]>
</programlisting>

<para>
  Sets the cursor for the window of this mouse instance to the operating system's predefined <emphasis
  role="italic">normal</emphasis> cursor, which is usually the standard arrow.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous cursor on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">arrow</emphasis> method is convenience method. It is exactly equivalent to using
    the <xref linkend="mthSetCursor"/> method with the ARROW keyword.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example just shows syntax, the method is not difficult to understand:
<programlisting>
<![CDATA[

  mouse = .Mouse~new(self)
  oldCursor = mouse~arrow

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::arrow() -->

<section id="mthCapture" xreflabel="capture"><title>capture</title>
<indexterm><primary>capture</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>capture</secondary></indexterm>
<programlisting>
<![CDATA[
>>--capture--------------------------------------><

]]>
</programlisting>

<para>
  Sets the mouse capture to this mouse's window. Once a window has captured the mouse, all mouse input is directed to
  the window even when the mouse is moved outside the boundaries of the window.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The handle to the window that previously captured the mouse, or 0 if the mouse was not captured before.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The mouse capture functions work with windows of the same thread. For ooDialog, this means the dialog window and the
    dialog control windows that belong to the same dialog as this mouse's window. The <emphasis
    role="italic">capture</emphasis> method can capture mouse input either when the mouse is over the dialog this
    mouse's window belongs to, or when the mouse button was pressed while the mouse was over that dialog, and the button
    is still down. Only one window at a time can capture the mouse.
  </para>
  <para>
    If the mouse cursor is over a window created by another thread, the system will direct mouse input to the specified
    window only if a mouse button is down.
  </para>
  <para>
    Only the foreground window, or a window belonging to the foreground window, can capture the mouse. Also, even if the
    foreground window has captured the mouse, the user can still click another window, bringing it to the foreground.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> to 0, but there are no operating system
    errors that would change the variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a method that initiates a drag and drop operation. It captures the mouse so that all mouse
    messages are directed to the same window and the program can monitor both the current position of the mouse, and
    when the mouse button is released:
<programlisting>
<![CDATA[

::method doDrag private
  expose oldCursor noDropCursor cursorIsNoDrop dragging
  use arg listView, index, p, mouse

  mouse~capture
  oldCursor = mouse~setCursor(noDropCursor)

  dragItem = .DragItem~new(listView, index, p, mouse)

  cursorIsNoDrop = .true
  dragging       = .true

  return dragItem

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::capture() -->

<section id="mthClipCursor" xreflabel="clipCursor"><title>clipCursor</title>
<indexterm><primary>clipCursor</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>clipCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--clipCursor(--rect--)-------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">clipCursor</emphasis> function restricts the cursor position to a rectangular area on the
  screen. When, or if, a subsequent cursor position (set by the <xref linkend="mthSetCursorPos"/>
  method or a mouse movement) would be outside the rectangle, the operating system automatically adjusts the position to
  keep the cursor inside the rectangular area
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>rect</term>
      <listitem>
      <para>
        A <link linkend="ovvRectangleCoordinates">bounding</link> rectangle specified as a
<xref linkend="clsRect"/> object that defines the area the cursor is confined to.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The cursor is a shared resource. If an application confines the cursor, it must release the cursor at some point by
    using <xref linkend="mthReleaseClipCursor"/> before the user can move to another application
    using the mouse.
  </para>
  <para>
    However, although the MSDN documentation does not explicity state this, experimentation shows that if the user
    brings up the Alt-Tab switching dialog and moves to another application in that manner, the cursor is no longer
    confined. If the user closes the dialog, the mouse is no longer confined.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example confines the cursor to the client area of the dialog:
<programlisting>
<![CDATA[

  r = self~clientRect
  self~client2screen(r)
  mouse~clipCursor(r)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::clipCursor() -->

<section id="mthConnectEvent" xreflabel="connectEvent"><title>connectEvent</title>
<indexterm><primary>connectEvent</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>connectEvent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectEvent(--event--+------------+--+-------------+--+--------+--)-------><
                          +-,-methName-+  +-,-willReply-+  +-,-opts-+
]]>
</programlisting>

<para>
  Connects mouse related Windows <xref linkend="ovvEvents"/> notifications to a method in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>event [required]</term>
      <listitem>
      <para>
        Specifies which event to connect. Use exactly one of the following keywords, case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>CAPTURECHANGED</member>
          <member>LBUTTONDBLCLK </member>
          <member>LBUTTONDOWN   </member>
          <member>LBUTTONUP     </member>
          <member>MBUTTONDOWN   </member>
          <member>MBUTTONUP     </member>
          <member>MBUTTONDBLCLK </member>
          <member>MOUSEHOVER    </member>
          <member>MOUSELEAVE    </member>
          <member>MOUSEMOVE     </member>
          <member>MOUSEWHEEL    </member>
          <member>RBUTTONDBLCLK </member>
          <member>RBUTTONDOWN   </member>
          <member>RBUTTONUP     </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>CAPTURECHANGED</term>
          <listitem>
          <para>
            This event notification is sent to the window that is losing the mouse capture. The
            <xref linkend="evtCAPTURCHANGED"/> Event Handler contains information on coding the event handler.
          </para> </listitem></varlistentry>
          <varlistentry><term>LBUTTONDBLCLK</term>
          <listitem>
          <para>
            The event notification is sent when the user double-clicks the left mouse button while the cursor is in the
            client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>LBUTTONDOWN</term>
          <listitem>
          <para>
            The event notification is sent when the user presses the left mouse button while the cursor is in the client
            area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler contains
            information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>LBUTTONUP</term>
          <listitem>
          <para>
            The event notification is sent when the user releases the left mouse button while the cursor is in the
            client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MBUTTONDBLCLK</term>
          <listitem>
          <para>
            The event notification is sent when the user double-clicks the middle mouse button while the cursor is in
            the client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MBUTTONDOWN</term>
          <listitem>
          <para>
            The event notification is sent when the user presses the middle mouse button while the cursor is in the
            client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MBUTTONUP</term>
          <listitem>
          <para>
            The event notification is sent when the user releases the middle mouse button while the cursor is in the
            client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MOUSEHOVER</term>
          <listitem>
          <para>
            The event notification is sent when the cursor hovers over the client area of the window for the period of
            time specified in a prior call to the <xref linkend="mthTrackEvent"/> method. The
            <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler contains information on coding the event
            handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MOUSELEAVE</term>
          <listitem>
          <para>
            The event notification is sent when the cursor leaves the client area of the window specified in a prior
            call to the <xref linkend="mthTrackEvent"/> method. The
            <xref linkend="evtMOUSELEAVE"/> Event Handler contains information on coding the event handler.
          </para> </listitem></varlistentry>
          <varlistentry><term>MOUSEMOVE</term>
          <listitem>
          <para>
            The event notification is sent when the cursor moves. The
            <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler contains information on coding the event
            handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MOUSEWHEEL</term>
          <listitem>
          <para>
            The event notification is sent when the mouse wheel is rotated. The
            <xref linkend="evtMOUSEWHEEL"/> Event Handler contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NCMOUSEHOVER</term>
          <listitem>
          <para>
            The event notification is sent when the cursor hovers over the
            non-<xref linkend="defClientArea"/> of the window for the period of time specified in a prior
            call to the <xref linkend="mthTrackEvent"/> method. The
            <xref linkend="evtNCMOUSEHOVER"/> Mouse Event Handler contains information on coding the event handler.
          </para> </listitem></varlistentry>
          <varlistentry><term>NCMOUSELEAVE</term>
          <listitem>
          <para>
            The event notification is sent when the cursor leaves the non-<xref linkend="defClientArea"/>
            area of the window specified in a prior call to the <xref linkend="mthTrackEvent"/> method. The <xref
            linkend="evtMOUSELEAVE"/> Event Handler contains information on coding the event handler.
          </para> </listitem></varlistentry>
          <varlistentry><term>RBUTTONDBLCLK</term>
          <listitem>
          <para>
            The event notification is sent when the user double-clicks the right mouse button while the cursor is in
            the client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RBUTTONDOWN</term>
          <listitem>
          <para>
            The event notification is sent when the user presses the right mouse button while the cursor is in the
            client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RBUTTONUP</term>
          <listitem>
          <para>
            The event notification is sent when the user releases the right mouse button while the cursor is in the
            client area of the window. The <xref linkend="evtGeneralMouseEvent"/> Mouse Event Handler
            contains information on coding the event handler.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>methName [optional]</term>
      <listitem>
      <para>
        The name of the method in the Rexx dialog that is to be invoked when the event notification is generated. If
        this argument is omitted, the method name is constructed automatically by the ooDialog framework. The method
        name is constructed by prepending the word <emphasis role="italic">on</emphasis> to the event keyword. For
        example, if the event is LBUTTONDOWN, the constructed method name would be <emphasis
        role="italic">onLButtonDown</emphasis>. If the event is MOUSEHOVER, the constructed method name would be
        <emphasis role="italic">onMouseHover</emphasis>, etc..
      </para>
      </listitem></varlistentry>
      <varlistentry><term>willReply [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">willReply</emphasis> argument controls whether the interpreter
        <link linkend="sctCodingEventHandlers">waits</link>) for the reply from the event handler. The default is
        <computeroutput>.true</computeroutput>, the interpreter waits for the reply. If <emphasis
        role="italic">willReply</emphasis> is <computeroutput>.false</computeroutput>, the interpreter does not wait for
        the event handling method to return a value. See the Remarks section.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>opts [optional]</term>
      <listitem>
      <para>
        Exactly one of the following keywords, case is not significant. The argument adds some control as to how the
        ooDialog framework replies to the operating system for the specified event notification. This argument is only
        applicable in certain cases. See the Remarks section for further details.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>REPLYFALSE   </member>
          <member>SENDTODLG    </member>
          <member>SENDTOCONTROL</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>REPLYFALSE</term>
          <listitem>
          <para>
            When the mouse window is a dialog window and <emphasis role="italic">willReply</emphasis> is false, this
            keyword will cause the reply to the operating system to indicate that the mouse event was not handled. By
            default the reply to the operating system will indicate the event was handled.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SENDTODLG</term>
          <listitem>
          <para>
            When the mouse window is a dialog control window, this keyword indicates that the mouse event notification
            message should be sent straight to the dialog. In this case, the <emphasis
            role="italic">methodName</emphasis> and <emphasis role="italic">willReply</emphasis> arguments have no
            effect. No method will be invoked. The event will be handled by the dialog window, if connected.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SENDTOCONTROL</term>
          <listitem>
          <para>
            When the mouse window is a dialog control window and <emphasis role="italic">willReply</emphasis> is false,
            this keyword will cause the event notification to be passed on to the dialog control. This allows the dialog
            control to handle the event as it normally would. By default, the reply to the operating system is that the
            event was handled, and the dialog control never sees the event.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on error. An error is not likely.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    See the sections on <link linkend="sctConnectingEventHandlers">connecting</link> and <link
    linkend="sctCodingEventHandlers">coding</link> event handlers for additional information on event handlers. Note that it
    is not possible to instantiate a mouse object tied to a dialog control window until after the <xref
    linkend="ovvUnderlying"/> dialog has been created. Therefore, for dialog control windows the <emphasis
    role="italic">connectEvent</emphasis> method is normally invoked in the <xref linkend="mthInitDialog"/> method.
  </para>
  <para>
    <emphasis role="bold">Note</emphasis> that to properly handle and process mouse event messages, it is usually
    necessary for the interpreter to wait for the reply from the event handler. If the programmer specifies false for
    the <emphasis role="italic">willReply</emphasis> argument, the event handler is likely to behave unpredictably. This
    is particularly true for the MOUSEMOVE event.
  </para>
  <para>
    For mouse events, there are several possible ways for the ooDialog framework to reply to the operating system in
    response to the underlying notification message. The possible replies are dependent on which type of window the
    mouse event is for, a dialog window or a dialog control window.
  </para>
  <variablelist>
    <varlistentry><term><emphasis role="bold">dialog window:</emphasis></term>
    <listitem>
    <para>
      When the mouse event is for a dialog window, ooDialog can reply to the operating system in these ways:
      <orderedlist>
      <listitem>
      <para>
        Tell the operating system the event was processed.
      </para>
      </listitem>
      <listitem>
      <para>
        Tell the operating system the event was not processed.
      </para>
      </listitem>
      </orderedlist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term><emphasis role="bold">dialog control window:</emphasis></term>
    <listitem>
    <para>
      When the mouse event is for a dialog control window, ooDialog can reply to the operating system in these ways:
      <orderedlist>
      <listitem>
      <para>
        Tell the operating system the event was processed.
      </para>
      </listitem>
      <listitem>
      <para>
        Have the operating system pass the message directly to the dialog.
      </para>
      </listitem>
      <listitem>
      <para>
        Have the operating system pass the message to the dialog control it was originally intended for.
      </para>
      </listitem>
      </orderedlist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  <para>
    The programmer specifies how ooDialog replies to the operating system through a combination of the <emphasis
    role="italic">willReply</emphasis> argument, the <emphasis role="italic">opts</emphasis> argument, and the return
    value of the event handler. The combinations are summarized in the following table:

    <table id="tblReplyCombinationsMouse" frame="all"> <title>Possible Replies to the Operating System</title>
    <tgroup cols="5">
    <colspec colwidth="1*" />
    <colspec colwidth="1*" />
    <colspec colwidth="1*" />
    <colspec colwidth="3*" />
    <thead>
    <row>
    <entry>Event</entry><entry>Will</entry><entry>Reply</entry><entry>opts</entry><entry>Action</entry>
    </row>
    <row>
    <entry>Window</entry><entry>Reply</entry><entry>Value</entry><entry>Argument</entry><entry>Taken</entry>
    </row>
    </thead>
    <tbody>
    <row>
    <entry>dialog</entry><entry>true</entry><entry><computeroutput>.true</computeroutput></entry><entry>omitted</entry><entry>OS told event processed.</entry>
    </row>
    <row>
    <entry>dialog</entry><entry>true</entry><entry><computeroutput>.false</computeroutput></entry><entry>omitted</entry><entry>OS told event not processed.</entry>
    </row>
    <row>
    <entry>dialog</entry><entry>false</entry><entry><computeroutput>n/a</computeroutput></entry><entry>omitted</entry><entry>OS told event processed.</entry>
    </row>
    <row>
    <entry>dialog</entry><entry>false</entry><entry><computeroutput>n/a</computeroutput></entry><entry>REPLYFALSE</entry><entry>OS told event not processed.</entry>
    </row>
    <row>
    <entry>dialog control</entry><entry>true</entry><entry><computeroutput>.true</computeroutput></entry><entry>omitted</entry><entry>OS told event processed.</entry>
    </row>
    <row>
    <entry>dialog control</entry><entry>true</entry><entry><computeroutput>.false</computeroutput></entry><entry>omitted</entry><entry>Message passed to the dialog control.</entry>
    </row>
    <row>
    <entry>dialog control</entry><entry>n/a</entry><entry><computeroutput>n/a</computeroutput></entry><entry>SENDTODLG</entry><entry>Message sent directly to the dialog.</entry>
    </row>
    <row>
    <entry>dialog control</entry><entry>false</entry><entry><computeroutput>n/a</computeroutput></entry><entry>omitted</entry><entry>OS told event processed.</entry>
    </row>
    <row>
    <entry>dialog control</entry><entry>false</entry><entry><computeroutput>n/a</computeroutput></entry><entry>SENDTOCONTROL</entry><entry>Message passed to the dialog control.</entry>
    </row>
    </tbody></tgroup>
    </table>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Resets the <xref linkend="dotSystemErrorCode"/> to zero. There are no operating
    system errors that would change the variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects the MOUSEWHEEL event for an edit control, using the SENDTODLG keyword for the <emphasis
    role="italic">opts</emphasis> argument. Note that no MOUSEWHEEL event is connected to the dialog. This has the
    effect of <emphasis role="italic">swallowing</emphasis> the event. The event notification is intercepted before it
    reaches the edit control, and no method in the dialog is invoked. When the user scrolls the mouse wheel while over
    the edit control, nothing happens.
<programlisting>
<![CDATA[

::method initDialog

  edit = self~newEdit(IDC_EDIT_FILE)

  mouse = .Mouse~new(edit)
  mouse~connectEvent(MOUSEWHEEL, , , SENDTODLG)

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>


<section id="evtCAPTURCHANGED" xreflabel="CAPTURECHANGED"><title>CaptureChanged Event Handler</title>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>CAPTURECHANGED</tertiary></indexterm>
<para>
  The event handler for the capture changed event is invoked when the window assigned to the mouse object is losing the
  capture. The event is received even if it is the mouse object itself that is
 <xref linkend="mthReleaseCapture"/> the capture. Microsoft's documentation states that the event handler
  should not attempt to <xref linkend="mthCapture"/> the mouse in response to this event.
</para>
<para>
  The programmer specifies if the interpreter waits or not for the return from the event handler through the arguments
  used in the <xref linkend="mthConnectEvent"/> method.
</para>

<programlisting>
<![CDATA[
::method onCaptureChanged unguarded
  use arg hwnd, mouse

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 2 arguments:
  </para>
  <variablelist>
    <varlistentry><term>hwnd</term>
    <listitem>
    <para>
      The window <xref linkend="defHandle"/> of the window gaining the mouse capture.  This may be 0 if
      there is no window gaining the capture.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mouse</term>
    <listitem>
    <para>
      The Rexx <xref linkend="clsMouse"/> object for the window that received the MOUSEWHEEL event
      notification.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    In general, return <computeroutput>.true</computeroutput> to indicate the event has been processed and
    <computeroutput>.false</computeroutput> to indicate it was not processed. However, the correct response is dependent
    on how the event was connected, and is summarized in the <link linkend="tblReplyCombinationsMouse">Remarks</link>
    section for the <emphasis role="italic">connectEvent</emphasis> method.
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End CaptureChanged Event Handler -->

<section id="evtGeneralMouseEvent" xreflabel="General"><title>General Mouse Event Handler</title>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>LBUTTONDOWN</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>LBUTTONUP</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>LBUTTONDBLCLK</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>MBUTTONDOWN</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>MBUTTONUP</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>MBUTTONDBLCLK</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>MOUSEHOVER</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>MOUSEMOVE</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>RBUTTONDOWN</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>RBUTTONUP</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>RBUTTONDBLCLK</tertiary></indexterm>
<para>
  There are a number of mouse events where the event handler receives the same arguments and the reply from the event
  handler is generally done in the same manner. These events are:
  <itemizedlist>
  <listitem><para>LButtonDown</para></listitem>
  <listitem><para>LButtonUp</para></listitem>
  <listitem><para>LButtonDBlClk</para></listitem>
  <listitem><para>MButtonDown</para></listitem>
  <listitem><para>MButtonUp</para></listitem>
  <listitem><para>MButtonDBlClk</para></listitem>
  <listitem><para>MouseHover</para></listitem>
  <listitem><para>MouseMove</para></listitem>
  <listitem><para>RButtonDown</para></listitem>
  <listitem><para>RButtonUp</para></listitem>
  <listitem><para>RButtonDBlClk</para></listitem>
  </itemizedlist>
  The handler for these events is discussed here. When each event is generated is described in the arugment description
  for the <xref linkend="mthConnectEvent"/> method.
</para>
<para>
  The programmer decides whether to have the interpreter wait, or not wait, in the message processing loop for the reply
  from the event handler. This is done through the <xref linkend="mthConnectEvent"/> method. The reply
  indicates if the event was processed or not. A common value to return would be <computeroutput>.true</computeroutput>.
</para>

<programlisting>
<![CDATA[
::method onMouseEvent unguarded
  use arg state, pos, mouse

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 3 arguments:
  </para>
  <variablelist>
    <varlistentry><term>state</term>
    <listitem>
    <para>
      A list of keywords that indicate the keyboard and mouse button modifiers. The list will contain 1 or more of the
      following keywords separated by spaces. It will never be the empty string:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>None    </member>
        <member>Control </member>
        <member>lButton </member>
        <member>mButton </member>
        <member>rButton </member>
        <member>Shift   </member>
        <member>xButton1</member>
        <member>xButton2</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>None</term>
        <listitem>
        <para>
          There are no modifiers. <emphasis role="italic">None</emphasis> will always be the only keyword if it is
          present.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>Control</term>
        <listitem>
        <para>
          The control key is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>lButton</term>
        <listitem>
        <para>
          The left mouse button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>mButton</term>
        <listitem>
        <para>
          The middle mouse button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>rButton</term>
        <listitem>
        <para>
          The right mouse button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>xButton1</term>
        <listitem>
        <para>
          The first X button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>xButton2</term>
        <listitem>
        <para>
          The second X button is down.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>pos</term>
    <listitem>
    <para>
      A <xref linkend="clsPoint"/> object that contains the x and y coordinates of the position of the mouse,
      relative to the upper-left corner of the screen.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mouse</term>
    <listitem>
    <para>
      The Rexx <xref linkend="clsMouse"/> object for the window that received the mouse event notification.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    In general, return <computeroutput>.true</computeroutput> to indicate the event has been processed and
    <computeroutput>.false</computeroutput> to indicate it was not processed. However, the correct response is dependent
    on how the event was connected, and is summarized in the <link linkend="tblReplyCombinationsMouse">Remarks</link>
    section for the <xref linkend="mthConnectEvent"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Only windows that have the CS_DBLCLKS style can receive double click event notifications. The system generates the
    notification whenever the user presses, releases, and again presses the mouse button within the system's
    double-click time limit. Double-clicking a mouse button actually generates a sequence of four messages: mouse button
    down, mouse button up, mouse button double click, and mouse button up.
  </para>
  <para>
    To receive the mouse hover event, the programmer must first invoke the
 <xref linkend="mthTrackEvent"/> method with the proper arguments. The mouse tracking is canceled when the
    mouse hover notification is generated. To receive further mouse hover events, the <emphasis
    role="italic">trackEvent</emphasis> method must be invoked again.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example uses the <xref linkend="mthConnectEvent"/> method to connect the mouse left
    button down event sent to a list view window with the onLBDown method of the dialog.
<programlisting>
<![CDATA[

::method initDialog
  expose listView

  listView = self~newListView(IDC_LV_DATA)

  mouse = .Mouse~new(listView)
  mouse~connectEvent(LBUTTONDOWN, onLBDown)

  ...


::method onLBdown unguarded
  expose listView
  use arg keyState, p, mouse

  index = listView~hitTestInfo(p)

  if keyState \== 'lButton' | index = -1 then do
    -- Pass the message on to the list view control.
    return .false
  end

  -- Since the list view will not receive the left button
  -- down event, we need to manually do the item selection
  listView~assignFocus
  listView~focus(index)
  listView~select(index)

  -- Do custom processing for left button down
  ...

  -- Indicate the event was processed.
  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End General Mouse Event Handler -->

<section id="evtNCMOUSEHOVER" xreflabel="NCMOUSEHOVER"><title>NcMouseHover Event Handler</title>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>NCMOUSEHOVER</tertiary></indexterm>
<para>
  The event handler for the nc mouse leave event is invoked when the cursor leaves the
  non-<xref linkend="defClientArea"/> of the window assigned to the mouse object. Normally, this event
  notification is <emphasis role="italic">not</emphasis> generated. To receive the notification the
 <xref linkend="mthTrackEvent"/> method must be invoked to set up the tracking behavior.
</para>
<para>
  The programmer specifies if the interpreter waits or not for the return from the event handler through the arguments
  used in the <xref linkend="mthConnectEvent"/> method.
</para>

<programlisting>
<![CDATA[
::method onNcMouseHover unguarded
  use arg hit, pos, mouse

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 3 argument:
  </para>
  <variablelist>
    <varlistentry><term>hit</term>
    <listitem>
    <para>
      A single keyword that indicates the result of the operating system's hit test of the mouse position. This defines
      exactly where in the non-client area the mouse position is.  Over the max button, on the border, etc.. The keyword
      will be one of the words in the <link linkend="tblHitTestKeyWord">hit test table</link>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>pos</term>
    <listitem>
    <para>
      A <xref linkend="clsPoint"/> object that contains the x and y coordinates of the position of the mouse,
      relative to the upper-left corner of the screen.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mouse</term>
    <listitem>
    <para>
      The Rexx <xref linkend="clsMouse"/> object for the window that received the MOUSELEAVE or NCMOUSELEAVE
      event notification.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    In general, return <computeroutput>.true</computeroutput> to indicate the event has been processed and
    <computeroutput>.false</computeroutput> to indicate it was not processed. However, the correct response is dependent
    on how the event was connected, and is summarized in the <link linkend="tblReplyCombinationsMouse">Remarks</link>
    section for the <emphasis role="italic">connectEvent</emphasis> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To receive either of the mouse leave events, the programmer must first invoke the <xref linkend="mthTrackEvent"/> method
    with the proper arguments. The mouse tracking is canceled when the mouse leave notification, (or the mouse hover
    notification,) is generated. To receive further mouse leave or mouse hover events, the <emphasis
    role="italic">trackEvent</emphasis> method must be invoked again.
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End MouseLeave Event Handler -->

<section id="evtMOUSELEAVE" xreflabel="MOUSELEAVE"><title>MouseLeave Event Handler</title>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>MOUSELEAVE</tertiary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>NCMOUSELEAVE</tertiary></indexterm>
<para>
  This description for the mouse leave event handler pertains to both the <xref linkend="defClientArea"/>
  mouse leave (MOUSELEAVE) and the <emphasis role="italic">non-client</emphasis> mouse leave (NCMOUSELEAVE) events. The
  arguments received by event handler for both events are exactly the same, and the event handler should behave the same
  for both events.
</para>
<para>
  The event handler for the mouse leave event is invoked when the cursor leaves the client area (MOUSELEAVE) or the
  non-client area (NCMOUSELEAVE) of the window assigned to the mouse object. Normally, these event notifications are
  <emphasis role="italic">not</emphasis> generated. To receive these notifications the
 <xref linkend="mthTrackEvent"/> method must be invoked to set up the tracking behavior.
</para>
<para>
  The programmer specifies if the interpreter waits or not for the return from the event handler through the arguments
  used in the <xref linkend="mthConnectEvent"/> method.
</para>

<programlisting>
<![CDATA[
::method onMouseLeave unguarded
  use arg mouse

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 1 argument:
  </para>
  <variablelist>
    <varlistentry><term>mouse</term>
    <listitem>
    <para>
      The Rexx <xref linkend="clsMouse"/> object for the window that received the MOUSELEAVE or NCMOUSELEAVE
      event notification.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    In general, return <computeroutput>.true</computeroutput> to indicate the event has been processed and
    <computeroutput>.false</computeroutput> to indicate it was not processed. However, the correct response is dependent
    on how the event was connected, and is summarized in the <link linkend="tblReplyCombinationsMouse">Remarks</link>
    section for the <emphasis role="italic">connectEvent</emphasis> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To receive either of the mouse leave events, the programmer must first invoke the
 <xref linkend="mthTrackEvent"/> method with the proper arguments. The mouse tracking is canceled when the
    mouse leave notification is generated. To receive further mouse leave, the <emphasis
    role="italic">trackEvent</emphasis> method must be invoked again.
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End MouseLeave Event Handler -->

<section id="evtMOUSEWHEEL" xreflabel="MOUSEWHEEL"><title>MouseWheel Event Handler</title>
<indexterm><primary>Mouse class</primary><secondary>events</secondary><tertiary>MOUSEWHEEL</tertiary></indexterm>
<para>
  The event handler for the mouse wheel event is invoked each time the user scrolls the mouse wheel.
</para>
<para>
  The programmer decides whether to have the interpreter wait, or not wait, in the message processing loop for the reply
  from the event handler. This is done through the <xref linkend="mthConnectEvent"/> method. The reply
  indicates if the event was processed or not. A common value to return would be <computeroutput>.true</computeroutput>.
</para>

<programlisting>
<![CDATA[
::method onMouseWheel unguarded
  use arg state, pos, mouse, delta

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 4 arguments:
  </para>
  <variablelist>
    <varlistentry><term>state</term>
    <listitem>
    <para>
      A list of keywords that indicate the keyboard and mouse button modifiers. The list will contain 1 or more of the
      following keywords separated by spaces. It will never be the empty string:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>None    </member>
        <member>Control </member>
        <member>lButton </member>
        <member>mButton </member>
        <member>rButton </member>
        <member>Shift   </member>
        <member>xButton1</member>
        <member>xButton2</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>None</term>
        <listitem>
        <para>
          There are no modifiers. <emphasis role="italic">None</emphasis> will always be the only keyword if it is
          present.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>Control</term>
        <listitem>
        <para>
          The control key is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>lButton</term>
        <listitem>
        <para>
          The left mouse button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>mButton</term>
        <listitem>
        <para>
          The middle mouse button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>rButton</term>
        <listitem>
        <para>
          The right mouse button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>xButton1</term>
        <listitem>
        <para>
          The first X button is down.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>xButton2</term>
        <listitem>
        <para>
          The second X button is down.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>pos</term>
    <listitem>
    <para>
      A <xref linkend="clsPoint"/> object that contains the x and y coordinates of the mouse position,
      relative to the upper-left corner of the screen.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mouse</term>
    <listitem>
    <para>
      The Rexx <xref linkend="clsMouse"/> object for the window that received the MOUSEWHEEL event
      notification.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>delta</term>
    <listitem>
    <para>
      A whole number that represents the amount the scroll wheel was turned. The operating system always sends a multiple
      of 120. Microsoft says this is to allow for future expansion with hardware that has a finer grain of control. If
      the number is positive, the user turned the wheel away from herself and indicates to scroll up. When negative
      the user turned the wheel towards himself, and indicates to scroll down.
    </para>
    <para>
      At this point in time (c. 2011) the OS sends the event notification for each notch of the scroll wheel. Therefore
      delta is always 120 or -120.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    In general, return <computeroutput>.true</computeroutput> to indicate the event has been processed and
    <computeroutput>.false</computeroutput> to indicate it was not processed. However, the correct response is dependent
    on how the event was connected, and is summarized in the <link linkend="tblReplyCombinationsMouse">Remarks</link>
    section for the <xref linkend="mthConnectEvent"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The mouse wheel event notification is sent by the operating system to the window with the current input focus. If
    the window does not process the message, then the OS sends the message to the parent window of that window.  This
    continues on up the parent / child window chain until either a window does process the notification or the top of
    the chain is reached. Most dialog controls do not process the mouse wheel notification, so the notification will
    reach the dialog.
  </para>
  <para>
    Multi-line edit controls <emphasis role="italic">do</emphasis> process the notification and normally handle their
    own scrolling. If the programmer wants to implement some type of custom scrolling using the
 <xref linkend="mthConnectEvent"/> method, the edit control's interception of the notification may
    interfere with the custom scrolling. Forcing the edit control to ignore the notification allows it to reach the
    dialog.
  </para>
  <para>
    Additional information on the mouse wheel and handling mouse wheel events is found in the system parameters
    information <xref linkend="clsSPI"/> class's <xref linkend="atrWheelScrollLines"/> attribute.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example uses the <xref linkend="mthConnectEvent"/> method to connect the mouse wheel
    event sent to the edit control to a method in the Rexx dialog. This then allows the programmer to supply some custom
    scrolling.  Normally, a multi-line edit control handles the mouse wheel event itself and the notification message
    will never reach the dialog.
<programlisting>
<![CDATA[

::method initDialog
  expose eData

  eData = self~newEdit(IDC_EDIT_DATA)

  mouse = .Mouse~new(eData)
  mouse~connectEvent(MOUSEWHEEL, onMouseWheel)

  ...

::method onMouseWheel unguarded
  expose eData
  use arg state, pos, mouse, delta

  -- If the mouse is not over the edit control, do nothing and
  -- return .true to indicate the event was processed.
  if \ pos~inRect(eData~windowRect) then return .true

  -- Mouse is over our edit control, do custom scrolling ...

  if delta > 0 then direction = 'up'
  else direction = 'down'

  scrollLines = .SPI~wheelScrollLines

  select
    when state == 'None' then do
      amt = scrollLines
      if direction == 'up' then cmd = 'UP'
      else cmd = 'DOWN'
    end

    when state~wordPos('Control') <> 0, state~wordPos('Shift') <> 0 then do
      amt = 3
      if direction == 'up' then cmd = 'PAGEUP'
      else cmd = 'PAGEDOWN'
    end

    when state~wordPos('Control') <> 0 then do
      amt = 1
      if direction == 'up' then cmd = 'PAGEUP'
      else cmd = 'PAGEDOWN'
    end

    when state~wordPos('Shift') <> 0 then do
      amt = 3 * scrollLines
      if direction == 'up' then cmd = 'UP'
      else cmd = 'DOWN'
    end

    otherwise do
      -- Some other modifier(s), we treat this
      -- the same as 'None'
      amt = scrollLines
      if direction == 'up' then cmd = 'UP'
      else cmd = 'DOWN'
    end
  end

  eData~scrollCommand(cmd, amt)

  -- Indicate the event was processed.
  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End MouseWheel Event Handler -->

</section>  <!-- End Mouse::connectEvent() -->

<section id="mthCross" xreflabel="cross"><title>cross</title>
<indexterm><primary>cross</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>cross</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cross----------------------------------------><

]]>
</programlisting>

<para>
  Sets the mouse cursor to the system's default <emphasis role="italic">high precision</emphasis> cursor, which is
  usually the crosshair cursor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous cursor on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cross</emphasis> method is convenience method. It is exactly equivalent to using
    the <xref linkend="mthSetCursor"/> method with the CROSS keyword.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This a simple method to use:
<programlisting>
<![CDATA[

  mouse = .Mouse~new(self)
  oldCursor = mouse~cross

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::cross() -->

<section id="mthDragDetect" xreflabel="dragDetect"><title>dragDetect</title>
<indexterm><primary>dragDetect</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>dragDetect</secondary></indexterm>
<programlisting>
<![CDATA[
>>--dragDetect(--point--)------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">dragDetect</emphasis> method is used to determine if the user has started a drag
  operation.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>point [required]</term>
      <listitem>
      <para>
        The initial position of the cursor, in screen <xref linkend="defScreenCoordinates"/>) coordinates, specified
        as a <xref linkend="clsPoint"/> object. Recall that screen coordinates are always in pixels.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is true if the user is dragging and false otherwise.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In a drag and drop enabled program it is not desirable to start a drag operation each time the user presses the left
    mouse button. This results in the user moving something when they only wanted to click on it. The operating system
    provides the drag detect functionality as a convenience to programmers.
  </para>
  <para>
    A drag operation is detected when the user presses the mouse button and then moves the cursor outside of the
    <emphasis role="italic">drag rectangle</emphasis>, while keeping the mouse button down. The drag rectangle is
    configurable, allowing for smaller or larger rectangles. The size of the current drag rectangle, and changing the
    size of the drag rectangle can be done through the <xref linkend="atrDragWidth"/> and
 <xref linkend="atrDragHeight"/> attributes of the <xref linkend="clsSPI"/> (System Parameters
    Information) class.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Resets the <xref linkend="dotSystemErrorCode"/> to 0. However, there are no system
    errors that would change that value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the event handler for a left button down event. When the event occurs, the handler checks if the
    user has started a drag operation. If so, the application initiates the operation and returns true. If not, the
    handler simply returns:
<programlisting>
<![CDATA[

::method onLBdown unguarded
  expose dragItem
  use arg keyState, p, mouse

  if mouse~dragDetect(p) then do
    dragItem = self~doDrag(p, mouse)
    return .true
  end

  return .false

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::dragDetect() -->

<section id="mthGetCapture" xreflabel="getCapture"><title>getCapture</title>
<indexterm><primary>getCapture</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>getCapture</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCapture-----------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">getCapture</emphasis> method retrieves the window handle, if any, that currently has
  captured the mouse. The window that has captured the mouse receives all mouse input regardless of whether the mouse
  cursor is within the borders of the window or not.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The window <xref linkend="defHandle"/> of the window, belonging to the same dialog as this mouse's
    window, that had previously captured the mouse, or 0 if no window previously had the capture.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The mouse capture functions work with windows of the same thread. For ooDialog, this means the dialog window and the
    dialog control windows that belong to the same dialog as this mouse's window. Getting the mouse capture, can only
    get the window handle of windows belonging to the same dialog as this mouse's window. If 0 is returned, it means
    that no window in the same dialog as this mouse's window has the mouse capture. However, some window belonging to
    another dialog could have the mouse capture.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> to 0, but there are no system errors
    that would change the variable from 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::getCapture() -->

<section id="mthGetClipCursor" xreflabel="getClipCursor"><title>getClipCursor</title>
<indexterm><primary>getClipCursor</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>getClipCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getClipCursor(--rect--)----------------------><

]]>
</programlisting>

<para>
  Retrieves the screen coordinates of the rectangular area to which the cursor is confined.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>rect [required]</term>
      <listitem>
      <para>
        A <xref linkend="clsRect"/> object in which the coordinates are returned.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the cursor is not confined, i.e., it is <link linkend="mthClipCursor">clipped</link>/>, then on return <emphasis
    role="italic">rect</emphasis> will contain the coordinates of the screen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::getClipCursor() -->

<section id="mthGetCursorPos" xreflabel="getCursorPos"><title>getCursorPos</title>
<indexterm><primary>getCursorPos</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>getCursorPos</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCursorPos---------------------------------><

]]>
</programlisting>

<para>
  Retrieves the current position of the cursor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the postion, in screen <xref linkend="defScreenCoordinates"/>, as a <xref linkend="clsPoint"/> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The setCursorPos <link linkend="exampleSetCursorPos">example</link> uses the <emphasis
    role="italic">getCursorPos</emphasis> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::getCursorPos() -->

<section id="mthIsButtonDown" xreflabel="isButtonDown"><title>isButtonDown</title>
<indexterm><primary>isButtonDown</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>isButtonDown</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isMouseButtonDown(--+---------------+--)-----><
                        +--whichButton--+
]]>
</programlisting>

<para>
  Retrieves information on whether a mouse button is pressed.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single optional argument is:
    <variablelist>
      <varlistentry><term>whichButton [optional]</term>
      <listitem>
      <para>
        If this argument is omitted the default keyword is LEFT. Otherwise, use exactly one of the following keywords,
        case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>LEFT    </member>
          <member>RIGHT   </member>
          <member>MIDDLE  </member>
          <member>XBUTTON1</member>
          <member>XBUTTON2</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>LEFT</term>
          <listitem>
          <para>
            Determine if the primary mouse button is down. The primary mouse button may actually be the right physical
            mouse button if the user has configured the system to swap the mouse buttons.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RIGHT</term>
          <listitem>
          <para>
            Determine if the secondary mouse button is down. The secondary mouse button may actually be the left
            physical mouse button if the user has configured the system to swap the mouse buttons.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MIDDLE</term>
          <listitem>
          <para>
            Determine if the middle mouse button is down.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>XBUTTON1</term>
          <listitem>
          <para>
            Determine if the first X button is down. XBUTTON1 and XBUTTON2 are used by the operating system to support
            the Microsoft IntelliMouse Explorer.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>XBUTTON2</term>
          <listitem>
          <para>
            Determine if the second X button is down. XBUTTON1 and XBUTTON2 are used by the operating system to support
            the Microsoft IntelliMouse Explorer.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the specified button is being pressed, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> to 0, but there are no operarting
    system errors that would change it from 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example carries out some operation, does stuff, while either the right or the left mouse button, but not both
    buttons, is pressed:
<programlisting>
<![CDATA[

  lMB = self~isMouseButtonDown("LEFT")
  rMB = self~isMouseButtonDown("RIGHT")
  do while (lMB | rMB) & \(lMB & rMB)
      -- do stuff
      ...

      lMB = self~isMouseButtonDown("LEFT")
      rMB = self~isMouseButtonDown("RIGHT")
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::isButtonDown() -->

<section id="mthNo" xreflabel="no"><title>no</title>
<indexterm><primary>no</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>no</secondary></indexterm>
<programlisting>
<![CDATA[
>>--no-------------------------------------------><

]]>
</programlisting>

<para>
  Sets the mouse cursor to the system's default <emphasis role="italic">not allowed</emphasis> cursor, which is usually
  a circle with a slash across it.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous cursor on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">no</emphasis> method is convenience method. It is exactly equivalent to using the
 <xref linkend="mthSetCursor"/> method with the NO keyword.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This a simple method to use:
<programlisting>
<![CDATA[

  mouse = .Mouse~new(self)
  oldCursor = mouse~no

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::no() -->

<section id="mthReleaseCapture" xreflabel="releaseCapture"><title>releaseCapture</title>
<indexterm><primary>releaseCapture</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>releaseCapture</secondary></indexterm>
<programlisting>
<![CDATA[
>>--releaseMouseCapture--------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">releaseCapture</emphasis> method releases the mouse capture from the window, belonging to
  the same dialog as this mouse's window, which had previously <xref linkend="mthCapture"/> the mouse.
  Normal mouse input processing is then restored.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, the mouse capture was released, or 1 on failure. On failure, the
    <computeroutput>.systemErrorCode</computeroutput> will be set.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The mouse capture functions work with windows of the same thread. For ooDialog, this means the dialog window and the
    dialog control windows that belong to the same dialog as this mouse's window.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is a snippet of code from a drag and drop enabled program. It is part of the processing of the left
    button up event handler. If <emphasis role="italic">dragging</emphasis> is <computeroutput>.true</computeroutput>
    then we know that the mouse was captured when the drag operation was initiated, so the capture is released. The
    return from <emphasis role="italic">releaseCapture</emphasis> is not checked because it is unlikely to fail:
<programlisting>
<![CDATA[

  if dragging then do
    okayToDrop = (cursorIsNoDrop \== .true)

    dragging = .false
    cursorIsNoDrop = .false
    mouse~releaseCapture
    mouse~setCursor(oldCursor)
    ...
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::releaseCapture() -->

<section id="mthReleaseClipCursor" xreflabel="releaseClipCursor"><title>releaseClipCursor</title>
<indexterm><primary>releaseClipCursor</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>releaseClipCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--releaseClipCursor----------------------------><

]]>
</programlisting>

<para>
  Releases the cursor so that it is free to move anywhere on the screen.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The cursor is a shared resource. If an application confines the cursor through the
 <xref linkend="mthClipCursor"/> method, it must release the cursor at some point by using
    <emphasis role="italic">releaseClipCursor</emphasis> before the user can move to another application using the
    mouse.
  </para>
  <para>
    Although the MSDN documentation does not explicity state this, experimentation shows that if the user brings up the
    Alt-Tab switching dialog and moves to another application in that manner, the cursor is no longer confined. If the
    user closes the dialog, the mouse is no longer confined.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example releases the cursor from the clipped state.
<programlisting>
<![CDATA[

  mouse = .Mouse~new(self)
  mouse~releaseClipCursor

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::releaseClipCursor() -->

<section id="mthRestoreCursor" xreflabel="restoreCursor"><title>restoreCursor</title>
<indexterm><primary>restoreCursor</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>restoreCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--restoreCursor(--+----------+--)--------------><
                    +--cursor--+
]]>
</programlisting>

<para>
  Restores the cursor. This is a convenience method, the same functionality can be achieved using the
 <xref linkend="mthSetCursor"/> method.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>cursor [optional]</term>
      <listitem>
      <para>
        A cursor <xref linkend="clsImage"/> object that will be set as the cursor for the window of this
        mouse instance. If this argument is omitted then the operating system's pre-defined <emphasis
        role="italic">normal</emphasis> cursor, which is usually the arrow cursor, is set as the cursor for the window.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous cursor on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Normal usage of this method would generally be to use a cursor saved using the return from the
 <xref linkend="mthSetCursor"/> method as the <emphasis role="italic">cursor</emphasis> argument. Assuming
    the previous cursor was the arrow cursor and omitting the <emphasis role="italic">cursor</emphasis> argument can be
    wrong if the user has customized his system.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example calculates pi to 35 decimal places. While the calculation is being done the cursor is changed to the
    busy cursor, and then restored when the calculation is finished:
<programlisting>
<![CDATA[

  -- Get the current mouse position.
  mouse = .Mouse~new(self)
  oldCursorPos = mouse~getCursorPos

  -- Set the cursor to the busy symbol and jiggle the
  -- mouse so it repaints.
  oldCursor = mouse~wait
  oldCursorPos~incr
  mouse~setCursorPos(oldCursorPos)

  -- Calculate pi to 35 decimal places.
  pi = self~calcPi(35)

  -- Restore the cursor.
  oldCursorPos~decr
  mouse~restoreCursor(oldCursor)
  mouse~setCursorPos(oldCursorPos)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::restoreCursor() -->

<section id="mthSetCursor" xreflabel="setCursor"><title>setCursor</title>
<indexterm><primary>setCursor</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>setCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setCursor(--cursor--)------------------------><

]]>
</programlisting>

<para>
  Sets the cursor for the window of this mouse instance.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>cursor [required]</term>
      <listitem>
      <para>
        This argument can either be a <xref linkend="clsImage"/> cursor object, in which case the image is
        used for the new cursor, or a single keyword. When <emphasis role="italic">cursor</emphasis> is a keyword, the
        new cursor is set to one of the shared pre-defined system cursors.
      </para>
      <para>
        When using a keyword as the <emphasis role="italic">cursor</emphasis> argument, it must be exactly one of the
        following to indicate which system cursor is desired, case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>APPSTARTING</member>
          <member>ARROW      </member>
          <member>CROSS      </member>
          <member>HAND       </member>
          <member>HELP       </member>
          <member>IBEAM      </member>
          <member>NO         </member>
          <member>SIZEALL    </member>
          <member>SIZENESW   </member>
          <member>SIZENS     </member>
          <member>SIZENWSE   </member>
          <member>SIZEWE     </member>
          <member>UPARROW    </member>
          <member>WAIT       </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>APPSTARTING</term>
          <listitem>
          <para>
            Standard arrow and small hourglass.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ARROW</term>
          <listitem>
          <para>
            Standard arrow.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CROSS</term>
          <listitem>
          <para>
            Crosshair.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HAND</term>
          <listitem>
          <para>
            Hand.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HELP</term>
          <listitem>
          <para>
            Arrow and question mark.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>IBEAM</term>
          <listitem>
          <para>
            I-beam.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NO</term>
          <listitem>
          <para>
            Slashed circle.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZEALL</term>
          <listitem>
          <para>
            Four-pointed arrow pointing north, south, east, and west.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZENESW</term>
          <listitem>
          <para>
            Double-pointed arrow pointing northeast and southwest.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZENS</term>
          <listitem>
          <para>
            Double-pointed arrow pointing north and south.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZENWSE</term>
          <listitem>
          <para>
            Double-pointed arrow pointing northwest and southeast.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SIZEWE</term>
          <listitem>
          <para>
            Double-pointed arrow pointing west and east.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>UPARROW</term>
          <listitem>
          <para>
            Vertical arrow.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>WAIT</term>
          <listitem>
          <para>
            Hourglass.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the previous cursor for the window as an <computeroutput>Image</computeroutput> object. On error
    returns 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is similar to the example for the <xref linkend="mthRestoreCursor"/> method, but it
    only uses the <emphasis role="italic">setCursor</emphasis> method:
<programlisting>
<![CDATA[

  -- Get the current mouse position.
  mouse = .Mouse~new(self)
  oldCursorPos = mouse~getCursorPos

  -- Set the cursor to the busy symbol and jiggle the
  -- mouse so it repaints.
  oldCursorPos~incr
  oldCursor = mouse~setCursor("WAIT")
  mouse~setCursorPos(oldCursorPos)

  -- Calculate pi to 35 decimal places.
  pi = self~calcPi(35)

  -- Restore the cursor.
  oldCursorPos~decr
  mouse~setCursor(oldCursor)
  mouse~setCursorPos(oldCursorPos)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::setCursor() -->

<section id="mthSetCursorPos" xreflabel="setCursorPos"><title>setCursorPos</title>
<indexterm><primary>setCursorPos</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>setCursorPos</secondary></indexterm>
<programlisting>
<![CDATA[

Form 1:

>>--setCursorPos(--point--)----------------------><

Form 2:

>>--setCursorPos(--x--,--y--)--------------------><

Generic form:

>>--setCursorPos(--newPosition--)----------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">setCursorPos</emphasis> method moves the mouse cursor to the specified position. This
  method can be used to force the repainting of the mouse cursor or to keep the mouse cursor within a specific
  rectangle.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The argument(s) specify the (x, y) coordinates for the new position of the mouse cursor. These coordinates can be
    specifed either as a <xref linkend="clsPoint"/> object or as 2 separate whole number arguments, as in
    Form 2.
    <variablelist>
      <varlistentry><term>newPosition [required]</term>
      <listitem>
      <para>
        Whether the coordinates are specified as a <computeroutput>point</computeroutput> object or in the x, y format
        both coordinates are required. The coordinates are specified as
        screen <xref linkend="defScreenCoordinates"/>) coordinates.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success or 1 on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleSetCursorPos"><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example shows two methods: one indicating that processing has started and one indicating that
    processing has completed. The method <emphasis role="italic">indicateBeginProcessing</emphasis> changes the mouse
    cursor to the WAIT cursor and <emphasis role="italic">indicateEndProcessing</emphasis> restores the original mouse
    cursor. Both methods retrieve the current position of the mouse and move it by one screen pixel in each direction
    to force the repainting of the cursor.
  </para>
<programlisting>
<![CDATA[
::method indicateBeginProcessing
  expose oldCursor

  mouse = .Mouse~new(self)
  oldCursor = mouse~wait
  p = mouse~getCursorPos
  mouse~setCursorPos(p~incr)

::method indicateEndProcessing
  expose oldCursor

  mouse = .Mouse~new(self)
  mouse~restoreCursor(oldCursor)
  p = mouse~getCursorPos
  mouse~setCursorPos(p~decr)
]]>
</programlisting>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::setCursorPos() -->

<section id="mthShowCursor" xreflabel="showCursor"><title>showCursor</title>
<indexterm><primary>showCursor</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>showCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--showCursor(--+--------+--)-------------------><
                 +--show--+
]]>
</programlisting>

<para>
  Displays or hides the cursor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>show [optional]</term>
      <listitem>
      <para>
        Specifies whether the internal display counter, (see the Remarks section,) is to be incremented or decremented.
        If .true, the display count is incremented by one. If <computeroutput>.false</computeroutput>, the display
        count is decremented by one. The default is <computeroutput>.true</computeroutput>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The new display count.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The operating system maintains an internal display counter that determines whether the cursor should be displayed.
    The cursor is displayed only if the display count is greater than or equal to 0. If a mouse is installed, the
    initial display count is set to 0. If no mouse is installed, the display count is -1.
  </para>
  <para>
    In early versions of Windows the internal counter was system wide, but now it is thread specific.  What this means
    in terms of ooDialog is that the cursor state, shown or hidden, will apply only to the dialog and all its child
    windows. For a dialog, the child windows are the dialog control windows, and any
 <xref linkend="clsControlDialog"/> windows, if present.
  </para>
  <para>
    Note that this method does not hide or show the cursor, it changes the internal counter. This implies that if the
    programmer invokes this method 10 times with <emphasis role="italic">show</emphasis> equal to
    <computeroutput>.false</computeroutput>, it will take at least 10 invocations of the method with <emphasis
    role="italic">show</emphasis> equal to <computeroutput>.true</computeroutput> to get the cursor to show.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> to 0. However, there are no system
    errors that would change the variable from 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is a code snippet from a program that hides the cursor while it is over one of the dialog windows in
    the program and shows it when not over that dialog window
<programlisting>
<![CDATA[

::method hideCursor private
  use strict arg obj

  mouse = .Mouse~new(obj)
  do while mouse~showCursor(.false) >= 0
    nop
  end

::method showCursor private
  use strict arg obj

  mouse = .Mouse~new(obj)
  do while mouse~showCursor(.true) < 0
    nop
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::showCursor() -->

<section id="mthTrackEvent" xreflabel="trackEvent"><title>trackEvent</title>
<indexterm><primary>trackEvent</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>trackEvent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--trackEvent(--+--------+--+-------------+--+----------+--)------------------><
                  +-event-+  +-,-hoverTime-+  +-,-answer-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">trackEvent</emphasis> method initiates mouse tracking behavior. It can also be used to
  query the current tracking behavior. When mouse tracking is in effect mouse hover and mouse leave
  <xref linkend="ovvEvents"/> notifications, depending on the type of tracking specified, will be generated.
  Normally these event notifications are <emphasis role="italic">not</emphasis> generated.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>event [optional]</term>
      <listitem>
      <para>
        A list of 1 or more of the following keywords separated by spaces, case is not significant. The keywords define
        the tracking behavior to initiate. If this argument is omitted, the default list is <emphasis
        role="italic">LEAVE</emphasis>:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>CANCEL   </member>
          <member>HOVER    </member>
          <member>LEAVE    </member>
          <member>NONCLIENT</member>
          <member>QUERY    </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>CANCEL</term>
          <listitem>
          <para>
            Cancel a prior tracking request. The type of tracking to be canceled should also be specified. For example,
            to cancel hover tracking, the keyword list should be <emphasis role="italic">Cancel Hover</emphasis>. (Case
            is not significant of course.)
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HOVER</term>
          <listitem>
          <para>
            Hover notifications should be generated. The notification generated is the MOUSEHOVER notification, connect
            this event using the <xref linkend="mthConnectEvent"/>method.
          </para>
          <para>
            If hover tracking is requested while hover tracking is already active, the hover timer will be reset. The
            operating system completely ignores this request if the mouse pointer is not over the window of this mouse
            instance.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>LEAVE</term>
          <listitem>
          <para>
            Leave notifications should be generated. The notification generated is the MOUSELEAVE notification, connect
            this event using the <xref linkend="mthConnectEvent"/>method. If the mouse is not over
            the window of this mouse instance, a leave notification is generated immediately and no further tracking is
            performed.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NONCLIENT</term>
          <listitem>
          <para>
            Non-<xref linkend="defClientArea"/> hover and leave notifications should be generated. The
            notifications generated are the NCMOUSELEAVE and NCMOUSEHOVER notifications, connect these events using the
 <xref linkend="mthConnectEvent"/>method.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>QUERY</term>
          <listitem>
          <para>
            Rather than treating this as a tracking request, the <emphasis role="italic">answer</emphasis> argument,
            which must be a <computeroutput>.Directory</computeroutput> object, is filled in. The
            <computeroutput>Directory</computeroutput> object will contain an EVENT and a HOVERTIME index. These indexes
            will contain values such that, had they been used for the <emphasis role="italic">event</emphasis> and
            <emphasis role="italic">hoverTime</emphasis> arguments to the <emphasis role="italic">trackEvent</emphasis>
            method, the method would generate the current tracking.
          </para>
          <para>
            The only anomaly is that the hover time out returned is always the actual time out and not
            <link linkend="sctMouseConstantMethods">HOVER_DEFAULT</link>, if HOVER_DEFAULT was specified as <emphasis
            role="italic">hoverTime</emphasis> during the original <emphasis role="italic">trackEvent</emphasis>
            request.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>hoverTime [optional]</term>
      <listitem>
      <para>
        Specifies the hover time out, (if HOVER was specified in <emphasis role="italic">event</emphasis>,) in
        milliseconds. The constant, <link linkend="sctMouseConstantMethods">HOVER_DEFAULT</link> can also be use to specify
        the system default hover time out. The value of the system default hover time out can be determined, or changed,
        through the <xref linkend="atrMouseHoverTime"/> attribute of the <xref linkend="clsSPI"/> (System Parameters
        Infomation) class.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>answer [optional] [in / out]</term>
      <listitem>
      <para>
        A <computeroutput>Directory</computeroutput> object in which the results of a QUERY request are returned. This
        is required if the <emphasis role="italic">event</emphasis> argument contains the QUERY keyword, otherwise this
        argument is ignored. On a successful return the <computeroutput>Directory</computeroutput> object will contain
        the following indexes:
      </para>
      <variablelist>
        <varlistentry><term>EVENT</term>
        <listitem>
        <para>
          A keyword list, using the same keywords that are listed for the <emphasis role="italic">event</emphasis>
          argument. The keywords will reflect the current tracking. If the list had been used in a tracking request,
          they would produce the current tracking.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HOVERTIME</term>
        <listitem>
        <para>
          The hover time out in effect for the current tracking. However, if HOVER_DEFAULT had been used for the
          <emphasis role="italic">hoverTime</emphasis> argument in the tracking request, this value will be the actual
          time out value, not the value of HOVER_DEFAULT.
        </para>
        </listitem></varlistentry>
      </variablelist>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The mouse pointer is considered to be <emphasis role="italic">hovering</emphasis> when it stays within a specific
    rectangle for a specific period of time. The <xref linkend="clsSPI"/> class has attributes that can be used
    to retrieve (or change) the hover rectangle or hover time out value. The <xref linkend="atrMouseHoverWidth"/> and <xref
    linkend="atrMouseHoverHeight"/> attributes reflect the hover rectangle. The <xref linkend="atrMouseHoverTime"/> attribute
    reflects the hover time out.
  </para>
  <para>
    The system default hover time out is initially the menu drop-down time, which is 400 milliseconds. The system
    default hover rectangle is the same as the double-click rectangle. However, these values may be changed / customized
    by the user.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects the mouse move, leave, and hover events. The first time a mouse move is received, the
    <emphasis role="italic">trackEvent</emphasis> method is used to request tracking for the leave and hover events.
    When either one of the events is received, the tracking for that event is canceled. In order to receive further
    events, a flag is set so that on the next mouse move event, the <emphasis role="italic">trackEvent</emphasis> method
    is invoked again.
<programlisting>
<![CDATA[

::method init

  ...

  mouse = .Mouse~new(self)
  mouse~connectEvent('MOUSEMOVE')
  mouse~connectEvent('MOUSELEAVE')
  mouse~connectEvent('MOUSEHOVER')

  -- so leave and hover tracking is requested on first mouse move
  mouseEntered  = .false
  mouseHovering = .true

::method onMouseMove unguarded
  expose mouseEntered mouseHovering
  use arg keyState, p, mouse

  if \ mouseEntered then do
    if \ mouse~trackEvent("LEAVE") then do
      say "trackEvent() failed. Error" .systemErrorCode ':' SysGetErrorText(.systemErrorCode)
    end
    mouseEntered = .true
  end

  if mouseHovering then do
    if \ mouse~trackEvent("HOVER") then do
      say "trackEvent() failed. Error" .systemErrorCode ':' SysGetErrorText(.systemErrorCode)
    end
    mouseHovering = .false
  end
  ...
  return .true

::method onMouseLeave unguarded
  expose mouseEntered
  use arg mouse

  mouseEntered = .false

  -- so hover tracking is started when mouse re-enters.
  mouseHovering = .true
  ...
  return .true

::method onMouseHover unguarded
  expose mouseHovering
  use arg keyState, mousePos, mouse

  mouseHovering = .true
  ...
  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::trackEvent() -->

<section id="mthWait" xreflabel="wait"><title>wait</title>
<indexterm><primary>wait</primary></indexterm>
<indexterm><primary>Mouse class</primary><secondary>wait</secondary></indexterm>
<programlisting>
<![CDATA[
>>--wait-----------------------------------------><

]]>
</programlisting>

<para>
  Sets the mouse cursor to the system's default <emphasis role="italic">busy</emphasis> cursor, which is usually the
  hourglass cursor.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous cursor on success, or 0 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">wait</emphasis> method is convenience method. It is exactly equivalent to using the
 <xref linkend="mthSetCursor"/> method with the WAIT keyword.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This a simple method to use:
<programlisting>
<![CDATA[

  mouse = .Mouse~new(self)
  oldCursor = mouse~wait

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Mouse::no() -->

</section> <!-- End Mouse Class -->

