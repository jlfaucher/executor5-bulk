<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2005-2022 Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter id="chpMenus" xreflabel="Menu"><title>Menus</title>
<indexterm><primary>Menus</primary></indexterm>

<para>
  Menus are lists of items that specify options for an application.  Groups of related options are usually placed in
  submenus. Clicking a menu item either opens a submenu or causes the application to carry out a command.
</para>
<para>
  Menus are arranged as a hierarchy. A <emphasis role="italic">menu bar</emphasis> is the top of the hiearchy for menus
  attached to an application window.  The menu bar will contain a list of <emphasis role="italic">menus</emphasis>, and
  menus can contain <emphasis role="italic">submenus</emphasis>.  Menu bars are often called <emphasis
  role="italic">top-level</emphasis> menus, while the menus and submenus are also known as
  <emphasis role="italic">pop-up</emphasis> menus.
</para>
<para>
  A menu <emphasis role="italic">item</emphasis> either carries out a command, opens a submenu, or is special type of
  menu item called a <emphasis role="italic">separator</emphasis>.  Menu items that do not open a submenu are called
  <emphasis role="italic">command</emphasis> items or simply commands. Menu items that open a submenu are sometimes
  called <emphasis role="italic">menu names</emphasis>. Separators appear as a horizontal line. They are used to divide
  a menu into groups of related items. A separator cannot be used in a menu bar, and the user cannot select a separator.
</para>
<para>
  Only top-level windows can have menu bars. Child windows can not have a menu bar. If the window has a title bar the
  system positions a menu bar underneath it. All menus must have an owner window.
</para>
<para>
   The system also provides <emphasis role="italic">shortcut menus</emphasis> and the <emphasis
   role="italic">window</emphasis> menu.  A shortcut menu is not attached to a menu bar and can appear anywhere on the
   screen.  Shortcut menus are typically activated by the user right-clicking on a specific portion of the screen and
   the menu items are usually only relevant to what the user clicked on.  For this reason, shortcut menus are often
   called <emphasis role="italic">context</emphasis> menus.  The window menu is also knows as the <emphasis
   role="italic">System</emphasis> menu or the <emphasis role="italic">Control</emphasis> menu.  The  System menu is
   usually managed exclusively by the system.  The user activates the System menu by clicking on the icon in the upper
   left corner of a window, or by right-clicking anywhere on the title bar. Unlike menu bars, child windows can have a
   System menu.  It is unusual for a top-level window to not have a System menu.
</para>
<para>
  The menu related classes in the following table are described in this chapter.  The primary classes that the ooDialog
  programmer will use are the <computeroutput>BinaryMenuBar, UserMenuBar, ScriptMenuBar</computeroutput>, and
  <computeroutput>PopupMenu</computeroutput>. The other classes are mixin classes that implement the functionality
  common to all types of menus. The binary, user, and script menu bar classes all have the same essential functionality.
  They just differ in how they are initially created.  The popup menu class is similar to the menu bar classes, it just
  does not have any methods that are only relevant to a menu bar.
<table id="tblMenuClasses" frame="all">
<title>ooDialog Menu Classes</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="2*" />
<thead>
<row>
<entry>Class</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="clsBinaryMenuBar"/></entry>
<entry>A menu bar created from a menu resource, or created as an empty menu bar.</entry>
</row>
<row>
<entry>Menu (Mixin Class) The Menu <xref linkend="clsMenu"/></entry>
<entry>The basis for the menu object.</entry>
</row>
<row>
<entry>MenuBar (Mixin Class) The Menu Bar <xref linkend="clsMenuBar"/></entry>
<entry>The basis for the menu bar object.</entry>
</row>
<row>
<entry><xref linkend="clsPopupMenu"/></entry>
<entry>A menu or a shortcut menu, also known as a submenu or a context menu.</entry>
</row>
<row>
<entry><xref linkend="clsScriptMenuBar"/></entry>
<entry>A menu bar created from a resource script file.</entry>
</row>
<row>
<entry><xref linkend="clsSystemMenu"/></entry>
<entry>A system menu, also known as the window menu or the control menu.</entry>
</row>
<row>
<entry><xref linkend="clsUserMenuBar"/></entry>
<entry>
  A menu bar created dynamically by the programmer in a fashion similar to a <xref linkend="clsUserDialog"/>.
</entry>
</row>
</tbody></tgroup>
</table>
</para>

<section id="sctMenuItemIDs" xreflabel="ID"><title>Menu Item IDs</title>
<para>
  Each menu item in a menu can be uniquely identified. This documentation generically refers to a menu item <emphasis
  role="italic">ID</emphasis>, but there are really two ways of identifying a menu item.
</para>

<variablelist>
  <varlistentry id="entMenuItemIdentifier" xreflabel="ID(s)">
  <term><emphasis role="bold">Menu Item Identifier</emphasis></term>
  <listitem>
  <para>
    Each menu item has a unique, positive, integer assigned to it by the programmer, called a menu item identifier.
    These numbers are essentially the same as any other <xref linkend="defResourceId"/> used in
    ooDialog. The Rexx programmer can use numeric or <xref linkend="itmMenuSymbolicIDs"/> IDs for menu
    item identifier's, in the same way as for other resource IDs.
  </para>
  <para>
    All menus assign menu item identifiers to command items and submenus. ooDialog uses what the Windows operating
    system calls <emphasis role="italic">extended</emphasis> menus. Extended menus also assign identifiers to
    separators. Identifiers are used for <xref linkend="sctMenuCommandEvents"/>s. In addition, a
    menu item can be specified using its identifier in method invocations. For example, to
 <xref linkend="mthEnableClsMenu"/> or <xref linkend="mthDisableClsMenu"/> a menu item.
  </para>
  <para>
    Identifiers allow the programmer to specify any menu item anywhere in the menu hiearchy. The
 <xref linkend="mthGetIDClsMenu"/>() method can be used to retrieve the identifier of the menu item at a
    specified position
  </para>
  </listitem></varlistentry>
  <varlistentry id="entMenuItemPosition" xreflabel="menu item position">
  <term><emphasis role="bold">Menu Item Position</emphasis></term>
  <listitem>
  <para>
    In addition to having a unique identifier, each menu item in a menu bar or menu has a unique position value.
    Although the operating system uses zero-based position numbering, ooDialog uses one-based position numbering to
    conform to general Rexx practice. The leftmost item in a menu bar, or the top item in a menu, has position one. The
    position value is incremented for subsequent menu items. A position value is assigned to all items in a menu,
    including separators.
  </para>
  <para>
    Position values can be used in method invocations that require specifying a menu item. Note that since the top item
    in a menu, or the leftmost menu item in a menu bar, always has a position of one, it is not possible to uniquely
    specify any menu item in a menu hiearchy. Rather, you can only use a position to specify an item in a specific
    submenu.
  </para>
  </listitem></varlistentry>
  <varlistentry id="itmMenuSymbolicIDs" xreflabel="symbolic">
  <term><emphasis role="bold">Symbolic Menu Item IDs</emphasis></term>
  <listitem>
  <para>
    Menu <emphasis role="italic">item identifiers</emphasis> are essentially resource <link
    linkend="defResourceId">IDs</link>. The programmer can use <xref linkend="defSymbolicId"/> IDs for menu item identifiers
    rather than numeric IDs for any argument in a menu object method that uses a menu item identifier. However, to do so, the
    programmer <emphasis role="italic">must</emphasis> use the global <xref linkend="dotConstDir"/>. If the global
    <computeroutput>.constDir</computeroutput> is not used, then all menu item identifier arguments <emphasis
    role="bold">must</emphasis> be numeric.
  </para>
 </listitem></varlistentry>
</variablelist>
<para>
  Except in a few methods where it simply does not make any sense, all menu methods that require specifying a menu item,
  accept either a menu item identifier or a menu item position. The menu item specifier is referred to generically as the
  <emphasis role="italic">menu item ID</emphasis>. In ooDialog, all <emphasis role="italic">menu item IDs</emphasis> must be
  greater than 0. Since both identifiers and positions are numbers, the programmer needs to specify which is being used.
  However, by default, the ID is assumed to be an identifier. Therefore, the programmer only need indicate when the ID is a
  position ID.
</para>
</section>


<section id="sctMenuCommandItems"><title>Menu Command Items</title>
<indexterm><primary>menu object</primary><secondary>command items</secondary></indexterm>
<para>
  Menu items that are not separators and do not open a submenu are called menu command items.
</para>

<section id="sctMenuCommandEvents" xreflabel="menu command event"><title>Menu Command Events</title>
<indexterm><primary>menu object</primary><secondary>command events</secondary></indexterm>
<para>
  When a user selects a menu command item, an <xref linkend="ovvEvents"/> is generated and the operating
  system sends a notification to the owner window of the menu. The ooDialog framework provides methods to connect this
  menu command notification to a method in the Rexx dialog object in a similar manner to connecting dialog control
  <link linkend="sctConnectingEvents">notifications</link>. The event connection methods are contained within the various
  menu objects and are similar to the event connection methods of the dialog object.
</para>
<para>
  However, there are some specific details when dealing with menus that should be understood. The menu command event is
  connected using the menu item <xref linkend="sctMenuItemIDs"/> of the command item, just as dialog
  control events are connected using the resource ID of the dialog control. Event notifications are always connected to
  a specific Rexx dialog object, the dialog object that represents the <xref linkend="ovvUnderlying"/>
  dialog that the notification is expected to be sent to.
</para>
<para>
  A Rexx dialog control object has one, and only one, underlying dialog. But, a Rexx
  menu <xref linkend="clsMenuBar"/> object can be attached to one dialog, then detached and attached to a
  different dialog. Likewise, the same
 <xref linkend="clsPopupMenu"/> menu could be used by any number of different dialogs. Because of this, it
  may be necessary to connect a menu command item notification to more than one dialog.
</para>
<para>
  For example, the same context menu object could be used by the programmer in several different dialogs. In this case,
  it is not sufficient to connect each of the menu items once, to one dialog. Rather, the menu items need to be
  connected to each dialog where the context menu is used. When the programmer
 <xref linkend="mthShowClsPopupMenu"/> the context menu, it will have one and only one owner dialog. When
  the user selects a menu item, the notification is sent to that owner dialog.
</para>
<para>
  Another example would be a program that shows different dialogs at various times. The dialogs are different, but all
  have a menu bar that contains the same items. One approach would be to create a single menu bar, that is attached to
  each dialog when it is shown. The menu items of the menu bar would then need to be connected to each dialog that the
  menu bar is attached to during the program.
</para>
<para>
  One last point the programmer should be aware of. Both a regular menu item selection and a
 <xref linkend="clsButton"/> click generate the same event notification. <emphasis
  role="bold">Note</emphasis> that a <emphasis role="italic">system</emphasis> menu command event uses a different type
  of notification than buttons or regular menus. A system menu command event notification will never be the same as a
  button click notification.
</para>
<para>
  Sometimes the action to take when a button is clicked and the action to take when a menu item is selected are the
  same. In these cases, it is a common practice in Windows programming to use the same resource ID for both the button
  and the menu item and then use the same event handler for both the button push and the menu item selection. To use
  this method in ooDialog, the programmer would need to only connect the event once.
</para>
<para>
  E.g., take the case of an OK push button and an Exit menu item. Many times the action to take for both is exactly the
  same. Here the ooDialog programmer would use the same resource ID for both the button and the menu item. OK buttons
  normally use the resource ID of <computeroutput>IDOK</computeroutput>, which the ooDialog framework
  <link linkend="sctStandardEventMethods">automatically</link> connects to the <xref linkend="mthOk"/> method. If the
  programmer also uses the IDOK id for the Exit menu item, then nothing else need be done. Whether the user selects the Exit
  menu item, or clicks the OK button, the same method in the Rexx dialog object will be invoked.
</para>
<para>
  Notice that, since a button click and a menu item selection generate the same notification, it is not possible to
  connect a menu item and a button click to separate methods if they both have the same resource ID.
</para>

</section>  <!-- End Section::Menu Command Events -->

<section id="sctMenuCommandEventConnections" xreflabel="connection"><title>Menu Command Event Connections</title>
<indexterm><primary>menu object</primary><secondary>command event connections</secondary></indexterm>
<para>
  Menus are separate objects from dialog objects and can be instantiated with no reference to any dialog. In addition,
  menus can be assigned different owner dialogs during an application's life time. Because of this, unlike connecting
  dialog control envents, there are several different strategies that can be used when connecting menu command events.
</para>
<para>
  The menu classes provide a number of ways, and a number of methods, to connect menu command events to methods in the
  Rexx dialog. There are three basic types of ways to make command event connections, <emphasis role="italic">auto
  connection</emphasis>, <emphasis role="italic">connect request</emphasis>, and <emphasis role="italic">direct
  connection</emphasis>.
</para>

<variablelist>
  <varlistentry id="varAutoConnection" xreflabel="autoconnection">
  <term><emphasis role="bold">Auto Connection</emphasis></term>
  <listitem>
  <para>
    When auto connection is on, <emphasis role="italic">each</emphasis> time a menu bar is attached to a dialog, or a
    context menu is assigned to an owner dialog, every menu command item is automatically connected to a method in that
    dialog. The programmer can specify if every command item is connected to the same method, or if every command item
    is connected to a unique method. When every command item is connected to an unique method, ooDialog automatically
    generates the method name based on the text of the command item.
  </para>
  <para>
    Note that if auto connection is on, the automatic connection of menu items is <emphasis
    role="italic">always</emphasis> done when a menu bar is attached to a dialog or a context menu is assigned its
    owner dialog. This is true even if the <emphasis role="italic">connection request</emphasis> way of connecting
    command items is also in use.
  </para>
  <para>
    Auto connection can be explicitly turned on by using the
 <xref linkend="mthSetAutoConnection"/> <emphasis role="italic">before</emphasis> a menu bar
    is attached, or a context menu is assigned, to a dialog. <emphasis role="italic">setAutoConnection</emphasis> can
    also be used to turn auto connection off at any time.
  </para>
  <para>
    The following is some specific details regarding auto connection for the different menu classes and menu class
    methods:
    <variablelist>
      <varlistentry><term><emphasis role="bold">BinaryMenuBar class</emphasis></term>
      <listitem>
      <para>
        Auto connection can also be turned on explicity in the <xref linkend="mthNewClsBinaryMenuBar"/> method
        of the <computeroutput>BinaryMenuBar</computeroutput>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">insertItem method</emphasis></term>
      <listitem>
      <para>
        If auto connection is turned on in the menu bar that the item is inserted into, and the menu bar is already
        attached to a dialog, then the item will be automatically connected. The method name that is used for the
        connected method is based on the current auto connection status. <xref linkend="mthGetAutoConnectStatus"/> can be
        used to determine the current auto connection status.
      </para>
      <para>
        This will <emphasis role="italic">only</emphasis> be done if the item is being inserted by item identifier, not
        if it is being inserted by item position. It is only done if the item is being inserted into a menu bar, not if
        it is being inserted into a popup menu.
      </para>
      <para>
        <emphasis role="bold">Note</emphasis> that the arguments to the <xref linkend="mthInsertItem"/>
        method, the <emphasis role="italic">connect</emphasis> argument, can also be used to specify a <emphasis
        role="italic">connection request</emphasis> type of connection. If a connection request is made using the
        <emphasis role="italic">connect</emphasis> argument and auto connection is turned on, both connections will be
        made. This should <emphasis role="italic">not</emphasis> be done, the result is non-deterministic.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">PopupMenu class</emphasis></term>
      <listitem>
      <para>
        When a popup menu is used as a submenu of a menu bar, auto connection is meaningless. A submenu can not be
        attached or assigned to a dialog. When a popup menu is used as a context menu, auto connection can be turned on,
        either explicitly by using the <xref linkend="mthSetAutoConnection"/> method, or by using
        the <emphasis role="italic">autoConnect</emphasis> option in the <xref linkend="mthAssignTo"/>
        method.
      </para>
      <para>
        Note that <emphasis role="italic">setAutoConnection</emphasis> has to be invoked on the top-level menu of the
        context menu. Invoking it on a submenu of the context menu would have no effect. When the
 <xref linkend="mthTrack"/> or <xref linkend="mthShowClsPopupMenu"/> methods are used with a
        popup menu, auto connection is ignored.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ScriptMenuBar class</emphasis></term>
      <listitem>
      <para>
        Auto connection can  be turned on explicitly using the
 <xref linkend="mthSetAutoConnection"/> method <emphasis role="italic">after</emphasis>
        the <computeroutput>ScriptMenuBar</computeroutput> is instantiated, but <emphasis
        role="italic">before</emphasis> it is attached to a dialog.
      </para> </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">UserMenuBar class</emphasis></term>
      <listitem>
      <para>
        Auto connection can be turned on in the <xref linkend="mthNewClsUserMenuBar"/> method of the
        <computeroutput>UserMenuBar</computeroutput>.
      </para>
      <para>
        Auto connection can  be turned on explicitly using the
 <xref linkend="mthSetAutoConnection"/> method <emphasis role="italic">after</emphasis>
        the <computeroutput>UserMenuBar</computeroutput> is instantiated, but <emphasis role="italic">before</emphasis>
        it is attached to a dialog.
      </para> </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry id="varConnectionRequest" xreflabel="connection request">
  <term><emphasis role="bold">Connection Request</emphasis></term>
  <listitem>
  <para>
    A <emphasis role="italic">connection request</emphasis> is made when a menu command item is to be connected to a
    specific method name in a dialog, before the menu bar has been attached to a dialog. Obviously it is impossible to
    connect the item to a dialog method, before it is known what dialog the menu bar is going to be connected to. All
    connection requests are fulfilled the <emphasis role="italic">first</emphasis> time the menu bar is connected to a
    dialog. The requests are then discarded.
  </para>
  <para>
    Connection requests are made by specifying a method to invoke when adding a command item to a
    <computeroutput>UserMenuBar</computeroutput> through the <xref linkend="mthAddItem"/> method, or by
    specifying <computeroutput>.true</computeroutput> for the <emphasis role="italic">connect</emphasis> argument in the
 <xref linkend="mthNewClsScriptMenuBar"/> method of the <computeroutput>ScriptMenuBar</computeroutput>. The
    request can also, possibly, be made by specifying a method to invoke when inserting a command item through the
 <xref linkend="mthInsertItem"/> method.
  </para>
  <para>
    The following is some specific details regarding connection requests for the different menu classes and menu class
    methods:
    <variablelist>
      <varlistentry><term><emphasis role="bold">BinaryMenuBar class</emphasis></term>
      <listitem>
      <para>
        Connection requests are not used in <computeroutput>BinaryMenuBar</computeroutput> class, except possibly though
        the <emphasis role="italic">insertItem</emphasis> method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">insertItem method</emphasis></term>
      <listitem>
      <para>
        A connection request can be made through the <xref linkend="mthInsertItem"/> method under these
        specific conditions.  The <emphasis role="italic">insertItem</emphasis> method is invoked on a menu bar, not
        using by position, and the menu bar is not currently attached to a dialog.  Then a connection request is made by
        using the last arguments to the method, the <emphasis role="italic">connect</emphasis> and possibly the
        <emphasis role="italic">mName</emphasis> methods. If the menu bar is already attached to a dialog, then those
        last two arguments connect the item immediately, which in this discussion is considered the <emphasis
        role="italic">direct connect</emphasis> type of making event connections.
      </para>
      <para>
        <emphasis role="bold">Note</emphasis> that if auto connection is turned and a connection request is made using
        the <emphasis role="italic">insertItem</emphasis> method, then both connections will be made. This should
        <emphasis role="italic">not</emphasis> be done, the result is non-deterministic.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">PopupMenu class</emphasis></term>
      <listitem>
      <para>
        Connection requests have no meaning in a popup menu, there is no such thing.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ScriptMenuBar class</emphasis></term>
      <listitem>
      <para>
        Connection requests are made by using the <emphasis role="italic">connnect</emphasis> argument in the
 <xref linkend="mthNewClsScriptMenuBar"/> method of the class. If <emphasis role="italic">connect</emphasis>
        is true, then a connection request is made for each command item found in the resource script, using a method
        name constructed from the text of the command item.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">UserMenuBar class</emphasis></term>
      <listitem>
      <para>
        In a <computeroutput>UserMenuBar</computeroutput>, a connection request can be made in the
 <xref linkend="mthAddItem"/> method by specifying a method name as the last argument, the <emphasis
        role="italic">mName</emphasis> argument.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    As can be seen from the discussion above. the connection request type of making connections is primarily meant to
    allow the programmer to automatically connect the menu items in a resource script when the script is parsed
    (<computeroutput>ScriptMenuBar</computeroutput>), or when the <emphasis role="italic">addItem</emphasis> method is
    used (<computeroutput>UserMenuBar</computeroutput>.)
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Direct Connection</emphasis></term>
  <listitem>
  <para>
    The direct connection type of connecting command item events is an explicit, connect <emphasis
    role="italic">this</emphasis> command item to a method in <emphasis role="italic">this</emphasis> dialog. This is
    relatively simple to understand. Directly connecting menu command events is done through the following methods:
    <itemizedlist>
    <listitem>
    <para>
      <xref linkend="mthConnectCommandEventCls"/> (Class method)
    </para>
    </listitem>
    <listitem>
    <para>
      <xref linkend="mthConnectAllCommandEvents"/>
    </para>
    </listitem>
    <listitem>
    <para>
      <xref linkend="mthConnectCommandEvent"/> (Instance method)
    </para>
    </listitem>
    <listitem>
    <para>
      <xref linkend="mthConnectSomeCommandEvents"/>
    </para>
    </listitem>
    </itemizedlist>
  </para>
  </listitem></varlistentry>
</variablelist>
<para>
  In general, only one type of making command event connections should be used in any one menu. Auto connection should
  never be used with the other two types of making connections. Mixing the 3 types of connecting command items to
  methods can result in unpredictable results.
  <itemizedlist>
  <listitem>
  <para>
    The same command item can end up connected to different methods, which method is invoked is non-deterministic.
  </para>
  </listitem>
  <listitem>
  <para>
    Numerous entries in the dialog's message table for the same command item connected to the same method can happen.
  </para>
  </listitem>
  <listitem>
  <para>
    Both of the above can result in the message table becoming far larger than necessary.
  </para>
  </listitem>
  </itemizedlist>
</para>
<para>
  At first glance, making menu command event connections may seem a little complex. However, <emphasis role="bold">in
  practice</emphasis>, in ooDialog programs, it is relatively straight forward. The complexity only arises when multiple
  menus are used with multiple dialogs in a single application and the programmer <emphasis
  role="italic">chooses</emphasis> to mix the different types of making connections. <emphasis
  role="italic">Most</emphasis> ooDialog programs contain a single dialog with a single menu bar and / or a single
  context menu. If the programmer picks one type of making the menu item connection for her menu(s), things are really
  pretty simple:

<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar = .BinaryMenuBar~new("menuResourceEx.dll", IDR_MENU1, , self, .true, onMenuSelect)

]]>
</programlisting>

  The above creates a menu bar from a binary resource, attaches it to the dialog, and automatically connects all the
  menu items in the menu to the <emphasis role="italic">onMenuSelect</emphasis> method, in one step. Which is pretty
  simple.
</para>

</section>  <!-- End Section::Menu Command Event Connections -->

<section id="sctMenuCommandEventHandlers" xreflabel="handler"><title>Menu Command Event Handlers</title>
<indexterm><primary>menu command event handlers</primary></indexterm>
<para>
  There are only two types of event handlers that the ooDialog programmer will need to code. Although similar, there are
  a few differences between the two. One <link linkend="sctSystemMenuCommandEventHandler">handler</link> is exclusively for
  menu command event notifications generated by the system menu. The other handler, described first, is for all other menu
  command event notifications.
</para>

<section id="sctMenuObjectCommandEventHandler"><title>Menu Object Command Event Handler</title>
<indexterm><primary>menu object</primary><secondary>command event handler</secondary></indexterm>
<para>
  Non-system menu command <xref linkend="ovvEvents"/> notifications are actually the same notifications as
  the <xref linkend="mthConnectButtonEvent"/> CLICK event. This makes the event handler for a menu command
  event pretty simple. The event handler is invoked when the user selects a menu command item. The programmer should
  return 0 from the event handler, however the interpreter does not <link linkend="sctCodingEventHandlers">wait</link> for
  the return.
</para>

<programlisting>
<![CDATA[
::method onMenuSelect unguarded
  use arg id, hMenu

  return 0
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The menu command event handling method receives 2 arguments:
  </para>
  <variablelist>
    <varlistentry><term>id</term>
    <listitem>
    <para>
      The numeric menu item identifier of the command item the user selected.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hMenu</term>
    <listitem>
    <para>
      The Windows <xref linkend="defHandle"/> to the menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    Return 0, although, since the interpreter does not wait for the reply, the value returned is ignored. However, it is
    good practice to always return a value from an event handler and 0 is the proper value for this notification.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Since the event handler for the menu command event is sent the ID of the menu item selected, there are two equally
    valid ways of coding the event handler. One way would be to connect all menu command items to one method. In that
    method check the menu item ID to determine which item the user selected and take the appropriate action. The other
    way would be to connect each menu item to its own method and ignore the arguments, simply take the action for that
    menu item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example connects the <emphasis role="italic">File Open</emphasis> menu item with a method and then
    opens a file when the user selects that menu item:

<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar~attachTo(self)
  ...
  menuBar~connectCommandEvent(IDM_OPEN, onFileOpen)
  ...

::method onFileOpen unguarded
  use arg id, hMenu

  self~openFile
  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End Section::Menu Object Command Event Handler -->

<section id="sctSystemMenuCommandEventHandler"><title>SystemMenu Command Event Handler</title>
<indexterm><primary>SystemMenu class</primary><secondary>command event handler</secondary></indexterm>
<para>
  System menu command <xref linkend="ovvEvents"/> notifications are generated when the user clicks on a menu
  command item in the system menu. The interpreter <link linkend="sctCodingEventHandlers">waits</link>) for the return
  from the Rexx method and the method must return either <computeroutput>.true</computeroutput> or
  <computeroutput>.false</computeroutput>.
</para>

<programlisting>
<![CDATA[
::method onMenuSelect unguarded
  use arg id, arg2

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The menu command event handling method receives 3 arguments:
  </para>
  <variablelist>
    <varlistentry><term>id</term>
    <listitem>
    <para>
      The identifier of the system menu command item the user selected. If this is one of the standard system menu
      command items, id will be a keyword identifying the item. The keywords correspond to the system menu command item
      <link linkend="sctSystemMenuConstantMethods">constants</link>, with the <emphasis role="italic">SC_</emphasis>
      removed. For example, if the menu item selected was the SC_CLOSE item, the keyword will be <emphasis
      role="italic">CLOSE</emphasis>. For non-standard system menu command items inserted into the menu by the
      application, <emphasis role="italic">id</emphasis> will be the numeric value of the item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>x</term>
    <listitem>
    <para>
      If the menu command item was selected using the mouse, <emphasis role="italic">x</emphasis> will be the horizontal
      position of the mouse cursor. When the user selects the item in some other manner, <emphasis
      role="italic">x</emphasis> will be 0.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>y</term>
    <listitem>
    <para>
      If the menu command item was selected using the mouse, <emphasis role="italic">y</emphasis> will be the vertical
      position of the mouse cursor. <emphasis role="italic">y</emphasis> will be -1 if the item was chosen using a
      system accelerator, or zero if chosen using a mnemonic.

    </para> </listitem></varlistentry>
  </variablelist> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    Return <computeroutput>.true</computeroutput> to indicate the system command was handled by the ooDialog program.
    Return <computeroutput>.false</computeroutput> to pass the command on to the operating system so that the default
    processing of the command item is done. For the standard system menu items, most Windows programs have the system
    process the selection. If the menu item selected was on inserted by the ooDialog application, then the event handler
    <emphasis role="italic">should</emphasis> return <computeroutput>.true</computeroutput>. Note that the Microsoft
    documentation says <emphasis role="italic">must</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example instantiates a <xref linkend="clsSystemMenu"/> object and uses it to insert
    an <emphasis role="italic">Edit</emphasis> menu into the system menu for the application. The new menu items are
    connected to appropriate event handlers. Note that the event handlers shown in the example are just stubs. Real code
    to handle the event would need to be added:

<programlisting>
<![CDATA[

::method initDialog
  expose sysMenu

  -- Get the system menu.
  sysMenu = .SystemMenu~new(self)

  -- Modify the system menu by inserting an "Edit" menu into it
  popup = .PopupMenu~new(IDM_EDIT_MENU)
  popup~insertItem(IDM_PASTE, IDM_PASTE, "Paste")
  popup~insertItem(IDM_PASTE, IDM_COPY, "Copy")
  popup~insertItem(IDM_PASTE, IDM_CUT, "Cut")

  sysMenu~insertPopup(SC_MOVE, IDM_EDIT_MENU, popup, "Edit")
  sysMenu~insertSeparator(SC_MOVE, IDM_SYS_SEP2)

  itemIDs = .set~of(IDM_COPY, IDM_CUT, IDM_PASTE)
  sysMenu~connectSomeCommandEvents(itemIDs)

  ...

::method copy
  use arg id, x, y

  say 'In SystemMenu->Edit->Copy, do a copy action id:' id 'x:' x 'y:' y
  return .true


::method cut
  use arg id, x, y

  say 'In SystemMenu->Edit->Cut, do a cut action id:' id 'x:' x 'y:' y
  return .true


::method paste
  use arg id, x, y

  say 'In SystemMenu->Edit->Paste, do a paste action id:' id 'x:' x 'y:' y
  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End Section::SystemMenu Command Event Handler -->

</section>  <!-- End Section::Menu Command Event Handlers -->

</section>  <!-- End Section::Menu Command Items -->


<section id="clsMenu" xreflabel="Menu"><title>The Menu Object</title>
<indexterm><primary>Menu class</primary></indexterm>
<indexterm><primary>The Menu Object</primary></indexterm>
<indexterm><primary>menu object</primary></indexterm>
<para>
  All the menu classes in ooDialog are similar. Menus have a large number of methods that are common to all types of
  menus. These common methods are contained in the <computeroutput>Menu</computeroutput> class, a mixin class inherited
  by all menu classes. This document treats the menu object in the same way it does the <xref linkend="chpDialogObject"/>
  object and the dialog <xref linkend="chpDialogControlObject"/> object, as an abstract concept. However, in this case the
  abstract menu object and the <computeroutput>Menu</computeroutput> mixin class are essentially the same.
</para>
<para>
  The methods listed in this chapter are all methods of the <computeroutput>Menu</computeroutput> class and all ooDialog
  menus have these methods.
</para>

<section id="sctMethodsMenuObject"><title>Method Table</title>
<para>
  The following table lists the class methods, attributes, and instance methods that all menus have in common:
<table id="tblMethodsMenuObject" frame="all"> <title>Menu Object Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="3*" />
<thead>
<row>
<entry>Menu Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="mthConnectCommandEventCls"/></entry>
<entry>Connects a menu command event notification from a menu to a method in a Rexx dialog.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="atrHMenu"/></entry>
<entry>The Windows handle of the menu.</entry>
</row>
<row>
<entry><xref linkend="atrWID"/></entry>
<entry>The resource ID of the menu.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="mthCheckClsMenu"/></entry>
<entry>Checks one or more menu items.</entry>
</row>
<row>
<entry><xref linkend="mthCheckRadio"/></entry>
<entry>Checks a specified menu item in a group of items and makes it a radio item.</entry>
</row>
<row>
<entry><xref linkend="mthConnectAllCommandEvents"/></entry>
<entry>Connects every command item in this menu to a method, or methods, in the Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthConnectCommandEvent"/></entry>
<entry>Connects a menu command event notification from a menu to a method in a Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthConnectMenuEvent"/></entry>
<entry>Connects menu <xref linkend="ovvEvents"/> notifications, other than menu command events, to a method in the Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthConnectSomeCommandEvents"/></entry>
<entry>Connects the specified subset of command items in this menu to a method, or methods, in the Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthDeletePopup"/></entry>
<entry>Deletes the specified popup menu from this menu.</entry>
</row>
<row>
<entry><xref linkend="mthDestroyClsMenu"/></entry>
<entry>Releases the system resources used by this menu.</entry>
</row>
<row>
<entry><xref linkend="mthDisableClsMenu"/></entry>
<entry>Disables one or more menu items.</entry>
</row>
<row>
<entry><xref linkend="mthEnableClsMenu"/></entry>
<entry>Enables one or more menu items.</entry>
</row>
<row>
<entry><xref linkend="mthGetAutoConnectStatus"/></entry>
<entry>Returns a <computeroutput>Directory</computeroutput> object containing the current status of <xref linkend="varAutoConnection"/>.</entry>
</row>
<row>
<entry><xref linkend="mthGetCountClsMenu"/></entry>
<entry>Returns the number of items in this menu.</entry>
</row>
<row>
<entry><xref linkend="mthGetHandle"/></entry>
<entry>Returns the value of the hMenu attribute of this menu.</entry>
</row>
<row>
<entry><xref linkend="mthGetHelpID"/></entry>
<entry>Gets the Help context identifier for this menu.</entry>
</row>
<row>
<entry><xref linkend="mthGetIDClsMenu"/></entry>
<entry>Gets the resource ID of the specified menu item.</entry>
</row>
<row>
<entry><xref linkend="mthGetItemState"/></entry>
<entry>Returns a string of 0 or more keywords that indicate the current state of the specified menu item.</entry>
</row>
<row>
<entry><xref linkend="mthGetMaxHeight"/></entry>
<entry>Gets the current maximum height for this menu, in pixels.</entry>
</row>
<row>
<entry><xref linkend="mthGetMenuHandle"/></entry>
<entry>Retrieves the Windows <xref linkend="defHandle"/> of the <xref linkend="ovvUnderlying"/> menu for the specified popup menu of this menu.</entry>
</row>
<row>
<entry><xref linkend="mthGetPopup"/></entry>
<entry>Gets the specified popup menu from this menu. This menu is unchanged.</entry>
</row>
<row>
<entry><xref linkend="mthGetTextClsMenu"/></entry>
<entry>Gets the text, the label, for the specified menu item. Separators do not have any text.</entry>
</row>
<row>
<entry><xref linkend="mthGetType"/></entry>
<entry>Returns a string of 0 or more keywords that indicate the type of the specified menu item.</entry>
</row>
<row>
<entry><xref linkend="mthGray"/></entry>
<entry>Grays one or more menu items.</entry>
</row>
<row>
<entry><xref linkend="mthHilite"/></entry>
<entry>Draws one or more menu items as high lighted. A high lighted menu item is drawn as though it were selected.</entry>
</row>
<row>
<entry><xref linkend="mthInsertItem"/></entry>
<entry>Inserts a new menu command item into this menu.</entry>
</row>
<row>
<entry><xref linkend="mthInsertPopup"/></entry>
<entry>Inserts a new submenu into this menu.</entry>
</row>
<row>
<entry><xref linkend="mthInsertSeparator"/></entry>
<entry>Inserts a separator into this menu at the specified position.</entry>
</row>
<row>
<entry><xref linkend="mthIsCheckedMenu"/></entry>
<entry>Determines if the specified menu item is checked.</entry>
</row>
<row>
<entry><xref linkend="mthIsCommandItem"/></entry>
<entry>Determines if the specified menu item is command menu item, that is if the menu item is one that a user would expect to carry out a command.</entry>
</row>
<row>
<entry><xref linkend="mthIsDisabled"/></entry>
<entry>Determines if the specified menu item is disabled or not.</entry>
</row>
<row>
<entry><xref linkend="mthIsEnabledClsMenu"/></entry>
<entry>Determines if the specified menu item is enabled or not.</entry>
</row>
<row>
<entry><xref linkend="mthIsGrayed"/></entry>
<entry>Determines if the specified menu item is grayed or not.</entry>
</row>
<row>
<entry><xref linkend="mthIsPopup"/></entry>
<entry>Determines if the specified menu item is a submenu (a pop up menu.)</entry>
</row>
<row>
<entry><xref linkend="mthIsSeparator"/></entry>
<entry>Determines if the specified menu item is a separator.</entry>
</row>
<row>
<entry><xref linkend="mthIsValidItemID"/></entry>
<entry>Determines if a specific menu item <xref linkend="sctMenuItemIDs"/> is valid for this menu.</entry>
</row>
<row>
<entry><xref linkend="mthIsValidMenu"/></entry>
<entry>Checks if this menu is valid.</entry>
</row>
<row>
<entry><xref linkend="mthIsValidMenuHandle"/></entry>
<entry>Given a <xref linkend="defHandle"/>, determines if the handle is a menu handle and, if it is, if the menu is still valid.</entry>
</row>
<row>
<entry><xref linkend="mthItemTextToMethodName"/></entry>
<entry>Converts the specified text to a method name as if the text were the text of a menu command item.</entry>
</row>
<row>
<entry><xref linkend="mthReleaseMenuHandle"/></entry>
<entry>Converts the specified text to a method name as if it where the text of a menu command item.</entry>
</row>
<row>
<entry><xref linkend="mthRemoveItem"/></entry>
<entry>Removes, but does not delete, the specified popup menu from the menu.</entry>
</row>
<row>
<entry><xref linkend="mthRemovePopup"/></entry>
<entry>Removes, but does not delete, the specified popup menu from the menu.</entry>
</row>
<row>
<entry><xref linkend="mthRemoveSeparator"/></entry>
<entry>Removes (deletes) the specified menu separator from this menu.</entry>
</row>
<row>
<entry><xref linkend="mthSetAutoConnection"/></entry>
<entry>Set the current status of <xref linkend="varAutoConnection"/>.</entry>
</row>
<row>
<entry><xref linkend="mthSetHelpID"/></entry>
<entry>Sets the Help context identifier for the this menu, and optionally all submenus.</entry>
</row>
<row>
<entry><xref linkend="mthSetID"/></entry>
<entry>Sets the resource ID of this menu.</entry>
</row>
<row>
<entry><xref linkend="mthSetMaxHeight"/></entry>
<entry>Sets the maximum height for this menu, in pixels, and optionally sets the height for all submenus of this menu.</entry>
</row>
<row>
<entry><xref linkend="mthSetTextClsMenu"/></entry>
<entry>Sets the text of the specified menu item..</entry>
</row>
<row>
<entry><xref linkend="mthUncheckClsMenu"/></entry>
<entry>Unchecks one or more menu items.</entry>
</row>
<row>
<entry><xref linkend="mthUnhilite"/></entry>
<entry>Removes the high light from one or more menu items.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthConnectCommandEventCls" xreflabel="connectCommandEvent"><title>connectCommandEvent (Class method)</title>
<indexterm><primary>connectCommandEvent</primary><secondary>menu object</secondary><tertiary>class method</tertiary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectCommandEvent</secondary><tertiary>class method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectCommandEvent(--id-,--methodName-,--dlg--)------------><

]]>
</programlisting>

<para>
  Connects a menu command item <xref linkend="ovvEvents"/> notification with a method in the specified Rexx
  dialog. The notification is sent to the Windows dialog when a command item in a menu is selected by the user.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the menu item, may be <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName [required]</term>
    <listitem>
    <para>
      The name of the method in the Rexx dialog to connect the notification to. This can not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The Rexx dialog to connect the notification to.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, <computeroutput>.false</computeroutput> on error. On
    error the <computeroutput>.systemErrorCode</computeroutput> will be set as described in the Details section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using the <emphasis role="italic">connectCommandEvent</emphasis> class method to connect menu command events,
    the programmer must use a menu item <xref linkend="sctMenuItemIDs"/>, not a menu item <emphasis
    role="italic">position</emphasis> identifier.
  </para>
  <para>
    The <emphasis role="italic">connectCommandEvent</emphasis> class method is used for all types of menus. However, the
    programmer should be aware of the differences in coding event
    <xref linkend="sctMenuCommandEventHandlers"/>s for <xref linkend="clsSystemMenu"/> and other
    types of menus.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_PARAMETER (87)</emphasis></term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">methodName</emphasis> argument can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <xref linkend="chpDialogObject"/> object.
      </para> </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example disables the ability of the user to move the position of the dialog at certain times. It does this by
    connecting the system menu's move command event to a method in the Rexx dialog. In the event handler, if the
    position of the dialog is <emphasis role="italic">frozen</emphasis>, then the method returns
    <computeroutput>.true</computeroutput> indicating that the event has been handled by the application.  The operating
    system then takes no further action and the dialog can not be moved by the user.
  </para>
  <para>
    The example is complete and can be copy-pasted into a program file and executed as:

<programlisting>
<![CDATA[

  dlg = .FreezePositionDlg~new
  dlg~execute('ShowTop')

::requires 'ooDialog.cls'

::class 'FreezePositionDlg' subclass Userdialog

::method init
  forward class (super) continue
  self~createCenter(180, 100, 'A Freezable Dialog')

::method defineDialog
  expose isFrozen

  self~createPushButton(100,  30, 65, 55, 15, , "Take Action",   onStartAction)
  self~createPushButton(101, 100, 65, 55, 15, , "Cancel Action", onCancelAction)

  .SystemMenu~connectCommandEvent(.SystemMenu~SC_MOVE, onSCMove, self)
  isFrozen = .false

::method onSCMove unguarded
  expose isFrozen
  use arg id, x, y

  if isFrozen then return .true
  else return .false

::method onStartAction unguarded
  expose isFrozen
  isFrozen = .true

::method onCancelAction unguarded
  expose isFrozen
  isFrozen = .false

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::connectCommandEvent() -->

<section id="atrHMenu" xreflabel="hMenu"><title>hMenu (Attribute)</title>
<indexterm><primary>hMenu</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>hMenu</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hMenu--------------------------------------------><

]]>
</programlisting>

<para>
  The Windows <xref linkend="defHandle"/> of the menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">hMenu get:</emphasis></term>
  <listitem>
  <para>
    The returned handle, if it is not null, can be used in any ooDialog method that takes a menu handle as an argument.
    The <xref linkend="mthGetHandle"/>() also returns the value of this attribute.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">hMenu set:</emphasis></term>
  <listitem>
  <para>
    This is a <emphasis role="italic">get</emphasis> only attribute. The programmer can not set the attribute through
    assignment. I.e.,
<programlisting>
<![CDATA[
  menuObj~hMenu = handle
]]>
</programlisting>
    is not valid.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If a menu is released through the <xref linkend="mthDestroyClsMenu"/>() method, the menu handle will
    then be null and is no longer valid. The menu handle is a Rexx <computeroutput>Pointer</computeroutput> object and
    therefore has the methods of that class. Specifically it has the <emphasis role="italic">isNull</emphasis>() method,
    which can be used to test if the handle is still valid.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::hMenu() [attribute]  -->

<section id="atrWID" xreflabel="wID"><title>wID (Attribute)</title>
<indexterm><primary>wID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>wID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--wID----------------------------------------------><

]]>
</programlisting>

<para>
  The resource ID of this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">wID get:</emphasis></term>
  <listitem>
  <para>
    The resource ID may be -1 if the ID was not set when the menu was created.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">wID set:</emphasis></term>
  <listitem>
  <para>
    This is a <emphasis role="italic">get</emphasis> only attribute. The programmer can not set the attribute through
    assignment. I.e.,
<programlisting>
<![CDATA[
  menuObj~wID = 110
]]>
</programlisting>
    is not valid.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Although the programmer can not set the <emphasis role="italic">wID</emphasis> attribute directly, it can be set
    when menu is instantiated, for instance see the <computeroutput>BinaryMenuBar</computeroutput>
 <xref linkend="mthNewClsBinaryMenuBar"/> method or the <computeroutput>PopupMenu</computeroutput>
 <xref linkend="mthNewClsPopupMenu"/> method. In addition, the <xref linkend="mthSetID"/> method can be
    used to set or change the ID of a <emphasis role="italic">submenu</emphasis>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::wID() [attribute]  -->

<section id="mthCheckClsMenu" xreflabel="check"><title>check</title>
<indexterm><primary>check</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>check</secondary></indexterm>
<programlisting>
<![CDATA[
>>--check(--IDs--+--------------+--)-------------><
                 +-,-byPosition-+
]]>
</programlisting>

<para>
  Checks one or more menu items. Separators can not be checked.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>IDs [required]</term>
    <listitem>
    <para>
      The item <xref linkend="entMenuItemIdentifier"/> to be checked, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a single ID or a collection of IDs.  The
      ID(s) can be position IDs or resource IDs, depending on the value of <emphasis
      role="italic">byPosition</emphasis>. However, if this is a collection of IDs there must be all the same type, all
      resource IDs or all position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To check more than 1 menu item at a time, use a collection object, such as an
    <computeroutput>array</computeroutput>, where each item in the collection is the menu item ID of the item to be
    checked.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified to be checked is a
        separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from an editor application that has a hexadecimal view of the text. The user can switch back and
    forth between the hexadecimal and normal views using the menu item with the text of <emphasis
    role="italic">hex</emphasis>. When the user selects the menu item, the view is toggled. A check mark by the menu
    item shows it is in hex view, when there is no check mark the view is normal:
<programlisting>
<![CDATA[

::method initDialog
  expose inHex

  inHex = .false
  ...

::method onHexSelect unguarded
  expose menuBar inHex

  if inHex then do
    inHex = .false
    menuBar~uncheck(IDM_HEX_VIEW)
    self~switchToAscii
  end
  else do
    inHex = .true
    menuBar~check(IDM_HEX_VIEW)
    self~switchToHex
  end

  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::check() -->

<section id="mthCheckRadio" xreflabel="checkRadio"><title>checkRadio</title>
<indexterm><primary>checkRadio</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>checkRadio</secondary></indexterm>
<programlisting>
<![CDATA[
>>--checkRadio(--start-,-end-,-check--+--------------+--)-------><
                                      +-,-byPosition-+
]]>
</programlisting>

<para>
  Checks a specified menu item in a group of items and makes it a radio item. At the same time, the function clears all
  other menu items in the associated group and clears the radio-item type flag for those items.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>start [required]</term>
    <listitem>
    <para>
      The resource ID of the first menu item in the group, may be <xref linkend="itmMenuSymbolicIDs"/> or
      numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>end [required]</term>
    <listitem>
    <para>
      The resource ID of the last menu item in the group, may be <xref linkend="itmMenuSymbolicIDs"/> or
      numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>check [required]</term>
    <listitem>
    <para>
      The resource ID of the menu item in the group that will be checked, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Note that all item IDs must be the same type, that is they must all be resource IDs or all by position IDs.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from an application that has a <emphasis role="italic">zoom</emphasis> view. The user can select a
    zoom in a range through the menu. A radion button menu item shows which zoom is currently in place:
<programlisting>
<![CDATA[

::method setZoom
  expose menuBar
  use strict arg zoomVal

  menuBar~checkRadio(IDM_ZOOM_MIN, IDM_ZOOM_MAX, zoomVal)
  self~zoomTo(zoomVal)
  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::checkRadio() -->

<section id="mthConnectAllCommandEvents" xreflabel="connectAllCommandEvents"><title>connectAllCommandEvents</title>
<indexterm><primary>connectAllCommandEvents</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectAllCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectAllCommandEvents(--+-------+--+-------+--)-----------><
                              +--mth--+  +-,-dlg-+
]]>
</programlisting>

<para>
  Connects every command item in the menu to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object.  The default is to connect the command
      items to the owner dialog of this menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog
        <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects every menu command item in the menu to the <emphasis role="italic">onMenuSelect</emphasis>
    method in the dialog:
<programlisting>
<![CDATA[

::method connectMenu unguarded private
  use strict arg menu

  if \ menu~connectAllCommandEvents(onMenuSelect) then self~error('Connect All Items Failed')

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::connectAllCommandEvents() -->

<section id="mthConnectCommandEvent" xreflabel="connectCommandEvent"><title>connectCommandEvent</title>
<indexterm><primary>connectCommandEvent</primary><secondary>menu object</secondary><tertiary>instance method</tertiary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectCommandEvent</secondary><tertiary>instance method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectCommandEvent(--id--,--methodName--+--------+--)---------------------><
                                             +-,-dlg--+
]]>
</programlisting>

<para>
  Connects a menu command item <xref linkend="ovvEvents"/> notification with a method in a Rexx dialog. The
  notification is sent to the Windows dialog when a command item in a menu is selected by the user.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the menu item, may be <xref linkend="itmMenuSymbolicIDs"/> or numeric.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>methodName [required]</term>
      <listitem>
      <para>
        The name of the method in the Rexx dialog to connect the notification to. This can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>dlg [optional]</term>
      <listitem>
      <para>
        A Rexx dialog to connect the notification to. By default, the notification is is connected to the Rexx dialog that
        the menu is <xref linkend="mthAttachTo"/> or <xref linkend="mthAssignTo"/> to. If
        omitted and there is no assigned or attached dialog, no connection is made and the
        <xref linkend="dotSystemErrorCode"/> is set as described in the Details section. (To connect a
        menu item command event, there must be a dialog to connect it to.)
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, otherwise <computeroutput>.false</computeroutput>. If
    there is an error, the <computeroutput>.systemErrorCode</computeroutput> is set as described in the Details section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using the <emphasis role="italic">connectCommandEvent</emphasis> method to connect menu command events, the
    programmer must use a menu item <xref linkend="sctMenuItemIDs"/>, not a menu item <emphasis
    role="italic">position</emphasis> identifier.
  </para>
  <para>
    The <emphasis role="italic">connectCommandEvent</emphasis> method is used for all types of menus. However, the
    programmer should be aware of the differences in coding event
    <xref linkend="sctMenuCommandEventHandlers"/>s for <xref linkend="clsSystemMenu"/> and other
    types of menus.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_PARAMETER (87)</emphasis></term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">methodName</emphasis> argument can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example example connects the <emphasis role="italic">Open</emphasis> menu item in the <emphasis
    role="italic">File</emphasis> submenu of the menu bar to the <emphasis role="italic">onFileOpen</emphasis> method in
    the dialog. Then the <emphasis role="italic">Close</emphasis>, <emphasis role="italic">Save</emphasis>, etc., menu
    items are connected. Since the menu bar has already been attached to the dialog, the third optional argument to
    <emphasis role="italic">connectCommandEvent</emphasis> is left out:
<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar~attachTo(self)

  menuBar~connectCommandEvent(IDM_OPEN, onFileOpen)
  menuBar~connectCommandEvent(IDM_CLOSE, onFileClose)
  menuBar~connectCommandEvent(IDM_SAVE, onFileSave)
  menuBar~connectCommandEvent(IDM_SAVEAS, onFileSaveAs)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::connectCommandEvent() -->

<section id="mthConnectMenuEvent" xreflabel="connectMenuEvent"><title>connectMenuEvent</title>
<indexterm><primary>connectMenuEvent</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectMenuEvent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectMenuEvent(--mName-,-event--+-----------+--+--------+--)-------------><
                                      +-,-hFilter-+  +-,-dlg--+
]]>
</programlisting>

<para>
  Connects menu <xref linkend="ovvEvents"/> notifications to a method in the Rexx dialog. These are menu
  notifications <emphasis role="italic">other</emphasis> than the <xref linkend="sctMenuCommandEvents"/> notifications.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>mName [required]</term>
    <listitem>
    <para>
      The method name of the event handler to be connected. This can not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>event [required]</term>
    <listitem>
    <para>
      Exactly one of the following keywords, case is not significant, that indicates the event to be connected:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>CONTEXTMENU  </member>
        <member>INITMENU     </member>
        <member>INITMENUPOPUP</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>CONTEXT</term>
        <listitem>
        <para>
          Notifies a window that the user clicked the right-clicked the mouse button in the window. The application
          should display a context menu. The <xref linkend="mthConnectContextMenuCls"/> class
          method or the <xref linkend="mthConnectContextMenu"/> instance method provide the same
          functionality and may be more convenient to use.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>INITMENU</term>
        <listitem>
        <para>
          Notifies the application that a menu is about to become active. The event occurs when the user clicks an item
          on the menu bar, clicks on the system menu, or presses a menu key. This notification allows the application to
          modify the menu before it is shown.
        </para>
        <para>
          The notification is also generated before a context menu is about to become active, but only if the
          application displays a context menu. I.e., the event notification is not generated if the application uses a
          context menu, but does not actually display it for some reason.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>INITMENUPOPUP</term>
        <listitem>
        <para>
          Notifies the application that a drop-down menu or submenu is about to become active. This allows the
          application to modify the menu before it is shown, without changing the entire menu.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hFilter [optional]</term>
    <listitem>
    <para>
      The Windows <xref linkend="defHandle"/> of an object to use to filter the connected notification. The
      use of this filter is specific to the event being connectd. For the CONTEXTMENU event it can be a window handle,
      in which case only notifications for that specific window are generated. When this menu is a menu
 <xref linkend="clsMenuBar"/>, then for the INITMENUPOPUP event it can be the menu handle of a submenu, in which
      case only notifications for that specific submenu are generated. When this menu is not a menu bar, the argument is
      ignored. For the INITMENU event, this argument is ignored.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      The dialog being connected to the event. By default the dialog this menu is attached or assigned to is used.
      However, any dialog can be used. In most cases, it only makes sense to connect the menu notification to the dialog
      the menu is attached to.
    </para>
    <para>
      Recall that menu objects exist and are not tied to dialog objects. Menu event connections can be, and maybe often
      are, made before a menu is assigned or attached to a dialog. Recall also that submenus in a menubar never have an
      owner dialog. In these cases, omitting the <emphasis role="italic">dlg</emphasis> argument results in <emphasis
      role="italic">no</emphasis> connection being made.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The INITMENU notification is only sent when a menu is first accessed, only one INITMENU notification is generated
    for each access. Moving the mouse across several menu items while holding down the button does not generate new
    messages. The INITMENU notification gives the programmer the opportunity to modify the entire menu before the user
    sees it. If the application only needs to modify a small part of the menu, the INITMENUPOPUP notification allows the
    programmer to only modify a specific portion of the menu and only if it is actually going to be displayed.
  </para>
  <para>
    When this menu is a menu bar, connecting the INITMENUPOPUP event and not using the optional <emphasis
    role="italic">hFilter</emphasis> argument results in <emphasis role="italic">all</emphasis> INITMENUPOPUP events
    sent to the <xref linkend="ovvUnderlying"/> dialog invoking the connected event handler. Note that
    this will include notifications that the programmer may not at first expect. If the user clicks on the system menu,
    an INITMENUPOPUP notification is generated. If the application uses a context menu, the INITMENUPOPUP notification
    is generated before the context menu is shown. The connected event handler will also be invoked for these
    notifications.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the object is not a <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects the INITMENU event to the <emphasis role="italic">menuInit</emphasis> method in the dialog:
<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar~attachTo(self)
  menuBar~connectMenuEvent(menuInit, INITMENU)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>


<section id="evtMenuObjectCONTEXTMENU"><title>Context Menu Event Handler</title>
<indexterm><primary>menu object event</primary><secondary>CONTEXTMENU</secondary></indexterm>
<para>
  <emphasis role="bold">Note</emphasis> that the event handler for the CONTEXTMENU event connected through the
 <xref linkend="mthConnectMenuEvent"/>, described in this section, is the same as the event handler
  <link linkend="evtPopupMenuCONTEXT">described</link> for the CONTEXTMENU event connected through one of the
 <xref linkend="clsPopupMenu"/> class methods. The event and event handler are the same no matter how the
  event connection is made.
</para>
<para>
  The event handler for the context menu event is invoked when the user right-mouse clicks on a window, types SHIFT-F10
  on the keyboard, or types the VK_APPS key on the keyboard. The VK_APPS key is the <emphasis
  role="italic">Applications</emphasis> key on a Natural keyboard.
</para>
<para>
  The interpreter does not wait for the return from the event handler, so the method does not need to return a value.
  However, good practice would be to always return a value from an event handler.
  <computeroutput>.true</computeroutput>, the notification was processed, is a good value to return.
</para>

<programlisting>
<![CDATA[
::method onContextMenu unguarded
  use arg hwnd, x, y

  return 0
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 3 arguments:
  </para>
  <variablelist>
    <varlistentry><term>hwnd</term>
    <listitem>
    <para>
      The window <xref linkend="defHandle"/> of the window the user clicked the mouse on, or the window
      that has the focus if the user generated the context menu event with the keyboard. Note that this will only be
      the dialog window handle of the user clicks on the dialog background. Quite often it is going to be one of the
      dialog controls.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>x</term>
    <listitem>
    <para>
      The X coordinate of the mouse position, in screen <xref linkend="defScreenCoordinates"/>) coordinates, at the
      time of the mouse click. Or, -1 if the user generated the context menu event by using the keyboard.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>y</term>
    <listitem>
    <para>
      The Y coordinate of the mouse position, in screen <xref linkend="defScreenCoordinates"/>) coordinates, at the
      time of the mouse click. Or, -1 if the user generated the context menu event by using the keyboard.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    0 makes a good return value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example shows the event handler method that is only invoked for a list view in the application. Note
    that since the application uses the <xref linkend="mthShowClsPopupMenu"/> method to put up the context
    menu, the handling of the menu command item selection is done in a menu command event
    <xref linkend="sctMenuCommandEventHandlers"/>.

<programlisting>
<![CDATA[

::method initDialog
  expose shortCutMenu
  ...

  shortCutMenu = self~createMenu
  shortCutMenu~assignTo(self)
  shortCutMenu~connectMenuEvent(onContext, 'CONTEXTMENU)

  ...

::method onContext
  expose shortCutMenu listView
  use arg hwnd, x, y

  if x == -1, y == -1 then do
    -- The keyboard was used, not the mouse.  Position the context menu as
    -- at the lower right of the list view.
    rect = listView~windowRect
    x = rect~right - .SM~cxVScroll + 15
    y = rect~bottom - 15
  end

  -- pos is the point on the screen, in pixels, to place the context menu.
  pos = .Point~new(x, y)

  -- Show the menu.
  ret = shortCutMenu~show(pos)
  if ret == -1 then do
    say "shortCutMenu~show() failed SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End Context Menu Event Handler -->

<section id="evtMenuObjectINITMENU" xreflabel="INITMENU"><title>InitMenu Event Handler</title>
<indexterm><primary>menu object event</primary><secondary>INITMENU</secondary></indexterm>
<para>
  The event handler for the init menu event is invoked when the user clicks on a menu or uses a menu key. The menu is
  about to become active, but has not actually been shown yet. This allows the programmer to modify the menu before it
  is displayed.
</para>
<para>
  The programmer must return <computeroutput>.true</computeroutput> or <computeroutput>.false</computeroutput> from the
  event handler, and the interpreter <link linkend="sctCodingEventHandlers">waits</link>) for this return.
</para>

<programlisting>
<![CDATA[
::method onInitMenu unguarded
  use arg hMenu

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 1 arguments
  </para>
  <variablelist>
    <varlistentry><term>hMenu</term>
    <listitem>
    <para>
      The Windows <xref linkend="defHandle"/> for the menu about to become active.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    Return true to indicate the notification was processed, otherwise return false. Note that the Microsoft
    documentation is vague in this area. Experimentation seems to indicate that, for dialogs, it does not matter if true
    or false is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
     The INITMENU notification is only generated when a menu is first accessed and only one notification is generated
     for each access. For example, moving the mouse across several menu items while holding down the button does not
     generate new notifications.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example shows an event handler that disables some (most) of the items in a system menu before it is
    shown. Whether or not the items are disabled is controlled by an instance variable that is set in other parts of the
    application:

<programlisting>
<![CDATA[

::method onInitMenu
  expose sysMenu disableItems
  use arg hMenu

  if disableItems then do
    sysMenu~disable(SC_MAXIMIZE)
    sysMenu~disable(SC_MINIMIZE)
    sysMenu~disable(SC_MOVE)
    sysMenu~disable(SC_CLOSE)
    return .true
  end
  else do
    return .false
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End InitMenu Event Handler -->

<section id="evtMenuOobjectINITMENUPOPUP"><title>InitMenuPopup Event Handler</title>
<indexterm><primary>menu object event</primary><secondary>INITMENUPOPUP</secondary></indexterm>
<para>
  The event handler for the init menu popup event is invoked when a submenu is about to become active. This includes
  the system menu or a context menu. This allows the programmer to modify a portion of a menu, rather than the whole
  menu.
</para>
<para>
  The programmer must return <computeroutput>.true</computeroutput> or <computeroutput>.false</computeroutput> from the
  event handler, and the interpreter <link linkend="sctCodingEventHandlers">waits</link>) for this return.
</para>

<programlisting>
<![CDATA[
::method onInitMenuPopup unguarded
  use arg position, isSystemMenu, hMenu

  return .true
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 3 arguments:
  </para>
  <variablelist>
    <varlistentry><term>position</term>
    <listitem>
    <para>
      The one-based position index of the submenu. For instance if the submenu is the third from the left in a menu bar,
      then position will be 3.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>isSystemMenu</term>
    <listitem>
    <para>
      True if the submenu about to become active is the system menu, otherwise false
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hMenu</term>
    <listitem>
    <para>
      The Windows <xref linkend="defHandle"/> for the submenu about to become active.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    Return true to indicate the notification was processed, otherwise return false. Note that the Microsoft
    documentation is vague in this area. Experimentation seems to indicate that, for dialogs, it does not matter if true
    or false is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If both the <xref linkend="evtMenuObjectINITMENU"/> and INITMENUPOPUP events are connected, then two successive event
    handlers will often be invoked. Take for instance a menu bar that contains a <emphasis role="italic">File</emphasis>
    submenu. If the user clicks on the <emphasis role="italic">File</emphasis> menu, the operating system first generates an
    INITMENU notification (for the menubar about to become active) and then generates an INITMENUPOPUP notification (for the
    <emphasis role="italic">File</emphasis> submenu about to be come active.)
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example is from an application with a large menu, with an <emphasis role="italic">Edit</emphasis>
    menu that has a <emphasis role="italic">Copy</emphasis> menu item. If there is nothing selected, the <emphasis
    role="italic">Copy</emphasis> menu item is disabled, if and only if, the user actually navigates to the <emphasis
    role="italic">Edit</emphasis> submenu.

<programlisting>
<![CDATA[

  ...
  hMenu = menuBar~getPopup(IDM_EDIT_SUBMEN)~hMenu
  menuBar~connectMenuEvent(onEditMenuPopup, 'INITMENUPOPUP', hMenu)
  ...

::method on EditMenuPopup unguarded
  expose menuBar
  use arg pos, isSysMenu, hMenu

  if self~haveSomeSelection then menuBar~enable(IDM_COPY)
  else menuBar~disable(IDM_COPY)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End InitMenuPopup Event Handler -->

</section>  <!-- End menu object::connectMenuEvent() -->

<section id="mthConnectSomeCommandEvents" xreflabel="connectSomeCommandEvents"><title>connectSomeCommandEvents</title>
<indexterm><primary>connectSomeCommandEvents</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>connectSomeCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectSomeCommandEvents(--ids-+-------+-+--------------+-+-------+--)-----><
                                   +-,-mth-+ +-,-byPosition-+ +-,-dlg-+
]]>
</programlisting>

<para>
  Connects a collection of menu command items to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>ids [required]</term>
    <listitem>
    <para>
      A <computeroutput>Collection</computeroutput> object containing the menu item
      <xref linkend="sctMenuItemIDs"/>s to connect.  The IDs can be by position IDs or resource IDs,
      depending on the value of the <emphasis role="italic">byPosition</emphasis> argument. However, they must be all
      the same type, all resource IDs or all by position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the IDS are by positional IDs, otherwise the are resource IDs. The default is false, they are resource
      IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object. The default is to connect the command items to
      the owner dialog of this menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">ids</emphasis> argument can be any ooRexx collection with a <emphasis
    role="italic">makeArray</emphasis> method that returns an array whose <emphasis role="italic">items</emphasis> are
    the menu item IDs to connnect.
  </para>
  <para>
    This method quits when an error is detected. This implies that on an error return some menu items may have been
    connected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_PARAMETER (87)</term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> One or more of the specified item IDs is
        not a menu command item.  Or the msg argument was used, but it is the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog
        <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects four menu command items in the menu bar, by their symbolic IDs, to 4 methods in the dialog.
    The method names will be constructed from the text of the menu item:
<programlisting>
<![CDATA[

::method enuConnectItems
  expose menuBar
  use strict arg

  ids = .array~of(IDM_EDIT_COPY, IDM_EDIT_PASTE, IDM_EDIT_CUT, IDM_EDIT_DELETE)

  if \ menuBar~connectSomeCommandEvents(ids) then self~error('Connect Some Menu Items Failed')


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::connectSomeCommandEvents() -->

<section id="mthDeletePopup" xreflabel="deletePopup"><title>deletePopup</title>
<indexterm><primary>deletePopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>deletePopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deletePopup(--id--+---------------+--)-------><
                      +-,-byPosition--+
]]>
</programlisting>

<para>
  Deletes the specified popup menu from this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the popup menu to be deleted. This can be a position ID or a
      resource ID, depending on the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a popup menu (a submenu) is deleted, the operating system frees all resources used by the popup menu and any
    references to the popup are no longer valid. To be explicit, this means that any
 <xref linkend="clsPopupMenu"/> objects that represent this submenu are no longer valid, which would also
    include any menu that has this submenu as one of its submenus.
  </para>
  <para>
    To remove a submenu from a menu, and still use the submenu, use the
 <xref linkend="mthRemovePopup"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error code may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The specified menu item is not a popup menu.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example removes the <emphasis role="italic">View</emphasis> popup menu from a menubar and deletes it, freeing
    up the system resources used for it:
<programlisting>
<![CDATA[

  menuBar~deletePopup(IDM_VIEW)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::deletePopup() -->

<section id="mthDestroyClsMenu" xreflabel="destroy"><title>destroy</title>
<indexterm><primary>destroy</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>destroy</secondary></indexterm>
<programlisting>
<![CDATA[
>>--destroy--------------------------------------><

]]>
</programlisting>

<para>
  Releases the operating system resources for the <xref linkend="ovvUnderlying"/> menu of this
  <computeroutput>Menu</computeroutput> object. Menubars attached to a dialog, or submenus that are a part of a menubar,
  should not be destroyed. A menubar attached to a window is automatically destroyed by the operating system when the
  window is destroyed. When the operating system destroys a menubar or popup menu, it does so recursively. All submenus
  of the menu are also destroyed.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    It is only when a menubar is not attached to a window, or a popup menu is not part of a menubar, that a menu needs
    to be destroyed. This should be done before the application ends, but it could be done at any time if the menu is no
    longer needed. Do not destroy a submenu of a menubar unless the submenu has been
 <xref linkend="mthRemovePopup"/> from the menubar, when the menubar is attached to a dialog. The results are
    unpredictable.
  </para>
  <para>
    When the <emphasis role="italic">destroy</emphasis> method is invoked, if this menu is a menubar attached to a
    dialog, the menubar is first <xref linkend="mthDetach"/>. The menubar is then destroyed. This in turn will
    cause the dialog to redraw its client area and all controls in the dialog will be moved up by the amount of space
    the menubar had occupied.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from an application that has a simple mode and an <emphasis role="italic">advanced</emphasis>
    mode. The simple and advanced modes each have their own menubars. When the user switches modes, the existing menubar
    is detached and the menubar for the new mode is attached to the dialog. When the dialog is ended, the menubar not
    currently in use is destroyed:
<programlisting>
<![CDATA[

::method leaving
  expose advancedMenubar simpleMenubar

  if self~isAdvancedMode then simpleMenubar~destroy
  else advancedMenubar~destroy

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::destroy() -->

<section id="mthDisableClsMenu" xreflabel="disable"><title>disable</title>
<indexterm><primary>disable</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>disable</secondary></indexterm>
<programlisting>
<![CDATA[
>>--disable(--IDs--+--------------+--)-----------><
                   +-,-byPosition-+
]]>
</programlisting>

<para>
  Disables one or more menu items. Separators can not be disabled. Note that disable and gray are the exact same thing.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>IDs [required]</term>
    <listitem>
    <para>
      The menu item <xref linkend="entMenuItemIdentifier"/> to be disabled, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a single ID or a collection of IDs.  The
      ID(s) can be position IDs or resource IDs, depending on the value of <emphasis
      role="italic">byPosition</emphasis>. However, if this is a collection of IDs there must be all the same type, all
      resource IDs or all position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To disable more than 1 menu item at a time, use a collection object, such as an
    <computeroutput>array</computeroutput>, where each item in the collection is the menu item ID of the item to be
    disabled.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified to be disabled is a
        separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from an application that only allows the user to open 1 file at a time. When the current file is
    closed, the Close File menu item is disabled and the Open File menu item is enabled.
<programlisting>
<![CDATA[

::method onCloseFile unguarded
  expose menuBar

  menuBar~disable(IDM_FILE_CLOSE)
  menuBar~enable(IDM_FILE_OPEN)

  self~closeCurrentFile
  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::disable() -->

<section id="mthEnableClsMenu" xreflabel="enable"><title>enable</title>
<indexterm><primary>enable</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>enable</secondary></indexterm>
<programlisting>
<![CDATA[
>>--enable(--IDs--+--------------+--)------------><
                  +-,-byPosition-+
]]>
</programlisting>

<para>
  Enables one or more menu items. Separators can not be enabled.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>IDs [required]</term>
    <listitem>
    <para>
      The menu item <xref linkend="entMenuItemIdentifier"/> to be enabled, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a single ID or a collection of IDs.  The
      ID(s) can be position IDs or resource IDs, depending on the value of <emphasis
      role="italic">byPosition</emphasis>. However, if this is a collection of IDs there must be all the same type, all
      resource IDs or all position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To enable more than 1 menu item at a time, use a collection object, such as an
    <computeroutput>array</computeroutput>, where each item in the collection is the menu item ID of the item to be
    enabled.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified to be enabled is a
        separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from an application that only allows the user to open 1 file at a time. When the current file is
    opened, the Open File menu item is disabled and the Close File menu item is enabled.
<programlisting>
<![CDATA[

::method onOpenFile unguarded
  expose menuBar

  if self~openFile then do
    menuBar~disable(IDM_FILE_OPEN)
    menuBar~enable(IDM_FILE_CLOSE)
  end

  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::enable() -->

<section id="mthGetAutoConnectStatus" xreflabel="getAutoConnectStatus"><title>getAutoConnectStatus</title>
<indexterm><primary>getAutoConnectStatus</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getAutoConnectStatus</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getAutoConnectStatus-------------------------><

]]>
</programlisting>

<para>
  Returns a <computeroutput>Directory</computeroutput> object containing the current status of
  <xref linkend="varAutoConnection"/>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a <computeroutput>.Directory</computeroutput> object with the following indexes:
  </para>
  <variablelist>
    <varlistentry><term>AUTOCONNECT</term>
    <listitem>
    <para>
      If true, autoconnection is on. If false, autoconnection is off
    </para>
    </listitem></varlistentry>
    <varlistentry><term>METHODNAME</term>
    <listitem>
    <para>
      The method name for autoconnection, if set. The <computeroutput>.nil</computeroutput> object if no method name is
      set, or autoconnection is off.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Use the <xref linkend="mthSetAutoConnection"/> method to change the status of autoconnection.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This code could be used to determine if autoconnection is on or off:
<programlisting>
<![CDATA[

  if menu~getAutoConnectStatus~autoConnect then do
    -- autoconnection is on, do something ...
  end
  else do
    -- autoconnection is no on, do something else ...
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getAutoConnectStatus() -->

<section id="mthGetCountClsMenu" xreflabel="getCount"><title>getCount</title>
<indexterm><primary>getCount</primary><secondary>Menu class</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>getCount</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCount-----------------------------------------><

]]>
</programlisting>

<para>
  Determines the number of menu items in this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      The number of menu items in the menu, or -1 on error.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The number of items in a menu will include the separator and submenu items, but not the count of items in the
    submenus. In other words, it is not a recursive count, just a count of the single menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
<programlisting>
<![CDATA[
  count = menuObj~count
  if count \== -1 then do
    say 'The menu has' count 'items.'
  end
  else do
    say 'Error getting count of menu items:'
    say '  Error Code:' .systemErrorCode SysGetErrortext(.systemErrorCode)
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetHandle" xreflabel="getHandle"><title>getHandle</title>
<indexterm><primary>getHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getHandle------------------------------------><

]]>
</programlisting>

<para>
  Retrieves the Windows <xref linkend="defHandle"/> of the <xref linkend="ovvUnderlying"/>
  menu this Rexx object represents.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The handle to the menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If a menu is released through the <xref linkend="mthDestroyClsMenu"/>() method, the menu handle will
    then be null and is no longer valid. The menu handle is a Rexx <computeroutput>Pointer</computeroutput> object and
    therefore has the methods of that class. Specifically it has the <emphasis role="italic">isNull</emphasis>() method,
    which can be used to test if the handle is still valid.
  </para>
  <para>
    The value returned from <emphasis role="italic">getHandle</emphasis> is identical to the value of the
 <xref linkend="atrHMenu"/> attribute.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the handle for an Edit submenu and then uses it as a filter in the
 <xref linkend="mthConnectMenuEvent"/> method:
<programlisting>
<![CDATA[

  ...

  editMenu = menuBar~getPopup(IDM_POP_EDIT)
  hEditMenu = editMenu~getHandle

  menuBar~connectMenuEvent(onEditMenuPopup, 'INITMENUPOPUP', hEditMenu)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::getHandle() -->

<section id="mthGetHelpID" xreflabel="getHelpID"><title>getHelpID</title>
<indexterm><primary>getHelpID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getHelpID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getHelpID------------------------------------><

]]>
</programlisting>

<para>
  Gets the Help context identifier for this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the help ID, or 0 if the help ID for the menu is not set. On failure, returns -1.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getHelpID() -->

<section id="mthGetIDClsMenu" xreflabel="getID"><title>getID</title>
<indexterm><primary>getID</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>getID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getID(--pos--)-------------------------------><

]]>
</programlisting>

<para>
  Gets the resource ID of the specified menu item.  This is always done by position, if the ID is already known, there
  is no use querying for it.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>pos</term>
    <listitem>
    <para>
      The <xref linkend="entMenuItemPosition"/> identifier whose resource ID is required.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the resource ID of the specified menu item, which is always greater than 0, or -1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Recall that when using menu item position identifiers, the item must be in the immediate menu, the menu that
    actually holds the menu item. The item can not be in a submenu of the menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example searches a menu until it finds a menu item that matches the specified text. If it finds that item, it
    returns the item's resource ID, otherwise it returns -1.
<programlisting>
<![CDATA[

::method retrieveID private
  use strict arg menu, label

  do i = 1 to menu~getCount
    if menu~getText(i, .true) == label then do
      id = menu~getID(i)
      if id > 0 then return id
    end
  end

  return -1

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getID() -->

<section id="mthGetItemState" xreflabel="getItemState"><title>getItemState</title>
<indexterm><primary>getItemState</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getItemState</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getItemState(--id--+---------------+--)------><
                       +-,-byPosition--+
]]>
</programlisting>

<para>
  Returns a string of 0 or more keywords that indicate the current state of the specified menu item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to get the state of. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 on error, otherwise a text string is returned that can contain zero or more of the following keywords,
    separated by blanks, which indicate the menu item's state:
  <variablelist>
    <varlistentry><term>CHECKED</term>
    <listitem>
    <para>
      The menu item is checked.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>DEFAULT</term>
    <listitem>
    <para>
      The menu item is the default menu item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>DISABLED GRAYED</term>
    <listitem>
    <para>
      The menu item is disabled. Disabled and grayed are exactly the same thing. If the menu item is disabled, the
      returned keyword string will always contain <emphasis role="italic">DISABLED GRAYED</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>ENABLED</term>
    <listitem>
    <para>
      The menu item is not disabled
    </para>
    </listitem></varlistentry>
    <varlistentry><term>HILITE</term>
    <listitem>
    <para>
      The menu item is high lighted, that is, it is drawn with the selected appearance.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>UNCHECKED</term>
    <listitem>
    <para>
      The menu item is not checked
    </para>
    </listitem></varlistentry>
    <varlistentry><term>UNHILITE</term>
    <listitem>
    <para>
      The menu item is not high lighted, that is, it is not drawn with the selected state.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the menu item is a separator, the keyword string will be the empty string.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getItemState() -->

<section id="mthGetMaxHeight" xreflabel="getMaxHeight"><title>getMaxHeight</title>
<indexterm><primary>getMaxHeight</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getMaxHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMaxHeight---------------------------------><

]]>
</programlisting>

<para>
  Gets the current maximum height for this menu, in pixels.  Note that 0, indicates that the maximum height is the
  height of the screen.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The maximum height of this menu in pixels, or -1 on error. As mentioned, a return of 0 indicates that the maximum
    height is the height of the screen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    By default, the maximum height of a menu is the height of the screen. This can be changed by the programmer through
    the <xref linkend="mthSetMaxHeight"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the current maximum height of the File drop down menu and checks if it is equal to the height
    of the dialog. If not, it changes the maximum height to the height of the dialog:
<programlisting>
<![CDATA[

::method checkHeight private
  expose menuBar

  size = self~getRealSize

  filePopup = menuBar~getPopup(IDM_FILE)
  if filePopup~getMaxHeight <> size~height then filePopup~setMaxHeight(size~height)

  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getMaxHeight() -->

<section id="mthGetMenuHandle" xreflabel="getMenuHandle"><title>getMenuHandle</title>
<indexterm><primary>getMenuHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getMenuHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMenuHandle(--id--+---------------+--)-----><
                        +-,-byPosition--+
]]>
</programlisting>

<para>
  Retrieves the Windows <xref linkend="defHandle"/> of the <xref linkend="ovvUnderlying"/>
  menu for the specified popup menu of this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the popup menu to get the handle for. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the handle for the submenu on success, or 0 on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error code may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_PARAMETER (87)</term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> the item specified is not a popup menu of
        this menu.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the handle of a submenu in the menubar in order to use it as a filter in the
 <xref linkend="mthConnectMenuEvent"/> method:
<programlisting>
<![CDATA[

  ...

  editMenu = menuBar~getMenuHandle(IDM_POP_EDIT)

  menuBar~connectMenuEvent(onEditMenuPopup, 'INITMENUPOPUP', hEditMenu)


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getMenuHandle() -->

<section id="mthGetPopup" xreflabel="getPopup"><title>getPopup</title>
<indexterm><primary>getPopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getPopup(--id--+---------------+--)----------><
                   +-,-byPosition--+
]]>
</programlisting>

<para>
  Gets the specified popup menu from this menu. This menu is unchanged.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the popup menu to get the handle for. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The specified <computeroutput>PopupMenu</computeroutput> object on success, or 0 on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The popup menu returned by the <emphasis role="italic">getPopup</emphasis> remains a submenu of the parent menu it
    was gotten from. Therefore the programmer should not invoke the <xref linkend="mthDestroyClsMenu"/> or
 <xref linkend="mthReleaseMenuHandle"/> methods on the returned object. The underlying submenu
    will automatically be destroyed by the operating system when its parent menu is destroyed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The specified menu item is not a popup menu.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>OR_INVALID_OID (1911)</term>
      <listitem>
      <para>
        The object specified was not found. <emphasis role="bold">Meaning:</emphasis> Internally, some error occurred in
        trying to get the Rexx <computeroutput>Popupmenu</computeroutput> object that represents the underlying submenu.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets a popup menu from a menubar so that it can be used as a context menu. Note that the popup menu is
    gotten by its position ID rather than its resource ID:
<programlisting>
<![CDATA[
  ...
  dlgPopup = menubar~getPopup(1, .true)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getPopup() -->

<section id="mthGetTextClsMenu" xreflabel="getText"><title>getText</title>
<indexterm><primary>getText</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>getText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getText(--id--+---------------+--)-----------><
                  +-,-byPosition--+
]]>
</programlisting>

<para>
  Gets the text, the label, for the specified menu item. Separators do not have any text.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to get the text for. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The text of the specified menu item on success, the empty string on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The label for a menu item can contain an ampersand symbol, which is not visible to the user. The text returned is
    the complete text set for the menu item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified is a separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from some debug code. The programmer has connected all menu command items (
 <xref linkend="mthConnectAllCommandEvents"/>), but is having trouble supplying the correct
    event handling method in the code. The debug code gets the text of the menu item and then uses
 <xref linkend="mthItemTextToMethodName"/> to determine the correct method name:
<programlisting>
<![CDATA[

::method doDebug private
  expose menuBar
  use strict arg id

  text = menuBar~getText(id)
  say 'Method name for menu item' id 'should be:' menuBar~itemTextToMethodName(text)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getText() -->

<section id="mthGetType" xreflabel="getType"><title>getType</title>
<indexterm><primary>getType</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>getType</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getType(--id--+---------------+--)-----------><
                  +-,-byPosition--+
]]>
</programlisting>

<para>
  Returns a string of 0 or more keywords that indicate the type of the specified menu item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to get the text for. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 on error, or a text string that can contain zero or more of the following keywords, separated by blanks,
    which indicate the menu item's type:
  <variablelist>
    <varlistentry><term>BITMAP</term>
    <listitem>
    <para>
      The menu item is displayed using a bitmap.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>COMMAND</term>
    <listitem>
    <para>
      The menu item is not a submenu or a separator, that is, the user will expect a command to be carried out when
      clicking on, or selecting, this item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>MENUBARBREAK</term>
    <listitem>
    <para>
      The menu item is placed on a new line (for a menubar) or in a new column (for a drop-down menu, submenu, or
      shortcut menu). For a drop-down menu, submenu, or shortcut menu, a vertical line separates the new
      column from the old.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>MENUBREAK</term>
    <listitem>
    <para>
      The menu item is placed on a new line (for a menu bar) or in a new column (for a drop-down menu, submenu, or
      shortcut menu). For a drop-down menu, submenu, or shortcut menu, the columns are not separated by a vertical line.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>OWNERDRAW</term>
    <listitem>
    <para>
      The application is responsible for drawing the menu item. ooDialog does not currently support this type, the
      keyword is documented for completeness.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>RADIO</term>
    <listitem>
    <para>
      If selected, the menu item is displayed using a radio-button mark instead of a check mark.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>RIGHTJUSTIFY</term>
    <listitem>
    <para>
      The menu item and any subsequent items are right-justified. This type is only used in a menubar.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>RIGHTORDER</term>
    <listitem>
    <para>
      Specifies that menus cascade right-to-left (the default is left-to-right). This is used to support right-to-left
      languages, such as Arabic and Hebrew.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>SEPARATOR</term>
    <listitem>
    <para>
      The menu item is a separator.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>STRING</term>
    <listitem>
    <para>
      The menu item is displayed using a text string
    </para>
    </listitem></varlistentry>
    <varlistentry><term>SUBMENU</term>
    <listitem>
    <para>
      The menu item is a submenu, that is a popup menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::getType() -->

<section id="mthGray" xreflabel="gray"><title>gray</title>
<indexterm><primary>gray</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>gray</secondary></indexterm>
<programlisting>
<![CDATA[
>>--gray(--IDs--+--------------+--)--------------><
                +-,-byPosition-+
]]>
</programlisting>

<para>
  Grays one or more menu items. Separators can not be grayed. Note that disable and gray are the exact same thing.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>IDs [required]</term>
    <listitem>
    <para>
      The menu item <xref linkend="entMenuItemIdentifier"/> to be grayed, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a single ID or a collection of IDs.  The
      ID(s) can be position IDs or resource IDs, depending on the value of <emphasis
      role="italic">byPosition</emphasis>. However, if this is a collection of IDs there must be all the same type, all
      resource IDs or all position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To gray more than 1 menu item at a time, use a collection object, such as an
    <computeroutput>array</computeroutput>, where each item in the collection is the menu item ID of the item to be
    grayed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified to be grayed is a
        separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from an application that only allows the user to open 1 file at a time. When the current file is
    closed, the Close File menu item is grayed and the Open File menu item is enabled.
<programlisting>
<![CDATA[

::method onCloseFile unguarded
  expose menuBar

  menuBar~gray(IDM_FILE_CLOSE)
  menuBar~enable(IDM_FILE_OPEN)

  self~closeCurrentFile
  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::gray() -->

<section id="mthHilite" xreflabel="hilite"><title>hilite</title>
<indexterm><primary>hilite</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>hilite</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hilite(--IDs--+--------------+--)------------><
                  +-,-byPosition-+
]]>
</programlisting>

<para>
  High lights one or more menu items. Separators can not be high lighted. A high lighted menu item is drawn as though it
  were the selected item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>IDs [required]</term>
    <listitem>
    <para>
      The menu item <xref linkend="entMenuItemIdentifier"/> to be high lighted, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a single ID or a collection of IDs.  The
      ID(s) can be position IDs or resource IDs, depending on the value of <emphasis
      role="italic">byPosition</emphasis>. However, if this is a collection of IDs there must be all the same type, all
      resource IDs or all position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To high light more than 1 menu item at a time, use a collection object, such as an
    <computeroutput>array</computeroutput>, where each item in the collection is the menu item ID of the item to be
    high lighted.
  </para>
  <para>
    There is not much use for this method, in the author's opinion, but it is documented for completeness since the
    method does exist. High lighting a menu item does not actually select the item, it just makes it look like it is
    selected. This would be confusing to the user. In addition, although this method will accept a collection of item
    IDs, as do the other similar methods, it makes little sense to high light more than one menu item at a time.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified to be high lighted is a
        separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::hilite() -->

<section id="mthInsertItem" xreflabel="insertItem"><title>insertItem</title>
<indexterm><primary>insertItem</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>insertItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertItem(-idBefore-,-id-,-text--+----------+--+--------+------->
                                      +-,-state--+  +-,-type-+

>------------+--------------+--+-----------+--+---------+--)---------><
             +-,-byPosition-+  +-,-connect-+  +-,-mName-+

]]>
</programlisting>

<para>
  Inserts a new menu command item into this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>idBefore [required]</term>
    <listitem>
    <para>
      The newly inserted item is inserted before the item with this <xref linkend="sctMenuItemIDs"/>. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID,
      depending on the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to be inserted. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text, the label, for the new menu item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>state [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. These specify the
      state of the new item. If this argument is omitted or the empty string the state is set to ENABLED UNHILITE NOTDEFAULT
      UNCHECKED.:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>CHECKED   </member>
        <member>DEFAULT   </member>
        <member>DISABLED  </member>
        <member>ENABLED   </member>
        <member>GRAYED    </member>
        <member>HILITE    </member>
        <member>NOTDEFAULT</member>
        <member>UNCHECKED </member>
        <member>UNHILITE  </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>CHECKED</term>
        <listitem>
        <para>
          The menu item is checked.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DEFAULT</term>
        <listitem>
        <para>
          The menu item is the default menu item. Only one item in any submenu can be the default item.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DISABLED</term>
        <listitem>
        <para>
          The menu item is disabled. Disabled and grayed are exactly the same thing.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ENABLED</term>
        <listitem>
        <para>
          The menu item is not disabled. This keyword does not need to be specified. If neither DISABLED nor GRAYED are
          specified, the menu item is automatically enabled
        </para>
        </listitem></varlistentry>
        <varlistentry><term>GRAYED</term>
        <listitem>
        <para>
          The menu item is disabled. Disabled and grayed are exactly the same thing.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HILITE</term>
        <listitem>
        <para>
          The menu item is high lighted, that is, it is drawn with the selected appearance.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTDEFAULT</term>
        <listitem>
        <para>
          The menu item is not the default menu item. This keyword does not need to be specified. If DEFAULT is not
          specified, the menu item is automatically not the default menu item.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>UNCHECKED</term>
        <listitem>
        <para>
          The menu item is not checked. This keyword does not need to be specified. If CHECKED is not specified, the new
          item will automatically be unchecked.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>UNHILITE</term>
        <listitem>
        <para>
          The menu item is not high lighted, that is, it is not drawn with the selected state. This keyword does not
          need to be specified, if the HILITE keyword is omitted, the NOHILITE state is set automatically.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>type [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. These specify the type
      of the new item. If this argument is omitted, or the empty string, then no special type is set:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>RADIO       </member>
        <member>RIGHTJUSTIFY</member>
        <member>MENUBARBREAK</member>
        <member>MENUBAR     </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>RADIO</term>
        <listitem>
        <para>
          Displays checked menu items using a radio-button mark instead of a check mark.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RIGHTJUSTIFY</term>
        <listitem>
        <para>
          Right-justifies the menu item and any subsequent items. This value is valid only if the menu item is in a menu
          bar. It has no effect if the item is in a popup menu.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MENUBARBREAK</term>
        <listitem>
        <para>
          Places the menu item on a new line (for a menu bar) or in a new column (for a drop-down menu, submenu, or
          shortcut menu). For a drop-down menu, submenu, or shortcut menu, a vertical line separates the new column from
          the old.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MENUBREAK</term>
        <listitem>
        <para>
          This is exactly the same as MENUBARBREAK, except that no vertical line is drawn between the columns when the
          item is not in a menu bar.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">idBefore</emphasis> is a positional ID,
      otherwise it is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>connect</term>
    <listitem>
    <para>
      Whether to automatically connect the command item to a method in the owning dialog. This is a
      <xref linkend="varConnectionRequest"/> type of connection type. Do not mix this with
      <xref linkend="varAutoConnection"/>. The default is false. If connect is true and the menu is
      already attached to a dialog the connection is made immediately. Otherwise the request is put in to a queue and
      the connection is made when the menu is first attached to a dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mName</term>
    <listitem>
    <para>
      If <emphasis role="italic">connect</emphasis> is true, this can be the name of the method to connect the command
      event to. If <emphasis role="italic">connect</emphasis> is false, this argument is ignored. If <emphasis
      role="italic">connect</emphasis> is true and this argument is omitted, then the method name is automatically
      constructed from the text of the new item.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If <link linkend="mthGetAutoConnectStatus">autoconnection</link> is on and <emphasis role="italic">connect</emphasis> is
    set to true by the programmer then the new menu item is connected by <emphasis role="italic">autoconnection</emphasis>
    and also connected because of the <emphasis role="italic">connect</emphasis> request. The result of this is
    unpredictable. The <emphasis role="italic">connect</emphasis> argument should never be set to true if autoconnection is
    on for the menu.
  </para>
  <para>
    When the menu command item is inserted into the menu, if there are no other items in the menu there is no ID for the
    <emphasis role="italic">before</emphasis> argument. In this case the programmer can use any positive number and
    the operating system will accept it. The ooDialog examples commonly use the same ID for both the <emphasis
    role="italic">idBefore</emphasis> and <emphasis role="italic">id</emphasis> arguments for this case. 1 is also a good
    choice for the <emphasis role="italic">idBefore</emphasis> argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example inserts a new menu command item into a menu bar with the resource ID of IDM_LV_PROFESSION. By position
    is false, (it could have been omitted,) so IDM_LV_RESTORE is a resource ID. The new item is inserted before the
    IDM_LV_RESTORE menu item, where ever it is in the menu bar. The <emphasis role="italic">connect</emphasis> argument
    is true, so the new menu command item is connected to the <emphasis role="italic">onOrderByProfession</emphasis>
    method, either immediately if the menubar is already attached to a dialog, or when the menubar is first attached to
    a dialog:
<programlisting>
<![CDATA[

  menuBar~insertItem(IDM_LV_RESTORE, IDM_LV_PROFESSION, "Order by Profession", -
                     'DEFAULT CHECKED', 'RADIO', .false, .true, onOrderByProfession)
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::insertItem() -->

<section id="mthInsertPopup" xreflabel="insertPopup"><title>insertPopup</title>
<indexterm><primary>insertPopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>insertPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertPopup(-idBefore-,-id-,-pop-,-txt-+----------+-+--------+-+---------+--)--><
                                           +-,-state--+ +-,-type-+ +-,-byPos-+

]]>
</programlisting>

<para>
  Inserts a new submenu into this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>idBefore [required]</term>
    <listitem>
    <para>
      The newly inserted submenu is inserted before the item with this <xref linkend="sctMenuItemIDs"/>. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID,
      depending on the value of <emphasis role="italic">byPos</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource <xref linkend="sctMenuItemIDs"/> of the submenu to be inserted. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>pop [required]</term>
    <listitem>
    <para>
      The <xref linkend="clsPopupMenu"/> object being inserted.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>txt [required]</term>
    <listitem>
    <para>
      The text, the label, for the new submenu.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>state [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. These specify the
      state of the new submenu. If this argument is omitted or the empty string the state is set to ENABLED UNHILITE
      NOTDEFAULT:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>DEFAULT   </member>
        <member>DISABLED  </member>
        <member>ENABLED   </member>
        <member>GRAYED    </member>
        <member>HILITE    </member>
        <member>NOTDEFAULT</member>
        <member>UNHILITE  </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>DEFAULT</term>
        <listitem>
        <para>
          The submenu is the default menu item. Only one item in any menu can be the default item.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DISABLED</term>
        <listitem>
        <para>
          The summenu is disabled. Disabled and grayed are exactly the same thing.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ENABLED</term>
        <listitem>
        <para>
          The submenu is not disabled. This keyword does not need to be specified. If neither DISABLED nor GRAYED are
          specified, the submenu is automatically enabled
        </para>
        </listitem></varlistentry>
        <varlistentry><term>GRAYED</term>
        <listitem>
        <para>
          The submenu is disabled. Disabled and grayed are exactly the same thing.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HILITE</term>
        <listitem>
        <para>
          The submenu is high lighted, that is, it is drawn with the selected appearance.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTDEFAULT</term>
        <listitem>
        <para>
          The submenu is not the default menu item. This keyword does not need to be specified. If DEFAULT is not
          specified, the submenu is automatically not the default menu item.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>UNHILITE</term>
        <listitem>
        <para>
          The submenu is not high lighted, that is, it is not drawn with the selected state. This keyword does not need
          to be specified, if the HILITE keyword is omitted, the NOHILITE state is set automatically.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>type [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. These specify the type
      of the new submenu. If this argument is omitted or the empty string then no special type is set:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>RIGHTJUSTIFY</member>
        <member>RIGHTORDER  </member>
        <member>MENUBARBREAK</member>
        <member>MENUBAR     </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>RIGHTJUSTIFY</term>
        <listitem>
        <para>
          Right-justifies the submenu and any subsequent items. This value is valid only if the submenu is in a menu
          bar. It has no effect if the item is in a popup menu.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RIGHTORDER</term>
        <listitem>
        <para>
          Specifies that menus cascade right-to-left (the default is left-to-right). This is used to support
          right-to-left languages, such as Arabic and Hebrew.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MENUBARBREAK</term>
        <listitem>
        <para>
          Places the submenu on a new line (for a menu bar) or in a new column (for a drop-down menu, submenu, or
          shortcut menu). For a drop-down menu, submenu, or shortcut menu, a vertical line separates the new column from
          the old.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MENUBREAK</term>
        <listitem>
        <para>
          This is exactly the same as MENUBARBREAK, except that no vertical line is drawn between the columns when the
          submenu is not in a menu bar.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">idBefore</emphasis> is a positional ID,
      otherwise it is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the submenu is inserted into the menu, if there are no other items in the menu there is no ID for the
    <emphasis role="italic">before</emphasis> argument. In this case the programmer can use any positive number and the
    operating system will accept it. The ooDialog examples commonly use the same ID for both the <emphasis
    role="italic">idBefore</emphasis> and <emphasis role="italic">id</emphasis> arguments for this case. 1 is also a good
    choice for the <emphasis role="italic">idBefore</emphasis> argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the start of the creation of a binary menubar. First a new empty menubar is instantiated. Then a
    new popup menu is instantiated with the resource id of IDM_HELP. One menu item is inserted into the popup menu, and
    the popup menu is inserted into the menubar. Note that the menubar at this point does not have any menu items, so
    there is no menu item for the <emphasis role="italic">idBefore</emphasis> argument. In this case the operating
    system does not seem to care what number is used for the <emphasis role="italic">idBefore</emphasis> argument. The
    examples in ooDialog generally will use the same ID as the ID of the menu item being inserted:
<programlisting>
<![CDATA[

  menu = .BinaryMenuBar~new(.nil, IDM_MENUBAR, , self)

  subMenu = .PopupMenu~new(IDM_HELP))
  subMenu~insertItem(IDM_ITEM_ABOUT, IDM_ITEM_ABOUT, "About")

  menu~insertPopup(IDM_HELP, IDM_HELP, subMenu, "Help", , 'RIGHTJUSTIFY')

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::insertPopup() -->

<section id="mthInsertSeparator" xreflabel="insertSeparator"><title>insertSeparator</title>
<indexterm><primary>insertSeparator</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>insertSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insertSeparator(--idBefore-,-id--+---------+--)-------------><
                                     +-,-byPos-+
]]>
</programlisting>

<para>
  Inserts a separator into this menu at the specified position.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>idBefore [required]</term>
    <listitem>
    <para>
      The new separator is inserted before the item with this <xref linkend="sctMenuItemIDs"/>. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPos</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource <xref linkend="sctMenuItemIDs"/> of the separator to be inserted. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">idBefore</emphasis> is a positional ID,
      otherwise it is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the separator is inserted into the menu, if there are no other items in the menu there is no ID for the
    <emphasis role="italic">before</emphasis> argument. In this case the programmer can use any positive number and the
    operating system will accept it. The ooDialog examples commonly use the same ID for both the <emphasis
    role="italic">idBefore</emphasis> and <emphasis role="italic">id</emphasis> arguments for this case. 1 is also a good
    choice for the <emphasis role="italic">idBefore</emphasis> argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example creates a new popup menu and inserts several menu items, including a separator:
<programlisting>
<![CDATA[

  subMenu = .PopupMenu~new(IDM_POP_FILE)

  subMenu~insertItem(IDOK, IDOK, "Exit")
  subMenu~insertItem(IDOK, IDM_MI_LEAVE, "Leave")
  subMenu~insertItem(IDM_MI_LEAVE, IDM_MI_TEST_ITEM, "Test Item")
  subMenu~insertItem(IDM_MI_LEAVE, IDM_MI_CONTEXT, "Context")
  subMenu~insertSeparator(IDM_MI_LEAVE, IDM_SEPARATOR)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::insertSeparator() -->

<section id="mthIsCheckedMenu" xreflabel="isChecked"><title>isChecked</title>
<indexterm><primary>isChecked</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>isChecked</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isChecked(--id--+---------------+--)---------><
                    +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is checked.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to determine the checked status of. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu item is checked, othewise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method raises a syntax condition on any failure, since there is no way to indicate failure in the
    return. The syntax condition will indicate why the method failed. If the failure was a Win32 API failure, the error
    text will contain the value of the <xref linkend="dotSystemErrorCode"/> so that the
    programmer can determine the cause of the failure. However, it is very unlikely that the Win32 API will fail. The
    more common cause of a failure would be the use of an invalid symbolic ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isChecked() -->

<section id="mthIsCommandItem" xreflabel="isCommandItem"><title>isCommandItem</title>
<indexterm><primary>isCommandItem</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isCommandItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isCommandItem(--id--+---------------+--)-----><
                        +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is command menu item, that is if the menu item is one that a user would expect
  to carry out a command.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to determine if it is a command item. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu item is a command menu item, othewise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method raises a syntax condition on any failure, since there is no way to indicate failure in the
    return. The syntax condition will indicate why the method failed. If the failure was a Win32 API failure, the error
    text will contain the value of the <xref linkend="dotSystemErrorCode"/> so that the
    programmer can determine the cause of the failure. However, it is very unlikely that the Win32 API will fail. The
    more common cause of a failure would be the use of an invalid symbolic ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isCommandItem() -->

<section id="mthIsDisabled" xreflabel="isDisabled"><title>isDisabled</title>
<indexterm><primary>isDisabled</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isDisabled</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isDisabled(--id--+---------------+--)--------><
                     +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is disabled or not.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to determine if it is disabled. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu item is disabled, othewise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method raises a syntax condition on any failure, since there is no way to indicate failure in the
    return. The syntax condition will indicate why the method failed. If the failure was a Win32 API failure, the error
    text will contain the value of the <xref linkend="dotSystemErrorCode"/> so that the
    programmer can determine the cause of the failure. However, it is very unlikely that the Win32 API will fail. The
    more common cause of a failure would be the use of an invalid symbolic ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isDisabled() -->

<section id="mthIsEnabledClsMenu" xreflabel="isEnabled"><title>isEnabled</title>
<indexterm><primary>isEnabled</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>isEnabled</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isEnabled(--id--+---------------+--)---------><
                    +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is enabled or not.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to determine if it is enabled. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu item is enabled, othewise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method raises a syntax condition on any failure, since there is no way to indicate failure in the
    return. The syntax condition will indicate why the method failed. If the failure was a Win32 API failure, the error
    text will contain the value of the <xref linkend="dotSystemErrorCode"/> so that the
    programmer can determine the cause of the failure. However, it is very unlikely that the Win32 API will fail. The
    more common cause of a failure would be the use of an invalid symbolic ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isEnabled() -->

<section id="mthIsGrayed" xreflabel="isGrayed"><title>isGrayed</title>
<indexterm><primary>isGrayed</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isGrayed</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isEnabled(--id--+---------------+--)---------><
                    +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is grayed or not.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to determine if it is grayed. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu item is grayed, othewise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method raises a syntax condition on any failure, since there is no way to indicate failure in the
    return. The syntax condition will indicate why the method failed. If the failure was a Win32 API failure, the error
    text will contain the value of the <xref linkend="dotSystemErrorCode"/> so that the
    programmer can determine the cause of the failure. However, it is very unlikely that the Win32 API will fail. The
    more common cause of a failure would be the use of an invalid symbolic ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isGrayed() -->

<section id="mthIsPopup" xreflabel="isPopup"><title>isPopup</title>
<indexterm><primary>isPopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isPopup(--id--+---------------+--)-----------><
                  +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is a submenu (a pop up menu.)
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to be queried. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if the menu item is a pop up menu item, otherwise
    <computeroutput>.false</computeroutput> .
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method raises a syntax condition on any failure, since there is no way to indicate failure in the
    return. The syntax condition will indicate why the method failed. If the failure was a Win32 API failure, the error
    text will contain the value of the <xref linkend="dotSystemErrorCode"/> so that the
    programmer can determine the cause of the failure. However, it is very unlikely that the Win32 API will fail. The
    more common cause of a failure would be the use of an invalid symbolic ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      Sets the <xref linkend="dotSystemErrorCode"/>.
    </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isPopup() -->

<section id="mthIsSeparator" xreflabel="isSeparator"><title>isSeparator</title>
<indexterm><primary>isSeparator</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isSeparator(--id--+---------------+--)-------><
                      +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if the specified menu item is a separator.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item to be queried. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if the menu item is a separator menu item, otherwise
    <computeroutput>.false</computeroutput> .
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method raises a syntax condition on any failure, since there is no way to indicate failure in the
    return. The syntax condition will indicate why the method failed. If the failure was a Win32 API failure, the error
    text will contain the value of the <xref linkend="dotSystemErrorCode"/> so that the
    programmer can determine the cause of the failure. However, it is very unlikely that the Win32 API will fail. The
    more common cause of a failure would be the use of an invalid symbolic ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
    <para>
      Sets the <xref linkend="dotSystemErrorCode"/>.
    </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isSeparator() -->

<section id="mthIsValidItemID" xreflabel="isValidItemID"><title>isValidItemID</title>
<indexterm><primary>isValidItemID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isValidItemID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isValidItemID(--id--+---------------+--)---------><
                        +-,-byPosition--+
]]>
</programlisting>

<para>
  Determines if a specific menu item <xref linkend="sctMenuItemIDs"/> is valid for this menu and if one of the
  <emphasis role="italic">is*</emphasis> methods, <xref linkend="mthIsCheckedMenu"/>, <xref linkend="mthIsPopup"/>, etc., is
  likely to fail.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The menu item ID to check.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If the item ID is a resource ID or a positional ID. The default is false, a resource ID. Use true if the ID is a
      positional ID.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True if the id is valid for the menu and if one of the <emphasis role="italic">is*</emphasis> methods is likely to
    succeed, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In most of the methods for the Menu classes, if an invalid item ID is specified, the method will fail and the
    <xref linkend="dotSystemErrorCode"/> is set to the failure reason. However, in some methods
    there is no way to indicate that the method failed. For those methods, a syntax error is raised if the item ID is
    not valid.
  </para>
  <para>
    The <emphasis role="italic">isValidItemID</emphasis> method can be used by the programmer to check if an item ID
    will raise a syntax error. The method also checks if the Win32 API used for a method succeeds. This allows the
    <emphasis role="italic">defensive</emphasis> programmer a way to check if a condition is going to be raised by
    invoking one of the <emphasis role="italic">is*</emphasis> methods before invoking it.
  </para>
  <para>
    However, a failure of the Win32 API is extremely unlikely and using an invalid menu id is easily fixed. Indeed,
    letting a syntax condition be raised for an invalid menu id is usually the best practice. The syntax condition will
    point out the incorrect id early in the development of an ooDialog program. Once fixed, the error will never happen
    again.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a method implemented by an overly-paranoid programmer as a replacement method for the
 <xref linkend="mthIsSeparator"/> method.
<programlisting>
<![CDATA[

::method isMenuSeparator private
  use strict arg menu, id, byPosition

  if menu~isValidItemID(id) then do
    if menu~isSeparator(id, byPosition) then return .true
    else return .false
  end

  -- Not a valid item id
  msg =   'The menu id:' id 'with byPosition value:' byPosition 'is ' || .endOfLine          -
          'not valid.'                                                || endOfLine~copies(2) -
          'Continue?'

  title = 'Invalid Menu Item ID Discovered'

  ret = MessageDialog(msg, self~hwnd, title, 'YESNO', 'ERROR', 'DEFBUTTON2')
  if ret == self~IDNO then do
    self~cancel:super
    return .false
  end

  return .false

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isValidItemID() -->

<section id="mthIsValidMenu" xreflabel="isValidMenu"><title>isValidMenu</title>
<indexterm><primary>isValidMenu</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isValidMenu</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isValidMenu--------------------------------------><

]]>
</programlisting>

<para>
  Checks if this menu is valid. This menu would not be valid if it has been
 <xref linkend="mthDestroyClsMenu"/> or <xref linkend="mthReleaseMenuHandle"/>. In addition, the
  menu could no longer be valid for some operating system reason, although this is highly unlikely.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu is valid, otherwise false.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::isValidMenu() -->

<section id="mthIsValidMenuHandle" xreflabel="isValidMenuHandle"><title>isValidMenuHandle</title>
<indexterm><primary>isValidMenuHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>isValidMenuHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isValidMenuHandle(--handle--)--------------------><

]]>
</programlisting>

<para>
  Given a <xref linkend="defHandle"/>, determines if the handle is a menu handle and, if it is, if the menu
  is still valid.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>handle</term>
    <listitem>
    <para>
      The handle to check if it is a valid menu handle.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True if <emphasis role="italic">handle</emphasis> is the handle of a valid menu, otherwise false.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::isValidMenuHandle() -->

<section id="mthItemTextToMethodName" xreflabel="itemTextToMethodName"><title>itemTextToMethodName</title>
<indexterm><primary>itemTextToMethodName</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>itemTextToMethodName</secondary></indexterm>
<programlisting>
<![CDATA[
>>--itemTextToMethodName(--text--)---------------><

]]>
</programlisting>

<para>
  Converts <emphasis role="italic">text</emphasis> to a method name as if <emphasis role="italic">text</emphasis> were
  the text of a menu command item. This method can be used as a debugging helper if the programmer has difficulty in
  determining what method name the ooDialog framework is constructing when automatically
  <link linkend="sctMenuCommandEventConnections">connecting</link>/> menu command items.
</para>
<para>
  The ooDialog framework constructs a method name from a string in this way: All space, tab, ampersand, colon, and plus
  characters are removed from the string. In addition any trailing periods are remove from the string. The remaining
  string is used as the method name.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text string to be converted to a method name. This can not be the empty string.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The method name the ooDialog framework would construct from <emphasis role="italic">text</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    In the menu classes there are a number of methods that connect <xref linkend="sctMenuCommandEvents"/>s to a method in the
    Rexx dialog. Most of these methods will automatically construct the connected method name if the programmer does not
    specify a method name. The name is constructed based on the text of the menu command item that is being connected.
  </para>
  <para>
    Sometimes, it may be difficult for the programmer to know what the constructed name is going to be. For instance,
    with a compiled binary menu, the programmer might need to look at the original resource script. Or, the programmer
    may not recall exactly what the rules are for constructing the name. This method can help in those situations by
    returning the method name that would be constructed. The programmer could add some quick debug code that printed the
    name to the screen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a debugging method that could be temporarily added to a dialog with a menu to determine what
    method name would be constructed for any menu command item:
<programlisting>
<![CDATA[

  ::method printMethodName private
    use strict arg menu, itemID

    text = menu~getText(itemID)
    name = menu~itemTextToMethodName(text)

    say 'The constructed method name for this menu item:'
    say '  Item ID:  ' itemID
    say '  Item Text:' text
    say '  Method:   ' name
    say

  return name

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::itemTextToMethodName() -->

<section id="mthReleaseMenuHandle" xreflabel="releaseMenuHandle"><title>releaseMenuHandle</title>
<indexterm><primary>releaseMenuHandle</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>releaseMenuHandle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--releaseMenuHandle(--handle--)---------------------------------------------><

]]>
</programlisting>

<para>
  Releases (frees) the operating system resources used by a menu. The menu is specified by its Windows
  <xref linkend="defHandle"/>. To release the operating system resources for an ooDialog
  <computeroutput>Menu</computeroutput> object, use the <xref linkend="mthDestroyClsMenu"/>() method.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>handle [required]</term>
    <listitem>
    <para>
      The handle of the menu to release. The handle must not be null.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true for success, false for failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When the operating system frees the system resource used by a menu, that menu is no longer valid. If there is a Rexx
    menu object that represents the menu specified by the <emphasis role="italic">handle</emphasis> argument then the
    Rexx object's menu will no longer be valid. In general, the Rexx programmer will not have much, if any, use for
    this method. It is provided for completeness. Normally, the <xref linkend="mthDestroyClsMenu"/> method
    will be used.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::releaseMenuHandle() -->

<section id="mthRemoveItem" xreflabel="removeItem"><title>removeItem</title>
<indexterm><primary>removeItem</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>removeItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removeItem(--id--+---------------+--)--------><
                     +-,-byPosition--+
]]>
</programlisting>

<para>
  Removes (deletes) the specified menu command item from this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu command item to remove. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The specified menu item is not a menu command
        item.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from an application that removes the Copy and Cut menu items from its menubar when there is
    currently no selected text. (A more common approach for this situation is to disable the two menu items.)
<programlisting>
<![CDATA[

::method prepareMenu private
  expose menuBar

  ...
  if \ self~selectedText then do
    menuBar~removeItem(IDM_MI_COPY)
    menuBar~removeItem(IDM_MI_CUT)
  end

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::removeItem() -->

<section id="mthRemovePopup" xreflabel="removePopup"><title>removePopup</title>
<indexterm><primary>removePopup</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>removePopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removePopup(--id--+---------------+--)-------><
                      +-,-byPosition--+
]]>
</programlisting>

<para>
  Removes, but does not delete, the specified popup menu from the menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the submenu to remove. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the specified submenu on success, 0 on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a popup menu (a submenu) is deleted, the operating system frees all resources used by the popup menu and any
    references to the popup are no longer valid. On the other hand, the <emphasis role="italic">removePopup</emphasis>
    method removes the specified submenu and returns it. The operating system resources are not freed and the returned
    submenu is still valid.
  </para>
  <para>
    The returned submenu can then be used in any number of ways, as a context menu, it can be inserted into some other
    menu, or even reinserted back into the menu it was removed from. If the removed submenu is no longer needed by the
    application, then the <xref linkend="mthDeletePopup"/> method can be used instead of <emphasis
    role="italic">removePopup</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The specified menu item is not a popup menu.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example uses a context menu that is gotten from a menubar. Since the menubar is not used in the application, it
    is just the source for the context menu, the menubar is destroyed after the context menu is removed:
<programlisting>
<![CDATA[

  dlgPopup = menubar~removePopup(1, .true)

  -- Start with the menu item to enable the list view greyed out.
  dlgPopup~disable(IDM_RC_ENABLE_LV)

  menuBar~destroy

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::removePopup() -->

<section id="mthRemoveSeparator" xreflabel="removeSeparator"><title>removeSeparator</title>
<indexterm><primary>removeSeparator</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>removeSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removeSeparator(--id--+---------------+--)---><
                          +-,-byPosition--+
]]>
</programlisting>

<para>
  Removes (deletes) the specified menu separator from this menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the submenu to remove. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The specified menu item is not a separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example, if there is no text selected the Cut and Copy menu items are removed from the menu. If there is no
    data on the clipboard then the Paste menu item is removed. Above and below those 3 menu items are separators. If all
    3 menu items are removed then the separators are also removed.
<programlisting>
<![CDATA[

::method prepareMenu private
  expose menuBar
  ...

  noSelection = .false
  noClipboard = .false

  if \ self~selectedText then do
    noSelection = .true
    menuBar~removeItem(IDM_MI_COPY)
    menuBar~removeItem(IDM_MI_CUT)
  end

  if \ self~hasClipboardData then do
    noClipboard = .true
    menuBar~removeItem(IDM_MI_PASTE)
  end

  if noSelection & noClipboard then do
    menuBar~removeSeparator(IDM_MI_SEPARATOR_TOP)
    menuBar~removeSeparator(IDM_MI_SEPARATOR_BOTTOM)
  end

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::removeSeparator() -->

<section id="mthSetAutoConnection" xreflabel="setAutoConnection"><title>setAutoConnection</title>
<indexterm><primary>setAutoConnection</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setAutoConnection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setAutoConnection(--onOff--+----------+--)---><
                               +-,-mName--+
]]>
</programlisting>

<para>
  Set the current status of <xref linkend="varAutoConnection"/>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>onOff [required]</term>
    <listitem>
    <para>
      True to set autoconnection on, false to turn it off.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mName [optional]</term>
    <listitem>
    <para>
      This argument is ignored unless <emphasis role="italic">onOff</emphasis> is true. If so the <emphasis
      role="italic">mName</emphasis> argument can be used to change the current autoconnection method name.
    </para>
    <para>
      When the autoconnection method name is not set, then when auto connection is done, the name of the connected
      method for each menu command item is composed from the menu item
 <xref linkend="mthItemTextToMethodName"/>. On the other hand, if the autoconnection method name is set, then
      each menu command item is connected to the same method, which is the autoconnection method name.
    </para>
    <para>
      When the <emphasis role="italic">setAutoConnection</emphasis> method is used to turn autoconnection on, if the
      <emphasis role="italic">mName</emphasis> argument is omitted, then no change is made to the current setting for
      the autoconnection method name. If <emphasis role="italic">mName</emphasis> is the empty string, then the
      autoconnection method name, if there is one, is removed. If <emphasis role="italic">mName</emphasis> is not
      ommitted and not the empty string, then the autoconnection method name is set to <emphasis
      role="italic">mName</emphasis>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error. An error is unlikely.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When <emphasis role="italic">setAutoConnection</emphasis> is used to turn autoconnection off, the autoconnection
    method name, if there is one, is always removed. If autoconnection is later turned on, and an autoconnection method
    name is desired, it will have to be specified.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example turns autoconnection on and sets the autoconnection method name to onSelect. Thus, when autoconnection
    is done, every menu command item in the menu will be connected to the onSelect method:
<programlisting>
<![CDATA[
  menuBar~setAutoConnection(.true, onSelect)
]]>
</programlisting>
  </para>
  <para>
    This example turns autoconnection off:
<programlisting>
<![CDATA[
  menuBar~setAutoConnection(.false)
]]>
</programlisting>
  </para>
  <para>
    This example assumes autoconnection is already on, with the autoconnection method name set. However, the programmer
    now wants each menu command item connected to an individual method in the dialog. That is, the programmer wants the
    autoconnection method name removed:
<programlisting>
<![CDATA[
  menuBar~setAutoConnection(.true, '')
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setAutoConnection() -->

<section id="mthSetHelpID" xreflabel="setHelpID"><title>setHelpID</title>
<indexterm><primary>setHelpID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setHelpID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setHelpID(--id--+------------+--)------------><
                    +-,-recurse--+
]]>
</programlisting>

<para>
  Sets the Help context identifier for the this menu, and optionally all submenus.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The help <xref linkend="sctMenuItemIDs"/> to be set. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>recurse [optional]</term>
    <listitem>
    <para>
      If true, set the id for this menu and all submenus of this menu. The default is false.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success and false on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Associated with each menubar, menu, submenu, and shortcut menu is a help identifier. If the user presses the F1 key
    while the menu is active, this value is sent to the owner window as part of the Windows
 <xref linkend="mthConnectHelp"/> event notification. The menu help ID is sent to the event handler as the first
    argument, the <emphasis role="italic">id</emphasis> argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the help ID for 3 of the submenus in a menubar. Since none of the submenus have submenus, the
    <emphasis role="italic">recurse</emphasis> argument is omitted. The application uses symbolic IDs for all resource
    IDs:
<programlisting>
<![CDATA[

  ...
  menuBar~getPopup(IDM_POP_FILE)~setHelpID(IDM_HELP_FILE)
  menuBar~getPopup(IDM_POP_EDIT)~setHelpID(IDM_HELP_EDIT)
  menuBar~getPopup(IDM_POP_VIEW)~setHelpID(IDM_HELP_VIEW)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setHelpID() -->

<section id="mthSetID" xreflabel="setID"><title>setID</title>
<indexterm><primary>setID</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setID(--id-,-newID--+--------------+--)------><
                        +-,-byPosition-+
]]>
</programlisting>

<para>
  Sets or resets the resource ID of the specified menu item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item whose resource ID is to be set. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>newID [required]</term>
    <listitem>
    <para>
      The new resource ID for the specified menu item. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <emphasis role="bold"><computeroutput>.true</computeroutput></emphasis>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">setID</emphasis> method would usually be done using a by position ID to specify the menu
    item. Maybe to set the ID of a menu item that does not have an ID. However, the method could also be used to change
    the existing ID of an item. For this reason, the menu item can be specified by resource ID.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Menu::setID() -->

<section id="mthSetMaxHeight" xreflabel="setMaxHeight"><title>setMaxHeight</title>
<indexterm><primary>setMaxHeight</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>setMaxHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setMaxHeight(--height--+------------+--)-----><
                           +-,-recurse--+
]]>
</programlisting>

<para>
  Sets the maximum height for this menu, and optionally all submenus.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>height [required]</term>
    <listitem>
    <para>
      The maximum height, in pixels, for this menu. Use zero to revert the height back to the system default, which is
      the height of the screen.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>recurse [optional]</term>
    <listitem>
    <para>
      If true, set the height for this menu and all submenus of this menu. The default is false.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a menu reaches the maximum height, scroll bars are automatically added. The default height is the height of
    the screen.  To revert back to the defualt height, specify 0 for the <emphasis role="italic">height</emphasis>
    argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the current maximum height of the File drop down menu and checks if it is equal to the height
    of the dialog. If not, it changes the maximum height to the height of the dialog:
<programlisting>
<![CDATA[

::method checkHeight private
  expose menuBar

  size = self~getRealSize

  filePopup = menuBar~getPopup(IDM_FILE)
  if filePopup~getMaxHeight <> size~height then filePopup~setMaxHeight(size~height)

  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setMaxHeight() -->

<section id="mthSetTextClsMenu" xreflabel="setText"><title>setText</title>
<indexterm><primary>setText</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>setText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setText(--id--,--text--+---------------+--)--><
                           +-,-byPosition--+
]]>
</programlisting>

<para>
  Sets the text of the specified menu item. Separator menu items do not have text.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The <xref linkend="sctMenuItemIDs"/> of the menu item whose text is being set. May be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a position ID or a resource ID, depending on
      the value of <emphasis role="italic">byPosition</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text for the menu item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If <computeroutput>.true</computeroutput>, <emphasis role="italic">id</emphasis> is a positional ID, otherwise it
      is a resource ID. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success and false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The specified menu item is a separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::setText() -->

<section id="mthUncheckClsMenu" xreflabel="uncheck"><title>uncheck</title>
<indexterm><primary>uncheck</primary><secondary>menu object</secondary></indexterm>
<indexterm><primary>menu object</primary><secondary>uncheck</secondary></indexterm>
<programlisting>
<![CDATA[
>>--uncheck(--IDs--+--------------+--)-----------><
                   +-,-byPosition-+
]]>
</programlisting>

<para>
  Unchecks one or more menu items. Separators can not be checked.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>IDs [required]</term>
    <listitem>
    <para>
      The item <xref linkend="entMenuItemIdentifier"/> to be unchecked, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a single ID or a collection of IDs.  The
      ID(s) can be position IDs or resource IDs, depending on the value of <emphasis
      role="italic">byPosition</emphasis>. However, if this is a collection of IDs there must be all the same type, all
      resource IDs or all position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To uncheck more than 1 menu item at a time, use a collection object, such as an
    <computeroutput>array</computeroutput>, where each item in the collection is the menu item ID of the item to be
    checked.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified to be unchecked is a
        separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is from an editor application that has a hexadecimal view of the text. The user can switch back and
    forth between the hexadecimal and normal views using the menu item with the text of <emphasis
    role="italic">hex</emphasis>. When the user selects the menu item, the view is toggled. A check mark by the menu
    item shows it is in hex view, when there is no check mark the view is normal:
<programlisting>
<![CDATA[

::method initDialog
  expose inHex

  inHex = .false
  ...

::method onHexSelect unguarded
  expose menuBar inHex

  if inHex then do
    inHex = .false
    menuBar~uncheck(IDM_HEX_VIEW)
    self~switchToAscii
  end
  else do
    inHex = .true
    menuBar~check(IDM_HEX_VIEW)
    self~switchToHex
  end

  return 0

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::uncheck() -->

<section id="mthUnhilite" xreflabel="unhilite"><title>unhilite</title>
<indexterm><primary>unhilite</primary></indexterm>
<indexterm><primary>menu object</primary><secondary>unhilite</secondary></indexterm>
<programlisting>
<![CDATA[
>>--unhilite(--IDs--+--------------+--)-----------><
                    +-,-byPosition-+
]]>
</programlisting>

<para>
  Removes the high light from one or more menu items. Separators can not be high lighted. A high lighted menu item is
  drawn as though it were the selected item.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>IDs [required]</term>
    <listitem>
    <para>
      The menu item <xref linkend="entMenuItemIdentifier"/> whose high light is to be removed, may be
      <xref linkend="itmMenuSymbolicIDs"/> or numeric. This can be a single ID or a collection of IDs.  The
      ID(s) can be position IDs or resource IDs, depending on the value of <emphasis
      role="italic">byPosition</emphasis>. However, if this is a collection of IDs there must be all the same type, all
      resource IDs or all position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the item IDs are positional IDs, otherwise they are resource IDs. The default is false, resource IDs.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    To remove the high light from more than 1 menu item at a time, use a collection object, such as an
    <computeroutput>array</computeroutput>, where each item in the collection is the menu item ID of the item whose high
    light will be removed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu item specified to have its high light
        removed is a separator.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu object::unhilite() -->

</section>  <!-- End Menu class -->


<section id="clsMenuBar" xreflabel="MenuBar"><title>The Menu Bar Object</title>
<indexterm><primary>MenuBar class</primary></indexterm>
<indexterm><primary>The MenuBar Object</primary></indexterm>
<indexterm><primary>menu bar object</primary></indexterm>
<para>
  A menu bar is often called the top-level menu. It is the bar positioned just below the title bar of an application
  window or a dialog. The menu bar object is used, like the <xref linkend="clsMenu"/>,
  <xref linkend="chpDialogObject"/>, and dialog <xref linkend="chpDialogControlObject"/> objects as an
  abstract concept to document the ooDialog menu objects that represent menu bars. The menu bar classes in ooDialog are
  the <xref linkend="clsBinaryMenuBar"/>, <xref linkend="clsUserMenuBar"/>, and
 <xref linkend="clsScriptMenuBar"/> classes.
</para>
<para>
  The menu bar object is implemented through the <computeroutput>MenuBar</computeroutput> mixin class and all menu bars
  have the methods of the <computeroutput>MenuBar</computeroutput> class. Similar to the menu object, the menu bar
  object is essentially the <computeroutput>MenuBar</computeroutput> mixin class. Note that menu bars <emphasis
  role="italic">are</emphasis> menus. All menu bar objects have all the methods of the
 <xref linkend="clsMenu"/> object in addition to the methods specific to the menu bar.
</para>

<section id="sctMethodsMenuBar"><title>Method Table</title>
<para>
  The following table lists the instance methods of the menu bar object.
<table id="tblMethodsMenuBar" frame="all"> <title>MenuBar Object Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="mthAttachTo"/></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><xref linkend="mthDetach"/></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><xref linkend="mthIsAttached"/></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawClsMenu"/></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><xref linkend="mthReplace"/></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthAttachTo" xreflabel="attachTo"><title>attachTo</title>
<indexterm><primary>attachTo</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>attachTo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--attachTo(--dlg--)--------------------------------><

]]>
</programlisting>

<para>
  Attaches this menu bar to the specified dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>The only argument is:
  <variablelist>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The Rexx dialog the menu bar is to be attached to.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
    <para>
      True on success, false for failure.
    </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If auto <xref linkend="sctMenuCommandEventConnections"/>s is turned on, (this can be checked through the <xref
    linkend="mthGetAutoConnectStatus"/> method,) then all menu command items are connected to a method in the <emphasis
    role="italic">dlg</emphasis> dialog at this time.
  </para>
  <para>
    A menu bar can only be attached to a dialog after the <xref linkend="ovvUnderlying"/> dialog exists.
    A menu bar can only be attached to one dialog, and a dialog can only have one menu bar attached to it. If any of
    these conditions are not met, this method fails.
  </para>
  <para>
    If this menu bar is already attached to a dialog and needs to be attached to a different dialog, first use the
 <xref linkend="mthDetach"/> method to detach it. Then attach it to the other dialog. On the other hand, if the
    dialog already has a menu bar attached to it and this menu bar needs to be attached to that dialog get a reference
    to the dialog's current menu bar and use the <xref linkend="mthReplace"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu is already attached to a dlg.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> Some menu
        items were not connected because the message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_HANDLE (1400)</term>
      <listitem>
      <para>
        Invalid window handle. <emphasis role="bold">Meaning:</emphasis> The underlying Windows dialog does not exist
        for the specified <emphasis role="italic">dlg</emphasis> argument.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis>  This menu has been destroyed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a dialog object.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_STYLE (2002)</term>
      <listitem>
      <para>
        The window style or class attribute is invalid for this operation. <emphasis role="bold">Meaning:</emphasis>
        The <emphasis role="italic">dlg</emphasis> argument is already attached to a menu bar.
      </para>
      <para>
        When this method returns false, the menu is not attached to a dialog, except in one circumstance. If the
        <computeroutput>.systemErrorCode</computeroutput> is ERROR_NOT_ENOUGH_MEMORY, then the menu is attached to the
        dialog, but some menu items were not connected.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example attaches a dialog's menu bar in the <emphasis role="italic">initDialog</emphasis> method. In the
    example, the menu bar was instantiated previously, and saved in an instance variable:
<programlisting>
<![CDATA[

::method initDialog
  expose menuBar

  menuBar~attachTo(self)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MenuBar::attachTo() -->

<section id="mthDetach" xreflabel="detach"><title>detach</title>
<indexterm><primary>detach</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>detach</secondary></indexterm>
<programlisting>
<![CDATA[
>>--detach---------------------------------------><

]]>
</programlisting>

<para>
  Detaches this menu bar from its assigned dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu bar is not attached to a dialog.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example detaches the menu bar from the dialog and destroys it as it is no longer needed in the application:
<programlisting>
<![CDATA[

  ...
  menuBar~detach
  menuBar~destroy
  ...
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu bar object::detach() -->

<section id="mthIsAttached" xreflabel="isAttached"><title>isAttached</title>
<indexterm><primary>isAttached</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>isAttached</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isAttached-----------------------------------><

]]>
</programlisting>

<para>
  Determines if this menu bar is currently attached to a dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if this menu bar is attached to a dialog, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>. There are no errors that could changes
    the value from 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu  bar object::isAttached() -->

<section id="mthRedrawClsMenu" xreflabel="redraw"><title>redraw</title>
<indexterm><primary>redraw</primary><secondary>menu bar object</secondary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>redraw</secondary></indexterm>
<programlisting>
<![CDATA[
>>--redraw---------------------------------------><

]]>
</programlisting>

<para>
  Tells the dialog this menu bar is attached to, to redraw the menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu bar is not attached to a dialog.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu bar object::redraw() -->

<section id="mthReplace" xreflabel="replace"><title>replace</title>
<indexterm><primary>replace</primary></indexterm>
<indexterm><primary>menu bar object</primary><secondary>replace</secondary></indexterm>
<programlisting>
<![CDATA[
>>--replace(--newMenuBar--)----------------------><

]]>
</programlisting>

<para>
  If this menu bar is attached to a dialog, the menu bar for the dialog is replaced by the specified menu bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>newMenuBar [required]</term>
    <listitem>
    <para>
      The new menu bar for the dialog this menu bar is attached to.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the menu bar that was previously attached to the dialog, which of course is this menu bar. On
    error the <computeroutput>.Nil</computeroutput> object is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on error. In addition to error codes set by the
    operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> This menu bar is not attached to a dialog.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from a program that uses 2 completely different menu bars depending on if the application is in
    edit or view mode. When the mode is switched, the menu bar is replaced by the appropriate one for the mode:
<programlisting>
<![CDATA[

::method onToggleMode
  expose fileMenu viewMenu currentMode

  if currentMode == 'Edit' then do
    fileMenu~replace(viewMenu)
    currentMode = 'View'
  end
  else do
    viewMenu~replace(fileMenu)
    currentMode = 'Edit'
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End menu bar Object::replace() -->

</section>  <!-- End MenuBar class -->


<section id="clsBinaryMenuBar" xreflabel="BinaryMenuBar"><title>BinaryMenuBar Class</title>
<indexterm><primary>BinaryMenuBar class</primary></indexterm>
<para>
  A <computeroutput>BinaryMenuBar</computeroutput> is a menu <xref linkend="clsMenuBar"/> whose menu template
  comes from a compiled binary resource, or whose menu template is constructed as an empty menu.
</para>
<para>
  The ooDialog framework provides three basic types of menu bars. The only difference in the three types is the source
  of the menu template for the menu bar. In a <xref linkend="clsScriptMenuBar"/> the source of the
  menu template is a resource <xref linkend="defResourceScript"/> file (usually a .rc file) that ooDialog parses and
  uses to construct the menu template. For an <xref linkend="clsUserMenuBar"/>, ooDialog constructs the
  menu template dynamically from method invocations in the program code.
</para>
<para>
  In general it is much easier to dynamically construct the menu template by starting with an empty
  <computeroutput>BinaryMenuBar</computeroutput> and inserting the desired menu items than it is to define the menu
  template in an <computeroutput>UserMenuBar</computeroutput>.
</para>

<section id="sctMethodsBinaryMenuBar"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>BinaryMenuBar</computeroutput>. For
  convenience, the inherited methods from the <xref linkend="clsMenuBar"/> mixin class are also listed
  here. Note that the <computeroutput>BinaryMenuBar</computeroutput> <emphasis role="italic">is</emphasis> a menu and
  therefore also contains all the methods of the <xref linkend="clsMenu"/> class.
<table id="tblMethodsBinaryMenuBar" frame="all"> <title>Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="mthNewClsBinaryMenuBar"/></entry>
<entry>Instantiates a new binary menu bar object.</entry>
</row>
<row>
<entry><xref linkend="mthAttachTo"/></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><xref linkend="mthDetach"/></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><xref linkend="mthIsAttached"/></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawClsMenu"/></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><xref linkend="mthReplace"/></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="mthNewClsBinaryMenuBar" xreflabel="new"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>BinaryMenuBar class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(-+----------+-+------+-+-------+-+------------+-+--------+-+---------+-)--><
         +--menuSrc-+ +-,-id-+ +-,-hID-+ +-,-attachTo-+ +-,-auto-+ +-,-mName-+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>BinaryMenuBar</computeroutput> object.
</para>
<para>
  The new menu bar is initially empty if <emphasis role="italic">menuSrc</emphasis> is omitted. If <emphasis
  role="italic">menuSrc</emphasis> is not omitted, the menu template is obtained from the compiled binary resource
  pointed to by <emphasis role="italic">menuSrc</emphasis>.
</para>
<para>
  When an empty menu bar is instantiated, the programmer can add to the menu dynamically using menu object methods such
  as <xref linkend="mthInsertPopup"/>, <xref linkend="mthInsertItem"/>, etc..
  Dynamically constructing a menu in this way is much less error prone than using the
 <xref linkend="clsUserMenuBar"/> class.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>menuSrc [optional]</term>
    <listitem>
    <para>
      The source of the menu template.  If this argument is omitted an empty menu template is constructed in memory.
      When not omitted, the argument can be one of the following objects:
    </para>
    <variablelist>
      <varlistentry><term><emphasis role="bold">.nil:</emphasis></term>
      <listitem>
      <para>
        Constructs an empty menu template in memory. This is identical to omitting the arugment altogether.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">.ResDialog:</emphasis></term>
      <listitem>
      <para>
        The menu template is located in the resource only DLL of the <xref linkend="clsResDialog"/>
        object specified. In this case, the resource <emphasis role="italic">id</emphasis> argument is required.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">.String:</emphasis></term>
      <listitem>
      <para>
        The file name of an executable module containing the menu template. When this source of the menu template is
        used, the resource <emphasis role="italic">id</emphasis> argument is required.  An executable module is either a
        DLL, or a .exe file, both of which can contain compiled resources.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">.Pointer</emphasis></term>
      <listitem>
      <para>
        A Rexx <computeroutput>.Pointer</computeroutput> object. If used, this argument must be a
        <computeroutput>.Pointer</computeroutput> object that represents a valid menu handle. Currently this source of
        the menu template is limited. The only way to get a menu handle is through the
 <xref linkend="mthGetMenuHandle"/> method. However, future enhancements to ooDialog will likely have
        other ways to get a menu handle.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
    <varlistentry><term>id [optional]</term>
    <listitem>
    <para>
      The resource ID of the menu bar, may be <xref linkend="itmMenuSymbolicIDs"/> or numeric. This
      argument is required if <emphasis role="italic">menuSrc</emphasis> is either a
      <computeroutput>.ResDialog</computeroutput> or <computeroutput>.String</computeroutput> object.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hID [optional]</term>
    <listitem>
    <para>
      The context help resource ID of the menu bar, may be <xref linkend="itmMenuSymbolicIDs"/> or
      numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>attachTo [optional]</term>
    <listitem>
    <para>
      If specified, attach this menu bar to the specified dialog. If used, <emphasis role="italic">attachTo</emphasis>
      has to be a <xref linkend="chpDialogObject"/> object and the dialog must be in a valid state to attach
      the menu bar. That is, the <xref linkend="ovvUnderlying"/> dialog must exist and the dialog must
      not already have a menu bar attached. If any of these conditions are not met, an exception is raised.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>auto [optional]</term>
    <listitem>
    <para>
      If true, turn on <emphasis role="italic">auto connection</emphasis>. The default is false. Refer to the
      discussion on command event <xref linkend="sctMenuCommandEventConnections"/>s to understand the details of <emphasis
      role="italic">auto connection</emphasis>. When auto connection is on, <emphasis
      role="italic">each</emphasis> time this menu bar is attached to a dialog, all <xref linkend="sctMenuCommandEvents"/>s
      are connected to a method in the dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mName [optional]</term>
    <listitem>
    <para>
      This argument is ignored unless <emphasis role="italic">auto</emphasis> is true. If so <emphasis
      role="italic">mName</emphasis> is used as the auto connection method name for all menu command events. When
      <emphasis role="italic">auto</emphasis> is true and this argument is omitted, the name of the connected method for
      each menu command item is composed from the menu item <xref linkend="mthItemTextToMethodName"/>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>BinaryMenuBar</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Raises conditions for all failures. If no condition is raised then the menu has been created successfully.
  </para>
  <para>
    To use <xref linkend="itmMenuSymbolicIDs"/> IDs with menu objects the programmer must use the global
    <xref linkend="dotConstDir"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected, or other errors in instantiating the menu object have
    occurred.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>. However, it will only be non-zero if
    the help ID is set and there is a Windows API failure. It is unlikely that this could happen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example loads a menu bar from a DLL, immediately attaches it to the dialog, and connects all menu command item
    events to the <emphasis role="italic">onMenuSelect</emphasis> even handler method:
<programlisting>
<![CDATA[

  .application~useGlobalConstDir('O', 'resource.h')

  dlg = .BinaryDialog~new("menuResourceEx.dll", IDD_DLGMENU)
  ...

::method initDialog
  expose menuBar
  ...

  menuBar = .BinaryMenuBar~new("menuResourceEx.dll", IDR_MENU1, , self, .true, onMenuSelect)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End BinaryMenuBar::new() -->

</section>  <!-- End BinaryMenuBar class -->

<section id="clsScriptMenuBar" xreflabel="ScriptMenuBar"><title>ScriptMenuBar Class</title>
<indexterm><primary>ScriptMenuBar class</primary></indexterm>
<para>
  The <emphasis role="italic">ScriptMenuBar</emphasis> is a menu <xref linkend="clsMenuBar"/> where the menu
  template is obtained from a resource <xref linkend="defResourceScript"/> file.
</para>
<para>
  The class has all the methods of the <computeroutput>MenuBar</computeroutput> and the
 <xref linkend="clsMenu"/> classes.  The only difference between the
  <computeroutput>ScriptMenuBar</computeroutput> and the other menu bar classes such as the
 <xref linkend="clsBinaryMenuBar"/> or <xref linkend="clsUserMenuBar"/> is in the
  <emphasis role="italic">new</emphasis> method.
</para>

<section id="sctMethodsScriptMenuBar"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>ScriptMenuBar</computeroutput>. For
  convenience, the inherited methods from the <xref linkend="clsMenuBar"/> mixin class are also listed
  here. Note that the <computeroutput>ScriptMenuBar</computeroutput> <emphasis role="italic">is</emphasis> a menu and
  therefore also contains all the methods of the <xref linkend="clsMenu"/> class.
<table id="tblMethodsScriptMenuBar" frame="all"> <title>ScriptMenuBar Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="mthNewClsScriptMenuBar"/></entry>
<entry>Returns a new <computeroutput>ScriptMenuBar</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthAttachTo"/></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><xref linkend="mthDetach"/></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><xref linkend="mthIsAttached"/></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawClsMenu"/></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><xref linkend="mthReplace"/></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsScriptMenuBar" xreflabel="new"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>ScriptMenuBar class</secondary></indexterm>
<indexterm><primary>ScriptMenuBar class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--rcFile--+------+-+----------+-+---------+-+-----------+-+------------+-)--><
                  +-,-id-+ +-,-helpID-+ +-,-count-+ +-,-connect-+ +-,-attachTo-+

]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>ScriptMenuBar</computeroutput> object. The menu template is obtained from the
  resource script specified by the <emphasis role="italic">rcFile</emphasis> argument.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>rcFile [required]</term>
      <listitem>
      <para>
        The resource <xref linkend="defResourceScript"/> file containing the menu definition for this script menu bar.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>id [optional]</term>
      <listitem>
      <para>
        The resource ID of the menu definition in the resource script. May be
        <xref linkend="itmMenuSymbolicIDs"/> or numeric. If this argument is omitted, the first menu definition
        found in the resource script is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>helpID [optional]</term>
      <listitem>
      <para>
        The context help ID for this menu. May be numeric or <xref linkend="itmMenuSymbolicIDs"/>. If
        omitted, the menu will not have a help ID.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>count [optional]</term>
      <listitem>
      <para>
        The (approximate) count of menu items the menu will contain. The default when omitted is 200. This number is
        used to allocate the resources for the in-memory menu template. It is only approximate because the actual size
        of the template will vary with the length of the labels for the menu items.
      </para>
      <para>
        When the template is being constructed, if the allocated resource is too small a syntax condition specifying the
        resource is too small will be raised. In this case, the programmer should use the <emphasis
        role="italic">count</emphasis> argument to specify a larger number of menu items.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>connect [optional]</term>
      <listitem>
      <para>
        If true, each menu command item in the menu is connected to a method in a Rexx dialog object the <emphasis
        role="italic">first</emphasis> time the menu is attached to a dialog. This is a <xref
        linkend="sctMenuCommandEventConnections"/> request type of connection. If the <emphasis
        role="italic">attachTo</emphasis> argument is used, then the menu command items are connected immediately.
        Otherwise the requests for connections are queued and the connections are made when the menu bar is actually
        attached to a dialog. The name of the connected method for each menu command item is composed from the menu item
        <xref linkend="mthItemTextToMethodName"/>. The default for this argument is false.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>attachTo [optional]</term>
      <listitem>
      <para>
        Specifies a Rexx dialog object for the menu to attach to immediately. This argument must be a
        <xref linkend="chpDialogObject"/> object, the <xref linkend="ovvUnderlying"/> Windows
        dialog must exist and that dialog must not already have a menu bar attached. If those conditions are not met,
        then a syntax condition is raised.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a new <computeroutput>ScriptMenuBar</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Raises conditions for all failures. If no condition is raised then the menu has been created successfully.
  </para>
  <para>
    To use <xref linkend="itmMenuSymbolicIDs"/> IDs with menu objects the programmer must use the global
    <xref linkend="dotConstDir"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected, or other errors in instantiating the menu object have
    occurred.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>. However, it will only be non-zero if
    the help ID is set and there is a Windows API failure. It is unlikely that this could happen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example creates a script menu bar and attaches it immediately to the dialog. Methods in the Rexx dialog are
    automatically connected to the menu command events, no help ID is assigned, and the menu item count is left at the
    default:
<programlisting>
<![CDATA[

  .application~useGlobalConstDir("O", "ScriptMenuBar.h")

  dlg = .SimpleDialog~new("ScriptMenuBar.rc", IDD_SCRIPTMENUBAR_DLG)
  ...

::method initDialog
  expose menuBar

  menuBar = .ScriptMenuBar~new("ScriptMenuBar.rc", IDR_MENU_LV, , , .true, self)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

</section>  <!-- End ScriptMenuBar class -->

<section id="clsUserMenuBar" xreflabel="UserMenuBar"><title>UserMenuBar Class</title>
<indexterm><primary>UserMenuBar class</primary></indexterm>
<para>
  A <computeroutput>UserMenuBar</computeroutput> is a <xref linkend="clsMenuBar"/> whose menu template comes from
  statements in the program code.
</para>
<para>
  The ooDialog framework provides three basic types of menu bars. The only difference in the three types is the source
  of the menu template for the menu bar. In a <xref linkend="clsScriptMenuBar"/> the source of the menu template is a
  resource <xref linkend="defResourceScript"/> file (usually a .rc file) that ooDialog parses and uses to construct the
  menu template. For a <xref linkend="clsBinaryMenuBar"/> the menu template comes from a compiled binary resource, or
  the menu template is constructed as an empty menu.
</para>
<para>
  In general it is much easier to dynamically construct the menu template by starting with an empty
 <xref linkend="clsBinaryMenuBar"/> and inserting the desired menu items than it is to define the menu
  template in an <computeroutput>UserMenuBar</computeroutput>.
</para>

<section id="sctMethodsUserMenuBar"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>UserMenuBar</computeroutput>. For
  convenience, the inherited methods from the <xref linkend="clsMenuBar"/> mixin class are also listed here. Note that
  the <computeroutput>UserMenuBar</computeroutput> <emphasis role="italic">is</emphasis> a menu and therefore also
  contains all the methods of the <xref linkend="clsMenu"/> class.
<table id="tblMethodsUserMenuBar" frame="all"> <title>UserMenuBar Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="mthNewClsUserMenuBar"/></entry>
<entry>Returns a new <computeroutput>UserMenuBar</computeroutput>object.</entry>
</row>
<row>
<entry><xref linkend="mthAddItem"/></entry>
<entry>Adds a command menu item to the menu template.</entry>
</row>
<row>
<entry><xref linkend="mthAddPopup"/></entry>
<entry>Adds a popup menu, a submenu, to the menu template.</entry>
</row>
<row>
<entry><xref linkend="mthAddSeparatorMenu"/></entry>
<entry>Adds a separator menu item to the menu template.</entry>
</row>
<row>
<entry><xref linkend="mthAttachTo"/></entry>
<entry>Attaches the menu bar to the specified dialog.</entry>
</row>
<row>
<entry><xref linkend="mthComplete"/></entry>
<entry>Finalizes the in-memory template and converts it to an actual menu bar.</entry>
</row>
<row>
<entry><xref linkend="mthDetach"/></entry>
<entry>Detaches this menu bar from its assigned dialog.</entry>
</row>
<row>
<entry><xref linkend="mthIsComplete"/></entry>
<entry>Tests if the menu template has been finished and converted to a menu.</entry>
</row>
<row>
<entry><xref linkend="mthIsAttached"/></entry>
<entry>Determines if this menu bar is currently attached to a dialog.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawClsMenu"/></entry>
<entry>Tells the dialog this menu bar is attached to, to redraw the menu.</entry>
</row>
<row>
<entry><xref linkend="mthReplace"/></entry>
<entry>If this menu bar is attached to a dialog, replaces this menu bar with the specified menu bar.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsUserMenuBar" xreflabel="new"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>UserMenuBar class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--+-----+-+----------+-+---------+-+--------+-+---------+--)-----------><
          +--id-+ +-,-helpID-+ +-,-count-+ +-,-auto-+ +-,-mName-+


]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>UserMenuBar</computeroutput> object. The menu template of a user menu bar is
  created dynamically in the program code, using the methods of the <computeroutput>UserMenuBar</computeroutput> class.
  This is similar to the creation of the dialog template in a <xref linkend="clsUserDialog"/>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [optional]</term>
    <listitem>
    <para>
      The resource ID for the menu bar. May be <xref linkend="itmMenuSymbolicIDs"/> or numeric. If this
      argument is omitted or is -1, the menu bar will not have a resource ID.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>helpID [optional]</term>
    <listitem>
    <para>
      The context help ID for this menu. May be numeric or <xref linkend="itmMenuSymbolicIDs"/>. If
      omitted, the menu will not have a help ID.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>count [optional]</term>
    <listitem>
    <para>
      The (approximate) count of menu items the menu will contain. The default when omitted is 200. This number is
      used to allocate the resources for the in-memory menu template. It is only approximate because the actual size
      of the template will vary with the length of the labels for the menu items.
    </para>
    <para>
      When the template is being constructed, if the allocated resource is too small a syntax condition specifying the
      resource is too small will be raised. In this case, the programmer should use the <emphasis
      role="italic">count</emphasis> argument to specify a larger number of menu items.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>auto [optional]</term>
    <listitem>
    <para>
      If true, turn on <emphasis role="italic">auto connection</emphasis>. The default is false. Refer to the
      discussion on command event <xref linkend="sctMenuCommandEventConnections"/>s to understand the details of <emphasis
      role="italic">auto connection</emphasis>. When auto connection is on, <emphasis
      role="italic">each</emphasis> time this menu bar is attached to a dialog, all <xref linkend="sctMenuCommandEvents"/>s
      are connected to a method in the dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mName [optional]</term>
    <listitem>
    <para>
      This argument is ignored unless <emphasis role="italic">auto</emphasis> is true. If so <emphasis
      role="italic">mName</emphasis> is used as the auto connection method name for all menu command events. When
      <emphasis role="italic">auto</emphasis> is true and this argument is omitted, the name of the connected method for
      each menu command item is composed from the menu item <xref linkend="mthItemTextToMethodName"/>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>UserMenuBar</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Properly constructing a menu template using the <computeroutput>UserMenuBar</computeroutput> is somewhat difficult
    to do correctly, making it prone to error. It is much simpler to construct the menu template using an empty
 <xref linkend="clsBinaryMenuBar"/>. ooDialog programmers are encouraged to use the
    <computeroutput>BinaryMenuBar</computeroutput> class rather than the <computeroutput>UserMenuBar</computeroutput>
    class.
  </para>
  <para>
    Raises conditions for all failures. If no condition is raised then the menu has been created successfully.
  </para>
  <para>
    To use <xref linkend="itmMenuSymbolicIDs"/> IDs with menu objects the programmer must use the global
    <xref linkend="dotConstDir"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected, or other errors in instantiating the menu object have
    occurred.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>. However, it will only be non-zero if
    the help ID is set and there is a Windows API failure. It is unlikely that this could happen.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleNewUserMenuBar"><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the creation of a user menu bar in a private method of the dialog. The application use symbolic
    menu IDs. The default count of menu items is changed to 20 when the user menu bar is instantiated and auto
    connection is turned on. Since no method name is provided, each menu command event will be connected to a separate
    method.
<programlisting>
<![CDATA[

  -- All resource IDs are symbolic and are defined in userMenu.h
  .application~useGlobalConstDir('O', "userMenu.h")
  ...

::method defineMenu private
  expose menuBar statusText

  count = 20
  menuBar = .UserMenuBar~new(IDH_MENU1, , count, .true)

  menuBar~addPopup(IDM_POP_FILES, "Files", "END", IDH_FILES)
    menuBar~addItem(ID_FILES_COPY, "Copy", "RADIO")
    menuBar~addItem(ID_FILES_MOVE, "Move", "DEFAULT CHECK RADIO")
    menuBar~addItem(ID_FILES_DELETE, "Delete", "RADIO")
    menuBar~addSeparator(IDM_SEP_FILES)
    menuBar~addPopup(IDM_POP_RENAME, "Rename", , IDH_RENAME)
      menuBar~addItem(ID_RENAME_LOWERCASE, "Lower case")
      menuBar~addItem(ID_RENAME_UPPERCASE, "Upper case", "CHECK END")
    menuBar~addSeparator(IDM_SEP_FILES)
    menuBar~addItem(ID_EXIT, "Exit", "END")

  if \ menuBar~complete then do
    statusText = 'User menu bar completion error: ' || -
                 .SystemErrorCode SysGetErrortext(.SystemErrorCode)
    return .false
  end

  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddItem" xreflabel="addItem"><title>addItem</title>
<indexterm><primary>addItem</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>addItem</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addItem(--id-,-text--+---------+--+---------+--)------------><
                         +-,-opts--+  +-,-mName-+
]]>
</programlisting>

<para>
  Adds a menu command item to the menu template. This method is only valid after the
  <computeroutput>UserMenuBar</computeroutput> has been instantiated and before the menu template is
 <xref linkend="mthComplete"/>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID for the menu command item. May be <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>text [required]</term>
    <listitem>
    <para>
      The text, the label, for the menu item.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. The keywords set the
      state and type of the popup menu, and specify when the popup menu is the last item at the current level in the
      menu.
    </para>
    <para>
      The keywords: ENABLED UNHILITE NOTDEFAULT UNCHECKED, although valid keywords, are simply ignored for this method.
      By default the state will be ENABLED UNHILITE NOTDEFAULT UNCHECKED, with no special type. The keywords are:
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>CHECKED      </member>
      <member>DEFAULT      </member>
      <member>DISABLED     </member>
      <member>GRAYED       </member>
      <member>HILITE       </member>
      <member>MENUBARBREAK </member>
      <member>MENUBREAK    </member>
      <member>RADIO        </member>
      <member>RIGHTJUSTIFY </member>
      <member>END          </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>CHECKED</term>
      <listitem>
      <para>
        A menu item state specification. Checks the menu item. If the item also has the RADIO type, the check is a
        bullet, otherwise it is a normal check mark.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DEFAULT</term>
      <listitem>
      <para>
        A menu item state specification. Specifies that the menu item is the default. A menu can contain only one
        default menu item, which is displayed in bold.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DISABLE</term>
      <listitem>
      <para>
        A menu item state specification. Disables the menu item and grays it so that it cannot be selected. DISABLED and
        GRAYED are exactly the same.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>GRAYED</term>
      <listitem>
      <para>
        A menu item state specification. Disables the menu item and grays it so that it cannot be selected. DISABLED and
        GRAYED are exactly the same.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>HILITE</term>
      <listitem>
      <para>
        A menu item state specification. Highlights the menu item. Although the menu item can be created with this
        state, it would not normally be done. It gives the user the appearance the menu is selected, but it is not
        actually selected.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBARBREAK</term>
      <listitem>
      <para>
        A menu item type specification. Places the menu item on a new line (for a menu bar) or in a new column (for a
        drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or shortcut menu, a vertical line
        separates the new column from the old.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBREAK</term>
      <listitem>
      <para>
        A menu item type specification. Places the menu item on a new line (if in the top level of a menu bar) or in a
        new column (for a menu item in a drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or
        shortcut menu, the columns are <emphasis role="italic">not</emphasis> separated by a vertical line.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTJUSTIFY</term>
      <listitem>
      <para>
        A menu item type specification. Right-justifies the menu item and any subsequent popup menus. This value is
        valid only if the menu item is in the top level of a menu bar. (Although it is not common to put a menu item in
        the top level of a menu bar, it can be done.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term>END</term>
      <listitem>
      <para>
        Indicates that this is the last menu item at the current level of the menu. The END keyword <emphasis
        role="italic">must</emphasis> be present if the item is the last menu item at the current level, and can
        <emphasis role="italic">not</emphasis> be present otherwise. Incorrect placement of the END keyword is the most
        common problem programmers have when using the <computeroutput>UserMenuBar</computeroutput> class.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term>mName [optional]</term>
  <listitem>
  <para>
    A method name to connect the menu command event to. The default is to not connect the menu command item. This is a
    <xref linkend="sctMenuCommandEventConnections"/>  request type of connection. If this argument is used it can not be the
    empty string.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    It is suggested that the ooDialog programmer create an empty <xref linkend="clsBinaryMenuBar"/>
    and add the menu items to the menu bar using the <emphasis role="italic">insert</emphasis> methods, such as
    <xref linkend="mthInsertPopup"/>. This provides all the functionality of the
    <computeroutput>UserMenuBar</computeroutput>, but is easier to use.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The <computeroutput>UserMenuBar</computeroutput>
        has already been <xref linkend="mthIsComplete"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_PARAMETER (87)</term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> When the <emphasis
      role="italic">mName</emphasis> argument is used, it can not be the empty string.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    There is a good example of using the <emphasis role="italic">addItem</emphasis> method in the
    <link linkend="exampleNewUserMenuBar">example</link>) for the <emphasis role="italic">new</emphasis> method of the
    <computeroutput>UserMenuBar</computeroutput> class.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::addItem() -->

<section id="mthAddPopup" xreflabel="addPopup"><title>addPopup</title>
<indexterm><primary>addPopup</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>addPopup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addPopup(--id--,--name--+--------+--+----------+--)----><
                            +-,-opts-+  +-,-helpID-+
]]>
</programlisting>

<para>
  Adds a popup menu, a submenu, to the menu template. This method is only valid after the
  <computeroutput>UserMenuBar</computeroutput> has been instantiated and before the menu template is
 <xref linkend="mthComplete"/>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID for the popup menu. May be <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>name [required]</term>
    <listitem>
    <para>
      The text label of the popup menu.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. The keywords set the
      state and type of the popup menu, and specify when the popup menu is the last item at the current level in the
      menu.
    </para>
    <para>
      The keywords: ENABLED UNHILITE NOTDEFAULT, although valid keywords, are simply ignored for this method. By default
      the state will be ENABLED UNHILITE NOTDEFAULT, with no special type. The keywords are:
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>DEFAULT      </member>
      <member>DISABLED     </member>
      <member>GRAYED       </member>
      <member>HILITE       </member>
      <member>MENUBARBREAK </member>
      <member>MENUBREAK    </member>
      <member>RIGHTJUSTIFY </member>
      <member>RIGHTORDER   </member>
      <member>END          </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>DEFAULT</term>
      <listitem>
      <para>
        A popup menu state specification. Specifies that the popup menu is the default. A menu can contain only one
        default menu item, which is displayed in bold.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DISABLE</term>
      <listitem>
      <para>
        A popup menu state specification. Disables the popup menu and grays it so that it cannot be selected. DISABLED
        and GRAYED are exactly the same
      </para>
      </listitem></varlistentry>
      <varlistentry><term>GRAYED</term>
      <listitem>
      <para>
        A popup menu state specification. Disables the popup menu and grays it so that it cannot be selected. DISABLED
        and GRAYED are exactly the same
      </para>
      </listitem></varlistentry>
      <varlistentry><term>HILITE</term>
      <listitem>
      <para>
        A popup menu state specification. Highlights the popup menu. Although the popup menu can be created with this
        state, it would not normally be done. It gives the user the appearance the popup menu is selected, but it is not
        actually selected.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBARBREAK</term>
      <listitem>
      <para>
        A popup menu type specification. Places the popup menu on a new line (for a menu bar) or in a new column (for a
        drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or shortcut menu, a vertical line
        separates the new column from the old.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBREAK</term>
      <listitem>
      <para>
        A popup menu type specification. Places the popup menu on a new line (for a menu bar) or in a new column (for a
        drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or shortcut menu, the columns are
        <emphasis role="italic">not</emphasis> separated by a vertical line.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTJUSTIFY</term>
      <listitem>
      <para>
        A popup menu type specification. Right-justifies the popup menu and any subsequent popup menus. This value is
        valid only if the popup menu is in a menu bar.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTORDER</term>
      <listitem>
      <para>
        A popup menu type specification.  Specifies that menus cascade right-to-left (the default is left-to-right).
        This is used to support right-to-left languages, such as Arabic and Hebrew.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>END</term>
      <listitem>
      <para>
        Indicates that this is the last menu item at the current level of the menu. The END keyword <emphasis
        role="italic">must</emphasis> be present if the popup menu is the last menu item at the current level, and can
        <emphasis role="italic">not</emphasis> be present otherwise. Incorrect placement of the END keyword is the most
        common problem programmers have when using the <computeroutput>UserMenuBar</computeroutput> class.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>helpID [optional]</term>
    <listitem>
    <para>
      The context help ID for the popup menu. May be <xref linkend="itmMenuSymbolicIDs"/> or numeric.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    It is suggested that the ooDialog programmer create an empty <xref linkend="clsBinaryMenuBar"/>
    and add the menu items to the menu bar using the <emphasis role="italic">insert</emphasis> methods, such as
 <xref linkend="mthInsertPopup"/>. This provides all the functionality of the
    <computeroutput>UserMenuBar</computeroutput>, but is easier to use.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The <computeroutput>UserMenuBar</computeroutput>
        has already been <xref linkend="mthIsComplete"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    There is a good example of using the <emphasis role="italic">addPopup</emphasis> method in the
    <link linkend="exampleNewUserMenuBar">example</link>) for the <emphasis role="italic">new</emphasis> method of the
    <computeroutput>UserMenuBar</computeroutput> class.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddSeparatorMenu" xreflabel="addSeparator"><title>addSeparator</title>
<indexterm><primary>addSeparator</primary><secondary>UserMenuBar class</secondary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>addSeparator</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addSeparator(--id--+---------+--)------------><
                       +-,-opts--+
]]>
</programlisting>

<para>
  Adds a separator, which is a horizontal line, to the menu template. This method is only valid after the
  <computeroutput>UserMenuBar</computeroutput> has been instantiated and before the menu template is
 <xref linkend="mthComplete"/>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID for the separator. May be <xref linkend="itmMenuSymbolicIDs"/> or numeric. -1 is
      accepted to indicate no ID is desired, however, there are many advantages to assigning valid IDs to separators.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. The keywords set the
      few valid types of the separator, and specify when the separator is the last item at the current level in the
      menu. The keywords are:
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>MENUBARBREAK </member>
      <member>MENUBREAK    </member>
      <member>RIGHTJUSTIFY </member>
      <member>END          </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>MENUBARBREAK</term>
      <listitem>
      <para>
        A separator type specification. Places the separator, and all menu items following it, on a new line (for a menu
        bar) or in a new column (for a drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or
        shortcut menu, a vertical line separates the new column from the old.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MENUBREAK</term>
      <listitem>
      <para>
        A separator type specification. Places the separator, and all menu items following it, on a new line (for a menu
        bar) or in a new column (for a drop down menu, submenu, or shortcut menu). For a drop down menu, submenu, or
        shortcut menu, the columns are <emphasis role="italic">not</emphasis> separated by a vertical line.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RIGHTJUSTIFY</term>
      <listitem>
      <para>
        A separator type specification. Right-justifies the separator and any subsequent menu items. This value is
        valid only if the separator is in a menu bar.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>END</term>
      <listitem>
      <para>
        Indicates that this is the last menu item at the current level of the menu. The END keyword <emphasis
        role="italic">must</emphasis> be present if the separator is the last menu item at the current level, and can
        <emphasis role="italic">not</emphasis> be present otherwise. Incorrect placement of the END keyword is the most
        common problem programmers have when using the <computeroutput>UserMenuBar</computeroutput> class.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success and false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The Microsoft documentation indicates that a separator can not be used in a menu bar, only in a submenu. However, on
    Windows 7 at least, separators can be used in the menu bar. No vertical line is shown, but the separator will take
    up a little space. The separator <emphasis role="italic">type</emphasis> keywords work as expected. I.e., if the
    separator is given the RIGHTJUSTIFY type, it and all subsequent menu items are right justified in the menu bar.
  </para>
  <para>
    It is suggested that the ooDialog programmer create an empty <xref linkend="clsBinaryMenuBar"/>
    and add the menu items to the menu bar using the <emphasis role="italic">insert</emphasis> methods, such as
 <xref linkend="mthInsertPopup"/>. This provides all the functionality of the
    <computeroutput>UserMenuBar</computeroutput>, but is easier to use.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The <computeroutput>UserMenuBar</computeroutput>
        has already been <xref linkend="mthIsComplete"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    There is a good example of using the <emphasis role="italic">addSeparator</emphasis> method in the
    <link linkend="exampleNewUserMenuBar">example</link>) for the <emphasis role="italic">new</emphasis> method of the
    <computeroutput>UserMenuBar</computeroutput> class.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::addSeparator() -->

<section id="mthComplete" xreflabel="complete"><title>complete</title>
<indexterm><primary>complete</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>complete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--complete-------------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">complete</emphasis> method finalizes the in-memory template and converts it to an actual
  menu bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The menu bar can not be attached to a dialog prior to invoking the <emphasis role="italic">complete</emphasis>
    method. Likewise, no menu items can be added to the template using the <xref linkend="mthAddItem"/>,
 <xref linkend="mthAddPopup"/>, or <xref linkend="mthAddSeparatorMenu"/> methods after
    the <emphasis role="italic">complete</emphasis> method is invoked. However, once the menu bar is complete, the
    <emphasis role="italic">insert</emphasis> methods of the menu object, such as the
 <xref linkend="mthInsertPopup"/> method can all be used to insert menu items.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The menu template has already been finalized.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The <link linkend="exampleNewUserMenuBar">example</link>) for the <emphasis role="italic">new</emphasis> method of
    the <computeroutput>UserMenuBar</computeroutput> class uses the <emphasis role="italic">complete</emphasis> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::complete() -->

<section id="mthIsComplete" xreflabel="isComplete"><title>isComplete</title>
<indexterm><primary>isComplete</primary></indexterm>
<indexterm><primary>UserMenuBar class</primary><secondary>isComplete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isComplete-----------------------------------><

]]>
</programlisting>

<para>
  Tests if the menu template has been finished and converted to a menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if the menu template has already been finished and converted to a menu, otherwise returns false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Once the menu template has been finalized and converted to an actual menu, menu items can not longer be added to the
    template.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a method that adds a separator to the menu template when invoked. It first checks that the menu
    template is still available to add menu items
<programlisting>
<![CDATA[

::method maybeAddSeparator private
  use strict arg id, isEnd

  if self~isComplete then return .false

  if isEnd the do
    self~addSeparator(id, 'END')
  end
  else do
    self~addSeparator(id)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End UserMenuBar::isComplete() -->

</section>  <!-- End UserMenuBar class -->

<section id="clsPopupMenu" xreflabel="PopupMenu"><title>PopupMenu Class</title>
<indexterm><primary>PopupMenu class</primary></indexterm>
<para>
  A popup menu is a <emphasis role="italic">menu</emphasis> as opposed to a <emphasis role="italic">menu
  bar</emphasis>. Menus are arranged in a hierarchy with the menu bar being the top-level of the hierarchy. Popup menus
  go by a variety of names depending on where they are located in the hierarchy, and their use. But, they are all the
  same no matter the name used.
</para>
<para>
  When a popup menu is in the menu bar, it is often called a drop-down menu. When a popup menu is within another popup
  menu it is usually called a submenu. Menus can also exist that are not attached to a menu bar, in which case they are
  often called shortcut menus, context menus, or popup menus. This documentation tries to be
  consistent and use the term popup menu in all cases. Method names in the Menu classes always use <emphasis
  role="italic">popup</emphasis>.
</para>

<section id="evtPopupMenuCONTEXT"><title>ContextMenu Event Handler</title>
<indexterm><primary>PopupMenu Event</primary><secondary>CONTEXTMENU</secondary></indexterm>
<para>
  <emphasis role="bold">Note</emphasis> that the event handler for the CONTEXTMENU event connected through the
 <xref linkend="mthConnectContextMenuCls"/> class method or the
 <xref linkend="mthConnectContextMenu"/> instance method, described in this section, is the same as
  the event handler <link linkend="evtMenuObjectCONTEXTMENU">described</link>/> for the CONTEXTMENU event connected through
  the <xref linkend="mthConnectMenuEvent"/> method. The event and event handler are the same no matter how the event
  connection is made.
</para>
<para>
  The event handler for the context menu event is invoked when the user right-mouse clicks on a window, types SHIFT-F10
  on the keyboard, or types the VK_APPS key on the keyboard. The VK_APPS key is the <emphasis
  role="italic">Applications</emphasis> key on a Natural keyboard. Use the
 <xref linkend="mthConnectContextMenuCls"/> class method, or the
 <xref linkend="mthConnectContextMenu"/> instance method to connect the context menu event.
</para>
<para>
  The interpreter does not wait for the return from the event handler, so the method does not need to return a value.
  However, good practice would be to always return a value from an event handler. 0 would be a good value to return.
</para>

<programlisting>
<![CDATA[
::method onContextMenu unguarded
  use arg hwnd, x, y

  return 0
]]>
</programlisting>

<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The event handling method receives 3 arguments:
  </para>
  <variablelist>
    <varlistentry><term>hwnd</term>
    <listitem>
    <para>
      The window <xref linkend="defHandle"/> of the window the user clicked the mouse on, or the window
      that has the focus if the user generated the context menu event with the keyboard. Note that this will only be
      the dialog window handle of the user clicks on the dialog background. Quite often it is going to be one of the
      dialog controls.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>x</term>
    <listitem>
    <para>
      The X coordinate of the mouse position, in screen <xref linkend="defScreenCoordinates"/>) coordinates, at the
      time of the mouse click. Or, -1 if the user generated the context menu event by using the keyboard.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>y</term>
    <listitem>
    <para>
      The Y coordinate of the mouse position, in screen <xref linkend="defScreenCoordinates"/>) coordinates, at the
      time of the mouse click. Or, -1 if the user generated the context menu event by using the keyboard.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return:</emphasis></term>
  <listitem>
  <para>
    0 makes a good return value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    The following example shows the event handler method that is only invoked for a list view in the application. Note
    that since the application uses the <xref linkend="mthShowClsPopupMenu"/> method to put up the context
    menu, the handling of the menu command item selection is done in a menu command event
    <xref linkend="sctMenuCommandEventHandlers"/>.

<programlisting>
<![CDATA[

  if \ lvPopup~connectContextMenu(onListViewContext, self~newListView(IDC_LV)~hwnd) then do
    say 'Error connecting context menu. SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end
  ...

::method onListViewContext
  expose lvPopup listView
  use arg hwnd, x, y

  if x == -1, y == -1 then do
    -- The keyboard was used, not the mouse.  Position the context menu as
    -- at the lower right of the list view.
    rect = listView~windowRect
    x = rect~right - .SM~cxVScroll + 15
    y = rect~bottom - 15
  end

  -- pos is the point on the screen, in pixels, to place the context menu.
  pos = .Point~new(x, y)

  -- Show the menu.
  ret = lvPopup~show(pos)
  if ret == -1 then do
    say 'lvPopup~show() failed SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>

</section>  <!-- End context Event Handler -->


<section id="sctMethodsPopupMenu"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>PopupMenu</computeroutput>.
<table id="tblMethodsPopupMenu" frame="all"> <title>PopupMenu Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="mthConnectContextMenuCls"/></entry>
<entry>Connects the Windows context menu event with a method in the Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthNewClsPopupMenu"/></entry>
<entry>Returns a new <computeroutput>PopupMenu</computeroutput>object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="mthAssignTo"/></entry>
<entry>Assigns this popup menu to a dialog.</entry>
</row>
<row>
<entry><xref linkend="mthConnectContextMenu"/></entry>
<entry>Connects the Windows context menu event with a method in the Rexx dialog.</entry>
</row>
<row>
<entry><xref linkend="mthIsAssigned"/></entry>
<entry>Determines if this menu has an assigned owner.</entry>
</row>
<row>
<entry><xref linkend="mthShowClsPopupMenu"/></entry>
<entry>Shows a popup menu as a context menu and returns immediately.</entry>
</row>
<row>
<entry><xref linkend="mthTrack"/></entry>
<entry>Shows a popup menu as a context menu and returns when the menu is dismissed</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthConnectContextMenuCls" xreflabel="connectContextMenu"><title>connectContextMenu (Class)</title>
<indexterm><primary>connectContextMenu</primary><secondary>PopupMenu class</secondary><tertiary>class method</tertiary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>connectContextMenu</secondary><tertiary>class method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectContextMenu(--dlg--,--methodName--+---------+--+-----------+--)-----><
                                             +-,-hwnd--+  +-,-handles-+
]]>
</programlisting>

<para>
  Connects the context menu <xref linkend="ovvEvents"/> notification to a method in a Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The Rexx dialog the notification is being connect to.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>methodName [required]</term>
    <listitem>
    <para>
      The method in the Rexx dialog to be invoked when the event happens.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hwnd [optional]</term>
    <listitem>
    <para>
      A window handle to filter the right-clicks on. This can be the window handle of any control in the dialog being
      connected, or even the dialog window handle itself. If used, only right-clicks on the specified window will be
      received. If omitted, all right-clicks on the dialog are received.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The context menu event is generated when the user right-mouse clicks on a window. The event can also be generated by
    the keyboard by using SHIFT-F10 or the VK_APPS key (the Applications key on a Natural keyboard.) The <emphasis
    role="italic">ContextMenu Event Handler</emphasis> <link linkend="evtPopupMenuCONTEXT">section</link> has
    information on how to code the event handler.
  </para>
  <para>
    In many cases, the <xref linkend="mthConnectContextMenu"/> instance method will be more
    convenient to use. This class method is provided for times when the menu object itself is not available. For
    instance, some Windows applications dynamically create a context menu when receiving the event notification and then
    discard the menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on error. The system error code is set this way
    by ooDialog, in addition to error codes the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    If the programmer does not provide a method named <emphasis role="italic">methodName</emphasis> in the Rexx dialog,
    a syntax condition will be raised if any context menu events happen.
  </para>
  <para>
    The underlying dialog receives the WM_CONTEXTMENU message as the notification for this event.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example the application creates the context menus after receiving the event notification. It needs to
    connect the event before the menu objects actually exist.
<programlisting>
<![CDATA[
::method initDialog
  ...

  lvHwnd = self~newListView(IDC_LV_EMPLOYEES)
  .PopupMenu~connectContextMenu(self, "onListViewContext", lvHwnd)

  .PopupMenu~connectContextMenu(self, "onDialogContext", self~hwnd)

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::connectContextMenu()::ClassMethod -->

<section id="mthNewClsPopupMenu" xreflabel="new"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>PopupMenu class</secondary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--+----+--+-----------+--)---------------><
          +-id-+  +-,-helpID--+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>PopupMenu</computeroutput> object. Initially the menu is empty.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [optional]</term>
    <listitem>
    <para>
      The resource ID for the popup menu. May be <xref linkend="itmMenuSymbolicIDs"/> or numeric. If this
      argument is omitted or is -1, the popup menu will not have a resource ID.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>helpID [optional]</term>
    <listitem>
    <para>
      The context help ID for this menu. May be numeric or <xref linkend="itmMenuSymbolicIDs"/>. If
      omitted, the popup menu will not have a help ID.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>PopupMenu</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using a popup menu as a context menu, it is often convenient to simply get the menu from an existing menu
    through the <xref linkend="mthGetPopup"/> method. This is particularly true when the application is
    based on resource script files or binary compiled resources. In those types of applications, the menus are created
    in the resource script file. Within the resource script, all menus have to be defined as menu bars. To define a
    popup menu that is only used as a context menu, simply define a menu bar that only contains one menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>. However, the variable will only be
    non-zero if the Windows API used to set the help ID fails. This is unlikely to happen.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a popup menu and then adds a few menu items to it:
<programlisting>
<![CDATA[

  m = .PopupMenu~new(IDM_LV_BAR)

  m~insertItem(IDM_LV_RESTORE, IDM_LV_RESTORE, "Restore Original Order")
  m~insertItem(IDM_LV_RESTORE, IDM_LV_PROFESSION, "Order by Profession")
  m~insertItem(IDM_LV_PROFESSION, IDM_LV_FNAME, "Order by First Name")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthAssignTo" xreflabel="assignTo"><title>assignTo</title>
<indexterm><primary>assignTo</primary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>assignTo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--assignTo(--dlg--+-------+-+----------+--)----><
                    +-,-auto+ +-,-mName--+
]]>
</programlisting>

<para>
  Assigns this popup menu to a dialog. This is only used when the menu is used as a context, or shortcut, menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>dlg [required]</term>
    <listitem>
    <para>
      The owner dialog to assign this menu to. See the Remarks section below.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>auto [optional]</term>
    <listitem>
    <para>
      If true, turn on auto <xref linkend="sctMenuCommandEventConnections"/>. The default is false. When <emphasis
      role="italic">auto connection</emphasis> is on, <emphasis role="italic">each</emphasis> time this popup menu is
      assigned to a dialog, all <xref linkend="sctMenuCommandEvents"/>s are connected to a method in the dialog.
    </para> </listitem></varlistentry>
    <varlistentry><term>mName [optional]</term>
    <listitem>
    <para>
      Only used if <emphasis role="italic">auto</emphasis> true. If <emphasis role="italic">auto</emphasis> is true and
      this argument is not omitted, then <emphasis role="italic">mName</emphasis> is used to set, or reset, the auto
      connection method name. Note that this implies that if <emphasis role="italic">auto connection</emphasis> is
      already turned on for this menu, then <emphasis role="italic">mName</emphasis> can be used to change the auto
      connection method name.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a popup menu is used as a shortcut (context) menu it sends messages to its owner dialog when menu items are
    selected. Even if the short cut menu is only used with the <xref linkend="mthTrack"/> method, (where
    selecting a menu item does not send a message to its owner dialog,) the operating system still requires that the
    short cut menu have an owner dialog.
  </para>
  <para>
    It is not neccessary to assign a short cut menu to a dialog, it just may be more convenient.  If the shortcut menu
    does not have an assigned dialog, then the owner dialog must be specified each time the
 <xref linkend="mthTrack"/> or <xref linkend="mthShowClsPopupMenu"/> methods are invoked.
  </para>
  <para>
    A short cut menu can only be assigned to one dialog, if this menu is already assigned to a dialog, the owner dialog
    is replaced by the specified dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis> This menu has been destroyed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> <emphasis
        role="italic">dlg</emphasis> is not a <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example calls a function that creates a context menu and then assigns the menu to the dialog object:
<programlisting>
<![CDATA[

  contextMenu = createListViewMenu()

  if \ contextMenu~assignTo(self, .true) then do
    say 'Error assigning the context menu. SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::assignTo() -->

<section id="mthConnectContextMenu" xreflabel="connectContextMenu"><title>connectContextMenu</title>
<indexterm><primary>connectContextMenu</primary><secondary>PopupMenu class</secondary><tertiary>instance method</tertiary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>connectContextMenu</secondary><tertiary>instance method</tertiary></indexterm>
<programlisting>
<![CDATA[
>>--connectContextMenu(--methodName--+--------+--+---------+--)----------------><
                                     +-,-dlg--+  +-,-hwnd--+
]]>
</programlisting>

<para>
  Connects the context menu <xref linkend="ovvEvents"/> notification to a method in a Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>methodName [required]</term>
    <listitem>
    <para>
      The method in the Rexx dialog to be invoked when the event happens.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      By default, the notification is connected to the owner dialog of the menu. However, the programmer can specify any
      Rexx dialog here to connect the notification to. If the menu does not have an owner dialog then the programmer
      must specify the Rexx dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>hwnd [optional]</term>
    <listitem>
    <para>
      A window handle to filter the right-clicks on. This can be the window handle of any control in the dialog being
      connected, or even the dialog window handle itself. If used, only right-clicks on the specified window will be
      received. If omitted, all right-clicks on the dialog are received.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The context menu event is generated when the user right-mouse clicks on a window. The event can also be generated by
    the keyboard by using SHIFT-F10 or the VK_APPS key (the Applications key on a Natural keyboard.) The <emphasis
    role="italic">ContextMenu Event Handler</emphasis> <link linkend="evtPopupMenuCONTEXT">section</link> has
    information on how to code the event handler.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  <para>
    If the programmer does not provide a method named <emphasis role="italic">methodName</emphasis> in the Rexx dialog,
    a syntax condition will be raised if any context menu events happen.
  </para>
  <para>
    The underlying dialog receives the WM_CONTEXTMENU message as the notification for this event.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example the context menu notification is connected to the method, <emphasis
    role="italic">onContextMenu</emphasis>. All
<programlisting>
<![CDATA[
::method initDialog
  ...

  lvHwnd = self~newListView(IDC_LV_EMPLOYEES)~hwnd
  .PopupMenu~connectContextMenu(self, "onListViewContext", lvHwnd)

  .PopupMenu~connectContextMenu(self, "onDialogContext", self~hwnd)

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::connectContextMenu()::InstanceMethod -->

<section id="mthIsAssigned" xreflabel="isAssigned"><title>isAssigned</title>
<indexterm><primary>isAssigned</primary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>isAssigned</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isAssigned-----------------------------------><

]]>
</programlisting>

<para>
  Determines if this menu has an assigned owner.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true if this menu has been assigned to an owner dialog, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Only popup menus can be assigned to a dialog, menu bars are <emphasis role="italic">attached</emphasis> to dialogs.
    Only popup menus that are used as context menus need to be <xref linkend="mthAssignTo"/> to a dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Resets the <xref linkend="dotSystemErrorCode"/> to 0. There are no operating system
    errors that would change that.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example checks if the context menu is already assigned to a dialog before assigning it to the current dialog
    object:
<programlisting>
<![CDATA[

  if \ contextMenu~isAssigned then do
    if \ contextMenu~assignTo(self, .true) then do
      say 'Error assigning the context menu. SystemErrorCode:' || -
      .SystemErrorCode SysGetErrortext(.SystemErrorCode)
    end
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::isAssigned() -->

<section id="mthShowClsPopupMenu" xreflabel="show"><title>show</title>
<indexterm><primary>show</primary><secondary>PopupMenu class</secondary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>show</secondary></indexterm>
<programlisting>
<![CDATA[
>>--show(--p--+-------+--+--------+--+--------------+--+---------------+--)----><
              +-,-dlg-+  +-,-opts-+  +-,-bothButtons-+  +-,-excludeRect-+
]]>
</programlisting>

<para>
  Displays a context menu and returns after the user has selected an item or canceled the menu.  When the user selects an
  item, a <xref linkend="sctMenuCommandEvents"/> notification, using the id of the menu item selected, is generated. If the
  user cancels, nothing happens.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>p [required]</term>
    <listitem>
    <para>
      A <xref linkend="clsPoint"/> object specifying the location for the shortcut menu, in
      screen <xref linkend="defScreenCoordinates"/>) coordinates.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      The Rexx dialog object that the menu should be assigned to. If the menu has already been assigned an owner dialog
      this argument can be omitted. If there is no already assigned dialog, this argument is required. Any menu
      displayed on the screen is required by the operating system to have an assigned dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, specifying additional options for the shortcut
      menu, case is not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>LEFT           </member>
        <member>HCENTER        </member>
        <member>RIGHT          </member>
        <member>TOP            </member>
        <member>VCENTER        </member>
        <member>BOTTOM         </member>
        <member>HORNEGANIMATION</member>
        <member>HORPOSANIMATION</member>
        <member>NOANIMATION    </member>
        <member>VERNEGANIMATION</member>
        <member>VERPOSANIMATION</member>
        <member>HORIZONTAL     </member>
        <member>VERTICAL       </member>
        <member>RECURSE        </member>
        <member>LAYOUTRTL      </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>LEFT</term>
        <listitem>
        <para>
          Centers the shortcut menu horizontally relative to the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HCENTER</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its left side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RIGHT</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its right side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the LEFT, HCENTER, or RIGHT keywords. RIGHT is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TOP</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its top side is aligned with the Y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VCENTER</term>
        <listitem>
        <para>
          Centers the shortcut menu vertically relative to the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>BOTTOM</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its bottom side is aligned with the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the TOP, VCENTER, or BOTTOM keywords. BOTTOM is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from right to left.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from left to right.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOANIMATION</term>
        <listitem>
        <para>
          Displays menu without animation.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from bottom to top.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from top to bottom.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORIZONTAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested horizontal alignment before the requested vertical alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERTICAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested vertical alignment before the requested horizontal alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RECURSE</term>
        <listitem>
        <para>
          Used to display a menu when another menu is already displayed. This is intended to support context menus
          within a menu.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LAYOUTRTL</term>
        <listitem>
        <para>
          Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later. Use right to left
          text layout. By default left to right text layout is used.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>bothButtons [optional]</term>
    <listitem>
    <para>
      If true, the user can use either the right or the left buttons to select a menu item. If false only the left
      button can be used. The defualt if omitted is false.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>excludeRect [optional]</term>
    <listitem>
    <para>
      A <xref linkend="clsRect"/> object that specifies an area of the screen the menu should not overlap.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success and <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">show</emphasis> and the <xref linkend="mthTrack"/> methods are both used to
    display a shortcut menu. The only difference is that when the <emphasis role="italic">show</emphasis> method is
    used, a menu command event is generated when the user selects a menu command item, but the <emphasis
    role="italic">track</emphasis> method directly returns the ID of the menu item selected.
  </para>
  <para>
    For any animation to occur, the System Parameters Information menu animation must be on. (
 <xref linkend="clsSPI"/> class, <xref linkend="atrMenuAnimation"/> attribute.) In addition,
    all the animation flags, except NOANIMATION, are ignored if menu fade animation is on. (
 <xref linkend="clsSPI"/> class, <xref linkend="atrMenuFade"/> attribute.)
  </para>
  <para>
    Microsoft says that it is essential that the System Metric, menu drop alignment (<xref linkend="clsSM"/> class, <xref
    linkend="atrMenuDropAlignment"/> attribute,) be checked to determine the correct horizontal alignment flag (LEFT or
    RIGHT) and/or horizontal animation direction flag (HORPOSANIMATION or HORNEGANIMATION) to use. The say it is essential
    for creating the optimal user experience, especially when developing Microsoft Tablet PC applications.
  </para>
  <para>
    Microsoft also notes that to display a context menu for a notification icon, the current window must be the
    foreground window before invoking the <emphasis role="italic">show</emphasis> or
 <xref linkend="mthTrack"/> methods. Otherwise, the menu will not disappear when the user clicks outside of the
    menu or the window that created the menu (if it is visible).
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_HANDLE (1400)</term>
      <listitem>
      <para>
        Invalid window handle. <emphasis role="bold">Meaning:</emphasis> The window handle for the dialog could not be
        obtained.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis> This menu has been destroyed, or is no longer
        valid for some reason.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument was specified, but the object is not a
        <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a context menu:
<programlisting>
<![CDATA[

  pos = .Point~new(x, y)

  ret = dlgPopup~show(pos, self)
  if ret == -1 then do
    say 'dlgPopup~show() failed SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end

  return 0
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::show() -->

<section id="mthTrack" xreflabel="track"><title>track</title>
<indexterm><primary>track</primary></indexterm>
<indexterm><primary>PopupMenu class</primary><secondary>track</secondary></indexterm>
<programlisting>
<![CDATA[
>>--track(--p--+-------+--+--------+--+--------------+--+---------------+--)---><
               +-,-dlg-+  +-,-opts-+  +-,-bothButtons-+  +-,-excludeRect-+
]]>
</programlisting>

<para>
  Displays a context menu and returns the menu ID that the user has selected.  When the user selects an item, <emphasis
  role="italic">no</emphasis> <xref linkend="sctMenuCommandEvents"/> notification is generated. If the user cancels the menu
  0 is returned.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>p [required]</term>
    <listitem>
    <para>
      A <xref linkend="clsPoint"/> object specifying the location for the shortcut menu, in
      screen <xref linkend="defScreenCoordinates"/>) coordinates.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      The Rexx dialog object that the menu should be assigned to. If the menu has already been assigned an owner dialog
      this argument can be omitted. If there is no already assigned dialog, this argument is required. Any menu
      displayed on the screen is required by the operating system to have an assigned dialog.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, specifying additional options for the shortcut
      menu, case is not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>LEFT           </member>
        <member>HCENTER        </member>
        <member>RIGHT          </member>
        <member>TOP            </member>
        <member>VCENTER        </member>
        <member>BOTTOM         </member>
        <member>HORNEGANIMATION</member>
        <member>HORPOSANIMATION</member>
        <member>NOANIMATION    </member>
        <member>VERNEGANIMATION</member>
        <member>VERPOSANIMATION</member>
        <member>HORIZONTAL     </member>
        <member>VERTICAL       </member>
        <member>RECURSE        </member>
        <member>LAYOUTRTL      </member>
      </simplelist>
      <variablelist>
        <varlistentry><term>LEFT</term>
        <listitem>
        <para>
          Centers the shortcut menu horizontally relative to the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HCENTER</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its left side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RIGHT</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its right side is aligned with the x coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the LEFT, HCENTER, or RIGHT keywords. RIGHT is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TOP</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its top side is aligned with the Y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VCENTER</term>
        <listitem>
        <para>
          Centers the shortcut menu vertically relative to the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>BOTTOM</term>
        <listitem>
        <para>
          Positions the shortcut menu so that its bottom side is aligned with the y coordinate specified by the <emphasis
          role="italic">p</emphasis> argument. Specify only one of the TOP, VCENTER, or BOTTOM keywords. BOTTOM is the
          default if none of the keywords is used.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from right to left.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from left to right.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOANIMATION</term>
        <listitem>
        <para>
          Displays menu without animation.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERNEGANIMATION</term>
        <listitem>
        <para>
          Animates the menu from bottom to top.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERPOSANIMATION</term>
        <listitem>
        <para>
          Animates the menu from top to bottom.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HORIZONTAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested horizontal alignment before the requested vertical alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>VERTICAL</term>
        <listitem>
        <para>
          If the menu cannot be shown at the specified location without overlapping the excluded rectangle, the OS tries
          to accommodate the requested vertical alignment before the requested horizontal alignment.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RECURSE</term>
        <listitem>
        <para>
          Used to display a menu when another menu is already displayed. This is intended to support context menus
          within a menu.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>LAYOUTRTL</term>
        <listitem>
        <para>
          Requires Common Control <xref linkend="ovvComctl32"/> version 6.0 or later. Use right to left
          text layout. By default left to right text layout is used.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>bothButtons [optional]</term>
    <listitem>
    <para>
      If true, the user can use either the right or the left buttons to select a menu item. If false only the left
      button can be used. The defualt if omitted is false.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>excludeRect [optional]</term>
    <listitem>
    <para>
      A <xref linkend="clsRect"/> object that specifies an area of the screen the menu should not overlap.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a non-negative number on success, -1 on error.  On success, the return is either 0, meaning the user
    canceled the menu, or the id of the menu item selected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">track</emphasis> and the <xref linkend="mthShowClsPopupMenu"/> methods are both used
    to display a shortcut menu. The only difference is that when the <emphasis role="italic">show</emphasis> method is
    used, a menu command event is generated when the user selects a menu command item and when the <emphasis
    role="italic">track</emphasis> method directly returns the ID of the menu item selected.
  </para>
  <para>
    For any animation to occur, the System Parameters Information menu animation must be on. (
 <xref linkend="clsSPI"/> class, <xref linkend="atrMenuAnimation"/> attribute.) In addition,
    all the animation flags, except NOANIMATION, are ignored if menu fade animation is on. (
 <xref linkend="clsSPI"/> class, <xref linkend="atrMenuFade"/> attribute.)
  </para>
  <para>
    Microsoft says that it is essential that the System Metric, menu drop alignment (<xref linkend="clsSM"/> class, <xref
    linkend="atrMenuDropAlignment"/> attribute,) be checked to determine the correct horizontal alignment flag (LEFT or
    RIGHT) and/or horizontal animation direction flag (HORPOSANIMATION or HORNEGANIMATION) to use. The say it is essential
    for creating the optimal user experience, especially when developing Microsoft Tablet PC applications.
  </para>
  <para>
    Microsoft also notes that to display a context menu for a notification icon, the current window must be the
    foreground window before invoking the <emphasis role="italic">show</emphasis> or
 <xref linkend="mthTrack"/> methods. Otherwise, the menu will not disappear when the user clicks outside of the
    menu or the window that created the menu (if it is visible).
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_WINDOW_HANDLE (1400)</term>
      <listitem>
      <para>
        Invalid window handle. <emphasis role="bold">Meaning:</emphasis> The window handle for the dialog could not be
        obtained.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_MENU_HANDLE (1401)</term>
      <listitem>
      <para>
        Invalid menu handle.  <emphasis role="bold">Meaning:</emphasis> This menu has been destroyed, or is no longer
        valid for some reason.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument was specified, but the object is not a
        <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a context menu using the <emphasis role="italic">track</emphasis> method:
<programlisting>
<![CDATA[

  pos = .Point~new(x, y)

  id = dlgPopup~track(pos, self)
  if id == -1 then do
    say 'dlgPopup~track() failed SystemErrorCode:' || -
    .SystemErrorCode SysGetErrortext(.SystemErrorCode)
  end
  else do
    return self~doMenuCommand(ret
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End PopupMenu::track() -->

</section>  <!-- End PopupMenu class -->

<section id="clsSystemMenu" xreflabel="SystemMenu"><title>SystemMenu Class</title>
<indexterm><primary>SystemMenu class</primary></indexterm>
<para>
  The System menu is also known as the <emphasis role="italic">Window</emphasis> or <emphasis
  role="italic">Control</emphasis> menu. The System menu is normally defined and managed completely by the operating
  system. It is a pop-up menu that the user can open by clicking on the application icon in the title bar, or by right
  clicking anywhere on the title bar. The <computeroutput>SystemMenu</computeroutput> class provides methods for the
  programmer to work with and manipulate the Windows System menu.
</para>
<para>
  The OS provides a standard set of menu items on the System menu that the user can choose to size or move a window,
  close a window, etc..  Menu items can be added, removed, and modified, but most applications just leave the System
  menu alone. A dialog window can have a System menu. For normal windows it is unusual to not have a System menu, but
  many simple dialogs do not use a System menu.
</para>
<para>
  When a user selects a System menu item an <xref linkend="ovvEvents"/> notification is sent to the owner
  window of the menu. However, most applications don't process the notification, but rather let the OS handle the
  notification with the default processing. The ooDialog programmer can connect the event notification to a method in
  her Rexx dialog in the same manner as other event notifications are connected. If the programmer adds menu command
  items to the System menu, the event notification for the item should be connected and processed by the
  application.
</para>

<section id="sctMethodsSystemMenu"><title>Method Table</title>
<para>
  The following table lists the constant, class, attribute, and instance methods of the SystemMenu.
<table id="tblMethodsSystemMenu" frame="all"> <title>Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="3*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><link linkend="sctSystemMenuConstantMethods">Constant Methods</link></entry>
<entry>The SystemMenu object provides a number of <emphasis role="italic">constant</emphasis> values through the <computeroutput>::constant</computeroutput>directive.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsSystemMenu"/> (Class)</entry>
<entry>Instantiates and returns a new system menu object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthConnectAllCommandEventsClsSystemMenu"/></entry>
<entry>.</entry>
</row>
<row>
<entry><xref linkend="mthConnectCommandEventClsSystemMenu"/></entry>
<entry>.</entry>
</row>
<row>
<entry><xref linkend="mthConnectSomeCommandEventsClsSystemMenu"/></entry>
<entry>.</entry>
</row>
<row>
<entry><xref linkend="mthRevert"/></entry>
<entry>.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="sctSystemMenuConstantMethods"><title>Constant Methods</title>
<indexterm><primary>constant methods</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>constant methods</secondary></indexterm>
<para>
  The <computeroutput>SystemMenu</computeroutput> object provides a number of <emphasis
  role="italic">constant</emphasis> values through the use of the <computeroutput>::constant</computeroutput> directive.
  The constants are listed and documented in this section. These constants are the <emphasis role="italic">menu item
  <xref linkend="sctMenuItemIDs"/>s</emphasis> for all System menu command items.
</para>
<para>
  Recall that the constant methods defined by the <computeroutput>::constant</computeroutput> directive are both class
  and instance methods of the class they are defined in. The constants listed here are defined in the
  <computeroutput>SystemMenu</computeroutput> class. Therefore to access the constant value, the programmer uses either
  the <computeroutput>SystemMenu</computeroutput> class object, or an instantiated system menu object.
</para>
<para>
  Note that for completeness, all the known system menu command items are defined and listed here. Microsoft does not
  explain what some of the command items are for. The constants can be used where ever a system menu command item
  identifier is needed. The constants provided by the system menu object are listed in the table below. The number in
  parentheses is the decimal value of the constant:
</para>
<table id="tblConstantsSystemMenu" frame="all"> <title>SystemMenu Object Constant Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="3*" />
<thead>
<row>
<entry>Constant Symbol</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry>SC_ARRANGE</entry>
<entry>Not explained. (61712)</entry>
</row>
<row>
<entry>SC_CLOSE</entry>
<entry>Closes the window. (61536)</entry>
</row>
<row>
<entry>SC_CONTEXTHELP</entry>
<entry>Changes the cursor to a question mark with a pointer. If the user then clicks a control in the dialog box, the control receives a WM_HELP message. (61824)</entry>
</row>
<row>
<entry>SC_DEFAULT</entry>
<entry>Selects the default item; the user double-clicked the window menu. (61792)</entry>
</row>
<row>
<entry>SC_HOTKEY</entry>
<entry>Activates the window associated with the application-specified hot key. (61776)</entry>
</row>
<row>
<entry>SC_HSCROLL</entry>
<entry>Scrolls horizontally. (61568)</entry>
</row>
<row>
<entry>SC_KEYMENU</entry>
<entry>Retrieves the window menu as a result of a keystroke. (61696)</entry>
</row>
<row>
<entry>SC_MAXIMIZE</entry>
<entry>Maximizes the window. (61488)</entry>
</row>
<row>
<entry>SC_MINIMIZE</entry>
<entry>Minimizes the window.. (61472)</entry>
</row>
<row>
<entry>SC_MONITORPOWER</entry>
<entry>Sets the state of the display. This command supports devices that have power-saving features, such as a battery-powered personal computer. (61808)</entry>
</row>
<row>
<entry>SC_MOVE</entry>
<entry>Moves the window. (61456)</entry>
</row>
<row>
<entry>SC_MOUSEMENU</entry>
<entry>Retrieves the window menu as a result of a mouse click. (61584)</entry>
</row>
<row>
<entry>SC_NEXTWINDOW</entry>
<entry>Moves to the next window. (61504)</entry>
</row>
<row>
<entry>SC_PREVWINDOW</entry>
<entry>Moves to the previous window. (61520)</entry>
</row>
<row>
<entry>SC_RESTORE</entry>
<entry>Restores the window to its normal position and size. (61728)</entry>
</row>
<row>
<entry>SC_SCREENSAVE</entry>
<entry>Executes the screen saver application specified in the [boot] section of the System.ini file. (61760)</entry>
</row>
<row>
<entry>SC_SEPARATOR</entry>
<entry>ID of the menu separator item. (61455)</entry>
</row>
<row>
<entry>SC_SIZE</entry>
<entry>Sizes the window. (61440)</entry>
</row>
<row>
<entry>SC_TASKLIST</entry>
<entry>Activates the Start menu. (61744)</entry>
</row>
<row>
<entry>SC_VSCROLL</entry>
<entry>Scrolls vertically. (61552)</entry>
</row>
</tbody></tgroup>
</table>
</section>

<section id="mthNewClsSystemMenu" xreflabel="new"><title>new (Class)</title>
<indexterm><primary>new</primary><secondary>SystemMenu class</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--dlg--)---------------------------------><

]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>SystemMenu</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>dlg</term>
    <listitem>
    <para>
      The Rexx dialog object that contains the System menu. To be explicit, the dialog must have a System menu. A
      <computeroutput>SystemMenu</computeroutput> object can not be initialized if the dialog does not already have a
      System menu.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new <computeroutput>SystemMenu</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The underlying menu object is a copy of the System menu of the specified dialog.  Once the copy is made, the System
    menu can be manipulated and modified just like other menu objects.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected. Raises errors for all failures. If no errors are raised,
    the system menu object is valid.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example instantiates a new <computeroutput>SystemMenu</computeroutput> object and then adds a couple of menu
    items to the system menu:
<programlisting>
<![CDATA[

::method initDialog
  expose menu sysMenu

  -- Attach our menu bar to this dialog.
  if \ menu~attachTo(self) then self~error('Failed to attach menu')

  -- Get the system menu.
  sysMenu = .SystemMenu~new(self)

  -- Modify the system menu by inserting 3 menu items.  Each item is inserted
  -- before the fist item in the menu.  The .true arg specifies that the menu
  -- item ID (the first arg) is by position, rather than the default of a
  -- resource ID.
  sysMenu~insertSeparator(1, IDM_SYS_SEP1, .true)
  sysMenu~insertItem(1, IDM_SYS_REMOVE_EDIT, 'Remove Edit Menu', , , .true)
  sysMenu~insertItem(1, IDM_SYS_ADD_EDIT, 'Add Edit Menu', , , .true)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::new() -->

<section id="mthConnectAllCommandEventsClsSystemMenu" xreflabel="connectAllCommandEvents"><title>connectAllCommandEvents</title>
<indexterm><primary>connectAllCommandEvents</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>connectAllCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectAllCommandEvents(--+-------+--+-------+--)-----------><
                              +--mth--+  +-,-dlg-+
]]>
</programlisting>

<para>
  Connects every command item in the system menu to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object.  The default is to connect the command
      items to the owner dialog of this menu. Since <computeroutput>SystemMenu</computeroutput> objects already have an
      owner dialog, there is no need to use this argument.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog
        <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects every menu command item in the system menu to the <emphasis
    role="italic">onMenuSelect</emphasis> method in the dialog:
<programlisting>
<![CDATA[

::method connectSystemMenu unguarded private
  use strict arg sysMenu

  if \ sysMenu~connectAllCommandEvents(onMenuSelect) then self~error('Connect All Items Failed')

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::connectAllCommandEvents() -->

<section id="mthConnectCommandEventClsSystemMenu" xreflabel="connectCommandEvent"><title>connectCommandEvent</title>
<indexterm><primary>connectCommandEvent</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>connectCommandEvent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectCommandEvent(--id--,--methodName--+--------+--)---------------------><
                                             +-,-dlg--+
]]>
</programlisting>

<para>
  Connects a system menu command item <xref linkend="ovvEvents"/> notification with a method in a Rexx
  dialog. The notification is sent to the Windows dialog when a command item in a system menu is selected by the user.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the menu item, may be <xref linkend="itmMenuSymbolicIDs"/> or numeric. The
        <link linkend="sctSystemMenuConstantMethods">constants</link> provided by the
        <computeroutput>SystemMenu</computeroutput> class can be used for the default items in a system menu.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>methodName [required]</term>
      <listitem>
      <para>
        The name of the method in the Rexx dialog to connect the notification to. This can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>dlg [optional]</term>
      <listitem>
      <para>
        A Rexx dialog to connect the notification to. By default, the notification is is connected to the Rexx dialog that
        the menu is <xref linkend="mthAttachTo"/> or <xref linkend="mthAssignTo"/> to. If
        omitted and there is no assigned or attached dialog, no connection is made and the
        <xref linkend="dotSystemErrorCode"/> is set as described in the Details section. (To connect a
        menu item command event, there must be a dialog to connect it to.)
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, otherwise <computeroutput>.false</computeroutput>. If
    there is an error, the <computeroutput>.systemErrorCode</computeroutput> is set as described in the Details section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When using the <emphasis role="italic">connectCommandEvent</emphasis> method to connect menu command events, the
    programmer must use a menu item <xref linkend="sctMenuItemIDs"/>, not a menu item <emphasis
    role="italic">position</emphasis> identifier.
  </para>
  <para>
    The <emphasis role="italic">connectCommandEvent</emphasis> method is used for all types of menus. However, the
    programmer should be aware of the differences in coding event
    <xref linkend="sctMenuCommandEventHandlers"/>s for <computeroutput>SystemMenu</computeroutput> events and
    other types of menus. See the <link linkend="sctSystemMenuCommandEventHandler">section</link>/> explaining the event
    handler for system menu command events.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on error. The system error code is set this way
    in addition to what the OS might set:
    <variablelist>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_FUNCTION (1)</emphasis></term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_INVALID_PARAMETER (87)</emphasis></term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">methodName</emphasis> argument can not be the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_WINDOW_NOT_DIALOG (1420)</emphasis></term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The <emphasis
        role="italic">dlg</emphasis> argument is not a <computeroutput>PlainBaseDialog</computeroutput>, (or subclass of
        course.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">ERROR_NOT_ENOUGH_MEMORY (8)</emphasis></term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::connectCommandEvent() -->

<section id="mthRevert" xreflabel="revert"><title>revert</title>
<indexterm><primary>revert</primary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>revert</secondary></indexterm>
<programlisting>
<![CDATA[
>>--revert---------------------------------------><

]]>
</programlisting>

<para>
  Reverts the system menu for the dialog back to the standard system menu.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a <computeroutput>SystemMenu</computeroutput> object is instantiated, it receives a copy of the system menu
    for the dialog. (The operating system maintains the standard system menu.) This method reverses that process. The
    operating system removes the copied system menu and replaces it with the standard system menu.
  </para>
  <para>
    This object will then no longer be valid.  <emphasis role="italic">Note</emphasis> however that any of the
    pre-defined System Command menu items that were connected to methods, will remain connected. Currently in ooDialog
    there is no way to 'unconnect' a method connection once it is made.
  </para>
  <para>
    The operating system will only revert back to the standard system menu. A dialog that does not have minimize and
    maximize buttons is originally given a standard system menu, where the operating system has removed the menu items
    that are not applicable. Namely, the Restore, Size, Maximize and Minimize menu items.
  </para>
  <para>
    When the operating system reverts back to the standard system menu on these dialogs, it does not remove these menu
    items. There is nothing the programmer can do about this, because only the operating system has access to the
    standard system menu.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example reverts the system menu for the dialog back to the standard system menu.
<programlisting>
<![CDATA[

::method onRevert
  expose sysMenu

  if \ sysMenu~revert then say 'revert() failed' .SystemErrorCode SysGetErrortext(.SystemErrorCode)
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::revert() -->

<section id="mthConnectSomeCommandEventsClsSystemMenu" xreflabel="connectSomeCommandEvents"><title>connectSomeCommandEvents</title>
<indexterm><primary>connectSomeCommandEvents</primary><secondary>SystemMenu class</secondary></indexterm>
<indexterm><primary>SystemMenu class</primary><secondary>connectSomeCommandEvents</secondary></indexterm>
<programlisting>
<![CDATA[
>>--connectSomeCommandEvents(--ids-+-------+-+--------------+-+-------+--)-----><
                                   +-,-mth-+ +-,-byPosition-+ +-,-dlg-+
]]>
</programlisting>

<para>
  Connects a collection of menu command items to a method, or methods, in the Rexx dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>ids [required]</term>
    <listitem>
    <para>
      A <computeroutput>Collection</computeroutput> object containing the menu item
      <xref linkend="sctMenuItemIDs"/>s to connect.  The IDs can be by position IDs or resource IDs,
      depending on the value of the <emphasis role="italic">byPosition</emphasis> argument. However, they must be all
      the same type, all resource IDs or all by position IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>mth [optional]</term>
    <listitem>
    <para>
      Connect all menu command items to the method of this name. The default is to connect all menu command items to a
      method name composed from the text of the command item. If not omitted, <emphasis role="italic">mth</emphasis> can
      not be the empty string.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>byPosition [optional]</term>
    <listitem>
    <para>
      If true, the IDS are by positional IDs, otherwise the are resource IDs. The default is false, they are resource
      IDs.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>dlg [optional]</term>
    <listitem>
    <para>
      Connect the command items to the method(s) of this dialog object.  The default is to connect the command
      items to the owner dialog of this menu. Since <computeroutput>SystemMenu</computeroutput> objects already have an
      owner dialog, there is no need to use this argument.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">ids</emphasis> argument can be any ooRexx collection with a <emphasis
    role="italic">makeArray</emphasis> method that returns an array whose <emphasis role="italic">items</emphasis> are
    the menu item IDs to connnect.
  </para>
  <para>
    This method quits when an error is detected. This implies that on an error return some menu items may have been
    connected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/> on failure. In addition to error codes set by
    the operating system, the following error codes may be set by ooDialog:
    <variablelist>
      <varlistentry><term>ERROR_INVALID_FUNCTION (1)</term>
      <listitem>
      <para>
        Incorrect function. <emphasis role="bold">Meaning:</emphasis> The dialog argument was omitted and the menu does
        not have an assigned dialog.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_NOT_ENOUGH_MEMORY (8)</term>
      <listitem>
      <para>
        Not enough storage is available to process this command. <emphasis role="bold">Meaning:</emphasis> The dialog
        message table is full.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_INVALID_PARAMETER (87)</term>
      <listitem>
      <para>
        The parameter is incorrect. <emphasis role="bold">Meaning:</emphasis> One or more of the specified item IDs is
        not a menu command item.  Or the msg argument was used, but it is the empty string.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ERROR_WINDOW_NOT_DIALOG (1420)</term>
      <listitem>
      <para>
        The window is not a valid dialog window. <emphasis role="bold">Meaning:</emphasis> The dialog argument was not
        ommitted, but the <emphasis role="italic">dlg</emphasis> is not a dialog
        <xref linkend="chpDialogObject"/> object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example connects the Close, Size, and Move command items in the System menu to 3 methods in the dialog. Note
    that those methods will be: closeAltF4(), size(), and move()
<programlisting>
<![CDATA[

::method systemMenuConnectItems
  expose sysMenu
  use strict arg

  ids = .array~of(self~SC_CLOSE, self~SC_SIZE, self~SC_MOVE)

  if \ sysMenu~connectSomeCommandEvents(ids) then self~error('Connect Some Items Failed')


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SystemMenu::connectSomeCommandEvents() -->

</section>  <!-- End SystemMenu class -->

</chapter>
