<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2005-2022 Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter id="utilityclasses"><title>Utility Classes, Routines, and Objects</title>
<indexterm><primary>Utility Classes</primary></indexterm>
<para>
  The ooDialog framework provides a number of utility classes and public routines that are useful when writing more complex
  programs.  These classes and routines do not easily fit into the category of a type of dialog or a type of dialog
  control and are therefore documented separately.  In addition, ooDialog places some globally available
  objects in the <computeroutput>.local</computeroutput> environment.
</para>
<para>
  The classes, routines, and objects in the following table are described in this chapter:
<table id="tUtilityClasses" frame="all">
<title>ooDialog Utility Classes, Routines, and Objects</title>
<tgroup cols="2">
<colspec colwidth="6*"/>
<colspec colwidth="19*"/>
<thead>
<row>
<entry>Utility Class, Routine, or Object</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="dotApplication"/></entry>
<entry>An instance of the <computeroutput>ApplicationManager</computeroutput> class that is present in all ooDialog programs.</entry>
</row>
<row>
<entry><xref linkend="clsApplicationManager"/></entry>
<entry>Manages application (global) settings for a single ooDialog program.</entry>
</row>
<row>
<entry><xref linkend="dotConstDir"/></entry>
<entry>an ooRexx <computeroutput>.Directory</computeroutput> object used to resolve <link linkend="ovvSymbolicIDMechanism">symbolic</link> IDs.</entry>
</row>
<row>
<entry><xref linkend="clsDayState"/></entry>
<entry>Represents the state of each day within a single month. A helper class for the <xref linkend="clsMonthCalendar"/>.</entry>
</row>
<row>
<entry><xref linkend="clsDayStates"/></entry>
<entry>A sequential collection of day state objects.</entry>
</row>
<row>
<entry><xref linkend="clsDlgArea"/></entry>
<entry>Assists in laying out the dialog controls in a dynamically defined dialog.</entry>
</row>
<row>
<entry><xref linkend="clsDlgAreaU"/></entry>
<entry>Assists in the creation of dynamically resizable dialogs.</entry>
</row>
<row>
<entry><xref linkend="clsDlgUtil"/></entry>
<entry>Provides some common, useful, utilities for working with dialogs.</entry>
</row>
<row>
<entry><xref linkend="rtnFindWindow"/></entry>
<entry>Searches the desktop for a specific window and returns its handle.</entry>
</row>
<row>
<entry><xref linkend="rtnLocate"/></entry>
<entry>Returns the directory containing the Rexx source code file that <emphasis role="italic">Locate</emphasis> is executing in. Similar to <emphasis role="italic">parse source</emphasis>.</entry>
</row>
<row>
<entry><xref linkend="rtnMSSleep"/></entry>
<entry>Sleeps for the specified number of milliseconds.</entry>
</row>
<row>
<entry><xref linkend="clsOS"/></entry>
<entry>Provides methods for accessing information about the operating system.</entry>
</row>
<row>
<entry><xref linkend="rtnPlay"/></entry>
<entry>Used to play audio sounds.</entry>
</row>
<row>
<entry><xref linkend="clsPoint"/></entry>
<entry>An object that represents a point in a 2-D coordinate system.</entry>
</row>
<row>
<entry><xref linkend="clsRect"/></entry>
<entry>An object used to represent a rectangle in a 2-D coordinate system.</entry>
</row>
<row>
<entry><xref linkend="rtnScreenSize"/></entry>
<entry>Obtains the screen size in dialog units and in pixels.</entry>
</row>
<row>
<entry><xref linkend="clsSize"/></entry>
<entry>An object encapsulating a width and height dimension in a 2-D coordinate system.</entry>
</row>
<row>
<entry><xref linkend="clsSM"/></entry>
<entry>A class whose attributes reflect the system metrics or configuration settings of the computer.</entry>
</row>
<row>
<entry><xref linkend="clsSPI"/></entry>
<entry>A class whose attributes reflect the system-wide parameters of the computer.</entry>
</row>
<row>
<entry><xref linkend="dotSystemErrorCode"/></entry>
<entry>Reflects the <xref linkend="defSystemErrorCode"/>, if set.</entry>
</row>
<row>
<entry><xref linkend="clsVK"/></entry>
<entry>Translates back and forth between virtual key code numbers and symbolic names.</entry>
</row>
<row>
<entry><xref linkend="clsWindow"/></entry>
<entry>An utility class with methods common to all windows.</entry>
</row>
<row>
<entry><xref linkend="rtnWinTimer"/></entry>
<entry>Depending on the specified mode, creates, waits on, or releases a periodic Windows timer.</entry>
</row>
</tbody></tgroup>
</table>
</para>


<section id="dotApplication" xreflabel=".application"><title>.application object</title>
<indexterm><primary>.application</primary></indexterm>
<para>
  The <computeroutput>.application</computeroutput> object is an instance of the
 <xref linkend="clsApplicationManager"/> class that is present in all ooDialog programs. The
  object is initialized and placed in the <computeroutput>.local</computeroutput> environment when the ooDialog package
  is loaded.
</para>
<para>
  The <computeroutput>.application</computeroutput> object is used by the programmer to manage application wide settings
  and constants. Its use is primarily to change global default values of ooDialog. For instance, by default,
  <link linkend="paraAutomaticDataDetection">automatic</link> data detection is on. (Automatic data detection is part of the
  <link linkend="sctUnderstandingDataAttributes">data</link> attributes concept.) The
  <computeroutput>.application</computeroutput> object can be used to change the default for all dialogs in a
  application to off.
</para>
<para>
  It would be most common to use the <computeroutput>.application</computeroutput> object at the start of a program.
  This example shows a typical way of changing the default for automatic data detection off for the entire application:
</para>
<programlisting>
<![CDATA[

  .application~autoDetection(.false)

  dlg = .SimpleDialog~new("UserMenuBar.rc", IDD_MAIN_DIALOG)
  if dlg~initCode <> 0 then do
    return 99
  end

  dlg~execute("SHOWTOP")
  ...

]]>
</programlisting>
</section>


<section id="clsApplicationManager" xreflabel="ApplicationManager"><title>ApplicationManager Class</title>
<indexterm><primary>ApplicationManager class</primary></indexterm>
<para>
  An application manager is used to set certain application wide defaults and to perform tasks that effect the entire
  ooDialog application. Examples of application wide defaults are the default
  <link linkend="mthClsGetFontName">font</link> and font <link linkend="mthClsGetFontSize">size</link>, whether
  <link linkend="mthInitAutoDetection">automatic</link> data detection is on or off, etc.. An example of a task that effects
  the entire application is the populating of the <xref linkend="dotConstDir"/> with symbols.
</para>
<para>
  When an ooDialog application starts, the ooDialog framework instantiates an
  <computeroutput>ApplicationManager</computeroutput> object and places it in the
  <computeroutput>.local</computeroutput> environment as the <xref linkend="dotApplication"/>. Only one instance of an
  <computeroutput>ApplicationManager</computeroutput> per application can be instantiated. In practice this means that the
  ooRexx programmer can not create a new <computeroutput>ApplicationManager</computeroutput> object. The programmer invokes
  all methods of the <computeroutput>ApplicationManager</computeroutput> through the
  <computeroutput>.application</computeroutput> object.
</para>

<section id="sctMethodsApplicationMgr"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>ApplicationManager</computeroutput> class:

<table id="tblMethodsApplicationMgr" frame="all"> <title>ApplicationManager Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewApplicationManager"/></entry>
<entry>A new application manager can not be instantiated in Rexx code.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
</row>
<row>
<entry><xref linkend="ruapConstDir"/></entry>
<entry>A directory object that maps symbolic resource IDS to their numeric IDs</entry>
</row>
<row>
<entry><xref linkend="atrSrcDir"/></entry>
<entry>Reflects the complete path name of the directory the main program file is located in, provided the <xref linkend="rtnLocate"/> method has been executed in the interpreter process.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="mthAddToConstDir"/></entry>
<entry>Adds symbols, symbolic IDs, to the <computeroutput>.constDir</computeroutput>.</entry>
</row>
<row>
<entry><xref linkend="mthAutoDetectionClsApplicationManger"/></entry>
<entry>Sets the application global default for <link linkend="paraAutomaticDataDetection">autoDetection</link> to off, or on.</entry>
</row>
<row>
<entry><xref linkend="mthDefaultFont"/></entry>
<entry>Changes the <link linkend="mthClsSetDefaultFont">default</link> font for the application.</entry>
</row>
<row>
<entry><xref linkend="mthDefaultIcon"/></entry>
<entry>Sets a default icon to be used for the <link linkend="defDialogIcon">application</link> icon for all dialogs that do not explicitly set their own application icon.</entry>
</row>
<row>
<entry><xref linkend="ruapParseIncludeFile"/></entry>
<entry>Reads a file and adds any symbol definitions found to the proper constant directory.</entry>
</row>
<row>
<entry><xref linkend="ruapResolveNumericID"/></entry>
<entry>Resolves a numeric ID to a symbolic ID.</entry>
</row>
<row>
<entry><xref linkend="ruapResolveSymbolicID"/></entry>
<entry>Resolves a symbolic ID to its numeric value.</entry>
</row>
<row>
<entry><xref linkend="mthRequiredOS"/></entry>
<entry>Checks that an ooDialog program is executing on a required minimum Windows version.</entry>
</row>
<row>
<entry><xref linkend="mthSetDefaults"/></entry>
<entry>Sets one or more of the global defaults for the application.</entry>
</row>
<row>
<entry><xref linkend="mthUseGlobalConstDir"/></entry>
<entry>Specifies how the global <xref linkend="dotConstDir"/> is used in the application.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewApplicationManager" xreflabel="new"><title>new</title>
<indexterm><primary>new</primary><secondary>ApplicationManager class</secondary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>new</secondary></indexterm>
<programlisting>
<![CDATA[
>>--new(--opaque--)------------------------------><

]]>
</programlisting>

<para>
  A new instance of the <computeroutput>ApplicationManager</computeroutput> can not be instantiated from Rexx code. A
  single instance for the <computeroutput>ApplicationManager</computeroutput> is instantiated by the ooDialog framework
  for each application and placed in the <computeroutput>.local</computeroutput> environment as the
  <xref linkend="dotApplication"/>. All methods of the
  <computeroutput>ApplicationManger</computeroutput> are invoked by the programmer though the
  <computeroutput>.application</computeroutput> object.
</para>
</section>  <!-- End ApplicationManager::new() -->

<section id="ruapConstDir"><title>constDir (Attribute)</title>
<programlisting>
ResourceUtils::<xref linkend="atrConstDir"/>

<![CDATA[
>>--constDir-------------------------------------><

>>--constDir[symbol]=numericValue----------------><
]]>
</programlisting>
</section>

<section id="atrSrcDir" xreflabel="srcDir"><title>srcDir (Attribute)</title>
<indexterm><primary>srcDir</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>srcDir</secondary></indexterm>
<programlisting>
<![CDATA[
>>--srcDir------------------------------------------------------><

>>--srcDir = varName--------------------------------------------><

]]>
</programlisting>

<para>
  Reflects the complete path name of the directory the main program file is located in, provided the <xref
  linkend="rtnLocate"/> routine has been executed in the interpreter process. The path name includes the trailing slash
  (<emphasis role="italic">\</emphasis>.)
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">srcDir get:</emphasis></term>
  <listitem>
  <para>
    Returns a complete path name of a directory, or the <computeroutput>.nil</computeroutput> object if the <xref
    linkend="rtnLocate"/> routine has not been executed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">srcDir set:</emphasis></term>
  <listitem>
  <para>
    The programmer can not set the value of this attribute directly. The ooDialog framework sets, or resets, its value when
    the <emphasis role="italic">Locate</emphasis> routine is executed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The purpose of the <emphasis role="italic">Locate</emphasis> function and the <emphasis role="italic">srcDir</emphasis>
    attribute is to help the programmer create complete path names for any auxiliary files needed by an application. This
    allows the application to execute correctly, even if started from a directory other than its installation directory. The
    documentation for the <xref linkend="rtnLocate"/> routine contains some additional insight into this purpose.
  </para>
  <para>
    <emphasis role="bold">Note</emphasis> that the intention for the <emphasis role="italic">srcDir</emphasis> attribute is
    to return the complete directory path name of the main application's source directory. However, this is dependent on the
    programmer's usage of the <emphasis role="italic">Locate</emphasis> routine. The actual value of the attribute is the
    directory in which the source code file, in which <emphasis role="italic">Locate</emphasis> is executed. If the
    programmer calls <emphasis role="italic">Locate</emphasis> in a source code file that is not located in the application's
    main directory, then the <emphasis role="italic">srcDir</emphasis> attribute is going to that directory.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows the <emphasis role="italic">Locate</emphasis> function being used to get the installation directory of
    an application and then the <emphasis role="italic">srcDir</emphasis> attribute being used to access the directory value
    in a private method of a class:
<programlisting>
<![CDATA[
  srcDir = Locate()

  rcFile = srcDir"resources\imageButton.rc"
  symbolFile = srcDir"resources\imageButton.h"

  .application~setDefaults("O", symbolFile, .false)

  dlg = .ImageListDlg~new(rcFile, IDD_IMAGELIST_BUTTON)
  ...

::class 'ImageListDlg' subclass RcDialog
  ...

::method setPictureButtons private
  expose pbView pbAdd stStatus imagesLoaded imageList

  if .DlgUtil~comCtl32Version < 6 then return self~oldSetButtons

  pbView~style = "MULTILINE BOTTOM"

  srcDir = .application~srcDir

  -- The images are loaded from files.
  files = .array~new()
  files[1] = srcDir"resources\Normal.bmp"       -- Normal
  files[2] = srcDir"resources\Hot.bmp"          -- Hot (hover)
  files[3] = srcDir"resources\Pushed.bmp"       -- Pushed
  files[4] = srcDir"resources\Disabled.bmp"     -- Disabled
  files[5] = srcDir"resources\Default.bmp"      -- Default button
  files[6] = srcDir"resources\Hot.bmp"          -- Stylus hot, tablet PC only
  ...
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationManager::srcDir() [attribute]  -->

<section id="mthAddToConstDir" xreflabel="addToConstDir"><title>addToConstDir</title>
<indexterm><primary>addToConstDir</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>addToConstDir</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addToConstDir(--symbols--)-------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">addToConstDir</emphasis> is used to add symbolic IDs to the global
  <xref linkend="dotConstDir"/> object. The <xref linkend="mthUseGlobalConstDir"/>,
  <xref linkend="ruapParseIncludeFile"/>, and <xref linkend="mthSetDefaults"/> methods
  can also be used to add symbols to the <computeroutput>.constDir</computeroutput>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
    <variablelist>
      <varlistentry><term>symbols [required]</term>
      <listitem>
      <para>
        <emphasis role="italic">symbols</emphasis> can either be the name of a file containing symbol <link
        linkend="defPoundDefine">definitions</link>s, or a collection object that maps <xref linkend="defSymbolicId"/> IDs to
        their numeric value.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If <emphasis role="italic">symbols</emphasis> is a string it is taken to be the name of a file containing symbol
    definitons. The result in this case is the same as using the
    <xref linkend="ruapParseIncludeFile"/>. The file is parsed and any symbol definitions are
    added to the <computeroutput>.constDir</computeroutput>.
  </para>
  <para>
    When <emphasis role="italic">symbols</emphasis> is not a string, it must be an object with a <emphasis
    role="italic">supplier</emphasis> method where the indexes the supplier provides are strings. The items the
    supplier provides are added to the <computeroutput>.constDir</computeroutput> using the supplied indexes.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example creates a table of symbolic IDs and then uses that table to add symbols to the
    <computeroutput>.constDir</computeroutput>
<programlisting>
<![CDATA[

  symbols = getSymbols()
  .application~addToConstDir(symbols)

  ...

::routine getSymbols

  tbl = .Table~new
  tbl[IDD_CONTEXT      ] = 1000
  tbl[IDC_LV           ] = 1003
  tbl[IDC_ST_MSG       ] = 1004

  tbl[IDM_RC_DLG       ] = 10000
  tbl[IDM_RC_SHOW      ] = 40000
  tbl[IDM_RC_ENABLE_LV ] = 40005
  tbl[IDM_RC_DISABLE_LV] = 40001
  tbl[IDM_RC_BEEP      ] = 40002
  tbl[IDM_RC_QUIT      ] = 40003

  tbl[IDM_LV_BAR       ] = 20000
  tbl[IDM_LV_SORT      ] = 20001
  tbl[IDM_LV_JUMBLE    ] = 20002
  tbl[IDM_LV_REVERSE   ] = 20003
  tbl[IDM_LV_SEP1      ] = 20004
  tbl[IDM_LV_SEP2      ] = 20005
  tbl[IDM_LV_FNAME     ] = 20006
  tbl[IDM_LV_LNAME     ] = 20007
  tbl[IDM_LV_PROFESSION] = 20008
  tbl[IDM_LV_RESTORE   ] = 20009

  return tbl

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationManager::addToConstDir() -->

<section id="mthAutoDetectionClsApplicationManger" xreflabel="autoDetection"><title>autoDetection</title>
<indexterm><primary>autoDetection</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>autoDetection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--autoDetection(--+------+--)------------------><
                    +--on--+
]]>
</programlisting>

<para>
  The <emphasis role="italic">autoDetection</emphasis> method is used to turn the application-wide default for
 <xref linkend="mthInitAutoDetection"/> data field detection on or off. When an ooDialog program starts, the
  default for automatic data field detection is on.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>on [optional]</term>
      <listitem>
      <para>
        If <emphasis role="italic">on</emphasis> is true, the default for automatic data detection is set to on, if
        false it is set to off. If <emphasis role="italic">on</emphasis> is omitted automatic data detection is turned
        off.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Automatic data detection can also be turned off using the <xref linkend="mthSetDefaults"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationManager::autoDetection() -->

<section id="mthDefaultFont" xreflabel="defaultFont"><title>defaultFont</title>
<indexterm><primary>defaultFont</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>defaultFont</secondary></indexterm>
<programlisting>
<![CDATA[
>>--defaultFont(--+------------+--+-------------+--)------------><
                  +--fontName--+  +-,-fontSize--+
]]>
</programlisting>

<para>
  Sets the application-wide default dialog font.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>fontName [optional]</term>
      <listitem>
      <para>
        The name of the new default font for the dialog. If omitted the global font name is not changed. However,
        if both name and size are omitted the font is set back to the default font and size. (See remarks.)
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fontSize [optional]</term>
      <listitem>
      <para>
        The new default size for the dialog font. If omitted the global font size is not changed. However, if both name
        and size are omitted the font is set back to the default font and size. (See remarks.)
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The programmer can change the global font back to the default font and font size by omitting both arguments. The
 <xref linkend="mthClsSetDefaultFont"/> class method of the
    <xref linkend="chpDialogObject"/> object can also be used to set the application-wide default dialog font.
  </para>
  <para>
    The length of the font name must be less than 256 characters and can not be the empty string, otherwise a syntax
    condition is raised. This is the only possible cause of failure. Note that since a syntax condition is raised on
    error, false will never actually be returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationManager::defaultFont() -->

<section id="mthDefaultIcon" xreflabel="defaultIcon"><title>defaultIcon</title>
<indexterm><primary>defaultIcon</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>defaultIcon</secondary></indexterm>
<programlisting>
<![CDATA[
>>--defaultIcon(--src--+------+--+----------+--)----------------><
                       +-,-id-+  +-,-binary-+
]]>
</programlisting>

<para>
  Sets a default icon to be used as the <link linkend="defDialogIcon">application</link> icon for all dialogs that do not
  explicitly set their own application icon.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>src [required]</term>
    <listitem>
    <para>
      Indicates the source of the icon. The other arguments are used, or not used, to specify exactly what the <emphasis
      role="italic">src</emphasis> is. The source for the icon can be one of the following:
    </para>

    <variablelist>
      <varlistentry><term><emphasis role="bold">ResourceImage</emphasis></term>
      <listitem>
      <para>
        If <emphasis role="italic">src</emphasis> is a <xref linkend="clsResourceImage"/> object, then the <emphasis
        role="italic">id</emphasis> argument must be used to specify the resource ID of the icon in the resource image. The
        <emphasis role="italic">binary</emphasis> argument will be ignored in this case because a resource image is known to
        be binary.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">File name of a text resource script</emphasis></term>
      <listitem>
      <para>
        When <emphasis role="italic">src</emphasis> is the file name of a resource <link
        linkend="defResourceScript">script</link> file, the <emphasis role="italic">id</emphasis> argument must be used
        to specify the ICON resource ID to be used. The <emphasis role="italic">binary</emphasis> argument must be false to
        distinguish that the file is not a compiled resource file. The resource script will be searched for an ICON statement
        matching the <emphasis role="italic">id</emphasis> argument value and loaded if found.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">File name of a binary compiled resource.</emphasis></term>
      <listitem>
      <para>
        If <emphasis role="italic">src</emphasis> is the name of a binary file containing the icon resource, then the
        <emphasis role="italic">id</emphasis> argument must specify the resource ID of the icon. In addition, the <emphasis
        role="italic">binary</emphasis> argument must be set to true. This is the only way to distinguish that the file is a
        compile binary file and not a text resource script file.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">Stand alone icon file</emphasis></term>
      <listitem>
      <para>
        The <emphasis role="italic">src</emphasis> argument can be the file name of a stand alone icon file. In this case the
        <emphasis role="italic">id</emphasis> argument must be omitted. When <emphasis role="italic">src</emphasis> is not a
        <computeroutput>ResourceImage</computeroutput> and <emphasis role="italic">id</emphasis> is omitted, then the
        ooDialog framework assumes <emphasis role="italic">src</emphasis> is the name of an icon file, and the <emphasis
        role="italic">binary</emphasis> argument is ignored.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold"><emphasis role="italic">oodialog.dll</emphasis></emphasis></term>
      <listitem>
      <para>
        If <emphasis role="italic">src</emphasis> is exactly <emphasis role="italic">oodialog.dll</emphasis>, case
        insignificant, then the icon is loaded from the ooDialog DLL. ooDialog embeds a few icon images in its DLL file for
        <link linkend="defDialogIcon">general</link> use by the programmer. If the <emphasis role="italic">id</emphasis>
        argument is not omitted, it must specify one of the pre-defined resource IDs of those icons. If <emphasis
        role="italic">id</emphasis> is ommitted then the default ID, IDI_DLG_OODIALOG, is used. This has no effect, unless
        the application has previously changed the default icon and now wants to revert to the default. The <emphasis
        role="italic">binary</emphasis> argument is ignored in this case because it is known that oodialog.dll is binary.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
    <varlistentry><term>id [optional]</term>
    <listitem>
    <para>
      The resource ID of the icon in the <emphasis role="italic">src</emphasis>. May be numeric or <xref
      linkend="defSymbolicId"/>. This argument must be omitted if <emphasis role="italic">src</emphasis> is the name of an
      icon file, and may be omitted if <emphasis role="italic">src</emphasis> is <emphasis
      role="italic">oodialog.dll</emphasis>. In all other cases it is required.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>binary [optional]</term>
    <listitem>
    <para>
      True to specify that <emphasis role="italic">src</emphasis> is a binary compiled file and false to specify that
      <emphasis role="italic">src</emphasis> is a resource script file. The defualt is false.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, otherwise false. In most cases of failure, the <computeroutput>.SystemErrorCode</computeroutput>
    object will contain the system error number for the failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">application</emphasis>, (or <emphasis role="italic">dialog</emphasis>,) icon can be explicitly
    set using an argument to the <xref linkend="mthExecute"/> method, or any of the other methods that start a dialog
    executing such as the <xref linkend="mthExecuteAsync"/>, <xref linkend="mthPopup"/>, etc., methods. When a dialog does
    not have an icon explicitly set, the default ooDialog icon is used. Note that none of the <link
    linkend="sctStandardClassesRoutines">standard</link> dialogs set an application icon.  The <emphasis
    role="italic">defaultIcon</emphasis> method can be used to change the application icon from the default ooDialog icon to
    any icon the programmer wants. This is especially useful when a program puts up more than one dialog and / or includes a
    number of the standard dialogs. Setting the default icon can give all dialogs in a program a common look.
  </para>
  <para>
    If the programmer wants to use a symbolic ID for the <emphasis role="italic">id</emphasis> argument, then the symbol must
    be in the global <xref linkend="dotConstDir"/>. This implies that the programmer needs to invoke the <emphasis
    role="italic">defaultIcon</emphasis> method, <emphasis role="italic">after</emphasis>, populating the
    <computeroutput>.constDir</computeroutput> with symbols.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the default icon for the application using a stand alone icon file:
<programlisting>
<![CDATA[

  .application~setDefaults('O', 'rc\oodStandardDialog.h')
  .application~defaultIcon('bmp\oodStandardDialog.ico')


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationManager::defaultIcon() -->


<section id="ruapParseIncludeFile" xreflabel="parseIncludeFile"><title>parseIncludeFile</title>
<programlisting>
ResourceUtils::<xref linkend="mthParseIncludeFile"/>

<![CDATA[
>>--parseIncludeFile(--fileName--)---------------><

]]>
</programlisting>
</section>

<section id="mthRequiredOS" xreflabel="requiredOS"><title>requiredOS</title>
<indexterm><primary>requiredOS</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>requiredOS</secondary></indexterm>
<programlisting>
<![CDATA[
>>--requiredOS(--os--,--appName--)---------------><
]]>
</programlisting>

<para>
  Checks that an ooDialog program is executing on a required minimum Windows version.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>os</term>
    <listitem>
    <para>
      A key word specifying the minimum required version of Windows. The allowable key words are: <emphasis
      role="italic">W2K, XP, W2K3, Vista,</emphasis> and <emphasis role="italic"> Windows7</emphasis>. Case is not
      significant.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>appName [required]</term>
    <listitem>
    <para>
      This should be the name of the application that is executing. The name is used in the message box shown to the user.
    </para>
    </listitem></varlistentry>
  </variablelist> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True if the current Windows OS mets the minimum requirement specified by <emphasis role="italic">os</emphasis>, otherwise
    false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the current OS does not meet the minimum version specified by <emphasis role="italic">os</emphasis>, a message box is
    shown to the user with the message stating: The <emphasis role="italic">appName</emphasis> application requires Windows
    <emphasis role="italic">os</emphasis> or later. It can not run on <emphasis role="italic">current OS name</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from an ooDialog application that can not be used on XP. The very first line of the application checks
    that the current Windows version is at least Vista or later and ends the program if it is not.  If the current OS is XP
    for instance, the <emphasis role="italic">requiredOS</emphasis> method will display a message to the user stating that:
    <emphasis role="italic">The openSaveFileDemo.rex application requires Windows Vista or later. It can not run on
    XP.</emphasis> before it returns:
<programlisting>
<![CDATA[
  if \ .application~requiredOS('Vista', 'openSaveFileDemo.rex') then return 99
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationManager::requiredOS() -->

<section id="ruapResolveNumericID" xreflabel="resolveNumericID"><title>resolveNumericID</title>
<programlisting>
ResourceUtils::<xref linkend="mthResolveNumericID"/>

<![CDATA[
>>--resolveNumericID(--id--)---------------------><

]]>
</programlisting>
</section>

<section id="ruapResolveSymbolicID" xreflabel="resolveSymbolicID"><title>resolveSymbolicID</title>
<programlisting>
ResourceUtils::<xref linkend="mthResolveSymbolicID"/>

<![CDATA[
>>--resolveSymbolicID(--id--)--------------------><

]]>
</programlisting>
</section>

<section id="mthSetDefaults" xreflabel="setDefaults"><title>setDefaults</title>
<indexterm><primary>setDefaults</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>setDefaults</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setDefaults(-+-------+-+-----------+-+--------+-+---------+-+---------+-)--><
                 +-usage-+ +-,-symbols-+ +-,-auto-+ +-,-fName-+ +-,-fSize-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">setDefaults</emphasis> method sets a number of default values for the application and / or
  performs tasks that effect the entire application, in a single method call.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>usage [optional]</term>
      <listitem>
      <para>
        The <emphasis role="italic">usage</emphasis> argument can either be a string specifying the global
        <xref linkend="dotConstDir"/> <xref linkend="entConstDirStrategy"/> to use for the
        application, or it can be a <computeroutput>directory</computeroutput> object specifying any number of defaults
        to set, and / or any number of application tasks to perform.
        <variablelist>
          <varlistentry><term><emphasis role="bold">when <emphasis role="italic">usage</emphasis> is a string:</emphasis></term>
          <listitem>
          <para>
            Specifies the usage <xref linkend="entConstDirStrategy"/> for the
           <computeroutput>.constDir</computeroutput>. <emphasis role="italic">usage</emphasis> must be exactly one of
           the following keywords. Only the first letter is required, and case is not significant:
          </para>
          <para>
            <simplelist type='vert' columns='4'>
              <member>Only </member>
              <member>First</member>
              <member>Last </member>
              <member>Never</member>
            </simplelist>
            <variablelist>
              <varlistentry><term>Only</term>
              <listitem>
              <para>
                Only the <computeroutput>.constDir</computeroutput> is used to resolve symbolic IDs.
              </para>
              </listitem></varlistentry>
              <varlistentry><term>First</term>
              <listitem>
              <para>
                When a symbolic ID needs to be resolved, the ooDialog framework first tries to resolve the ID through the
                <computeroutput>.constDir</computeroutput>. If that fails, the framework then tries the
                <xref linkend="atrConstDir"/> attribute of the <xref linkend="chpDialogObject"/> object.
              </para>
              </listitem></varlistentry>
              <varlistentry><term>Last</term>
              <listitem>
              <para>
                This is the opposite of the <emphasis role="italic">First</emphasis> strategy. When a symbolic ID needs to
                be resolved, the ooDialog framework tries to resolve the ID through the
                <xref linkend="atrConstDir"/> attribute of the <xref linkend="chpDialogObject"/> object. If that
                fails, the framework then tries the global <computeroutput>.constDir</computeroutput> object.
              </para>
              </listitem></varlistentry>
              <varlistentry><term>Never</term>
              <listitem>
              <para>
                The <computeroutput>.constDir</computeroutput> is never used to resolve symbolic IDs. This is the default
                when an ooDialog application starts up.
              </para>
              </listitem></varlistentry>
            </variablelist>
          </para>
          </listitem></varlistentry>
          <varlistentry><term><emphasis role="bold">when <emphasis role="italic">usage</emphasis> is a directory</emphasis></term>
          <listitem>
          <para>
            A <computeroutput>directory</computeroutput> object can be used to set some or all of the defaults and
            perform some or all of the tasks that the individual methods of the
            <computeroutput>ApplicationManager</computeroutput> do. The following indexes of the
            <computeroutput>directory</computeroutput> object are recognized. Indexes not in the list are ignored. For
            each index, the corresponding documentation for the method of the
            <computeroutput>ApplicationManger</computeroutput> may contain additional insight. E.g. restrictions on the
            value for the item at the index are identical to restrictions listed in the method documentation.
            <variablelist>
              <varlistentry><term><emphasis role="bold">CONSTDIRUSAGE:</emphasis></term>
              <listitem>
              <para>
                Specifies the <computeroutput>.constDir</computeroutput> usage
                <xref linkend="entConstDirStrategy"/>. This is equivalent to the <emphasis
                role="italic">mode</emphasis> argument in the
 <xref linkend="mthUseGlobalConstDir"/> method and is the same as when <emphasis
                role="italic">usage</emphasis>is a string above.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">SYMBOLSRC</emphasis></term>
              <listitem>
              <para>
                Adds symbols to the <computeroutput>.constDir</computeroutput>. This is equivalent to the <emphasis
                role="italic">symbolSrc</emphasis> argument in the
 <xref linkend="mthUseGlobalConstDir"/> method.
              </para> </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">AUTODETECTION</emphasis></term>
              <listitem>
              <para>
                Sets the default for <xref linkend="mthInitAutoDetection"/> data detection. This is
                equivalent to the <emphasis role="italic">on</emphasis> argument in the
 <xref linkend="mthAutoDetectionClsApplicationManger"/> method.
              </para> </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">FONTNAME</emphasis></term>
              <listitem>
              <para>
                Sets the name of the default font for dialogs. This is equivalent to the <emphasis
                role="italic">fontName</emphasis> argument in the
 <xref linkend="mthDefaultFont"/> method. With this exception, if both the FONTNAME and
                FONTSIZE indexes are missing from the <computeroutput>directory</computeroutput> object, the default is
                not set back to the default when an ooDialog application starts.
              </para>
              </listitem></varlistentry>
              <varlistentry><term><emphasis role="bold">FONTSIZE</emphasis></term>
              <listitem>
              <para>
                Sets the default font size for dialogs. This is equivalent to the <emphasis
                role="italic">fontSize</emphasis> argument in the
 <xref linkend="mthDefaultFont"/> method. With this exception, if both the FONTNAME and
                FONTSIZE indexes are missing from the <computeroutput>directory</computeroutput> object, the default is
                not set back to the default when an ooDialog application starts.
              </para>
              </listitem></varlistentry>
            </variablelist>
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>symbols [optional]</term>
      <listitem>
      <para>
        <emphasis role="italic">symbols</emphasis> can either be the name of a file containing symbol
        <xref linkend="defPoundDefine"/>s, or a collection object that maps
        <xref linkend="defSymbolicId"/> IDs to their numeric value.
      </para>
      <para>
        This argument is ignored if a <computeroutput>directory</computeroutput> object is used for argument one.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>auto [optional]</term>
      <listitem>
      <para>
        If <emphasis role="italic">auto</emphasis> is true, the default for <xref linkend="mthInitAutoDetection"/>
        data detection is set to on, if false it is set to off.
      </para>
      <para>
        This argument is ignored if a <computeroutput>directory</computeroutput> object is used for argument one.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fName [optional]</term>
      <listitem>
      <para>
        The new font, the name of the font. If omitted the global font name is not changed.
      </para>
      <para>
        This argument is ignored if a <computeroutput>directory</computeroutput> object is used for argument one.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fSize [optional]</term>
      <listitem>
      <para>
        The new size for the default font. If omitted the global font size is not changed.
      </para>
      <para>
        This argument is ignored if a <computeroutput>directory</computeroutput> object is used for argument one.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example specifies that only the <computeroutput>.constDir</computeroutput> should be used to resolve symbolic
    IDs, loads symbols into the <computeroutput>.constDir</computeroutput> from the file:
    <computeroutput>rc\PropertySheetDemo.h</computeroutput> and sets the default for automatic data detection to off:
<programlisting>
<![CDATA[

  .application~setDefaults("O", "rc\PropertySheetDemo.h", .false)

  t1 = .ListViewDlg~new("res\PropertySheetDemo.dll", IDD_LISTVIEW_DLG)
  t2 = .TreeViewDlg~new("res\PropertySheetDemo.dll", IDD_TREEVIEW_DLG)
  t3 = .ProgressBarDlg~new("rc\PropertySheetDemo.rc", IDD_PROGRESSBAR_DLG)
  t4 = .TrackBarDlg~new("res\PropertySheetDemo.dll", IDD_TRACKBAR_DLG)
  t5 = .TabDlg~new("res\PropertySheetDemo.dll", IDD_TAB_DLG)

  tabContent = .array~of(t1, t2, t3, t4, t5)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationManager::setDefaults() -->
<section id="mthUseGlobalConstDir" xreflabel="useGlobalConstDir"><title>useGlobalConstDir</title>
<indexterm><primary>useGlobalConstDir</primary></indexterm>
<indexterm><primary>ApplicationManager class</primary><secondary>useGlobalConstDir</secondary></indexterm>
<programlisting>
<![CDATA[
>>--useGlobalConstDir(--mode--+-------------+--)----------------><
                              +--symbolSrc--+
]]>
</programlisting>

<para>
  The ooDialog framework supports a <xref linkend="ovvSymbolicIDMechanism"/> for using
  <xref linkend="defSymbolicId"/> resource IDs for method arguments that required a resource ID. The global
  <xref linkend="dotConstDir"/> is part of that support. The <computeroutput>.constDir</computeroutput>
  is the most efficient and capable way to use symbolic IDs. However, to support backwards program compatibility, the
  programmer must specify a usage <xref linkend="entConstDirStrategy"/> that includes the use of the
  <computeroutput>.constDir</computeroutput>.
</para>
<para>
  By default the <computeroutput>.constDir</computeroutput> is not used. The programmer specifies the usage strategy for
  the <computeroutput>.constDir</computeroutput> through the <emphasis role="italic">useGlobalConstDir</emphasis>
  method. Optionally, the programmer can load symbols into the <computeroutput>.constDir</computeroutput> at the same
  time the <computeroutput>.constDir</computeroutput> usage is specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>mode [required]</term>
      <listitem>
      <para>
        Specifies the usage <xref linkend="entConstDirStrategy"/> for the
       <computeroutput>.constDir</computeroutput>. <emphasis role="italic">mode</emphasis >must be exactly one of the
       following keywords. Only the first letter is required, and case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='4'>
          <member>Only </member>
          <member>First</member>
          <member>Last </member>
          <member>Never</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>Only</term>
          <listitem>
          <para>
            Only the <computeroutput>.constDir</computeroutput> is used to resolve symbolic IDs.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>First</term>
          <listitem>
          <para>
            When a symbolic ID needs to be resolved, the ooDialog framework first tries to resolve the ID through the
            <computeroutput>.constDir</computeroutput>. If that fails, the framework then tries the
 <xref linkend="atrConstDir"/> attribute of the <xref linkend="chpDialogObject"/>
            object.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>Last</term>
          <listitem>
            <para>
              This is the opposite of the <emphasis role="italic">First</emphasis> strategy. When a symbolic ID needs to
              be resolved, the ooDialog framework tries to resolve the ID through the
 <xref linkend="atrConstDir"/> attribute of the <xref linkend="chpDialogObject"/>
              object. If that fails, the framework then tries the global <computeroutput>.constDir</computeroutput>
              object.
            </para>
          </listitem></varlistentry>
          <varlistentry><term>Never</term>
          <listitem>
          <para>
            The <computeroutput>.constDir</computeroutput> is never used to resolve symbolic IDs. This is the default
            when an ooDialog application starts up.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>symbolSrc [optional]</term>
      <listitem>
      <para>
        As a convenience the programmer can load symbols into the <computeroutput>.constDir</computeroutput> through the
        <emphasis role="italic">symbolSrc</emphasis> argument
      </para>
      <para>
        <emphasis role="italic">symbolSrc</emphasis> can either be the name of a file containing symbol
        <xref linkend="defPoundDefine"/>s, or a collection object that maps
        <xref linkend="defSymbolicId"/> IDs to their numeric value.
      </para> </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, false on failure.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If <emphasis role="italic">symbolSrc</emphasis> is a string it is taken to be the name of a file containing symbol
    definitons. The result in this case is the same as using the
    <xref linkend="ruapParseIncludeFile"/>. The file is parsed and any symbol definitions are
    added to the <computeroutput>.constDir</computeroutput>.
  </para>
  <para>
    When <emphasis role="italic">symbolSrc</emphasis> is not a string, it must be an object with a <emphasis
    role="italic">supplier</emphasis> method where the indexes the supplier provides are strings. The items the
    supplier provides are added to the <computeroutput>.constDir</computeroutput> using the supplied indexes.
  </para>
  <para>
    Either the <xref linkend="mthAddToConstDir"/> or the
    <xref linkend="ruapParseIncludeFile"/> can be used to add additional symbols to the
    <computeroutput>.constDir</computeroutput>. <emphasis role="bold">Note</emphasis> that if the usage strategy is
    specified as <emphasis role="italic">None</emphasis> and the <emphasis role="italic">symbolSrc</emphasis> argument
    is used, the symbols will be loaded into the <computeroutput>.constDir</computeroutput>, (because the
    <computeroutput>.constDir</computeroutput> object is always present in an ooDialog.) However the symbols won't be
    available in the program, (because the programmer specified to not use the
    <computeroutput>.constDir</computeroutput>.)
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In this example the programmer specifies to only use the <computeroutput>.constDir</computeroutput> to resolve
    symbolic IDs, and at the same time loads symbols into the <computeroutput>.constDir</computeroutput> from the
    <computeroutput>ticketWizard.h</computeroutput> file:
<programlisting>
<![CDATA[

  .application~useGlobalConstDir('O', "rc\ticketWizard.h")

  msg = "The upcoming dialog demonstrates a Wizard 97 style dialog."
  title = "Wizard 97 Dialog"
  dlg = .TimedMessage~new(msg, title, 2000)
  dlg~execute

  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ApplicationMgr::useGlobalConstDir() -->

</section> <!-- End ApplicationManager Class -->


<section id="dotConstDir" xreflabel=".constdir"><title>.constDir object</title>
<indexterm><primary>.constDir</primary></indexterm>
<para>
  The <computeroutput>.constDir</computeroutput> is a Rexx <computeroutput>.directory</computeroutput> object that is
  present in all ooDialog programs. It is initialized and placed in the <computeroutput>.local</computeroutput>
  environment automatically by the <xref linkend="dotApplication"/>. The global
  <computeroutput>.constDir</computeroutput> is part of the <xref linkend="ovvSymbolicIDMechanism"/>
  allowing the use of <xref linkend="defSymbolicId"/> IDs in ooDialog programs.
</para>
<para>
  The <computeroutput>.constDir</computeroutput> is the most efficient way to use symbolic IDs. However, to maintain
  backwards compatibility with older ooDialog programs its use is turned off by default. The
  <computeroutput>.application</computeroutput> object, through its
 <xref linkend="mthUseGlobalConstDir"/> method or <xref linkend="mthSetDefaults"/>
  method is used to specify how the <computeroutput>.constDir</computeroutput> is used.
</para>
<para>
  Other than specifying <emphasis role="italic">how</emphasis> the <computeroutput>.constDir</computeroutput> is to be
  used, the <computeroutput>.constDir</computeroutput> is mostly transparent to the programmer. To take best advantage
  of the <computeroutput>.constDir</computeroutput> the programmer should read the section in the Brief Overview chapter
  that discusses the symbolic ID <xref linkend="ovvSymbolicIDMechanism"/> in ooDialog.
</para>
<para>
  This example shows a typical use of the <computeroutput>.constDir</computeroutput> in a program. The example sets the
  program to use <emphasis role="bold">only</emphasis> the <computeroutput>.constDir</computeroutput> and populates the
  <computeroutput>.constDir</computeroutput> with the symbolic IDs contained in the file:
  <computeroutput>accountingApp.h</computeroutput>. Notice that the <computeroutput>.constDir</computeroutput> is not
  even directly referenced.
</para>
<programlisting>
<![CDATA[

  .application~useGlobalConstDir('O', 'accountingApp.h')

  dlg = .MainMenuDlg~new("QuickBooks.dll", IDD_MAIN_MENU_DIALOG)
  if dlg~initCode == 0 then do
      dlg~execute("SHOWTOP", IDI_BOOKS)
  end
  ...

]]>
</programlisting>
<para>
  Much of the time the programmer never needs to directly access the <computeroutput>.constDir</computeroutput>.
  However, the use of symbolic IDs can make a program more readable and / or maintainable. In this example, all the
  radion buttons are connected to one event handling method and which radio button was selected is determined using the
  <computeroutput>.constDir</computeroutput>:

<programlisting>
<![CDATA[

::method onRbSelect
  expose process
  use arg info, handle

  id = .DlgUtil~loWord(info)

  select
    when id == .constDir[IDC_RB_ANYWHERE        ] then process = "ANYWHERE"
    when id == .constDir[IDC_RB_DIALOG          ] then process = "DIALOG"
    when id == .constDir[IDC_RB_ON_EDIT_OK      ] then process = "ON_EDIT_OK"
    when id == .constDir[IDC_RB_FOCUSED_ANYWHERE] then process = "FOCUSED_ANYWHERE"
    when id == .constDir[IDC_RB_FOCUSED_DIALOG  ] then process = "FOCUSED_DIALOG"
    when id == .constDir[IDC_RB_FOCUSED_EDIT    ] then process = "FOCUSED_EDIT"
    otherwise
      nop
  end
  -- End select

]]>
</programlisting>
</para>
</section>


<section id="clsDlgUtil" xreflabel="DlgUtil"><title>DlgUtil Class</title>
<indexterm><primary>DlgUtil class</primary></indexterm>
<para>
  All the methods of the DlgUtil class are class methods. There are no instance methods, other than inherited methods,
  for this class.  The class methods are a collection of common utilities, mostly for converting different Windows
  values, getting version information, and the like.
</para>

<section id="sctMethodsDlgUtil"><title>Method Table</title>
<para>
  The <computeroutput>DlgUtil</computeroutput> class implements the methods listed in the following table.

<table id="tDlgUtilMethods" frame="all">
<title>Methods of the DlgUtil class</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthAndClsDlgUtil"/></entry>
<entry><emphasis role="italic">and's</emphasis> two numbers and returns the result.</entry>
</row>
<row>
<entry><xref linkend="mthComCtl32Version"/></entry>
<entry>Determines the Common Controls Library version in use by ooDialog.</entry>
</row>
<row>
<entry><xref linkend="mthErrMsg"/></entry>
<entry>Returns the error message text for the specified Windows system error code.</entry>
</row>
<row>
<entry><xref linkend="mthGetGUID"/></entry>
<entry>Returns a GUID in string format.</entry>
</row>
<row>
<entry><xref linkend="mthGetSystemMetricsClsDlgUtil"/></entry>
<entry>Obtains the system metric value for a given index.</entry>
</row>
<row>
<entry><xref linkend="mthHiWord"/></entry>
<entry>Returns the high-order word portion of a number as a number in the range of 0 through 65535.</entry>
</row>
<row>
<entry><xref linkend="mthLoWord"/></entry>
<entry>Returns the low-order word portion of a number as a number in the range of 0 through 65535.</entry>
</row>
<row>
<entry><xref linkend="mthMakeLParam"/></entry>
<entry>Packs two numbers into a LPARAM argument and returns the result.</entry>
</row>
<row>
<entry><xref linkend="mthMakeWParam"/></entry>
<entry>Packs two numbers into a WPARAM argument and returns the result</entry>
</row>
<row>
<entry><xref linkend="mthOrClsDlgUtil"/></entry>
<entry><emphasis role="italic">or's</emphasis> two or more numbers and returns the result.</entry>
</row>
<row>
<entry><xref linkend="mthScreenArea"/></entry>
<entry>Retrieves the usable screen area (work area.) on the primary display monitor.</entry>
</row>
<row>
<entry><xref linkend="mthScreenSize"/></entry>
<entry>Retrieves the screen size in either pixels, dialog units, or both.</entry>
</row>
<row>
<entry><xref linkend="mthShiftLeft"/></entry>
<entry>Performs a logical bitwise shift left on a non-negative whole number.</entry>
</row>
<row>
<entry><xref linkend="mthShiftLeft"/></entry>
<entry>Performs a logical bitwise shift right on a non-negative whole number.</entry>
</row>
<row>
<entry><xref linkend="mthSHiWord"/></entry>
<entry>Returns the high-order word portion of a number as a number in the range of -32768 through 32767.</entry>
</row>
<row>
<entry><xref linkend="mthSigned"/></entry>
<entry>Casts an unsigned whole number to its signed equivalent.</entry>
</row>
<row>
<entry><xref linkend="mthSigned32"/></entry>
<entry>Casts a 32-bit unsigned whole number to its 32-bit signed equivalent.</entry>
</row>
<row>
<entry><xref linkend="mthSLoWord"/></entry>
<entry>Returns the low-order word portion of a number as a number in the range of -32768 through 32767.</entry>
</row>
<row>
<entry><xref linkend="mthSShiftLeft"/></entry>
<entry>Performs a logical bitwise shift left on a whole number.</entry>
</row>
<row>
<entry><xref linkend="mthSShiftLeft"/></entry>
<entry>Performs a logical bitwise shift right on a whole number.</entry>
</row>
<row>
<entry><xref linkend="mthUnsigned"/></entry>
<entry>Casts a signed whole number to its unsigned equivalent.</entry>
</row>
<row>
<entry><xref linkend="mthUnsigned32"/></entry>
<entry>Casts a 32-bit signed whole number to its 32-bit unsigned equivalent.</entry>
</row>
<row>
<entry><xref linkend="mthThreadID"/></entry>
<entry>Returns the thread identifier of the thread the method is executing in.</entry>
</row>
<row>
<entry><xref linkend="mthVersion"/></entry>
<entry>Returns the ooDialog version string.</entry>
</row>
<row>
<entry><xref linkend="mthWindowFromPoint"/></entry>
<entry>Retrieves the window handle of the window that contains the specified point.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="mthAndClsDlgUtil" xreflabel="and"><title>and (Class Method)</title>
<indexterm><primary>and</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>and</secondary></indexterm>
<programlisting>
<![CDATA[
>>--and(--number1-,-number2--)-------------------><

]]>
</programlisting>

<para>
  Combines two numbers into a single number by <emphasis role="italic">anding</emphasis> the individual numbers
  together.  This is the typical <emphasis role="italic">and</emphasis> operation used by assembly and C programmer's.
  The typical ooDialog programmer would have no need of the method. It is provided as a convenience for use in
  sophisticated ooDialog programs.
</para>
<para>
  The normal use of an <emphasis role="italic">and</emphasis> operation in ooDialog programs is to extract the low or
  high words from an argument returned from the operating system. The addition of the
 <xref linkend="mthLoWord"/>() and <xref linkend="mthHiWord"/>() methods to the ooDialog framework
  have eliminated most of the reason for this usage.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The required two arguments are the whole numbers to be <emphasis role="italic">anded</emphasis> together.
  </para>
  <para>
    As a convenience, the whole numbers can also be specified as a string with the following format:
    <computeroutput>0x</computeroutput> followed by a series of hexadecimal digits with no spaces. Such as
    <computeroutput>"0xff12abc9"</computeroutput> or <computeroutput>"0x1"</computeroutput> or
    <computeroutput>"0x00000080"</computeroutput>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is the number that is the result of <emphasis role="italic">anding</emphasis> the two arguments
    together.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example is part of a generic method in an application that returns the text of an edit control. The
    application is a complex one and has many edit controls that are read only. The text for read only controls is
    ignored. The method returns .nil for read only controls to differentiate the difference between a read only
    control and a control that has the empty string.
  </para>
  <para>
    The value of the ES_READONLY style is 0x0800.
<programlisting>
<![CDATA[

::method getEditText private
  use strict arg control

  -- If the control is read only, we just return .nil
  if .DlgUtil~and(control~getStyleRaw, 0x0800) <> 0 then return .nil

  ...
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::and() [class method] -->


<section id="mthComCtl32Version" xreflabel="comCtl32Version"><title>comCtl32Version (Class Method)</title>
<indexterm><primary>comCtl32Version</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>comCtl32Version</secondary></indexterm>
<programlisting>
<![CDATA[

>>--comCtl32Version(--+----------+-)-------------><
                      +--format--+

]]>
</programlisting>

<para>
  Use this method to determine the version of the Common Controls <xref linkend="ovvComctl32"/> used by
  ooDialog on the current system.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
    <varlistentry><term>format [optional]</term>
    <listitem>
    <para>
      A keyword indicating the format of the returned version string.  Only the first letter is needed and case is not
      significant.  Any unrecognized keyword is ignored and the default format is used.  The format for each keyword is
      as follows:
    </para>
    <variablelist>
      <varlistentry><term>Short</term>
      <listitem>
      <para>
        The version number, for instance <computeroutput>4.72</computeroutput> or <computeroutput>6.0</computeroutput>.
        This is the default.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>Number</term>
      <listitem>
      <para>
        This is an alias for short.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>OS</term>
      <listitem>
      <para>
        The minimum operating system that can be expected to be compatible with the library. Earlier versions of the
        common control library were also distributed with Internet Explorer and so an OS part of say,
        <computeroutput>W98 / IE 4.01</computeroutput> would indicate that the current common control library supports
        all the features available on Windows 98 or with Internet Explorer 4.01.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>Full</term>
      <listitem>
      <para>
        The full format string in the format <computeroutput>comctl32.dll version 6.0 (XP)</computeroutput>. Where the
        6.0 is the number part and XP is the OS part.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method returns a string in one of the formats described above.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    In the following example, the programmer repositions the dialog controls under certain conditions.  In Windows XP
    and later, this task is more accurate if the <computeroutput>getIdealSize()</computeroutput> method of the Button
    class is used. However, the programmer needs the application to also run on Windows 2000.  He uses the
    <computeroutput>comCtl32Version()</computeroutput> method to determine if the
 <xref linkend="mthGetIdealSize"/> method is available.  If it is not available he uses an
    alternative, but less accurate method to reposition the controls.

<programlisting>
<![CDATA[
::method repositionControls

  if .DlgUtil~comCtl32Version < 6.0 then return self~doW2KReposition

  size = self~newPushButton(IDC_CHECK_TWO)~getIdealSize
  if size == .nil then return .false

  -- do the repositioning

return .true
]]>
</programlisting>
    An alternative way to achieve the same thing might be:
<programlisting>
<![CDATA[
::method repositionControls

  if .DlgUtil~comCtl32Version('O') == "XP" then return self~doXPReposition

  -- Do the less accurate repositioning
  ...

return .true
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthErrMsg" xreflabel="errMsg"><title>errMsg</title>
<indexterm><primary>errMsg</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>errMsg</secondary></indexterm>
<programlisting>
<![CDATA[
>>--errMsg(--errCode--)--------------------------><
]]>
</programlisting>

<para>
  Returns the error message text for the specified Windows system error code.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>errCode [required]</term>
    <listitem>
    <para>
      The Windows system error code to get the error message for. Typically this would come from the <link
      linkend="dotSystemErrorCode">.SystemErrorCode</link> variable, but it can be any non-negative whole number in the range
      0 to 4294967295.
    </para>
    <para>
      For convenience in looking up COM or OLE related error codes, strings in conventional <xref
      linkend="defConventionalHex"/> format are also accepted. Typically an <computeroutput>OleObject</computeroutput> COM
      related error is displayed something like: 0x80040000.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the error message text that Windows associates with the specified error code. Note that the error message comes
    from Windows, not ooDialog. ooDialog has no control over the clarity of the message.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Although any valid whole number within the range specified is accepted, only numbers that are actually valid system
    errors will produce a valid result. Numbers that are not Windows system errors will return a string similar to, <emphasis
    role="italic">Internal Windows error formatting the message (317)</emphasis>. The number in parenthesis will be the
    system error code that Windows returned when asked for the message text for the <emphasis
    role="italic">errCode</emphasis> argument. Since 317 is a valid system error, its message text could be looked up using
    the <emphasis role="italic">errMsg</emphasis> method, see the example below.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows several usages of the <emphasis role="italic">errMsg</emphasis> method:
<programlisting>
<![CDATA[

  say .DlgUtil~errMsg('0x80004024')
  say .DlgUtil~errMsg(2147500068)
  say
  say .DlgUtil~errMsg(266)
  say
  say .DlgUtil~errMsg(279)
  say
  say .DlgUtil~errMsg(317)
  say
  say .DlgUtil~errMsg(87)

/* Output would be:
Error code 2147500068 (0x80004024): The specified activation could not occur in the client context as specified.
Error code 2147500068 (0x80004024): The specified activation could not occur in the client context as specified.

Error code 266 (0x0000010a): The copy functions cannot be used.

Internal Windows error formatting the message (317)

Error code 317 (0x0000013d): The system cannot find message text for message number 0x%1 in the message file for %2.

Error code 87 (0x00000057): The parameter is incorrect.

*/

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::errMsg() -->

<section id="mthGetGUID" xreflabel="getGUID"><title>getGUID</title>
<indexterm><primary>getGUID</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>getGUID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getGUID(--+----------------+--)--------------><
              +--conventional--+
]]>
</programlisting>

<para>
  Returns a GUID in string format.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  </para>
  <variablelist>
    <varlistentry><term>conventional [optional]</term>
    <listitem>
    <para>
      Specifies the format of the returned GUID. If true the returned string format is Microsoft's conventional format. If
      false the string is returned in universal format. If omitted, <emphasis role="italic">conventional</emphasis> is false.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A GUID in the string format specified, or the <computeroutput>.nil</computeroutput> object on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A GUID is actually a number, a 128-bit number. That large a number is difficult to display and the conventional string
    format is commonly used when talking about a GUID. It is even difficult to pass that large a number as an argument to a
    function or method. Often software accepts the string format of a GUID and internally converts it to a number.
  </para>
  <para>
    A new GUID is generated for each invocation of this method.
  </para>
  <para>
    By default the string GUID will be similar to:
   <computeroutput>3d2c9438-a3b0-494d-ba5d-10f53e6ec9cf</computeroutput>
  </para>
  <para>
    If Microsoft's convention is requested the same GUID would be returned as:
    <computeroutput>{3d2c9438-a3b0-494d-ba5d-10f53e6ec9cf}</computeroutput>
  </para>
  <para>
    A GUID and a UUID are synonymous and can be used interchangeably in ooDialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <link linkend="dotSystemErrorCode">.SystemErrorCode</link> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example prints out a new GUID every time it is executed. Typically, the GUID would then be copy-pasted into the
    software it will be used in:
<programlisting>
<![CDATA[
/* genGUID.rex - simple GUID generating program. */

    guid = .DlgUtil~getGUID
    say guid
return 0
::requires 'ooDialog.cls'
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::getGUID() -->

<section id="mthGetSystemMetricsClsDlgUtil" xreflabel="getSystemMetrics"><title>getSystemMetrics (Class Method)</title>
<indexterm><primary>getSystemMetrics</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>getSystemMetrics</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getSystemMetrics(--index--)------------------><

]]>
</programlisting>

<para>
  Obtains the system metric value for the given index.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>The only argument is:
  <variablelist>
    <varlistentry><term>index</term>
    <listitem>
    <para>
      The numeric index of the system metric.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is dependent on the index queried. See the <emphasis role="italic">remarks</emphasis> section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Good documentation on the system metrics is found in the MSDN <xref linkend="defWindowsDoc"/>
    under the GetSystemMetrics function.  This documentation contains both the
    numeric value of the different indexes and information on what is returned for each index. The
    documentation is easy to found using a Google search of &quot;GetSystemMetrics MSDN
    library&quot;
  </para>
  <para>
    The OS will return 0 if an invalid index is used.  However, the return value for some indexes is also 0.  The
    programmer will need to determine from the context if 0 is an error return or not.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following code snippet is from an application where the user can have 5, 6, or more, independent dialogs open at
    one time. One of the menu options is &quot;Tile Dialogs.&quot; When the user selects this option all the open
    dialogs are &quot;tiled.&quot;
  </para>
  <para>
    All the open dialog objects are stored in a queue.  In the <computeroutput>onTile</computeroutput> method, which is
    invoked when the user selects the menu item, each dialog is fetched in turn from the queue.  Then the  dialog is
    repositioned at an offset from the preceding dialog. It is shifted to the right the width of 2 scroll bars and
    shifted down the width of the title bar.  (This width is the title bar width plus the thin border around the
    title bar.)  The height of the thin border, the height of the title bar, and the width of a scroll bar are all
    determined by querying the system metrics.
<programlisting>
<![CDATA[

::method onTile
  expose offSetX offSetY dialogQueue

  -- SM_CXVSCROLL = 20
  -- SM_CYCAPTION = 4
  -- SM_CYBORDER  = 6

  if \ offSetX~datatype('W') then do
    scrollBarX = .DlgUtil~getSystemMetrics(20)
    titleBarY = .DlgUtil~getSystemMetrics(4)
    windowBorderY = .DlgUtil~getSystemMetrics(6)

    offSetX = 2 * scrollBarX
    offSetY = (2 * windowBorderY) + titleBarY
  end

  parse value self~getWindowRect(self~dlgHandle) with x y .

  do dlg over dialogQueue
    x += offSetX
    y += offSetY

    self~setWindowRect(dlg~dlgHandle, x, y, 0, 0, "NOSIZE")
  end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::getSystemMetrics() [class method] -->


<section id="mthHiWord" xreflabel="hiWord"><title>hiWord (Class Method)</title>
<indexterm><primary>hiWord</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>hiWord</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hiWord(--param--)----------------------------><

]]>
</programlisting>

<para>
  The Windows API often packs two values into a single number.  One value in the low-order word and the other value in
  the high-order word.  In ooDialog this is most often seen in the arguments passed to event notification methods.  This
  utility method is used to extract the high-order word from a number.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>param [required]</term>
      <listitem>
      <para>
        The number whose high-order word is needed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is the high-order word portion of the number. This whole number value will be in the range of 0 through
    65535.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Unfortunately, the practice of packing two values into a single number can lead to ambiguities, especially when the
    values can be either negative or positive, and start getting larger. The number returned from the <emphasis
    role="italic">hiWord</emphasis> method will always be non-negative. For situations where the expected returned
    number may be negative, the <xref linkend="mthSHiWord"/> method is provided.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the loWord() <link linkend="exampleLoWordClsDlgUtil">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthLoWord" xreflabel="loWord"><title>loWord (Class Method)</title>
<indexterm><primary>loWord</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>loWord</secondary></indexterm>
<programlisting>
<![CDATA[
>>--loWord(--param--)----------------------------><

]]>
</programlisting>

<para>
  The Windows API often packs two values into a single number.  One value in the low-order word and the other value in
  the high-order word.  In ooDialog this is most often seen in the arguments passed to event notification methods.  This
  utility method is used to extract the low-order word from a number.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>param [required]</term>
      <listitem>
      <para>
        The number whose low-order word is needed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is the low-order word portion of the number. This whole number value will be in the range of 0 through
    65535.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Unfortunately, the practice of packing two values into a single number can lead to ambiguities, especially when the
    values can be either negative or positive, and start getting larger. The number returned from the <emphasis
    role="italic">loWord</emphasis> method will always be non-negative. For situations where the expected returned
    number may be negative, the <xref linkend="mthSLoWord"/> method is provided.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    A common place in the Windows API where two values are packed into a single number is where the API deals with
    position.  This example shows how to extract the x and y position coordinates of a dialog after it has been moved.
    The example is complete, it can be cut and pasted into a file and will execute as is.
<programlisting id="exampleLoWordClsDlgUtil">
<![CDATA[

  dlg = .MovingDialog~new
  dlg~createCenter(100, 60, "Move Me")
  dlg~execute("SHOWTOP")

::requires 'ooDialog.cls'

::class 'MovingDialog' subclass UserDialog

::method init
  forward class (super) continue

  self~connectMove(onMove)

::method onMove
  use arg unUsed, posInfo

  x = .DlgUtil~loWord(posInfo)
  y = .DlgUtil~hiWord(posInfo)
  say 'At coordinate (' x',' y' ) on the screen. (In pixels.)'

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthMakeLParam" xreflabel="makeLParam"><title>makeLParam (Class Method)</title>
<indexterm><primary>makeLParam</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>makeLParam</secondary></indexterm>
<programlisting>
<![CDATA[
>>--makeLParam(--numLow--,--numHigh--)-----------><

]]>
</programlisting>

<para>
  When a <xref linkend="ovvWindowMessages"/> is <link linkend="mthSendMessage">sent</link> to an
  <xref linkend="ovvUnderlying"/> window two of the arguments are the WPARAM and the LPARAM parameters.
  Quite often the Windows API requires that two numbers be packed into the LPARAM argument. The <emphasis
  role="italic">makeLParam</emphasis> method is a convenience method used to perform the packing.  It is similar to the
 <xref linkend="mthLoWord"/> and <xref linkend="mthHiWord"/> methods, but works in the
  opposite direction.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>numLow [required]</term>
    <listitem>
    <para>
      A whole number to be packed into the low word position of the LPARAM number.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>numHigh [required]</term>
    <listitem>
    <para>
      A whole number to be packed into the high word position of the LPARAM number.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a number suitable for the LPARAM argument in a message sent to an underlying window, when the message
    requires two values in LPARAM.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleMakeLParam"><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    This example shows the implementation of a method used to set the margins in an edit control
<programlisting>
<![CDATA[
::method setEditMargins
    use arg left, right

    EC_LEFTMARGIN  = "0x0001"
    EC_RIGHTMARGIN = "0x0002"
    EC_USEFONTINFO = "0xFFFF"
    EM_SETMARGINS  = "0x00D3"

    if arg(1, 'O'), arg(2, 'O') then do
       self~sendMessage(EM_SETMARGINS, 0, EC_USEFONTINFO)
    end
    else do
       flag = 0
       if arg(1, 'E') then flag = EC_LEFTMARGIN
       if arg(2, 'E') then flag = .DlgUtil~or(flag, EC_RIGHTMARGIN)
       lParam = .DlgUtil~makeLParam(left, right)
       self~sendMessage(EM_SETMARGINS, flag, lParam)
    end
    return 0
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::makeLParam() -->


<section id="mthMakeWParam" xreflabel="makeWParam"><title>makeWParam (Class Method)</title>
<indexterm><primary>makeWParam</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>makeWParam</secondary></indexterm>
<programlisting>
<![CDATA[
>>--makeWParam(--numLow--,--numHigh--)-----------><

]]>
</programlisting>

<para>
  When a <xref linkend="ovvWindowMessages"/> is <link linkend="mthSendMessage">sent</link> to an
  <xref linkend="ovvUnderlying"/> window two of the arguments are the WPARAM and the LPARAM parameters.
  Quite often the Windows API requires that two numbers be packed into the WPARAM argument. The <emphasis
  role="italic">makeWParam</emphasis> method is a convenience method used to perform the packing.  It is similar to the
  <xref linkend="mthLoWord"/> and <xref linkend="mthHiWord"/> methods, but works in the
  opposite direction.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>numLow [required]</term>
    <listitem>
    <para>
      A whole number to be packed into the low word position of the WPARAM number.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>numHigh [required]</term>
    <listitem>
    <para>
      A whole number to be packed into the high word position of the WPARAM number.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a number suitable for the WPARAM argument in a message sent to an underlying window, when the message
    requires two values in WPARAM.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example</emphasis></term>
  <listitem>
  <para>
    Although the <link linkend="exampleMakeLParam">example</link> for <emphasis role="italic">makeLParam</emphasis> does not
    show the use of <emphasis role="italic">makeWParam</emphasis>, the basic idea in using either method is essentially the
    same.
  </para>
  </listitem></varlistentry>
</variablelist> </section>  <!-- End DlgUtil::makeWParam() -->


<section id="mthOrClsDlgUtil" xreflabel="or"><title>or (Class Method)</title>
<indexterm><primary>or</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>or</secondary></indexterm>
<programlisting>
<![CDATA[
         +-,-------+
         V         |
>>--or(----number--+--)--------------------------><

]]>
</programlisting>

<para>
  Combines any number of numerical values into a single number by <emphasis role="italic">oring</emphasis> the
  individual numbers together.  This is the typical or operation used by assembly and C programmer's.  The ooDialog
  programmer does not need to understand the concept to use this method.  Some arguments to some methods in the ooDialog
  framework can take a value that is a combination of some individual <emphasis role="italic">flags</emphasis>.  The or
  method is provided to construct this combination.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There is no restriction on the number of arguments to this method, other than each argument must represent a whole
    number.
  </para>
  <para>
    As a convenience, the whole numbers can also be specified as a string with the following format:
    <computeroutput>0x</computeroutput> followed by a series of hexadecimal digits with no spaces. Such as
    <computeroutput>"0xff12abc9"</computeroutput> or <computeroutput>"0x1"</computeroutput> or
    <computeroutput>"0x00000080"</computeroutput>. This makes it easy to look up and use the value of a flag directly.
    For instance looking up the value of <computeroutput>ILC_COLOR24</computeroutput>, one would see it is
    <computeroutput>0x00000018</computeroutput>. This value could be used directly in the
    <computeroutput>or()</computeroutput> method. Case is not significant in the string.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is a number that is the result of combining all the individual arguments together.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    One method that has an argument that can be the result of combining a number of flags is the
<xref linkend="mthCreateClsImageList"/> method of the
<xref linkend="clsImage"/> class.  This is how the or method might be used
<programlisting> <![CDATA[
  flags = .DlgUtil~or(.Image~toID(ILC_COLOR24), .Image~toID(ILC_MASK))

  -- Create an empty .ImageList object:
  imageList = .ImageList~create(.Size~new(61, 46), flags, 10, 10);
]]>
</programlisting>
    </para>
    <para>
      The following is equivalent to the above example:
<programlisting>
<![CDATA[
  flags = .DlgUtil~or(0x00000018, 0x00000001)

  -- Create an empty .ImageList object:
  imageList = .ImageList~create(.Size~new(61, 46), flags, 10, 10);
]]>
</programlisting>
  </para>
  <para>
    To round out the examples a little:
<programlisting>
<![CDATA[
  flags = .DlgUtil~or(.Image~toID(ILC_COLOR24), .Image~toID(ILC_MASK))
  say "Flags value:" flags

  flags = .DlgUtil~or(0x00000018, 0x00000001)
  say "Flags value:" flags

::requires 'ooDialog.cls'

/* Output would be:

     Flags value: 25
     Flags value: 25
*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::or() [class method] -->


<section id="mthScreenArea" xreflabel="screenArea"><title>screenArea (Class Method)</title>
<indexterm><primary>screenArea</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>screenArea</secondary></indexterm>
<programlisting>
<![CDATA[
>>--screenArea-----------------------------------><

]]>
</programlisting>

<para>
  Gets the usable screen area (work area.) on the primary display monitor. The work area is the portion of the screen
  not obscured by the system taskbar or by application desktop toolbars.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method takes no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A <xref linkend="clsRect"/> object that contains the coordinates of the work area. The coordinates are
    expressed in screen <xref linkend="defScreenCoordinates"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::screenArea() -->


<section id="mthScreenSize" xreflabel="screenSize"><title>screenSize (Class Method)</title>
<indexterm><primary>screenSize</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>screenSize</secondary></indexterm>
<programlisting>
<![CDATA[
>>--screenSize(--+--------+--+-----------+--)----><
                 +--flag--+  +-,-dlgObj--+
]]>
</programlisting>

<para>
  Retrieves the screen size in either pixels, dialog units, or both.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>flag [optional]</term>
      <listitem>
      <para>
        A keyword signaling whether to return the size in pixels, dialog units, or both. The default is both. The keywords
        are PIXELS, DIALOGUNITS, and BOTH.  Only the first letter is needed and case is insignificant.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>dlgObj [optional]</term>
      <listitem>
      <para>
        A Rexx dialog object. When this argument is used, dialog units are calculated correctly for the dialog. If it is
        omitted, the dialog units will most likely be incorrect. See the remarks section
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is dependent on the flag in use:
    <variablelist>
      <varlistentry><term>Pixels:</term>
      <listitem>
      <para>
        A <xref linkend="clsSize"/> object with the screen size in pixels.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DialogUnits</term>
      <listitem>
      <para>
        A <xref linkend="clsSize"/> object with the screen size in dialog units.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>Both</term>
      <listitem>
      <para>
        An <computeroutput>Array</computeroutput>> with the screen size in dialog units at indexes 1 and 2 and the size
        in pixels at indexes 3 and 4. Indexes 1 and 3 contain the width, indexes 2 and 4 contain the height..
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If a Rexx dialog object is not supplied, it is unlikely that the <xref linkend="defDialogUnit"/>s will be correct.
    Without a reference to a dialog, the method calculates the dialog units using 8 point System font.
    Since dialog units are dependent on the font in use for a specific dialog, It is highly unlikely that this is
    correct for any specific dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example calculates the mid-point of the upper left quadrant of the screen and positions the dialog at that
    point:
<programlisting>
<![CDATA[

::method initDialog

  -- Get the screen size and then position ourself in the upper left quadrant.
  s = .DlgUtil~screenSize('P')
  p = .Point~new(s~width % 4, s~height % 4)
  self~moveTo(p, "SHOWWINDOW")
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::screenSize() -->


<section id="mthShiftLeft" xreflabel="shiftLeft"><title>shiftLeft</title>
<indexterm><primary>shiftLeft</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>shiftLeft</secondary></indexterm>
<programlisting>
<![CDATA[
>>--shiftLeft(--unsignedN--+----------+--)-------><
                           +-,-count--+
]]>
</programlisting>

<para>
  Performs a logical bitwise shift left.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>unsignedN</term>
      <listitem>
      <para>
        A non-negative whole number up to 64 bits in size. That is, 0 to 18,446,744,073,709,551,615.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>count</term>
      <listitem>
      <para>
        The non-negative whole number of bits to shift. <emphasis role="italic">count</emphasis> must be in the range of
        0 to 63.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The unsigned whole number that is the result of the logical shift.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::shiftLeft() -->

<section id="mthShiftRight" xreflabel="shiftRight"><title>shiftRight</title>
<indexterm><primary>shiftRight</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>shiftRight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--shiftRight(--unsignedN--+----------+--)------><
                            +-,-count--+
]]>
</programlisting>

<para>
  Performs a logical bitwise shift right.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>unsignedN</term>
      <listitem>
      <para>
        A non-negative whole number up to 64 bits in size. That is, 0 to 18,446,744,073,709,551,615.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>count</term>
      <listitem>
      <para>
        The non-negative whole number of bits to shift. <emphasis role="italic">count</emphasis> must be in the range of
        0 to 63.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The unsigned whole number that is the result of the logical shift.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::shiftRight() -->


<section id="mthSHiWord" xreflabel="sHiWord"><title>sHiWord (Class Method)</title>
<indexterm><primary>sHiWord</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>sHiWord</secondary></indexterm>
<programlisting>
<![CDATA[
>>--sHiWord(--param--)---------------------------><

]]>
</programlisting>

<para>
  The Windows API often packs two values into a single number.  One value in the low-order word and the other value in
  the high-order word. The <emphasis role="italic">sHiWord</emphasis> method is the signed version of the
 <xref linkend="mthHiWord"/> method. It is used to extract the high-order word from a number, where the
  value of the high-order word may be positive or negative.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>param [required]</term>
      <listitem>
      <para>
        The number whose high-order word is needed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is the high-order word portion of the number. The returned whole number will be in the range of -32768 to
    32767.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Unfortunately, the practice of packing two values into a single number can lead to ambiguities, especially when the
    values can be either negative or positive, and start getting larger. The number returned from the <emphasis
    role="italic">sHiWord</emphasis> method can be either negative or positive, but the largest maximum number will only
    be 32767. For situations where the expected returned number is always positive and may be larger than 32767, the
 <xref linkend="mthHiWord"/> method is provided.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the <emphasis role="italic">sLoWord</emphasis> <link linkend="exampleSLoWordClsDlgUtil">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthSigned" xreflabel="signed"><title>signed</title>
<indexterm><primary>signed</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>signed</secondary></indexterm>
<programlisting>
<![CDATA[
>>--signed(--unsigned--)-------------------------><

]]>
</programlisting>

<para>
  Casts an unsigned whole number to its signed equivalent.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>unsigned</term>
      <listitem>
      <para>
        The unsigned whole number to cast.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The signed equivalent of <emphasis role="italic">unsigned</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">signed</emphasis> method works with whole numbers of the same size as the addressing
    mode of the interpreter. I.e., if the address mode is 32-bit, <emphasis role="italic">signed</emphasis> works with
    32-bit numbers and if the addressing mode is 64-bit it works with 64-bit numbers.
  </para>
  <para>
    In 32-bit addressing mode, <emphasis role="italic">signed</emphasis> accepts a whole number in the range of 0 to
    4,294,967,295 and returns a whole number in the range of -2,147,483,648 to 2,147,483,647.
  </para>
  <para>
    In 64-bit addressing mode, <emphasis role="italic">signed</emphasis> accepts a whole number in the range of 0 to
    18,446,744,073,709,551,615 and returns a whole number in the range of -9,223,372,036,854,775,808 to
    9,223,372,036,854,775,807.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::signed() -->


<section id="mthSigned32" xreflabel="signed32"><title>signed32</title>
<indexterm><primary>signed32</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>signed32</secondary></indexterm>
<programlisting>
<![CDATA[
>>--signed(--unsigned--)-------------------------><

]]>
</programlisting>

<para>
  Casts a 32-bit unsigned whole number to its 32-bit signed equivalent.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>unsigned</term>
      <listitem>
      <para>
        The unsigned 32-bit whole number to cast.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The 32-bit signed equivalent of <emphasis role="italic">unsigned</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <xref linkend="mthSigned"/> method works with whole numbers of the same size as the addressing mode of the
    interpreter. I.e., if the address mode is 32-bit, <emphasis role="italic">signed</emphasis> works with
    32-bit numbers and if the addressing mode is 64-bit it works with 64-bit numbers.
  </para>
  <para>
    In 32-bit addressing mode, <emphasis role="italic">signed</emphasis> accepts a whole number in the range of 0 to
    4,294,967,295 and returns a whole number in the range of -2,147,483,648 to 2,147,483,647.
  </para>
  <para>
    In 64-bit addressing mode, <emphasis role="italic">signed</emphasis> accepts a whole number in the range of 0 to
    18,446,744,073,709,551,615 and returns a whole number in the range of -9,223,372,036,854,775,808 to
    9,223,372,036,854,775,807.
  </para>
  <para>
    In general, the <emphasis role="italic">signed</emphasis> and <emphasis role="italic">unsigned</emphasis> methods work
    well. However, there is a problem in 64-bit addressing mode when trying to convert a number known to be 32-bit. A number
    such as 0xfffffdd8 is positive 4294966744 if treated as a 64-bit number. However it is -552 if treated as a 32-bit
    number. The <emphasis role="italic">signed32</emphasis> and <xref linkend="mthUnsigned32"/> methods are for use in these
    cases.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::signed() -->


<section id="mthSLoWord" xreflabel="sLoWord"><title>sLoWord (Class Method)</title>
<indexterm><primary>sLoWord</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>sLoWord</secondary></indexterm>
<programlisting>
<![CDATA[
>>--sLoWord(--param--)---------------------------><

]]>
</programlisting>

<para>
  The Windows API often packs two values into a single number.  One value in the low-order word and the other value in
  the high-order word. The <emphasis role="italic">sLoWord</emphasis> method is the signed version of the
 <xref linkend="mthLoWord"/> method. It is used to extract the low-order word from a number, where the
  value of the low-order word may be positive or negative.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>param [required]</term>
      <listitem>
      <para>
        The number whose low-order word is needed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is the low-order word portion of the number. The returned whole number will be in the range of -32768 to
    32767
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Unfortunately, the practice of packing two values into a single number can lead to ambiguities, especially when the
    values can be either negative or positive, and start getting larger. The number returned from the <emphasis
    role="italic">sLoWord</emphasis> method can be either negative or positive, but the largest maximum number will only
    be 32767. For situations where the expected returned number is always positive and may be larger than 32767, the
 <xref linkend="mthLoWord"/> method is provided.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    One place where two values are packed into one number by the operating system is the return from scrolling an edit
    control. The operating system returns true or false in the high word, for success or failure. The lines scrolled are
    in the low word. When the edit control is scrolled from the bottom towards the top, the number of lines is negative.
    This example shows the result of using the <xref linkend="mthScrollCommand"/> repeatedly until
    the top of the edit control is reached:

<programlisting id="exampleSLoWordClsDlgUtil">
<![CDATA[

  success = .true
  do while success
    ret = editControl~scrollCommand("PAGEUP")

    success = .DlgUtil~sHiWord(ret)
    linesMoved = .DlgUtil~sLoWord(ret)

    say "Scrolled the edit control:"
    say "  Success?" success
    say "  Lines:  " linesMoved
  end

/* Output might be:

Scrolled the edit control:
  Success? 1
  Lines:   -16
Scrolled the edit control:
  Success? 1
  Lines:   -16
...
Scrolled the edit control:
  Success? 1
  Lines:   -16
Scrolled the edit control:
  Success? 1
  Lines:   -5
Scrolled the edit control:
  Success? 0
  Lines:   0

*/

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthSShiftLeft" xreflabel="sShiftLeft"><title>sShiftLeft</title>
<indexterm><primary>sShiftLeft</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>sShiftLeft</secondary></indexterm>
<programlisting>
<![CDATA[
>>--sShiftLeft(--signedN--+----------+--)--------><
                          +-,-count--+
]]>
</programlisting>

<para>
  Performs a logical bitwise shift left on a whole number.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>signedN</term>
      <listitem>
      <para>
        A whole number up to 64 bits in size. That is, -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>count</term>
      <listitem>
      <para>
        The non-negative whole number of bits to shift. <emphasis role="italic">count</emphasis> must be in the range of
        0 to 63.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The whole number that is the result of performing the logical shift.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::sShiftLeft() -->

<section id="mthSShiftRight" xreflabel="sShiftRight"><title>sShiftRight</title>
<indexterm><primary>sShiftRight</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>sShiftRight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--sShiftRight(--signedN--+----------+--)-------><
                           +-,-count--+
]]>
</programlisting>

<para>
  Performs a logical bitwise shift right on a whole number.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>signedN</term>
      <listitem>
      <para>
        A whole number up to 64 bits in size. That is, -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>count</term>
      <listitem>
      <para>
        The non-negative whole number of bits to shift. <emphasis role="italic">count</emphasis> must be in the range of
        0 to 63.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The whole number that is the result of performing the logical shift.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::sShiftRight() -->


<section id="mthThreadID" xreflabel="threadID"><title>threadID (Class Method)</title>
<indexterm><primary>threadID</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>threadID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--threadID-------------------------------------><

]]>
</programlisting>

<para>
  Returns the thread identifier of the thread the method is executing in.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a non-zero positive number, the number the operating system uses to identify the current thread.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Until the thread terminates, the thread identifier uniquely identifies the thread throughout the operating system.
  </para>
  <para>
    This is a convenience method for the use of the developers more than anything. However, for any user of ooRexx it
    does provide some insight into the concurrency functionality of ooRexx.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example displays the thread ID from several different threads, (activities,) during the life cycle of a dialog.
<programlisting>
<![CDATA[

  dlg = .SimpleDialog~new
  say "In the start up of the program thread ID:  " .DlgUtil~threadID
  dlg~execute("SHOWTOP", IDI_DLG_OOREXX)

::requires "ooDialog.cls"

::class 'SimpleDialog' subclass UserDialog

::method init
  forward class (super) continue

  self~create(30, 30, 257, 123, "Simple Dialog", "CENTER")

::method defineDialog

  self~createPushButton(IDOK, 142, 99, 50, 14, "DEFAULT", "Ok")
  self~createPushButton(IDCANCEL, 197, 99, 50, 14, , "Cancel")

::method initDialog

  say "In initDialog() thread ID:                 " .DlgUtil~threadID
  self~start("secondActivity")

::method secondActivity unguarded

  reply 0
  j = SysSleep(1)
  say "Executing in the second activity thread ID:" .DlgUtil~threadID

::method ok unguarded

  say "In the ok method thread ID:                " .DlgUtil~threadID
  return self~ok:super

/* The output on the console might ge:

In the start up of the program thread ID:   128
In initDialog() thread ID:                  128
Executing in the second activity thread ID: 2672
In the ok method thread ID:                 2344

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::threadID() -->


<section id="mthUnsigned" xreflabel="unsigned"><title>unsigned</title>
<indexterm><primary>unsigned</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>unsigned</secondary></indexterm>
<programlisting>
<![CDATA[
>>--unsigned(--signed--)-------------------------><

]]>
</programlisting>

<para>
  Casts a signed whole number to its unsigned equivalent.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>signed</term>
      <listitem>
      <para>
        The signed whole number to be cast.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The unsigned whole number equivalent to <emphasis role="italic">signed</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">unsigned</emphasis> method works with whole numbers of the same size as the addressing
    mode of the interpreter. I.e., if the address mode is 32-bit, <emphasis role="italic">unsigned</emphasis> works with
    32-bit numbers and if the addressing mode is 64-bit it works with 64-bit numbers.
  </para>
  <para>
    In 32-bit addressing mode, <emphasis role="italic">unsigned</emphasis> accepts a whole number in the range of
    -2,147,483,648 to 2,147,483,647 and returns a whole number in the range of 0 to 4,294,967,295.
  </para>
  <para>
    In 64-bit addressing mode, <emphasis role="italic">unsigned</emphasis> accepts a whole number in the range of
    -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807 and returns a whole number in the range of 0 to
    18,446,744,073,709,551,615.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::unsigned() -->


<section id="mthUnsigned32" xreflabel="unsigned32"><title>unsigned32</title>
<indexterm><primary>unsigned32</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>unsigned32</secondary></indexterm>
<programlisting>
<![CDATA[
>>--unsigned32(--signed--)-----------------------><

]]>
</programlisting>

<para>
  Casts a 32-bit signed whole number to its 32 bit-unsigned equivalent.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>signed</term>
      <listitem>
      <para>
        The signed 32-bit whole number to be cast.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The unsigned 32-bit whole number equivalent to <emphasis role="italic">signed</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <xref linkend="mthSigned"/> method works with whole numbers of the same size as the addressing mode of the
    interpreter. I.e., if the address mode is 32-bit, <emphasis role="italic">unsigned</emphasis> works with 32-bit numbers
    and if the addressing mode is 64-bit it works with 64-bit numbers.
  </para>
  <para>
    In 32-bit addressing mode, <emphasis role="italic">unsigned</emphasis> accepts a whole number in the range of
    -2,147,483,648 to 2,147,483,647 and returns a whole number in the range of 0 to 4,294,967,295.
  </para>
  <para>
    In 64-bit addressing mode, <emphasis role="italic">unsigned</emphasis> accepts a whole number in the range of
    -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807 and returns a whole number in the range of 0 to
    18,446,744,073,709,551,615.
  </para>
  <para>
    In general, the <emphasis role="italic">signed</emphasis> and <emphasis role="italic">unsigned</emphasis> methods work
    well. However, there is a problem in 64-bit addressing mode when trying to convert a number known to be 32-bit. A number
    such as 0xfffffdd8 is positive 4294966744 if treated as a 64-bit number. However it is -552 if treated as a 32-bit
    number. The <emphasis role="italic">unsigned32</emphasis> and <xref linkend="mthSigned32"/> methods are for use in these
    cases.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::unsigned32() -->


<section id="mthVersion" xreflabel="version"><title>version (Class Method)</title>
<indexterm><primary>version</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>version</secondary></indexterm>
<programlisting>
<![CDATA[

>>-version(--+---------+-)-----------------------><
             +-format--+
]]>
</programlisting>

<para>
  Returns the ooDialog version string.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
    <varlistentry><term>format [optional]</term>
    <listitem>
    <para>
      A keyword indicating the format of the returned version string.  Only the first letter is needed and case is not
      significant.  Any unrecognized keyword is ignored and the default format is used.  The format for each keyword is
      as follows:
    </para>
    <variablelist>
      <varlistentry><term>Full</term>
      <listitem>
      <para>
        A string specifying the version of ooDialog.  This is the default. The string has the format:
        <computeroutput>ooDialog Version x.x.x.SS (an ooRexx Windows Extension) </computeroutput> where x.x.x is the
        ooDialog version and SS is the Subversion revision number of the build. The actual version string might look
        like: <computeroutput>ooDialog Version 4.2.0.8038 (an ooRexx Windows Extension)</computeroutput>
      </para> </listitem></varlistentry>
      <varlistentry><term>Short</term>
      <listitem>
      <para>
        Only the x.x.x.SS part of the full version string is returned. Using the above example, the string would look
        like <computeroutput>4.2.0.8038</computeroutput> .
      </para>
      </listitem></varlistentry>
      <varlistentry><term>Level</term>
      <listitem>
      <para>
        The ooDialog <link linkend="tblOODialogLevels">level</link>. Continuing with the same example the level would be
        <computeroutput>4.2.0</computeroutput>
      </para>
      </listitem></varlistentry>
    </variablelist>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A string in one of the formats specified above.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
<programlisting>
<![CDATA[
v = .DlgUtil~version
say v
say

if .DlgUtil~version("SHORT") < 4.1.0.0000 then do
  say 'Too bad, you are still running ooRexx 4.0.0'
end
else do
  if .DlgUtil~version("LEVEL") < 4.2.0 then
    say 'You should really get a 4.2.0 ooDialog, it is much improved.'
end

::requires 'ooDialog.cls'

/* On the screen you might see:

ooDialog Version 4.0.0.3768 (an ooRexx Windows Extension)

Too bad, you are still running ooRexx 4.0.0

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthWindowFromPoint" xreflabel="windowFromPoint"><title>windowFromPoint</title>
<indexterm><primary>windowFromPoint</primary></indexterm>
<indexterm><primary>DlgUtil class</primary><secondary>windowFromPoint</secondary></indexterm>
<programlisting>
<![CDATA[
>>--windowFromPoint(--p--)-----------------------><

]]>
</programlisting>

<para>
  Retrieves the window <xref linkend="defHandle"/> of the window that contains the specified point.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>p [required]</term>
      <listitem>
      <para>
        A <xref linkend="clsPoint"/> object that specifies the point to be tested.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a handle to the window that contains the point. If no window exists at the point then 0 is returned. For a
 <xref linkend="clsStatic"/> text control, the handle to the window under the control is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method does not retrieve handles of hidden or disabled windows even if the point is within the window. The
    <xref linkend="mthChildWindowFromPoint"/> method of the
    <xref linkend="chpDialogObject"/> object can be used for a nonrestrictive search.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a method that tests if the mouse is over a list view control and that there is no other window
    covering the list view at that point:
<programlisting>
<![CDATA[

  ::method overListView private

    if \ self~isDialogActive then return .false

    mouse = .Mouse~new(self)
    pos = mouse~getCursorPos

    hwndLV = self~newListView(IDC_LV)~hwnd

    if .DlgUtil~windowFromPoint(pos) == hwndLV then return .true
    else return .false

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DlgUtil::windowFromPoint() -->

</section> <!-- End DlgUtil Class -->


<section id="rtnFindWindow" xreflabel="FindWindow"><title>FindWindow Routine</title>
<indexterm><primary>FindWindow</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>FindWindow</secondary></indexterm>
<para>Searches the Windows application list for a specific window and
returns its handle.</para>
<programlisting>
<![CDATA[
>>-FindWindow(--Caption--)-----------------------><
]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Argument:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>Caption</term>
<listitem><para>Caption of the window that is to be searched.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>Handle of the window or 0 if the window was not found.
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="rtnLocate" xreflabel="Locate"><title>Locate</title>
<indexterm><primary>Locate</primary></indexterm>
<indexterm><primary>public routines</primary><secondary>Locate</secondary></indexterm>
<programlisting>
<![CDATA[
>>--Locate(--+----------+--)---------------------><
             +--update--+
]]>
</programlisting>

<para>
  Returns the directory containing the Rexx source code file that <emphasis role="italic">Locate</emphasis> is executing in.
  This is similar to <emphasis role="italic">parse source</emphasis>, but returns the complete directory path rather than the
  complete file name. In addition, <emphasis role="italic">Locate</emphasis> sets the value of the <xref
  linkend="atrSrcDir"/> attribute of the <xref linkend="dotApplication"/> to the complete directory path name.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>update [optional]</term>
      <listitem>
      <para>
        By default this routine only sets the <computeroutput>.application's</computeroutput> <emphasis
        role="italic">srcDir</emphasis> attribute the first time it is invoked. On successive invocations, it does not change
        the attribute. If update is true, it resets the <computeroutput>.application's</computeroutput> <emphasis
        role="italic">srcDir</emphasis> attribute to the value it is returning.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the complete path name, including the trailing slash (<emphasis role="italic">\</emphasis>,) of the directory the
    source code file containing the executing <emphasis role="italic">Locate</emphasis> is located in.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The primary purpose of the <emphasis role="italic">Locate</emphasis> function is to help the ooDialog programmer create
    complete path names for any resource files, or other auxiliary files, needed by an application. This in turns allows the
    application to be executed from any directory. The <emphasis role="italic">Locate</emphasis> function is a convenience
    function. The same functionality can be achieved using <emphasis role="italic">parse source</emphasis> and some mechanism
    for retaining the directory value.
  </para>
  <para>
    Typically, <emphasis role="italic">Locate</emphasis> function would be executed once during the start up of an
    application and the <emphasis role="italic">srcDir</emphasis> attribute of the <emphasis
    role="italic">.application</emphasis> object would be used elsewhere in the application to gain access to the directory
    value. If the programmer chooses to execute <emphasis role="italic">Locate</emphasis> more than once, then she would need
    to decide if the <emphasis role="italic">srcDir</emphasis> attribute's value should be updated with the new directory
    value. Assuming, <emphasis role="italic">Locate</emphasis> is returning a new value. This is the purpose of the <emphasis
    role="italic">update</emphasis> argument. By default, the <emphasis role="italic">srcDir</emphasis> attribute will not be
    changed. Pass true as the first argument to <emphasis role="italic">Locate</emphasis> to force the routine to update the
    <emphasis role="italic">srcDir</emphasis> attribute.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example comes from an application that has its resource files located in a subdirectory of the main application
    directory. The <emphasis role="italic">Locate</emphasis> function is used to get the complete path name of the directory
    the main program file is in and then the returned value is used to construct complete path names to the application's
    resource files:
<programlisting>
<![CDATA[

  srcDir = Locate()

  rcFile = srcDir"resources\imageButton.rc"
  symbolFile = srcDir"resources\imageButton.h"

  .application~setDefaults("O", symbolFile, .false)

  dlg = .ImageListDlg~new(rcFile, IDD_IMAGELIST_BUTTON)
  ...

::class 'ImageListDlg' subclass RcDialog
  ...

::method setPictureButtons private
  expose pbView pbAdd stStatus imagesLoaded imageList

  if .DlgUtil~comCtl32Version < 6 then return self~oldSetButtons

  pbView~style = "MULTILINE BOTTOM"

  srcDir = .application~srcDir

  -- The images are loaded from files.
  files = .array~new()
  files[1] = srcDir"resources\Normal.bmp"       -- Normal
  files[2] = srcDir"resources\Hot.bmp"          -- Hot (hover)
  files[3] = srcDir"resources\Pushed.bmp"       -- Pushed
  files[4] = srcDir"resources\Disabled.bmp"     -- Disabled
  files[5] = srcDir"resources\Default.bmp"      -- Default button
  files[6] = srcDir"resources\Hot.bmp"          -- Stylus hot, tablet PC only
  ...
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Locate() -->


<section id="rtnMSSleep" xreflabel="MSSleep"><title>MSSleep Routine</title>
<indexterm><primary>MSSleep</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>MSSleep</secondary></indexterm>
<para>Sleeps for the specified number of milliseconds.</para>
<programlisting>
<![CDATA[
>>-MSSleep(--duration--)-------------------------><
]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Argument:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>duration</term>
<listitem><para>The time in milliseconds to sleep.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>This function always returns 0.
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="clsOS" xreflabel="OS"><title>OS Class</title>
<indexterm><primary>OS class</primary></indexterm>
<para>
  The <computeroutput>OS</computeroutput> class provides methods for interacting with the operating system a program is
  currently executing on. Many of the methods extract information from or about the operating system. Other methods set
  operating system wide information or notify the operating system of changes.
</para>
<para>
  All the methods of the OS class are class methods. In general these methods are easy to use, returning true or false
  about a specific piece of information. See the <xref linkend="mthIsAtLeastVista"/>() method for an
  example of usage.
</para>


<section id="sctMethodsOS"><title>Method Table</title>
<para>
  The following table lists the class methods of the <computeroutput>OS</computeroutput> class:
<table id="tblMethodsOS" frame="all"> <title>OS Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthIs32on64bit"/></entry>
<entry>Tests if running under ooRexx 32-bit on a 64 bit system</entry>
</row>
<row>
<entry><xref linkend="mthIs64bit"/></entry>
<entry>Tests if running under ooRexx 64-bit</entry>
</row>
<row>
<entry><xref linkend="mthIsAtLeastVista"/></entry>
<entry>Tests if operating system is Windows Vista or later</entry>
</row>
<row>
<entry><xref linkend="mthIsAtLeastW2K"/></entry>
<entry>Tests if operating system is Windows 2000 or later</entry>
</row>
<row>
<entry><xref linkend="mthIsAtLeastW2K3"/></entry>
<entry>Tests if operating system is Windows 2003 or later</entry>
</row>
<row>
<entry><xref linkend="mthIsAtLeastWindows7"/></entry>
<entry>Tests if operating system is Windows 7 or later</entry>
</row>
<row>
<entry><xref linkend="mthIsAtLeastXP"/></entry>
<entry>Tests if operating system is Windows XP or later</entry>
</row>
<row>
<entry><xref linkend="mthIsServer2008"/></entry>
<entry>Tests if operating system is Windows Server 2008</entry>
</row>
<row>
<entry><xref linkend="mthIsServer2008R2"/></entry>
<entry>Tests if operating system is Windows Server 2008 Release 2</entry>
</row>
<row>
<entry><xref linkend="mthIsVista"/></entry>
<entry>Tests if operating system is Windows Vista</entry>
</row>
<row>
<entry><xref linkend="mthIsW2K"/></entry>
<entry>Tests if operating system is Windows 2000</entry>
</row>
<row>
<entry><xref linkend="mthIsW2K3"/></entry>
<entry>Tests if operating system is Windows 2003</entry>
</row>
<row>
<entry><xref linkend="mthIsWindows7"/></entry>
<entry>Tests if operating system is Windows 7</entry>
</row>
<row>
<entry><xref linkend="mthIsWow64"/></entry>
<entry>Alias for the <emphasis role="italic">is32on64bit</emphasis>() method</entry>
</row>
<row>
<entry><xref linkend="mthIsXP"/></entry>
<entry>Tests if operating system is Windows XP</entry>
</row>
<row>
<entry><xref linkend="mthIsXP32"/></entry>
<entry>Tests if operating system is 32-bit Windows XP</entry>
</row>
<row>
<entry><xref linkend="mthIsXP64"/></entry>
<entry>Tests if operating system is 64-bit Windows XP</entry>
</row>
<row>
<entry><xref linkend="mthSettingChanged"/></entry>
<entry>Notifies the operating system that environment settings have changed.</entry>
</row>
<row>
<entry><xref linkend="mthShellChangeNotify"/></entry>
<entry>Notifies the operating system that the application has performed an action that may affect the Shell.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="mthIs32on64bit" xreflabel="is32on64bit"><title>is32on64bit (Class Method)</title>
<indexterm><primary>is32on64bit</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>is32on64bit</secondary></indexterm>
<programlisting> <![CDATA[

>>--is32on64bit----------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running under the 32-bit ooRexx interpreter on a 64-bit version of
  Windows, otherwise false.
</para>
</section>  <!-- End OS::is32on64bit() [class method] -->


<section id="mthIs64bit" xreflabel="is64bit"><title>is64bit (Class Method)</title>
<indexterm><primary>is64bit</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>is64bit</secondary></indexterm>
<programlisting>
<![CDATA[

>>--is64bit--------------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running under the 64-bit ooRexx interpreter on a 64-bit version of
  Windows, otherwise false.
</para>
</section>  <!-- End OS::is64bit() [class method] -->


<section id="mthIsAtLeastVista" xreflabel="isAtLeastVista"><title>isAtLeastVista (Class Method)</title>
<indexterm><primary>isAtLeastVista</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isAtLeastVista</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isAtLeastVista-------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows Vista, or later. Otherwise it returns false.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The <xref linkend="clsMonthCalendar"/> class has a number of methods that are only available on
    Windows Vista or Windows 7. This example is from a program that demonstrates those methods. It first checks if the
    program is running on Vista, and if not it quits.
<programlisting>
<![CDATA[

/* Simple MonthCalendar example */

  -- We demonstrate some of the MonthCalendar features here that are
  -- only available on Vista.  So, be sure we are running on Vista and
  -- abort if not.
  if \ .OS~isAtLeastVista then do
    info = "This program requires Windows Vista or later."
    return messageDialog(info, , "Error", "OK", "HAND")
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End OS::isAtLeastVista() [class method] -->


<section id="mthIsAtLeastW2K" xreflabel="isAtLeastW2K"><title>isAtLeastW2K (Class Method)</title>
<indexterm><primary>isAtLeastW2K</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isAtLeastW2K</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isAtLeastW2K---------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows 2000, or later. Otherwise it returns false.
</para>
</section>  <!-- End OS::isAtLeastW2K() [class method] -->


<section id="mthIsAtLeastW2K3" xreflabel="isAtLeastW2K3"><title>isAtLeastW2K3 (Class Method)</title>
<indexterm><primary>isAtLeastW2K3</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isAtLeastW2K3</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isAtLeastW2K3--------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows 2003, or later. Otherwise it returns false.
</para>
</section>  <!-- End OS::isAtLeastW2K3() [class method] -->


<section id="mthIsAtLeastWindows7" xreflabel="isAtLeastWindows7"><title>isAtLeastWindows7 (Class Method)</title>
<indexterm><primary>isAtLeastWindows7</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isAtLeastWindows7</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isAtLeastWindows7----------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows 7, or later. Otherwise it returns false.
</para>
</section>  <!-- End OS::isAtLeastWindows7() [class method] -->


<section id="mthIsAtLeastXP" xreflabel="isAtLeastXP"><title>isAtLeastXP (Class Method)</title>
<indexterm><primary>isAtLeastXP</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isAtLeastXP</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isAtLeastXP----------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows XP, or later. Otherwise it returns false.
</para>
</section>  <!-- End OS::isAtLeastXP() [class method] -->


<section id="mthIsServer2008" xreflabel="isServer2008"><title>isServer2008 (Class Method)</title>
<indexterm><primary>isServer2008</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isServer2008</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isServer2008---------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows Server 2008, otherwise false.
</para>
</section>  <!-- End OS::isServer2008() [class method] -->


<section id="mthIsServer2008R2" xreflabel="isServer2008R2"><title>isServer2008R2 (Class Method)</title>
<indexterm><primary>isServer2008R2</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isServer2008R2</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isServer2008R2-------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows Server 2008 Release 2, otherwise false.
</para>
</section>  <!-- End OS::isServer2008R2() [class method] -->


<section id="mthIsVista" xreflabel="isVista"><title>isVista (Class Method)</title>
<indexterm><primary>isVista</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isVista</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isVista--------------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows Vista, otherwise false.
</para>
</section>  <!-- End OS::isVista() [class method] -->


<section id="mthIsW2K" xreflabel="isW2K"><title>isW2K (Class Method)</title>
<indexterm><primary>isW2K</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isW2K</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isW2K----------------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows 2000, otherwise false.
</para>
</section>  <!-- End OS::isW2K() [class method] -->


<section id="mthIsW2K3" xreflabel="isW2K3"><title>isW2K3 (Class Method)</title>
<indexterm><primary>isW2K3</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isW2K3</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isW2K3---------------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows 2003, otherwise false.
</para>
</section>  <!-- End OS::isW2K3() [class method] -->


<section id="mthIsWindows7" xreflabel="isWindows7"><title>isWindows7 (Class Method)</title>
<indexterm><primary>isWindows7</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isWindows7</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isWindows7-----------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows 7, otherwise false.
</para>
</section>  <!-- End OS::isWindows7() [class method] -->


<section id="mthIsWow64" xreflabel="isWow64"><title>isWow64 (Class Method)</title>
<indexterm><primary>isWow64</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isWow64</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isWow64--------------------------------------><

]]>
</programlisting>

<para>
  This is an alias for the <emphasis role="italic">is32on64bit</emphasis>() method.  WoW is Microsoft's term for running
  Windows on Windows.  In this case running 32-bit Windows on a 64-bit version of Windows.  The method returns true if
  the currently executing program is running under the 32-bit ooRexx interpreter on a 64-bit version of Windows,
  otherwise false.
</para>
</section>  <!-- End OS::isWow64() [class method] -->


<section id="mthIsXP" xreflabel="isXP"><title>isXP (Class Method)</title>
<indexterm><primary>isXP</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isXP</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isXP-----------------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on Windows XP, otherwise false.
</para>
</section>  <!-- End OS::isXP() [class method] -->

<section id="mthIsXP32" xreflabel="isXP32"><title>isXP32 (Class Method)</title>
<indexterm><primary>isXP32</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isXP32</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isXP-----------------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on 32-bit Windows XP, otherwise false.
</para>
</section>  <!-- End OS::isXP32() [class method] -->

<section id="mthIsXP64" xreflabel="isXP64"><title>isXP64 (Class Method)</title>
<indexterm><primary>isXP64</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>isXP64</secondary></indexterm>
<programlisting>
<![CDATA[

>>--isXP64---------------------------------------><

]]>
</programlisting>

<para>
  Returns true if the currently executing program is running on 64-bit Windows XP, otherwise false.
</para>
</section>  <!-- End OS::isXP64() [class method] -->

<section id="mthSettingChanged" xreflabel="settingChanged"><title>settingChanged</title>
<indexterm><primary>settingChanged</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>settingChanged</secondary></indexterm>
<programlisting>
<![CDATA[
>>--settingChanged(--+-----------+--+---------+--+--------+--)--><
                     +--timeOut--+  +-,-opts--+  +-,-area-+
]]>
</programlisting>

<para>
  Sends the WM_SETTINGCHANGE to all top-level windows. Applications should invoke this method when they make changes to
  system environment parameters.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>timeOut [optional]</term>
      <listitem>
      <para>
        Specifies a period in milliseconds to wait when a windows does not respond. The default <emphasis
        role="italic">timeOut</emphasis> is 5,000. If the <emphasis role="italic">timeOut</emphasis> is the special
        value of 0, the message is sent in a way that does not wait for any window to acknowledge the message and
        the method returns immediately.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>style [optional]</term>
      <listitem>
      <para>
        Specifies how the WM_SETTINGCHANGE message is sent. This should be one or more of the following keywords
        separated by spaces, case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>ABORTIFHUNG       </member>
          <member>BLOCK             </member>
          <member>NORMAL            </member>
          <member>NOTIMEOUTIFNOTHUNG</member>
          <member>ERRORONEXIT       </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>ABORTIFHUNG</term>
          <listitem>
          <para>
            Returns without waiting for the time-out period to elapse if the receiving thread appears to not respond or
            to be <emphasis role="italic">hung.</emphasis> This is the default if this argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>BLOCK</term>
          <listitem>
          <para>
            Prevents the calling thread from processing any other requests until the function returns
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NORMAL</term>
          <listitem>
          <para>
             The calling thread is not prevented from processing other requests while waiting for the function to
             return.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NOTIMEOUTIFNOTHUNG</term>
          <listitem>
          <para>
             Do not enforce the time-out period as long as the receiving thread is processing messages.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ERRONONEXIT</term>
          <listitem>
          <para>
            <emphasis role="bold">Vista or later only.</emphasis> The broadcast function should return 0 if the
            receiving window is destroyed or its owning thread dies while the message is being processed.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>area [optional]</term>
      <listitem>
      <para>
        This argument indicates the area of change. The default is <emphasis role="italic">Environment</emphasis> which
        is correct to indicate the system or user environment variables have changed. The arugment can also be the name
        of a registry key or the name of a section in the Win.ini file. When the string is a registry name, it typically
        indicates only the leaf node in the registry, not the full path.
      </para>
      <para>
        It is suggested that the programmer should not change this from the default, unless the programmer understands
        the usage of this argument in the WM_SETTINGCHANGED window message.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method would typically be used to notify the operating system that one of the environment variables, such as
    the PATH variable, has been changed in the registry. This allows, for instance, updating the path without rebooting
    the system.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example updates the user PATH variable and then notifies the system so that the new path takes effect
    immediately:
<programlisting>
<![CDATA[

  reg = .WindowsRegistry~new
  envKey = reg~open(reg~current_user, 'Environment', 'WRITE QUERY')

  -- Error checking code, code that creates the new path string, the data
  -- type for the registry value, etc..

  reg~setValue(envKey, pathName, newPath, valueType)

  reg~close(envKey)


  .OS~settingChanged(2000);

::requires 'ooDialog.cls'
::requires 'winsystm.cls'

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End OS::settingChanged() -->

<section id="mthShellChangeNotify" xreflabel="shellChangeNotify"><title>shellChangeNotify</title>
<indexterm><primary>shellChangeNotify</primary></indexterm>
<indexterm><primary>OS class</primary><secondary>shellChangeNotify</secondary></indexterm>
<programlisting>
<![CDATA[
>>--shellChangeNotify(--+---------+-+--------+-+--------+-+--------+--)--------><
                        +-eventID-+ +-,-opt-+ +-,-val1-+ +-,-val2-+
]]>
</programlisting>

<para>
  Notifies the system of an event that an application has performed. An application should use this function if it
  performs an action that may affect the Shell. Currently this method can only be used to notify the system that a file
  type association has changed.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>eventID [reserved optional]</term>
      <listitem>
      <para>
        Identifies the event that has occurred. Typically, only one event is specified at a time. If more than one event
        is specified, the values contained in the <emphasis role="italic">val!</emphasis> and <emphasis
        role="italic">val2</emphasis> arguments must be the same, respectively, for all specified events.
      </para>
      <para>
        In the current implementation the programmer can not specify the id, it is set to SHCNE_ASSOCCHANGED. If this
        argument is specified, the method fails.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>opts [reserved optional]</term>
      <listitem>
      <para>
        A single flag that indicates the meaning of the values contained in the <emphasis role="italic">val1</emphasis>
        and <emphasis role="italic">val2</emphasis> arguments.
      </para>
      <para>
        In the current implementation the programmer can not specify the flag, it is set to SHCNF_IDLIST. If this
        argument is specified, the method fails.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>val1 [reserved optional]</term>
      <listitem>
      <para>
        First event-dependent value.
      </para>
      <para>
        In the current implementation the programmer can not specify the <emphasis role="italic">val1</emphasis> value,
        it is set correctly by the ooDialog framework. If this argument is specified, the method fails.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>val [reserved optional]</term>
      <listitem>
      <para>
        Second event-dependent value.
      </para>
      <para>
        In the current implementation the programmer can not specify the <emphasis role="italic">val1</emphasis> value,
        it is set correctly by the ooDialog framework. If this argument is specified, the method fails.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    In the current implementation, returns false if the programmer specifies any of the reserved arguments, otherwise it
    returns true.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This function notifies the system that a file type association has changed. This allows an application to add, or
    modify the file type values in the registry and have the changes take effect immediately without rebooting the
    system. The underlying Windows API that is used in the implementation provides more functionality than this specific
    notification. Future versions of ooDialog may add that functionality to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example writes to the registry to add a file type association and then invokes <emphasis
    role="italic">shellChangeNotify</emphasis> to have the new file association take place immediately:
<programlisting>
<![CDATA[

  reg = .WindowsRegistry~new

  -- Code that adds the file type infomation to the registry
  ...

  .OS~shellChangeNotify

::requires 'ooDialog.cls'
::requires 'winsystm.cls'

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End OS::shellChangeNotify() -->

</section> <!-- End OS Class -->


<section id="rtnPlay" xreflabel="Play"><title>Play Routine</title>
<indexterm><primary>Play</primary></indexterm>
<indexterm><primary>public routines</primary><secondary>Play</secondary></indexterm>
<para>This routine is used to play audio sounds.</para>
<programlisting>
<![CDATA[
>>-Play(--+----------+--+---------+--)-----------><
          +-fileName-+  +-,--YES--+
                        +-,--LOOP-+
]]>
</programlisting>

<para>
  The Play routine can be used to play an audio file using the Windows multimedia capabilities.  When the
  arguments are omitted, the currently playing sound file is stopped.
</para>
<para>
  The named file is searched for in the current directory and in the directories of the SOUNDPATH
  environment variable.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>fileName</term>
<listitem>
  <para>
    The file name of an audio (.WAV) file. The file is searched for in the current directory and in the
    directories listed in the SOUNDPATH environment variable. If this argument is omitted, the currently
    playing sound file is stopped.
</para>
<note><title>Note</title><para>
  The system can only play one audio file at a time using the <emphasis role="italic">play</emphasis>()
  routine. If an audio file is currently playing, calling the routine with arguments will disrupt the
  audio file already playing.
</para></note>
</listitem></varlistentry>
<varlistentry><term>option</term>
<listitem>
  <para>
    When this argument is omitted, the audio file is played synchronously. Otherwise, use one of the
    following keywords:
<variablelist>
<varlistentry><term>YES</term>
<listitem><para>The audio file is played asynchronously.
</para></listitem></varlistentry>
<varlistentry><term>LOOP</term>
<listitem>
  <para>
    The audio file is played asynchronously in a loop. The loop is stopped by calling Play again with no
    arguments.
  </para>
</listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example plays a welcoming message:
<programlisting>
<![CDATA[
rc = play("Welcome.wav")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="clsPoint" xreflabel="Point"><title>Point Class</title>
<indexterm><primary>Point class</primary></indexterm>
<para>
  The <computeroutput>Point</computeroutput> class represents a point in a 2-D coordinate system.
</para>


<section id="sctMethodsPoint"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>Point</computeroutput> class:

<table id="tblMethodsPoint" frame="all"> <title>Point Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsPoint"/></entry>
<entry>Instantiates a new <computeroutput>Point</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrXClsPoint"/></entry>
<entry>Reflects the X coordinate of the point.</entry>
</row>
<row>
<entry><xref linkend="atrYClsPoint"/></entry>
<entry>Reflects the Y coordinate of the point.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthPlus"/></entry>
<entry>Adds two <computeroutput>Point</computeroutput>objects</entry>
</row>
<row>
<entry><xref linkend="mthMinus"/></entry>
<entry>Subtracts two <computeroutput>Point</computeroutput>objects</entry>
</row>
<row>
<entry><xref linkend="mthCopyClsPoint"/></entry>
<entry>Returns a new <computeroutput>Point</computeroutput> object that represents the same coordinates as this point.</entry>
</row>
<row>
<entry><xref linkend="mthDecr"/></entry>
<entry>Decrements the x and y attributes by the amount specified</entry>
</row>
<row>
<entry><xref linkend="mthIncr"/></entry>
<entry>Increments the x and y attributes by the amount specified</entry>
</row>
<row>
<entry><xref linkend="mthInRect"/></entry>
<entry>Tests if this point is within a specified rectangular area.</entry>
</row>
<row>
<entry><xref linkend="mthStringPoint"/></entry>
<entry>Provides an informative string representation of the <computeroutput>Point</computeroutput> object.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="mthNewClsPoint" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>Point class</secondary></indexterm>
<programlisting>
<![CDATA[

>>--new(--+---+--,--+---+--)---------------------><
          +-x-+     +-y-+
]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>Point</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>x [optional]</term>
      <listitem>
      <para>
        The x coordinate of the point. The default is 0.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>y</term>
      <listitem>
      <para>
        The y coordinate of the point. The default is the value of the x coordinate.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method returns a new <computeroutput>Point</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Both the x and y coordinates of a point are whole numbers in the range of -2147483648 to 2147483647, inclusive.
    Note that the <emphasis role="italic">x</emphasis> argument is checked first, if it is omitted, its value is set
    to 0. The <emphasis role="italic">y</emphasis>, if omitted, is then set to the value of <emphasis
    role="italic">x</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example simply creates a few <computeroutput>Point</computeroutput> objects:
<programlisting id="exampleNewClsPoint">
<![CDATA[
p = .Point~new(45, 90)
say 'Point p is at ('p~x','p~y')'
say
q = .Point~new(55)
say 'A new point q is at ('q~x','q~y')'
say

q~x = 150
q~y = 300
say 'Changed point q to be at ('q~x','q~y')'
say

::requires 'ooDialog.cls'

/* Output would be:

Point p is at (45,90)

A new point q is at (55,55)

Changed point q to be at (150,300)

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="atrXClsPoint" xreflabel="x"><title>x (Attribute)</title>
<indexterm><primary>x</primary><secondary>Point class</secondary></indexterm>
<indexterm><primary>Point class</primary><secondary>x</secondary></indexterm>
<programlisting>
<![CDATA[
>>--x--------------------------------------------><

>>--x=number-------------------------------------><

]]>
</programlisting>

<para>
  Reflects the x coordinate of the <computeroutput>Point</computeroutput>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">x get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of <emphasis role="italic">x</emphasis> coordinate of the point
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">x set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">x</emphasis> coordinate of the point. The value must be a
    whole number in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Point~new <link linkend="exampleNewClsPoint">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::x() [attribute]  -->


<section id="atrYClsPoint" xreflabel="y"><title>y (Attribute)</title>
<indexterm><primary>y</primary><secondary>Point class</secondary></indexterm>
<indexterm><primary>Point class</primary><secondary>y</secondary></indexterm>
<programlisting>
<![CDATA[
>>--y--------------------------------------------><

>>--y=number-------------------------------------><

]]>
</programlisting>

<para>
  Reflects the y coordinate of the <computeroutput>Point</computeroutput>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">y get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of <emphasis role="italic">y</emphasis> coordinate of the point
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">y set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">y</emphasis> coordinate of the point. The value must be a whole number
    in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Point~new <link linkend="exampleNewClsPoint">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::y() [attribute]  -->


<section id="mthPlus" xreflabel="+"><title>+ (addition)</title>
<indexterm><primary>+</primary></indexterm>
<indexterm><primary>Point class</primary><secondary>+</secondary></indexterm>
<programlisting>
<![CDATA[
>>--"+"--point2----------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">+</emphasis> method adds the X and Y attributes of this point to another
  <computeroutput>Point</computeroutput>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>point2 [required]</term>
    <listitem>
    <para>
      The <computeroutput>Point</computeroutput> object being added.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is a <computeroutput>Point</computeroutput> object whose X and Y attributes are the sum of the X
    and Y attributes of this point and the other point.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows a generic method used to move a number of controls the same relative distance in a dialog:
<programlisting>
<![CDATA[

::method moveControls private
  use strict arg controlArray, x = 0, y = 0

  offSet = .Point~new(x, y)
  do obj over controlArray
    pos = obj~getRealPos
    newPos = pos + offSet
    obj~moveTo(newPos, "NOREDRAW")
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::+() -->


<section id="mthMinus" xreflabel="-"><title>- (subtraction)</title>
<indexterm><primary>-</primary></indexterm>
<indexterm><primary>Point class</primary><secondary>-</secondary></indexterm>
<programlisting>
<![CDATA[
>>--"-"--point2----------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic"></emphasis> method subtracts the X and Y attributes of this point from another
  <computeroutput>Point</computeroutput>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>point2 [required]</term>
    <listitem>
    <para>
      The <computeroutput>Point</computeroutput> object being subtracted.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is a <computeroutput>Point</computeroutput> object whose X and Y attributes are the result of
    subtracting the other point's X and Y attributes from the X and Y attributes of this point.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    A simple example:
<programlisting>
<![CDATA[


  p1 = .Point~new(250, 200)
  p2 = .Point~new(25, 20)
  p3 = p1 - p2
  say "Point 3, x:" p3~x "y:" p3~y

  /* Output would be:

     Point 3, x: 225 y: 180

  */
::requires "ooDialog.cls"
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::-() -->

<section id="mthCopyClsPoint" xreflabel="copy"><title>copy</title>
<indexterm><primary>copy</primary><secondary>PointClass</secondary></indexterm>
<indexterm><primary>Point class</primary><secondary>copy</secondary></indexterm>
<programlisting>
<![CDATA[
>>--copy-----------------------------------------><

]]>
</programlisting>

<para>
  Returns a new <computeroutput>Point</computeroutput> object that represents the same coordinates as this point.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a new point whose <emphasis role="italic">x</emphasis> and <emphasis role="italic">y</emphasis> attributes
    are the same as this point's attriubtes.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example makes a copy of the current mouse postion so that it can be mapped to the client coordinates of the
    dialog without altering the position in screen coordinates:
<programlisting>
<![CDATA[

  ::method initDialog
    expose mouse

    mouse = .Mouse~new(self)
    ...

::method mouseOverDialog private
  expose mouse

  pos = mouse~getCursorPos
  clientPos = pos~copy

  self~screen2client(clientPos)

  say 'Screen mouse postion:       ' pos
  say 'Dialog client mouse postion:' clientPos
  say 'Mouse over dialog?          ' clientPos~inRect(self~clientRect)

  return clientPos~inRect(self~clientRect)


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::copy() -->


<section id="mthDecr" xreflabel="decr"><title>decr</title>
<indexterm><primary>decr</primary></indexterm>
<indexterm><primary>Point class</primary><secondary>decr</secondary></indexterm>
<programlisting>
<![CDATA[
>>--decr(--+--------+--+---------+--)------------><
           +--decrX-+  +-,-decrY-+
]]>
</programlisting>

<para>
  Decrements this point's x and y attributes by the specified amount.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>decrX [optional]</term>
    <listitem>
    <para>
      The amount to decrement, (to subtract from,) this point's x attribute. The amount must be a whole number in the
      range of -2147483648 to 2147483647, inclusive.
    </para>
    <para>
      If <emphasis role="italic">decrY</emphasis> is specified and this arg is omitted then the x attribute is not
      changed. If both <emphasis role="italic">decrX</emphasis> and <emphasis role="italic">decrY</emphasis> are
      ommitted, then the x and y attributes are decremented by 1.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>decrY [optional]</term>
    <listitem>
    <para>
      The amount to decrement, (to subtract from,) this point's y attribute. The amount must be a whole number in the
      range of -2147483648 to 2147483647, inclusive.
    </para>
    <para>
      If <emphasis role="italic">decrX</emphasis> is specified and this arg is omitted then the y attribute is not
      changed. If both <emphasis role="italic">decrX</emphasis> and <emphasis role="italic">decrY</emphasis> are
      ommitted, then the x and y attributes are decremented by 1.
    </para>
    </listitem></varlistentry>
  </variablelist> </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    There is no return.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the pointer to the hourglass shape then moves the cursor one pixel up and one pixel to the
    left. Moving the cursor forces the cursor to be redrawn
<programlisting>
<![CDATA[

  oldCursorPosition = self~getCursorPos
  oldCursorShape = self~cursor_wait
  self~setCursorPos(oldCursorPosition~decr)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::decr() -->


<section id="mthIncr" xreflabel="incr"><title>incr</title>
<indexterm><primary>incr</primary></indexterm>
<indexterm><primary>Point class</primary><secondary>incr</secondary></indexterm>
<programlisting>
<![CDATA[
>>--incr(--+--------+--+---------+--)------------><
           +--incrX-+  +-,-incrY-+
]]>
</programlisting>

<para>
  Increments this point's x and y attributes by the specified amount.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>incrX [optional]</term>
    <listitem>
    <para>
      The amount to increment, (to add to,) this point's x attribute. The amount must be a whole number in the range of
      -2147483648 to 2147483647, inclusive.
    </para>
    <para>
      If <emphasis role="italic">incrY</emphasis> is specified and this arg is omitted then the x attribute is not
      changed. If both <emphasis role="italic">incrX</emphasis> and <emphasis role="italic">incrY</emphasis> are
      ommitted, then the x and y attributes are incremented by 1.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>incrY [optional]</term>
    <listitem>
    <para>
      The amount to increment, (to add to,) this point's y attribute. The amount must be a whole number in the range of
      -2147483648 to 2147483647, inclusive.
    </para>
    <para>
      If <emphasis role="italic">incrX</emphasis> is specified and this arg is omitted then the y attribute is not
      changed. If both <emphasis role="italic">incrX</emphasis> and <emphasis role="italic">incrY</emphasis> are
      ommitted, then the x and y attributes are incremented by 1.
    </para>
    </listitem></varlistentry>
  </variablelist> </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    There is no return.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the pointer to the hourglass shape then moves the cursor one pixel down and one pixel to the
    right. Moving the cursor it to be redrawn
<programlisting>
<![CDATA[

  oldCursorPosition = self~getCursorPos
  oldCursorShape = self~cursor_wait
  self~setCursorPos(oldCursorPosition~incr)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::incr() -->

<section id="mthInRect" xreflabel="inRect"><title>inRect</title>
<indexterm><primary>inRect</primary></indexterm>
<indexterm><primary>Point class</primary><secondary>inRect</secondary></indexterm>
<programlisting>
<![CDATA[
>>--inRect(--rect--)-----------------------------><

]]>
</programlisting>

<para>
  Tests if this point is within a specified rectangular area.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>rect [required]</term>
      <listitem>
      <para>
        A <xref linkend="clsRect"/> object that specifies the area to be tested.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True if the point lies within the rectangle, otherwise false. See the remarks for the definition of <emphasis
    role="italic">within</emphasis> .
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Windows defines that a point is within a rectangle if it lies on the left or top side or is within all four sides. A
    point on the right or bottom side is considered outside the rectangle.
  </para>
  <para>
    The rectangle must be normalized, that is, rect~right must be greater than rect~left and rect~bottom must be greater
    than rect~top. If the rectangle is not normalized, a point is never considered inside of the rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example tests if the current cursor position lies with the client area of the dialog:
<programlisting>
<![CDATA[

  mouse = .Mouse~new(self)
  p = mouse~getCursorPos

  self~screen2client(p)
  if p~inRect(self~clientRect) then do
    say 'The mouse cursor is over this dialog'
  end
  else do
    say 'The mouse cursor is NOT over this dialog'
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::inRect() -->

<section id="mthStringPoint" xreflabel="string"><title>string</title>
<indexterm><primary>string</primary><secondary>Point class</secondary></indexterm>
<indexterm><primary>Point class</primary><secondary>string</secondary></indexterm>
<programlisting>
<![CDATA[
>>--string---------------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">string</emphasis> method over-rides the <computeroutput>.Object</computeroutput> classes
  <emphasis role="italic">string</emphasis> method to provide more informative string representation of a
  <computeroutput>Point</computeroutput> object. The returned string include the value of the x and y attributes.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a string in the form: <emphasis role="italic">a Point (x, y)</emphasis> where <emphasis
    role="italic">x</emphasis> is the value of the x attribute of the object and <emphasis role="italic">y</emphasis> is
    the value of the y attribute.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    A trival example.
<programlisting>
<![CDATA[

  p = .Point~new(5, 120)
  say s

  /* Output would be:

  a Point (5, 120)

  */

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Point::string() -->

</section> <!-- End Point Class -->


<section id="clsRect" xreflabel="Rect"><title>Rect Class</title>
<indexterm><primary>Rect class</primary></indexterm>
<para>
  The <computeroutput>Rect</computeroutput> object is most often used to represent a rectangle on a coordinate system,
  specifically the coordinate system used by Windows where the upper left corner is considered (0,0).  However, it is
  convenient to use the Rect object for other things, for instance the margin around a rectangle.
</para>

<section id="sctMethodsRect"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>Rect</computeroutput> class:
<table id="tblMethodsRect" frame="all"> <title>Rect Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsRect"/></entry>
<entry>Instantiates a new <computeroutput>Rect</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrBottomClsRect"/></entry>
<entry>The <emphasis role="italic">bottom</emphasis> coordinate of the rectangle.</entry>
</row>
<row>
<entry><xref linkend="atrLeftClsRect"/></entry>
<entry>The <emphasis role="italic">left</emphasis> coordinate of the rectangle.</entry>
</row>
<row>
<entry><xref linkend="atrRightClsRect"/></entry>
<entry>The <emphasis role="italic">right</emphasis> coordinate of the rectangle.</entry>
</row>
<row>
<entry><xref linkend="atrTopClsRect"/></entry>
<entry>The <emphasis role="italic">top</emphasis> coordinate of the rectangle.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthCopyClsRect"/></entry>
<entry>Returns a new <computeroutput>Rect</computeroutput> object with the same coordinates as this rectangle.</entry>
</row>
<row>
<entry><xref linkend="mthStringRect"/></entry>
<entry>Provides an informative string representation of the <computeroutput>Rect</computeroutput> object.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsRect" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>Rect class</secondary></indexterm>
<programlisting>
<![CDATA[

>>--new(--+------+--+--------+--+---------+--+----------+--)----><
          +-left-+  +-,-top--+  +-,-right-+  +-,-bottom-+

]]>
</programlisting>

<para>
  Instantiates a new <computeroutput>Rect</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem><para>The arguments are:
  <variablelist>
    <varlistentry><term>left [optional]</term>
    <listitem>
    <para>
      The left coordinate of the rectangle. The default is 0.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>top [optional]</term>
    <listitem>
    <para>
      The top coordinate of the rectangle. The default is the value of <emphasis role="italic">left</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>right [optional]</term>
    <listitem>
    <para>
      The right coordinate of the rectangle. The default is the value of <emphasis role="italic">left</emphasis>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>bottom [optional]</term>
    <listitem>
    <para>
      The bottom coordinate of the rectangle. The default is the value of <emphasis role="italic">left</emphasis>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The new <computeroutput>Rect</computeroutput> object is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    All the coordinates of the rectangle are whole numbers in the range of -2147483648 to 2147483647, inclusive. Note
    that the <emphasis role="italic">left</emphasis> argument is checked first, if it is omitted, its value is set to 0.
    All other arguments, if omitted, are set to the value of <emphasis role="italic">left</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleNewClsRect"><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
<programlisting>
<![CDATA[
r = .Rect~new(3, 4, 13, 9)
say 'Upper corner ('r~left','r~top') lower corner 'r~right','r~bottom')'
say
margin = .Rect~new(5)
say 'Margins:'
say '  Left: ' margin~left
say '  Top   ' margin~top
say '  Right ' margin~right
say '  Bottom' margin~bottom
say

r~left = 55
r~top = 75
r~right = 110
r~bottom = 125
say 'New upper corner ('r~left','r~top') new lower corner 'r~right','r~bottom')'
say

/* Output would be:
Upper corner (3,4) lower corner 13,9)

Margins:
  Left:  5
  Top    5
  Right  5
  Bottom 5

New upper corner (55,75) new lower corner 110,125)

/*

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="atrBottomClsRect" xreflabel="bottom"><title>bottom (Attribute)</title>
<indexterm><primary>bottom</primary><secondary>Rect class</secondary></indexterm>
<indexterm><primary>Rect class</primary><secondary>bottom</secondary></indexterm>
<programlisting>
<![CDATA[
>>--bottom---------------------------------------><

>>--bottom=number--------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">bottom</emphasis> attribute reflects the y coordinate of the bottom right corner of the
  rectangle.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">bottom get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of the <emphasis role="italic">bottom</emphasis> coordinate of the rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">bottom set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">bottom</emphasis> coordinate of the rectangle. The value must be a
    whole number in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Rect~new <link linkend="exampleNewClsRect">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Rect::bottom() [attribute]  -->


<section id="atrLeftClsRect" xreflabel="left"><title>left (Attribute)</title>
<indexterm><primary>left</primary><secondary>Rect class</secondary></indexterm>
<indexterm><primary>Rect class</primary><secondary>left</secondary></indexterm>
<programlisting>
<![CDATA[
>>--left-----------------------------------------><

>>--left=number----------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">left</emphasis> attribute reflects the x coordinate of the upper left corner of the
  rectangle.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">left get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of <emphasis role="italic">left</emphasis> coordinate of the rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">left set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">left</emphasis> coordinate of the rectangle. The value must be a
    whole number in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Rect~new <link linkend="exampleNewClsRect">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Rect::left() [attribute]  -->


<section id="atrRightClsRect" xreflabel="right"><title>right (Attribute)</title>
<indexterm><primary>right</primary><secondary>Rect class</secondary></indexterm>
<indexterm><primary>Rect class</primary><secondary>right</secondary></indexterm>
<programlisting>
<![CDATA[
>>--right----------------------------------------><

>>--right=number---------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">right</emphasis> attribute reflects the x coordinate of the bottom right corner of the
  rectangle.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">right get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of <emphasis role="italic">right</emphasis> coordinate of the rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">right set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">right</emphasis> coordinate of the rectangle. The value must be a
    whole number in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Rect~new <link linkend="exampleNewClsRect">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Rect::right() [attribute]  -->



<section id="atrTopClsRect" xreflabel="top"><title>top (Attribute)</title>
<indexterm><primary>top</primary><secondary>Rect class</secondary></indexterm>
<indexterm><primary>Rect class</primary><secondary>top</secondary></indexterm>
<programlisting>
<![CDATA[
>>--top------------------------------------------><

>>--top=number-----------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">top</emphasis> attribute reflects the y coordinate of the upper left corner of the
  rectangle.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">top get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of <emphasis role="italic">top</emphasis> coordinate of the rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">top set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">top</emphasis> coordinate of the rectangle. The value must be a
    whole number in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Rect~new <link linkend="exampleNewClsRect">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Rect::top() [attribute]  -->

<section id="mthCopyClsRect" xreflabel="copy"><title>copy</title>
<indexterm><primary>copy</primary><secondary>RectClass</secondary></indexterm>
<indexterm><primary>Rect class</primary><secondary>copy</secondary></indexterm>
<programlisting>
<![CDATA[
>>--copy-----------------------------------------><
]]>
</programlisting>

<para>
  Returns a new <computeroutput>Rect</computeroutput> object with the same coordinates as this rectangle.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a newly instantiated <computeroutput>Rect</computeroutput> object with the same coordinates as this object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The copied rectangle initially has the same coordinates as this rectangle. Changing the coordinates in one rectangle
    after the copy does not effect the coordinates of the other rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example makes a copy of the client rectangle of an edit control:
<programlisting>
<![CDATA[

  editOffsetRect = editRect~copy
  editOffsetRect~top -= height
  editOffSetRect~bottom -= height

  say 'text rect:      ' editRect
  say 'text offset rect' editOffsetRect

  /* Output might be */

  text rect:       a Rect (0, 0, 104, 21)
  text offset rect a Rect (0, -21, 104, 0)
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Rect::copy() -->


<section id="mthStringRect" xreflabel="string"><title>string</title>
<indexterm><primary>string</primary><secondary>Rect class</secondary></indexterm>
<indexterm><primary>Rect class</primary><secondary>string</secondary></indexterm>
<programlisting>
<![CDATA[
>>--string---------------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">string</emphasis> method over-rides the <computeroutput>.Object</computeroutput> classes
  <emphasis role="italic">string</emphasis> method to provide more informative string representation of a
  <computeroutput>Rect</computeroutput> object. The returned string include the value of the coordinates of the
  rectangle. I.e., the left, top, right, and bottom attributes.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a string in the form: <emphasis role="italic">a Rect (l, t, r, b)</emphasis> where <emphasis
    role="italic">l</emphasis> is the value of the left attribute, <emphasis role="italic">t</emphasis> is the value of
    the top attribute, <emphasis role="italic">r</emphasis> is the value of the right attribute, and <emphasis
    role="italic">b</emphasis> is the value of the bottom attribute of the object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    A trival example.
<programlisting>
<![CDATA[

  r = .Rect~new(5, 5, 120, 40)
  say r

  /* Output would be:

  a Rect (5, 5, 120, 40)

  */

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Size::string() -->

</section> <!-- End Rect Class -->


<section id="rtnScreenSize" xreflabel="ScreenSize"><title>ScreenSize Routine</title>
<indexterm><primary>ScreenSize</primary></indexterm>
<indexterm><primary>public routines</primary>
<secondary>ScreenSize</secondary></indexterm>
<para>Obtains the screen size in dialog units and in pixels.</para>
<programlisting>
<![CDATA[
>>-ScreenSize()----------------------------------><
]]>
</programlisting>

<para></para>
<variablelist>
<varlistentry><term><emphasis role="bold">Argument:</emphasis></term>
<listitem><para>This function takes no arguments.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>An array containing the screen size.  The size in dialog units
of the width is at index 1 and the height in dialog units is at index 2. The
size in pixels of the width is at index 3 and the height in pixels is at index
4.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Remarks</emphasis></term>
<listitem>
<para>
  There are a few problems with this routine. The main problem is with the values returned for the
  <xref linkend="defDialogUnit"/>x. Since dialog units are dependent on the font in use for a specific dialog, and there is
  no dialog involved here, the routine calculates the dialog units using 8 point System font. It is highly unlikely that this
  is correct for any specific dialog.
</para>
<para>
  The <xref linkend="mthScreenSize"/> method of the <xref linkend="clsDlgUtil"/> class is
  a better way to get the screen size. It can provide accurate dialog units and may be more convenient to use since the
  programmer seldom needs to get the size in both pixels and dialog units.
</para>
</listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example</emphasis></term>
<listitem><para>Get the screen size and display it to the user.
<programlisting>
<![CDATA[
size = screenSize()
say
say 'The monitor is' size[1] 'dialog units wide and' size[2] 'dialog units high.'
say 'The monitor is' size[3] 'pixels wide and' size[4] 'pixels high.'
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="clsSize" xreflabel="Size"><title>Size Class</title>
<indexterm><primary>Size class</primary></indexterm>
<para>
  A <computeroutput>Size</computeroutput> object encapsulates a width and height dimension in a 2-D coordinate system.
</para>


<section id="sctMethodsSize"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>Size</computeroutput> class:

<table id="tblMethodsSize" frame="all"> <title>Size Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsSize"/></entry>
<entry>Instantiates a new <computeroutput>Size</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes </emphasis></entry>
</row>
<row>
<entry><xref linkend="atrHeightClsSize"/></entry>
<entry>Reflects the height of the <computeroutput>Size</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="atrWidthClsSize"/></entry>
<entry>Reflects the width of the <computeroutput>Size</computeroutput> object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry>comparison <xref linkend="mthComparsion"/></entry>
<entry>Operators that compare one <computeroutput>Size</computeroutput> object to another.</entry>
</row>
<row>
<entry><xref linkend="mthEquateTo"/></entry>
<entry>Sets the width and height of the <computeroutput>Size</computeroutput> object to that of another <computeroutput>Size</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="mthStringSize"/></entry>
<entry>Provides an informative string representation of the <computeroutput>Size</computeroutput> object.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsSize" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary><secondary>Size class</secondary></indexterm>
<programlisting>
<![CDATA[

>>-.Size~new(--+-------+--,--+---------+--)------><
               +-width-+     +-height--+
]]>
</programlisting>
<para>
  Instantiates a new <computeroutput>Size</computeroutput> object with the dimensions specified.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>width</term>
      <listitem>
      <para>
        The width for the new object.  The default is 0.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>height</term>
      <listitem>
      <para>
        The height for the new object.  The default is the <emphasis role="italic">width</emphasis> value.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method returns the new <computeroutput>Size</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Both the <emphasis role="italic">width</emphasis> and the <emphasis role="italic">height</emphasis>  of a
    <computeroutput>Size</computeroutput> object are whole numbers in the range of -2147483648 to 2147483647, inclusive.
    Note that the <emphasis role="italic">width</emphasis> argument is checked first, if it is omitted, its value is set
    to 0. The <emphasis role="italic">height</emphasis>, if omitted, is then set to the value of <emphasis
    role="italic">width</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleNewClsSize"><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
<programlisting>
<![CDATA[

size = .Size~new(4, 8)
say 'Width:' size~width 'Height:' size~height
say
size2 = .Size~new(16)
say 'A new size object:'
say '  Width: ' size2~width
say '  Height:' size2~height
say

size2~width = 100
size2~height = 300
say 'New width:' size2~width 'new height:' size2~height
say

::requires 'ooDialog.cls'

/* Output would be:

Width: 4 Height: 8

A new size object:
  Width:  16
  Height: 16

New width: 100 new height: 300

*/
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="atrHeightClsSize" xreflabel="height"><title>height (Attribute)</title>
<indexterm><primary>height</primary><secondary>Size class</secondary></indexterm>
<indexterm><primary>Size class</primary><secondary>height</secondary></indexterm>
<programlisting>
<![CDATA[
>>--height---------------------------------------><

>>--height=number--------------------------------><

]]>
</programlisting>

<para>
  Reflects the height of the <computeroutput>Size</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">height get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of <emphasis role="italic">height</emphasis> of the <computeroutput>Size</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">height set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">height</emphasis> of the <computeroutput>Size</computeroutput> object.
    The value must be a whole number in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Size~new <link linkend="exampleNewClsSize">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Size::height() [attribute]  -->


<section id="atrWidthClsSize" xreflabel="width"><title>width (Attribute)</title>
<indexterm><primary>width</primary><secondary>Size class</secondary></indexterm>
<indexterm><primary>Size class</primary><secondary>width</secondary></indexterm>
<programlisting>
<![CDATA[
>>--width----------------------------------------><

>>--width=number---------------------------------><

]]>
</programlisting>

<para>
  Reflects the width of the <computeroutput>Size</computeroutput> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">width get:</emphasis></term>
  <listitem>
  <para>
    Returns the value of <emphasis role="italic">width</emphasis> of the <computeroutput>Size</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">width set:</emphasis></term>
  <listitem>
  <para>
    Sets the value of the <emphasis role="italic">width</emphasis> of the <computeroutput>Size</computeroutput> object.
    The value must be a whole number in the range of -2147483648 to 2147483647, inclusive.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    See the .Size~new <link linkend="exampleNewClsSize">example</link>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Size::width() [attribute]  -->


<section id="mthComparsion" xreflabel="Comparison"><title>Comparison Operators</title>
<indexterm><primary>Size class</primary><secondary>comparison operators</secondary></indexterm>
<programlisting>
<![CDATA[
>>--sizeObj1 =   sizeObj2------------------------><
>>--sizeObj1 ==  sizeObj2------------------------><
>>--sizeObj1 \=  sizeObj2------------------------><
>>--sizeObj1 \== sizeObj2------------------------><
>>--sizeObj1 <   sizeObj2------------------------><
>>--sizeObj1 <<  sizeObj2------------------------><
>>--sizeObj1 <=  sizeObj2------------------------><
>>--sizeObj1 <<= sizeObj2------------------------><
>>--sizeObj1 >   sizeObj2------------------------><
>>--sizeObj1 >>  sizeObj2------------------------><
>>--sizeObj1 >=  sizeObj2------------------------><
>>--sizeObj1 >>= sizeObj2------------------------><

]]>
</programlisting>

<para>
  The comparsion operators allow one <computeroutput>Size</computeroutput> object to be compared to another
  <computeroutput>Size</computeroutput> object.
</para>
<para>
  Not every possible comparsion operation is implemented, only the operators listed are supported. All the comparisons
  follow these two principles. When a comparison operator is doubled, it is a strict comparison. The
 <xref linkend="atrWidthClsSize"/> attribute of each <computeroutput>Size</computeroutput> object is
  compared and the <xref linkend="atrHeightClsSize"/> attribute of each <computeroutput>Size</computeroutput>
  object is compared. Both comparisons must be true.
</para>
<para>
  When there is not a doubled operator, then the <emphasis role="italic">area</emphasis> of the size objects is
  compared. For example:

<programlisting>
<![CDATA[

  s1 = .Size~new(4, 4)
  s2 = .Size~new(2, 8)
  s3 = .Size~new(8, 2)
  s4 = .Size~new(2, 8)

  s1 = s2    -- True
  s1 == s2   -- False
  s2 == s4   -- True
  s2 == s3   -- False

  s5 = .Size~new(3, 4)
  s6 = .Size~new(4, 4)

  s5 < s6    -- True
  s5 << s6   -- False
  s5 <= s6   -- True
  s5 <<= s6  -- True

]]>
</programlisting>

</para>
<para>
  The following table lists the comparsion operators. Given two <computeroutput>Size</computeroutput> objects, <emphasis
  role="italic">s1</emphasis> and <emphasis role="italic">s2</emphasis>:

<table id="tblComparisonsSize" frame="all"> <title>Size Comparison Operator Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Operator</entry>
<entry>True When</entry>
</row>
</thead>
<tbody>
<row>
<entry>=</entry>
<entry>(s1~width * s1~height) is equal to (s2~width * s2~height)</entry>
</row>
<row>
<entry>==</entry>
<entry>s1~width is equal to s2~width and s1~height is equal to s2~height.</entry>
</row>
<row>
<entry>\=</entry>
<entry>(s1~width * s1~height) is not equal to (s2~width * s2~height)</entry>
</row>
<row>
<entry>\==</entry>
<entry>s1~width is not equal to s2~width and s1~height is not equal to s2~height.</entry>
</row>
<row>
<entry>&lt;</entry>
<entry>(s1~width * s1~height) is less than (s2~width * s2~height)</entry>
</row>
<row>
<entry>&lt;&lt;</entry>
<entry>s1~width is less than s2~width and s1~height is less than s2~height.</entry>
</row>
<row>
<entry>&lt;=</entry>
<entry>(s1~width * s1~height) is less than or equal to (s2~width * s2~height)</entry>
</row>
<row>
<entry>&lt;&lt;=</entry>
<entry>s1~width is less than or equal to s2~width and s1~height is less than or equal to s2~height.</entry>
</row>
<row>
<entry>&gt;</entry>
<entry>(s1~width * s1~height) is greater than (s2~width * s2~height)</entry>
</row>
<row>
<entry>&gt;&gt;</entry>
<entry>s1~width is greater than s2~width and s1~height is greater than s2~height.</entry>
</row>
<row>
<entry>&gt;=</entry>
<entry>(s1~width * s1~height) is greater than or equal to (s2~width * s2~height)</entry>
</row>
<row>
<entry>&gt;&gt;=</entry>
<entry>s1~width is greater than or equal to s2~width and s1~height is greater than or equal to s2~height.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>  <!-- End Size::comparisonOperators -->

<section id="mthEquateTo" xreflabel="equateTo"><title>equateTo</title>
<indexterm><primary>equateTo</primary></indexterm>
<indexterm><primary>Size class</primary><secondary>equateTo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--equateTo(--otherSize--)----------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">equateTo</emphasis> method sets the width and height attributes of this
  <computeroutput>Size</computeroutput> object to the width and height attributes of <emphasis
  role="italic">otherSize</emphasis>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>otherSize</term>
      <listitem>
      <para>
        The <computeroutput>Size</computeroutput> object that is used to set the
 <xref linkend="atrWidthClsSize"/> and <xref linkend="atrHeightClsSize"/> attributes of this
        object.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns <computeroutput>.true</computeroutput>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This is a simple method as the example shows:
<programlisting>
<![CDATA[

  s1 = .Size~new(14, 57)
  s2 = .Size~new(2, 3)

  say 's1:' s1
  say 's2:' s2
  say

  s1~equateTo(s2)

  say 's1:' s1
  say 's2:' s2
  say

  /* Output will be:

s1: a Size (14, 57)
s2: a Size (2, 3)

s1: a Size (2, 3)
s2: a Size (2, 3)

 */

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Size::equateTo() -->


<section id="mthStringSize" xreflabel="string"><title>string</title>
<indexterm><primary>string</primary><secondary>Size class</secondary></indexterm>
<indexterm><primary>Size class</primary><secondary>string</secondary></indexterm>
<programlisting>
<![CDATA[
>>--string---------------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">string</emphasis> method over-rides the <computeroutput>.Object</computeroutput> classes
  <emphasis role="italic">string</emphasis> method to provide more informative string representation of a
  <computeroutput>Size</computeroutput> object. The returned string include the value of the width and height
  attributes.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a string in the form: <emphasis role="italic">a Size (w, h)</emphasis> where <emphasis
    role="italic">w</emphasis> is the value of the width attribute of the object and <emphasis
    role="italic">h</emphasis> is the value of the height attribute.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    A trival example.
<programlisting>
<![CDATA[

  s = .Size~new(4, 17)
  say s

  /* Output would be:

  a Size (4, 17)

  */

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End Size::string() -->

</section> <!-- End Size Class -->


<section id="clsSM" xreflabel="SM"><title>SM Class</title>
<indexterm><primary>SM</primary></indexterm>
<para>
  The <computeroutput>SM</computeroutput> class (System Metrics) reflects the system metrics or configuration settings
  of the computer the Rexx program is running on. The class consists entirely of class attributes. For each attribute,
  the value of the attribute is the value of a system metric or configuration setting.
</para>
<para>
  System metric values and configuration settings can not be changed. The Rexx programmer can not assign a value to any
  attribute of the <computeroutput>SM</computeroutput> class.  A syntax condition is raised if the programmer attemps to
  change the value of an attribute.
</para>
<para>
  In the <computeroutput>SM</computeroutput> class, all attributes that reflect dimensions are in pixels.  All
  attributes whose attribute name starts with <emphasis role="italic">cx</emphasis> reflect widths. Likewise, attribute
  names that start with <emphasis role="italic">cy</emphasis> reflect heights. System metrics can vary from display to
  display.
</para>

<section id="sctMethodsSM"><title>Method Table</title>
<para>
  The following table lists the class attributes of the <computeroutput>SM</computeroutput> class:

<table id="tblMethodsSM" frame="all"> <title>SM Class Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrCMouseButtons"/></entry>
<entry>The number of buttons on a mouse.</entry>
</row>
<row>
<entry><xref linkend="atrCxCursor"/></entry>
<entry>The width of a cursor in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCxDrag"/></entry>
<entry>The width of the drag rectangle in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCxFixedFrame"/></entry>
<entry>The thickness of the border around a non-resizable window that has a caption, in pixels. The width of the vertical border.</entry>
</row>
<row>
<entry><xref linkend="atrCxIcon"/></entry>
<entry>The default width of an icon, in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCxScreen"/></entry>
<entry>The width of the primary monitor in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCxSize"/></entry>
<entry>Reflects the width of a button in a window caption or title bar, in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCxSmIcon"/></entry>
<entry>Reflects the recommended width of a small icon, in pixels. Small icons typically appear in window captions and in small icon view.</entry>
</row>
<row>
<entry><xref linkend="atrCxVscroll"/></entry>
<entry>The width of a vertical scroll bar in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCyCaption"/></entry>
<entry>The height of a caption area in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCyCursor"/></entry>
<entry>The height of a cursor in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCyDrag"/></entry>
<entry>The height of drag rectangle in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCyFixedFrame"/></entry>
<entry>The thickness of the border around a non-resizable window that has a caption, in pixels. The height of the horizontal border.</entry>
</row>
<row>
<entry><xref linkend="atrCyHscroll"/></entry>
<entry>The height of a horizontal scroll bar in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCyIcon"/></entry>
<entry>The default height of an icon, in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCyMenu"/></entry>
<entry>The height of a single-line menu bar, in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCyScreen"/></entry>
<entry>The height of the primary monitor in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCySize"/></entry>
<entry>The height of a button in a window caption or title bar, in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrCySmIcon"/></entry>
<entry>The recommended height of a small icon, in pixels.</entry>
</row>
<row>
<entry><xref linkend="atrMenuDropAlignment"/></entry>
<entry>Reflects whether drop-down menus are right aligned or not.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="atrCMouseButtons" xreflabel="cMouseButtons"><title>cMouseButtons (Attribute)</title>
<indexterm><primary>cMouseButtons</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cMouseButtons</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cMouseButtons--------------------------------><
]]>
</programlisting>

<para>
  Reflects the number of buttons on a mouse.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cMouseButtons get:</emphasis></term>
  <listitem>
  <para>
    The number of buttons on a mouse, or zero if no mouse is installed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cMouseButtons set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cMouseButtons</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cMouseButtons() [attribute]  -->


<section id="atrCxCursor" xreflabel="cxCursor"><title>cxCursor (Attribute)</title>
<indexterm><primary>cxCursor</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxCursor-------------------------------------><
]]>
</programlisting>

<para>
  Reflects the width of a cursor, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxCursor get:</emphasis></term>
  <listitem>
  <para>
    The width of a cursor, in pixels. The system cannot create cursors of other sizes.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxCursor set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxCursor</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxCursor() [attribute]  -->


<section id="atrCxDrag" xreflabel="cxDrag"><title>cxDrag (Attribute)</title>
<indexterm><primary>cxDrag</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxDrag</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxDrag---------------------------------------><
]]>
</programlisting>

<para>
  Reflects the width of the drag rectangle in pixels. The drag rectangle is a rectangle that is centered on a drag point
  to allow for limited movement of the mouse pointer before a drag operation begins. It allows the user to click and
  release the mouse button easily without unintentionally starting a drag operation.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxDrag get:</emphasis></term>
  <listitem>
  <para>
    The width of the drag rectangle, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxDrag set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxDrag</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute. However, the size of the drag rectangle can be changed using the <xref linkend="clsSPI"/>
    class through its <xref linkend="atrDragWidth"/> and <xref linkend="atrDragHeight"/>
    attributes.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxDrag() [attribute]  -->


<section id="atrCxFixedFrame" xreflabel="cxFixedFrame"><title>cxFixedFrame (Attribute)</title>
<indexterm><primary>cxFixedFrame</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxFixedFrame</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxFixedFrame---------------------------------><
]]>
</programlisting>

<para>
  Reflects the thickness of a frame around the perimeter of a window that has a caption but is not sizable, in pixels.
  <emphasis role="italic">cxFixedFrame</emphasis> is the width of the vertical border and
 <xref linkend="atrCyFixedFrame"/> is the height of the horizontal border.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxFixedFrame get:</emphasis></term>
  <listitem>
  <para>
    The width of the border (frame) of a non-sizable window that has a caption. This is a normal dialog's border.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxFixedFrame set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxFixedFrame</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxFixedFrame() [attribute]  -->


<section id="atrCxIcon" xreflabel="cxIcon"><title>cxIcon (Attribute)</title>
<indexterm><primary>cxIcon</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxIcon</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxIcon---------------------------------------><
]]>
</programlisting>

<para>
  Reflects the default width of an icon, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxIcon get:</emphasis></term>
  <listitem>
  <para>
    The default width of an icon, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxIcon set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxIcon</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxIcon() [attribute]  -->


<section id="atrCxScreen" xreflabel="cxScreen"><title>cxScreen (Attribute)</title>
<indexterm><primary>cxScreen</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxScreen</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxScreen-------------------------------------><
]]>
</programlisting>

<para>
  Reflects the width of the screen of the primary display monitor, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxScreen get:</emphasis></term>
  <listitem>
  <para>
    The width of the screen in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxScreen set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxScreen</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxScreen() [attribute]  -->


<section id="atrCxSize" xreflabel="cxSize"><title>cxSize (Attribute)</title>
<indexterm><primary>cxSize</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxSize</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxSize---------------------------------------><

]]>
</programlisting>

<para>
  Reflects the width of a button in a window caption or title bar, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxSize get:</emphasis></term>
  <listitem>
  <para>
    The width of a button in the title bar, such as the close button, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxSize set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxSize</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxSize() [attribute]  -->


<section id="atrCxSmIcon" xreflabel="cxSmIcon"><title>cxSmIcon (Attribute)</title>
<indexterm><primary>cxSmIcon</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxSmIcon</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxSmIcon-------------------------------------><
]]>
</programlisting>

<para>
  Reflects the recommended width of a small icon, in pixels. Small icons typically appear in window captions and in small
  icon view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxSmIcon get:</emphasis></term>
  <listitem>
  <para>
    The recommended width of a small icon, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxSmIcon set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxSmIcon</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxSmIcon() [attribute]  -->


<section id="atrCxVscroll" xreflabel="cxVscroll"><title>cxVscroll (Attribute)</title>
<indexterm><primary>cxVscroll</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cxVscroll</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cxVscroll------------------------------------><
]]>
</programlisting>

<para>
  Reflects the width of a vertical scroll bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cxVscroll get:</emphasis></term>
  <listitem>
  <para>
    The width of a vertical scroll bar, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxVscroll set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxVscroll</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxVscroll() [attribute]  -->


<section id="atrCyCaption" xreflabel="cyCaption"><title>cyCaption (Attribute)</title>
<indexterm><primary>cyCaption</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyCaption</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyCaption------------------------------------><
]]>
</programlisting>

<para>
  The height of a caption area.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyCaption get:</emphasis></term>
  <listitem>
  <para>
    The height of a caption area, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cyCaption set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cyCaption</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cyCaption() [attribute]  -->


<section id="atrCyCursor" xreflabel="cyCursor"><title>cyCursor (Attribute)</title>
<indexterm><primary>cyCursor</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyCursor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyCursor-------------------------------------><
]]>
</programlisting>

<para>
  Reflects the height of a cursor, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyCursor get:</emphasis></term>
  <listitem>
  <para>
    The height of a cursor, in pixels. The system cannot create cursors of other sizes.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cyCursor set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cyCursor</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cyCursor() [attribute]  -->


<section id="atrCyDrag" xreflabel="cyDrag"><title>cyDrag (Attribute)</title>
<indexterm><primary>cyDrag</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyDrag</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyDrag---------------------------------------><
]]>
</programlisting>

<para>
  Reflects the height of the drag rectangle in pixels. The drag rectangle is a rectangle that is centered on a drag
  point to allow for limited movement of the mouse pointer before a drag operation begins. It allows the user to click
  and release the mouse button easily without unintentionally starting a drag operation.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyDrag get:</emphasis></term>
  <listitem>
  <para>
    The height of the drag rectangle, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxDrag set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cyDrag</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute. However, the size of the drag rectangle can be changed using the <xref linkend="clsSPI"/>
    class through its <xref linkend="atrDragWidth"/> and <xref linkend="atrDragHeight"/>
    attributes.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cyDrag() [attribute]  -->


<section id="atrCyFixedFrame" xreflabel="cyFixedFrame"><title>cyFixedFrame (Attribute)</title>
<indexterm><primary>cyFixedFrame</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyFixedFrame</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyFixedFrame---------------------------------><
]]>
</programlisting>

<para>
  Reflects the thickness of a frame around the perimeter of a window that has a caption but is not sizable, in pixels.
  <emphasis role="italic">cyFixedFrame</emphasis> is the height of the horizontal border and
 <xref linkend="atrCxFixedFrame"/> is the width of the vertical border.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyFixedFrame get:</emphasis></term>
  <listitem>
  <para>
    The height of the border (frame) of a non-sizable window that has a caption. This is a normal dialog's border.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxCursor set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cxFixedFrame</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cxFixedFrame() [attribute]  -->


<section id="atrCyHscroll" xreflabel="cyHscroll"><title>cyHscroll (Attribute)</title>
<indexterm><primary>cyHscroll</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyHscroll</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyHscroll------------------------------------><
]]>
</programlisting>

<para>
  Reflects the height of a horizontal scroll bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyHscroll get:</emphasis></term>
  <listitem>
  <para>
    The height of a horizontal scroll bar, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cyHscroll set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cyHscroll</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cyHscroll() [attribute]  -->


<section id="atrCyIcon" xreflabel="cyIcon"><title>cyIcon (Attribute)</title>
<indexterm><primary>cyIcon</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyIcon</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyIcon---------------------------------------><
]]>
</programlisting>

<para>
  Reflects the default height of an icon, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyIcon get:</emphasis></term>
  <listitem>
  <para>
    The default height of an icon, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cyIcon set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cyIcon</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cyIcon() [attribute]  -->


<section id="atrCyMenu" xreflabel="cyMenu"><title>cyMenu (Attribute)</title>
<indexterm><primary>cyMenu</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyMenu</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyMenu---------------------------------------><
]]>
</programlisting>

<para>
  Reflects the height of a single-line menu bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyMenu get:</emphasis></term>
  <listitem>
  <para>
    The height of a single-line menu bar, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cyMenu set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cyMenu</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cyMenu() [attribute]  -->


<section id="atrCyScreen" xreflabel="cyScreen"><title>cyScreen (Attribute)</title>
<indexterm><primary>cyScreen</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cyScreen</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cyScreen-------------------------------------><
]]>
</programlisting>

<para>
  Reflects the hight of the screen of the primary display monitor, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cyScreen get:</emphasis></term>
  <listitem>
  <para>
    The height of the screen in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cxScreen set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cyScreen</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cyScreen() [attribute]  -->


<section id="atrCySize" xreflabel="cySize"><title>cySize (Attribute)</title>
<indexterm><primary>cySize</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cySize</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cySize---------------------------------------><

]]>
</programlisting>

<para>
  Reflects the height of a button in a window caption or title bar, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cySize get:</emphasis></term>
  <listitem>
  <para>
    The height of a button in the title bar, such as the close button, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cySize set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cySize</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cySize() [attribute]  -->


<section id="atrCySmIcon" xreflabel="cySmIcon"><title>cySmIcon (Attribute)</title>
<indexterm><primary>cySmIcon</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>cySmIcon</secondary></indexterm>
<programlisting>
<![CDATA[
>>--cySmIcon-------------------------------------><
]]>
</programlisting>

<para>
  Reflects the recommended height of a small icon, in pixels. Small icons typically appear in window captions and in small
  icon view.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">cySmIcon get:</emphasis></term>
  <listitem>
  <para>
    The recommended height of a small icon, in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">cySmIcon set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">cySmIcon</emphasis> attribute can not be changed. You can not assign a new value to
    this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::cySmIcon() [attribute]  -->


<section id="atrMenuDropAlignment" xreflabel="menuDropAlignment"><title>menuDropAlignment (Attribute)</title>
<indexterm><primary>menuDropAlignment</primary></indexterm>
<indexterm><primary>SM class</primary><secondary>menuDropAlignment</secondary></indexterm>
<programlisting>
<![CDATA[
>>--menuDropAlignment-------------------------------------------><
]]>
</programlisting>

<para>
  Reflects whether drop-down menus are right aligned or not.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">menuDropAlignment get:</emphasis></term>
  <listitem>
  <para>
    The value of the attribute is nonzero if drop-down menus are right-aligned with the corresponding menu-bar item, and
    0 if the menus are left-aligned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">menuDropAlignment set:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">menuDropAlignment</emphasis> attribute can not be changed. You can not assign a new
    value to this attribute.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SM::menuDropAlignment() [attribute]  -->

</section> <!-- End SM Class -->


<section id="clsSPI" xreflabel="SPI"><title>SPI Class</title>
<indexterm><primary>SPI class</primary></indexterm>
<para>
  The <computeroutput>SPI</computeroutput> class (System Parameters Information) reflects the system-wide parameters
  of the computer the Rexx program is running on. The class mostly consists of class attributes. For each attribute,
  the value of the attribute is the value of a system parameter. Changing the value of the attribute changes the value
  of the system parameter.
</para>
<para>
  When a system-wide parameter is set, the operating system will optionally update the user profile and additionally
  broadcast the WM_SETTINGCHANGE message to all top-level windows to notify them of the change. The programmer can
  specify to do neither, update the profile only, or update the profile and broadcast the message. Specifying the action
  to take is done through the <xref linkend="atrUpdateFlag"/> attribute.
</para>

<section id="sctMethodsSPI"><title>Method Table</title>
<para>
  The following table lists the class attributes of the <computeroutput>SPI</computeroutput> class:

<table id="tblMethodsSPI" frame="all"> <title>SPI Class Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Constants</emphasis></entry>
<entry align="center"><emphasis role="bold">Constants</emphasis></entry>
</row>
<row>
<entry><xref linkend="cnstWHEEL-PAGESCROLL"/></entry>
<entry>Indicates a turn of the mouse wheel should scroll 1 page rather than some number of lines.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
</row>
<row>
<entry><xref linkend="atrDragHeight"/></entry>
<entry>Reflects the height of the drag rectangle.</entry>
</row>
<row>
<entry><xref linkend="atrDragWidth"/></entry>
<entry>Reflects the width of the drag rectangle.</entry>
</row>
<row>
<entry><xref linkend="atrMenuAnimation"/></entry>
<entry>Reflects whether menu animation is enabled or disabled.</entry>
</row>
<row>
<entry><xref linkend="atrMenuFade"/></entry>
<entry>Reflects whether menu animation uses fade or slide animation.</entry>
</row>
<row>
<entry><xref linkend="atrMouseHoverHeight"/></entry>
<entry>Reflects the height in pixels of the rectangle the mouse needs to stay in to generate a hover notification.</entry>
</row>
<row>
<entry><xref linkend="atrMouseHoverTime"/></entry>
<entry>Reflects the time in milliseconds the mouse has to remain in the hover rectangle to generate a hover notification.</entry>
</row>
<row>
<entry><xref linkend="atrMouseHoverWidth"/></entry>
<entry>Reflects the width in pixels of the rectangle the mouse needs to stay in to generate a hover notification.</entry>
</row>
<row>
<entry><xref linkend="atrUpdateFlag"/></entry>
<entry>Defines additional actions to take when a system-wide parameter is set.</entry>
</row>
<row>
<entry><xref linkend="atrWheelScrollLines"/></entry>
<entry>Reflects the number of lines to scroll when the vertical mouse wheel is moved.</entry>
</row>
<row>
<entry><xref linkend="atrWorkArea"/></entry>
<entry>Reflects the size of the work area of the screen.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="cnstWHEEL-PAGESCROLL" xreflabel="WHEEL_PAGESCROLL"><title>WHEEL_PAGESCROLL (Constant)</title>
<indexterm><primary>WHEEL_PAGESCROLL</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>WHEEL_PAGESCROLL</secondary></indexterm>
<programlisting>
<![CDATA[
>>--val=.SPI~WHEEL_PAGESCROLL--------------------><

]]>
</programlisting>

<para>
  <emphasis role="italic">WHEEL_PAGESCROLL</emphasis> is a value defined by the Windows <xref linkend="defPlatformSDK"/>
  that indicates a turn of one notch in the mouse wheel should scroll one page rather than some number of lines. See the
  <xref linkend="atrWheelScrollLines"/> attribute more more information on the mouse wheel.
</para>
</section>  <!-- End SPI::WHEEL_PAGESCROLL [constant]  -->

<section id="atrDragHeight" xreflabel="dragHeight"><title>dragHeight (Attribute)</title>
<indexterm><primary>dragHeight</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>dragHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--dragHeight-----------------------------------><

>>--dragHeight=height----------------------------><

]]>
</programlisting>

<para>
  Reflects the height of the drag rectangle. The drag rectangle is the rectangle used to detect the start of a drag
  operation.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">dragHeight get:</emphasis></term>
  <listitem>
  <para>
    Retrieves the height of the system wide drag rectangle in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">dragHeight set:</emphasis></term>
  <listitem>
  <para>
    Use a non-negative whole number to set the height, in pixels, of the drag rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The drag rectangle is a rectangle that is centered on a drag point to allow for limited movement of the mouse
    pointer before a drag operation begins. It allows the user to click and release the mouse button easily without
    unintentionally starting a drag operation.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::dragHeight() [attribute]  -->

<section id="atrDragWidth" xreflabel="dragWidth"><title>dragWidth (Attribute)</title>
<indexterm><primary>dragWidth</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>dragWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--dragWidth------------------------------------><

>>--dragWidth=width------------------------------><

]]>
</programlisting>

<para>
  Reflects the width of the drag rectangle. The drag rectangle is the rectangle used to detect the start of a drag
  operation.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">dragWidth get:</emphasis></term>
  <listitem>
  <para>
    Retrieves the width of the system wide drag rectangle in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">dragWidth set:</emphasis></term>
  <listitem>
  <para>
    Use a non-negative whole number to set the width, in pixels, of the drag rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The drag rectangle is a rectangle that is centered on a drag point to allow for limited movement of the mouse
    pointer before a drag operation begins. It allows the user to click and release the mouse button easily without
    unintentionally starting a drag operation.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::dragWidth() [attribute]  -->

<section id="atrMenuAnimation" xreflabel="menuAnimation"><title>menuAnimation (Attribute)</title>
<indexterm><primary>menuAnimation</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>menuAnimation</secondary></indexterm>
<programlisting>
<![CDATA[
>>--menuAnimation--------------------------------><

>>--menuAnimation = onOff------------------------><

]]>
</programlisting>

<para>
  Reflects whether menu animation is on or off.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">menuAnimation get:</emphasis></term>
  <listitem>
  <para>
    The value of the attribute is <computeroutput>.true</computeroutput> if menu animation is on and
  <computeroutput>.false</computeroutput> when menu animation is off.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">menuAnimation set:</emphasis></term>
  <listitem>
  <para>
    Enables or disables menu animation. Set the attribute to <computeroutput>.true</computeroutput> to enable menu
    animation and to <computeroutput>.false</computeroutput> to disable menu animation.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Menu animation must be on for <emphasis role="italic">any</emphasis> menu animations to occur. The
 <xref linkend="atrMenuFade"/> attribute reflects whether menus use slide or fade animation.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::menuAnimation() [attribute]  -->

<section id="atrMenuFade" xreflabel="menuFade"><title>menuFade (Attribute)</title>
<indexterm><primary>menuFade</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>menuFade</secondary></indexterm>
<programlisting>
<![CDATA[
>>--menuFade-------------------------------------><

>>--menuFade = onOff-----------------------------><

]]>
</programlisting>

<para>
  Reflects whether menu animation uses fade or slide animation.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">menuFade get:</emphasis></term>
  <listitem>
  <para>
    The value of the attribute is <computeroutput>.true</computeroutput> if menu fade animation is used and
  <computeroutput>.false</computeroutput> when menu fade animation is not used.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">menuFade set:</emphasis></term>
  <listitem>
  <para>
    Enables or disables menu fade animation. Set the attribute to <computeroutput>.true</computeroutput> to enable menu
    fade animation and to <computeroutput>.false</computeroutput> to disable menu fade animation.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When menu fade is off, menus use slide animation. For any animation to be used,
 <xref linkend="atrMenuAnimation"/> must be on. Menu fade effect is only possible if the system
    has a color depth of more than 256 colors.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::menuFade() [attribute]  -->

<section id="atrMouseHoverHeight" xreflabel="mouseHoverHeight"><title>mouseHoverHeight (Attribute)</title>
<indexterm><primary>mouseHoverHeight</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>mouseHoverHeight</secondary></indexterm>
<programlisting>
<![CDATA[
>>--mouseHoverHeight-----------------------------><

>>--mouseHoverHeight=height----------------------><

]]>
</programlisting>

<para>
  Reflects the height of the hover rectangle. The hover rectangle is the rectangle within which the mouse pointer has
  to stay to generate a MOUSEHOVER notification.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">mouseHoverHeight get:</emphasis></term>
  <listitem>
  <para>
    Retrieves the height of the system wide hover rectangle in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">mouseHoverHeight set:</emphasis></term>
  <listitem>
  <para>
    Sets the width, in pixels, of the hover rectangle. The <emphasis role="italic">width</emphasis> must be a
    non-negative whole number.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The hover rectangle is the rectangle within which the mouse pointer has to stay for the operating system to generate
    a <xref linkend="mthConnectEvent"/> notification. Normally the mouse hover event is not generated.
    The <xref linkend="mthTrackEvent"/> method must be invoked to request hover tracking before the
    operating system will generate the hover notification.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::mouseHoverHeight() [attribute]  -->

<section id="atrMouseHoverTime" xreflabel="mouseHoverTime"><title>mouseHoverTime (Attribute)</title>
<indexterm><primary>mouseHoverTime</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>mouseHoverTime</secondary></indexterm>
<programlisting>
<![CDATA[
>>--mouseHoverTime-------------------------------><

>>--mouseHoverTime=milliseconds------------------><

]]>
</programlisting>

<para>
  Reflects the time, in milliseconds the mouse must remain in the hover rectangle to generate a MOUSEHOVER notification.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">mouseHoverTime get:</emphasis></term>
  <listitem>
  <para>
    Retrieves the system wide default hover time out value in milliseconds
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">mouseHoverTime set:</emphasis></term>
  <listitem>
  <para>
    Sets the time, in milliseconds, for the hover time out. The <emphasis role="italic">milliseconds</emphasis> must be
    a non-negative whole number within the range of 10 to 2147483647.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The hover rectangle is the rectangle within which the mouse pointer has to stay for the operating system to generate
    a <xref linkend="mthConnectEvent"/> notification. The time out value is the number of milliseconds
    the mouse has to remain in the rectangle. Normally the mouse hover event is not generated. The
 <xref linkend="mthTrackEvent"/> method must be invoked to request hover tracking before the
    operating system will generate the hover notification.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::mouseHoverHeight() [attribute]  -->

<section id="atrMouseHoverWidth" xreflabel="mouseHoverWidth"><title>mouseHoverWidth (Attribute)</title>
<indexterm><primary>mouseHoverWidth</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>mouseHoverWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--mouseHoverWidth------------------------------><

>>--mouseHoverWidth=width------------------------><

]]>
</programlisting>

<para>
  Reflects the width of the hover rectangle. The hover rectangle is the rectangle  within which the mouse pointer has to
  stay to generate a MOUSEHOVER notification.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">mouseHoverWidth get:</emphasis></term>
  <listitem>
  <para>
    Retrieves the width of the system wide hover rectangle in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">mouseHoverWidth set:</emphasis></term>
  <listitem>
  <para>
    Sets the width, in pixels, of the hover rectangle. The <emphasis role="italic">width</emphasis> must be a
    non-negative whole number.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The hover rectangle is the rectangle within which the mouse pointer has to stay for the operating system to generate
    a <xref linkend="mthConnectEvent"/> notification. Normally the mouse hover event is not generated.
    The <xref linkend="mthTrackEvent"/> method must be invoked to request hover tracking before the
    operating system will generate the hover notification.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::mouseHoverWidth() [attribute]  -->

<section id="atrUpdateFlag" xreflabel="updateFlag"><title>updateFlag (Attribute)</title>
<indexterm><primary>updateFlag</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>updateFlag</secondary></indexterm>
<programlisting>
<![CDATA[
>>--updateFlag-----------------------------------><

>>--updateFlag=newFlag---------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">updateFlag</emphasis> attribute allows the programmer to direct the operating system to
  update the user profile and to broadcast the WM_SETTINGCHANGE message when a system parameter value is changed
  through the <computeroutput>SPI</computeroutput> class.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">updateFlag get:</emphasis></term>
  <listitem>
  <para>
    Retrives the current value of the <emphasis role="italic">updateFlag</emphasis> attribute. The value is returned as
    a key word and will be exactly one of these words: UpdateProfile SendChange None. The meaning of the key words is
    explained below.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">updateFlag set:</emphasis></term>
  <listitem>
  <para>
    Assign a key word to the <emphasis role="italic">updateFlag</emphasis> attribute to specify additional actions for
    the operating system to take when changing a system parameter through the <computeroutput>SPI</computeroutput>
    class.
  </para>
  <para>
    The key word must be exactly one of the following key words, case is not significant and only the first letter of
    the word needs to be specified:
  </para>
  <para>
    <simplelist type='vert' columns='3'>
      <member>None         </member>
      <member>UpdateProfile</member>
      <member>SendChange   </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>None</term>
      <listitem>
      <para>
        The operating system takes no additional action when the value of one of the system parameter attributes is
        changed through the <computeroutput>SPI</computeroutput> class.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>UpdateProfile</term>
      <listitem>
      <para>
        When a system parameter attribute's value is changed through the <computeroutput>SPI</computeroutput> class, the
        operating system will also update the user profile.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SendChange</term>
      <listitem>
      <para>
        When a system parameter attribute's value is changed through the <computeroutput>SPI</computeroutput> class, the
        operating system updates the user profile and broadcasts the WM_SETTINGCHANGE message to all top-level windows
        to notify them of the change.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The value of the <emphasis role="italic">updateFlag</emphasis> attribute only comes into play when a new value is
    assigned to a system parameter attribute.  <emphasis role="italic">updateFlag</emphasis> is ignored when the value
    of a system parameter is retrieved. By default, <emphasis role="italic">updateFlag</emphasis> is set to None.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the WheelScrollLines system parameter to 5. It has the operating system update the user profile
    and broadcast the setting changed message to all top-level windows so the applications currently running can update
    their settings if needed. It then changes the <emphasis role="italic">updateFlag</emphasis> back to the default.
<programlisting>
<![CDATA[

  .SPI~updateFlag = 'SendChange'
  .SPI~wheelScrollLines = 5
  .SPI~updateFlag = 'N'

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::updateFlag() [attribute]  -->

<section id="atrWheelScrollLines" xreflabel="wheelScrollLines"><title>wheelScrollLines (Attribute)</title>
<indexterm><primary>wheelScrollLines</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>wheelScrollLines</secondary></indexterm>
<programlisting>
<![CDATA[
>>--wheelScrollLines-----------------------------><

>>--wheelScrollLines=count-----------------------><

]]>
</programlisting>

<para>
  Reflects the number of lines to scroll when the vertical mouse wheel is moved. The number is a non-negative whole
  number. The system default is 3.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">wheelScrollLines get:</emphasis></term>
  <listitem>
  <para>
    Retrieves the number of lines to scroll when the vertical mouse wheel is moved.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">wheelScrollLines set:</emphasis></term>
  <listitem>
  <para>
    Sets the number of lines to scroll when the vertical mouse wheel is moved.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The wheel scroll lines is the suggested number of lines to scroll when the mouse wheel is rolled without using
    modifier keys. If the number is 0, then no scrolling should occur. If the number of lines to scroll is larger than
    the number of viewable lines, and especially if it is the <computeroutput>SPI</computeroutput> constant
    WHEEL_PAGESCROLL (<computeroutput>.SPI~WHEEL_PAGESCROLL</computeroutput>), the scroll operation should be
    interpreted as clicking once in the page down or page up regions of the scroll bar.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
    <para>
      Sets the <xref linkend="dotSystemErrorCode"/>.
    </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example retrieves the current setting for the wheel scroll lines and then scrolls the text in an edit control
    the appropriate amount. Note that this is a simplistic example. The code should really check if <emphasis
    role="italic">scrollLines</emphasis> is 0, or equal to the WHEEL_PAGESCROLL constant, or greater than the number of
    visible lines in the edit control.
<programlisting>
<![CDATA[

::method scrollUp private
  use strict arg editCtrl

  scrollLines = .SPI~wheelScrollLines
  editCtrl~scrollCommand("UP", scrollLines)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::wheelScrollLines() [attribute]  -->

<section id="atrWorkArea" xreflabel="workArea"><title>workArea (Attribute)</title>
<indexterm><primary>workArea</primary></indexterm>
<indexterm><primary>SPI class</primary><secondary>workArea</secondary></indexterm>
<programlisting>
<![CDATA[
>>--workArea-------------------------------------><

>>--workArea=rArea-------------------------------><

]]>
</programlisting>

<para>
  Reflects the size of the work area on the screen as a <computeroutput>.Rect</computeroutput> object.  The work area is
  the portion of the screen not hidden by the system taskbar or by application desktop toolbars.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">workArea get:</emphasis></term>
  <listitem>
  <para>
    The value of the <emphasis role="italic">workArea</emphasis> attribute is a <xref linkend="clsRect"/>
    object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">workArea set:</emphasis></term>
  <listitem>
  <para>
    Assign a <computeroutput>.Rect</computeroutput> object as the value of this attribute. This changes the current work
    area to the coordinates specified in the <computeroutput>.Rect</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When setting a new work area, the <computeroutput>.Rect</computeroutput> object specifies the new work area in
    virtual screen coordinates. If the system has multiple display monitors, the operating system sets the work
    area of the monitor that contains the specified rectangle.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End SPI::workArea() [attribute]  -->

</section> <!-- End SPI Class -->


<section id="dotSystemErrorCode" xreflabel=".systemErrorCode"><title>.systemErrorCode object</title>
<indexterm><primary>.systemErrorCode</primary></indexterm>
<para>
  The .systemErrorCode can be used, at times, to obtain additional information when the invocation of a
  method generates an operating system error.
</para>
<para>
  ooDialog provides an interface to the Windows operating system APIs.  To be specific, the Win32 APIs,
  and mostly those dealing with dialogs and other graphical aspects of the user interface.  Some of the
  Win32 APIs will set a system error code when something goes wrong.  (On the other hand, many of the
  Win32 APIs do not set a system error code.)
</para>
<para>
  When the ooDialog framework first initializes, it sets the value of .systemErrorCode to 0.  <emphasis
  role="italic">Some</emphasis>, of the methods of the ooDialog classes will set the .systemErrorCode to
  the value of the system error code when the method detects that a Win32 API has failed and has set the
  error code.  Most methods do <emphasis role="bold">not</emphasis> change the value of .SystemErrorCode.
  Only those methods that explicitly document they use .systemErrorCode will ever change its value.
</para>
<para>
  One consequence of the fact that most methods do not change .systemErrorCode is that its value is only
  meaningful immediately after the invocation of a method that is documented as using .SystemErrorCode.
  Those methods will set the code to 0 and, if they detect a Win32 API has set the system error code to
  non-zero, they will then set .systemErrorCode to the value of the system error.  Checking
  .systemErrorCode after the invocation of a method that does not set .systemErrorCode will tell the
  programmer nothing. Neither that a system error happened, or that it did not happen.
</para>
<para>
  The <xref linkend="mthGetImageClsImage"/> method of the <xref linkend="clsImage"/> class is
  one method that does change .SystemErrorCode. <emphasis role="bold">Note</emphasis> in the example the use of the
  RexxUtil function, <computeroutput>SysGetErrorText</computeroutput>. This function is useful to get an explanatory
  message for the error code. The message is provided by Windows, not by ooRexx or ooDialog. This is an example of a
  possible usage:
</para>
<programlisting>
<![CDATA[
image = .Image~getImage("resources\bogus.bmp")
if image~isNull then do
  say "Error getting the bogus.bmp image."
  if .systemErrorCode <> 0 then do
    say 'System error code:' .systemErrorCode
    say '  system message:' SysGetErrorText(.systemErrorCode)
  end
end

/*
  Output on the screen might be:

Error getting the bogus.bmp image.
System error code: 2
  system message: The system cannot find the file specified.
*/
]]>
</programlisting>
</section>


<section id="clsVK" xreflabel="VK"><title>VK Class</title>
<indexterm><primary>VK class</primary></indexterm>
<indexterm><primary>virtual key codes</primary></indexterm>
<para>
  The <computeroutput>VK</computeroutput> class allows the programmer to use symbolic names in a program instead of the
  numeric value of the virtual key codes.
</para>
<para>
  The Windows operating system assigns a value to each key on the keyboard called a scan code. Scan codes are device
  <emphasis role="italic">dependent</emphasis>. To notify an application that the user has pressed a key, the operating system translates the scan
  code into a <emphasis role="italic">virtual key code</emphasis>. Virtual key codes are device <emphasis
  role="italic">independent</emphasis>. This allows the programmer to write a program without worrying about what
  keyboard the user may have.
</para>
<para>
  Virtual key codes are in the range of 0 through 255. However a number of the possible codes are unassigned, perhaps 30
  or 40. The <computeroutput>VK</computeroutput> class provides constants for every assigned key code. The constants
  serve as symbolic names for the key codes. In addition, the <xref linkend="mthKey2Name"/> method is
  provided that translates a numeric number into its human-readable string name.
</para>
<para>
  There are two ways to use the <computeroutput>VK</computeroutput> class. The class is a <emphasis
  role="italic">mixinclass</emphasis>. It can be inherited by a class to provide that class with all the constants and
  methods of the <computeroutput>VK</computeroutput> class. Recall that the <emphasis
  role="italic">::constant</emphasis> directive defines both a class and an instance method that returns a constant
  value. Therefore, the constant values can be accessed directly through the class methods of the
  <computeroutput>VK</computeroutput> class.  There is also a <emphasis role="italic">key2name</emphasis> class method
  along with the instance method. The following two examples should clarify that:
</para>

<programlisting>
<![CDATA[

::class 'SimpleDlg' subclass RcDialog inherit VK

::method onKeyDown
  use arg controlID, key

  say "The key pressed was the" self~name2key(key) "virtual key"

  if key == self~DELETE then do
    return self~deleteAllItems
  end

]]>
</programlisting>
<para>
  The above example inherits the <computeroutput>VK</computeroutput> class and thus the DELETE constant and the
  <emphasis role="italic">key2name</emphasis> method become part of the  <computeroutput>SimpleDlg</computeroutput>
  class. The same thing can be accomplished using the class methods of the <computeroutput>VK</computeroutput> class:
</para>

<programlisting>
<![CDATA[

::class 'SimpleDlg' subclass RcDialog

::method onKeyDown
  use arg controlID, key

  say "The key pressed was the" .VK~name2key(key) "virtual key"

  if key == .VK~DELETE then do
    return self~deleteAllItems
  end

]]>
</programlisting>
<para>
  Using the class methods of the <computeroutput>VK</computeroutput> class has the advantage of not conflicting with any
  existing method the <computeroutput>SimpleDlg</computeroutput> may have.
</para>

<section id="sctMethodsVK"><title>Method Table</title>
<para>
  The <computeroutput>VK</computeroutput> class primarily consists of constants. The implemented constants and methods
  are listed in the following table.

<table id="tblVKMethods" frame="all">
<title>Methods of the VK class</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="3*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthKey2Name"/></entry>
<entry>Returns the symbolic name for a numeric key code as a string</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthKey2Name"/></entry>
<entry>Returns the symbolic name for a numeric key code as a string</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Constants</emphasis></entry>
<entry align="center"><emphasis role="bold">Constants</emphasis></entry>
</row>
<row>
<entry><emphasis role="bold">0</emphasis></entry>
<entry>The <emphasis role="bold">0</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">1</emphasis></entry>
<entry>The <emphasis role="bold">1</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">2</emphasis></entry>
<entry>The <emphasis role="bold">2</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">3</emphasis></entry>
<entry>The <emphasis role="bold">3</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">4</emphasis></entry>
<entry>The <emphasis role="bold">4</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">5</emphasis></entry>
<entry>The <emphasis role="bold">5</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">6</emphasis></entry>
<entry>The <emphasis role="bold">6</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">7</emphasis></entry>
<entry>The <emphasis role="bold">7</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">8</emphasis></entry>
<entry>The <emphasis role="bold">8</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">9</emphasis></entry>
<entry>The <emphasis role="bold">9</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">A</emphasis></entry>
<entry>The <emphasis role="bold">A</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">B</emphasis></entry>
<entry>The <emphasis role="bold">B</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">C</emphasis></entry>
<entry>The <emphasis role="bold">C</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">D</emphasis></entry>
<entry>The <emphasis role="bold">D</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">E</emphasis></entry>
<entry>The <emphasis role="bold">E</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">F</emphasis></entry>
<entry>The <emphasis role="bold">F</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">G</emphasis></entry>
<entry>The <emphasis role="bold">G</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">H</emphasis></entry>
<entry>The <emphasis role="bold">H</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">I</emphasis></entry>
<entry>The <emphasis role="bold">I</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">J</emphasis></entry>
<entry>The <emphasis role="bold">J</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">K</emphasis></entry>
<entry>The <emphasis role="bold">K</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">L</emphasis></entry>
<entry>The <emphasis role="bold">L</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">M</emphasis></entry>
<entry>The <emphasis role="bold">M</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">N</emphasis></entry>
<entry>The <emphasis role="bold">N</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">O</emphasis></entry>
<entry>The <emphasis role="bold">O</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">P</emphasis></entry>
<entry>The <emphasis role="bold">P</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">Q</emphasis></entry>
<entry>The <emphasis role="bold">Q</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">R</emphasis></entry>
<entry>The <emphasis role="bold">R</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">S</emphasis></entry>
<entry>The <emphasis role="bold">S</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">T</emphasis></entry>
<entry>The <emphasis role="bold">T</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">U</emphasis></entry>
<entry>The <emphasis role="bold">U</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">V</emphasis></entry>
<entry>The <emphasis role="bold">V</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">W</emphasis></entry>
<entry>The <emphasis role="bold">W</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">X</emphasis></entry>
<entry>The <emphasis role="bold">X</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">Y</emphasis></entry>
<entry>The <emphasis role="bold">Y</emphasis> key</entry>
</row>
<row>
<entry><emphasis role="bold">Z</emphasis></entry>
<entry>The <emphasis role="bold">Z</emphasis> key</entry>
</row>
<row>
<entry>ACCEPT</entry>
<entry>The IME accept</entry>
</row>
<row>
<entry>ADD</entry>
<entry>The Add key</entry>
</row>
<row>
<entry>APPS</entry>
<entry>The Applications key (Natural keyboard)</entry>
</row>
<row>
<entry>ATTN</entry>
<entry>The Attn key</entry>
</row>
<row>
<entry>BACK</entry>
<entry>The BACKSPACE key</entry>
</row>
<row>
<entry>BROWSER_BACK</entry>
<entry>The Browser Back key</entry>
</row>
<row>
<entry>BROWSER_FAVORITES</entry>
<entry>The Browser Favorites key</entry>
</row>
<row>
<entry>BROWSER_FORWARD</entry>
<entry>The Browser Forward key</entry>
</row>
<row>
<entry>BROWSER_HOME</entry>
<entry>The Browser Start and Home key</entry>
</row>
<row>
<entry>BROWSER_REFRESH</entry>
<entry>The Browser Refresh key</entry>
</row>
<row>
<entry>BROWSER_SEARCH</entry>
<entry>The Browser Search key</entry>
</row>
<row>
<entry>BROWSER_STOP</entry>
<entry>The Browser Stop key</entry>
</row>
<row>
<entry>CANCEL</entry>
<entry>The Control-break processing</entry>
</row>
<row>
<entry>CAPITAL</entry>
<entry>The CAPS LOCK key</entry>
</row>
<row>
<entry>CLEAR</entry>
<entry>The CLEAR key</entry>
</row>
<row>
<entry>CONTROL</entry>
<entry>The CTRL key</entry>
</row>
<row>
<entry>CONVERT</entry>
<entry>The IME convert</entry>
</row>
<row>
<entry>CRSEL</entry>
<entry>The CrSel key</entry>
</row>
<row>
<entry>DECIMAL</entry>
<entry>The Decimal key</entry>
</row>
<row>
<entry>DELETE</entry>
<entry>The DEL key</entry>
</row>
<row>
<entry>DIVIDE</entry>
<entry>The Divide key</entry>
</row>
<row>
<entry>DOWN</entry>
<entry>The DOWN ARROW key</entry>
</row>
<row>
<entry>END</entry>
<entry>The END key</entry>
</row>
<row>
<entry>EREOF</entry>
<entry>The Erase EOF key</entry>
</row>
<row>
<entry>ESCAPE</entry>
<entry>The ESC key</entry>
</row>
<row>
<entry>EXECUTE</entry>
<entry>The EXECUTE key</entry>
</row>
<row>
<entry>EXSEL</entry>
<entry>The ExSel key</entry>
</row>
<row>
<entry>F1</entry>
<entry>The F1 key</entry>
</row>
<row>
<entry>F2</entry>
<entry>The F2 key</entry>
</row>
<row>
<entry>F3</entry>
<entry>The F3 key</entry>
</row>
<row>
<entry>F4</entry>
<entry>The F4 key</entry>
</row>
<row>
<entry>F5</entry>
<entry>The F5 key</entry>
</row>
<row>
<entry>F6</entry>
<entry>The F6 key</entry>
</row>
<row>
<entry>F7</entry>
<entry>The F7 key</entry>
</row>
<row>
<entry>F8</entry>
<entry>The F8 key</entry>
</row>
<row>
<entry>F9</entry>
<entry>The F9 key</entry>
</row>
<row>
<entry>F10</entry>
<entry>The F10 key</entry>
</row>
<row>
<entry>F11</entry>
<entry>The F11 key</entry>
</row>
<row>
<entry>F12</entry>
<entry>The F12 key</entry>
</row>
<row>
<entry>F13</entry>
<entry>The F13 key</entry>
</row>
<row>
<entry>F14</entry>
<entry>The F14 key</entry>
</row>
<row>
<entry>F15</entry>
<entry>The F15 key</entry>
</row>
<row>
<entry>F16</entry>
<entry>The F16 key</entry>
</row>
<row>
<entry>F17</entry>
<entry>The F17 key</entry>
</row>
<row>
<entry>F18</entry>
<entry>The F18 key</entry>
</row>
<row>
<entry>F19</entry>
<entry>The F19 key</entry>
</row>
<row>
<entry>F20</entry>
<entry>The F20 key</entry>
</row>
<row>
<entry>F21</entry>
<entry>The F21 key</entry>
</row>
<row>
<entry>F22</entry>
<entry>The F22 key</entry>
</row>
<row>
<entry>F23</entry>
<entry>The F23 key</entry>
</row>
<row>
<entry>F24</entry>
<entry>The F24 key</entry>
</row>
<row>
<entry>FINAL</entry>
<entry>The IME final mode</entry>
</row>
<row>
<entry>HANGUL</entry>
<entry>The IME Hangul mode</entry>
</row>
<row>
<entry>HANJA</entry>
<entry>The IME Hanja mode</entry>
</row>
<row>
<entry>HELP</entry>
<entry>The HELP key</entry>
</row>
<row>
<entry>HOME</entry>
<entry>The HOME key</entry>
</row>
<row>
<entry>ICO_00</entry>
<entry>The 00 key on ICO</entry>
</row>
<row>
<entry>ICO_CLEAR</entry>
<entry>No explanation</entry>
</row>
<row>
<entry>ICO_HELP</entry>
<entry>The Help key on ICO</entry>
</row>
<row>
<entry>INSERT</entry>
<entry>The INS key</entry>
</row>
<row>
<entry>JUNJA</entry>
<entry>The IME Junja mode</entry>
</row>
<row>
<entry>KANA</entry>
<entry>The IME Kana mode</entry>
</row>
<row>
<entry>KANJI</entry>
<entry>The IME Kanji mode</entry>
</row>
<row>
<entry>LAUNCH_APP1</entry>
<entry>The Start Application 1 key</entry>
</row>
<row>
<entry>LAUNCH_APP2</entry>
<entry>The Start Application 2 key</entry>
</row>
<row>
<entry>LAUNCH_MAIL</entry>
<entry>The Start Mail key</entry>
</row>
<row>
<entry>LAUNCH_MEDIA_SELECT</entry>
<entry>The Select Media key</entry>
</row>
<row>
<entry>LBUTTON</entry>
<entry>The Left mouse button</entry>
</row>
<row>
<entry>LCONTROL</entry>
<entry>The Left CONTROL key</entry>
</row>
<row>
<entry>LEFT</entry>
<entry>The LEFT ARROW key</entry>
</row>
<row>
<entry>LMENU</entry>
<entry>The Left MENU key</entry>
</row>
<row>
<entry>LSHIFT</entry>
<entry>The Left SHIFT key</entry>
</row>
<row>
<entry>LWIN</entry>
<entry>The Left Windows key (Natural keyboard)</entry>
</row>
<row>
<entry>MBUTTON</entry>
<entry>The Middle mouse button (three-button mouse)</entry>
</row>
<row>
<entry>MEDIA_NEXT_TRACK</entry>
<entry>The Next Track key</entry>
</row>
<row>
<entry>MEDIA_PLAY_PAUSE</entry>
<entry>The Play/Pause Media key</entry>
</row>
<row>
<entry>MEDIA_PREV_TRACK</entry>
<entry>The Previous Track key</entry>
</row>
<row>
<entry>MEDIA_STOP</entry>
<entry>The Stop Media key</entry>
</row>
<row>
<entry>MENU</entry>
<entry>The ALT key</entry>
</row>
<row>
<entry>MODECHANGE</entry>
<entry>The IME mode change request</entry>
</row>
<row>
<entry>MULTIPLY</entry>
<entry>The Multiply key</entry>
</row>
<row>
<entry>NEXT</entry>
<entry>The PAGE DOWN key</entry>
</row>
<row>
<entry>NONCONVERT</entry>
<entry>The IME nonconvert</entry>
</row>
<row>
<entry>NUMLOCK</entry>
<entry>The NUM LOCK key</entry>
</row>
<row>
<entry>NUMPAD0</entry>
<entry>The Numeric keypad 0 key</entry>
</row>
<row>
<entry>NUMPAD1</entry>
<entry>The Numeric keypad 1 key</entry>
</row>
<row>
<entry>NUMPAD2</entry>
<entry>The Numeric keypad 2 key</entry>
</row>
<row>
<entry>NUMPAD3</entry>
<entry>The Numeric keypad 3 key</entry>
</row>
<row>
<entry>NUMPAD4</entry>
<entry>The Numeric keypad 4 key</entry>
</row>
<row>
<entry>NUMPAD5</entry>
<entry>Numeric keypad 5 key</entry>
</row>
<row>
<entry>NUMPAD6</entry>
<entry>The Numeric keypad 6 key</entry>
</row>
<row>
<entry>NUMPAD7</entry>
<entry>The Numeric keypad 7 key</entry>
</row>
<row>
<entry>NUMPAD8</entry>
<entry>The Numeric keypad 8 key</entry>
</row>
<row>
<entry>NUMPAD9</entry>
<entry>The Numeric keypad 9 key</entry>
</row>
<row>
<entry>OEM_1</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard. For the US standard keyboard, the ';:' key</entry>
</row>
<row>
<entry>OEM_2</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard. For the US standard keyboard, the '/?' key</entry>
</row>
<row>
<entry>OEM_3</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard. For the US standard keyboard, the '`~' key</entry>
</row>
<row>
<entry>OEM_4</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard. For the US standard keyboard, the '[{' key</entry>
</row>
<row>
<entry>OEM_5</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard. For the US standard keyboard, the '\|' key</entry>
</row>
<row>
<entry>OEM_6</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard. For the US standard keyboard, the ']}' key</entry>
</row>
<row>
<entry>OEM_7</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard. For the US standard keyboard, the 'single-quote/double-quote' key</entry>
</row>
<row>
<entry>OEM_8</entry>
<entry>Used for miscellaneous characters; it can vary by keyboard.</entry>
</row>
<row>
<entry>OEM_102</entry>
<entry>Either the angle bracket key or the backslash key on the RT 102-key keyboard</entry>
</row>
<row>
<entry>OEM_ATTN</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_AUTO</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_AX</entry>
<entry>The <emphasis role="italic">AX</emphasis> key on Japanese AX kbd</entry>
</row>
<row>
<entry>OEM_BACKTAB</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_CLEAR</entry>
<entry>The Clear key</entry>
</row>
<row>
<entry>OEM_COMMA</entry>
<entry>For any country/region, the ',' key</entry>
</row>
<row>
<entry>OEM_COPY</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_CUSEL</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_ENLW</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_FINISH</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_JUMP</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_MINUS</entry>
<entry>For any country/region, the '-' key</entry>
</row>
<row>
<entry>OEM_PA1</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_PA2</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_PA3</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_PERIOD</entry>
<entry>For any country/region, the '.' key</entry>
</row>
<row>
<entry>OEM_RESET</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>OEM_WSCTRL</entry>
<entry>Nokia/Ericsson definition</entry>
</row>
<row>
<entry>PACKET</entry>
<entry>Used to pass Unicode characters as if they were keystrokes. The PACKET key is the low word of a 32-bit Virtual Key value used for non-keyboard input methods.</entry> </row>
<row>
<entry>OEM_PLUS</entry>
<entry>For any country/region, the '+' key</entry>
</row>
<row>
<entry>PA1</entry>
<entry>The PA1 key</entry>
</row>
<row>
<entry>PAUSE</entry>
<entry>The PAUSE key</entry>
</row>
<row>
<entry>PLAY</entry>
<entry>The Play key</entry>
</row>
<row>
<entry>PRINT</entry>
<entry>The PRINT key</entry>
</row>
<row>
<entry>PRIOR</entry>
<entry>The PAGE UP key</entry>
</row>
<row>
<entry>PROCESSKEY</entry>
<entry>The IME PROCESS key</entry>
</row>
<row>
<entry>RBUTTON</entry>
<entry>The Right mouse button</entry>
</row>
<row>
<entry>RCONTROL</entry>
<entry>The Right CONTROL key</entry>
</row>
<row>
<entry>RETURN</entry>
<entry>The ENTER key</entry>
</row>
<row>
<entry>RIGHT</entry>
<entry>The RIGHT ARROW key</entry>
</row>
<row>
<entry>RMENU</entry>
<entry>The Right MENU key</entry>
</row>
<row>
<entry>RSHIFT</entry>
<entry>The Right SHIFT key</entry>
</row>
<row>
<entry>RWIN</entry>
<entry>The Right Windows key (Natural keyboard)</entry>
</row>
<row>
<entry>SCROLL</entry>
<entry>The SCROLL LOCK key</entry>
</row>
<row>
<entry>SELECT</entry>
<entry>The SELECT key</entry>
</row>
<row>
<entry>SEPARATOR</entry>
<entry>The Separator key</entry>
</row>
<row>
<entry>SHIFT</entry>
<entry>The SHIFT key</entry>
</row>
<row>
<entry>SLEEP</entry>
<entry>The Computer Sleep key</entry>
</row>
<row>
<entry>SNAPSHOT</entry>
<entry>The PRINT SCREEN key</entry>
</row>
<row>
<entry>SPACE</entry>
<entry>The SPACEBAR</entry>
</row>
<row>
<entry>SUBTRACT</entry>
<entry>The Subtract key</entry>
</row>
<row>
<entry>TAB</entry>
<entry>The TAB key</entry>
</row>
<row>
<entry>UP</entry>
<entry>The UP ARROW key</entry>
</row>
<row>
<entry>VOLUME_DOWN</entry>
<entry>The Volume Down key</entry>
</row>
<row>
<entry>VOLUME_MUTE</entry>
<entry>The Volume Mute key</entry>
</row>
<row>
<entry>VOLUME_UP</entry>
<entry>The Volume Up key</entry>
</row>
<row>
<entry>XBUTTON1</entry>
<entry>The X1 mouse button</entry>
</row>
<row>
<entry>XBUTTON2</entry>
<entry>The X2 mouse button</entry>
</row>
<row>
<entry>ZOOM</entry>
<entry>The Zoom key</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>


<section id="mthKey2Name" xreflabel="key2name"><title>key2name</title>
<indexterm><primary>key2name</primary></indexterm>
<indexterm><primary>VK class</primary><secondary>key2name</secondary></indexterm>
<programlisting>
<![CDATA[
>>--key2name(--numericCode--)--------------------><

]]>
</programlisting>

<para>
  Converts a numeric virtual key code into the string version of its constant name.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The only argument is:
  <variablelist>
    <varlistentry><term>numericCode [required]</term>
    <listitem>
    <para>
      The numeric value of a virtual key code. Virtual key codes are whole numbers in the range 0 through 255.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the constant method name for the specified virtual key code as a string.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    There is both a class method and an instance method with this method's name. Therefore the method can be use like
    this:
<programlisting>
<![CDATA[
  ::class 'MyClass' subclass ResDialog inherit VK
    ...
    say "The key pressed was:" self~key2Name(key)

]]>
</programlisting>

    or like this:

<programlisting>
<![CDATA[
  ::class 'MyClass' subclass RcDialog
    ...
    say "The key pressed was:" .VK~key2name(key)

]]>
</programlisting>

  </para>
  <para>
    Not all possible key codes are assigned. The empty string is returned for those numbers.
  </para>
  <para>
    This method is a convenience method which allows a program to print the key code name to the screen in a say
    statement. The method is usually not needed. In particular, code like this:

<programlisting>
<![CDATA[
  ::method someMethod
    use arg key
    ...
    if .VK~key2Name(key) == "INSERT" then
      ...

]]>
</programlisting>

    can be replaced by this:

<programlisting>
<![CDATA[
  ::method someMethod
    use arg key
    ...
    if key == .VK~INSERT then
      ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    A syntax error is raised if <emphasis role="italic">numericCode</emphasis> is not a whole number the range of 0
    through 255.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End VK::key2name() -->

<section id="exampleVKConstant"><title>Example VK Constant Use</title>
<para>
  This example connects the key down event in a tree control with a method in the dialog. If the user presses the
  delete key while the tree control has the focus, the selected item is deleted. Likewise, if the user presses the
  insert key he is given the opportunity to insert a new item into the tree.
</para>

<programlisting>
<![CDATA[

::class 'TreeDlg' subclass ResDialog
...

::method initDialog

self~connectTreeViewEvent(IDC_TREE, "KEYDOWN", onKeyDown)
...

::method onKeyDown
use arg treeId, key
tree = self~newTreeView(treeId)

-- If the delete key is pressed, delete the selected item, or if the insert
-- key is pressed insert a new item by programmatically clicking the New Item
-- button. Otherwise ignore key.
if key == .VK~DELETE then
   tree~delete(tree~selected)
else if key == .VK~INSERT then
   self~newPushButton(IDC_PB_NEW_ITEM)~push

]]>
</programlisting>
</section>

</section> <!-- End VK Class -->


<section id="clsWindow" xreflabel="Window"><title>Window Class</title>
<indexterm><primary>Window class</primary></indexterm>
<para>
  A <emphasis role="italic">Window</emphasis> object allows the invocation of methods common to every window.  It does
  this by inheriting the <xref linkend="clsWindowBase"/> class. Other than the
 <xref linkend="mthNewClsWindow"/>() method, the <emphasis role="italic">Window</emphasis> class provides no
  other methods of its own.
</para>

<section id="sctMethodsWindow"><title>Method Table</title>
<para>
  The following table lists the class and instance methods of the <computeroutput>Window</computeroutput> class:
<table id="tblMethodsWindow" frame="all"> <title>Window Class Method Reference</title>
<tgroup cols="2">
<colspec colwidth="1*" />
<colspec colwidth="4*" />
<thead>
<row>
<entry>Window Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
<entry align="center"><emphasis role="bold">Class Methods</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthNewClsWindow"/></entry>
<entry>Instantiates a new window object.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
</row>
<row>
<entry><xref linkend="wbwFactorX"/></entry>
<entry>The horizontal size of one dialog unit in pixels. (Inaccurate.)</entry>
</row>
<row>
<entry><xref linkend="wbwFactorY"/></entry>
<entry>The vertical size of one dialog unit in pixels. (Inaccurate.)</entry>
</row>
<row>
<entry><xref linkend="wbwHwnd"/></entry>
<entry>The window handle of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwInitCode"/></entry>
<entry>Has no meaning, always 0.</entry>
</row>
<row>
<entry><xref linkend="wbwPixelCX"/></entry>
<entry>The width of the window in pixels.</entry>
</row>
<row>
<entry><xref linkend="wbwPixelCY"/></entry>
<entry>The height of the window in pixels.</entry>
</row>
<row>
<entry><xref linkend="wbwSizeX"/></entry>
<entry>The width of the window in dialog units. (Inaccurate.)</entry>
</row>
<row>
<entry><xref linkend="wbwSizeY"/></entry>
<entry>The height of the window in dialog units. (Inaccurate.)</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="wbwClear"/></entry>
<entry>Clears the client area of the window by painting it with the background brush.</entry>
</row>
<row>
<entry><xref linkend="wbwClient2screen"/></entry>
<entry>Converts a point or points in client-area coordinates of the window to its screen coordinates.</entry>
</row>
<row>
<entry><xref linkend="wbwClientRect"/></entry>
<entry>Returns a <computeroutput>Rect</computeroutput> object containing the dimensions of the window's client area in pixels.</entry>
</row>
<row>
<entry><xref linkend="wbwClientToScreen"/></entry>
<entry>Converts client-area coordinates of the window to its screen coordinates.</entry>
</row>
<row>
<entry><xref linkend="wbwDisable"/></entry>
<entry>Disables the window.</entry>
</row>
<row>
<entry><xref linkend="wbwDisplay"/></entry>
<entry>Shows or hides the window.</entry>
</row>
<row>
<entry><xref linkend="wbwDraw"/></entry>
<entry>Redraws the entire client area of the window immediately.</entry>
</row>
<row>
<entry><xref linkend="wbwEnable"/></entry>
<entry>Enables the window.</entry>
</row>
<row>
<entry><xref linkend="wbwForegroundWindow"/></entry>
<entry>Returns the handle of the window in the foreground.</entry>
</row>
<row>
<entry><xref linkend="wbwGetClientRect"/></entry>
<entry>Returns the dimensions of the window's client area.</entry>
</row>
<row>
<entry><xref linkend="wbwGetExStyleRaw"/></entry>
<entry>Retrieves the numeric value of the window's extended style flags.</entry>
</row>
<row>
<entry><xref linkend="wbwGetID"/></entry>
<entry>Retrieves the identification number of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwGetPos"/></entry>
<entry>Returns the position of the window in dialog units <emphasis role="bold">(not accurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="wbwGetRealPos"/></entry>
<entry>Returns the position of the window in pixels as a <computeroutput>Point</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="wbwGetRealSize"/></entry>
<entry>Returns the size of the window in pixels as a <computeroutput>Size</computeroutput> object.</entry>
</row>
<row>
<entry><xref linkend="wbwGetRect"/></entry>
<entry>Returns the dimensions of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwGetSize"/></entry>
<entry>Returns the size of the window in dialog units <emphasis role="bold">(not accurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="wbwGetStyleRaw"/></entry>
<entry>Retrieves the numeric value of the window's style flags.</entry>
</row>
<row>
<entry><xref linkend="wbwGetText"/></entry>
<entry>Gets the text of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwGetTextSizePx"/></entry>
<entry>Calculates the size needed for a string in pixels <emphasis role="bold">(preferred method.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="wbwGetTextSizeScreen"/></entry>
<entry>Calculates the size needed for a string in pixels.</entry>
</row>
<row>
<entry><xref linkend="wbwHide"/></entry>
<entry>Makes the window invisible and repaints it.</entry>
</row>
<row>
<entry><xref linkend="wbwHideFast"/></entry>
<entry>Marks the window as invisible</entry>
</row>
<row>
<entry><xref linkend="wbwIsEnabled"/></entry>
<entry>Tests if the window is enabled.</entry>
</row>
<row>
<entry><xref linkend="wbwIsVisible"/></entry>
<entry>Tests if the window is visible.</entry>
</row>
<row>
<entry><xref linkend="wbwMove"/></entry>
<entry>Moves the window to the position specified in dialog units <emphasis role="bold">(not accurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="wbwMoveTo"/></entry>
<entry>Moves the window to the position specified in pixels.</entry>
</row>
<row>
<entry><xref linkend="wbwRedraw"/></entry>
<entry>Redraws the entire window and all its child windows immediately.</entry>
</row>
<row>
<entry><xref linkend="wbwRedrawClient"/></entry>
<entry>Redraws the entire client area of the window immediately.</entry>
</row>
<row>
<entry><xref linkend="wbwResize"/></entry>
<entry>Resizes the window to the size specified in dialog units <emphasis role="bold">(not accurate.)</emphasis></entry>
</row>
<row>
<entry><xref linkend="wbwResizeTo"/></entry>
<entry>Resizes the window to the size specified in pixels.</entry>
</row>
<row>
<entry><xref linkend="wbwScreen2client"/></entry>
<entry>Converts a point or points in screen coordinates to the client-area coordinates of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwScreenToClient"/></entry>
<entry>Converts screen coordinates to the client-area coordinates of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwSendMessage"/></entry>
<entry>Sends a Windows message to the underlying window and returns its response as a whole number.</entry>
</row>
<row>
<entry><xref linkend="wbwSendMessageHandle"/></entry>
<entry>Sends a Windows message to the underlying window and returns its response as a handle.</entry>
</row>
<row>
<entry><xref linkend="wbwSetRect"/></entry>
<entry>Moves and / or resizes the window.</entry>
</row>
<row>
<entry><xref linkend="wbwSetStyleRaw"/></entry>
<entry>Sets the value of the window's style flags using the numeric value specified.</entry>
</row>
<row>
<entry><xref linkend="wbwSetText"/></entry>
<entry>Sets the text of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwSetTitle"/></entry>
<entry>Sets the text of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwShowFast"/></entry>
<entry>Marks the window as visible.</entry>
</row>
<row>
<entry><xref linkend="wbwTitle"/></entry>
<entry>Gets the text of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwTitleEquals"/></entry>
<entry>Sets the text of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwUpdate"/></entry>
<entry>Invalidates the entire client area of the window.</entry>
</row>
<row>
<entry><xref linkend="wbwWindowRect"/></entry>
<entry>Returns a <computeroutput>Rect</computeroutput> object containing the dimensions of the window in pixels.</entry>
</row>
</tbody></tgroup>
</table>
</para>
</section>

<section id="mthNewClsWindow" xreflabel="new"><title>new (Class Method)</title>
<indexterm><primary>new</primary>
<secondary>Window class</secondary></indexterm>
<programlisting>
<![CDATA[

>>--new(--hwnd--)--------------------------------><

]]>
</programlisting>

<para>
  Given a window <xref linkend="defHandle"/>, instantiates a new <computeroutput>Window</computeroutput>
  object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
    <varlistentry><term>hwnd</term>
    <listitem>
    <para>
      The window
    </para>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method returns a new <computeroutput>Window</computeroutput> object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    Given an array of dialog control resource IDs this method enables all the controls without having to know what the
    type of the individual control is:
<programlisting>
<![CDATA[
::method enableControls
  use strict arg IDs
  hDlg = self~hwnd
  do id over IDs
    hwnd = self~getControlHandle(id, hDlg)
    if hwnd = 0 then return .false
    .Window~new(hwnd)~enable
  end
  return .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="wbwInitCode" xreflabel="initCode"><title>initCode (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrInitCode"/>

<![CDATA[
>>--initCode-------------------------------------><

>>--initCode=code--------------------------------><

]]>
</programlisting>
</section>

<section id="wbwHwnd" xreflabel="hwnd"><title>hwnd (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrHwnd"/>

<![CDATA[
>>--hwnd-----------------------------------------><

]]>
</programlisting>
</section>

<section id="wbwFactorX" xreflabel="factorX"><title>factorX (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrFactorX"/>

<![CDATA[
>>--factorX--------------------------------------><

>>--factorX=ratio--------------------------------><
]]>

</programlisting>
</section>

<section id="wbwFactorY" xreflabel="factorY"><title>factorY (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrFactorY"/>

<![CDATA[
>>--factorY--------------------------------------><

>>--factorY=ratio--------------------------------><
]]>

</programlisting>
</section>

<section id="wbwPixelCX" xreflabel="pixelCX"><title>pixelCX (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrPixelCX"/>

<![CDATA[
>>--pixelCX--------------------------------------><
]]>
</programlisting>
</section>

<section id="wbwPixelCY" xreflabel="pixelCY"><title>pixelCY (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrPixelCY"/>

<![CDATA[
>>--pixelCY--------------------------------------><
]]>
</programlisting>
</section>

<section id="wbwSizeX" xreflabel="sizeX"><title>sizeX (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrSizeX"/>

<![CDATA[
>>--sizeX----------------------------------------><

>>--sizeX=dialogUnits----------------------------><
]]>
</programlisting>
</section>

<section id="wbwSizeY" xreflabel="sizeY"><title>sizeY (Attribute)</title>
<programlisting>
WindowBase::<xref linkend="atrSizeY"/>

<![CDATA[
>>--sizeY----------------------------------------><

>>--sizeY=dialogUnits----------------------------><
]]>
</programlisting>
</section>


<section id="wbwClear" xreflabel="clear"><title>clear</title>
<programlisting>
WindowBase::<xref linkend="mthClear"/>

<![CDATA[
>>--clear----------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwClient2screen" xreflabel="client2screen"><title>client2screen</title>
<programlisting>
WindowBase::<xref linkend="mthClient2screen"/>

<![CDATA[
>>--client2screen(--pointOrRect--)---------------><
]]>
</programlisting>
</section>


<section id="wbwClientRect" xreflabel="clientRect"><title>clientRect</title>
<programlisting>
WindowBase::<xref linkend="mthClientRect"/>

<![CDATA[
>>--clientRect(--+--------+--)-------------------><
                 +--hwnd--+
]]>
</programlisting>
</section>


<section id="wbwClientToScreen" xreflabel="clientToScreen"><title>clientToScreen</title>
<programlisting>
WindowBase::<xref linkend="mthClientToScreen"/>

<![CDATA[
>>--clientToScreen(--x--,--y--)------------------><
]]>
</programlisting>
</section>


<section id="wbwDisable" xreflabel="disable"><title>disable</title>
<programlisting>
WindowBase::<xref linkend="mthDisable"/>

<![CDATA[
>>--disable--------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwDisplay" xreflabel="display"><title>display</title>
<programlisting>
WindowBase::<xref linkend="mthDisplay"/>

<![CDATA[
]]>
</programlisting>
</section>


<section id="wbwDraw" xreflabel="draw"><title>draw</title>
<programlisting>
WindowBase::<xref linkend="mthDraw"/>

<![CDATA[
>>--draw-----------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwEnable" xreflabel="enable"><title>enable</title>
<programlisting>
WindowBase::<xref linkend="mthEnable"/>

<![CDATA[
>>--enable---------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwForegroundWindow" xreflabel="foregroundWindow"><title>foregroundWindow</title>
<programlisting>
WindowBase::<xref linkend="mthForegroundWindow"/>

<![CDATA[
>>--foregroundWindow-----------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetClientRect" xreflabel="getClientRect"><title>getClientRect</title>
<programlisting>
WindowBase::<xref linkend="mthGetClientRect"/>

<![CDATA[
>>--getClientRect(--+------+--)------------------><
                    +-hwnd-+
]]>
</programlisting>
</section>


<section id="wbwGetExStyleRaw" xreflabel="getExStyleRaw"><title>getExStyleRaw</title>
<programlisting>
WindowBase::<xref linkend="mthGetExStyleRaw"/>

<![CDATA[
>>--getExStyleRaw--------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetID" xreflabel="getID"><title>getID</title>
<programlisting>
WindowBase::<xref linkend="mthGetID"/>

<![CDATA[
>>--getID----------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetPos" xreflabel="getPos"><title>getPos</title>
<programlisting>
WindowBase::<xref linkend="mthGetPos"/>

<![CDATA[
>>--getPos---------------------------------------><

]]>
</programlisting>
</section>


<section id="wbwGetRealPos" xreflabel="getRealPos"><title>getRealPos</title>
<programlisting>
WindowBase::<xref linkend="mthGetSize"/>

<![CDATA[
>>--getRealPos-----------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetRealSize" xreflabel="getRealSize"><title>getRealSize</title>
<programlisting>
WindowBase::<xref linkend="mthGetRealSize"/>

<![CDATA[
>>--getRealSize----------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetRect" xreflabel="getRect"><title>getRect</title>
<programlisting>
WindowBase::<xref linkend="mthGetRect"/>

<![CDATA[
>>--getRect--------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetSize" xreflabel="getSize"><title>getSize</title>
<programlisting>
WindowBase::<xref linkend="mthGetSize"/>

<![CDATA[
>>--getSize--------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetStyleRaw" xreflabel="getStyleRaw"><title>getStyleRaw</title>
<programlisting>
WindowBase::<xref linkend="mthGetStyleRaw"/>

<![CDATA[
>>--getStyleRaw----------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetText" xreflabel="getText"><title>getText</title>
<programlisting>
WindowBase::<xref linkend="mthGetText"/>

<![CDATA[
>>--getText--------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwGetTextSizePx" xreflabel="getTextSizePx"><title>getTextSizePx</title>
<programlisting>
WindowBase::<xref linkend="mthGetTextSizePx"/>

<![CDATA[
>>--getTextSizePx(-text--)-----------------------><
]]>
</programlisting>
</section>


<section id="wbwGetTextSizeScreen" xreflabel="getTextSizeScreen"><title>getTextSizeScreen</title>
<programlisting>
WindowBase::<xref linkend="mthGetTextSizeScreen"/>

<![CDATA[
>>--getTextSizeScreen(-text--+---------+--+------------+--+-------------+-)----><
                             +-,-type--+  +-,-fontSrc--+  +-,-fontSize--+
]]>
</programlisting>
</section>


<section id="wbwHide" xreflabel="hide"><title>hide</title>
<programlisting>
WindowBase::<xref linkend="mthHide"/>

<![CDATA[
>>--hide-----------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwHideFast" xreflabel="hideFast"><title>hideFast</title>
<programlisting>
WindowBase::<xref linkend="mthHideFast"/>

<![CDATA[
>>--hideFast-------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwIsEnabled" xreflabel="isEnabled"><title>isEnabled</title>
<programlisting>
WindowBase::<xref linkend="mthIsEnabled"/>

<![CDATA[
>>--isEnabled------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwIsVisible" xreflabel="isVisible"><title>isVisible</title>
<programlisting>
WindowBase::<xref linkend="mthIsVisible"/>

<![CDATA[
>>--isVisible------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwMove" xreflabel="move"><title>move</title>
<programlisting>
WindowBase::<xref linkend="mthMove"/>

<![CDATA[
>>--move(--xPos--,--yPos--+-------------+--)-----><
                          +-,-showOpts--+
]]>
</programlisting>
</section>


<section id="wbwMoveTo" xreflabel="moveTo"><title>moveTo</title>
<programlisting>
WindowBase::<xref linkend="mthMoveTo"/>

<![CDATA[
Form 1:

>>--moveTo(--point--+--------------+--)----------><
                    +--,-showOpts--+
Form 2:

>>--moveTo(--x,--y--+--------------+--)----------><
                    +--,-showOpts--+
Generic form:

>>--moveTo(--newPos--+--------------+--)---------><
                     +--,-showOpts--+
]]>
</programlisting>
</section>


<section id="wbwRedraw" xreflabel="redraw"><title>redraw</title>
<programlisting>
WindowBase::<xref linkend="mthRedraw"/>

<![CDATA[
>>--redraw---------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwRedrawClient" xreflabel="redrawClient"><title>redrawClient</title>
<programlisting>
WindowBase::<xref linkend="mthRedrawClient"/>

<![CDATA[
>>--redrawClient(--+------------+--)-------------><
                   +--eraseBkg--+
]]>
</programlisting>
</section>


<section id="wbwResize" xreflabel="resize"><title>resize</title>
<programlisting>
WindowBase::<xref linkend="mthResize"/>

<![CDATA[
>>--resize(--width--,--height--+-------------+--)---------------><
                               +-,-showOpts--+
]]>
</programlisting>
</section>


<section id="wbwResizeTo" xreflabel="resizeTo"><title>resizeTo</title>
<programlisting>
WindowBase::<xref linkend="mthResizeTo"/>

<![CDATA[
Form 1:

>>--resizeTo(--size--)---------------------------><

Form 2:

>>--resizeTo(--cx,--cy--)------------------------><

Generic form:

>>--resizeTo(--newSize--)------------------------><
]]>
</programlisting>
</section>


<section id="wbwScreen2client" xreflabel="screen2client"><title>screen2client</title>
<programlisting>
WindowBase::<xref linkend="mthScreen2client"/>

<![CDATA[
>>--screen2client(--pointOrRect--)---------------><
]]>
</programlisting>
</section>


<section id="wbwScreenToClient" xreflabel="screenToClient"><title>screenToClient</title>
<programlisting>
WindowBase::<xref linkend="mthScreenToClient"/>

<![CDATA[
>>--screenToClient(--x--,--y--)------------------><
]]>
</programlisting>
</section>


<section id="wbwSendMessage" xreflabel="sendMessage"><title>sendMessage</title>
<programlisting>
WindowBase::<xref linkend="mthSendMessage"/>

<![CDATA[
>>--sendMessage(--id--,--msg--,--wParam--,--lParam--)-----------><
]]>
</programlisting>
</section>


<section id="wbwSendMessageHandle" xreflabel="sendMessageHandle"><title>sendMessageHandle</title>
<programlisting>
<xref linkend="mthSendMessageHandle"/>

<![CDATA[
>>--sendMessageHandle(--id--,--msg--,--wParam--,--lParam--)-----><
]]>
</programlisting>
</section>


<section id="wbwSetRect" xreflabel="setRect"><title>setRect</title>
<programlisting>
WindowBase::<xref linkend="mthSetRect"/>

<![CDATA[
Form 1:

>>--setRect(--rectangle--+------------+--)-------><
                         +-,-showOpts-+

Form 2:

>>--setRect(--point--,--size--+------------+--)-----------------><
                              +-,-showOpts-+

Form 3:

>>--setRect(--x-,--y-,--cx-,--cy--+------------+--)-------------><
                                  +-,-showOpts-+

Generic form:

>>--setRect(--ptSizeRectangle--+------------+--)----------------><
                               +-,-showOpts-+
]]>
</programlisting>
</section>


<section id="wbwSetStyleRaw" xreflabel="setStyleRaw"><title>setStyleRaw</title>
<programlisting>
WindowBase::<xref linkend="mthSetStyleRaw"/>

<![CDATA[
>>--setStyleRaw(--value--)-----------------------><
]]>
</programlisting>
</section>


<section id="wbwSetText" xreflabel="setText"><title>setText</title>
<programlisting>
WindowBase::<xref linkend="mthSetText"/>

<![CDATA[
>>--setText(--newText--)-------------------------><
]]>
</programlisting>
</section>


<section id="wbwSetTitle" xreflabel="setTitle"><title>setTitle</title>
<programlisting>
WindowBase::<xref linkend="mthSetTitleClsWindowBase"/>

<![CDATA[
>>--setTitle(--newText--)------------------------><
]]>
</programlisting>
</section>


<section id="wbwShowFast" xreflabel="showFast"><title>showFast</title>
<programlisting>
WindowBase::<xref linkend="mthShowFast"/>

<![CDATA[
>>--showFast-------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwTitle" xreflabel="title"><title>title</title>
<programlisting>
WindowBase::<xref linkend="mthTitle"/>

<![CDATA[
>>--title----------------------------------------><
]]>
</programlisting>
</section>


<section id="wbwTitleEquals" xreflabel="title="><title>title=</title>
<programlisting>
WindowBase::<xref linkend="mthTitleEquals"/>

<![CDATA[
>>--title=newText--------------------------------><
]]>
</programlisting>
</section>


<section id="wbwUpdate" xreflabel="update"><title>update</title>
<programlisting>
WindowBase::<xref linkend="mthUpdateClsWindowBase"/>

<![CDATA[
]]>
</programlisting>
</section>


<section id="wbwWindowRect" xreflabel="windowRect"><title>windowRect</title>
<programlisting>
WindowBase::<xref linkend="mthWindowRect"/>

<![CDATA[
>>--windowRect(--+--------+--)-------------------><
                 +--hwnd--+
]]>
</programlisting>
</section>

</section> <!-- End Window Class -->


<section id="rtnWinTimer" xreflabel="WinTimer"><title>WinTimer Routine</title>
<indexterm><primary>WinTimer</primary></indexterm>
<indexterm><primary>public routines</primary><secondary>WinTimer</secondary></indexterm>
<programlisting>
<![CDATA[
>>--WinTimer(--mode--,--msOrID--)----------------><
]]>
</programlisting>

<para>
  Creates, waits on, or releases, depending on <emphasis role="italic">mode</emphasis>, a periodic Windows timer.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>mode [required]</term>
      <listitem>
      <para>
        Exactly one of the following keywords, case is not significant. The <emphasis role="italic">mode</emphasis> keyword
        controls what the function does:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>START</member>
          <member>WAIT</member>
          <member>STOP</member>
        </simplelist>
        <variablelist>
          <varlistentry><term>START</term>
          <listitem>
          <para>
            Creates the timer and starts it. The WAIT and STOP modes will fail if the timer is not created first. In the
            START mode, the <emphasis role="italic">msOrID</emphasis> argument specifies the period, in milliseconds, of the
            timer. The return value for the START mode is the ID of the timer. This ID must then be used for the WAIT or STOP
            modes.
          </para>
          </listitem></varlistentry>
          <varlistentry><term></term>
          <listitem>
          <para>
            Waits until the next period of the timer is elapsed. In the WAIT mode, the <emphasis
            role="italic">msOrID</emphasis> argument must be the ID of the timer that is returned from using the CREATE mode.
            The return value is 0 on success and the system error code on error.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>STOP</term>
          <listitem>
          <para>
            Stops, releases, the timer. In the STOP mode,  the <emphasis role="italic">msOrID</emphasis> argument must be the
            ID of the timer that is returned from using the CREATE mode. The return value is 0 on success and the system
            error code on error.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>msOrID [required]</term>
      <listitem>
      <para>
        The value of the <emphasis role="italic">msOrID</emphasis> argument is dependent on the <emphasis
        role="italic">mode</emphasis> argument as explained above. When creating the timer this argument is the desired
        period, in milliseconds, of the timer. In the WAIT and STOP modes, the <emphasis role="italic">msOrID</emphasis>
        argument must be the timer ID that is returned from calling the function in the CREATE mode.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is dependent on the <emphasis role="italic">mode</emphasis> the function is called with. If <emphasis
    role="italic">mode</emphasis> is CREATE, then the return value is 0 on error, otherwise the timer ID on success. In the
    other 2 modes the return is 0 on success and a system error code on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Every created timer should be released by calling the function with the STOP <emphasis role="italic">mode</emphasis>.
    Otherwise, the operating system will continue signaling the timer and consuming some system resources.
  </para>
  <para>
    When calling <emphasis role="italic">WinTimer</emphasis> in the WAIT mode, the routine does not return until the current
    period of the timer elapses. During the WAIT, the current thread is suspended. When starting the WAIT, some portion of
    the current period will have elapsed, so the current thread is not suspended for the timer period. It is only suspended
    for the remaining time in the current period. This is unlike the Rexx <emphasis role="italic">SysSleep</emphasis>
    routine, where the thread is suspended for the interval specified. For instance, if the timer period is 2 seconds and the
    application calls the routine in WAIT mode after .9 seconds of the current period has elapsed, the thread will only be
    suspended for 1.1 seconds.
  </para>
  <para>
    Windows is not a real time operating system. Any type of timer in Windows can only achieve an approximate wait period. In
    particular you can not expect a working wait period of less than 15 milliseconds with the <emphasis
    role="italic">WinTimer</emphasis> routine.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example that shows how to correctly start and use a timer with the <emphasis role="italic">WinTimer</emphasis>
    routine:
<programlisting>
<![CDATA[

::method doStuff unguarded
  expose finished

  finished = .false
  reply 0

  id = WinTimer("START", 2000)
  if id <> 0 then do while \ finished
    say "Still working at:" time()

    do i = 1 to 10
      ...
    end

    ...

    ret = WinTimer("WAIT", id)
    if ret <> 0 then leave
  end

  if id <> 0 then ret = WinTimer("STOP", id)

  finished = .true

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End WinTimer() -->

</chapter>
