<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2013-2013 Rexx Language Association. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter id="chpOoDialogExe" xreflabel="ooDialog.exe"><title>The ooDialog Exeutable</title>
<indexterm><primary>ooDialog executable</primary></indexterm>
<para>
  The distribution of ooDialog includes an executable file, named: <computeroutput>ooDialog.exe</computeroutput>. This
  executable file is located in the same directory as the <computeroutput>oodialog.dll</computeroutput> and
  <computeroutput>ooDialog.cls</computeroutput> files. In the typical installation of ooRexx or ooDialog, this diretory will
  be in the PATH which allows ooDialog.exe to be accessed from anywhere on the computer.
</para>

<section id="sctOverView"><title>OverView</title>
<indexterm><primary>ooDialog executable</primary><secondary>overview</secondary></indexterm>

<para>
  The ooDialog executable provides a number of enhancements and services to use along with the ooDialog framework. These
  range from the simplistic to the relatively complex. There is no need, or requirement, to ever run the executable if the
  ooDialog user is not interested in any of the features provide by <computeroutput>ooDialog.exe</computeroutput>. That is,
  currently, there are no dependencies on <computeroutput>ooDialog.exe</computeroutput> in the ooDialog framework.
</para>
<para>
  The following briefly lists and describes the functionality provided by the ooDialog executable:
</para>

<variablelist>
  <varlistentry><term><emphasis role="bold">Displays information about the installed ooDialog:</emphasis></term>
  <listitem>
  <para>
    ooDialog.exe can be used to display simple version information for the installed ooDialog framework. It also will display
    more detailed information for the ooDialog installation such as the build date, 32 or 64 bit, debug or release, version
    of ooRexx that is in use, etc..
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Executes ooRexx programs without a console window:</emphasis></term>
  <listitem>
  <para>
    ooDialog.exe can be used as a replacement for rexxhide.exe to executate ooRexx programs without a secondary console
    window popping up. ooDialog.exe has a few enhancements that may make it more suitable to use than rexxhide.exe.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Serves as a drop target for drag and dropping ooRexx programs:</emphasis></term>
  <listitem>
  <para>
    ooRexx programs can be dragged and dropped on ooDialog.exe, or a short cut to ooDialog.exe, to execute them.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Configures file associations for ooDialog and the PATHEXT:</emphasis></term>
  <listitem>
  <para>
    For users not familiar with setting up file types and associations, ooDialog.exe can present a graphical user interface
    to configure file types and associate them with the executable.
  </para>
  </listitem></varlistentry>
</variablelist>

</section> <!-- End OverView section -->


<section id="sctOodExeCLO"><title>ooDialog.Exe Command Line Options</title>
<indexterm><primary>ooDialog executable</primary><secondary>command line options</secondary></indexterm>

<para>
  One of the simplest features ooDialog.exe provides is to display information about the current installation of ooDialog.
  Since the installation of ooDialog has been decoupled from the installation of ooRexx, the version of ooRexx no longer has
  any relation to the installed version of ooDialog. ooDialog.exe can be executed from a command prompt, using the
  <computeroutput>-v</computeroutput> option, to quickly determine the version of the installed ooDialog:
<programlisting>
<![CDATA[
C:\Rexx>oodialog -v
ooDialog 4.2.4.9574

C:\Rexx>
]]>
</programlisting>
</para>
<para>
  If ooDialog.exe is executed from a command prompt with no options, or if it is double-clicked in Explorer, it opens an
  informational window that displays the ooDialog version and other details concerning the executable and its purpose.
  Executing ooDialog.exe from a command prompt with the <computeroutput>-h</computeroutput> option displays the syntax for
  ooDialog.exe. For example:
<programlisting>
<![CDATA[
C:\Rexx>oodialog -h
Syntax:

    ooDialog [option flags] [programName] [arg1 arg2 ... argN]

option flags:
  -h        Show this, the short help text.
  /?        Same as -h.
  -H        Show the long help text.
  --help    If from a console window, show the long help.
  -s        Display the ooDialog Setup dialog.
  -v        Print the short version string.
  -V        Print the long version string.
  --version If from a console window, print the long version string.

programName:
  The first argument that does not begin with '-' is taken as the name
  of a Rexxx program to be executed.

arg1 ... argN:
  Arguments 1 through N are passed on to programName.


C:\Rexx>
]]>
</programlisting>
</para>
<para>
  Executing ooDialog.exe from a command prompt with the <computeroutput>--version</computeroutput> option displays more
  detailed information concerning the ooDialog version, along with the version of ooRexx that ooDialog is running under. For
  example:
<programlisting>
<![CDATA[
C:\Rexx>oodialog --version

ooDialog: ooDialog Version 4.2.4.9574 (64 bit) - Internal Test Version
          Built Nov 27 2013 07:38:21
          Copyright (c) IBM Corporation 1995, 2004.
          Copyright (c) RexxLA 2005-2013.
          All Rights Reserved.

Rexx:     Open Object Rexx Version 4.2.0


C:\Rexx>
]]>
</programlisting>
</para>

</section> <!-- End oodExeCLO section -->


<section id="sctOodExePL"><title>ooDialog.Exe as a Program Launcher</title>
<indexterm><primary>ooDialog executable</primary><secondary>program launcher</secondary></indexterm>

<para>
  A primary use of ooDialog.exe is to execute ooDialog programs without displaying a secondary console window. This is very
  much like the rexxhide.exe program that comes with the Windows ooRexx distribution. The ooRexx interpreter (rexx.exe) is
  built as a console application. This is what gives the interpreter access to the standard input and output streams. Which
  in turn allows the <emphasis role="italic">say</emphasis> instruction to write text to the console and the <emphasis
  role="italic">pull</emphasis> instruction to retrieve text the user has typed.
</para>
<para>
  Because it is a console application, whenever rexx.exe starts, the operating system creates a console window if it is not
  already being executed from a console window. For a purely graphical application, as most ooDialog programs are, this
  secondary console window can be an annoyance. The ooDialog executable, (and rexxhide.exe,) are built as a windows
  applicattion and internally use the ooRexx naive API to start an instance of the interpreter to execute the Rexx program.
  Because they are built as a windows application, no console window is created by the operating system.
</para>
<para>
  One drawback that rexxhide.exe has, is that since it is built as a windows application with no console window, all text
  normally writen to the console is lost. This includes the error condition text written when a condition is raised. Because
  of this Rexx programs run under rexxhide.exe just silently end if a problem in the program raises a condition. This can be
  frustrating because the program will just terminate and there is no way to know why.
</para>
<para>
  The ooDialog executable has been enhanced to help with this situation. If a condition is raised and the Rex program is
  terminated, oodialg.exe traps the condition text and then displays it in a window when the interpreter terminates.
</para>

<note><title>Note</title>
  <para>
    This discussion on using ooDialgo.exe as a program launcher mostly refers to launching ooDialog programs. However,
    ooDialog.exe will execute any ooRexx program. It is not restricted to launching only ooDialog programs.
  </para>
</note>

<para>
  There are a number of ways to launch ooDialog programs using ooDialog.exe:
</para>

<variablelist>
  <varlistentry><term><emphasis role="bold">direct invocation:</emphasis></term>
  <listitem>
  <para>
    From a command prompt simply use ooDialog.exe instead of rexx.exe:
<programlisting>
<![CDATA[
/* Instead of this: */

C:\Rexx>rexx.exe ooRexx\ooRexxTry.rex

/* Use this: */

C:\Rexx>ooDialog.exe ooRexx\ooRexxTry.rex
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">within a shortcut or Start menu item:</emphasis></term>
  <listitem>
  <para>
    Typically, people create a short cut to an ooDialog program using rexxhide.exe. Then, double-clicking the short cut in
    Explorer launches the ooDialog program with no console Window. The ooRexx installer has set up these types of short cuts
    for ooDialog example programs for years. In the short cut, ooDialog.exe can be used instead of rexxhide.exe:
<programlisting>
<![CDATA[
/* The ooRexx installer has set up a Start menu item to the ooDialog sample.rex programe like this: */

Target type:      Application
Target location:  ooRexx
Target:           C:\Rexx\ooRexx\rexxhide.exe "C:\Rexx\ooRexx\samples\oodialog\sample.rex"
Start in:         C:\Rexx\ooRexx\samples\oodialog\

/* Use this for the short cut instead: */

Target type:      Application
Target location:  ooRexx
Target:           C:\Rexx\ooRexx\ooDialog.exe "C:\Rexx\ooRexx\samples\oodialog\sample.rex"
Start in:         C:\Rexx\ooRexx\samples\oodialog\

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">with drag and drop:</emphasis></term>
  <listitem>
  <para>
    The ooDialog exectuable is drag and drop enabled. That is, ooDialog.exe can serve as a drop target. In Explorer when an
    ooDialog program file is dragged and dropped on the ooDialog.exe icon, the ooDialog program will execute without a
    secondary console window. A common use of this ability would be to create a short cut to ooDialog.exe on the desktop and
    drag and drop ooDialog programs on the short cut.
  </para>
  <para>
    This snapshot of a portion of a user's Desktop shows a short cut icon to ooDialog.exe. ooDialog programs such as
    <emphasis role="italic">columnIcons.rex</emphasis> can be dragged from Explorer and dropped on the short cut, which
    launches the ooDialog program.
    <figure id="figDesktopIcon"><title>Drag and Drop Scenario</title>
    <mediaobject>
    <imageobject>
    <imagedata fileref="images/oodDesktopIcon.jpg" scale="80" />
    </imageobject>
    </mediaobject>
    </figure>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">using file types and associations:</emphasis></term>
  <listitem>
  <para>
    Probably one of the best ways to use ooDialog.exe to execute ooDialog programs is through the use of file type
    associations. Once a file type has been created for ooDialog.exe, and an extension associated with that file type,
    double-clicking on any file with the extension will execute the ooDialog program.
  </para>
  <para>
    The figure below shows a user's system where a file type has been created for ooDialog.exe and the extension <emphasis
    role="italic">.ood</emphasis> is associated with that file type. Double-clicking on
    <computeroutput>columnIcons.ood</computeroutput> has executed that ooDialog program.
    <figure id="figFileAssociation"><title>.ood Extension Associated with ooDialog.exe</title>
    <mediaobject>
    <imageobject>
    <imagedata fileref="images/oodFileAssociation.jpg" scale="65" />
    </imageobject>
    </mediaobject>
    </figure>
  </para>
  <para>
    Although it is not discernible from the figure itself, the created file type on the user's system is
    <computeroutput>ooRexx.ooDialog.1</computeroutput>. File types and associations are relatively easy to create and manage
    from the command prompt, or through Explorer. People familar will file type associations will recognize that the
    following displays the file type and association from the system in the figure above:
<programlisting>
<![CDATA[
C:\Rexx>ftype ooRexx.ooDialog.1
ooRexx.ooDialog.1="C:\Rexx\ooRexx\ooDialog.exe" "%1" %*

C:\Rexx>assoc .ood
.ood=ooRexx.ooDialog.1

C:\Rexx>
]]>
</programlisting>
    For people not familar with creating file types and associations, ooDialog.exe can be used to configure file associations
    for the system through a graphical user interface. This use of ooDialgo.exe is explained in the next section
  </para>
  </listitem></varlistentry>
</variablelist>
</section> <!-- End oodExePL section -->


<section id="sctOodExeFA"><title>ooDialog.Exe Configure File Associations</title>
<indexterm><primary>ooDialog executable</primary><secondary>configure file associations</secondary></indexterm>

<para>
  Windows has promoted a scheme to identify the type of a file through the file name extension of the file. (The extension
  part of a file name is everything following the last dot in the file name.) Different types of files are then associated
  with the program that uses the file. When a file type and its association are made known to the operating system, when the
  user interacts with a known file type, the operarting system will start the program that uses the file directly. For
  instance, text files can be associated with the user's favorite editor. Double-clicking on a text file will then start the
  editor will the file ready to edit.
</para>
<para>
  The <emphasis role="italic">Configure ooDialog Services</emphasis> dialog is used to start the process of configuring file
  associations for ooDialog.exe:
  <figure id="figConfigServices"><title>Configure Services Dialog</title>
  <mediaobject>
  <imageobject>
  <imagedata fileref="images/oodConfigureServices.jpg" scale="100" />
  </imageobject>
  </mediaobject>
  </figure>
  Future versions of ooDialog may have the ability to configure more services than just file associations, in which case this
  dialog will be expanded to allow that configuration. Currently, only file associations are configured through this dialog.
</para>
<para>
  The configure services dialog can be brought up in two ways. From a command prompt, the <emphasis
  role="italic">-s</emphasis> option will immediately start the dialog:
<programlisting>
<![CDATA[
C:\Rexx>oodialog -s

C:\Rexx>
]]>
</programlisting>
  Starting ooDialog.exe with no arguments, either from the command prompt or by double-clicking ooDialog.exe, brings up the
  information display window:
  <figure id="figInformationWindow"><title>ooDialogInformationWindow</title>
  <mediaobject>
  <imageobject>
  <imagedata fileref="images/oodInformationWindow.jpg" scale="70" />
  </imageobject>
  </mediaobject>
  </figure>
  Check the <emphasis role="italic">Configure other ooDialog services</emphasis> check box. The <emphasis
  role="italic">Close</emphasis> button's label will change to <emphasis role="italic">Continue</emphasis> and clicking the
  button starst the configure services dialog.
</para>
<para>
  This figure shows the dialog that is used to configure file associations for ooDialog.exe and the use of the
  dialog is explained in the following text:
  <figure id="figConfigFileAssociations"><title>Drag and Drop Scenario</title>
  <mediaobject>
  <imageobject>
  <imagedata fileref="images/oodConfigureFileAssociations.jpg" scale="70" />
  </imageobject>
  </mediaobject>
  </figure>
</para>

</section> <!-- End oodExeFA section -->


</chapter> <!-- End ooDialog Executable -->

