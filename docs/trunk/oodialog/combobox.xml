<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference SGML file.
    #
    # Copyright (c) 2005-2011, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="clsComboBox"><title>Combo Box Controls</title>
<indexterm><primary>ComboBox class</primary></indexterm>
<para>
  There are 3 types of combo boxes.
</para>
<itemizedlist>
<listitem><para>Simple combo boxes</para></listitem>
<listitem><para>Drop-down combo boxes</para></listitem>
<listitem><para>Drop-down list combo boxes</para></listitem>
</itemizedlist>
<para>
  A combo box consists of a list and a selection field. The list presents options that can be selected and the selection
  field displays the current selection.
</para>
<para>
  In simple and drop-down combo boxes the selection field is an edit control and can be used to enter
  text not available in the list, or to edit existing text. In drop-down list combo boxes, the list is a
  list box control and the use can only select the items.  In a drop-down combo-box the list only appears
  when the user opens it. In a simple combo box the list is always visible.
</para>
<para>
  The <computeroutput>ComboBox</computeroutput> class provides methods to query and modify combo box controls.
</para>
<para>
  In addition to the methods of the class itself, the following methods from other classes in the ooDialog framework are
  needed, or are useful, when working with combo box controls:
<variablelist>
  <varlistentry><term><emphasis role="bold">Instantiation:</emphasis></term>
  <listitem>
  <para>
    Use the <link linkend="mthNewComboBox">newComboBox</link>() method of the <link
    linkend="chpDialogObject">dialog</link> to retrieve a combo box object.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Dynamic Definition:</emphasis></term>
  <listitem>
  <para>
    To dynamically create a combo box in the dialog template of a <link linkend="clsUserDialog">UserDialog</link> use
    the <link linkend="mthCreateComboBox">createComboBox</link> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Notification</emphasis></term>
  <listitem>
  <para>
    To connect the <link linkend="ovvEvents">event</link> notifications sent by the underlying combo box control to a
    method in the Rexx dialog object use the <link linkend="mthConnectComboBoxEvent">connectComboBoxEvent</link>)
    method.
  </para>
  </listitem></varlistentry>
</variablelist>
</para>

<section id="sctMethodsComboBox"><title>Method Table</title>
<para>
  The following table provides links to the documentation for the primary methods and attributes used in working
  with ComboBox objects, including the pertinent methods from other classes:
</para>
<table id="tblComboBoxMethods" frame="all">
<title>ComboBox Methods and Attributes</title>
<tgroup cols="2">
<colspec colwidth="1.75in">
<thead>
<row>
<entry>Method</entry>
<entry>Documentation</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Useful External Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="tmthNewComboBox">newComboBox</link></entry>
<entry>Obtains a ComboBox object that represents a combo box control in a dialog.</entry>
</row>
<row>
<entry><link linkend="tmthCreateComboBox">createComboBox</link></entry>
<entry>Creates a combo box control in an <link linkend="clsUserDialog">UserDialog</link>.</entry>
</row>
<row>
<entry><link linkend="tmthConnectComboBoxEvent">connectComboBoxEvent</link></entry>
<entry>Connects ComboBox event notifications to a Rexx dialog method.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><link linkend="mthAddClsComboBox">add</link></entry>
<entry>Adds a new item to the list of the combo box.</entry>
</row>
<row>
<entry><link linkend="mthAddDirectoryClsComboBox">addDirectory</link></entry>
<entry>Adds all or selected file names of a given directory to the combo box.</entry>
</row>
<row>
<entry><link linkend="mthCloseDropDown">closeDropDown</link></entry>
<entry>Closes the list box of the combo box.</entry>
</row>
<row>
<entry><link linkend="mthDeleteClsComboBox">delete</link></entry>
<entry>Removes a list item from the combo box.</entry>
</row>
<row>
<entry><link linkend="mthDeleteAllClsComboBox">deleteAll</link></entry>
<entry>Removes all list items from the combo box.</entry>
</row>
<row>
<entry><link linkend="mthEditSelection">editSelection</link></entry>
<entry>Selects the specified text range in the edit control of the combo box.</entry>
</row>
<row>
<entry><link linkend="mthFindClsComboBox">find</link></entry>
<entry>Searches the combo box for a list item containing the specified text or prefix.</entry>
</row>
<row>
<entry><link linkend="mthGetHorizontalExtentClsComboBox">getHorizontalExtent</link></entry>
<entry>Gets the value of the horizontal extent for the combo box.</entry>
</row>
<row>
<entry><link linkend="mthGetTextClsComboBox">getText</link></entry>
<entry>Gets the text of the list item at the specified position in the combo box.</entry>
</row>
<row>
<entry><link linkend="mthInsertClsComboBox">insert</link></entry>
<entry>Inserts a new item into the list of the combo box after the specified item.</entry>
</row>
<row>
<entry><link linkend="mthIsdropdownopen">isDropDownOpen</link></entry>
<entry>Determines if the list box of the associated combo box is open.</entry>
</row>
<row>
<entry><link linkend="mthItemsClsComboBox">items</link></entry>
<entry>Retrieves the number of items in the combo box.</entry>
</row>
<row>
<entry><link linkend="mthModifyClsComboBox">modify</link></entry>
<entry>Changes the text of the list item at the specified position in the combo box.</entry>
</row>
<row>
<entry><link linkend="mthOpenDropDown">openDropDown</link></entry>
<entry>Opens the list box of the associated combo box.</entry>
</row>
<row>
<entry><link linkend="mthSelectClsComboBox">select</link></entry>
<entry>Selects the list entry that matches the specified text.</entry>
</row>
<row>
<entry><link linkend="mthSelectedClsComboBox">selected</link></entry>
<entry>Retrieves the text of the currently selected entry of the combo box list.</entry>
</row>
<row>
<entry><link linkend="mthSelectedIndexClsComboBox">selectedIndex</link></entry>
<entry>Retrieves the index of the currently selected entry of the combo box.</entry>
</row>
<row>
<entry><link linkend="mthSelectIndexClsComboBox">selectIndex</link></entry>
<entry>Selects and highlights the list entry at the specified position.</entry>
</row>
<row>
<entry><link linkend="mthGetHorizontalExtentClsComboBox">setHorizontalExtent</link></entry>
<entry>Sets the value of the horizontal extent for the combo box.</entry>
</row>
</tbody></tgroup>
</table>
</section>


<section id="tmthNewComboBox"><title>newComboBox (dialog object method)</title>
<para>
  <computeroutput>ComboBox</computeroutput> objects can not be instantiated by the programmer from Rexx code using a <emphasis
  role="italic">new</emphasis>() method. Rather, a combo box object is obtained by using the <link
  linkend="mthNewComboBox">newComboBox</link>() method of the <link linkend="chpDialogObject">dialog</link>
  object. The syntax is:
<programlisting>
<![CDATA[
>>-newComboBox(--id--)---------------------------><

]]>
</programlisting>
</para>
</section>  <!-- End Dialog::newComboBox() (dialog object method) -->


<section id="tmthCreateComboBox"><title>createComboBox (UserDialog method)</title>
<para>
  A combo box control can be created in the dialog template of a <link linkend="clsUserDialog">UserDialog</link>
  through the <link linkend="mthCreateComboBox">createComboBox</link> method. The basic syntax is:

<programlisting>
<![CDATA[
>>-createComboBox(-id-,--x-,--y-,--cx-,--cy-+----------+-+-------------+--)----><
                                            +-,--style-+ +-,--attrName-+

]]>
</programlisting>
</para>
</section>  <!-- End UserDialog::createComboBox() (UserDialog method) -->


<section id="tmthConnectComboBoxEvent"><title>connectComboBoxEvent (dialog object method)</title>
<para>
  To connect event notifications from a combo box  control use the <link
  linkend="mthConnectComboBoxEvent">connectComboBoxEvent</link> method of the <link
  linkend="chpDialogObject">dialog</link> object. The basic syntax is:

<programlisting> <![CDATA[
>>-connectComboBoxEvent(--id--,--event--+----------------+--)------------------><
                                        +--,-methodName--+

]]>
</programlisting>
</para>
</section>  <!-- End EventNotification::connectComboBoxEvent() (dialog object method) -->


<section id="mthAddClsComboBox"><title>add</title>
<indexterm><primary>add</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>add</secondary></indexterm>
<programlisting>
<![CDATA[
>>--add(--listEntry--)---------------------------><


]]>
</programlisting>

<para>
  The <emphasis role="italic">add</emphasis> method adds a new item to the combo box list.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The only argument is:
    <variablelist>
      <varlistentry><term>listEntry [required]</term>
      <listitem>
      <para>
        The item to add to the list.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, the one-based index of the new item. On error, a value less than 1.
  </para>
  </listitem>
  </varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the combo box does not have the SORT style, the new item is added to the end of the list. If it does have the
    SORT style, the item is inserted into the list and the combo box resorts the list.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetHorizontalExtentClsComboBox"><title>getHorizontalExtent</title>
<indexterm><primary>getHorizontalExtent</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>getHorizontalExtent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getHorizontalExtent--------------------------><

]]>
</programlisting>

<para>
  Gets the width that the list box of the combo box can be scrolled horizontally.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return value is the width in pixels of the horizontal extent.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is only applicable if the combo box has a horizontal scroll bar. A scroll bar can be added explicitly by
    using the WS_HSCROLL style with the combo box definition in the resource script for a <link
    linkend="clsRcDialog">RcDialog</link> or a <link linkend="clsResDialog">ResDialog</link>, or by using the HSCROLL
    style in the <link linkend="mthCreateComboBox">createComboBox</link> method of a <link
    linkend="clsUserDialog">UserDialog</link>.
  </para>
  <para>
    In addition, a horizontal scroll bar is added implicitly if the CBS_DISABLENOSCROLL style is used in the resource
    script. (Or the DISABLENOSCROLL style in the <emphasis role="italic">createComboBox</emphasis> method.)
  </para>
  <para>
    When the <link linkend="ovvUnderlying">underlying</link> combo box is created, it has its horizontal extend set to
    0. The <link linkend="mthSetHorizontalExtentClsComboBox">setHorizontalExtent</link> method can be used to change
    this value.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End ComboBox::getHorizontalExtent() -->

<section id="mthSetHorizontalExtentClsComboBox"><title>setHorizontalExtent</title>
<indexterm><primary>setHorizontalExtent</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>setHorizontalExtent</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setHorizontalExtent(--pixels--)--------------><

]]>
</programlisting>

<para>
  Sets the width, in pixels, that the combo box's list box can be scrolled horizontally.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>pixels [required]</term>
      <listitem>
      <para>
        Specifies the scrollable width, in pixels, of the combo box's list box.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method works whether or not the combo box has a horizontal scroll bar. However, if the combo box does not have
    a scroll bar, the user will see no difference. A scroll bar can be added explicitly by using the WS_HSCROLL style
    with the combo box definition in the resource script for a <link linkend="clsRcDialog">RcDialog</link> or a <link
    linkend="clsResDialog">ResDialog</link>, or by using the HSCROLL style in the <link
    linkend="mthCreateComboBox">createComboBox</link> method of a <link linkend="clsUserDialog">UserDialog</link>.
  </para>
  <para>
    In addition, a horizontal scroll bar is added implicitly if the CBS_DISABLENOSCROLL style is used in the resource
    script. (Or the DISABLENOSCROLL style in the <emphasis role="italic">createComboBox</emphasis> method.)
  </para>
  <para>
    When the width of the list box in the combo box is equal to or greater than the horizontal extent value, the
    horizontal scroll bar is hidden. If there are items in the combo box that are wider than the width of the list box,
    the user will not be able to see all of the item. In this case, the horizontal extent needs to be set by the
    programmer to a higher value.
  </para>
  <para>
    When the width of the list box in the combo box is smaller than the value of the horizontal extent, the horizontal
    scroll bar will horizontally scroll items in the list box.
  </para>
  <para>
    Note that if the combo box has the DISABLENOSCROLL style, instead of hiding the horizontal scroll bar when the width
    of the list box is equal to or greater than the horizontal extent, the scroll bar is disabled.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example calculates the width in pixels of the longest item added to the combo box. If this width is longer than
    the width of the combo box, then the horizontal extent is set to that width.  Otherwise the horizontal extent is not
    changed. This will have no effect unless the combo box has a horizontal scroll bar, see the Remarks section.
<programlisting>
<![CDATA[

::method initDialog
  expose comboBox comboBoxItems

  longest = .Size~new

  comboBox = self~getComboBox(IDC_CBO_ONE)
  do i over combolBoxItems
    comboBox~add(i)

    size = self~getTextSizePx(i)
    if size~width > longest~width then longest = size
  end

  -- Be sure we have a 1 pixel space at the end of the longest item.
  longest~width += 1

  if comboBox~pixelCX < longest~width then do
    comboBox~setHorizontalExtent(longest~width)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist> </section>  <!-- End ComboBox::setHorizontalExtent() -->

<section id="mthInsertClsComboBox"><title>insert</title>
<indexterm><primary>insert</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>insert</secondary></indexterm>
<programlisting>
<![CDATA[
>>--insert(--+-------+--,--item--)---------------><
             +-index-+

]]>
</programlisting>

<para>
  Inserts a new item into the list of the combo box.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>index [optional]</term>
      <listitem>
      <para>
        The one-based index of the position to add the new item. If this <emphasis role="italic">index</emphasis> is
        omitted, the item is added after the currently selected item. If there is no currently selected item, the new
        item is inserted as the last item. If <emphasis role="italic">index</emphasis> is 0 the item is inserted as the
        first item. If <emphasis role="italic">index</emphasis> is less than 0 then the new item is inserted as the last
        item
      </para>
      </listitem></varlistentry>
      <varlistentry><term>item [required]</term>
      <listitem>
      <para>
      	The item to add to the list.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Unlike the <link linkend="mthAddClsComboBox">add</link> method, if the combo box has the SORT style, the <emphasis
    role="italic">insert</emphasis> method does not cause the combo box to sort the list items.
  </para>
  <para>
    If the combo box has a horizontal scroll bar and the width of the new item is wider than the combo box, or wider
    than the current horizontal extent, the programmer should use the <link
    linkend="mthSetHorizontalExtentClsComboBox">setHorizontalExtent</link> method to ensure the scroll bar is shown and
    will scroll far enough to show the whole item.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, the one-based index of the position at which the item was been added. A number less than 1 indicates an
    error.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthDeleteClsComboBox"><title>delete</title>
<indexterm><primary>delete</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>delete</secondary></indexterm>
<programlisting>
<![CDATA[
>>--delete(--+---------+--)----------------------><
             +--index--+

]]>
</programlisting>

<para>
  Removes an item from the list in the combo box.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The only argument is:
    <variablelist>
    <varlistentry><term>index [optional]</term>
    <listitem>
    <para>
      The one-based index of the item to delete from the list. If this argument is omitted, the currently selected item
      is deleted.
    </para>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The number of items remaining in the list. -1 is returned if <emphasis role="italic">index</emphasis> is not valid.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If <emphasis role="italic">index</emphasis> is omitted and there is no selected item, no item is deleted and -1 is
    returned.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthDeleteAllClsComboBox"><title>deleteAll</title>
<indexterm><primary>deleteAll</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>deleteAll</secondary></indexterm>
<programlisting>
<![CDATA[
>>--deleteAll------------------------------------><

]]>
</programlisting>

<para>
  Removes all items from the list in a combo box.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns <computeroutput>.true</computeroutput>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthFindClsComboBox"><title>find</title>
<indexterm><primary>find</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>find</secondary></indexterm>
<programlisting>
<![CDATA[
>>--find(--textorPrefix--+--------------+--+---------+--)-------><
                         +-,-startIndex-+  +-,-exact-+


]]>
</programlisting>

<para>The find method searches the combo box for a list
entry containing the specified text or prefix. The search is caseless.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>TextorPrefix</term>
<listitem><para>The text or prefix for which the list is searched.
</para></listitem></varlistentry>
<varlistentry><term>startIndex</term>
<listitem><para>The first list item at which the search is to be started. When the search
reaches the bottom of the list, it is continued backward. If you
omit this argument or specify 0, the entire list is searched.
</para></listitem></varlistentry>
<varlistentry><term>exact</term>
<listitem><para>If you specify 1 or E, the text of the list item must exactly match
the text specified for <emphasis role="italic">TextorPrefix</emphasis>.
If you omit this argument or specify 0, the list entries are searched for a
prefix that matches <emphasis role="italic">TextorPrefix</emphasis>.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based index of the list entry that matches the search text,
or 0 if not found.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectedIndexClsComboBox"><title>selectedIndex</title>
<indexterm><primary>selectedIndex</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>selectedIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selectedIndex--------------------------------><


]]>
</programlisting>

<para>The selectedIndex method retrieves the index of
the currently selected entry of the combo box list. This entry is highlighted
and surrounded by a dotted border.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based index of the currently selected list entry, or 0 if none
is selected.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectedClsComboBox"><title>selected</title>
<indexterm><primary>selected</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>selected</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selected-------------------------------------><


]]>
</programlisting>

<para>The selected method retrieves the text of the currently
selected entry of the combo box list.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The text of the currently selected list entry, or an empty string if
none is selected.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectIndexClsComboBox"><title>selectIndex</title>
<indexterm><primary>selectIndex</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>selectIndex</secondary></indexterm>
<programlisting>
<![CDATA[
>>--selectIndex(--index--)-----------------------><


]]>
</programlisting>

<para>The selectIndex method selects the list entry at
the specified position. The currently selected list item in the combo box
is highlighted and surrounded by a dotted border.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The index (starting with 1) of the list item to be selected. If you
specify 0 for this argument, the combo box must not contain any selection.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if an error occurred or you specified 0 for
<emphasis role="italic">index</emphasis> to remove the selection.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSelectClsComboBox"><title>select</title>
<indexterm><primary>select</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>select</secondary></indexterm>
<programlisting>
<![CDATA[
>>--select(--itemText--)-------------------------><


]]>
</programlisting>

<para>The select method selects the list entry that matches
the specified text.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>ItemText</term>
<listitem><para>The text that the combo box is searched for.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>0 if an error occurred or a matching list entry was not found.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthItemsClsComboBox"><title>items</title>
<indexterm><primary>items</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>items</secondary></indexterm>
<programlisting>
<![CDATA[
>>--items----------------------------------------><


]]>
</programlisting>

<para>The items method retrieves the number of items
in the combo box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The number of items in the combo box list.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetTextClsComboBox"><title>getText</title>
<indexterm><primary>getText</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>getText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getText(--index--)---------------------------><


]]>
</programlisting>

<para>The getText method gets the text of the list item
at the specified position in the combo box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The one-based index of the combo box item containing the text you are
interested in.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The text of the combo box item at the given position, or an empty string
if the <emphasis role="italic">index</emphasis> does not refer to an
item or an error occurred.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthModifyClsComboBox"><title>modify</title>
<indexterm><primary>modify</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>modify</secondary></indexterm>
<programlisting>
<![CDATA[
>>--modify(--index--,--newText--)----------------><


]]>
</programlisting>

<para>The modify method changes the text of the list
item at the specified position in the combo box.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>index</term>
<listitem><para>The one-based index of the combo box item of which the text is to be
changed. If you omit this argument, the currently selected item is modified.
</para></listitem></varlistentry>
<varlistentry><term>newText</term>
<listitem><para>The new text string to be displayed at the given position.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The one-based index of the modified combo box item at the given position.
The return value is 0 if an error occurred, or -1 if the
<emphasis role="italic">index</emphasis> does not refer to an item.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthAddDirectoryClsComboBox"><title>addDirectory</title>
<indexterm><primary>addDirectory</primary><secondary>ComboBox class</secondary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>addDirectory</secondary></indexterm>
<programlisting>
<![CDATA[

>>--addDirectory(--filePattern--+-------------------+--)--------><
                                +-,-fileAttributes--+

]]>
</programlisting>

<para>
  Adds the names of all files matching <emphasis role="italic">filePattern</emphasis> that have the optionally specified
  file attributes to the combo box.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>filePattern [required]</term>
      <listitem>
      <para>
        A file name pattern of files to search for. For example, <computeroutput>C:\Program Files\*.exe</computeroutput>, or
        <computeroutput>C:\temp\*.txt</computeroutput>. The <emphasis role="italic">fileAttributes</emphasis> argument can
        be used to further restrict the types of files searched for. All matching file names are added to the combo box.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fileAttributes [optional]</term>
      <listitem>
      <para>
        A list of 0 or more of the following keywords separated by spaces, case is not significant. The keywords specify the
        file attributes the files must possess in order to be added to the combo box:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>READWRITE</member>
          <member>READONLY </member>
          <member>HIDDEN   </member>
          <member>SYSTEM   </member>
          <member>DIRECTORY</member>
          <member>ARCHIVE  </member>
          <member>EXCLUSIVE</member>
          <member>DRIVES   </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>READWRITE</term>
          <listitem>
          <para>
            Includes read write files with no additional attributes. This is the default if the <emphasis
          role="italic">fileAttributes</emphasis> argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>READONLY</term>
          <listitem>
          <para>
            Includes read-only files.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HIDDEN</term>
          <listitem>
          <para>
            Includes hidden files.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SYSTEM</term>
          <listitem>
          <para>
            Includes system files.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DIRECTORY</term>
          <listitem>
          <para>
            Includes subdirectories. The subdirectory names are enclosed in square brackets ([ ]) when they are added
            to the combo box.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ARCHIVE</term>
          <listitem>
          <para>
            Includes archived files.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>EXCLUSIVE</term>
          <listitem>
          <para>
            Includes only the files with the specified attributes. By default, read write files are listed even if
            READWRITE is not specified.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DRIVES</term>
          <listitem>
          <para>
            Mapped drives are also added to the list. The drives names are added in the form [-D-], where D is the
            drive letter.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The one-based index of the file name added last to the combo box, or less than 1 if an error occurred.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">filePattern</emphasis> argument can be a file name, relative path, or absolute path. It
    can contain the normal file name wildcard characters. Absolute paths can begin with a drive letter or use Universal
    Naming Convention (UNC).  I.e. <computeroutput>D:\</computeroutput> or
    <computeroutput>\\server\share</computeroutput>.
  </para>
  <para>
    If a file or directory name matches the file pattern and has the attributes specified by <emphasis
    role="italic">fileAttributes</emphasis> it is added to the list displayed by the combo box.
  </para>
  <para>
    <emphasis role="bold">Note</emphasis> that the operating system searches for and adds the files to the combo box.
    What files are found and how they are displayed is up to the operating system. ooDialog has no control over that.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example puts the names of all the read/write files with extension
    <computeroutput>.rex</computeroutput> in the <computeroutput>C:\work.ooRexx</computeroutput> directory into the
    combo box:

<programlisting>
<![CDATA[

  cb = self~newComboBox(IDC_CB_FILES)
  self~addDirectory("C:\work.ooRexx\*.rex", "READWRITE")
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthOpenDropDown"><title>openDropDown</title>
<indexterm><primary>openDropDown</primary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>openDropDown</secondary></indexterm>
<programlisting>
<![CDATA[
>>--openDropDown---------------------------------><


]]>
</programlisting>

<para>
  Shows the drop down list box of a drop-down combo box or a drop-down list combo box. This method has no effect on
  simple combo boxes.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns <computeroutput>.true</computeroutput>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthCloseDropDown"><title>closeDropDown</title>
<indexterm><primary>closeDropDown</primary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>closeDropDown</secondary></indexterm>
<programlisting>
<![CDATA[
>>--closeDropDown--------------------------------><

]]>
</programlisting>

<para>
  Closes the drop down list box of a drop-down combo box or a drop-down list combo box. This method has no effect on
  simple combo boxes.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method always returns <computeroutput>.true</computeroutput>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthIsDropDownOpen"><title>isDropDownOpen</title>
<indexterm><primary>isDropDownOpen</primary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>isDropDownOpen</secondary></indexterm>
<programlisting>
<![CDATA[
>>--isDropDownOpen-------------------------------><


]]>
</programlisting>

<para>
  Determines whether the list box of the combo box dropped down.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> if the list box is dropped down, otherwise
    <computeroutput>.fase</computeroutput>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

<section id="mthEditSelection"><title>editSelection</title>
<indexterm><primary>editSelection</primary></indexterm>
<indexterm><primary>ComboBox class</primary><secondary>editSelection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--editSelection(--startIndex--,--endIndex--)---><


]]>
</programlisting>

<para>
  The <emphasis role="italic">editSelection</emphasis> method selects the specified text range in the
  edit control of the associated combo box.  This method is not applicable for drop-down list combo boxes, it is
  only for simple and drop-down combo boxes.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>startIndex</term>
<listitem><para>
  The one-based index of the first character in the edit control to be selected. If you omit this argument or
  specify 0, the selection, if any, is removed.
</para></listitem></varlistentry>
<varlistentry><term>endIndex</term>
<listitem><para>
  The one-based index of the last character in the edit control to be selected. If you omit this argument or
  specify 0, the selection is extended from the start character to the end of the text.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>
  This method always returns 0, unless the combo box is a drop-down list.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>
  The combo box is a drop-down list combo box.  This method has no effect on a drop-down list combo box because it
  does not have an edit control.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>
</chapter>
