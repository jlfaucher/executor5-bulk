<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2005-2012, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter id="clsMonthCalendar" xreflabel="MonthCalendar"><title>Month Calendar Controls</title>
<indexterm><primary>MonthCalendar class</primary></indexterm>
<para>
  A month calendar control provides an easy to use interface that allows users to select or enter dates. The control has
  the appearence of a typical calendar. The month calendar interface allows the user to select a date from the displayed
  days or change the control's display in various ways. The appearence of month calendar controls differ slightly
  between different versions of Windows.
</para>
<para>
  The <computeroutput>MonthCalendar</computeroutput> object can not be used for dates prior to 1601 because Windows does
  not support dates prior to 1601. The month calendar control is based on the Gregorian calendar, which was introduced
  in 1753. It will not calculate dates that are consistent with the Julian calendar that was in use prior to 1753.
</para>
<para>
  The <computeroutput>MonthCalendar</computeroutput> class provides methods that allow access to all the capabilities of
  the underlying Windows month calendar control, including the features available only on Windows Vista and Windows 7.
  To use the Windows Vista features, the Rexx program must be running on Vista or later. Likewise, to use Windows 7
  features, the Rexx program must be running a Windows 7, or later, system.
</para>
<para>
  In addition to the methods of the class itself, the following methods from other classes in the ooDialog framework are
  needed, or are useful, when working with month calendar controls:
<variablelist>
  <varlistentry><term><emphasis role="bold">Instantiation:</emphasis></term>
  <listitem>
  <para>
    Use the <xref linkend="mthNewMonthCalendar"/> method to retrieve an object of the
    <computeroutput>MonthCalendar</computeroutput> class.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Dynamic Definition:</emphasis></term>
  <listitem>
  <para>
    To dynamically create a month calendar control in the template of an <xref linkend="clsUserDialog"/>, use the
    <xref linkend="mthCreateMonthCalendar"/> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Event Notification</emphasis></term>
  <listitem>
  <para>
    To receive notification of month calendar events use the
    <xref linkend="mthConnectMonthCalendarEvent"/>) method.
  </para>
  <para>
    One of the month calendar event notifications, the <xref linkend="evtMonthCalendarGETDAYSTATE"/>
    notification, requires that a buffer of day states be returned in reply. The Rexx programmer can not construct the
    proper buffer in Rexx code. The <xref linkend="clsDayState"/> and <xref linkend="clsDayStates"/> classes are
    provided to help manage day states and to construct the proper buffer.
  </para>
  </listitem></varlistentry>
</variablelist>
</para>

<section id="sctMethodsMonthCalendar"><title>Method Table</title>
<para>
  The following table provides links to the documentation for the primary methods and attributes used in working
  with <computeroutput>MonthCalendar</computeroutput> objects, including other relevant classes and methods from other
  classes:
</para>
<table id="tblMonthCalendarMethods" frame="all">
<title>MonthCalendar Methods and Attributes</title>
<tgroup cols="2">
<colspec colwidth="1*+4pc"/><colspec colwidth="3*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry align="center"><emphasis role="bold">Useful External Classes</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="clsDayState"/></entry>
<entry>Represents the state of each day in a month.</entry>
</row>
<row>
<entry><xref linkend="clsDayStates"/></entry>
<entry>Manages <computeroutput>DayState</computeroutput> objects and constructs buffers of day states.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Useful External Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="tmthNewMonthCalendar"/></entry>
<entry>Obtains a MonthCalendar object that represents a control in a dialog.</entry>
</row>
<row>
<entry><xref linkend="tmthCreateMonthCalendar"/></entry>
<entry>Creates a MontCalendar control in an <xref linkend="clsUserDialog"/></entry>
</row>
<row>
<entry><xref linkend="tmthConnectMonthCalendarEvent"/></entry>
<entry>Connects MonthCalendar event notifications to a Rexx dialog method.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Attributes</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="atrDate"/></entry>
<entry>Reflects the currently selected date in the calendar.</entry>
</row>
<row>
<entry align="center"><emphasis role="bold">Instance Methods</emphasis></entry>
<entry align="center"><emphasis role="bold"></emphasis></entry>
</row>
<row>
<entry><xref linkend="mthAddStyleClsMC"/></entry>
<entry>Adds the specified month calendar style(s) to the control.</entry>
</row>
<row>
<entry><xref linkend="mthGetCalendarBorder"/></entry>
<entry>Retrieves the month calendar's border, in pixels.</entry>
</row>
<row>
<entry><xref linkend="mthGetCalendarCount"/></entry>
<entry>Gets the number of calendars currently displayed in the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetCALID"/></entry>
<entry>Returns a keyword specifying the current calendar ID for the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetColor"/></entry>
<entry>Retrieves the color for a given portion of a month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetCurrentView"/></entry>
<entry>Returns a keyword specifying the current view for the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetFirstDayOfWeek"/></entry>
<entry>Returns the first day of the week, as a whole number, for the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetGridInfo"/></entry>
<entry>Gets information about a calendar grid in the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetMaxSelection"/></entry>
<entry>Retrieves the maximum date range that can be selected in the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetMaxTodayWidth"/></entry>
<entry>Retrieves the maximum width of the <emphasis role="italic">today</emphasis> string in the month calendar control</entry>
</row>
<row>
<entry><xref linkend="mthGetMinRect"/></entry>
<entry>Fills in a <xref linkend="clsRect"/> object with the minimum size required to display a full month in the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetMonthDelta"/></entry>
<entry>Returns the scroll rate for the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetMonthRange"/></entry>
<entry>Retrieves date information that represents the high and low limits of a month calendar control's display.</entry>
</row>
<row>
<entry><xref linkend="mthGetRangeClsMC"/></entry>
<entry>Gets the current minimum and maximum allowable dates for the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetSelectionRange"/></entry>
<entry>Retrieves date information for the upper and lower limits of the current range selected by the user in a multi-selection month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetStyleClsMC"/></entry>
<entry>Returns the current style of the specified month calendar control as list of style keywords.</entry>
</row>
<row>
<entry><xref linkend="mthGetToday"/></entry>
<entry>Retrieves the date information for the date specified as <emphasis role="italic">today</emphasis> for the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthHitTest"/></entry>
<entry>Determines which portion of a month calendar control is at a given point on the screen.</entry>
</row>
<row>
<entry><xref linkend="mthRemoveStyleClsMC"/></entry>
<entry>Removes the specified month calendar style(s) from the control.</entry>
</row>
<row>
<entry><xref linkend="mthReplaceStyleClsMC"/></entry>
<entry>Removes some existing month calendar style(s) and adds some new style(s).</entry>
</row>
<row>
<entry><xref linkend="mthSetCalendarBorder"/></entry>
<entry>Sets the size, in pixels, of the month calendar  control's border.</entry>
</row>
<row>
<entry><xref linkend="mthSetCALID"/></entry>
<entry>Sets the calendar ID for the calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetColorClsMonthCalendar"/></entry>
<entry>Sets the color for a given part of a month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetCurrentView"/></entry>
<entry>Sets the view for the month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetDayState"/></entry>
<entry>Sets the day states for all months that are currently visible within a month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetDayStateQuick"/></entry>
<entry>Sets the day states for 3 months that are currently visible within a month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetFirstDayOfWeek"/></entry>
<entry>Sets the first day of the week for a month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetMaxSelection"/></entry>
<entry>Sets the maximum number of days that can be selected in a multi-selection month calendar control</entry>
</row>
<row>
<entry><xref linkend="mthSetMonthDelta"/></entry>
<entry>Sets the number of months that the month calendar control moves its display when the user clicks a scroll button.</entry>
</row>
<row>
<entry><xref linkend="mthSetRangeClsMC"/></entry>
<entry>Sets the minimum and maximum allowable dates for a month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetSelectionRange"/></entry>
<entry>Sets the selection for a month calendar control to a given date range.</entry>
</row>
<row>
<entry><xref linkend="mthSetToday"/></entry>
<entry>Sets the <emphasis role="italic">today</emphasis> selection for a month calendar control.</entry>
</row>
<row>
<entry><xref linkend="mthSizeRectToMin"/></entry>
<entry>Calculates how many calendars will fit in the given rectangle and returns the minimum size a rectangle needs to be to fit the calendars.</entry>
</row>
</tbody></tgroup>
</table>
</section>


<section id="tmthNewMonthCalendar" xreflabel="new"><title>newMonthCalendar (dialog object method)</title>
<para>
  <computeroutput>MonthCalendar</computeroutput> objects can not be instantiated by the programmer from Rexx code using
  a <emphasis role="italic">new</emphasis>() method. Rather, a month calendar object is obtained by using the
  <xref linkend="mthNewMonthCalendar"/> method of the <xref linkend="chpDialogObject"/> object. The syntax is:
<programlisting>
<![CDATA[
>>-newMonthCalendar(--id--+-------------+--)-----><
                          +-,--category-+

]]>
</programlisting>
</para>
</section>  <!-- End Dialog::newMonthCalendar() (dialog object method) -->


<section id="tmthCreateMonthCalendar" xreflabel="createMonthCalendar"><title>createMonthCalendar (UserDialog method)</title>
<para>
  A <computeroutput>MonthCalendar</computeroutput> object can be added to the dialog template in a <xref
  linkend="clsUserDialog"/> through the <xref linkend="mthCreateMonthCalendar"/> method. The basic syntax is:

<programlisting>
<![CDATA[
>>-createMonthCalendar(-id-,--x-,--y-,--cx-,--cy-+----------+-+-------------+--><
                                                 +-,--style-+ +-,--attrName-+

]]>
</programlisting>
</para>
</section>  <!-- End UserDialog::createMonthCalendar() (UserDialog method) -->


<section id="tmthConnectMonthCalendarEvent" xreflabel="connectMonthCalendarEvent">
<title>connectMonthCalendarEvent (dialog object method)</title>
<para>
  To connect event notifications from a month calendar control use the
  <xref linkend="mthConnectMonthCalendarEvent"/> method of the
  <xref linkend="chpDialogObject"/> object. The basic syntax is:

<programlisting> <![CDATA[
>>-connectMonthCalendarEvent(--id--,--event--+----------------+--)-------------><
                                             +--,-methodName--+

]]>
</programlisting>
</para>
</section>  <!-- End EventNotification::ConnectMonthCalendarEvent() (dialog object method) -->

<section id="atrDate" xreflabel="date"><title>date (Attribute)</title>
<indexterm><primary>date</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>date</secondary></indexterm>
<programlisting>
<![CDATA[
>>--date-----------------------------------------><

>>--date=varName---------------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">date</emphasis> attribute reflects the currently selected date in the month calendar
  control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">date get:</emphasis></term>
  <listitem>
  <para>
    The value of the <emphasis role="italic">date</emphasis> attribute is a <computeroutput>DateTime</computeroutput>
    object that reflects the currently selected date in the control. The time portion of the
    <computeroutput>DateTime</computeroutput> object has no meaning. For multi-selection month calendar controls, the
    date is the first selected date in the range of selected dates.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">date set:</emphasis></term>
  <listitem>
  <para>
    A <computeroutput>DateTime</computeroutput> object must be used to set the <emphasis role="italic">date</emphasis>
    attribute. The time portion of the <computeroutput>DateTime</computeroutput> object is ignored. When the <emphasis
    role="italic">date</emphasis> attribute is assigned a new value, the currently selected date in the underlying
    control is updated to reflect the value of the attribute. With multi-selection month calendar controls, when the
    <emphasis role="italic">date</emphasis> attribute is assigned a new value, both the start and end of the selected
    range are updated to reflect the new value.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">date</emphasis> attribute is most useful when used with single-selection month calendar
    controls. For multi-selection controls, use the <xref linkend="mthGetSelectionRange"/> and
    <xref linkend="mthSetSelectionRange"/> methods to work with the full range of selected dates.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example initializes a month calendar control with a currently selected date 10 years prior to the current
    day.

<programlisting>
<![CDATA[

::method initDialog

  mc = self~newMonthCalendar(IDC_MC)
  mc~date = .DateTime~new~addYears(-10)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::date() [attribute]  -->

<section id="mthAddStyleClsMC" xreflabel="addStyle"><title>addStyle</title>
<indexterm><primary>addStyle</primary><secondary>MonthCalendar class</secondary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>addStyle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--addStyle(--styles--)-------------------------><

]]>
</programlisting>

<para>
  Adds the specified month calendar style(s) to the control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>style [required]</term>
    <listitem>
    <para>
      A list of 1 or more of the following month calendar style keywords, separated by spaces, case is not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>DAYSTATE   </member>
        <member>MULTI      </member>
        <member>NOTODAY    </member>
        <member>NOCIRCLE   </member>
        <member>WEEKNUMBERS</member>
        <member>NOTRAILING </member>
        <member>SHORTDAYS  </member>
        <member>NOSELCHANGE</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>DAYSTATE</term>
        <listitem>
        <para>
          The month calendar will send the GETDAYSTATE <xref linkend="ovvEvents"/> notification to request
          information about which days should be displayed in bold. Use the
          <xref linkend="mthConnectMonthCalendarEvent"/> method to connect this notification
          with a method in the Rexx dialog object.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MULTI</term>
        <listitem>
        <para>
          This style allows the user to select a range of dates within the control. By default, the maximum range is one
          week. The programmer changes the maximum range that can be selected by using the
          <xref linkend="mthSetRangeClsDTP"/> method.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTODAY</term>
        <listitem>
        <para>
          The month calendar control will not display the <emphasis role="italic">today</emphasis> date at the bottom of the control.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOCIRCLE</term>
        <listitem>
        <para>
          The month calendar control will not circle the <emphasis role="italic">today</emphasis> date at the bottom of
          the control.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>WEEKNUMBERS</term>
        <listitem>
        <para>
          The month calendar displays week numbers (1-52) to the left of each row of days. Week 1 is defined by
          Microsoft as the first week that contains at least four days.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTRAILING</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. This style disables displaying the dates
          from the previous / next month in the current calendar.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SHORTDAYS</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style, the month calendar uses the
          shortest day name for the label of the day of the week column header.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOSELCHANGE</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style the selection does not
          change when the user navigates to the next or previous month in the calendar. This style is needed for the
          user to be able to select a range greater than what is currently displayed.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A list of month calendar style keywords, separated by spaces, that was the style of the month calendar control
    before the <emphasis role="italic">replaceStyle</emphasis> method was invoked. The list could be empty if the
    previous style was the default month calendar style.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode" /> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example adds the NOSELCHANGE style to the calendar, provide the Rexx program is running on Vista or later.
<programlisting>
<![CDATA[

::method initDialog

  ...

  if .OS~isAtLeastVista then do
    mc = self~newMonthCalendar(IDC_MC)
    mc~addStyle("NOSELCHANGE")
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::addStyle() -->

<section id="mthGetCalendarBorder" xreflabel="getCalendarBorder"><title>getCalendarBorder</title>
<indexterm><primary>getCalendarBorder</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getCalendarBorder</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCalendarBorder----------------------------><

]]>
</programlisting>

<para>
  Retrieves the month calendar's border, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is the width of the month calendar border in pixels.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getCalendarBorder() -->


<section id="mthGetCalendarCount" xreflabel="getCalendarCount"><title>getCalendarCount</title>
<indexterm><primary>getCalendarCount</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getCalendarCount</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCalendarCount-----------------------------><

]]>
</programlisting>

<para>
  Gets the number of calendars currently displayed in the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method does not use any arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the number of calendars displayed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getCalendarCount() -->

<section id="mthGetCALID" xreflabel="getCALID"><title>getCALID</title>
<indexterm><primary>getCalID</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getCalID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCalID-------------------------------------><

]]>
</programlisting>

<para>
  Returns a keyword specifying the current calendar ID for the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments to this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A calendar ID keyword. The possible keywords and Microsoft's explanations for the keywords are listed in the Remarks
    section.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This table lists the keywords that might be returned from this method:
  </para>
  <table id="tblCalendarIDs" frame="all">
  <title>Calendar IDs</title>
  <tgroup cols="2">
  <colspec colwidth="1*" />
  <colspec colwidth="2*" />
  <thead>
  <row>
  <entry>ID Keyword</entry>
  <entry>Description</entry>
  </row>
  </thead>
  <tbody>
  <row>
  <entry>GREGORIAN</entry>
  <entry>Gregorian (localized)</entry>
  </row>
  <row>
  <entry>GREGORIAN_US</entry>
  <entry>Gregorian (English strings always</entry>
  </row>
  <row>
  <entry>JAPAN</entry>
  <entry>Japanese Emperor Era</entry>
  </row>
  <row>
  <entry>TAIWAN</entry>
  <entry>Taiwan calendar</entry>
  </row>
  <row>
  <entry>KOREA</entry>
  <entry>Korean Tangun Era</entry>
  </row>
  <row>
  <entry>HIJRI</entry>
  <entry>Hijri (Arabic Lunar)</entry>
  </row>
  <row>
  <entry>THAI</entry>
  <entry>Thai</entry>
  </row>
  <row>
  <entry>HEBREW</entry>
  <entry>Hebrew (Lunar)</entry>
  </row>
  <row>
  <entry>GREGORIAN_ME_FRENCH</entry>
  <entry>Gregorian Middle East French</entry>
  </row>
  <row>
  <entry>GREGORIAN_ARABIC</entry>
  <entry>Gregorian Arabic</entry>
  </row>
  <row>
  <entry>CAL_GREGORIAN_XLIT_ENGLISH</entry>
  <entry>Gregorian transliterated English</entry>
  </row>
  <row>
  <entry>CAL_GREGORIAN_XLIT_FRENCH</entry>
  <entry>Gregorian transliterated French</entry>
  </row>
  <row>
  <entry>UMALQURA</entry>
  <entry>Um Al Qura (Arabic lunar) calendar </entry>
  </row>
  </tbody></tgroup>
  </table>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getCalID() -->


<section id="mthGetColor" xreflabel="getColor"><title>getColor</title>
<indexterm><primary>getColor</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getColor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getColor(--calendarPart--)-------------------><

]]>
</programlisting>

<para>
  Retrieves the color for a given portion of a month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>calendarPart [required]</term>
    <listitem>
    <para>
      A single keyword specifying which part of the calendar to get the color for, case is not significant. The valid
      keywords are:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>BACKGROUND  </member>
        <member>MONTHBK     </member>
        <member>TEXT        </member>
        <member>TITLEBK     </member>
        <member>TITLETEXT   </member>
        <member>TRAILINGTEXT</member>
        <member></member>
      </simplelist>
      <variablelist>
        <varlistentry><term>BACKGROUND</term>
        <listitem>
        <para>
          Retrieves the background color displayed between months.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MONTHBK</term>
        <listitem>
        <para>
          Retrieves the background color displayed within the month.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TEXT</term>
        <listitem>
        <para>
          Retrieves the color used to display text within a month.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TITLEBK</term>
        <listitem>
        <para>
          Retrieves the background color displayed in the calendar's title.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TITLETEXT</term>
        <listitem>
        <para>
          Retrieves the color used to display text within the calendar's title.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TRAILINGTEXT</term>
        <listitem>
        <para>
          Retrieves the color used to display header day and trailing day text. Header and trailing days are the days
          from the previous and following months that appear on the current month calendar.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns a COLORREF representing the color setting for the part of the month calendar control specified.
    returns CLR_INVALID on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <xref linkend="clsImage"/> class has a number of convenience methods for working with COLORREFs,
    including the <xref linkend="mthColorRef"/> method that explains what a COLORREF is.
  </para>
  <para>
    The <emphasis role="italic">colorRef</emphasis> method can be used to test the return for error. I.e.:
    <computeroutput>.Image~colorRef(CLR_INVALID)</computeroutput>. (An error is not very likely.)
  </para>
  <para>
    Note that many of the underlying dialog controls ignore their color settings when visual themes are enabled, unless
    the theme is Windows Clasic. This is the case for the month calendar control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the color for the head and trailing day text, and checks for an error.
<programlisting>
<![CDATA[

  monthCalendar = self~newMonthCalendar(IDC_MC)
  invalid = .Image~colorRef(CLR_INVALID)

  color = monthCalendar~getColor("TRAILINGTEXT")
  if color == invalid then do
    -- Fill in with some error routine.
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getColor() -->


<section id="mthGetCurrentView" xreflabel="getCurrentView"><title>getCurrentView</title>
<indexterm><primary>getCurrentView</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getCurrentView</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getCurrentView-------------------------------><

]]>
</programlisting>

<para>
  Returns a keyword specifying the current view for the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method does not have any arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return will be exactly one of the following keywords describing the current view: <emphasis
    role="italic">Monthly</emphasis>, <emphasis role="italic">Annual</emphasis>, <emphasis
    role="italic">Decade</emphasis>, or <emphasis role="italic">Century</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors if incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getCurrentView() -->


<section id="mthGetFirstDayOfWeek" xreflabel="getFirstDayOfWeek"><title>getFirstDayOfWeek</title>
<indexterm><primary>getFirstDayOfWeek</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getFirstDayOfWeek</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getFirstDayOfWeek(--+--------+--)------------><
                        +--info--+
]]>
</programlisting>

<para>
  Returns the first day of the week, as a whole number, for the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>info [optional]</term>
    <listitem>
    <para>
      A <computeroutput>Directory</computeroutput> object in which additional information is returned.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns a whole number that represents the first day of the week, where 0 is Monday, 1 is Tuesday, and so on.
  </para>
  <para>
    If the optional <emphasis role="italic">info</emphasis> argument is supplied, the
    <computeroutput>Directory</computeroutput> object will contain the following indexes on return:
  </para>
  <variablelist>
    <varlistentry><term>DAY</term>
    <listitem>
    <para>
      The numerical first day of the week. This is the same value as the return value of the method.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>USINGLOCALE</term>
    <listitem>
    <para>
      True if the calendar is using the localized first day of the week, false if the first day of the week has been set
      to something other than the localized first day of the week.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>DAYNAME</term>
    <listitem>
    <para>
      The english name of the day corresponding to first day of the week.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getFirstDayOfWeek() -->


<section id="mthGetGridInfo" xreflabel="getGridInfo"><title>getGridInfo</title>
<indexterm><primary>getGridInfo</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getGridInfo</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getGridInfo(--info--)------------------------><

]]>
</programlisting>

<para>
  Gets information about a calendar grid in the month calendar control. A <computeroutput>Directory</computeroutput>
  object with indexes specifying the information requested is passed into the method. On return, the
  <computeroutput>Directory</computeroutput> object contains indexes with the information requested.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>info [required] [in / out]</term>
      <listitem>
      <para>
        A <computeroutput>Directory</computeroutput> object. On input, the object contains the following indexes
        specifying the information needed:
      </para>
      <variablelist>
        <varlistentry><term>PART [required]</term>
        <listitem>
        <para>
          A single keyword, specifying which part of the calendar the information is requested for. The following keywords
          are accepted, case is not significant:
        </para>
        <para>
          <simplelist type='vert' columns='3'>
            <member>CONTROL </member>
            <member>NEXT    </member>
            <member>PREV    </member>
            <member>FOOTER  </member>
            <member>CALENDAR</member>
            <member>HEADER  </member>
            <member>BODY    </member>
            <member>ROW     </member>
            <member>CELL    </member>
          </simplelist>
          <variablelist>
            <varlistentry><term>CONTROL</term>
            <listitem>
            <para>
              The entire month calendar control, which may include up to 12 calendars.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>NEXT</term>
            <listitem>
            <para>
              The next button.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>PREV</term>
            <listitem>
            <para>
              The previous button.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>FOOTER</term>
            <listitem>
            <para>
              The footer.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>CALENDAR</term>
            <listitem>
            <para>
              One specific calendar. The value of the INDEX index specifies which calendar.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>HEADER</term>
            <listitem>
            <para>
              The calendar header. The value of the INDEX index specifies which calendar.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>BODY</term>
            <listitem>
            <para>
              The calendar body. The value of the INDEX index specifies which calendar.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>ROW</term>
            <listitem>
            <para>
              A given calendar row. The value of the INDEX index specifies which calendar.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>CELL</term>
            <listitem>
            <para>
              A given calendar cell. The value of the INDEX index specifies which calendar.
            </para>
            </listitem></varlistentry>
          </variablelist>
        </para>
        </listitem></varlistentry>
        <varlistentry><term>WHAT [required]</term>
        <listitem>
        <para>
          A list of one or more of the following keywords, specifying what information (what indexes) will be filled in
          for the calendar part specified in the PART index. Case is not significant:
        </para>
        <para>
          <simplelist type='vert' columns='3'>
            <member>DATE </member>
            <member>RECT </member>
            <member>NAME </member>
          </simplelist>
          <variablelist>
            <varlistentry><term>DATE</term>
            <listitem>
            <para>
              The STARTDATE and ENDDATE indexes will be present and contain valid values.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>RECT</term>
            <listitem>
            <para>
              The RECT index will be present.
            </para>
            </listitem></varlistentry>
            <varlistentry><term>NAME</term>
            <listitem>
            <para>
              The NAME index will be present.
            </para>
            </listitem></varlistentry>
          </variablelist>
        </para>
        </listitem></varlistentry>
        <varlistentry><term>INDEX [optional]</term>
        <listitem>
        <para>
          Specifies the one-based index of the calendar the requested information is for. Used when the PART index
          specifies CALENDAR, HEADER, BODY, ROW, or CELL. If omitted, the default is 1.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ROW [optional]</term>
        <listitem>
        <para>
          If the PART keyword is ROW, specifies the row for which to return information.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>COL [optional]</term>
        <listitem>
        <para>
          If the PART keyword is CELL, specifies the column of the cell for which to return information. The ROW index
          provides the row of the cell for which to return information.
        </para>
        </listitem></varlistentry>
      </variablelist>
      <para>
        On a successful return the <computeroutput>Directory</computeroutput> object contains the following indexes,
        dependent on the information requested:
      </para>
      <variablelist>
        <varlistentry><term>SELECTED</term>
        <listitem>
        <para>
          If PART is CELL, indicates if the cell described by the values in the ROW and COL is currently selected. The
          value of the SELECTED index will be <computeroutput>.true</computeroutput> if the cell is selected and
          <computeroutput>.false</computeroutput> if it is not.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>STARTDATE</term>
        <listitem>
        <para>
          Contains a <computeroutput>DateTime</computeroutput> object representing the start date of the Calendar
          specified by INDEX index. Only valid when the WHAT index contains the DATE keyword.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ENDDATE</term>
        <listitem>
        <para>
          Contains a <computeroutput>DateTime</computeroutput> object representing the end date of the Calendar
          specified by INDEX index. Only set when the WHAT index contains the DATE keyword.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RECT</term>
        <listitem>
        <para>
          A <xref linkend="clsRect"/> object containing the dimensions of the calendar part specified in the
          PART index. Only set when the WHAT index contains the RECT keyword.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NAME</term>
        <listitem>
        <para>
           Set only if the WHAT index contains the NAME keyword, and only for the following PART keywords:
        </para>
        <variablelist>
          <varlistentry><term>CALENDAR:</term>
          <listitem>
          <para>
            Returns the text of the selected dates. In the case of multiple selection, returns the text for the date at
            the start of the selection.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CELL:</term>
          <listitem>
          <para>
            Returns the text of the cell indicated by ROW and COL indexes, for instance <emphasis
            role="italic">15</emphasis>, if the 15th day was specified.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HEADER:</term>
          <listitem>
          <para>
            Returns the text in the calendar header, for instance <emphasis role="italic">March 1951</emphasis>.
          </para>
          </listitem></varlistentry>
        </variablelist>
        </listitem></varlistentry>
      </variablelist>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    True on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This contrived example determines the date of the cell at row 2, column 3 in the second displayed calendar, if there
    is a second calendar.  It also determines if the cell is selected and its dimensions:
<programlisting>
<![CDATA[

  if .OS~isAtLeastVista then do
    mc = self~newMonthCalendar
    if mc~getCalendarCount >= 2 then do
      info = .directory~new
      info~part = "CELL"
      info~what = "RECT NAME"
      info~index = 2
      info~row  = 2
      info~col  = 3

      if mc~getGridInfo(info) then do
        selectedWords = "is not selected,"
        if info~selected then selectedWords = "is selected."

        width  = info~rect~right - info~rect~left
        height = info~rect~bottom - info~rect~top

        say "The date of the day at row 2, column 3 in the second calendar is" info~name"."
        say "The day" selectedWords
        say "The day is at ("info~rect~left"," info~rect~top")" on the screen."
        say "It is" width "pixels wide and" height "pixels high."
      end
      else do
        say "Unexpected failure of getGridInfo()."
      end
    end
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getGridInfo() -->


<section id="mthGetMaxSelection" xreflabel="getMaxSelection"><title>getMaxSelection</title>
<indexterm><primary>getMaxSelection</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getMaxSelection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMaxSelection------------------------------><

]]>
</programlisting>

<para>
  Retrieves the maximum date range that can be selected in the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    There are no arguments for this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the total number of days that can be selected for the month calendar control.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The maximum date range that can be selected can be changed by using the
    <xref linkend="mthSetMaxSelection"/> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getMaxSelection() -->


<section id="mthGetMaxTodayWidth" xreflabel="getMaxTodayWidth"><title>getMaxTodayWidth</title>
<indexterm><primary>getMaxTodayWidth</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getMaxTodayWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMaxTodayWidth-----------------------------><

]]>
</programlisting>

<para>
  Retrieves the maximum width of the <emphasis role="italic">today</emphasis> string in the month calendar control,
  which includes the date and label text.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method does not have any arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the width of the today string in pixels
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getMaxTodayWidth() -->


<section id="mthGetMinRect" xreflabel="getMinRect"><title>getMinRect</title>
<indexterm><primary>getMinRect</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getMinRect</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMinRect(--rect--)-------------------------><

]]>
</programlisting>

<para>
  Fills in a <xref linkend="clsRect"/> object with the minimum size required to display a full month in the
  month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>rect [required]</term>
    <listitem>
    <para>
      A <computeroutput>Rect</computeroutput> object in which to return the minimum size.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    If the method succeeds, <computeroutput>.true</computeroutput> is returned, otherwise
    <computeroutput>.false</computeroutput>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The minimum required size for the month calendar control depends on things like the current font, the style in
    effect for the month calendar, etc.. If the application changes anything that will affect the minimum size, the
    programmer should use the <emphasis role="italic">getMinRect</emphasis> method to recalculate the minimum size.
  </para>
  <para>
    <emphasis role="bold">Note</emphasis> that the rectangle returned will not include the width of the <emphasis
    role="italic">Today</emphasis> string. If the month calendar does not have the NOTODAY style set, the programmer
    should also get the <emphasis role="italic">Today</emphasis> string width by using the
    <xref linkend="mthGetMaxTodayWidth"/> method. For the width portion of the minimum required size,
    use the larger of the value reported by <emphasis role="italic">getMaxTodayWidth</emphasis> and the value reported
    by <emphasis role="italic">getMinRect</emphasis>. This will ensure that the <emphasis role="italic">
    Today</emphasis> string is not clipped..
  </para>
  <para>
    The <emphasis role="italic">top</emphasis> and <emphasis role="italic">left</emphasis> of the
    <computeroutput>Rect</computeroutput> object will always be 0. The <emphasis role="italic">right</emphasis> and
    <emphasis role="italic">bottom</emphasis> of the <computeroutput>Rect</computeroutput> object will contain the
    minimum width and height required for the month calendar.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example resizes a month calendar control to the minimum required size. The position of the control, i.e., the
    upper left hand corner, remains unchanged.
<programlisting>
<![CDATA[

::method sizeCalendar private
  use strict arg calendar

  r = .Rect~new
  if calendar~getMinRect(r) then calendar~resizeTo(.Size~new(r~right, r~bottom))

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getMinRect() -->


<section id="mthGetMonthDelta" xreflabel="getMonthDelta"><title>getMonthDelta</title>
<indexterm><primary>getMonthDelta</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getMonthDelta</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMonthDelta--------------------------------><

]]>
</programlisting>

<para>
  Returns the scroll rate for the month calendar control. The scroll rate is the number of months that the control moves
  its display when the user clicks a scroll button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method does not use any arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    When the scroll rate has been previously set through the <xref linkend="mthSetMonthDelta"/>
    method, the return is a whole number specifying the current scroll rate. If, the scroll rate has not been previously
    set, of it it has been reset to the default, the return is a whole number specifying the number of months currently
    being displayed by the month calendar control.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getMonthDelta() -->


<section id="mthGetMonthRange" xreflabel="getMonthRange"><title>getMonthRange</title>
<indexterm><primary>getMonthRange</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getMonthRange</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getMonthRange(--range--+---------+--)--------><
                           +-,-span--+
]]>
</programlisting>

<para>
  Retrieves date information (using <computeroutput>DateTime</computeroutput> objects) that represents the high and low
  limits of a month calendar control's display.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>range [required] [IN/OUT]</term>
      <listitem>
      <para>
        An <computeroutput>Array</computeroutput> object in which the range is returned. The lower limit will be
        returned at index 1 and the upper limit will be returned at index 2. Both the values at the indexes will be
        <computeroutput>DateTime</computeroutput> objects.
      </para>
     </listitem></varlistentry>
     <varlistentry><term>range [optional]</term>
     <listitem>
     <para>
       A keyword specifying whether the range should include only months that are ENTIRELY displayed or to include
       trailing and following months that are only PARTIALLY displayed.  The default if omitted is PARTIALLY.  Only the
       first letter of ENTIRELY or PARTIALLY are required and case is insignificant.
     </para>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a whole number representing the span of months of the lower and upper limits returned in the <emphasis
    role="italic">range</emphasis> argument.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getMonthRange() -->


<section id="mthGetRangeClsMC" xreflabel="getRange"><title>getRange</title>
<indexterm><primary>getRange</primary><secondary>MonthCalendar class</secondary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getRange</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getRange(--range--)--------------------------><

]]>
</programlisting>

<para>
  Gets the current minimum and maximum allowable dates for the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>range [required] [IN/OUT]</term>
      <listitem>
      <para>
        An <computeroutput>Array</computeroutput> object in which the minimum and maximum dates are returned as
        <computeroutput>DateTime</computeroutput> objects.  The minimum date will be at index 1 and the maximum
        at index 2.  If the value at either index is set to zero, then no corresponding limit is set for the month
        calendar control.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A keyword indicating which, if any, of the limits have been set. The keyword will be exactly one of the following:
    <variablelist>
      <varlistentry><term><emphasis role="bold">none</emphasis></term>
      <listitem>
      <para>
        The month calendar has neither a minimum nor maximum date set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">min</emphasis></term>
      <listitem>
      <para>
        The month calendar has a minimum allowable date set, but no maximum date is set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">max</emphasis></term>
      <listitem>
      <para>
        The month calendar has a maximum allowable date set, but no minimum date is set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">none</emphasis></term>
      <listitem>
      <para>
        The month calendar has both a minimum and a maximum allowable date set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term><emphasis role="bold">error</emphasis></term>
      <listitem>
      <para>
        An error occurred, the values at index 1 and 2 of the <emphasis role="italic">range</emphasis> argument are
        undefined. It is unlikely that an error will occur.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Additional comments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example checks for minimum and maximum allowable dates and displays the results:
<programlisting>
<![CDATA[

  mc = self~newMonthCalendar(IDC_MC)
  range = .array~new(2)

  result = mc~getRange(range)
  select
    when result == 'none' then say "No minimum or maximum allowable dates set."

    when result == 'min' then do
      say "There is no maximum allowable date set."
      say "The minimum allowable date is" self~formatDate(range[1])"."
    end

    when result == 'max' then do
      say "There is no minimum allowable date set."
      say "The maximum allowable date is" self~formatDate(range[2])"."
    end

    when result == 'both' then do
      say "The minimum allowable date is" self~formatDate(range[1])"."
      say "The maximum allowable date is" self~formatDate(range[2])"."
    end

    when result == 'error' then do
      say "An error occurred."
      say "Hang the documentation author!!!"
    end
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getRange() -->


<section id="mthGetSelectionRange" xreflabel="getSelectionRange"><title>getSelectionRange</title>
<indexterm><primary>getSelectionRange</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getSelectionRange</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getSelectionRange(--range--)-----------------><

]]>
</programlisting>

<para>
  Retrieves date information that represents the upper and lower limits of the date range currently selected by the
  user in a multi-selection month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>range [required] [IN/OUT]</term>
      <listitem>
      <para>
        An <computeroutput>Array</computeroutput> object in which the lower and upper limits of the selection are
        returned as <computeroutput>DateTime</computeroutput> objects.  The lower bound of the selection will be at
        index 1 and the upper bound at index 2.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success, otherwise <computeroutput>.false</computeroutput>.
  </para>
  <para>
    On success index 1 of the <emphasis role="italic">range</emphasis> array argument will contain a
    <computeroutput>DateTime</computeroutput> object whose date portion is the lower limit of the selection range.
    Likewise, index 2 will contain a <computeroutput>DateTime</computeroutput> object whose date portion is the upper
    limit of the selection. On error, the <emphasis role="italic">range</emphasis> argument is unchanged.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">getSelectionRange</emphasis> method is for month calendar controls that have the MULTI
    (multi-selection) style. If the month calendar is a single-selection calendar this method returns
    <computeroutput>.false</computeroutput>. For a single-selection month calendar the <xref linkend="atrDate"/>
    attribute will reflect the current selection.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getSelectionRange() -->


<section id="mthGetStyleClsMC" xreflabel="getStyle"><title>getStyle</title>
<indexterm><primary>getStyle</primary><secondary>MonthCalendar class</secondary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getStyle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getStyle-------------------------------------><

]]>
</programlisting>

<para>
  Returns the current style of the specified month calendar control as list of style keywords.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method has no arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A list of month calendar style keywords, separated by spaces. The list could be empty if the previous style was the
    default month calendar style. Otherwise, the list will contain one or more of the following keywords:
  </para>
  <para>
    <simplelist type='vert' columns='3'>
      <member>DAYSTATE   </member>
      <member>MULTI      </member>
      <member>NOTODAY    </member>
      <member>NOCIRCLE   </member>
      <member>WEEKNUMBERS</member>
      <member>NOTRAILING </member>
      <member>SHORTDAYS  </member>
      <member>NOSELCHANGE</member>
    </simplelist>
    <variablelist>
      <varlistentry><term>DAYSTATE</term>
      <listitem>
      <para>
        The month calendar will send the GETDAYSTATE <xref linkend="ovvEvents"/> notification to request
        information about which days should be displayed in bold. Use the <xref linkend="mthConnectMonthCalendarEvent"/>
        method to connect this notification with a method in the Rexx dialog object.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MULTI</term>
      <listitem>
      <para>
        This style allows the user to select a range of dates within the control. By default, the maximum range is one
        week. The programmer changes the maximum range that can be selected by using the <xref linkend="mthSetRangeClsDTP"/>
        method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>NOTODAY</term>
      <listitem>
      <para>
        The month calendar control will not display the <emphasis role="italic">today</emphasis> date at the bottom of the control.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>NOCIRCLE</term>
      <listitem>
      <para>
        The month calendar control will not circle the <emphasis role="italic">today</emphasis> date at the bottom of
        the control.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>WEEKNUMBERS</term>
      <listitem>
      <para>
        The month calendar displays week numbers (1-52) to the left of each row of days. Week 1 is defined by
        Microsoft as the first week that contains at least four days.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>NOTRAILING</term>
      <listitem>
      <para>
        <emphasis role="bold">Requires Windows Vista or later</emphasis>. This style disables displaying the dates
        from the previous / next month in the current calendar.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SHORTDAYS</term>
      <listitem>
      <para>
        <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style, the month calendar uses the
        shortest day name for the label of the day of the week column header.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>NOSELCHANGE</term>
      <listitem>
      <para>
        <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style the selection does not
        change when the user navigates to the next or previous month in the calendar. This style is needed for the
        user to be able to select a range greater than what is currently displayed.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example displays the current style of a month calendar control:
<programlisting>
<![CDATA[

::method printStyle private

  mc = self~newMonthCalendar(IDC_MC_HOLIDAYS
  say 'The holidays month calendar has this style:' mc~getStyle

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::addStyle() -->

<section id="mthGetToday" xreflabel="getToday"><title>getToday</title>
<indexterm><primary>getToday</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>getToday</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getToday-------------------------------------><

]]>
</programlisting>

<para>
  Retrieves the date information for the date specified as <emphasis role="italic">today</emphasis> for a month calendar
  control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    This method does not have any arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, the return is a <computeroutput>DateTime</computeroutput> object whose date portion is the date of the
    <emphasis role="italic">Today</emphasis> date for the month calendar. On error the
    <computeroutput>.nil</computeroutput> object is returned.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::getToday() -->


<section id="mthHitTest" xreflabel="hitTest"><title>hitTest</title>
<indexterm><primary>hitTest</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>hitTest</secondary></indexterm>
<programlisting>
<![CDATA[
>>--hitTest(--screenPoint--)---------------------><

]]>
</programlisting>

<para>
  Determines which portion of a month calendar control is at a given point on the screen.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>screenPoint [required]</term>
    <listitem>
    <para>
      A <xref linkend="clsPoint"/> object containing the point to test.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a <computeroutput>directory</computeroutput> object containing information on the point hit-tested.
    The <computeroutput>directory</computeroutput> will contain some or all of the following indexes, depending on the
    results of the hit test:
    <variablelist>
      <varlistentry><term>HIT:</term>
      <listitem>
      <para>
        This index will always be present. Its value will be exactly one of the following keywords:
        <variablelist>
          <varlistentry><term>CalendarBackground:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was in the calendar's background.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarControl:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, is outside of any calendar but within the
            calendar controls rectangle.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarDate:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was on a particular date within the calendar. The
            DATE index of the <computeroutput>directory</computeroutput> object is set to the date at the given point.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarDateMin:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over the minimum date(s) in the calendar.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarDateMax:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over the maximum date(s) in the calendar.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarDateNext:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over a date from the next month (partially
            displayed at the end of the currently displayed month). If the user clicks here, the month calendar will
            scroll its display to the next month or set of months.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarDatePrev:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over a date from the previous month
            (partially displayed at the end of the currently displayed month). If the user clicks here, the month
            calendar will scroll its display to the previous month or set of months.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarDay:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over a day abbreviation, like <emphasis
            role="italic">Fri</emphasis>, for example. The DATE index of the <computeroutput>directory</computeroutput>
            object is set to the corresponding date in the top row.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>CalendarWeekNum:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over a week number. This only applies when
            the month calendar has the WEEKNUMBERS style. The DATE index of the
            <computeroutput>directory</computeroutput> object is set to the  the corresponding date in the leftmost
            column.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NoWhere:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was not on the month calendar control, or it was
            in an inactive portion of the control.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TitleBackground:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over the background of a month's title.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TitleButtonNext:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over the button at the top right corner of
            the control. If the user clicks here, the month calendar will scroll its display to the next month or set of
            months.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TitleButtonPrev:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was over the button at the top left corner of the
            control. If the user clicks here, the month calendar will scroll its display to the previous month or set of
            months.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TitleMonth:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was in a month's title bar, over a month name.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TitleYear:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was in a month's title bar, over the year value.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>TodayLink:</term>
          <listitem>
          <para>
            The point, <emphasis role="italic">screenPoint</emphasis>, was on the <emphasis
            role="italic">today</emphasis> link at the bottom of the month calendar control.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DATE:</term>
      <listitem>
      <para>
        When set, the DATE index will contain a <computeroutput>DateTime</computeroutput> object that reflects the date
        as specified by the HIT index above. That is, for CalendarDate, CalendarDay, and CalendarWeekNum. The index is
        not set for any other hit.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>RECT:</term>
      <listitem>
      <para>
        <emphasis role="bold">Vista or later only:</emphasis> The index will be a <xref linkend="clsRect"/>
        object that specifies the rectangle of the hit-tested location.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>OFFSET:</term>
      <listitem>
      <para>
        <emphasis role="bold">Vista or later only:</emphasis> The OFFSET index is the one-based offset of the calendar
        at the hit-teste point. This is primarily for use when more than one calendar is displayed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ROW:</term>
      <listitem>
      <para>
        <emphasis role="bold">Vista or later only:</emphasis> The one-based index of the row in the calendar grid that
        <emphasis role="italic">screenPoint</emphasis> is over. When the point is over the calendar <emphasis
        role="italic">grid</emphasis>, which is the grid of dates, both the ROW and COLUMN indexes are set. In addition,
        if the hit test is <emphasis role="italic">CalendarWeekNum</emphasis> the ROW index is set, but the COLUMN index
        is not set.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>COLUMN:</term>
      <listitem>
      <para>
        <emphasis role="bold">Vista or later only:</emphasis> The one-based index of the column in the calendar grid
        that <emphasis role="italic">screenPoint</emphasis> is over. When the point is over the calendar <emphasis
        role="italic">grid</emphasis>, which is the grid of dates, both the ROW and COLUMN indexes are set. In addition,
        if the hit test is <emphasis role="italic">CalendarDay</emphasis> the COLUMN index is set, but the ROW index
        is not set.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Although the Microsoft documentation calls the point to be tested the point on the screen, experimentation shows
    that the point must be in <xref linkend="defScreenCoordinates"/> coordinates of the dialog.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example gets the current cursor position, hit tests that point, and then prints out the hit test information:
<programlisting>
<![CDATA[

::method onF7
  expose calendar

  pt = self~getCursorPos
  calendar~screen2client(pt)

  d = calendar~hitTest(pt)
  say 'Hit:   ' d~hit
  say 'Date:  ' d~date
  if d~rect == .nil then say 'Rect:  ' d~rect
  else say 'Rect:  ' '('d~rect~left',' d~rect~top',' d~rect~right',' d~rect~bottom')'
  say 'Offset:' d~offset
  say 'Row:   ' d~row
  say 'Column:' d~column
  say

/*  Output for 2 hit tests might for instance be:

Hit:    CalendarDate
Date:   2011-10-12T00:00:00.000000
Rect:   (116, 79, 147, 94)
Offset: 1
Row:    3
Column: 4

Hit:    TodayLink
Date:   The NIL object
Rect:   (63, 139, 184, 156)
Offset: 1
Row:    The NIL object
Column: The NIL object

 */
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::hitTest() -->


<section id="mthRemoveStyleClsMC" xreflabel="removeStyle"><title>removeStyle</title>
<indexterm><primary>removeStyle</primary><secondary>MonthCalendar class</secondary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>removeStyle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--removeStyle(--styles-)-----------------------><

]]>
</programlisting>

<para>
  Removes the specified month calendar style(s) from the control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>style [required]</term>
    <listitem>
    <para>
      A list of 1 or more of the following month calendar style keywords, separated by spaces, case is not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>DAYSTATE   </member>
        <member>MULTI      </member>
        <member>NOTODAY    </member>
        <member>NOCIRCLE   </member>
        <member>WEEKNUMBERS</member>
        <member>NOTRAILING </member>
        <member>SHORTDAYS  </member>
        <member>NOSELCHANGE</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>DAYSTATE</term>
        <listitem>
        <para>
          The month calendar will send the GETDAYSTATE <xref linkend="ovvEvents"/> notification to request
          information about which days should be displayed in bold. Use the
          <xref linkend="mthConnectMonthCalendarEvent"/> method to connect this notification
          with a method in the Rexx dialog object.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MULTI</term>
        <listitem>
        <para>
          This style allows the user to select a range of dates within the control. By default, the maximum range is one
          week. The programmer changes the maximum range that can be selected by using the
          <xref linkend="mthSetRangeClsDTP"/> method.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTODAY</term>
        <listitem>
        <para>
          The month calendar control will not display the <emphasis role="italic">today</emphasis> date at the bottom of the control.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOCIRCLE</term>
        <listitem>
        <para>
          The month calendar control will not circle the <emphasis role="italic">today</emphasis> date at the bottom of
          the control.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>WEEKNUMBERS</term>
        <listitem>
        <para>
          The month calendar displays week numbers (1-52) to the left of each row of days. Week 1 is defined by
          Microsoft as the first week that contains at least four days.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTRAILING</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. This style disables displaying the dates
          from the previous / next month in the current calendar.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SHORTDAYS</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style, the month calendar uses the
          shortest day name for the label of the day of the week column header.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOSELCHANGE</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style the selection does not
          change when the user navigates to the next or previous month in the calendar. This style is needed for the
          user to be able to select a range greater than what is currently displayed.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A list of month calendar style keywords, separated by spaces, that was the style of the month calendar control
    before the <emphasis role="italic">removeStyle</emphasis> method was invoked. The list could be empty if the
    previous style was the default month calendar style.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode" /> variable.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::removeStyle() -->

<section id="mthReplaceStyleClsMC" xreflabel="replaceStyle"><title>replaceStyle</title>
<indexterm><primary>replaceStyle</primary><secondary>MonthCalendar class</secondary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>replaceStyle</secondary></indexterm>
<programlisting>
<![CDATA[
>>--replaceStyle(--oldStyles--,--newStyles--)----><

]]>
</programlisting>

<para>
  The <emphasis role="italic">replaceStyle</emphasis> method removes some existing month calendar styles and adds some
  new styles.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>oldStyles [required]</term>
    <listitem>
    <para>
      A list of 1 or more of the following month calendar style keywords, separated by spaces, case is not significant.
      The styles specified will be removed from the month calendar.
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>DAYSTATE   </member>
        <member>MULTI      </member>
        <member>NOTODAY    </member>
        <member>NOCIRCLE   </member>
        <member>WEEKNUMBERS</member>
        <member>NOTRAILING </member>
        <member>SHORTDAYS  </member>
        <member>NOSELCHANGE</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>DAYSTATE</term>
        <listitem>
        <para>
          The month calendar will send the GETDAYSTATE <xref linkend="ovvEvents"/> notification to request
          information about which days should be displayed in bold. Use the
          <xref linkend="mthConnectMonthCalendarEvent"/> method to connect this notification
          with a method in the Rexx dialog object.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MULTI</term>
        <listitem>
        <para>
          This style allows the user to select a range of dates within the control. By default, the maximum range is one
          week. The programmer changes the maximum range that can be selected by using the
          <xref linkend="mthSetRangeClsDTP"/> method.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTODAY</term>
        <listitem>
        <para>
          The month calendar control will not display the <emphasis role="italic">today</emphasis> date at the bottom of the control.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOCIRCLE</term>
        <listitem>
        <para>
          The month calendar control will not circle the <emphasis role="italic">today</emphasis> date at the bottom of
          the control.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>WEEKNUMBERS</term>
        <listitem>
        <para>
          The month calendar displays week numbers (1-52) to the left of each row of days. Week 1 is defined by
          Microsoft as the first week that contains at least four days.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOTRAILING</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. This style disables displaying the dates
          from the previous / next month in the current calendar.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SHORTDAYS</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style, the month calendar uses the
          shortest day name for the label of the day of the week column header.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOSELCHANGE</term>
        <listitem>
        <para>
          <emphasis role="bold">Requires Windows Vista or later</emphasis>. With this style the selection does not
          change when the user navigates to the next or previous month in the calendar. This style is needed for the
          user to be able to select a range greater than what is currently displayed.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>newStyles [required]</term>
    <listitem>
    <para>
      A list of 1 or more month calendar style keywords, separated by spaces, case is not significant. The styles
      specified will be added to the month calendar. The acceptable keywords are the same as those for the <emphasis
      role="italic">oldStyles</emphasis> argument above.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A list of month calendar style keywords, separated by spaces, that was the style of the month calendar control
    before the <emphasis role="italic">replaceStyle</emphasis> method was invoked. The list could be empty if the
    previous style was the default month calendar style.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <emphasis role="italic">replaceStyle</emphasis> method is essentially a combination of the
    <xref linkend="mthRemoveStyleClsMC"/> and <xref linkend="mthAddStyleClsMC"/> methods into
    one convenience method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode" /> variable.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example checks if the Rexx program is running on a Vista or later system. If it is, it removes the NOTODAY and
    NOCIRCLE styles and adds the Vista specific, NOSELCHANGE, SHORTDAYS, and NOTRAILING styles.
<programlisting>
<![CDATA[

::method initDialog

  ...

  if .OS~isAtLeastVista then do
    mc = self~newMonthCalendar(IDC_MC)
    mc~replaceStyle("NOTODAY NOCIRCLE", "NOSELCHANGE SHORTDAYS NOTRAILING")
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::replaceStyle() -->

<section id="mthSetCalendarBorder" xreflabel="setCalendarBorder"><title>setCalendarBorder</title>
<indexterm><primary>setCalendarBorder</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setCalendarBorder</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setCalendarBorder(--+----------+--)----------><
                        +--pixels--+
]]>
</programlisting>

<para>
  Sets the size, in pixels, of the month calendar's border.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>pixels [optional]</term>
    <listitem>
    <para>
      The size to set the border to, in pixels. If <emphasis role="italic">pixels</emphasis> is omitted, the border is
     set to the default value specified by the theme, or zero if themes are not being used.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0, always.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the calendar border to a very large size and then resizes the calendar to its optimal size:
<programlisting>
<![CDATA[

::method sizeCalendar private
  use strict arg calendar

  calendar~setCalendarBorder(32)

  r = .Rect~new
  if \ calendar~getMinRect(r) then return 0

  calendar~resizeTo(.Size~new(r~right, r~bottom))
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setCalendarBorder() -->


<section id="mthSetCALID" xreflabel="setCALID"><title>setCALID</title>
<indexterm><primary>setCALID</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setCALID</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setCALID(--calID--)--------------------------><

]]>
</programlisting>

<para>
  Sets the calendar ID for the calendar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>calID [required]</term>
    <listitem>
    <para>
      A single keyword specifying the calendar ID to use. The keywords are case insensitive. The keywords are listed in
      the following table:
    </para>
    <table id="tblCalendarIDKeywords" frame="all">
    <title>Calendar ID Keywords</title>
    <tgroup cols="2">
    <colspec colwidth="1*" />
    <colspec colwidth="2*" />
    <thead>
    <row>
    <entry>ID Keyword</entry>
    <entry>Description</entry>
    </row>
    </thead>
    <tbody>
    <row>
    <entry>GREGORIAN</entry>
    <entry>Gregorian (localized)</entry>
    </row>
    <row>
    <entry>GREGORIAN_US</entry>
    <entry>Gregorian (English strings always</entry>
    </row>
    <row>
    <entry>JAPAN</entry>
    <entry>Japanese Emperor Era</entry>
    </row>
    <row>
    <entry>TAIWAN</entry>
    <entry>Taiwan calendar</entry>
    </row>
    <row>
    <entry>KOREA</entry>
    <entry>Korean Tangun Era</entry>
    </row>
    <row>
    <entry>HIJRI</entry>
    <entry>Hijri (Arabic Lunar)</entry>
    </row>
    <row>
    <entry>THAI</entry>
    <entry>Thai</entry>
    </row>
    <row>
    <entry>HEBREW</entry>
    <entry>Hebrew (Lunar)</entry>
    </row>
    <row>
    <entry>GREGORIAN_ME_FRENCH</entry>
    <entry>Gregorian Middle East French</entry>
    </row>
    <row>
    <entry>GREGORIAN_ARABIC</entry>
    <entry>Gregorian Arabic</entry>
    </row>
    <row>
    <entry>CAL_GREGORIAN_XLIT_ENGLISH</entry>
    <entry>Gregorian transliterated English</entry>
    </row>
    <row>
    <entry>CAL_GREGORIAN_XLIT_FRENCH</entry>
    <entry>Gregorian transliterated French</entry>
    </row>
    <row>
    <entry>UMALQURA</entry>
    <entry>Um Al Qura (Arabic lunar) calendar </entry>
    </row>
    </tbody></tgroup>
    </table>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0, always.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setCALID() -->


<section id="mthSetColorClsMonthCalendar" xreflabel="setColor"><title>setColor</title>
<indexterm><primary>setColor</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setColor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setColor(--which--,--color--)----------------><

]]>
</programlisting>

<para>
  Sets the color for a given part of a month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>which [required]</term>
    <listitem>
    <para>
      Specifies which part of the calendar will have its coler set. Exactly one of the following keywords must be used,
      case is not significant:
    </para>
    <para>
      <simplelist type='vert' columns='3'>
        <member>BACKGROUND  </member>
        <member>MONTHBK     </member>
        <member>TEXT        </member>
        <member>TITLEBK     </member>
        <member>TITLETEXT   </member>
        <member>TRAILINGTEXT</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>BACKGROUND</term>
        <listitem>
        <para>
          Set the background color displayed between months.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MONTHBK</term>
        <listitem>
        <para>
          Set the background color displayed within the month.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TEXT</term>
        <listitem>
        <para>
          Set the color used to display text within a month.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TITLEBK</term>
        <listitem>
        <para>
          Set the background color displayed in the calendar's title.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TITLETEXT</term>
        <listitem>
        <para>
          Set the color used to display text within the calendar's title.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>TRAILINGTEXT</term>
        <listitem>
        <para>
          Set the color used to display header day and trailing day text. Header and trailing days are the days
          from the previous and following months that appear on the current month calendar.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>color [required]</term>
    <listitem>
    <para>
      The color, specified as a COLORREF, to set the specified calendar part.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the previouse color, as a COLORREF, for the part of the month calendar control specified.
    Returns CLR_INVALID on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The <xref linkend="clsImage"/> class has a number of convenience methods for working with COLORREFs,
    including the <xref linkend="mthColorRef"/> method that explains what a COLORREF is.
  </para>
  <para>
    The <emphasis role="italic">colorRef</emphasis> method can be used to test the return for error. I.e.:
    <computeroutput>.Image~colorRef(CLR_INVALID)</computeroutput>. (An error is not very likely.)
  </para>
  <para>
    Note that many of the underlying dialog controls ignore their color settings when visual themes are enabled, unless
    the theme is Windows Clasic. This is the case for the month calendar control. Setting any of the calendar part
    colors will have no effect, except in the Windows Classic theme.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the color for the TEXT calendar part to blue and prints out the RGB values for the previous color.
<programlisting>
<![CDATA[

  monthCalendar = self~newMonthCalendar(IDC_MC_HOLIDAYS)
  invalid = .Image~colorRef(CLR_INVALID)

  -- Blue
  color = .Image~colorRef(255, 0, 0)

  oldColor = monthCalendar~setColor("TEXT", color)
  if oldColor == invalid then do
    -- Fill in with some error routine.
    say 'setColor() failed.'
  end
  else do
    R = .Image~getRValue(oldColor)
    G = .Image~getGValue(oldColor)
    B = .Image~getBValue(oldColor)
    say 'The old color for "TEXT" was:('R',' G',' B')'
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setColor() -->


<section id="mthSetCurrentView" xreflabel="setCurrentView"><title>setCurrentView</title>
<indexterm><primary>setCurrentView</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setCurrentView</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setCurrentView(--view--)---------------------><

]]>
</programlisting>

<para>
  Sets the view for a month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>view [required]</term>
    <listitem>
    <para>
      The <emphasis role="italic">view</emphasis> argument must be exactly one of the following keywords, case is not
      significant:
    </para>
    <para>
      <simplelist type='vert' columns='4'>
        <member>MONTHLY</member>
        <member>ANNUAL </member>
        <member>DECADE </member>
        <member>CENTURY</member>
      </simplelist>
      <variablelist>
        <varlistentry><term>MONTHLY</term>
        <listitem>
        <para>
          Monthly view.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>ANNUAL</term>
        <listitem>
        <para>
          Annual view.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DECADE</term>
        <listitem>
        <para>
          Decade view.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>CENTURY</term>
        <listitem>
        <para>
          Century view.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setCurrentView() -->


<section id="mthSetDayState" xreflabel="setDayState"><title>setDayState</title>
<indexterm><primary>setDayState</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setDayState</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setDayState(--dayStates--)-------------------><

]]>
</programlisting>

<para>
  Sets the day states for all months that are currently visible within a month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
  <variablelist>
    <varlistentry><term>dayStates [required]</term>
    <listitem>
    <para>
      An array of <xref linkend="clsDayState"/> objects. The array must not be sparse and can not contain
      more items than the number of currently visible months in the calendar. Index 1 in the array should contain the
      <computeroutput>DayState</computeroutput> object for the first visible month in the calendar. Each consecutive
      index contains the <computeroutput>DayState</computeroutput> object for the next visible month, with the last
      index in the array containing the <computeroutput>DayState</computeroutput> object for the last visible month in
      the calendar.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A month calendar uses a day state to determine how to display individual dates in a month. The day state specifies
    which days should be bolded. The month calendar must have the <xref linkend="mthCreateMonthCalendar"/>
    style or setting the day state has no effect. The programmer must use the
    <xref linkend="clsDayState"/> class to create the day state objects.
  </para>
  <para>
    The number of elements in <emphasis role="italic">dayStates</emphasis> must equal the return value from
    <xref linkend="mthGetMonthRange"/> when used with the PARTIALLY keyword argument. That is, <emphasis
    role="italic">dayStates</emphasis> must contain values that correspond with all months currently in the control's
    display, in chronological order. This includes the two months that may be partially displayed before the first month
    and after the last month.
  </para>
  <para>
    Normally in a program using day states with a month calendar, the programmer will not have to continually invoke the
    <emphasis role="italic">setDayState</emphasis> method as the user scrolls through the calendar. Rather he will
    connect the <xref linkend="mthConnectMonthCalendar"/> event of the month calendar and return an
    array of day state objects from the event (<xref linkend="evtMonthCalendarGETDAYSTATE" />) handler. The month
    calendar then sets the day states internally using the array.
  </para>
  <para>
    However, the programmer will need to use the <emphasis role="italic">setDayState</emphasis> method to properly
    display the dates when the dialog with a month caldendar is first shown.
  </para> </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the 15th and 30th of each month to be bolded in the month calendar when the dialog is first shown.
    Notice that the day state for each month is the same (15th and 30th) so the code does not determine exactly which
    months are showing, it only needs to determine how many months are showing.
<programlisting>
<![CDATA[

::method initDialog
  expose calendar

  calendar = self~newMonthCalendar(IDC_MC_PAYDAYS)

  monthsShowing = .array~new
  count = calendar~getMonthRange(monthsShowing, 'P')

  dayStates = .array~new(count)
  dayState = .DayState~new(15, 30)
  do i = 1 to count
    dayStates[i] = dayState
  end

  calendar~setDayState(dayStates)
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setDayState() -->


<section id="mthSetDayStateQuick" xreflabel="setDayStateQuick"><title>setDayStateQuick</title>
<indexterm><primary>setDayStateQuick</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setDayStateQuick</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setDayStateQuick(--ds1-,-ds2-,-ds3--)--------><

]]>
</programlisting>

<para>
  Sets the day states for 3 months that are currently visible (assumed) within a month calendar control. The <emphasis
  role="italic">setDayStateQuick</emphasis> method is almost identical to the
  <xref linkend="mthSetDayState"/> method except that the number of day (<xref linkend="clsDayState" />) state objects
  is fixed at 3.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>ds1</term>
    <listitem>
    <para>
      The <xref linkend="clsDayState"/> object for the first month.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>ds2</term>
    <listitem>
    <para>
      The <xref linkend="clsDayState"/> object for the second month.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>ds3</term>
    <listitem>
    <para>
      The <xref linkend="clsDayState"/> object for the third month.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A month calendar uses a day state to determine how to display individual dates in a month. The day state specifies
    which days should be bolded. The month calendar must have the <xref linkend="mthCreateMonthCalendar"/>
    style or setting the day state has no effect. The programmer must use the
    <xref linkend="clsDayState"/> class to create the day state objects.
  </para>
  <para>
    The most common use case for a month calendar is to display 1 month. In this case, when setting the day states for
    the calendar, exactly 3 monts of day state objects are needed, (previouse, current, and next months.) The <emphasis
    role="italic">setDayStateQuick</emphasis> is simply a short cut method to take advantage of this foreknowledge.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets the day states for the month calendar when the dialog is initially displayed. Since the programmer
    knows the calendar is set to only display 1 month, she knows that she need exactly 3 day state objects. 1 for the
    displayed month, and 1 each for the leading and trailing days of the previous and next months:
<programlisting>
<![CDATA[

::method initDialog
  expose calendar

  calendar = self~newMonthCalendar(IDC_MC_PAYDAYS)

  dayState = .DayState~new(15, 30)
  calendar~setDayStateQuick(dayState, dayState, dayState)
  ...
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setDayStateQuick() -->


<section id="mthSetFirstDayOfWeek" xreflabel="setFirstDayOfWeek"><title>setFirstDayOfWeek</title>
<indexterm><primary>setFirstDayOfWeek</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setFirstDayOfWeek</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setFirstDayOfWeek(--firstDay--)--------------><

]]>
</programlisting>

<para>
  Sets the first day of the week for the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>firstDay [required]</term>
    <listitem>
    <para>
      Which day is to be the first day of the week. This can either be the name of the day (Monday, Tuesday, etc., case
      insignificant) or the number of the day (0 for Monday, 1 for Tuesday, etc..)
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A <computeroutput>Directory</computeroutput> object with information concerning the previous first day of the week.
    This is the same information as returned by the <xref linkend="mthGetFirstDayOfWeek"/>
    method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the first day of the week is set to anything other than the default, which is the locale dependent first day of
    the week, the control will no longer automatically update first-day-of-the-week changes based on locale changes.
  </para>
  <para>
    The returned <computeroutput>Directory</computeroutput> object will contain the following indexes with information
    concerning ther previous first day of the week:
  </para>
  <variablelist>
    <varlistentry><term>DAY</term>
    <listitem>
    <para>
      The numerical first day of the week (0 for Monday, 1 for Tuesday, etc..)
    </para>
    </listitem></varlistentry>
    <varlistentry><term>USINGLOCALE</term>
    <listitem>
    <para>
      True if the calendar is using the localized first day of the week, false if the first day of the week has been set
      to something other than the localized first day of the week.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>DAYNAME</term>
    <listitem>
    <para>
      The english name of the day corresponding to first day of the week.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode" /> variable.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setFirstDayOfWeek() -->


<section id="mthSetMaxSelection" xreflabel="setMaxSelection"><title>setMaxSelection</title>
<indexterm><primary>setMaxSelection</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setMaxSelection</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setMaxSelection(--count--)-------------------><

]]>
</programlisting>

<para>
  Sets the maximum number of days that can be selected in a month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>count [required]</term>
    <listitem>
    <para>
      The maximum number of days that can be selected.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, otherwise false.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method will fail if the month calendar control does not have the multi-select style.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setMaxSelection() -->


<section id="mthSetMonthDelta" xreflabel="setMonthDelta"><title>setMonthDelta</title>
<indexterm><primary>setMonthDelta</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setMonthDelta</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setMonthDelta(--amount--)--------------------><

]]>
</programlisting>

<para>
  Sets the number of months that the month calendar control moves its display when the user clicks a scroll button. This
  is called the scroll rate.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>amount [required]</term>
    <listitem>
    <para>
       The number of months to be set as the month calendar's scroll rate. If <emphasis role="italic">amount</emphasis>
       is zero, the month delta is reset to the default. The defualt is the number of months displayed in the month
       calendar control.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the previous scroll rate. If the scroll rate was not previously set, the return value is zero
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The PAGE UP and PAGE DOWN keys, (<computeroutput>.VK~PRIOR</computeroutput> (<xref linkend="clsVK" />) and
    <computeroutput>.VK~NEXT</computeroutput>,) change the selected month by one, regardless of the number of months
    displayed or the value set by <emphasis role="italic">setMonthDelta</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setMonthDelta() -->


<section id="mthSetRangeClsMC" xreflabel="setRange"><title>setRange</title>
<indexterm><primary>setRange</primary><secondary>MonthCalendar class</secondary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setRange</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setRange(--dates--)--------------------------><

]]>
</programlisting>

<para>
  Sets the minimum and maximum allowable dates for the month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>dates [required]</term>
    <listitem>
    <para>
      An array of <computeroutput>DateTime</computeroutput> objects used to set the minimum and maximum dates. The
      <computeroutput>DateTime</computeroutput> object at index 1 sets the minimum date and the
      <computeroutput>DateTime</computeroutput> object at index 2 sets the maximum date.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    xx
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The array must contain at least one of the indexes.  If it contains neither, and exceptions is raised. If one of the
    array indexes is empty, then the corresponding date is not set.  The time portion of the
    <computeroutput>DateTime</computeroutput> object(s) is ignored.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example sets a month calendar to only show the months of 2011:
<programlisting>
<![CDATA[

::method initDialog
  expose calendar

  calendar = self~newMonthCalendar(IDC_MC_HOLIDAYS)
  ...

  -- Restrict the calendar so that it only displays the year 2011.
  start = .DateTime~fromStandardDate("20110101")
  end = .DateTime~fromStandardDate("20111231")

  calendar~setRange(.array~of(start, end))

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setRange() -->


<section id="mthSetSelectionRange" xreflabel="setSelectionRange"><title>setSelectionRange</title>
<indexterm><primary>setSelectionRange</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setSelectionRange</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setSelectionRange(--dates--)-----------------><

]]>
</programlisting>

<para>
  Sets the selection for a multi-selection month calendar control to a given date range.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>dates [required]</term>
    <listitem>
    <para>
      An <computeroutput>Array</computeroutput> object containg two <computeroutput>DateTime</computeroutput> objects.
      The <computeroutput>DateTime</computeroutput> object at index 1 must be the starting date of the selection and the
      <computeroutput>DateTime</computeroutput> object at index 2 must be the ending date of the selection. The time
      portion of the <computeroutput>DateTime</computeroutput> object is ignored.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns true on success, false on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method will fail if the month calendar does not have the multi-selection style.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setSelectionRange() -->


<section id="mthSetToday" xreflabel="setToday"><title>setToday</title>
<indexterm><primary>setToday</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>setToday</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setToday(--+--------+--)---------------------><
               +--date--+
]]>
</programlisting>

<para>
  Sets the <emphasis role="italic">today</emphasis> selection for a month calendar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single optional argument is:
  <variablelist>
    <varlistentry><term>date [optional]</term>
    <listitem>
    <para>
      A <computeroutput>DateTime</computeroutput> object that contains the date to set the <emphasis
      role="italic">today</emphasis> selection to. The time portion of the object is ignored. If this argument is
      omitted, the month calendar reverts to the default setting for the <emphasis role="italic">today</emphasis>
      selection.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0, always.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When <emphasis role="italic">today</emphasis> is set to anything other than the default, then these conditions
    apply:
    <itemizedlist>
    <listitem>
    <para>
      The month calendar will not automatically update the <emphasis role="italic">today</emphasis> selection when time
      passes midnight of the current day.
    </para>
    </listitem>
    <listitem>
    <para>
      The month calendar will not automatically update its display based on locale changes.
    </para>
    </listitem>
    </itemizedlist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example sets the <emphasis role="italic">today</emphasis> selection to tomorrow.
<programlisting>
<![CDATA[

  calendar = self~newMonthCalendar(IDC_MC_PAYDAYS)

  -- Pretend it is the day after tomorrow:
  date = .DateTime~today
  calendar~setToday(date~addDays(2))
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::setToday() -->


<section id="mthSizeRectToMin" xreflabel="sizeRectToMin"><title>sizeRectToMin</title>
<indexterm><primary>sizeRectToMin</primary></indexterm>
<indexterm><primary>MonthCalendar class</primary><secondary>sizeRectToMin</secondary></indexterm>
<programlisting>
<![CDATA[
>>--sizeRectToMin(--rect--)----------------------><

]]>
</programlisting>

<para>
  Calculates how many calendars will fit in the given rectangle, and then returns the minimum size that a rectangle
  needs to be to fit that number of calendars.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single required argument is:
  <variablelist>
    <varlistentry><term>rext [required] [in / out]</term>
    <listitem>
    <para>
      A <xref linkend="clsRect"/> object that, on entry, describes a region that is greater than or equal to
      the size necessary to fit the desired number of calendars. When this method returns, the
      <computeroutput>rect</computeroutput> object will contain the minimum size needed for this number of calendars.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0, always.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    <emphasis role="bold">Requires Windows Vista or later</emphasis>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End MonthCalendar::sizeRectToMin() -->

</chapter>  <!-- End MonthCalendar class -->

