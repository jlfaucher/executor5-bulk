<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "rxsock.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: RxSock TCP/IP Socket Functions Reference
    #
    # Copyright (c) 2005-2012, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter><title>SMTP Class Reference</title>
<indexterm><primary>class, SMTP</primary></indexterm>
<indexterm><primary>SMTP class</primary></indexterm>
<para>The following sections describe the SMTP class supplied with ooRexx.
This class can send SMTP messages to an SMTP server. It utilizes the
<xref linkend="clsStreamSocket" />
to perform the communications with the server.
</para>

<section><title>Installation</title>
<indexterm><primary>installation, streamsocket class</primary></indexterm>
<indexterm><primary>streamsocket class installation</primary></indexterm>
<para>The SMTP class package is contained in the file smtp.cls. This file
must be placed in a directory listed in your PATH. To get access to the class
and methods in the SMTP class, include the following statement in your Rexx
program:
<programlisting>
::requires 'smtp.cls'
</programlisting></para>
</section>

<section id="clsSMTP"><title>The SMTP Class</title>
<indexterm><primary>SMTP class</primary></indexterm>
<indexterm><primary>class</primary>
<secondary>SMTP class</secondary></indexterm>

<para>This class encapsulates all the communications necessary to send mail via an
SMTP server.
</para>

<!-- $GENERATED-20160822-START rexxrefClassTable(Smtp) -->
<table id="ooRexxSmtpClass" frame="all" pgwide="1">
<title>Smtp Class</title>
<tgroup cols="1">
<tbody>
 <row><entry align="center"><emphasis role="bold">Object</emphasis></entry>
 </row>
<!-- should we link to rexxref here?
 <row><entry>Methods inherited from the <xref linkend="clsObject" xrefstyle="template:Object class"/></entry>
 </row>
-->
 <row><entry align="center"><emphasis role="bold">Smtp</emphasis></entry>
 </row>
 <row><entry>
  <simplelist columns="3">
   <member><xref linkend="mthSmtpNew" xrefstyle="select:title"/></member>
  </simplelist>
  <simplelist columns="3">
   <member><xref linkend="mthSmtpAuthId" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpCmdResponse" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpConnect" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpDebug" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpLocalhost" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpLogoff" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpPassword" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpResponse" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpSend" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpSmtpErrno" xrefstyle="select:title"/></member>
  </simplelist>
 </entry></row>
</tbody>
</tgroup>
</table>
<!-- $GENERATED-20160822-END rexxrefClassTable(Smtp) -->

<section id="mthSmtpNew"><title>new (Inherited Class Method)</title>
<indexterm><primary>new method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>new method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_new.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Initializes the object.
Returns the new SMTP object.</para>
</section>

<section id="mthSmtpAuthId"><title>authid/=</title>
<indexterm><primary>authid method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>authid method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_authid.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method either sets the authid or returns the current authid.
The default value for the authid is a zero-length string.</para>
</section>

<section id="mthSmtpCmdResponse"><title>cmdresponse</title>
<indexterm><primary>cmdresponse method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>cmdresponse method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_cmdresponse.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns an array containing all the commands sent to the SMTP server
and the responses from that server.</para>
</section>

<section id="mthSmtpConnect"><title>connect</title>
<indexterm><primary>connect method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>connect method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_connect.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This opens the connection to the SMTP host machine.</para>
<variablelist>
<varlistentry><term>smtphost</term>
<listitem><para>The host name or TCP/IP address of the SMTP host.
This string can contain a port designation.
</para></listitem></varlistentry>
<varlistentry><term>authid</term>
<listitem><para>(Optional) The account authid to be used if needed.
</para></listitem></varlistentry>
<varlistentry><term>password</term>
<listitem><para>(optional) The password for the specified authid.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSmtpDebug"><title>debug/=</title>
<indexterm><primary>debug method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>debug method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_debug.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method either sets the debug flag or returns the current flag value.
The default value for the flag is 0 (false) which suppresses debug messages.</para>
</section>

<section id="mthSmtpLocalhost"><title>localhost</title>
<indexterm><primary>localhost method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>localhost method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_localhost.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the local host name.</para>
</section>

<section id="mthSmtpLogoff"><title>logoff</title>
<indexterm><primary>logoff method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>logoff method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_logoff.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method logs off the session to the SMTP host.</para>
</section>

<section id="mthSmtpPassword"><title>password/=</title>
<indexterm><primary>password method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>password method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_password.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method either sets the SMTP server account password, or returns the password value.
The default value for the password is a zero-length string.</para>
</section>

<section id="mthSmtpResponse"><title>response</title>
<indexterm><primary>response method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>response method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_response.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the parsed response to the last command sent to the SMTP server.
The initial value for the response is a zero-length string.</para>
</section>

<section id="mthSmtpSend"><title>send</title>
<indexterm><primary>send method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>send method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_send.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sends an SMTP message to the SMTP server. The 
<emphasis role="italic">msg</emphasis> must be an instance of the
<xref linkend="clsSMTPMsg" xrefstyle="template:SMTPMsg" /> class.
</para>
</section>

<section id="mthSmtpSmtpErrno"><title>smtpErrno</title>
<indexterm><primary>smtpErrno method</primary>
<secondary>of SMTP class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>smtpErrno method</secondary>
<tertiary>of SMTP class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtp_smtperrno.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the return code of the last command sent to the SMTP server.
The initial value for the response is a zero-length string.</para>
</section>
</section>

<section id="clsSMTPMsg"><title>The SMTPMsg Class</title>
<indexterm><primary>SMTPMsg class</primary></indexterm>
<indexterm><primary>class</primary>
<secondary>SMTPMsg class</secondary></indexterm>

<para>This class encapsulates all information needed to communicate a complete message
to the SMTP server.</para>

<!-- $GENERATED-20160822-START rexxrefClassTable(SmtpMsg) -->
<table id="ooRexxSmtpMsgClass" frame="all" pgwide="1">
<title>SmtpMsg Class</title>
<tgroup cols="1">
<tbody>
 <row><entry align="center"><emphasis role="bold">Object</emphasis></entry>
 </row>
<!-- should we link to rexxref here?
 <row><entry>Methods inherited from the <xref linkend="clsObject" xrefstyle="template:Object class"/></entry>
 </row>
-->
 <row><entry align="center"><emphasis role="bold">SmtpMsg</emphasis></entry>
 </row>
 <row><entry>
  <simplelist>
   <member><xref linkend="mthSmtpMsgNew" xrefstyle="select:title"/></member>
  </simplelist>
  <simplelist columns="3">
   <member><xref linkend="mthSmtpMsgAddRecipient" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpMsgContent" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpMsgFrom" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpMsgRecipients" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSmtpMsgSubject" xrefstyle="select:title"/></member>
  </simplelist>
 </entry></row>
</tbody>
</tgroup>
</table>
<!-- $GENERATED-20160822-END rexxrefClassTable(SmtpMsg) -->

<section id="mthSmtpMsgNew"><title>new (Inherited Class Method)</title>
<indexterm><primary>new method</primary>
<secondary>of SMTPMsg class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>new method</secondary>
<tertiary>of SMTPMsg class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtpmsg_new.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Initializes the object.
Returns the new SMTPMsg object.</para>
</section>

<section id="mthSmtpMsgAddRecipient"><title>addRecipient</title>
<indexterm><primary>addRecipient method</primary>
<secondary>of SMTPMsg class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>addRecipient method</secondary>
<tertiary>of SMTPMsg class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtpmsg_addrecipient.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method adds a new recipient of the message.
</para>
</section>

<section id="mthSmtpMsgContent"><title>content/=</title>
<indexterm><primary>content method</primary>
<secondary>of SMTPMsg class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>content method</secondary>
<tertiary>of SMTPMsg class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtpmsg_content.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns or sets a piece of the SMTP message. The 
<emphasis role="italic">part</emphasis> must be an instance of the
<xref linkend="clsMimePart" xrefstyle="template:MimePart" /> or
<xref linkend="clsMimeMultiPart" xrefstyle="template:MimeMultiPart" /> class, or
a plain string.</para>
</section>

<section id="mthSmtpMsgFrom"><title>from/=</title>
<indexterm><primary>from method</primary>
<secondary>of SMTPMsg class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>from method</secondary>
<tertiary>of SMTPMsg class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtpmsg_from.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sets or fetches the "From" mail header field.
</para>
</section>

<section id="mthSmtpMsgRecipients"><title>recipients</title>
<indexterm><primary>recipients method</primary>
<secondary>of SMTPMsg class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>recipients method</secondary>
<tertiary>of SMTPMsg class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtpmsg_recipients.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This returns an array of the mail header "Recipient" fields.
</para>
</section>

<section id="mthSmtpMsgSubject"><title>subject/=</title>
<indexterm><primary>subject method</primary>
<secondary>of SMTPMsg class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>subject method</secondary>
<tertiary>of SMTPMsg class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/smtpmsg_subject.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sets or fetches the "Subject" mail header field.
</para>
</section>
</section>
</chapter>
