<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "rxsock.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: RxSock TCP/IP Socket Functions Reference
    #
    # Copyright (c) 2005-2021, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # https://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<chapter><title>Socket Class Reference</title>
<indexterm><primary>class, socket</primary></indexterm>
<indexterm><primary>socket class</primary></indexterm>
<para>The following sections describe the socket class supplied with ooRexx.
This class encapsulates the rxsock external functions into several classes that
improve the functionality if the external function library by extending the
error checking and reducing the amount of code needed in an average rxsock
program.</para>

<section><title>Installation</title>
<indexterm><primary>installation, socket class</primary></indexterm>
<indexterm><primary>socket class installation</primary></indexterm>
<para>The Socket class package is contained in the file socket.cls. This file
must be placed in a directory listed in your PATH. To get access to the class
and methods in the Socket class, include the following statement in your Rexx
program:
<programlisting>
::requires 'socket.cls'
</programlisting></para>
</section>

<section id="clsSocket"><title>Socket Class</title>
<!-- modified: removed init() / added new(), removed uninit() -->
<!-- $GENERATED-20160822-START rexxrefClassTable(Socket) -->
<table id="ooRexxSocketClass" frame="all" pgwide="1">
<title>Socket Class</title>
<tgroup cols="1">
<tbody>
 <row><entry align="center"><emphasis role="bold">Object</emphasis></entry>
 </row>
<!-- should we link to rexxref here?
 <row><entry>Methods inherited from the <xref linkend="clsObject" xrefstyle="template:Object class"/></entry>
 </row>
-->
 <row><entry align="center"><emphasis role="bold">Socket</emphasis></entry>
 </row>
 <row><entry>
  <simplelist>
   <member><xref linkend="mthSocketNew" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketGetHostByAddr" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketGetHostByName" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketGetHostId" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketGetHostName" xrefstyle="select:title"/></member>
  </simplelist>
  <simplelist columns="3">
   <member><xref linkend="mthSocketAccept" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketBind" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketClose" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketConnect" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketErrno" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketGetOption" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketGetPeerName" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketGetSockName" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketIoctl" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketListen" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketRecv" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketRecvFrom" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketSelect" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketSend" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketSetOption" xrefstyle="select:title"/></member>
   <member><xref linkend="mthSocketString" xrefstyle="select:title"/></member>
<!-- <member><xref linkend="mthSocketUninit" xrefstyle="select:title"/></member> -->
  </simplelist>
 </entry></row>
</tbody>
</tgroup>
</table>
<!-- $GENERATED-20160822-END rexxrefClassTable(Socket) -->

<section id="mthSocketNew"><title>new (Inherited Class Method)</title>
<indexterm><primary>new</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>class method</primary>
<secondary>new</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_new.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns a new instance of the
<xref linkend="clsSocket" xrefstyle="template:Socket" /> class.
</para>
<variablelist>
   <varlistentry>
      <term><emphasis role="bold">domain</emphasis></term>
      <listitem><para>If specified, this argument must be AF_INET.
      </para></listitem>
   </varlistentry>
   <varlistentry>
      <term><emphasis role="bold">type</emphasis></term>
      <listitem><para>If specified, this argument must be SOCK_STREAM,
                    SOCK_DGRAM or SOCK_RAW. SOCK_STREAM is the default.
      </para></listitem>
   </varlistentry>
   <varlistentry>
      <term><emphasis role="bold">protocol</emphasis></term>
      <listitem><para>If specified, this argument must be 0,
                    IPPROTO_UDP or IPPROTO_TCP. 0 is the default.
      </para></listitem>
   </varlistentry>
</variablelist>
</section>

<section id="mthSocketGetHostByAddr"><title>getHostByAddr (Class Method)</title>
<indexterm><primary>getHostByAddr class method</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>getHostByAddr class method</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_gethostbyaddr.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This is a class method. It returns an instance of the
<xref linkend="clsHostInfo" xrefstyle="template:HostInfo" /> class.
</para>
</section>

<section id="mthSocketGetHostByName"><title>getHostByName (Class Method)</title>
<indexterm><primary>getHostByName class method</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>getHostByName class method</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_gethostbyname.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This is a class method. It returns an instance of the
<xref linkend="clsHostInfo" xrefstyle="template:HostInfo" /> class.
</para>
</section>

<section id="mthSocketGetHostId"><title>getHostId (Class Method)</title>
<indexterm><primary>getHostId class method</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>getHostId class method</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_gethostid.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This is a class method. It returns the dotted decimal host id of the local
machine.
</para>
</section>


<!-- Class Socket - method getHostName ======================== -->
<section id="mthSocketGetHostName"><title>getHostName (Class Method)</title>
<indexterm><primary>getHostName class method</primary><secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary><secondary>getHostName class method</secondary><tertiary>of Socket class</tertiary></indexterm>
<indexterm><primary>lookup local host name</primary></indexterm>
<indexterm><primary>local host name, lookup</primary></indexterm>

<para>
<mediaobject><imageobject>
<imagedata fileref="images/methods/socket_gethostname.svg" scale="55"/>
</imageobject></mediaobject>
</para>

<para>This is a class method. Returns the name of the local host.
</para>
<note><para>SockGetHostName() interfaces with the C function gethostname().
</para></note>
</section>

<section id="mthSocketAccept"><title>accept</title>
<indexterm><primary>accept method</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>accept method</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_accept.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns a new socket class instance that is connected to a
remote host that has requested a connection from a server socket.
</para>
</section>

<section id="mthSocketBind"><title>bind</title>
<indexterm><primary>bind method</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>bind method</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_bind.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method binds a socket to a particular local IP address specified by
an instance of the <xref linkend="clsInetAddress" xrefstyle="template:InetAddress" /> class
contained in the <emphasis role="italic">address</emphasis> argument.
</para>
</section>

<section id="mthSocketClose"><title>close</title>
<indexterm><primary>close method</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>close method</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_close.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method closes this socket instance.
</para>
</section>

<section id="mthSocketConnect"><title>connect</title>
<indexterm><primary>connect</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>connect</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_connect.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method connect the socket to a remote address specified by an
instance of the <xref linkend="clsInetAddress" xrefstyle="template:InetAddress" /> class
contained in the <emphasis role="italic">address</emphasis> argument.
</para>
</section>

<!-- Class Socket - method errno ======================== -->
<section id="mthSocketErrno"><title>errno</title>
<indexterm><primary>errno method</primary><secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary><secondary>errno method</secondary><tertiary>of Socket class</tertiary></indexterm>

<para>
<mediaobject><imageobject>
<imagedata fileref="images/methods/socket_errno.svg" scale="55"/>
</imageobject></mediaobject>
</para>

<para>Returns a string describing the last error occurred.
</para>
</section>

<section id="mthSocketGetOption"><title>getOption</title>
<indexterm><primary>getOption</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>getOption</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_getoption.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the value of the options specified by the <emphasis
role="italic">option</emphasis> argument.
</para>
<para>The <emphasis role="italic">option</emphasis> argument must be one of the
following:
<simplelist>
   <member>SO_BROADCAST  </member>
   <member>SO_DEBUG      </member>
   <member>SO_DONTROUTE  </member>
   <member>SO_ERROR      </member>
   <member>SO_KEEPALIVE  </member>
   <member>SO_LINGER     </member>
   <member>SO_OOBINLINE  </member>
   <member>SO_RCVBUF     </member>
   <member>SO_RCVLOWAT   </member>
   <member>SO_RCVTIMEO   </member>
   <member>SO_REUSEADDR  </member>
   <member>SO_SNDBUF     </member>
   <member>SO_SNDLOWAT   </member>
   <member>SO_SNDTIMEO   </member>
   <member>SO_TYPE       </member>
   <member>SO_USELOOPBACK</member>
</simplelist>
</para>
</section>

<section id="mthSocketGetPeerName"><title>getPeerName</title>
<indexterm><primary>getPeerName</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>getPeerName</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_getpeername.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the peer name of the remote connection.
</para>
</section>

<section id="mthSocketGetSockName"><title>getSockName</title>
<indexterm><primary>getSockName</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>getSockName</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_getsockname.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns an instance of the
<xref linkend="clsInetAddress" xrefstyle="template:InetAddress" /> class that is the name
information of the remote machine.
</para>
</section>

<section id="mthSocketIoctl"><title>ioctl</title>
<indexterm><primary>ioctl</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>ioctl</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_ioctl.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sends a special command to the socket. The <emphasis role="italic">
cmd</emphasis> and the <emphasis role="italic">data</emphasis> are not checked
for valid values.
</para>
</section>

<section id="mthSocketListen"><title>listen</title>
<indexterm><primary>listen</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>listen</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_listen.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method turns the socket into a server listening socket. The
<emphasis role="italic">backlog</emphasis> is the number of connection
requests the socket should cache.
</para>
</section>

<section id="mthSocketRecv"><title>recv</title>
<indexterm><primary>recv</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>recv</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_recv.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method receives data on a socket connection. The
<emphasis role="italic">length</emphasis> is the maximum number of bytes the
socket should receive. This method returns the data received, which could be
less than the maximum length specified.
</para>
</section>

<section id="mthSocketRecvFrom"><title>recvFrom</title>
<indexterm><primary>recvFrom</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>recvFrom</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_recvfrom.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method receives data on a socket connection from the specified
<emphasis role="italic">address</emphasis>. The <emphasis role="italic">
address</emphasis> must be an instance of the <xref linkend="clsInetAddress" xrefstyle="template:InetAddress" />
class. The <emphasis role="italic">length</emphasis> is the maximum
number of bytes the socket should receive. This method returns the data
received, which could be less than the maximum length specified.
</para>
</section>

<section id="mthSocketSelect"><title>select</title>
<indexterm><primary>select</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>select</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_select.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method monitors activity on a set of sockets. It returns the number
of sockets ready for activity. Upon return the input argument arrays will be
reset to only the sockets that are ready.
</para>
<variablelist>
   <varlistentry>
      <term><emphasis role="bold">reads</emphasis></term>
      <listitem><para>An array of socket instances to monitor for read activity.
      </para></listitem>
   </varlistentry>
   <varlistentry>
      <term><emphasis role="bold">writes</emphasis></term>
      <listitem><para>An array of socket instances to monitor for write
                    activity.
      </para></listitem>
   </varlistentry>
   <varlistentry>
      <term><emphasis role="bold">excepts</emphasis></term>
      <listitem><para>An array of socket instances to monitor for exception
                    activity.
      </para></listitem>
   </varlistentry>
   <varlistentry>
      <term><emphasis role="bold">timeout</emphasis></term>
      <listitem><para>The timeout in seconds. This must be a whole number (no
                   fractions allowed).
      </para></listitem>
   </varlistentry>
</variablelist>
</section>

<section id="mthSocketSend"><title>Send</title>
<indexterm><primary>send</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>send</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_send.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sends the <emphasis role="italic">data</emphasis> on the
socket. It returns the number of bytes sent, which could be less than the length
of <emphasis role="italic">data</emphasis>.
</para>
</section>

<section id="mthSocketSetOption"><title>setOption</title>
<indexterm><primary>setOption</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>setOption</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_setoption.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sets the option given by <emphasis role="italic">name</emphasis>
with the data in <emphasis role="italic">value</emphasis>. See the method
<xref linkend="mthSocketGetOption" xrefstyle="select:title" /> for the list of valid
<emphasis role="italic">name</emphasis>s.
</para>
</section>

<section id="mthSocketString"><title>string</title>
<indexterm><primary>string</primary>
<secondary>of Socket class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>string</secondary>
<tertiary>of Socket class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/socket_string.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the string representing the socket.
</para>
</section>

</section>

<section id="clsInetAddress"><title>InetAddress Class</title>
<!-- modified: renamed init() to new() -->
<!-- $GENERATED-20160822-START rexxrefClassTable(InetAddress) -->
<table id="ooRexxInetAddressClass" frame="all" pgwide="1">
<title>InetAddress Class</title>
<tgroup cols="1">
<tbody>
 <row><entry align="center"><emphasis role="bold">Object</emphasis></entry>
 </row>
<!-- should we link to rexxref here?
 <row><entry>Methods inherited from the <xref linkend="clsObject" xrefstyle="template:Object class"/></entry>
 </row>
-->
 <row><entry align="center"><emphasis role="bold">InetAddress</emphasis></entry>
 </row>
 <row><entry>
  <simplelist>
   <member><xref linkend="mthInetAddressNew" xrefstyle="select:title"/></member>
  </simplelist>
  <simplelist columns="3">
   <member><xref linkend="mthInetAddressAddress" xrefstyle="select:title"/></member>
   <member><xref linkend="mthInetAddressAddressEquals" xrefstyle="select:title"/></member>
   <member><xref linkend="mthInetAddressFamily" xrefstyle="select:title"/></member>
   <member><xref linkend="mthInetAddressFamilyEquals" xrefstyle="select:title"/></member>
   <member><xref linkend="mthInetAddressMakeStem" xrefstyle="select:title"/></member>
   <member><xref linkend="mthInetAddressPort" xrefstyle="select:title"/></member>
   <member><xref linkend="mthInetAddressPortEquals" xrefstyle="select:title"/></member>
  </simplelist>
 </entry></row>
</tbody>
</tgroup>
</table>
<!-- $GENERATED-20160822-END rexxrefClassTable(InetAddress) -->

<section id="mthInetAddressNew"><title>new (Inherited Class Method)</title>
<indexterm><primary>new method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>new method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_new.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method creates a new instance of the InetAddress class.
</para>
<variablelist>
   <varlistentry>
      <term><emphasis role="bold">hostname</emphasis></term>
      <listitem><para>The IP address or host name of the host machine.
      </para></listitem>
   </varlistentry>
   <varlistentry>
      <term><emphasis role="bold">port</emphasis></term>
      <listitem><para>The port number of the connection.
      </para></listitem>
   </varlistentry>
   <varlistentry>
      <term><emphasis role="bold">family</emphasis></term>
      <listitem><para>The address family. The only valid value is AF_INET.
      </para></listitem>
   </varlistentry>
</variablelist>
</section>

<section id="mthInetAddressAddress"><title>address</title>
<indexterm><primary>address method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>address method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_address.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the IP address of the original hostname.
</para>
</section>

<section id="mthInetAddressAddressEquals"><title>address=</title>
<indexterm><primary>address= method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>address= method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_address_equals.svg" scale="55" />
</imageobject>
</mediaobject>

<para>Sets the IP address of the original hostname.
</para>
</section>

<section id="mthInetAddressFamily"><title>family</title>
<indexterm><primary>family method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>family method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_family.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the IP address family of the original hostname.
</para>
</section>

<section id="mthInetAddressFamilyEquals"><title>family=</title>
<indexterm><primary>family= method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>family= method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_family_equals.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sets the IP address family of the original hostname.
</para>
</section>

<section id="mthInetAddressMakeStem"><title>makeStem</title>
<indexterm><primary>makeStem method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>makeStem method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_makestem.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns a stem variable set to the current values of the
instance. This method has limited usefulness to the programmer.
</para>
</section>

<section id="mthInetAddressPort"><title>port</title>
<indexterm><primary>port method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>port method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_port.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns port number of the original hostname.
</para>
</section>

<section id="mthInetAddressPortEquals"><title>port=</title>
<indexterm><primary>port= method</primary>
<secondary>of InetAddress class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>port= method</secondary>
<tertiary>of InetAddress class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/inetaddr_port_equals.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method sets the port number of the original hostname.
</para>
</section>

</section>

<section id="clsHostInfo"><title>HostInfo Class</title>
<!-- modified: renamed init() to new() -->
<!-- $GENERATED-20160822-START rexxrefClassTable(HostInfo) -->
<table id="ooRexxHostInfoClass" frame="all" pgwide="1">
<title>HostInfo Class</title>
<tgroup cols="1">
<tbody>
 <row><entry align="center"><emphasis role="bold">Object</emphasis></entry>
 </row>
<!-- should we link to rexxref here?
 <row><entry>Methods inherited from the <xref linkend="clsObject" xrefstyle="template:Object class"/></entry>
 </row>
-->
 <row><entry align="center"><emphasis role="bold">HostInfo</emphasis></entry>
 </row>
 <row><entry>
  <simplelist>
   <member><xref linkend="mthHostInfoNew" xrefstyle="select:title"/></member>
  </simplelist>
  <simplelist columns="3">
   <member><xref linkend="mthHostInfoAddr" xrefstyle="select:title"/></member>
   <member><xref linkend="mthHostInfoAddress" xrefstyle="select:title"/></member>
   <member><xref linkend="mthHostInfoAlias" xrefstyle="select:title"/></member>
   <member><xref linkend="mthHostInfoMakeStem" xrefstyle="select:title"/></member>
   <member><xref linkend="mthHostInfoName" xrefstyle="select:title"/></member>
  </simplelist>
 </entry></row>
</tbody>
</tgroup>
</table>
<!-- $GENERATED-20160822-END rexxrefClassTable(HostInfo) -->

<section id="mthHostInfoNew"><title>new (Inherited Class Method)</title>
<indexterm><primary>new method</primary>
<secondary>of HostInfo class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>new method</secondary>
<tertiary>of HostInfo class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/hostinfo_new.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method create an instance of the HostInfo class and sets all the
attribute methods of the instance. The <emphasis role="italic">hostname</emphasis>
can be either a valid DNS host name or an IP address.
</para>
</section>

<section id="mthHostInfoAddr"><title>addr</title>
<indexterm><primary>addr method</primary>
<secondary>of HostInfo class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>addr method</secondary>
<tertiary>of HostInfo class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/hostinfo_addr.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns an array of IP addresses of the host.
</para>
</section>

<section id="mthHostInfoAddress"><title>address</title>
<indexterm><primary>address method</primary>
<secondary>of HostInfo class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>address method</secondary>
<tertiary>of HostInfo class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/hostinfo_address.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the main IP address of the host.
</para>
</section>

<section id="mthHostInfoAlias"><title>alias</title>
<indexterm><primary>alias method</primary>
<secondary>of HostInfo class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>alias method</secondary>
<tertiary>of HostInfo class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/hostinfo_alias.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns an array of alias host name of the host.
</para>
</section>

<section id="mthHostInfoMakeStem"><title>makeStem</title>
<indexterm><primary>makeStem method</primary>
<secondary>of HostInfo class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>makeStem method</secondary>
<tertiary>of HostInfo class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/hostinfo_makestem.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns a stem variable set to the current values of the
instance. This method has limited usefulness to the programmer.
</para>
</section>

<section id="mthHostInfoName"><title>name</title>
<indexterm><primary>name method</primary>
<secondary>of HostInfo class</secondary></indexterm>
<indexterm><primary>method</primary>
<secondary>name method</secondary>
<tertiary>of HostInfo class</tertiary></indexterm>

<mediaobject>
<imageobject>
<imagedata fileref="images/methods/hostinfo_name.svg" scale="55" />
</imageobject>
</mediaobject>

<para>This method returns the main host name of the host.
</para>
</section>

</section>

<section id="exampleSocketClass"><title>Socket Class Example</title>
<indexterm><primary>Socket class example</primary></indexterm>
<indexterm><primary>example</primary>
<secondary>of Socket class</secondary></indexterm>
<example id="ex.socketclass">
<title>Socket Class</title>
<programlisting>
<![CDATA[
host = '127.0.0.1'
port = 8080
srvr = .server~new(host, port)
call syssleep(1) -- just to let the server get started
call client host, port, 'This is test 1'
call client host, port, 'This is test 2'
call client host, port, 'stop'
return

::requires 'socket.cls'

::routine client
use strict arg host, port, message
-- get a new socket
s = .socket~new()
-- set the server address/port to connection information
addr = .inetaddress~new(host, port)
-- connect to the server
retc = s~connect(addr)
if retc &lt;&gt; 0 then do
   say 'Error' s~errno() 'connecting to server socket.'
   return
   end
-- send the command
retc = s~send(message)
-- receive the command back
say s~recv(4096)
-- close the socket
s~close()
return

::class server
::method init
use strict arg host, port
-- get a new socket
s = .socket~new()
if s = -1 then do
   say 'Error' s~errno() 'creating server socket'
   return
   end
-- set the socket to reuse the addresses assigned to it
retc = s~setoption('SO_REUSEADDR', 1)
if retc = -1 then do
   say 'Error' s~errno() 'setting socket option'
   return
   end
-- bind the socket to an address/port
addr = .inetaddress~new(host, port)
retc = s~bind(addr)
if retc = -1 then do
   say 'Error' s~errno() 'binding socket'
   return
   end
-- mark it as a listening socket
retc = s~listen(3)
if retc = -1 then do
   say 'Error' s~errno() 'making the socket a listening socket'
   return
   end
say 'Server starting'
reply
stop = .false
do while \stop
   -- accept a client connection socket
   cs = s~accept()
   if cs = .nil then do
      say 'Error accepting new socket'
      iterate
      end
   -- receive the command from the client
   cmd = cs~recv(4096)
   -- echo the command back to the client
   cs~send(cmd)
   -- close the client connection socket
   cs~close()
   -- if the command was stop then stop the server
   if cmd~upper() = 'STOP' then do
      stop = .true
      end
   end
-- close the socket
s~close()
return
]]>
</programlisting>
</example>
</section>

</chapter>

