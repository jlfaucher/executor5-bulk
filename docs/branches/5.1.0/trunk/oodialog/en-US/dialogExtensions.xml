<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "oodialog.ent">
%BOOK_ENTITIES;
]>
<!--#########################################################################
    #
    # Description: Open Object Rexx: ooDialog Reference XML file.
    #
    # Copyright (c) 2005-2025, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    #########################################################################
-->
<section id="clsDialogExtensions" xreflabel="DialogExtensions"><title>DialogExtensions Mixin Class</title>
<indexterm><primary>DialogExtensions Class</primary></indexterm>
<para>
  The <computeroutput>DialogExtensions</computeroutput> class is a <emphasis role="italic">mixin</emphasis> class
  inherited by <xref linkend="clsPlainBaseDialog"/> class. Therefore the methods of this class are
  methods of every dialog. The methods of the <computeroutput>DialogExtensions</computeroutput> class are probably
  methods added after the original release of the ooDialog framework, thus the <emphasis
  role="italic">extensions</emphasis> part of the class name.
</para>

<section id="sctMethodsDialogExtensions"><title>Method Table</title>

<para>
  The following table provides links to the documentation for the methods DialogExtensions Mixin Class:
</para>
<table id="tblDialogExtensionsMethods" frame="all">
<title>DialogExtensions Methods</title>
<tgroup cols="2">
<colspec colwidth="3*" /><colspec colwidth="8*" />
<thead>
<row>
<entry>Method</entry>
<entry>Description</entry>
</row>
</thead>
<tbody>
<row>
<entry><xref linkend="mthAddAutoStartMethod"/></entry>
<entry>Adds a method name and parameters to an internal queue whose items are started automatically and run concurrently when the dialog is executed.</entry>
</row>
<row>
<entry><xref linkend="mthChangeBitmapButton"/></entry>
<entry>Changes the bitmap of a bitmap button.</entry>
</row>
<row>
<entry><xref linkend="mthClearControlRect"/></entry>
<entry>Clears the client area of the specified dialog control by redrawing the area with the background brush set to the default background color of a dialog.</entry>
</row>
<row>
<entry><xref linkend="mthClearRectClsDialogExtensions"/></entry>
<entry>Clears the specified rectangular within the client area of a window.</entry>
</row>
<row>
<entry><xref linkend="mthClearWindowRect"/></entry>
<entry>Erases the client area of the given window.</entry>
</row>
<row>
<entry><xref linkend="mthCreateBrushClsDialogExtensions"/></entry>
<entry>Creates a logical brush that has the specified style, color, and pattern.</entry>
</row>
<row>
<entry><xref linkend="mthDetermineSBPosition"/></entry>
<entry>Calculates and sets the new scroll bar position based on the position data retrieved from the scroll bar and the step information.</entry>
</row>
<row>
<entry><xref linkend="mthDimBitmap"/></entry>
<entry>Draws a bitmap step by step.</entry>
</row>
<row>
<entry><xref linkend="mthDisplaceBitmap"/></entry>
<entry>Sets the position of the bitmap within a bitmap button.</entry>
</row>
<row>
<entry><xref linkend="mthDrawBitmap"/></entry>
<entry>Draws the bitmap for a bitmap button at the specified position.</entry>
</row>
<row>
<entry><xref linkend="mthDrawButton"/></entry>
<entry>Draws the specified button.</entry>
</row>
<row>
<entry><xref linkend="mthEndAsyncExecution"/></entry>
<entry>Used to end the asynchronous execution of a dialog started using the executedAsync method.</entry>
</row>
<row>
<entry><xref linkend="mthExecuteAsync"/></entry>
<entry>Creates the underlying Windows dialog, starts it executing, shows it in the same way as the execute method does, and returns immediately.</entry>
</row>
<row>
<entry><xref linkend="mthFreeControlDC"/></entry>
<entry>Releases the device context of a control.</entry>
</row>
<row>
<entry><xref linkend="mthFreeWindowDC"/></entry>
<entry>Releases the device context of a window.</entry>
</row>
<row>
<entry><xref linkend="mthGetBitmapPosition"/></entry>
<entry>Retrieves the position, as a point, of the upper left corner of a bitmap within a bitmap button.</entry>
</row>
<row>
<entry><xref linkend="mthGetBitmapSizeX"/></entry>
<entry>Retrieves the width of the bitmap that is set for a bitmap button.</entry>
</row>
<row>
<entry><xref linkend="mthGetBitmapSizeY"/></entry>
<entry>Retrieves the height of the bitmap that is set for a bitmap button.</entry>
</row>
<row>
<entry><xref linkend="mthGetBmpDisplacement"/></entry>
<entry>Retrieves the position of the bitmap within a bitmap button.</entry>
</row>
<row>
<entry><xref linkend="mthGetControlDC"/></entry>
<entry>Returns the device context of a dialog control.</entry>
</row>
<row>
<entry><xref linkend="mthGetControlRect"/></entry>
<entry>Returns the size and position rectangle of the specified dialog control.</entry>
</row>
<row>
<entry><xref linkend="mthGetListItemHeight"/></entry>
<entry>Returns the height of the items in a list box in dialog units. <emphasis role="bold">(Inaccurate)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthGetListItemHeightPx"/></entry>
<entry>Returns the height of the items in a list box in pixels.</entry>
</row>
<row>
<entry><xref linkend="mthGetListWidth"/></entry>
<entry>Returns the scrollable width of a list box in dialog units. <emphasis role="bold">(Inaccurate)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthGetListWidthPx"/></entry>
<entry>Returns the scrollable width of a list box in pixels.</entry>
</row>
<row>
<entry><xref linkend="mthGetSBPos"/></entry>
<entry>Returns the current position of a scroll bar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetSBRange"/></entry>
<entry>Returns the range of a scroll bar control.</entry>
</row>
<row>
<entry><xref linkend="mthGetWindowDC"/></entry>
<entry>Returns the device context of a window.</entry>
</row>
<row>
<entry><xref linkend="mthInstallAnimatedButton"/></entry>
<entry>Installs an animated button and runs it concurrently with the main activity.</entry>
</row>
<row>
<entry><xref linkend="mthInstallBitmapButton"/></entry>
<entry>Connects bitmap(s) and a method with a push button.</entry>
</row>
<row>
<entry><xref linkend="mthMoveControl"/></entry>
<entry>Moves a dialog control to another position within the dialog window.</entry>
</row>
<row>
<entry><xref linkend="mthPopup"/></entry>
<entry>Starts a modeless dialog executing and returns immediately.</entry>
</row>
<row>
<entry><xref linkend="mthPopupAsChild"/></entry>
<entry>Assigns a parent dialog, starts a modeless dialog executing, and returns immediately. The dialog is closed automatically when the parent dialog ends.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawControl"/></entry>
<entry>Redraws the specified dialog control.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawRectClsDialogExtensions"/></entry>
<entry>Redraws a rectangle within the client area of this dialog, or optionally the client area of a specified window.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawWindow"/></entry>
<entry>Redraws the specified window.</entry>
</row>
<row>
<entry><xref linkend="mthRedrawWindowRect"/></entry>
<entry>Forces this dialog to completely redraw its client area, or optionally the client area of a specified window.</entry>
</row>
<row>
<entry><xref linkend="mthResizeControl"/></entry>
<entry>Changes the size of a dialog control.</entry>
</row>
<row>
<entry><xref linkend="mthScrollBitmapFromTo"/></entry>
<entry>Scrolls the bitmap within the bitmap button from one position to another.</entry>
</row>
<row>
<entry><xref linkend="mthScrollButton"/></entry>
<entry>Moves a rectangle within the button and redraws the uncovered area with the button background color.</entry>
</row>
<row>
<entry><xref linkend="mthScrollInControl"/></entry>
<entry>Scrolls text in a dialog control using the specified font.</entry>
</row>
<row>
<entry><xref linkend="mthScrollText"/></entry>
<entry>Scrolls text in the specified window using the specified font.</entry>
</row>
<row>
<entry><xref linkend="mthSetBitmapPosition"/></entry>
<entry>Sets the position of the upper left corner of a bitmap within the bitmap button.</entry>
</row>
<row>
<entry><xref linkend="mthSetControlFont"/></entry>
<entry>Changes the font for specified dialog control.</entry>
</row>
<row>
<entry><xref linkend="mthSetControlColor"/></entry>
<entry>Sets the background color, and optionally the text color, for the specified dialog control.</entry>
</row>
<row>
<entry><xref linkend="mthSetControlSysColor"/></entry>
<entry>Sets the background color, and optionally the text color, for the specified dialog control using the system colors.</entry>
</row>
<row>
<entry><xref linkend="mthSetForegroundWindow"/></entry>
<entry>Brings the specified window to the foreground.</entry>
</row>
<row>
<entry><xref linkend="mthSetListColumnWidth"/></entry>
<entry>Sets the width of all columns in a list box in dialog units. <emphasis role="bold">(Inaccurate)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthSetListColumnWidthPx"/></entry>
<entry>Sets the width of all columns in a list box in pixels.</entry>
</row>
<row>
<entry><xref linkend="mthSetListItemHeight"/></entry>
<entry>Sets the height for all items in a list box in dialog units. <emphasis role="bold">(Inaccurate)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthSetListItemHeightPx"/></entry>
<entry>Sets the height for all items in a list box in pixels.</entry>
</row>
<row>
<entry><xref linkend="mthSetListWidth"/></entry>
<entry>Sets the scrollable width of a list box in dialog units. <emphasis role="bold">(Inaccurate)</emphasis></entry>
</row>
<row>
<entry><xref linkend="mthSetListWidthPx"/></entry>
<entry>Sets the scrollable width of a list box in pixels.</entry>
</row>
<row>
<entry><xref linkend="mthSetSBPos"/></entry>
<entry>Sets the current position of a scroll bar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetSBRange"/></entry>
<entry>Sets the range of a scroll bar control.</entry>
</row>
<row>
<entry><xref linkend="mthSetSBRange"/></entry>
<entry>Changes the size and position of the specified window.</entry>
</row>
<row>
<entry><xref linkend="mthWriteToWindow"/></entry>
<entry>Writes text to the dialog or dialog control, specified by its window handle, in the given font at the specified position.</entry>
</row>
<row>
<entry><xref linkend="mthWriteToControl"/></entry>
<entry>Writes text to the dialog control, specified by its resource ID, in the given font at the specified position.</entry>
</row>
</tbody></tgroup>
</table>
</section>


<section id="mthAddAutoStartMethod" xreflabel="addAutoStartMethod"><title>addAutoStartMethod</title>
<indexterm><primary>addAutoStartMethod</primary></indexterm>
<programlisting>
<![CDATA[
>>--addAutoStartMethod(--+---------+--,--methodName--+---------------+--)------><
                         +-inClass-+                 +-,--parameters-+


]]>
</programlisting>

<para>The addAutoStartMethod method adds a method name
and parameters to a special internal queue. All methods in this queue will
be started automatically and run concurrently when the dialog is executed.
The given method (MethodName) in the given class (InClass) is started concurrently with the dialog when
the dialog is activated using the <xref linkend="mthExecute"/> or <xref linkend="mthExecuteAsync"/> method. This is useful for processing animated
buttons. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>inClass</term>
<listitem><para>The class where the method is defined. If this argument is omitted,
the method is assumed to be defined in the dialog class.
</para></listitem></varlistentry>
<varlistentry><term>methodName</term>
<listitem><para>The name of the method
</para></listitem></varlistentry>
<varlistentry><term>parameters</term>
<listitem><para>All parameters that are passed to this method
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example installs the ExecuteB method
of the MyAnimatedButton class so that it is processed
concurrently with the dialog execution:

<programlisting>
<![CDATA[
MyDialog~addAutoStartMethod("MyAnimatedButton", "ExecuteB")

::class MyAnimatedButton
::method ExecuteB
     .
     .
     .
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthChangeBitmapButton" xreflabel="changeBitmapButton"><title>changeBitmapButton</title>
<indexterm><primary>changeBitmapButton</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>changeBitmapButton</secondary></indexterm>
<programlisting>
<![CDATA[

>>--changeBitmapButton(--id-,-bN--+------+--+------+--+------+--+--------+--)--><
                                  +-,-bF-+  +-,-bS-+  +-,-bD-+  +-,-opts-+

]]>
</programlisting>

<para>
  Changes the bitmaps for an already <xref linkend="mthInstallBitmapButton"/> bitmap button and
  optionally immediately redraws the button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID for the bitmap button whose bitmaps are being changed. May be numeric or
        <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bN [required]</term>
      <listitem>
      <para>
        The bitmap to use for the normal state of the button. See the remarks for information on how the bitmap may be
        specified.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>focused [optional]</term>
      <listitem>
      <para>
        The bitmap to use for the focused state of the button. See the remarks for information on how the bitmap may be
        specified. If this argument is omitted, the normal bitmap is used for the focused state.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>selected [optional]</term>
      <listitem>
      <para>
        The bitmap to use for the selected state of the button. See the remarks for information on how the bitmap may be
        specified. If this argument is omitted, the normal bitmap is used for the selected state.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>disabled [optional]</term>
      <listitem>
      <para>
        The bitmap to use for the disabled state of the button. See the remarks for information on how the bitmap may be
        specified. If this argument is omitted, the normal bitmap is used for the disabled state.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>style [optional]</term>
      <listitem>
      <para>
        A list of 0 or more of the following keywords separated by spaces, case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>FRAME   </member>
          <member>USEPAL  </member>
          <member>INMEMORY</member>
          <member>STRETCH </member>
          <member>NODRAW  </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>FRAME</term>
          <listitem>
          <para>
            With this option, when the ooDialog framework draws the bitmap button, it attempts to draw it with the 3D
            effect. Note that the drawing method is outdated and will give a somewhat different appearance to the button
            than that of buttons in modern Windows versions.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>USEPAL</term>
          <listitem>
          <para>
            Uses the colors of the bitmap for the normal state to create a system color palette. Use this option when
            the bitmap was created with a palette other than the default Windows color palette. This palette is used
            when drawing all of the bitmap states so when different bitmaps are used for the different states, they
            should all use the same colors.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>INMEMORY</term>
          <listitem>
          <para>
            The bitmaps can be loaded into memory through the <xref linkend="mthLoadBitmap"/> method. In
            this case, the programmer uses the bitmap handle to specify the bitmaps and <emphasis
            role="bold">must</emphasis> use the INMEMORY keyword.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>STRETCH</term>
          <listitem>
          <para>
            If the size of the bitmap is smaller than the size of the button rectangle, the bitmap is stretched to match
            the size of the button. This option has no effect on bitmaps loaded from a dynamic-link library.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>NODRAW</term>
          <listitem>
          <para>
            By default, when the button bitmaps are changed, the button is immediately redrawn. If this keyword is used,
            the button is not redrawn immediately. The next time the button needs to be redrawn, it will be redrawn
            using the new bitmaps.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 for success. On error returns -1 if the resource ID was symbolic and it could not be resolved to a numeric
    ID, or 1 for any other error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The arguments specifying the bitmaps can be a bitmap file name, a bitmap <xref linkend="defHandle"/>, or
    the resource number of a bitmap compiled into the resource DLL of a <xref linkend="clsResDialog"/>.
    The bitmap arguments must all be the same type. I.e. all file names, all resource IDs, or all handles. Symbolic
    resource IDs can be used for the bitmap arguments. If the bitmap arguments are handles the style argument must
    contain the INMEMORY keyword.
  </para>
  <para>
    The bitmap button must have already been assigned bitmaps, if there are no assigned bitmaps this method fails. All
    of the existing assigned bitmaps are removed, the programmer must reassign all 4 bitmaps, even if the bitmap for some
    state is the same as the previous bitmap.
  </para>
  <para>
    In ooDialog a bitmap button is an owner-drawn button that uses the supplied bitmap(s) for the button. ooDialog
    internally handles the drawing of the button.
  </para>
  <para>
    Up to 4 bitmaps can be assigned to the button. These bitmaps are drawn for the different button states: normal,
    focused, selected and disabled. The normal bitmap must be supplied and that bitmap is used for any of the other
    states if no bitmap for the state is supplied.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
<programlisting>
<![CDATA[

  self~changeBitmap("IDOK", "AddBut_n.bmp", "AddBut_f.bmp", -
                    "AddBut_s.bmp", "AddBut_d.bmp", "FRAME")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::changeBitmapButton() -->


<section id="mthClearControlRect" xreflabel="clearControlRect"><title>clearControlRect</title>
<indexterm><primary>clearControlRect</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>clearControlRect</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>clearControlRect</secondary></indexterm>
<programlisting>
<![CDATA[
>>--clearControlRect(--id--)---------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">clearControlRect</emphasis> clears the client area of the specified dialog control by
  redrawing the area with the background brush set to the default background color of a dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource id of the dialog control that is to be cleared. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    0 on success, or 1 on any error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The client area of the control is not really <emphasis role="italic">cleared</emphasis>, but rather the dialog
    background is painted over the top of the area. Most dialog controls do not have a border, but if the control does
    have a border, the border is not cleared because it is outside of the client area.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End dialog object::clearControlRect() -->


<section id="mthClearRectClsDialogExtensions" xreflabel="clearRect"><title>clearRect</title>
<indexterm><primary>clearRect</primary><secondary>dialog object</secondary></indexterm>
<indexterm><primary>dialog object</primary><secondary>clearRect</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>clearRect</secondary></indexterm>
<programlisting>
<![CDATA[
Form 1:

>>--clearRect(--hwnd--,--rectangle--)------------><


Form 2:

>>--clearRect(--hwnd--,--pt1--,--pt2--)----------><


Form 3:

>>--clearRect(--hwnd--,--x--,--y--,--x1--,--y1--)---------------><


Generic form:

>>--clearRect(--hwnd--,--rectCoordinates--)------><


]]>
</programlisting>

<para>
  The <emphasis role="italic">clearRect</emphasis> method clears the specified bounding <xref
  linkend="ovvRectangleCoordinates"/> within the client area of a window. The rectangle is
  <emphasis role="italic">cleared</emphasis> by redrawing it with the background brush set to the typical background
  color for dialog boxes and three dimensional elements.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>hwnd [required]</term>
      <listitem>
      <para>
        The <xref linkend="defHandle"/> of the window containing the rectangle to be cleared.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>rectCoordinates [required]</term>
      <listitem>
      <para>
        The coordinates of the rectangle to be cleared. The coordinates specify the upper left and lower right corners
        of the rectangle. The corners can be specified using either a <xref linkend="clsRect"/> object, two
 <xref linkend="clsPoint"/> objects, or the individual x and y coordinates of each corner.
      </para>
      <para>
        The coordinates are specified as <xref linkend="defClientArea"/> coordinates, in pixels.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    0 on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The rectangle is not really cleared, but rather is redrawn using the normal background color for a dialog box.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example is a complete program, it can be copy and pasted into a file and executed. Running the program and
    reading the code should give a better understanding of the <emphasis role="italic">clearRect</emphasis> method than
    a text description alone.

<programlisting>
<![CDATA[

/* Shows clearRect() at work. */

  dlg = .Simple~new
  dlg~execute("SHOWTOP")

  return 0
-- End of entry point.

::requires "ooDialog.cls"

::class 'Simple' subclass UserDialog

::method init

  forward class (super) continue
  self~createCenter(245, 132, "clearRect() Example")

::method defineDialog

  self~createGroupBox(100, 10, 13, 107, 70, , "Test Group Box")
  self~createListView(200, 130, 13, 107, 70, "REPORT")

  self~createPushButton(300, 115, 108, 65, 14, , "Clear Group Box", onClear)
  self~createPushButton(IDOK, 185, 108, 50, 14, "DEFAULT", "Ok")

::method initDialog
  expose list gb pb

  list = self~newListView(200)

  list~insertColumn(0, "Text", 40)
  list~insertColumn(1, "Number", 30)
  do i = 1 to 3
    list~addRow(i, , "Line", i)
  end

  gb = self~newGroupBox(100)
  pb = self~newPushButton(300)

::method onClear unguarded
  expose list gb pb

  text = pb~getText
  select
    when text == "Clear Group Box" then do
      text = "Clear List View"
      r = gb~clientRect
      r~right %= 2
      r~bottom %= 2
      self~clearRect(gb~hwnd, r)
    end
    when text == "Clear List View" then do
      text = "Refresh"
      self~clearRect(list~hwnd, 10, 10, 55, 80)
    end
    otherwise do
      text = "Clear Group Box"
      gb~redrawClient
      list~redrawClient
    end
  end
  -- End select

  pb~setText(text)


]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End dialog object::clearRect() -->


<section id="mthClearWindowRect" xreflabel="clearWindowRect"><title>clearWindowRect</title>
<indexterm><primary>clearWindowRect</primary></indexterm>
<programlisting>
<![CDATA[
>>--clearWindowRect(--hwnd--)--------------------><


]]>
</programlisting>

<para>The clearWindowRect method erases the client area
of the given window. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hwnd</term>
<listitem><para>The handle of the window. See <xref linkend="mthGetSelf"/>, <xref linkend="mthGet"/>, or
<xref linkend="mthGetControlHandle"/> for some methods to get a window handle.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example gets the window handle of a dialog control with the symbolic resource ID of
IDC_PB_DONE and then clears the dialog control window:

<programlisting>
<![CDATA[
hwnd = self~getControlHandle(IDC_PB_DONE)
MyDialog~clearWindowRect(hwnd)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthCreateBrushClsDialogExtensions" xreflabel="createBrush"><title>createBrush</title>
<indexterm><primary>createBrush</primary><secondary>DialogExtensions</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>createBrush</secondary></indexterm>
<indexterm><primary>dialog object</primary><secondary>createBrush</secondary></indexterm>
<programlisting>
<![CDATA[
>>--createBrush(--+---------+--+-------------------+--)------------------------><
                  +--color--+  +-,-brushSpecifier--+

]]>
</programlisting>

<para>
  The <emphasis role="italic">createBrush</emphasis> method creates a logical brush that has the specified style, color,
  and pattern.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    Both arguments are optional. If both arguments are omitted then a hollow brush is created. Otherwise, the arguments
    are:
  <variablelist>
    <varlistentry><term>color [optional]</term>
    <listitem>
    <para>
      The <xref linkend="defColor"/>. When this argument is omitted and <emphasis
      role="italic">brushSpecifier</emphasis> is used, the color number defaults to 1.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>brushSpecifier [optional]</term>
    <listitem>
    <para>
      If this argument is omitted a solid brush using the color specified is created.  Otherwise, this argument can be
      the name of a bitmap file, the resource ID of a bitmap compiled in the resource only DLL of a
 <xref linkend="clsResDialog"/>, or one of the following keywords. The keywords create a hatched brush. A
      bitmap file name will cause the bitmap to be loaded into memory and then used for the brush. Case is not
      significant in the keywords.
    </para>
    <para>
    <simplelist type='vert' columns='2'>
      <member>UPDIAGONAL  </member>
      <member>CROSS       </member>
      <member>DIAGCROSS   </member>
      <member>DOWNDIAGONAL</member>
      <member>HORIZONTAL  </member>
      <member>VERTICAL    </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>UPDIAGONAL</term>
      <listitem>
      <para>
        A 45-degree upward, left-to-right hatch.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CROSS</term>
      <listitem>
      <para>
        A horizontal and vertical crosshatch.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DIAGCROSS</term>
      <listitem>
      <para>
        A 45-degree crosshatch.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>DOWNDIAGONAL</term>
      <listitem>
      <para>
        A 45-degree downward, left-to-right hatch.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>HORIZONTAL</term>
      <listitem>
      <para>
        A horizontal hatch.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>VERTICAL</term>
      <listitem>
      <para>
        A vertical hatch.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A brush is a bitmap that the operating system uses to paint the interiors of filled shapes. After the programmer
    creates a brush, it can then be selected into a device context using the <xref linkend="mthObjectToDC"/>
    method. When the brush is no longer needed use the <xref linkend="mthDeleteObject"/> method to
    release the operating resources used by the brush.
  </para>
  <para>
    When <emphasis role="italic">brushSpecifier</emphasis> is a non-negative whole number, it is taken to be the
    resource ID of a bitmap compiled in to the resource only DLL of a <computeroutput>ResDialog</computeroutput>. If the
    dialog is not a <computeroutput>ResDialog</computeroutput>, or if there is no matching bitmap in the DLL, the method
    fails. Note that, technically, if the dialog is not a <computeroutput>ResDialog</computeroutput>, the
    <computeroutput>ooDialog.dll</computeroutput> is searched for the bitmap. However, since there are currently no
    bitmaps compiled in to <computeroutput>ooDialog.dll</computeroutput>, the restriction that the dialog must be a
    <computeroutput>ResDialog</computeroutput> is essentially correct.
  </para>
  <para>
    The <emphasis role="italic">createBrush</emphasis> method here is almost identical to the
 <xref linkend="mthCreateBrush"/> method of the
 <xref linkend="clsWindowExtensions"/> class. The method documented here is a method of the
 <xref linkend="clsDialogExtensions"/> class and is therefore inherited only by the
    <xref linkend="chpDialogObject"/> object.
  </para>
  <para>
    In the dialog object, the <emphasis role="italic">createBrush</emphasis> method of the
    <computeroutput>DialogExtensions</computeroutput> class over-rides the <emphasis
    role="italic">createBrush</emphasis> method of the <computeroutput>WindowExtensions</computeroutput> class.
    Therefore, this documentation is essentially the dialog object's <emphasis role="italic">createBrush</emphasis>
    documentation. The <xref linkend="mthCreateBrush"/> documentation is for the dialog control
    object's <emphasis role="italic">createBrush</emphasis> method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthDetermineSBPosition" xreflabel="determineSBPosition"><title>determineSBPosition</title>
<indexterm><primary>determineSBPosition</primary></indexterm>
<programlisting>
<![CDATA[
>>--determineSBPosition(--id--,--posdata--+-----------+--+---------+--)--------><
                                          +-,-single--+  +-,-page--+

]]>
</programlisting>

<para>The determineSBPosition method calculates and sets
the new scroll bar position based on the position data retrieved from the
scroll bar and the step information.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Protected:</emphasis></term>
<listitem><para>This method is protected.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the scroll bar.
</para></listitem></varlistentry>
<varlistentry><term>posdata</term>
<listitem><para>The position information sent with the connected scroll bar event.
</para></listitem></varlistentry>
<varlistentry><term>single</term>
<listitem><para>This number is added (or subtracted if negative) to the current position
for a single step. If omitted, the single step size is 1.
</para></listitem></varlistentry>
<varlistentry><term>page</term>
<listitem><para>This number is added (or subtracted if negative) to the current position
for a page step. If omitted, the page step size is 10.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The new scroll bar position.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example demonstrates how to update the scroll bar position.
Each time the ScrollBarEventHandler is called by an event for scroll bar SB_SIZE,
the position of the scroll bar is calculated and updated. <computeroutput>posdata</computeroutput> is
sent along with the scroll bar event.

<programlisting>
<![CDATA[
   /* Method ScrollBarEventHandler is connected to item SB_SIZE */
::method ScrollBarEventHandler
    use arg posdata, sbwnd
    pos = self~determineSBPosition("SB_SIZE",posdata,1,25)
    return pos

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthDimBitmap" xreflabel="dimBitmap"><title>dimBitmap</title>
<indexterm><primary>dimBitmap</primary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>dimBitmap</secondary></indexterm>
<programlisting>
<![CDATA[
>>--dimBitmap(--id-,-bmp-,-cx-,-cy--+---------+--+---------+--+---------+--)---><
                                    +-,-stepX-+  +-,-stepY-+  +-,-steps-+

]]>
</programlisting>

<para>
  Draws a bitmap on the client area of a button control step by step.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the button. May be numeric or symbolic.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bmp [required]</term>
      <listitem>
      <para>
        A handle to the bitmap loaded with <xref linkend="mthLoadBitmap"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>cx, cy [required]</term>
      <listitem>
      <para>
        The width and height of the bitmap.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>stepx, stepy [optional]</term>
      <listitem>
      <para>
        The number of pixels to increment the x and y position of the bitmap at each step. The default is 2 pixels for
        both <emphasis role="italic">cx</emphasis> and <emphasis role="italic">cy</emphasis>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>steps [optional]</term>
      <listitem>
      <para>
        The number of iterations used to draw the bitmap. The bitmap is redrawn at each step. The default is 10.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and -1 if an error is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is only intended to be used with button controls. It will fail if the resource ID argument specifies a
    dialog control that is not a button.
  </para>
  <para>
    The <xref linkend="ovvUnderlying"/> Windows dialog must exist to use this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthDisplaceBitmap" xreflabel="displaceBitmap"><title>displaceBitmap</title>
<indexterm><primary>displaceBitmap</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>displaceBitmap</secondary></indexterm>
<programlisting>
<![CDATA[
>>--displaceBitmap(--id--,--x--,--y--)-----------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">displaceBitmap</emphasis> method sets the position of a bitmap within the
  <xref linkend="defClientArea"/> of a bitmap button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
    <varlistentry><term>x [required]</term>
    <listitem>
    <para>
      The x coordinate of the top left corner of the bitmap within the client area of the bitmap button.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>y [required]</term>
    <listitem>
    <para>
      The y coordinate of the upper left corner of the bitmap within the client area of the bitmap button.
    </para>
    </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Both the x and y coordinates are in pixels and can have negative values.
  </para>
  <para>
    Recall that client area coordinates are specified in relation to the (0, 0) point of the client area of a window.
    Negative values then place the bitmap outside of the client area of the bitmap
  </para>
  <para>
    The <xref linkend="mthSetBitmapPosition"/> method is most likely a better method to
    use than the <emphasis role="italic">displaceBitmap</emphasis>.  It accepts either a
    <computeroutput>Point</computeroutput> object or the individual x and y coordinates to specify the position of the
    bitmap. <emphasis role="italic">Set position</emphasis> more accurately describes what the method does than
    <emphasis role="italic">displace</emphasis>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example moves the bitmap within the associated bitmap button 4 screen pixels to the right and 3
    pixels upward. Contrast this with the setBitmapPosition <link linkend="exampleSetBitmapPosition">example</link>:

<programlisting>
<![CDATA[

  parse value self~getBmpDisplacement(IDC_PB_BITMAP1) with dx dy
  if dx <> -1 then do
    dx += 4
    dy -=3
    self~displaceBitmap(IDC_PB_BITMAP1, dx, dy)
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::displaceBitmap() -->


<section id="mthDrawBitmap" xreflabel="drawBitmap"><title>drawBitmap</title>
<indexterm><primary>drawBitmap</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>drawBitmap</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>drawBitmap</secondary></indexterm>
<programlisting>
<![CDATA[

>>--drawBitmap(--+--------+--,--id--+------+--+------+--+---------+------------>
                 +--hwnd--+         +-,-x--+ -+-,-y--+ -+-,-bmpX--+

>--+---------+--+----------+--+-----------+--)---------------------------------><
   +-,-bmpY--+  +-,-width--+  +-,-height--+

]]>
</programlisting>

<para>
  Draws all, or part of, the bitmap for a bitmap button at the specified position.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>hwnd [optional]</term>
      <listitem>
      <para>
        The window <xref linkend="defHandle"/> of the bitmap button. This argument is, and has always been,
        ignored. It is simply retained for backwards compatibility.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the bitmap button. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>x, y [optional]</term>
      <listitem>
      <para>
        The client area <xref linkend="defScreenCoordinates"/> where the upper left corner of the
        bitmap is to be drawn, in pixels. The default is (0, 0).
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bmpX, bmpY [optional]</term>
      <listitem>
      <para>
        The coordinates in the bitmap for the upper left corner of the portion that is to be drawn. The default is (0,
        0). This, along with the <emphasis role="italic">width</emphasis> and <emphasis role="italic">height</emphasis>
        arguments, can be used to draw only a portion of the bitmap. For instance, to draw only the lower right quadrant
        of the bitmap, this argument could be set to the mid point of the bitmap.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>width [optional]</term>
      <listitem>
      <para>
        The width, starting from ()<emphasis role="italic">bmpX</emphasis>, <emphasis role="italic">bmpY</emphasis>) of
        the bitmap of the portion for the bitmap being drawn. If omitted or 0, the remaining width of the bitmap is
        drawn.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>height [optional]</term>
      <listitem>
      <para>
        The height, starting from ()<emphasis role="italic">bmpX</emphasis>, <emphasis role="italic">bmpY</emphasis>) of
        the bitmap for the portion of the bitmap being drawn. If omitted or 0, the remaining height of the bitmap is
        drawn.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success or 1 for error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is only for bitmaps that have been assigned to a bitmap button through the
 <xref linkend="mthInstallBitmapButton"/> method. If there is no bitmap assigned to the button
    then 1 is returned.
  </para>
  <para>
    Unlike the <xref linkend="mthSetBitmapPosition"/> method, which permanently sets the
    position for the bitmap, the <emphasis role="italic">drawBitmap</emphasis> immediately draws the bitmap, or part of
    it, at the specified position. If the button needs to be redrawn, maybe because the window was covered and then
    uncovered, the bitmap is drawn at the position set with <emphasis role="italic">setBitmapPosition</emphasis>.
    <emphasis role="italic">drawBitmap</emphasis> is used by
 <xref linkend="mthScrollBitmapFromTo"/>, for example.
  </para>
  <para>
    You can use the <emphasis role="italic">drawBitmap</emphasis> method to animate a bitmap by providing a bitmap that
    contains several images and use the offset and extension arguments to display a single image of the bitmap.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::drawBitmap() -->


<section id="mthDrawButton" xreflabel="drawButton"><title>drawButton</title>
<indexterm><primary>drawButton</primary></indexterm>
<programlisting>
<![CDATA[
>>--drawButton(--id--)---------------------------><


]]>
</programlisting>

<para>The drawButton method draws the given button. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the button
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthEndAsyncExecution" xreflabel="endAsyncExecution"><title>endAsyncExecution</title>
<indexterm><primary>endAsyncExecution</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>endAsyncExecution</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>endAsyncExecution</secondary></indexterm>
<programlisting>
<![CDATA[
>>--endAsyncExecution----------------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">endAsyncExecution</emphasis> method is used to end the asynchronous execution of a dialog
  started using the <xref linkend="mthExecuteAsync"/> method. The <emphasis
  role="italic">endAsyncExecution</emphasis> method does not return until the user closes the dialog.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The method does not take any arguments.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return values are the same as for the <xref linkend="mthExecute"/> method and are:
    <variablelist>
      <varlistentry><term>0</term>
      <listitem>
      <para>
        Some error occurred, the dialog was not executed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>1</term>
      <listitem>
      <para>
        The user terminated the dialog using an ok command.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>2</term>
      <listitem>
      <para>
        The user terminated the dialog using a cancel command.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Every dialog that is started using the <xref linkend="mthExecuteAsync"/> method must have a
    matching <emphasis role="italic">endAsyncExecution</emphasis> invocation. This is the only way to ensure the proper
    termination of the dialog. This does not apply of course if the invocation of <emphasis
    role="italic">executeAsync</emphasis> failed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The executeAsync <link linkend="exampleExecuteAsync">example</link> shows the proper use of the <emphasis
  role="italic">endAsyncExecution</emphasis> method.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::endAsyncExecution() -->


<section id="mthExecuteAsync" xreflabel="executeAsync"><title>executeAsync</title>
<indexterm><primary>executeAsync</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>executeAsync</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>executeAsync</secondary></indexterm>
<programlisting>
<![CDATA[
>>--executeAsync(--+-----------+--+----------------+--+----------+--)----------><
                   +--ignored--+  +-,--showOption--+  +-,--icon--+
]]>
</programlisting>

<para>
  The <emphasis role="italic">executeAsync</emphasis> method creates the <xref linkend="ovvUnderlying"/>
  Windows dialog, starts it executing, and shows it in the same way as the <xref linkend="mthExecute"/>
  method does. However, <emphasis role="italic">executeAsync</emphasis> does not wait for the dialog to be closed,
  rather it returns immediately. This allows the programmer to execute other Rexx statements asynchronously with the
  dialog execution. The <xref linkend="mthEndAsyncExecution"/> method is used to halt the
  asynchronously execution and wait for the dialog to be closed.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>ignored [optional]</term>
      <listitem>
      <para>
        This argument is completely ignored. It is a hold over from older versions of ooDialog, versions prior to 4.0.0.
        However, for backwards program compatibility the argument must be returned. The programmer should omit the
        argument altogether, or could put in any value as a place holder.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>showOption [optional]</term>
      <listitem>
      <para>
        Zero or one of the following keywords to specify how the dialog is shown. This keyword is used in the automatic
        invocation of the <xref linkend="mthShowClsPlainBaseDialog"/> method. Case is not significant. If this
        argument is omitted, the NORMAL keyword is used:
        <variablelist>
          <varlistentry><term>NORMAL</term>
          <listitem>
          <para>
            Makes the dialog visible in its default position and window size. This has the effect of restoring the dialog size
            and position if it is minimized or maximized. This is the default if the argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFAULT</term>
          <listitem>
          <para>
            DEFAULT is an alias for NORMAL. The two keywords are functionally identical.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SHOWTOP</term>
          <listitem>
          <para>
            Makes the dialog visible and the topmost window.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HIDE</term>
          <listitem>
          <para>
            Makes the dialog invisible.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MIN</term>
          <listitem>
          <para>
            Minimizes the dialog and activates the next window in the window order.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MAX</term>
          <listitem>
          <para>
            Maximizes, and makes visible if necessary, the dialog.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>INACTIVE</term>
          <listitem>
          <para>
            Makes the dialog visible without changing the active window.  When the NORMAL keyword is used, the dialog is shown
            and becomes the active window. The INACTIVE keyword makes the dialog visible without changing the focus from the
            current active window.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RESTORE</term>
          <listitem>
          <para>
            Makes the dialog visible and restores it to its original size and position if it was minimized or maximized. An
            application should specify this flag when restoring a minimized window.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>icon [optional]</term>
      <listitem>
      <para>
        The resource ID of the <xref linkend="defDialogIcon"/>. May be numeric or <xref linkend="defSymbolicId"/>. If an
        icon ID is not supplied, the default ooDialog icon will be used.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return values are:
    <variablelist>
      <varlistentry><term>0</term>
      <listitem>
      <para>
        The dialog was created and shown without problems. The dialog is currently executing.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>1</term>
      <listitem>
      <para>
        An error occurred, the dialog was not created and is not executing. Do not invoke
 <xref linkend="mthEndAsyncExecution"/> in this case.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Although any of the show keywords can be used, for the <emphasis role="italic">executeAsync</emphasis> method the
    SHOWTOP, HIDE, and MAX keywords make the most sense. SHOWTOP is the usual keyword. Rather than use the HIDE keyword,
    it is more practical to simply create the dialog <emphasis role="bold">without</emphasis> the VISIBLE style.
  </para>
  <para>
    If another ooDialog dialog has been started by the Rexx program, it is disabled when <emphasis
    role="italic">executeAsync</emphasis> is invoked. This in effect makes the dialog a
    <xref linkend="defModalModeless"/> dialog. To start a <emphasis role="italic">modeless</emphasis> dialog use the <xref
    linkend="mthPopup"/> or <xref linkend="mthPopupAsChild"/> methods.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleExecuteAsync"><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows an application that creates a <emphasis role="italic">tool palette</emphasis> dialog. The tool
    palette dialog can not be executed until its underlying owner dialog has been created. So the main dialog is
    started using <emphasis role="italic">executeAsync</emphasis>, then the palette dialog is executed, and finally
 <xref linkend="mthEndAsyncExecution"/> is used to wait for the main dialog to close:
<programlisting>
<![CDATA[

  .application~useGlobalConstDir("O", "useTools.h")

  dlg = .MainDialog~new

  dlgTool = .ToolPaletteDlg~new
  dlgTool~ownerDialog = dlg

  dlg~executeAsync("SHOWTOP", IDI_DLG_OOREXX)

  dlgTool~popup("SHOWTOP")

  dlg~endAsyncExecution

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::executeAsync() -->


<section id="mthFreeControlDC" xreflabel="freeControlDC"><title>freeControlDC</title>
<indexterm><primary>freeControlDC</primary></indexterm>
<programlisting>
<![CDATA[
>>--freeControlDC(--id--,--dc--)-----------------><


]]>
</programlisting>

<para>The freeControlDC method releases the device context
of a control. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The resource ID of the control.
</para></listitem></varlistentry>
<varlistentry><term>dc</term>
<listitem><para>The device context previously received by the <xref linkend="mthGetControlDC"/> method
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthFreeWindowDC" xreflabel="freeWindowDC"><title>freeWindowDC</title>
<indexterm><primary>freeWindowDC</primary></indexterm>
<programlisting>
<![CDATA[
>>--freeWindowDC(--hwnd--,--dc--)----------------><

]]>
</programlisting>

<para>The freeWindowDC method frees the device context
of a window. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>hwnd</term>
<listitem><para>The window handle
</para></listitem></varlistentry>
<varlistentry><term>dc</term>
<listitem><para>The device context previously received by the <xref linkend="mthGetWindowDC"/> method
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthGetBitmapPosition" xreflabel="getBitmapPosition"><title>getBitmapPosition</title>
<indexterm><primary>getBitmapPosition</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>getBitmapPosition</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>getBitmapPosition</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getBitmapPosition(--id--,--pos--)------------><

]]>
</programlisting>

<para>
  Retrieves the position in client <xref linkend="defScreenCoordinates"/>  of the upper left corner of a
  bitmap within a bitmap button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the bitmap button. May be numeric or <xref linkend="defSymbolicId"/>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>pos</term>
    <listitem>
    <para>
      A <xref linkend="clsPoint"/> object. On a successful return the point object is updated with the
      position of the bitmap. On an error return, the point object is left unchanged.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns <computeroutput>.true</computeroutput> on success and <computeroutput>.false</computeroutput> on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Recall that client area coordinates are relative to the (0, 0) point of the client area of a window. Both or either
    of the coordinates can be negative. A negative x will place the bitmap to the left of the edge of the button. A
    negative y will place the bitmap above the top of the bitmap.
  </para>
  <para>
    This method is only for bitmaps that have been assigned to a bitmap button through the
 <xref linkend="mthInstallBitmapButton"/> method. If there is no bitmap assigned to the button
    then <computeroutput>.false</computeroutput> is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::getBitmapPosition() -->


<section id="mthGetBitmapSize" xreflabel="getBitmapSize"><title>getBitmapSize</title>
<indexterm><primary>getBitmapSize</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>getBitmapSize</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>getBitmapSize</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getBitmapSize(--id--)------------------------><

]]>
</programlisting>

<para>
  Retrieves the size of the bitmap for a bitmap button as a <xref linkend="clsSize"/> object.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single arguments is:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the bitmap button. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, returns the bitmap size. On failure returns -1.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If <emphasis role="italic">id</emphasis> is not the resource ID of a bitmap button, or if the bitmap for the button
    can not be located, the negative one is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example retrieves the size of the bitmap for the bitmap button with symbolic resource ID of IDC_PB_TICKET:
<programlisting>
<![CDATA[

  size = self~getBitmapSize(IDC_PB_TICKET)
  say 'Size for the ticket push button bitmap:' size~width 'by' size~height

  /* Output might be:

     Size for the ticket push button bitmap: 152 by 178

  */
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::getBitmapSize() -->


<section id="mthGetBitmapSizeX" xreflabel="getBitmapSizeX"><title>getBitmapSizeX</title>
<indexterm><primary>getBitmapSizeX</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>getBitmapSizeX</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>getBitmapSizeX</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getBitmapSizeX(--id--)-----------------------><

]]>
</programlisting>

<para>
  Gets the width of the bitmap assigned to this bitmap button in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the bitmap button. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, the width of the bitmap for the bitmap button in pixels, on error -1.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is only for bitmaps that have been assigned to a bitmap button through the
 <xref linkend="mthInstallBitmapButton"/> method. If there is no bitmap assigned to this button
    then -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::getBitMapSizeX() -->


<section id="mthGetBitmapSizeY" xreflabel="getBitmapSizeY"><title>getBitmapSizeY</title>
<indexterm><primary>getBitmapSizeY</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>getBitmapSizeY</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>getBitmapSizeY</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getBitmapSizeY(--id--)-----------------------><

]]>
</programlisting>

<para>
  Gets the height of the bitmap assigned to this bitmap button in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the bitmap button. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    On success, the height of the bitmap for the bitmap button in pixels, on error -1.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is only for bitmaps that have been assigned to a bitmap button through the
 <xref linkend="mthInstallBitmapButton"/> method. If there is no bitmap assigned to this button
    then -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::getBitMapSizeX() -->


<section id="mthGetBmpDisplacement" xreflabel="getBmpDisplacement"><title>getBmpDisplacement</title>
<indexterm><primary>getBmpDisplacement</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>getBmpDisplacement</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>getBmpDisplacement</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getBmpDisplacement(--id--)-------------------><

]]>
</programlisting>

<para>
  Returns a string containing the <xref linkend="defClientArea"/> coordinates of the bitmap in a bitmap
  button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single argument is:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the bitmap button. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    A string with the X position and then the Y position of the bitmap, in pixels. The X and Y coordinates are separated
    by a blank. On error, -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Recall that client area coordinates are relative to the (0, 0) point of the client area of a window. Both or either
    of the coordinates can be negative.
  </para>
  <para>
    This method is only for bitmaps that have been assigned to a bitmap button through the
 <xref linkend="mthInstallBitmapButton"/> method. If there is no bitmap assigned to the button
    then -1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This following example shows how to use the <emphasis role="italic">getBmpDisplacement</emphasis> method:

<programlisting>
<![CDATA[
  bmpPos = self~getBmpDisplacement(IDC_PB_TICKET)
  parse var bmpPos x y
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::getBmpDisplacement() -->


<section id="mthGetControlDC" xreflabel="getControlDC"><title>getControlDC</title>
<indexterm><primary>getControlDC</primary></indexterm>
<programlisting>
<![CDATA[
>>--getControlDC(--id--)-------------------------><


]]>
</programlisting>

<para>The getControlDC method returns the device context
of a dialog control. Do not forget to free the device context after you have completed
the operations (see <xref linkend="mthFreeControlDC"/>). </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The resource ID of the dialog control. May be numeric or symbolic.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthGetControlRect" xreflabel="getControlRect"><title>getControlRect</title>
<indexterm><primary>getControlRect</primary></indexterm>
<programlisting>
<![CDATA[
>>--getControlRect(--id--)-----------------------><


]]>
</programlisting>

<para>The getControlRect method returns the size and position rectangle of the given dialog control. The four values
(left, top, right, bottom) are returned in one string separated by blanks.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the dialog control.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthGetListItemHeight" xreflabel="getListItemHeight"><title>getListItemHeight</title>
<indexterm><primary>getListItemHeight</primary></indexterm>
<programlisting>
<![CDATA[
>>--getListItemHeight(--id--)--------------------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">getListItemHeight</emphasis> method returns the height of the items in a list box, in
  dialog units.
</para>
<para>
  The value is usually <xref linkend="ovvInaccurate"/> because it is calculated using
 <xref linkend="atrFactorX"/>. The programmer is advised to use the
 <xref linkend="mthGetListItemHeightPx"/> method instead, which will return the correct height of
  a list item.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the list box of which you want to know the item height.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The height of the list box items, in dialog units.
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthGetListItemHeightPx" xreflabel="getListItemHeightPx"><title>getListItemHeightPx</title>
<indexterm><primary>getListItemHeightPx</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>getListItemHeightPx</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>getListItemHeightPx</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getListItemHeightPx(--id--)------------------><

]]>
</programlisting>

<para>
  Gets the height, in pixels, of an individual item in a <xref linkend="clsListBox"/> control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single arguments is:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the list box. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns the height of each item in the list box, in pixels.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::getListItemHeightPx() -->


<section id="mthGetListWidth" xreflabel="getListWidth"><title>getListWidth</title>
<indexterm><primary>getListWidth</primary></indexterm>
<programlisting>
<![CDATA[
>>--getListWidth(--id--)-------------------------><

]]>
</programlisting>

<para>
  The getListWidth method returns the scrollable width of a list box, in dialog units.
</para>
<para>
  The value is usually <xref linkend="ovvInaccurate"/> because it is calculated using
 <xref linkend="atrFactorX"/>. The programmer is advised to use the
 <xref linkend="mthGetListWidthPx"/> method instead, which will return the correct width in pixels.
</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the list box of which you want to know the scrollable width.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>The width of the scrollable area of the list box, in dialog units.
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthGetListWidthPx" xreflabel="getListWidthPx"><title>getListWidthPx</title>
<indexterm><primary>getListWidthPx</primary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>getListWidthPx</secondary></indexterm>
<programlisting>
<![CDATA[
>>--getListWidthPx(--id--)-----------------------><

]]>
</programlisting>

<para>
  Retrieves the width, in pixels, that a list box can be scrolled horizontally, if the list box has a horizontal scroll
  bar.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The single arguments is:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the list box. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The scrollable width of the list box, in pixels
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::getListWidthPx() -->


<section id="mthGetSBPos" xreflabel="getSBPos"><title>getSBPos</title>
<indexterm><primary>getSBPos</primary></indexterm>
<programlisting>
<![CDATA[
>>--getSBPos(--id--)-----------------------------><

]]>
</programlisting>

<para>The getSBPos method returns the current position of
a scroll bar control. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the scroll bar.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthGetSBRange" xreflabel="getSBRange"><title>getSBRange</title>
<indexterm><primary>getSBRange</primary></indexterm>
<programlisting>
<![CDATA[
>>--getSBRange(--id--)---------------------------><

]]>
</programlisting>

<para>The getSBRange method returns the range of a scroll
bar control. It returns the two values (minimum and maximum) in one string,
separated by a blank. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Protected:</emphasis></term>
<listitem><para>This method is protected.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the scroll bar.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example demonstrates how to get the minimum and the maximum
values of the scroll bar:

<programlisting>
<![CDATA[
     .
     .
     .
::method dumpSBRange

  sbRange = self~getSBRange(IDC_SB)
  parse var sbRange sbMin sbMax
  say sbMin " - " sbMax

]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthGetWindowDC" xreflabel="getWindowDC"><title>getWindowDC</title>
<indexterm><primary>getWindowDC</primary></indexterm>
<programlisting>
<![CDATA[
>>--getWindowDC(--hwnd--)------------------------><


]]>
</programlisting>

<para>The getWindowDC method returns the device context
of a window. Do not forget to free the device context after you have completed
the operations (see <xref linkend="mthFreeWindowDC"/>). </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hwnd</term>
<listitem><para>The handle of the window
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthInstallAnimatedButton" xreflabel="installAnimatedButton"><title>installAnimatedButton</title>
<indexterm><primary>installAnimatedButton</primary></indexterm>
<programlisting>
<![CDATA[
>>--installAnimatedButton(--id-,-+--------+-+--------+-,-bmpF-+--------+-,--mX->
                                 +-,-mth--+ +-,-cls--+        +-,-bmpT-+

>--,-mY--+---------+--+---------+--,--delay---+--------+--+--------+--)--------><
         +-,-sizeX-+  +-,-sizeY-+             +-,-xNow-+  +-,-yNow-+


]]>
</programlisting>

<para>The installAnimatedButton method installs an animated
button and runs it concurrently with the main activity. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the button
</para></listitem></varlistentry>
<varlistentry><term>mth</term>
<listitem><para>The name of a method within the same class. This method is called each
time the button is clicked.
</para></listitem></varlistentry>
<varlistentry><term>cls</term>
<listitem><para>The class that controls the animation. The default is <xref linkend="clsAnimatedButton"/> Class.
</para></listitem></varlistentry>
<varlistentry><term>bmpF</term>
<listitem><para>The ID of the first bitmap in the animation sequence within a binary
resource. It can also be the name of an array stored in the .local directory
containing handles of bitmaps to be animated and bmpTo is omitted. See <xref linkend="mthLoadBitmap"/> for how to get bitmap
handles. The array starts at index 1.
</para></listitem></varlistentry>
<varlistentry><term>bmpT</term>
<listitem><para>The ID of the last bitmap in the animation sequence within a binary
resource. If omitted, bmpFrom is expected to be the
name of an array stored in .local that holds the bitmap handles of the bitmaps
that are to be animated.
</para></listitem></varlistentry>
<varlistentry><term>mX, mY</term>
<listitem><para>Size of one move (in pixels)
</para></listitem></varlistentry>
<varlistentry><term>sizeX, sizeY</term>
<listitem><para>Size of the bitmaps (if omitted, the size of the bitmaps is retrieved)
</para></listitem></varlistentry>
<varlistentry><term>delay</term>
<listitem><para>The time in milliseconds the method waits after each move
</para></listitem></varlistentry>
<varlistentry><term>xNow, yNow</term>
<listitem><para>The starting position of the bitmap
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example defines and runs an animated button. The example
loads ten bitmaps (&quot;anibmp1.bmp&quot; to &quot;anibmp10.bmp&quot;) into memory
and stores them into the array "My.Bitmaps" that is stored in the .local directory.
The name "My.Bitmaps" is specified as the <computeroutput>bmpfrom</computeroutput> and <computeroutput>bmpto</computeroutput> is omitted. After the dialog execution the bitmaps are removed from
memory again. The sample also uses a different animation class (".MyAnimation")
which subclasses from .AnimatedButton and overrides method HitRight which
plays a tune each time the animated bitmap hits the right border.
</para></listitem></varlistentry>
</variablelist>

<programlisting>
<![CDATA[
/* store array in .local */
.Local["My.Bitmaps"] = .array~new(10)
/* load 10 bitmaps into .local array */
do i= 1 to 10
  .Local["My.Bitmaps"][i] = Dialog~loadBitmap("anibmp"i".bmp")
  /* you could also use .My.Bitmaps[i] =  ... */
end

/* connect bitmap sequence and .MyAnimated class with button IDANI */
Dialog~installAnimatedButton("IDANI", ,.MyAnimation,"My.Bitmaps", ,1,1, , ,100)

...
Dialog~execute
...

/* Free the bitmap previously loaded */
do bmp over .Local["My.Bitmaps"] /* You could also use do bmp over .My.Bitmaps */
   Dialog~removeBitmap(bmp)
end


::class MyAnimation subclass AnimatedButton

/* play sound.wav whenever the bitmap hits the right border */

::method HitRight
   ret = Play("sound.wav", yes)
   return self~super:hitright
]]>
</programlisting>
</section>

<section id="mthInstallBitmapButton" xreflabel="installBitmapbutton"><title>installBitmapbutton</title>
<indexterm><primary>installBitmapButton</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>installBitmapButton</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>installBitmapButton</secondary></indexterm>
<programlisting>
<![CDATA[
>>--installBitmapButton(-id-+-------+-,-bN--+------+-+------+-+-------+-+--------+-)-><
                            +-,-mth-+       +-,-bF-+ +-,-bS-+ +-,-bD--+ +-,-opts-+

]]>
</programlisting>

<para>
  The <emphasis role="italic">installBitmapButton</emphasis> method installs the bitmaps for a bitmap push button and
  optionally connects the push button click <xref linkend="ovvEvents"/> with a method in the Rexx dialog.
  When the button needs to be drawn, the ooDialog framework draws the button using the supplied bitmaps rather than
  having the operating system draw a default push button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the button. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>mth [optional]</term>
      <listitem>
      <para>
        The name of the event handler method in the Rexx dialog that will be invoked when the push button is clicked. If
        this method is omitted, then the event notification is not connected.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bN [required]</term>
      <listitem>
      <para>
        The source of the bitmap to be used for the button face when it is in the <emphasis
        role="italic">normal</emphasis> state. See the Remarks section for details on how to specify a bitmap source for
        this method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bF [optional]</term>
      <listitem>
      <para>
        The source of the bitmap to be used for the button face when it is in the <emphasis
        role="italic">focused</emphasis> state. See the Remarks section for details on how to specify a bitmap source
        for this method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bS [optional]</term>
      <listitem>
      <para>
        The source of the bitmap to be used for the button face when it is in the <emphasis
        role="italic">selected</emphasis> state. See the Remarks section for details on how to specify a bitmap source
        for this method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bD [optional]</term>
      <listitem>
      <para>
        The source of the bitmap to be used for the button face when it is in the <emphasis
        role="italic">disabled</emphasis> state. See the Remarks section for details on how to specify a bitmap source
        for this method.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>opts [optional]</term>
      <listitem>
      <para>
        A list of 0 or more of the following keywords separated by spaces, case is not significant:
      </para>
      <para>
        <simplelist type='vert' columns='2'>
          <member>FRAME   </member>
          <member>INMEMORY</member>
          <member>STRETCH </member>
          <member>USEPAL  </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>FRAME</term>
          <listitem>
          <para>
            Draws a frame around the button. When this option is used, the appearance of the bitmap button is more
            similar to a normal Windows button, except that the button face is drawn using the bitmap rather than text.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>INMEMORY</term>
          <listitem>
          <para>
            This option <emphasis role="italic">must</emphasis> be used if the named bitmaps are already loaded into memory by using the
 <xref linkend="mthLoadBitmap"/> method. The bitmap source arguments must be specified as the
            bitmap <xref linkend="defHandle"/> returned from the <emphasis
            role="italic">loadBitmap</emphasis> method.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>STRETCH</term>
          <listitem>
          <para>
            If this option is specified and the extent of the bitmap is smaller than the extent of the button rectangle,
            the bitmap is adapted to match the extent of the button. STRETCH has no effect for bitmaps loaded through a
            DLL.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>USEPAL</term>
          <listitem>
          <para>
            Stores the colors of the bitmap file as the system color palette.  This option is needed when the bitmap was
            created with a palette other than the default Windows color palette. Use it for one button only, because
            only one color palette can be active at any time. <emphasis role="italic">USEPAL</emphasis> is
            invalid for a bitmap loaded from a DLL.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success. Otherwise, returns -1 if the <emphasis role="italic">id</emphasis> argument was symbolic and
    could not be resolved and 1 for any other error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    There are 3 ways to specify the bitmap source for the <emphasis role="italic">bN</emphasis>, <emphasis
    role="italic">bf</emphasis>, <emphasis role="italic">bS</emphasis>, and <emphasis role="italic">bD</emphasis>
    arguments. The arguments can be a bitmap file name, in which case the bitmap is loaded from the file, the arguments
    can be the resource ID of bitmap compiled into the resource DLL for a <xref linkend="clsResDialog"/>,
    or the arguments can be a bitmap <emphasis role="italic">handle</emphasis> returned from the
 <xref linkend="mthLoadBitmap"/> method.
  </para>
  <para>
    However, <emphasis role="italic">all</emphasis> the bitmap source arguments <emphasis role="bold">must</emphasis>
    be the same type. I.e., if the <emphasis role="italic">bN</emphasis> argument is specified as a file name, if any of
    the other bitmap source arguments are used they must also be specified as file names. Symbolic IDs can be used when
    using resource IDs to specify the bitmap sources.
  </para>
  <para>
    Once a bitmap push button is installed, the <xref linkend="mthChangeBitmapButton"/> method
    can be used to change the bitmaps associated with the button.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example installs a bitmap push button using four bitmaps and connects the button click event to a method:
<programlisting>
<![CDATA[

::method initDialog
  ...

  self~installBitmapButton(204, "onBmpButtonClicked",                   -
                                "AddBut_n.bmp", "AddBut_f.bmp",         -
                                "AddBut_s.bmp", "AddBut_d.bmp", "FRAME")
  ...

::method onBmpButtonClicked
  ...

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End dialog object::installBitmapbutton() -->

<section id="mthMoveControl" xreflabel="moveControl"><title>moveControl</title>
<indexterm><primary>moveControl</primary>
<secondary>dialog object</secondary></indexterm>
<programlisting>
<![CDATA[
>>--moveControl(--id--,--xPos--,--yPos--+------------+--)-------><
                                        +-,-showOpt--+

]]>
</programlisting>

<para>The moveControl method moves a dialog control to another
position within the dialog window. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the dialog control you want to move
</para></listitem></varlistentry>
<varlistentry><term>xPos, yPos</term>
<listitem><para>The new position in dialog units relative to the dialog window
</para></listitem></varlistentry>
<varlistentry><term>showOpt</term>
<listitem><para>This argument can be one of the following keywords:
<variablelist>
<varlistentry><term>HIDEWINDOW</term>
<listitem><para>Hides the dialog
</para></listitem></varlistentry>
<varlistentry><term>SHOWWINDOW</term>
<listitem><para>Shows the dialog
</para></listitem></varlistentry>
<varlistentry><term>NOREDRAW</term>
<listitem><para>Moves the dialog control without updating the display. Use the <xref linkend="mthUpdateClsWindowBase"/>
method to manually update the display.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthPopup" xreflabel="popup"><title>popup</title>
<indexterm><primary>popup</primary><secondary>dialog object class</secondary></indexterm>
<indexterm><primary>dialog object</primary><secondary>popup</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>popup</secondary></indexterm>
<programlisting>
<![CDATA[
>>--popup(--+--------------+--+------------+--+--------+--)-----><
            +--showOption--+  +-,-ignored--+  +-,-icon-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">popup</emphasis> method starts a <link linkend="defModalModeless">modeless</link> dialog
  executing and returns immediately.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>showOption [optional]</term>
      <listitem>
      <para>
        Zero or one of the following keywords to specify how the dialog is shown. This keyword is used in the automatic
        invocation of the <xref linkend="mthShowClsPlainBaseDialog"/> method. Case is not significant. If this
        argument is omitted, the NORMAL keyword is used:
        <variablelist>
          <varlistentry><term>NORMAL</term>
          <listitem>
          <para>
            Makes the dialog visible in its default position and window size. This has the effect of restoring the dialog size
            and position if it is minimized or maximized. This is the default if the argument is omitted.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>DEFAULT</term>
          <listitem>
          <para>
            DEFAULT is an alias for NORMAL. The two keywords are functionally identical.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SHOWTOP</term>
          <listitem>
          <para>
            Makes the dialog visible and the topmost window.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HIDE</term>
          <listitem>
          <para>
            Makes the dialog invisible.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MIN</term>
          <listitem>
          <para>
            Minimizes the dialog and activates the next window in the window order.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MAX</term>
          <listitem>
          <para>
            Maximizes, and makes visible if necessary, the dialog.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>INACTIVE</term>
          <listitem>
          <para>
            Makes the dialog visible without changing the active window.  When the NORMAL keyword is used, the dialog is shown
            and becomes the active window. The INACTIVE keyword makes the dialog visible without changing the focus from the
            current active window.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>RESTORE</term>
          <listitem>
          <para>
            Makes the dialog visible and restores it to its original size and position if it was minimized or maximized. An
            application should specify this flag when restoring a minimized window.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ignored [optional]</term>
      <listitem>
      <para>
        This argument is completely ignored. It is a hold over from the original ooDialog implementation. However, since
        the <emphasis role="italic">icon</emphasis> argument follows it, the <emphasis role="italic">ignored</emphasis>
        must be retained. It serves as a place holder argument to preserve backwards compatibility. The programmer
        should simply omit it, or use a value such as <computeroutput>1</computeroutput> to serve as the place holder.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>icon [optional]</term>
      <listitem>
      <para>
        The resource ID of the <xref linkend="defDialogIcon"/>. May be numeric or <xref linkend="defSymbolicId"/>. If an
        icon ID is not supplied, the default ooDialog icon will be used.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a Rexx <computeroutput>Message</computeroutput> object, (see the Open Object Rexx reference manual to
    learn more about the <computeroutput>Message</computeroutput> class.) The message object can be used, for instance,
    to check if the dialog has been closed by the user, to obtain the result value from the execution of the dialog,
    etc..
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Note that the example shown below for the <emphasis role="italic">popup</emphasis> method makes use of the returned
    <computeroutput>Message</computeroutput> object to illustrate a possible use of the return. However, it is a contrived
    use case. Typically it is easier to just work with the instantiated dialog object directly.  (In the case of the example
    this would be the <emphasis role="italic">dlg</emphasis> variable.)
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example demonstrates how a dialog started with <emphasis role="italic">popup</emphasis> executes asynchronously
    to the code in the main portion of the program. The example code below is complete. I can be cut and pasted into a
    file and will run as is.
<programlisting>
<![CDATA[

  dlg = .ExampleDlg~new( , "simple.h")
  msgObj = dlg~popup("SHOWTOP", IDI_DLG_OOREXX)

  do i = 1 to 1000
    say "Iteration" i
    j = msSleep(1000)

    if msgObj~completed then do
      val = msgObj~result
      select
        when val == 1 then say 'The user closed the dialog with Ok.'
        when val == 2 then say 'The user closed the dialog with Cancel.'
        otherwise say 'The dialog has closed with an error'
      end
      leave
    end
  end

  if \ msgObj~completed then say 'Iteration loop ended, dialog is still running.'

::requires "ooDialog.cls"

::class 'ExampleDlg' subclass UserDialog

::method init
  forward class (super) continue
  self~create(30, 30, 257, 123, "Simple Dialog", "CENTER")

::method defineDialog

  self~createPushButton(IDOK, 142, 99, 50, 14, "DEFAULT", "Ok")
  self~createPushButton(IDCANCEL, 197, 99, 50, 14, , "Cancel")

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::popup() -->


<section id="mthPopupAsChild" xreflabel="popupAsChild"><title>popupAsChild</title>
<indexterm><primary>popupAsChild</primary><secondary>DialogExtensions class</secondary></indexterm>
<indexterm><primary>dialog object</primary><secondary>popupAsChild</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>popupAsChild</secondary></indexterm>
<programlisting>
<![CDATA[
>>--popupAsChild(--parent--+---------------+--+------------+--+---------+--)---><
                           +-,-showOption--+  +-,-ignored--+  +-,-icon--+
]]>
</programlisting>

<para>
  The <emphasis role="italic">popupAsChild</emphasis> method starts a <link linkend="defModalModeless">modeless</link>
  dialog executing and returns immediately. It is very similar to the <xref linkend="mthPopup"/> method, but has the
  additional functionality that it is closed automatically when the <emphasis role="italic">parent</emphasis> dialog is
  closed.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
  <variablelist>
    <varlistentry><term>parent [required]</term>
    <listitem>
    <para>
      Some other Rexx dialog object. A relationship is established with the <emphasis role="italic">parent</emphasis>
      dialog such that when the <emphasis role="italic">parent</emphasis> dialog is closed, this dialog is
      automatically closed also.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>showOption [optional]</term>
    <listitem>
    <para>
      Zero or one of the following keywords to specify how the dialog is shown. This keyword is used in the automatic
      invocation of the <xref linkend="mthShowClsPlainBaseDialog"/> method. Case is not significant. If this
      argument is omitted, the NORMAL keyword is used:
      <variablelist>
        <varlistentry><term>NORMAL</term>
        <listitem>
        <para>
          Makes the dialog visible in its default position and window size. This has the effect of restoring the dialog size
          and position if it is minimized or maximized. This is the default if the argument is omitted.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>DEFAULT</term>
        <listitem>
        <para>
          DEFAULT is an alias for NORMAL. The two keywords are functionally identical.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SHOWTOP</term>
        <listitem>
        <para>
          Makes the dialog visible and the topmost window.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HIDE</term>
        <listitem>
        <para>
          Makes the dialog invisible.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MIN</term>
        <listitem>
        <para>
          Minimizes the dialog and activates the next window in the window order.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>MAX</term>
        <listitem>
        <para>
          Maximizes, and makes visible if necessary, the dialog.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>INACTIVE</term>
        <listitem>
        <para>
          Makes the dialog visible without changing the active window.  When the NORMAL keyword is used, the dialog is shown
          and becomes the active window. The INACTIVE keyword makes the dialog visible without changing the focus from the
          current active window.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>RESTORE</term>
        <listitem>
        <para>
          Makes the dialog visible and restores it to its original size and position if it was minimized or maximized. An
          application should specify this flag when restoring a minimized window.
        </para>
        </listitem></varlistentry>
      </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>ignored [optional]</term>
    <listitem>
    <para>
      This argument is completely ignored. It is a hold over from the original ooDialog implementation. However, since
      the <emphasis role="italic">icon</emphasis> argument follows it, the <emphasis role="italic">ignored</emphasis>
      argument must be retained. It serves as a place holder argument to preserve backwards compatibility. The
      programmer should simply omit it, or use a value such as <computeroutput>1</computeroutput> to serve as the
      place holder.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>icon [optional]</term>
    <listitem>
    <para>
      The resource ID of the <xref linkend="defDialogIcon"/>. May be numeric or <xref linkend="defSymbolicId"/>. If an
    icon ID is not supplied, the default ooDialog icon will be used.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The return is a Rexx <computeroutput>Message</computeroutput> object, (see the Open Object Rexx reference manual to
    learn more about the <computeroutput>Message</computeroutput> class.) The message object can be used, for instance,
    to check if the dialog has been closed by the user, to obtain the result value from the execution of the dialog,
    etc..
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Note that the relationship between the dialog started with <emphasis role="italic">popupAsChild</emphasis> and the
    <emphasis role="italic">parent</emphasis> dialog is one-way. When the <emphasis role="italic">parent</emphasis>
    dialog is closed, the dialog started with the <emphasis role="italic">popupAsChild</emphasis> method is closed. But,
    when the dialog started with <emphasis role="italic">popupAsChild</emphasis> is closed, the <emphasis
    role="italic">parent</emphasis> dialog continues to execute as normal. It is not effected by the closing of the
    <emphasis role="italic">child</emphasis> dialog.
  </para>
  <para>
    Note also that the example shown below for the <emphasis role="italic">popupAsChild</emphasis> method makes use of the
    returned <computeroutput>Message</computeroutput> object from the <emphasis role="italic">popup</emphasis> method to
    illustrate a possible use of the return. However, it is a contrived use case. Typically it is easier to just work with
    the instantiated dialog object directly.  (In the case of the example this would be the <emphasis
    role="italic">parentDlg</emphasis> variable.)
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example creates and executes a <emphasis role="italic">parent</emphasis> dialog. It then executes a second
    dialog, using <emphasis role="italic">popupAsChild</emphasis> to start the second dialog. The main program path then
    runs a loop to demonstrate that both dialogs are executing asynchronously. When the loop counter reaches 20, the
    program closes the parent dialog. This will also close the child dialog.
  </para>
  <para>
    This example program is complete. It can be copy and pasted into a file and will execute as is:

<programlisting>
<![CDATA[

  parentDlg = .SimpleParentDlg~new

  msgObj = parentDlg~popup("SHOWTOP", , IDI_DLG_OOREXX)

  childDlg = .ExampleChildDlg~new

  childDlg~popupAsChild(parentDlg, 'SHOWTOP', IDI_DLG_OODIALOG)

  do i = 1 to 1000
    say "Iteration" i
    j = msSleep(1000)

    -- Check if the user closed the parent dialog.  We do
    -- not care if the user closed the child dialog, the
    -- parent will keep executing.
    if msgObj~completed then leave

    -- After 20 seconds, close the parent dialog.  This
    -- will also close the child dialog.
    if i == 20 then do
      parentDlg~ok
      leave
    end
  end

::requires "ooDialog.cls"

::class 'ExampleChildDlg' subclass UserDialog

::method init
  forward class (super) continue
  self~create(60, 70, 257, 123, "Example - I am the Child Dialog")

::method defineDialog

  self~createPushButton(IDOK, 142, 99, 50, 14, "DEFAULT", "Ok")
  self~createPushButton(IDCANCEL, 197, 99, 50, 14, , "Cancel")


::class 'SimpleParentDlg' subclass UserDialog

::method init
  forward class (super) continue

  self~create(30, 30, 257, 123, "Simple Parent Dialog", "CENTER")

::method defineDialog

  self~createPushButton(IDOK, 142, 99, 50, 14, "DEFAULT", "Ok")
  self~createPushButton(IDCANCEL, 197, 99, 50, 14, , "Cancel")

]]>
</programlisting>

  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::popupAsChild() -->


<section id="mthRedrawControl" xreflabel="redrawControl"><title>redrawControl</title>
<indexterm><primary>redrawControl</primary></indexterm>
<programlisting>
<![CDATA[
>>--redrawControl(--id--+-------------+--)-------><
                       +-,--erasebkg-+
]]>
</programlisting>

<para>The redrawControl method redraws the specified dialog control.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the button
</para></listitem></varlistentry>
<varlistentry><term>erasebkg</term>
<listitem><para>Determines whether (1) or not (0) the background of the drawing area
should be erased before redrawing. The default is 0.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthRedrawRectClsDialogExtensions" xreflabel="redrawRect"><title>redrawRect</title>
<indexterm><primary>redrawRect</primary><secondary>dialog object</secondary></indexterm>
<indexterm><primary>dialog object </primary><secondary>redrawRect</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>redrawRect</secondary></indexterm>
<programlisting>
<![CDATA[
Form 1:

>>--redrawRect(--+--------+-,--rectangle--+---------+--)-----------------------><
                 +--hwnd--+              +-,-erase-+

Form 2:

>>--redrawRect(--+--------+-,--pt1--,--pt2--+---------+--)---------------------><
                 +--hwnd--+            +-,-erase-+

Form 3:

>>--redrawRect(--+--------+-,--x-,--y-,--x1-,--y1--+---------+--)--------------><
                 +--hwnd--+                   +-,-erase-+

Generic form:

>>--redrawRect(--+--------+-,--rectCoordinates--+---------+--)-----------------><
                 +--hwnd--+                +-,-erase-+

]]>
</programlisting>

<para>
  The <emphasis role="italic">redrawRect</emphasis> method redraws the specified
  <link linkend="ovvRectangleCoordinates">bounding</link> rectangular within the client area of this dialog. Optionally,
  another window can be specified, and the background of the rectangle can be erased first.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>hwnd [optional]</term>
      <listitem>
      <para>
        By default the rectangle to redraw is assumed to belong to the client area of this dialog. Optionally, the
        window <xref linkend="defHandle"/> of some other window can be specified.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>rectCoordinates [required]</term>
      <listitem>
      <para>
        The coordinates of the rectangle to be redrawn. The coordinates specify the upper left and lower right corners
        of the rectangle. The corners can be specified using either a <xref linkend="clsRect"/> object, two
 <xref linkend="clsPoint"/> objects, or the individual x and y coordinates of each corner.
      </para>
      <para>
        The coordinates are specified as <xref linkend="defClientArea"/> coordinates, in pixels.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>erase [optional]</term>
      <listitem>
      <para>
        A boolean (<computeroutput>.true</computeroutput> or <computeroutput>.false</computeroutput>) that specifies
        whether the background of the rectangle should be redrawn (<computeroutput>.true</computeroutput>) or not
        <computeroutput>.false</computeroutput>.) The default is <computeroutput>.false</computeroutput>
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    0 on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The rectangle is not really erased, but rather the background is specified to be redrawn also. By default the
    operating system does not redraw the background.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example shows 2 methods in an application that hides some of its dialog controls, under certain circumstances,
    and unhides them later:

<programlisting>
<![CDATA[

::method hideCustomerControls private

  gb = self~newGroupBox(IDC_GB)
  pb = self~newPushButton(IDC_PB)

  rGB = gb~windowRect
  self~screen2client(rGB)

  rLV = list~windowRect
  self~screen2client(rLV)

  rRect = .Rect~new(rGB~left, rGB~top, rLV~right, rLV~bottom)

  gb~hideFast
  list~hideFast
  self~redrawRect( , rRect, .true)

  return 0

::method showCustomerControls private

  gb = self~newGroupBox(IDC_GB)
  pb = self~newPushButton(IDC_PB)

  rLV = list~windowRect
  self~screen2client(rLV)

  rRect = .Rect~new(rGB~left, rGB~top, rLV~right, rLV~bottom)

  gb~showFast
  list~showFast
  self~redrawRect( , rRect)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::redrawRect() -->


<section id="mthRedrawWindow" xreflabel="redrawWindow"><title>redrawWindow</title>
<indexterm><primary>redrawWindow</primary></indexterm>
<programlisting>
<![CDATA[
>>--redrawWindow(--hwnd--)-----------------------><

]]>
</programlisting>

<para>The redrawWindow method redraws a specific dialog. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The only argument is:
<variablelist>
<varlistentry><term>hwnd</term>
<listitem><para>The handle to the dialog that is to be redrawn.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Redrawing was successful.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>Redrawing failed.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthRedrawWindowRect" xreflabel="redrawWindowRect"><title>redrawWindowRect</title>
<indexterm><primary>redrawWindowRect</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>redrawWindowRect</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>redrawWindowRect</secondary></indexterm>
<programlisting>
<![CDATA[
>>--redrawWindowRect(--+--------+--+------------+--)------------><
                       +--hwnd--+  +-,-erasebkg-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">redrawWindowRect</emphasis> method, by default, forces this dialog to completely
  redraw its <xref linkend="defClientArea"/>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem><para>The arguments are:
  <variablelist>
    <varlistentry><term>hwnd [optional]</term>
    <listitem>
    <para>
      Optionally, some other window can be forced to redraw by specifying the <xref linkend="defHandle"/> to
      the window. All Rexx dialog and dialog controls have the <xref linkend="atrHwnd"/> attribute which
      contains the handle of the <xref linkend="ovvUnderlying"/> window. In addition, methods like
      <xref linkend="mthGetControlHandle"/> can be used to obtain a window handle. If you omit this
      argument, the handle of the dialog itself is used.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>erasebkg [optional]</term>
    <listitem>
    <para>
      Specifies whether the background of the client area should be erased before redrawing. If
      <computeroutput>.true</computeroutput> the background is erased, if <computeroutput>.false</computeroutput> the
      background is not erased. The default is <computeroutput>.false</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthResizeControl" xreflabel="resizeControl"><title>resizeControl</title>
<indexterm><primary>resizeControl</primary></indexterm>
<programlisting>
<![CDATA[
>>--resizeControl(--id--,--width--,--height--+------------+--)-----------------><
                                             +-,-showOpt--+

]]>
</programlisting>

<para>The resizeControl method changes the size of a dialog control. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the dialog item you want to resize
</para></listitem></varlistentry>
<varlistentry><term>width, height</term>
<listitem><para>The new size in dialog units
</para></listitem></varlistentry>
<varlistentry><term>showOpt</term>
<listitem><para>This argument can be one of the following keywords:
<variablelist>
<varlistentry><term>HIDEWINDOW</term>
<listitem><para>Hides the control.
</para></listitem></varlistentry>
<varlistentry><term>SHOWWINDOW</term>
<listitem><para>Shows the control.
</para></listitem></varlistentry>
<varlistentry><term>NOREDRAW</term>
<listitem><para>Resizes the control without updating the display. Use the <xref linkend="mthUpdateClsWindowBase"/> method
to manually update the display.
          </para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example resizes a dialog control:

<programlisting>
<![CDATA[
self~resizeControl(IDC_PB_NEXT, 40, 30, "SHOWWINDOW")
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthScrollBitmapFromTo" xreflabel="scrollBitmapFromTo"><title>scrollBitmapFromTo</title>
<indexterm><primary>scrollBitmapFromTo</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>scrollBitmapFromTo</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>scrollBitmapFromTo</secondary></indexterm>
<programlisting>
<![CDATA[

>>--scrollBitmapFromTo(--id--,--fromX--,--fromY--,--toX--,--toY---------------->


>--+---------+--+---------+--+---------+--+------------+--)--------------------><
   +-,-stepX-+  +-,-stepY-+  +-,-delay-+  +-,-displace-+
]]>
</programlisting>

<para>
  Scrolls, (moves,) a bitmap from one position to another within a bitmap button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the bitmap button. May be numeric or <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fromX, fromY [required]</term>
      <listitem>
      <para>
        The starting position, in client <xref linkend="defScreenCoordinates"/>, where the upper
        left corner of the bitmap is first drawn. This is specified in pixels.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>toX, toY [required]</term>
      <listitem>
      <para>
        The ending position, in client <xref linkend="defScreenCoordinates"/>, where the upper
        left corner of the bitmap is drawn last. This is specified in pixels.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>stepX, stepY [optional]</term>
      <listitem>
      <para>
        The amount, in pixels, that the bitmap is moved for each step. For each move, <emphasis
        role="italic">stepX</emphasis> is the amount the bitmap is moved horizontally and <emphasis
        role="italic">stepY</emphasis> is the amount the bitmap is vertically. Either or both can be negative. The
        default for both is 0. However, they can not both be 0, or both omitted.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>delay [optional]</term>
      <listitem>
      <para>
        The time in milliseconds this method waits after each move before doing the next move. This determines the speed
        at which the bitmap moves. The default is 0, which means there is no delay between each move of the bitmap.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>displace [optional]</term>
      <listitem>
      <para>
        If <computeroutput>.true</computeroutput> the internal position of the bitmap is updated after each incremental
        move. <xref linkend="mthSetBitmapPosition"/> is called after each step
        to adjust the bitmap position. If the dialog is redrawn, the bitmap is shown at the correct position. The
        default is <computeroutput>.true</computeroutput>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is only for bitmaps that have been assigned to a bitmap button through the
 <xref linkend="mthInstallBitmapButton"/> method. If there is no bitmap assigned to the button
    then 1 is returned.
  </para>
  <para>
    Scrolling is done by positioning the bitmap and then drawing it. After the bitmap is drawn, it is repositioned
    using the <emphasis role="italic">stepX</emphasis> and <emphasis role="italic">stepY</emphasis> arguments and drawn
    again. This is repeated until the bitmap reaches the (<emphasis role="italic">toX</emphasis>, <emphasis
    role="italic">toY</emphasis>) ending position.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::scrollBitmapFromTo() -->


<section id="mthScrollButton" xreflabel="scrollButton"><title>scrollButton</title>
<indexterm><primary>scrollButton</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>scrollButton</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>scrollButton</secondary></indexterm>
<programlisting>
<![CDATA[
>>--scrollButton(--id--,--xPos--,--yPos--,--lft--,--top--,--rght--,--bttm--)---><

]]>
</programlisting>

<para>
  Moves the specified rectangle within the button and redraws the uncovered area with the button background color. This
  method is used to move bitmaps within bitmap buttons.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the button. May be numeric or symbolic.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>xPos, yPos [required]</term>
      <listitem>
      <para>
        The client area <xref linkend="defScreenCoordinates"/> of the new position for the upper left
        corner of the specified rectangle. The coordinates are specified in pixels.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>lft, top, rght, bttm [required]</term>
      <listitem>
      <para>
        The client area <xref linkend="defScreenCoordinates"/> of the upper left and bottom right
        corners of the rectangular area to be moved. The coordinates are specified in pixels.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method is only intended to be used with button controls. It will fail if the resource ID argument specifies a
    dialog control that is not a button.
  </para>
  <para>
    The <xref linkend="ovvUnderlying"/> Windows dialog must exist to use this method.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect usage is detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::scroll() -->


<section id="mthScrollInControl" xreflabel="scrollInControl"><title>scrollInControl</title>
<indexterm><primary>scrollInControl</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>scrollInControl</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>scrollInControl</secondary></indexterm>
<programlisting>
<![CDATA[
>>--scrollInControl(--id-,-text--+--------+--+--------+--+--------+--+-----+--->
                                 +-,-font-+  +-,-size-+  +-,-opts-+  +-,-y-+

>--+--------+--+---------+--+---------+----------------------------------------><
   +-,-step-+  +-,-sleep-+  +-,-color-+

]]>
</programlisting>

<para>
  Scrolls text in a dialog control using the specified font.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource id of the dialog control where the text will be scrolled. May be numeric or
        <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>text [required]</term>
      <listitem>
      <para>
        A text string that is displayed and scrolled.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>font [optional]</term>
      <listitem>
      <para>
        The name of the font used to write the text. If omitted, the System font is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>size [optional]</term>
      <listitem>
      <para>
        The size of the font used to write the text. If omitted, the default is 10.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>opts [optional]</term>
      <listitem>
      <para>
        A list of 0 or more of the following keywords separated by spaces, case is not significant. These options control
        aspects of the font and how the font is written. If this argument is omitted a normal font is used, i.e., not
        bolded, underlined, italicized, or striked out.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>THIN       </member>
          <member>EXTRALIGHT </member>
          <member>LIGHT      </member>
          <member>MEDIUM     </member>
          <member>SEMIBOLD   </member>
          <member>EXTRABOLD  </member>
          <member>HEAVY      </member>
          <member>BOLD       </member>
          <member>UNDERLINE  </member>
          <member>ITALIC     </member>
          <member>STRIKEOUT  </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>THIN</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 100.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>EXTRALIGHT</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 200.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>LIGHT</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 300.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MEDIUM</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 500.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SEMIBOLD</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 600.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>BOLD</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 700.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>EXTRABOLD</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 800.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HEAVY</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 900.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>UNDERLINE</term>
          <listitem>
          <para>
            An underline font is used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ITALIC</term>
          <listitem>
          <para>
            An italic font is used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>STRIKEOUT</term>
          <listitem>
          <para>
            A strike out font is used.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>displaceY</term>
      <listitem>
      <para>
        The Y client area <xref linkend="defScreenCoordinates"/> of the text. The default is 0. This
        argument is used to shift the text down from the top edge of the control, if needed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>step</term>
      <listitem>
      <para>
        The amount of screen pixels that the text is moved in each iteration. The default is 4.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>sleep</term>
      <listitem>
      <para>
        The time, in milliseconds, that the program waits after each iteration. This determines the scrolling speed. The
        default is 10 milliseconds.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>color</term>
      <listitem>
      <para>
        The color index used for the text. The default is 0, which is black.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The text is scrolled from right to left. Scrolling is done by repeatedly rewriting the text at <emphasis
    role="italic">step</emphasis> pixels to the left in the client area of the dialog control, starting at the right
    edge of the control. When the writing position reaches the left edge of the control, the rewriting ends.
  </para>
  <para>
    The <emphasis role="italic">font</emphasis>, <emphasis role="italic">size</emphasis>, <emphasis
    role="italic">style</emphasis>, and <emphasis role="italic">color</emphasis> arguments specify a font for the text
    being scrolled. The ooDialog framework requests a font to match this description from the font manager.
  </para>
  <para>
    If the method is started concurrently, call it a second time with no arguments to stop the scrolling.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example scrolls the string "Hello world!" from left to right within the dialog control window with the
    symbolic resource id of IDC_PB_SCROLLER. The text is located 2 pixels below the top of the client area, one move is
    3 screen pixels, and the delay time after each movement is 15 ms.

<programlisting>
<![CDATA[

self~start(scrollInControl, IDC_PB_SCROLLER, "Hello world!", "Arial", 36,   -
                            "BOLD ITALIC", 2, 3, 15, 4)

]]>
</programlisting>

  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions:scrollInControl() -->


<section id="mthScrollText" xreflabel="scrollText"><title>scrollText</title>
<indexterm><primary>scrollText</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>scrollText</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>scrollText</secondary></indexterm>
<programlisting>
<![CDATA[
>>--scrollText(--hwnd-,-text--+--------+--+--------+--+--------+--+-----+------>
                              +-,-font-+  +-,-size-+  +-,-opts-+  +-,-y-+

>--+--------+--+---------+--+---------+----------------------------------------><
   +-,-step-+  +-,-sleep-+  +-,-color-+

]]>
</programlisting>

<para>
  Scrolls text in the window using the specified font.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>hwnd [required]</term>
      <listitem>
      <para>
        The window <xref linkend="defHandle"/> where the text will be scrolled.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>text [required]</term>
      <listitem>
      <para>
        A text string that is displayed and scrolled.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>font [optional]</term>
      <listitem>
      <para>
        The name of the font used to write the text. If omitted, the System font is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>size [optional]</term>
      <listitem>
      <para>
        The size of the font used to write the text. If omitted, the default is 10.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>opts [optional]</term>
      <listitem>
      <para>
        A list of 0 or more of the following keywords separated by spaces, case is not significant. These options control
        aspects of the font and how the font is written. If this argument is omitted a normal font is used, i.e., not
        bolded, underlined, italicized, or striked out.
      </para>
      <para>
        <simplelist type='vert' columns='3'>
          <member>THIN       </member>
          <member>EXTRALIGHT </member>
          <member>LIGHT      </member>
          <member>MEDIUM     </member>
          <member>SEMIBOLD   </member>
          <member>EXTRABOLD  </member>
          <member>HEAVY      </member>
          <member>BOLD       </member>
          <member>UNDERLINE  </member>
          <member>ITALIC     </member>
          <member>STRIKEOUT  </member>
        </simplelist>
        <variablelist>
          <varlistentry><term>THIN</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 100.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>EXTRALIGHT</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 200.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>LIGHT</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 300.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>MEDIUM</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 500.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>SEMIBOLD</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 600.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>BOLD</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 700.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>EXTRABOLD</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 800.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>HEAVY</term>
          <listitem>
          <para>
            The weight of the font in a range of 0 through 1000 will be 900.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>UNDERLINE</term>
          <listitem>
          <para>
            An underline font is used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>ITALIC</term>
          <listitem>
          <para>
            An italic font is used.
          </para>
          </listitem></varlistentry>
          <varlistentry><term>STRIKEOUT</term>
          <listitem>
          <para>
            A strike out font is used.
          </para>
          </listitem></varlistentry>
        </variablelist>
      </para>
      </listitem></varlistentry>
      <varlistentry><term>displaceY</term>
      <listitem>
      <para>
        The Y client area <xref linkend="defScreenCoordinates"/> of the text. The default is 0. This
        argument is used to shift the text down from the top edge of the window, if needed.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>step</term>
      <listitem>
      <para>
        The amount of screen pixels that the text is moved in each iteration. The default is 4.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>sleep</term>
      <listitem>
      <para>
        The time, in milliseconds, that the program waits after each iteration. This determines the scrolling speed. The
        default is 10 milliseconds.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>color</term>
      <listitem>
      <para>
        The color index used for the text. The default is 0, which is black.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    The text is scrolled from right to left. Scrolling is done by repeatedly rewriting the text at <emphasis
    role="italic">step</emphasis> pixels to the left in the client area of the window, starting at the right edge of
    the window. When the writing position reaches the left edge of the window, the rewriting ends.
  </para>
  <para>
    The <emphasis role="italic">font</emphasis>, <emphasis role="italic">size</emphasis>, <emphasis
    role="italic">style</emphasis>, and <emphasis role="italic">color</emphasis> arguments specify a font for the text
    being scrolled. The ooDialog framework requests a font to match this description from the font manager.
  </para>
  <para>
    If the method is started concurrently, call it a second time with no arguments to stop the scrolling.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example scrolls the string "Hello world!" from left to right within the control window with the
    symbolic resource id of IDC_PB_SCROLLER. The text is located 2 pixels below the top of the client area, one move is
    3 screen pixels, and the delay time after each movement is 15 ms.

<programlisting>
<![CDATA[

hwnd = self~newPushButton(IDC_PB_SCROLLER)~hwnd

self~start(scrollText, hwnd, "Hello world!", "Arial", 36,   -
                       "BOLD ITALIC", 2, 3, 15, 4)

]]>
</programlisting>

  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions:scrollText() -->


<section id="mthSetBitmapPosition" xreflabel="setBitmapPosition"><title>setBitmapPosition</title>
<indexterm><primary>setBitmapPosition</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setBitmapPosition</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setBitmapPosition</secondary></indexterm>
<programlisting>
<![CDATA[

Form 1:

>>--setBitmapPosition(--id--,--point--)----------><

Form 2:

>>--setBitmapPosition(--id--,--x--,--y--)--------><

Generic form:

>>--setBitmapPosition(--id--,--newPosition--)----><

]]>
</programlisting>

<para>
  Sets the position of the upper left corner of the bitmap within the <xref linkend="defClientArea"/>
  of a bitmap button.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the button. May be numeric or symbolic.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>newPosition [required]</term>
      <listitem>
      <para>
        The <emphasis role="italic">newPosition</emphasis> argument(s) specify the (x, y) coordinates of the bitmap.
        These coordinates can be specified either as a <xref linkend="clsPoint"/> or as 2 separate whole
        number arguments, as in Form 2.
      </para>
      <para>
        Whether specified as a <computeroutput>point</computeroutput> object, or using the <emphasis role="italic">x,
        y</emphasis> format, both the x and y coordinates are required.  If only one argument is used, it must be a
        <computeroutput>point</computeroutput> object. The coordinates are specified as client area coordinates, in
        pixels.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    This method returns 0 for success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    Recall that client area coordinates are relative to the (0, 0) point of the client area of a window. Both or either
    of the coordinates can be negative. A negative x will place the bitmap to the left of the edge of the button. A
    negative y will place the bitmap above the top of the bitmap.
  </para>
  <para>
    This method is only for bitmaps that have been assigned to a bitmap button through the
 <xref linkend="mthInstallBitmapButton"/> method. If there is no bitmap assigned to the button
    then 1 is returned.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry id="exampleSetBitmapPosition"><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>

<programlisting>
<![CDATA[
    p = .Point~new
    if button~getBitmapPosition(IDC_PB_HORSEBITMAP, p) then
        p~x += 4
        p~y += 3
        button~setBitmapPosition(IDC_PB_HORSEBITMAP, p)
    end
]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setBitmapPosition() -->


<section id="mthSetControlColor" xreflabel="setControlColor"><title>setControlColor</title>
<indexterm><primary>setControlColor</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setControlColor</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setControlColor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setControlColor(--id--,--+------+--+-------+--+---------+--)---------------><
                             +-,-bk-+  +-,-fg--+  +-,-isClr-+
]]>
</programlisting>

<para>
  Sets the background color or the text color, or both, for the specified dialog control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  </para>
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the dialog control whose color is being set. May be numeric or
        <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bk [optional]</term>
      <listitem>
      <para>
        Specifies the background color of the dialog control. This may either be a palette <xref linkend="defColor"/>, or
        a <xref linkend="defColorRef"/> number. To use a COLORREF, the <emphasis role="italic">isClr</emphasis> argument must
        be true.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fg [optional]</term>
      <listitem>
      <para>
        Specifies the foreground color of the dialog control. This may either be a palette <xref linkend="defColor"/>, or
        a <xref linkend="defColorRef"/> number. To use a COLORREF, the <emphasis role="italic">isClr</emphasis> argument must
        be true. The foreground color is the color that text is written in.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>isClr [optional]</term>
      <listitem>
      <para>
        Specifies if the <emphasis role="italic">bg</emphasis> and <emphasis role="italic">fg</emphasis> arguments are to be
        interpreted as palette indexes or COLORREF numbers. The default if omitted is false.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, -1 if a symbolic ID is used for the resource ID and it could not be resolved, or 1 on some
    other error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the <emphasis role="italic">bk</emphasis> argument is omitted, then ooDialog ensures that the background of the dialog
    control is painted with the same color as the dialog background.
  </para>
  <para>
    Both the <emphasis role="italic">bk</emphasis> and <emphasis role="italic">fg</emphasis> arguments must be specified in
    the same manner. They must both be palette indexes or COLORREF numbers.
  </para>
  <para>
    Earlier versions of ooDialog had a restriction on the number of different dialog controls that could have their
    control changed from their default color. In ooDialog version 4.2.0 that restriction was lifted and there is no
    limit to the number of controls having their color set.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the background color of a static control to red and the text color to yellow using palette indexes:
<programlisting>
<![CDATA[

self~setControlColor(IDC_ST_EDIT_LABEL, 2, 4)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setControlColor() -->


<section id="mthSetControlFont" xreflabel="setControlFont"><title>setControlFont</title>
<indexterm><primary>setControlFont</primary></indexterm>
<programlisting>
<![CDATA[

>>--setControlFont(--id--,--fonthandle--+-----------+--)--------><
                                        +-.-redraw--+
]]>
</programlisting>

<para>
  The setControlFont method changes the font for a particular dialog control.
</para>
<para>
  The best place to call this method is within <xref linkend="mthInitDialog"/>. If the
  font is no longer needed, for instance, when the dialog is closed or another font has been assigned to
  the dialog control, you should free the font resource by calling
 <xref linkend="mthDeleteFont"/>. A good place to do this is the
 <xref linkend="mthLeaving"/> method.</para>
<variablelist>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of the dialog item.
</para></listitem></varlistentry>
<varlistentry><term>fonthandle</term>
<listitem><para>The handle returned by <xref linkend="mthCreateFontEx"/>.
</para></listitem></varlistentry>
<varlistentry><term>redraw</term>
<listitem><para>
<variablelist>
<varlistentry><term>0</term>
<listitem><para>Do not redraw the control.
</para></listitem></varlistentry>
<varlistentry><term>1</term>
<listitem><para>Redraw the control, which is the default.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example sets a 12-point Arial font for the control:
<programlisting>
<![CDATA[
::method initDialog
     .
     .
     .
   hFont = self~createFontEx("Arial",12)
   self~setControlFont(IDC_LB_ADDRESSES, hFont, .false)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>


<section id="mthSetControlSysColor" xreflabel="setControlSysColor"><title>setControlSysColor</title>
<indexterm><primary>setControlSysColor</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setControlSysColor</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setControlSysColor</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setControlSysColor(--id--,--+------+--+-------+--)----------><
                                +-,-bk-+  +-,-fg--+
]]>
</programlisting>

<para>
  Sets the background color or foreground color, or both, for the specified dialog control using the specified system <link
  linkend="defSysColor">color</link>.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>id [required]</term>
      <listitem>
      <para>
        The resource ID of the dialog control whose color is being set. May be numeric or
        <xref linkend="defSymbolicId"/>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>bk [optional]</term>
      <listitem>
      <para>
        The system color ID for the background color of the dialog control. This can be either the non-negative whole number
        ID or the keyword ID. IDs can be looked up in the System Color Elements <link linkend="tblSysColors">table</link>.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>fg [optional]</term>
      <listitem>
      <para>
        The system color for the foreground color of the dialog control. The foreground color is the color that text is
        written in. This can be either the non-negative whole number ID or the keyword ID. IDs can be looked up in the System
        Color Elements <link linkend="tblSysColors">table</link>.
      </para>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success, -1 if a symbolic ID is used for the resource ID and it could not be resolved, or 1 on some
    other error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    If the <emphasis role="italic">bk</emphasis> argument is omitted, the ooDialog framework ensures that the operating
    system paints the background using the background color of the dialog.
  </para>
  <para>
    Earlier versions of ooDialog had a restriction on the number of different dialog controls that could have their
    control changed from their default color. In ooDialog version 4.2.0 that restriction was lifted and there is no
    limit to the number of controls having their color set.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example changes the background color of a static control to the system background color for a menu:
<programlisting>
<![CDATA[

self~setControlSysColor(IDC_ST_STATES, 'MENU')

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setControlSysColor() -->


<section id="mthSetForegroundWindow" xreflabel="setForegroundWindow"><title>setForegroundWindow</title>
<indexterm><primary>setForegroundWindow</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setForegroundWindow</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setForegroundWindow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setForegroundWindow(--hwnd--)----------------><

]]>
</programlisting>

<para>
  Brings the specified window to the foreground.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem><para>The only argument is:
  <variablelist>
    <varlistentry><term>hwnd [required]</term>
    <listitem>
    <para>
      The <xref linkend="defHandle"/> to the window that is to become the foreground window.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    The window handle of the previous foreground window, or 0 if this method failed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    When a window becomes the foreground window the operating system puts the thread that created the specified window
    into the foreground and activates the window. The window receives the keyboard input, and visual cues are changed to
    alert the user of the new foreground window. The system also gives a slightly higher priority to the thread that
    created the foreground window than it does to other threads.
  </para>
  <para>
    Windows no longer allows a program to arbitrarily change the foreground window. The system restricts which processes
    can set the foreground window. A process can set the foreground window only if one of the following conditions is
    true:
    <itemizedlist>
      <listitem><para>The process is the foreground process.</para></listitem>
      <listitem><para>The process was started by the foreground process.</para></listitem>
      <listitem><para>The process received the last input event. </para></listitem>
      <listitem><para>There is no foreground process.</para></listitem>
      <listitem><para>No menus are active.</para></listitem>
    </itemizedlist>
    With this change, an application cannot force a window to the foreground while the user is working with another
    window.
  </para>
  <para>
    Only top-level windows can become the foreground window. If <emphasis role="italic">hwnd</emphasis> specifies a
    dialog control window, its owner dialog becomes the foreground window and the dialog control receives the input
    focus.
  </para>
  <para>
    In very rare cases, there might not be a previous foreground window and 0 would be returned.  In this case, the
    <computeroutput>.systemErrorCode</computeroutput> will be 0, otherwise the
    <computeroutput>.systemErrorCode</computeroutput> will not be 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example makes another dialog the foreground window and returns the window handle of the current foreground
    window to the caller, or returns -1 if there was an error:

<programlisting>
<![CDATA[

::method switchToReportDlg
  expose reportDlg
  currentHwnd = self~setForeGroundwindow(reportDlg~dlgHandle)
  if currentHwnd == 0 then return -1  -- Report an error
  return currentHwnd

]]>

</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthSetListColumnWidth" xreflabel="setListColumnWidth"><title>setListColumnWidth</title>
<indexterm><primary>setListColumnWidth</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setListColumnWidth</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setListColumnWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setListColumnWidth(--id--,--width--)---------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">setListColumnWidth</emphasis> method sets the width of all columns in a list box, in
  dialog units.
</para>
<para>
  The method usually produces <xref linkend="ovvInaccurate"/> results because it converts the dialog
  units to pixels using <xref linkend="atrFactorX"/>. The programmer is advised to use the
 <xref linkend="mthSetListColumnWidthPx"/> method instead, which will produce the correct results.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem><para>The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the list box for which you want to set the column width. May be numeric or
      <xref linkend="defSymbolicId"/> .
    </para>
    </listitem></varlistentry>
    <varlistentry><term>width [required]</term>
    <listitem>
    <para>
      The width, in pixels, to set the columns in the list box.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 if <emphasis role="italic">id</emphasis> is not correct, otherwise 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setListColumnWidth() -->


<section id="mthSetListColumnWidthPx" xreflabel="setListColumnWidthPx"><title>setListColumnWidthPx</title>
<indexterm><primary>setListColumnWidthPx</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setListColumnWidthPx</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setListColumnWidthPx</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setListColumnWidthPx(--id--,--width--)-------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">setListColumnWidthPx</emphasis> method sets the width of all columns in a list box, in
  pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem><para>The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the list box for which you want to set the column width. May be numeric or
      <xref linkend="defSymbolicId"/> .
    </para>
    </listitem></varlistentry>
    <varlistentry><term>width [required]</term>
    <listitem>
    <para>
      The width, in pixels, to set the columns in the list box.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 if <emphasis role="italic">id</emphasis> is not correct, otherwise 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setListColumnWidthPx() -->


<section id="mthSetListItemHeight" xreflabel="setListItemHeight"><title>setListItemHeight</title>
<indexterm><primary>setListItemHeight</primary></indexterm>
<programlisting>
<![CDATA[
>>--setListItemHeight(--id--,--height--)---------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">setListItemHeight</emphasis> method sets the height for all items in a list box, in dialog
units.
</para>
<para>
  The method usually produces <xref linkend="ovvInaccurate"/> results because it converts the dialog
  units to pixels using <xref linkend="atrFactorX"/>. The programmer is advised to use the
 <xref linkend="mthSetListItemHeightPx"/> method instead, which will produce the correct results.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the list box for which you want to set the item height. May be numeric or
      <xref linkend="defSymbolicId"/>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>height [required]</term>
    <listitem>
    <para>
      The height to set the items in the list box to, in dialog units.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 if <emphasis role="italic">id</emphasis> is not correct, otherwise 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setListItemHeight() -->


<section id="mthSetListItemHeightPx" xreflabel="setListItemHeightPx"><title>setListItemHeightPx</title>
<indexterm><primary>setListItemHeightPx</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setListItemHeightPx</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setListItemHeightPx</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setListItemHeightPx(--id--,--height--)-------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">setListItemHeightPx</emphasis> method sets the height for all items in a list box, in
  pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the list box for which you want to set the item height. May be numeric or
      <xref linkend="defSymbolicId"/>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>height [required]</term>
    <listitem>
    <para>
      The height to set the items in the list box to, in pixels.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 if <emphasis role="italic">id</emphasis> is not correct, otherwise 0.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setListItemHeightPx() -->


<section id="mthSetListWidth" xreflabel="setListWidth"><title>setListWidth</title>
<indexterm><primary>setListWidth</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setListWidth</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setListWidth</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setListWidth(--id--,--scrollwidth--)---------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">setListWidth</emphasis> method sets the scrollable width of a list box, in dialog units.
</para>
<para>
  The method usually produces <xref linkend="ovvInaccurate"/> results because it converts the dialog
  units to pixels using <xref linkend="atrFactorX"/>. The programmer is advised to use the
 <xref linkend="mthSetListWidthPx"/> method instead, which will produce the correct results.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The ID of the list box for which you want to set the scrollable width. May be numeric or
      <xref linkend="defSymbolicId"/>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>scrollwidth [required]</term>
    <listitem>
    <para>
      The width of the scrollable area of the list box, in dialog units.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 if <emphasis role="italic">id</emphasis> is not correct, otherwise 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A list box will display a horizontal scrollbar only if it has the <xref linkend="mthCreateListBox"/>
    style <emphasis role="bold">and</emphasis> the scrollable width of the list box is set wider than the width of the
    list box.
  </para>
  <para>
    When the <xref linkend="ovvUnderlying"/> list box is created it does not have any items
    and the list box sets its scrollable width to its own width. The list box does not update its scrollable width
    dynamically, so if an item is added to the list box whose width is wider than the list box, no scrollbar will
    appear. Likewise, for the user to be able to scroll enough to see all items in the list box, the scrollable width
    must be set to at least the width of the widest item in the list.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setListWidth() -->


<section id="mthSetListWidthPx" xreflabel="setListWidthPx"><title>setListWidthPx</title>
<indexterm><primary>setListWidthPx</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setListWidthPx</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setListWidthPx</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setListWidthPx(--id--,--scrollwidth--)-------><

]]>
</programlisting>

<para>
  The <emphasis role="italic">setListWidthPx</emphasis> method sets the scrollable width of a list box, in pixels.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The ID of the list box for which you want to set the scrollable width. May be numeric or
      <xref linkend="defSymbolicId"/>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>scrollwidth [required]</term>
    <listitem>
    <para>
      The width of the scrollable area of the list box, in pixels.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns -1 if <emphasis role="italic">id</emphasis> is not correct, otherwise 0.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    A list box will display a horizontal scrollbar only if it has the <xref linkend="mthCreateListBox"/>
    style <emphasis role="bold">and</emphasis> the scrollable width of the list box is set wider than the width of the
    list box.
  </para>
  <para>
    When the <xref linkend="ovvUnderlying"/> list box is created it does not have any items
    and the list box sets its scrollable width to its own width. The list box does not update its scrollable width
    dynamically, so if an item is added to the list box whose width is wider than the list box, no scrollbar will
    appear. Likewise, for the user to be able to scroll enough to see all items in the list box, the scrollable width
    must be set to at least the width of the widest item in the list.
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setListWidth() -->


<section id="mthSetSBPos" xreflabel="setSBPos"><title>setSBPos</title>
<indexterm><primary>setSBPos</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setSBPos</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>setSBPos</secondary></indexterm>
<programlisting>
<![CDATA[
>>--setSBPos(--id--,--pos--+----------+--)-------><
                           +-,-redraw-+

]]>
</programlisting>

<para>
  The <emphasis role="italic">setSBPos</emphasis> method sets the current position of a
 <xref linkend="clsScrollBar"/> bar control.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id</term>
    <listitem>
    <para>
      The resource ID of the scroll bar whose position is to be set. May be numeric or
      <xref linkend="defSymbolicId"/>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>pos</term>
    <listitem><para>
      The new position for the scroll bar. It must be within the defined <xref linkend="mthSetSBRange"/> of
      the scroll bar.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>redraw</term>
    <listitem>
    <para>
      <computeroutput>.true</computeroutput> or <computeroutput>.false</computeroutput>, specifying whether or not the
      scroll bar should redraw itself after it is repositioned. The default is <computeroutput>.true</computeroutput>.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthSetSBRange" xreflabel="setSBRange"><title>setSBRange</title>
<indexterm><primary>setSBRange</primary></indexterm>
<programlisting>
<![CDATA[
>>--setSBRange(--id--,--min--,--max--,--+--------+--)-----------><
                                        +-redraw-+

]]>
</programlisting>

<para>The setSBRange method sets the range of a scroll
bar control. It sets the minimum and maximum values. </para>
<variablelist>
<varlistentry><term><emphasis role="bold">Protected:</emphasis></term>
<listitem><para>This method is not intended to be used outside of the BaseDialog class.
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
<listitem><para>The arguments are:
<variablelist>
<varlistentry><term>id</term>
<listitem><para>The ID of a scroll bar control.
</para></listitem></varlistentry>
<varlistentry><term>min</term>
<listitem><para>The minimum value.
</para></listitem></varlistentry>
<varlistentry><term>max</term>
<listitem><para>The maximum value.
</para></listitem></varlistentry>
<varlistentry><term>redraw</term>
<listitem><para>A flag indicating whether (1) or not (0) the scroll bar should be redrawn.
The default is 1.
</para></listitem></varlistentry>
</variablelist>
</para></listitem></varlistentry>
<varlistentry><term><emphasis role="bold">Example:</emphasis></term>
<listitem><para>The following example allows the scroll bar to take values between 1
and 10:

<programlisting>
<![CDATA[
MyDialog~setSBRange(234, 1, 10, 1)
]]>
</programlisting>
</para></listitem></varlistentry>
</variablelist>
</section>

<section id="mthSetWindowRect" xreflabel="setWindowRect"><title>setWindowRect</title>
<indexterm><primary>setWindowRect</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>setWindowRect</secondary></indexterm>
<indexterm><primary>DialogExtensions class</primary><secondary>setWindowRect</secondary></indexterm>
<programlisting>
<![CDATA[
Form 1:

>>--setWindowRect(--hwnd--,--rectangle--+---------+--)-------------------------><
                                        +-,-opts--+

Form 2:

>>--setWindowRect(--hwnd--,--pt--,--size--+---------+--)-----------------------><
                                          +-,-opts--+

Form 3:

>>--setWindowRect(--hwnd--,--x-,--y-,--cx-,--cy--+---------+--)----------------><
                                                 +-,-opts--+

Generic form:

>>--setWindowRect(--hwnd--,--rectCoordinates--+---------+--)-------------------><
                                              +-,-opts--+

]]>
</programlisting>

<para>
  Changes the size and position of the specified window. By specifying either the NOSIZE or NOMOVE options the
  programmer can only move or only resize the window.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
    <variablelist>
      <varlistentry><term>hwnd [required]</term>
      <listitem>
      <para>
        The <xref linkend="defHandle"/> of the window to be resized and / or moved.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>rectCoordinates [required]</term>
      <listitem>
      <para>
        The coordinates for the new size and position of the window as a <link
        linkend="ovvRectangleCoordinates">point/size</link> rectangle. The coordinates specify the upper left point of the
        new position, the width of the window and the height of the window. These coordinates can be specified using
        either a <xref linkend="clsRect"/> object, a <xref linkend="clsPoint"/> and a
        <xref linkend="clsSize"/> object, or the individual x and y coordinates, width, and height values.
      </para>
      <para>
        The coordinates are specified as <xref linkend="defClientArea"/> coordinates, in pixels. All 4
        of the coordinates
      </para>
      </listitem></varlistentry>
      <varlistentry><term>opts [optional]</term>
      <listitem>
      <para>
        A list of 0 or more of the following keywords separated by spaces. Case is not significant. If this argument is
        omitted, the window is made visible, moved to the position specified by the x, y coordinates and resized to the
        width and height specified by the width and height portion of the point / size rectangle
      </para>
      <para>
      <simplelist type='vert' columns='3'>
        <member>NOSIZE    </member>
        <member>NOMOVE    </member>
        <member>HIDEWINDOW</member>
        <member>SHOWWINDOW</member>
        <member>NOREDRAW  </member>
      </simplelist>
      </para>
      <variablelist>
        <varlistentry><term>NOSIZE</term>
        <listitem>
        <para>
           The window will not be resized. The new width and height specified is ignored. The values can be 0, or any
           other value.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOMOVE</term>
        <listitem>
        <para>
          The position of the window will not be changed. The new x, y position is ignored. Again, the values can be 0, or
          any other value.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>HIDEWINDOW</term>
        <listitem>
        <para>
          In addition to any moving or resizing that is done, the window is made invisible.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>SHOWWINDOW</term>
        <listitem>
        <para>
          In addition to any moving or resizing that is done, the window is made visible.
        </para>
        </listitem></varlistentry>
        <varlistentry><term>NOREDRAW</term>
        <listitem>
        <para>
          No repainting of any kind is done. The programmer is responsible for invalidating or redrawing any parts of the
          window and <emphasis role="bold">parent</emphasis> window that need redrawing. See the
 <xref linkend="mthRedraw"/> method.
        </para>
        </listitem></varlistentry>
      </variablelist>
      </listitem></varlistentry>
    </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 for success, 1 on error. On error, check the <computeroutput>.systemErrorCode</computeroutput>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    <emphasis role="bold">Note carefully:</emphasis> If a <computeroutput>Rect</computeroutput> object is used
    to specify the point / size rectangle, the semantics are not quite correct. The <emphasis
    role="italic">right</emphasis> member of the <computeroutput>Rect</computeroutput> must contain the width of
    the window and the <emphasis role="italic">bottom</emphasis> member must contain the height of the window.
  </para>
  <para>
    When the <emphasis role="italic">showOpts</emphasis> argument contains the NOMOVE keyword, the x, y coordinates
    are ignored. Likewise, if <emphasis role="italic">showOpts</emphasis> contains NOSIZE, the width and height
    portion of the point / size rectangle is ignored.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details</emphasis></term>
  <listitem>
  <para>
    Raises syntax errors when incorrect arguments are detected.
  </para>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    This example resizes an edit control so that it takes up the entire <xref linkend="defClientArea"/>
    of the dialog:
<programlisting>
<![CDATA[

::method resizeEditControl
  expose editControl isHidden

  hwnd = self~getControlHandle(IDC_MULTILINE)
  rect = self~clientRect

  self~setWindowRect(hWnd, rect)

  if isHidden then do
    editControl~show
    isHidden = .false
  end

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>  <!-- End DialogExtensions::setWindowRect() -->


<section id="mthWriteToWindow" xreflabel="writeToWindow"><title>writeToWindow</title>
<indexterm><primary>writeToWindow</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>writeToWindow</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>writeToWindow</secondary></indexterm>
<programlisting>
<![CDATA[
>>--writeToWindow(-h-,-x-,-y-,-txt-+-------+-+------+-+--------+-+------+-+------+-)--><
                                   +-,-fnt-+ +-,-fs-+ +-,-opts-+ +-,-fg-+ +-,-bk-+
]]>
</programlisting>

<para>
  The <emphasis role="italic">writeToWindow</emphasis> method writes text to the specified dialog or dialog control
  in the given font, style, and color, at the specified position.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>h [required]</term>
    <listitem>
    <para>
      The window <xref linkend="defHandle"/> of the dialog or dialog control to write the text to.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>x, y [required]</term>
    <listitem>
    <para>
      The starting position of the text, in pixels. The position coordinates are relative to the window, by default, or
      the client area of the window, not relative to the screen. Use the CLIENT keyword in the <emphasis
      role="italic">opts</emphasis> argument to indicate the starting position is relative to the client area of the
      window.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>txt [required]</term>
    <listitem>
    <para>
      The text string to be written.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>fnt [optional]</term>
    <listitem>
    <para>
      The font name. The default if omitted is SYSTEM.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>fs [optional]</term>
    <listitem>
    <para>
      The point size of the font. If omitted, the standard size (10) is used.
    </para>
    </listitem></varlistentry>

    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. These options control
      aspects of the font and how the font is written.
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>OPAQUE     </member>
      <member>TRANSPARENT</member>
      <member>CLIENT     </member>
      <member>THIN       </member>
      <member>EXTRALIGHT </member>
      <member>LIGHT      </member>
      <member>MEDIUM     </member>
      <member>SEMIBOLD   </member>
      <member>EXTRABOLD  </member>
      <member>HEAVY      </member>
      <member>BOLD       </member>
      <member>UNDERLINE  </member>
      <member>ITALIC     </member>
      <member>STRIKEOUT  </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>OPAQUE</term>
      <listitem>
      <para>
        The background of the area the text will occupy is painted with the specified background color, or with white if
        the background color is omitted, before writing the text.  This has the effect of &quot;erasing&quot; whatever
        is currently drawn in that area. Contrast this with the TRANSPARENT option. OPAQUE is the default.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>TRANSPARENT</term>
      <listitem>
      <para>
        The background area of the text is left unchanged. (The background color option is ignored if it is used.) This
        has the effect of writing the text over the top of whatever is currently drawn in the area the text will occupy.
        Contrast this with the OPAQUE option.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CLIENT</term>
      <listitem>
      <para>
        The position for the text will be relative to the <xref linkend="defClientArea"/> of the
        specified window, rather than relative to the window itself.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>THIN</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 100.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>EXTRALIGHT</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 200.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>LIGHT</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 300.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MEDIUM</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 500.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SEMIBOLD</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 600.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>BOLD</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 700.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>EXTRABOLD</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 800.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>HEAVY</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 900.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>UNDERLINE</term>
      <listitem>
      <para>
        An underline font is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ITALIC</term>
      <listitem>
      <para>
        An italic font is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>STRIKEOUT</term>
      <listitem>
      <para>
        A strike out font is used.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>fg [optional]</term>
    <listitem>
    <para>
      The color index for the text foreground color. If omitted, the text color is left unchanged.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>bk [optional]</term>
    <listitem>
    <para>
      The color index of the background color. If omitted, the background color is left unchanged. The background color
      is not used in transparent mode.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method sets <computeroutput>.systemErrorCode</computeroutput> to the error code set by the operating system
    when a failure in one of the Win32 APIs is detected. However, there is one Win32 API,
    <computeroutput>SelectObject()</computeroutput>, that does not set the system error code on failure. It is unlikely
    that it will fail, but if it does, the ooDialog framework sets <computeroutput>.systemErrorCode</computeroutput> to
    <computeroutput>156</computeroutput>, ERROR_SIGNAL_REFUSED.
  </para>
  <para>
    The text message for error code <computeroutput>156</computeroutput> is: <emphasis role="italic">The recipient
    process has refused the signal.</emphasis> In this case, the text message is not really related to the failure, it
    is just used to indicate that the <computeroutput>SelectObject()</computeroutput> API failed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.  See the remarks above.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example writes the string <emphasis role="italic">Hello world!</emphasis> on the surface of a button
    using a blue 24pt Arial font in bold, italic style. The starting position of the text is at the point (3, 3)
    relative to the client area of the button:

<programlisting>
<![CDATA[

hwnd = self~NewPushButton(IDC_PB_CANVAS)
self~writeToWindow(hwnd, 3, 3, "Hello world!", "Arial", 24, "BOLD ITALIC CLIENT", 4)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>


<section id="mthWriteToControl" xreflabel="writeToControl"><title>writeToControl</title>
<indexterm><primary>writeToControl</primary></indexterm>
<indexterm><primary>dialog object</primary><secondary>writeToControl</secondary></indexterm>
<indexterm><primary>DialogExtensions</primary><secondary>writeToControl</secondary></indexterm>
<programlisting>
<![CDATA[
>>--writeToControl(-id-,-x-,-y-,-txt-+-------+-+------+-+--------+-+------+-+------+-)-><
                                     +-,-fnt-+ +-,-fs-+ +-,-opts-+ +-,-fg-+ +-,-bk-+

]]>
</programlisting>

<para>
  The <emphasis role="italic">writeToControl</emphasis> method writes text to the specified dialog control in the given
  font, style, and color, at the specified position.
</para>
<variablelist>
  <varlistentry><term><emphasis role="bold">Arguments:</emphasis></term>
  <listitem>
  <para>
    The arguments are:
  <variablelist>
    <varlistentry><term>id [required]</term>
    <listitem>
    <para>
      The resource ID of the dialog control to write the text to. May be numeric or
      <xref linkend="defSymbolicId"/>.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>x, y [required]</term>
    <listitem>
    <para>
      The starting position of the text, in pixels. The position coordinates are relative to the window, by default, or
      the client area of the window, not relative to the screen. Use the CLIENT keyword in the <emphasis
      role="italic">opts</emphasis> argument to indicate the starting position is relative to the client area of the
      window.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>txt [required]</term>
    <listitem>
    <para>
      The string to be written.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>fnt [optional]</term>
    <listitem>
    <para>
      The font name. The default if omitted is SYSTEM.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>fs [optional]</term>
    <listitem>
    <para>
      The point size of the font. If omitted, the standard size (10) is used.
    </para>
    </listitem></varlistentry>

    <varlistentry><term>opts [optional]</term>
    <listitem>
    <para>
      A list of 0 or more of the following keywords separated by spaces, case is not significant. These options control
      aspects of the font and how the font is written.
    </para>
    <para>
    <simplelist type='vert' columns='3'>
      <member>OPAQUE     </member>
      <member>TRANSPARENT</member>
      <member>CLIENT     </member>
      <member>THIN       </member>
      <member>EXTRALIGHT </member>
      <member>LIGHT      </member>
      <member>MEDIUM     </member>
      <member>SEMIBOLD   </member>
      <member>EXTRABOLD  </member>
      <member>HEAVY      </member>
      <member>BOLD       </member>
      <member>UNDERLINE  </member>
      <member>ITALIC     </member>
      <member>STRIKEOUT  </member>
    </simplelist>
    <variablelist>
      <varlistentry><term>OPAQUE</term>
      <listitem>
      <para>
        The background of the area the text will occupy is painted with the specified background color, or with white if
        the background color is omitted, before writing the text.  This has the effect of &quot;erasing&quot; whatever
        is currently drawn in that area. Contrast this with the TRANSPARENT option. OPAQUE is the default.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>TRANSPARENT</term>
      <listitem>
      <para>
        The background area of the text is left unchanged. (The background color option is ignored if it is used.) This
        has the effect of writing the text over the top of whatever is currently drawn in the area the text will occupy.
        Contrast this with the OPAQUE option.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>CLIENT</term>
      <listitem>
      <para>
        The position for the text will be relative to the <xref linkend="defClientArea"/> of the
        specified window, rather than relative to the window itself.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>THIN</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 100.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>EXTRALIGHT</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 200.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>LIGHT</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 300.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>MEDIUM</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 500.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>SEMIBOLD</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 600.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>BOLD</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 700.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>EXTRABOLD</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 800.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>HEAVY</term>
      <listitem>
      <para>
        The weight of the font in a range of 0 through 1000 will be 900.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>UNDERLINE</term>
      <listitem>
      <para>
        An underline font is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>ITALIC</term>
      <listitem>
      <para>
        An italic font is used.
      </para>
      </listitem></varlistentry>
      <varlistentry><term>STRIKEOUT</term>
      <listitem>
      <para>
        A strike out font is used.
      </para>
      </listitem></varlistentry>
    </variablelist>
    </para>
    </listitem></varlistentry>
    <varlistentry><term>fg [optional]</term>
    <listitem>
    <para>
      The color index for the text foreground color. If omitted, the text color is left unchanged.
    </para>
    </listitem></varlistentry>
    <varlistentry><term>bk [optional]</term>
    <listitem>
    <para>
      The color index of the background color. If omitted, the background color is left unchanged. The background color
      is not used in transparent mode.
    </para>
    </listitem></varlistentry>
  </variablelist>
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Return value:</emphasis></term>
  <listitem>
  <para>
    Returns 0 on success and 1 on error.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Remarks:</emphasis></term>
  <listitem>
  <para>
    This method sets <computeroutput>.systemErrorCode</computeroutput> to the error code set by the operating system
    when a failure in one of the Win32 APIs is detected. However, there is one Win32 API,
    <computeroutput>SelectObject()</computeroutput>, that does not set the system error code on failure. It is unlikely
    that it will fail, but if it does, the ooDialog framework sets <computeroutput>.systemErrorCode</computeroutput> to
    <computeroutput>156</computeroutput>, ERROR_SIGNAL_REFUSED.
  </para>
  <para>
    The text message for error code <computeroutput>156</computeroutput> is: <emphasis role="italic">The recipient
    process has refused the signal.</emphasis> In this case, the text message is not really related to the failure, it
    is just used to indicate that the <computeroutput>SelectObject()</computeroutput> API failed.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Details:</emphasis></term>
  <listitem>
  <para>
    Sets the <xref linkend="dotSystemErrorCode"/>.  See the remarks above.
  </para>
  </listitem></varlistentry>
  <varlistentry><term><emphasis role="bold">Example:</emphasis></term>
  <listitem>
  <para>
    The following example writes the string <emphasis role="italic">I am done!</emphasis> to the client area of a static
    control. The font of the text will be a blue 18pt Arial font in bold, italic style. The starting position of the
    text is at the point (5, 5) relative to the client area of the static control.

<programlisting>
<![CDATA[

self~writeToControl(IDC_ST_BLANK, 5, 5, "I am done!", "Arial", 18, "BOLD ITALIC CLIENT", 4)

]]>
</programlisting>
  </para>
  </listitem></varlistentry>
</variablelist>
</section>

</section>
