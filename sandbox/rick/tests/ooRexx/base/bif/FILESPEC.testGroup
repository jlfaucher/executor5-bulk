#!/usr/bin/env rexx
/*
  SVN Revision: $Rev$
  Change Date:  $Date$
*/
/*----------------------------------------------------------------------------*/
/*                                                                            */
/* Copyright (c) 2005-2018 Rexx Language Association. All rights reserved.    */
/*                                                                            */
/* This program and the accompanying materials are made available under       */
/* the terms of the Common Public License v1.0 which accompanies this         */
/* distribution. A copy is also available at the following address:           */
/* http://www.oorexx.org/license.html                                         */
/*                                                                            */
/* Redistribution and use in source and binary forms, with or                 */
/* without modification, are permitted provided that the following            */
/* conditions are met:                                                        */
/*                                                                            */
/* Redistributions of source code must retain the above copyright             */
/* notice, this list of conditions and the following disclaimer.              */
/* Redistributions in binary form must reproduce the above copyright          */
/* notice, this list of conditions and the following disclaimer in            */
/* the documentation and/or other materials provided with the distribution.   */
/*                                                                            */
/* Neither the name of Rexx Language Association nor the names                */
/* of its contributors may be used to endorse or promote products             */
/* derived from this software without specific prior written permission.      */
/*                                                                            */
/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */
/* "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */
/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */
/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */
/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */
/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */
/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */
/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */
/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */
/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */
/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */
/*                                                                            */
/*----------------------------------------------------------------------------*/
  parse source . . fileSpec
  group = .TestGroup~new(fileSpec)

  group~add(.FILESPEC.testGroup)

  if group~isAutomatedTest then return group

  testResult = group~suite~execute~~print

return testResult

::requires 'ooTest.frm' -- load the ooRexxUnit classes

::class "FILESPEC.testGroup" subclass ooTestCase public

::method testPath01
  if .ooRexxUnit.OSName == "WINDOWS" then do
      self~assertSame("", filespec("P", "Foo.bar"))
      self~assertSame("a\b\", filespec("P", "a\b\Foo.bar"))
      self~assertSame("\a\b c\", filespec("p", "\a\b c\Foo.bar"))
      self~assertSame("\a\b\", filespec("p", "\a\b\Foo.bar"))
      self~assertSame("\a\b\", filespec("p", "\a\b\Foo Bar.dat"))
      self~assertSame("\a\b\", filespec("P", "c:\a\b\Foo.bar"))
      self~assertSame("..\b\", filespec("P", "..\b\Foo.bar"))
      self~assertSame(".\b\", filespec("P", ".\b\Foo.bar"))
      self~assertSame("", filespec("P", ""))
  end
  else do
      self~assertSame("", filespec("P", "Foo.bar"))
      self~assertSame("a/b/", filespec("p", "a/b/Foo.bar"))
      self~assertSame("/a/b/", filespec("P", "/a/b/Foo.bar"))
      self~assertSame("../b/", filespec("P", "../b/Foo.bar"))
      self~assertSame("./b/", filespec("P", "./b/Foo.bar"))
      self~assertSame("", filespec("P", ""))
  end

::method testLocation01
  if .ooRexxUnit.OSName == "WINDOWS" then do
      self~assertSame("", filespec("L", "Foo.bar"))
      self~assertSame("a\b\", filespec("L", "a\b\Foo.bar"))
      self~assertSame("\a\b\", filespec("l", "\a\b\Foo.bar"))
      self~assertSame("c:\a\b\", filespec("L", "c:\a\b\Foo.bar"))
      self~assertSame("\a\b\", filespec("l", "\a\b\Foo Bar.dat"))
      self~assertSame("\a\b c\", filespec("l", "\a\b c\Foo.bar"))
      self~assertSame("", filespec("l", ""))
  end
  else do
      self~assertSame("", filespec("L", "Foo.bar"))
      self~assertSame("a/b/", filespec("l", "a/b/Foo.bar"))
      self~assertSame("/a/b/", filespec("L", "/a/b/Foo.bar"))
      self~assertSame("", filespec("l", ""))
  end

::method testExtension01
  if .ooRexxUnit.OSName == "WINDOWS" then do
      self~assertSame("", filespec("E", "Foobar"))
      self~assertSame("bar", filespec("E", "Foo.bar"))
      self~assertSame("bar", filespec("E", "a\b\Foo.bar"))
      self~assertSame("bar", filespec("E", "a\b.c\Foo.bar"))
      self~assertSame("", filespec("E", "a\b.c\Foobar"))
      self~assertSame("", filespec("E", "a\b.c\Foo bar"))
      self~assertSame("bar", filespec("e", "..\b\Foo.bar"))
      self~assertSame("bar", filespec("e", "..\b\Foo Bar.bar"))
      self~assertSame("", filespec("e", "..\b\Foobar"))
      self~assertSame("bar", filespec("e", ".\b\Foo.bar"))
      self~assertSame("", filespec("e", ".\b\Foobar"))
      self~assertSame("", filespec("e", ""))
  end
  else do
      self~assertSame("", filespec("E", "Foobar"))
      self~assertSame("bar", filespec("E", "Foo.bar"))
      self~assertSame("bar", filespec("E", "a/b/Foo.bar"))
      self~assertSame("bar", filespec("E", "a/b.c/Foo.bar"))
      self~assertSame("", filespec("E", "a/b.c/Foobar"))
      self~assertSame("bar", filespec("e", "../b/Foo.bar"))
      self~assertSame("", filespec("e", "../b/Foobar"))
      self~assertSame("bar", filespec("e", "./b/Foo.bar"))
      self~assertSame("", filespec("e", "./b/Foobar"))
      self~assertSame("", filespec("e", ""))
  end

::method testName01
  if .ooRexxUnit.OSName == "WINDOWS" then do
      self~assertSame("Foobar", filespec("n", "Foobar"))
      self~assertSame("Foo.bar", filespec("n", "Foo.bar"))
      self~assertSame("Foo.bar", filespec("N", "a\b\Foo.bar"))
      self~assertSame("Foo.bar", filespec("n", "a\b.c\Foo.bar"))
      self~assertSame("Foo Bar.bar", filespec("n", "a\b.c\Foo Bar.bar"))
      self~assertSame("Foo Bar", filespec("n", "a\b.c\Foo Bar"))
      self~assertSame("", filespec("n", "a\b.c\"))
      self~assertSame("Foo.bar", filespec("n", "..\b\Foo.bar"))
      self~assertSame("", filespec("n", "..\b\"))
      self~assertSame("", filespec("n", "c:"))
      self~assertSame("Foo.bar", filespec("n", "c:Foo.bar"))
      self~assertSame("", filespec("n", ""))
  end
  else do
      self~assertSame("Foobar", filespec("n", "Foobar"))
      self~assertSame("Foo.bar", filespec("n", "Foo.bar"))
      self~assertSame("Foo.bar", filespec("N", "a/b/Foo.bar"))
      self~assertSame("Foo.bar", filespec("n", "a/b.c/Foo.bar"))
      self~assertSame("", filespec("n", "a/b.c/"))
      self~assertSame("Foo.bar", filespec("n", "../b/Foo.bar"))
      self~assertSame("", filespec("n", "../b/"))
      self~assertSame("", filespec("n", ""))
  end

::method testDrive01
  if .ooRexxUnit.OSName == "WINDOWS" then do
      self~assertSame("", filespec("d", "Foobar"))
      self~assertSame("", filespec("D", "a\b\Foo.bar"))
      self~assertSame("d:", filespec("D", "d:\a\b\Foo.bar"))
      self~assertSame("c:", filespec("d", "c:"))
      self~assertSame("C:", filespec("d", "C:"))
      self~assertSame("c:", filespec("d", "c:Foo.bar"))
      self~assertSame("", filespec("d", ""))
  end

::method testSyntax01
  self~expectSyntax(88.901)
  x = filespec()

::method testSyntax02
  self~expectSyntax(88.901)
  x = filespec('E')

::method testSyntax03
  self~expectSyntax(88.901)
  x = filespec(,'a.b')

::method testSyntax04
  self~expectSyntax(88.922)
  x = filespec('e', 'a.b', 'x')

::method testSyntax05
  self~expectSyntax(40.904)
  x = filespec('', 'a.b')

::method testSyntax06
  self~expectSyntax(40.904)
  x = filespec('x', 'a.b')

::method testSyntax07
  if .ooRexxUnit.OSName \== "WINDOWS" then do
      self~assertSame("", filespec("d", "a.b"))
  end


::options novalue error
