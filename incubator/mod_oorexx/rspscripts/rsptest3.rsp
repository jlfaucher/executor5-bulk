<?rexx
/*----------------------------------------------------------------------------*/
/*                                                                            */
/* Copyright (C) W. David Ashley 2004-2008. All Rights Reserved.              */
/* Copyright (c) 2009-2009 Rexx Language Association. All rights reserved.    */
/*                                                                            */
/* This program and the accompanying materials are made available under       */
/* the terms of the Common Public License v1.0 which accompanies this         */
/* distribution. A copy is also available at the following address:           */
/* http://www.ibm.com/developerworks/oss/CPLv1.0.htm                          */
/*                                                                            */
/* Redistribution and use in source and binary forms, with or                 */
/* without modification, are permitted provided that the following            */
/* conditions are met:                                                        */
/*                                                                            */
/* Redistributions of source code must retain the above copyright             */
/* notice, this list of conditions and the following disclaimer.              */
/* Redistributions in binary form must reproduce the above copyright          */
/* notice, this list of conditions and the following disclaimer in            */
/* the documentation and/or other materials provided with the distribution.   */
/*                                                                            */
/* Neither the name of Rexx Language Association nor the names                */
/* of its contributors may be used to endorse or promote products             */
/* derived from this software without specific prior written permission.      */
/*                                                                            */
/* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS        */
/* "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT          */
/* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS          */
/* FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT   */
/* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,      */
/* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED   */
/* TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,        */
/* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY     */
/* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING    */
/* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS         */
/* SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.               */
/*                                                                            */
/* Author: W. David Ashley                                                    */
/*                                                                            */
/* Description: Test RSP page. Prints the current month's calendar.           */
/*                                                                            */
/*----------------------------------------------------------------------------*/
?>
<html>
<head>
<title>Calendar</title>
</head>
<body bgcolor="#ffffff">
<br />
<center>
<h1>Calendar</h1>
</center>
<hr />
<br />
<center>

<?rexx
sdate = date('S')
cdate = substr(sdate, 7) + 0
/* for OS/2 Classic Rexx use the following instead */
/* month = date('M') || ' - ' || substr(sdate, 1, 4) */
month = date('M', sdate, 'S') || ' - ' || substr(sdate, 1, 4)
startday = (date('B', substr(sdate, 1, 6) || '01', 'S') // 7) + 2
if startday > 7 then startday = startday - 7
lastsdate = substr(sdate, 1, 6) || '01'
if substr(lastsdate, 5, 2) = '12' then ,
 nextdate = (substr(lastsdate, 1, 4) + 1) || '0101'
else nextsdate = substr(lastsdate, 1, 4) || ,
 right(substr(lastsdate, 5, 2) + 1, 2, '0') || '01'
days = date('B', nextsdate, 'S') - date('B', lastsdate, 'S')

/* output the table headers */
say '<table border="1">'
say '<tr><td colspan="7" align ="center"><b>'month'</b></td></tr>'
say '<tr>'
say '<td align="center" width="30">Sun</td>'
say '<td align="center" width="30">Mon</td>'
say '<td align="center" width="30">Tue</td>'
say '<td align="center" width="30">Wed</td>'
say '<td align="center" width="30">Thu</td>'
say '<td align="center" width="30">Fri</td>'
say '<td align="center" width="30">Sat</td>'
say '</tr>'

/* output the table contents */
day = 0
do i = 1 to 6
   if day >= days then iterate
   say '<tr>'
   do j = 1 to 7
      say '<td align="right">'
      if i = 1 then do
         if j >= startday then day = day + 1
         end
      else day = day + 1
      if day = 0 | day > days then say '&nbsp;'
      else do
         if day = cdate then say '<b>'day'</b>'
         else say day
         end
      say '</td>'
      end
   say '</tr>'
   end

/* output the table footer */
say '</table>'
?>

</center>
</body>
</html>
