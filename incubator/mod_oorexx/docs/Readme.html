<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Apache Mod_ooRexx Interface Package</title>
</head>
<body bgcolor="#FFFFFF">

<center>
<h1>Apache Mod_ooRexx<br />
<a href="http://www.opensource.org/docs/definition.php">
<img src="http://www.opensource.org/trademarks/opensource/web/opensource-110x95.png"
 border="0" width="110" height="95" alt="Open Source Logo" /></a>
<a href="http://sourceforge.net">
<img src="http://sourceforge.net/sflogo.php?group_id=106456&amp;type=5"
    width="210" height="62" border="0" alt="SourceForge.net Logo" /></a>
</h1>
</center>

<pre>
Package: Mod_ooRexx

Version: 2.2.0

Author:  W. David Ashley
         IBM Lab Services - pSeries Linux Consultant
         <a href="mailto:dashley@us.ibm.com">dashley@us.ibm.com</a>
</pre>

<center>
<p style="color: red">
<u>Warning! Warning! Warning! Warning! Warning! Warning! Warning! Warning!
Warning! Warning! Warning! Warning!</u></p>
</center>
<p style="color: red">This version of Mod_ooRexx works with Apache 2.2
only. You should carefully read this
documentation before installing or using this version of Mod_ooRexx.
You must have Open Object Rexx 4.0.0 or later installed. Mod_ooRexx does NOT
work with any other Rexx interpreter.</p>

<p>This software is subject to the terms of the Common Public License. You must
accept the terms of this license to use this software. Refer to
<a href="./CPLv1.0.htm">CPLv1.0.htm</a> for more information.</p>
<p>This package provides an interface from Apache to
Open Object Rexx (version 4.0.0 or later) under Windows, AIX and
Linux. To use the package you do not need to know how to write Apache
modules, but you do need a general understanding of how Apache processes
requests.</p>
<p>This package is not an Apache module tutorial/reference.</p>
<p>There are changes in this release of Mod_ooRexx which will require some
changes to your ooRexx scripts if you are upgrading from Mod_Rexx.
The builtin function WWWGETARGS has changed
and you will need to adjust your scripts accordingly.</p>

<p>Many people have contributed to this effort and I want to thank some of
them here.</p>

Rick McGuire - Open Object Rexx Team Lead Architect
<br />Mark Hessling - Maintainer of Regina Rexx
<br />Rony G. Flatscher - Open Object Rexx Team
<br />Mark Miesfeld - Open Object Rexx Team

<br /><br /><br /><br /><br />
<h2>Table of Contents</h2>
<a href="#Whatis">
What is Mod_ooRexx</a>
<br /><a href="#WinInstall">
Windows Package Installation</a>
<br /><a href="#UnixInstall">
Unix Package Installation</a>
<br /><a href="#WinInfo">
Windows Information</a>
<br /><a href="#UnixInfo">
Unix Information</a>
<br /><a href="#Otherplat">
Other Platforms</a>
<br /><a href="#VersionInfo">
Version History</a>
<br /><a href="#ProblemInfo">
Known Problems</a>
<br /><a href="./RexxDirs.html">
Mod_ooRexx Apache Configuration Directives</a>
<br /><a href="./ApacheCls.html">
Apache Object Rexx Class Documentation</a>
<br /><a href="./RexxFuncs.html">
ooRexx Apache External Functions</a>
<br /><a href="./RexxVars.html">
Available ooRexx Variables</a>
<br /><a href="./RexxHowTo.html">
Mod_ooRexx HowTo</a>
<br /><a href="./RSP.html">
ooRexx Server Pages</a>
<br /><a href="#Future">
Future Enhancements</a>

<br /><br />
<hr />
<br />

<h2><a name="Whatis">
What is Mod_ooRexx</a></h2>
<p>Mod_ooRexx is <b>NOT</b> a CGI environment for ooRexx. Your ooRexx CGI programs
will not run under Mod_ooRexx without significant modifications. The Mod_ooRexx
execution environment is CGI-like, but even that is not a proper definition
of the environment.</p>
<p>Mod_ooRexx is a very powerful package that can bring full control of the
Apache request process to the ooRexx programmer. When Apache receives a request
it divides the processing of that request into phases. Each of these phases
is responsible for a small part of the request.</p>
<br />
<center>
<img src="./figure1.jpg" alt="Figure 1" />
</center>
<br />
<ol>
<li>Post Read Request Phase - This phase can modify the request itself after
the request has been read.</li>
<li>URI Translation Phase - This phase maps the URI request to a physical file,
virtual document produced by an external script, or a document generated by
an internal module.</li>
<li>Header Parser Phase - Another chance to examine the request headers.</li>
<li>Access Control Phase - This is the first of three phases that handle
authentication and authorization. This phase should perform simple access
control based on the browser's IP address, hostname, or some other simple
attribute of the programmer's choice.</li>
<li>Authentication Phase - This phase is called whenever the requested file
is password-protected. Usually this phase checks the userid and password.
This is the second phase involved in authentication and authorization.</li>
<li>Authorization Phase - Actually determines if the user is actually
authorized to access the requested URI. This is the third (and last) phase
involved in authentication and authorization.</li>
<li>MIME Type Check Phase - This phase assignes a provisional MIME type to
the request.</li>
<li>Fixup Phase - This is the last chance to modify the request before the
response handler phase is called.</li>
<li>Response Handler Phase - This is also known as the content handler phase.
This phase is responsible for actually returning the requested information
to the browser either dynamically or statically, by returning a file.
This handler acts somewhat like a CGI program but the runtime environment
for this phase is very different from the traditional CGI environment.</li>
<li>Log Phase - This phase is responsible for logging the request.</li>
</ol>
<p>Each of these phases can have a ooRexx script assigned to it. In most cases
you will probably only assign a script to the Response Phase, but it is
possible for a ooRexx script to fully process any phase. Mod_ooRexx defines
directives which are placed into the Apache configuration file which then
define how a ooRexx script is assigned to a particular request phase.</p>
<p>For more information about how the Apache request phases work I highly
recommend the book <cite>The Apache Modules Book</cite> by
Nick Kew published by Prentice Hall ISBN: 0-13-240967-4.</p>

<br /><br /><br /><br /><br />
<h2><a name="WinInstall">
Windows Package Installation</a></h2>
<p>
To install the package on Windows, unzip the contents to a temporary
subdirectory. Move the following files to these locations (where x: is the
Apache server install drive):</p>
<br />
<pre>
   mod_oorexx.dll ->     x:\Program Files\Apache Software Foundation\Apache2.2\modules

   rspcomp.rex    ->     x:\Program Files\Apache Software Foundation\Apache2.2\bin

   Apache.cls     ->     x:\Program Files\Apache Software Foundation\Apache2.2
                              or
                         somewhere in the system PATH

   test.rex       ->     For testing purposes place all these files in Apache's
   otest1.rex            document root subdirectory. You can move them later.
   footer.rex
   access.rex
   rsptest1.rsp
   rsptest2.rsp
   rsptest3.rsp
</pre>

<p>In the httpd.conf file (located in Apache conf directory) insert the following lines:</p>
<br />
<center>
<table border="1" cellpadding="4" cellspacing="0" width="90%">
<tr><td valign="top" bgcolor="#e6e6e6">
<pre>
 # The following line needs to be added to the end of the appropriate
 # httpd.conf LoadModule list
 LoadModule oorexx_module modules/mod_oorexx.dll

 # The following lines should be added at the end of the http.conf file
 #
 AddType application/x-httpd-rexx-script .rex .rexx
 AddType application/x-httpd-rexx-rsp .rsp

 #Add these for ooRexx Server Page support
 RexxTempFileNameTemplate "c:/temp/execrsp?????.rex"
 RexxRspCompiler "c:/Program Files/Apache Group/Apache2/bin/rspcomp.rex"
</pre>
</td></tr>
</table>
</center>
<p>
You may need to modify the lines above if your Apache server modules subdirectory is
not located in the specified place.</p>
<p>
Now restart the Apache server.</p>
<p>
To test that the package is working start your browser and enter the following
URL (where your.domain.com is the name of your server):</p>

<br />
<center>
<table border="1" cellpadding="4" cellspacing="0" width="90%">
<tr><td valign="top" bgcolor="#e6e6e6">
<pre>
http://your.domain.com/test.rex
</pre>
</td></tr>
</table>
</center>
<p>
This should execute the ooRexx program test.rex and a sample HTML page
should be displayed.</p>
<p>
To build your own Apache ooRexx programs just code your program and place it
anywhere in Apache's document tree. Your ooRexx programs should have a file
extension which matches one of the extensions listed in the</p>
<pre>
 AddType application/x-httpd-rexx-script .rex .rexx
</pre>
<p>line of the Apache configuration file. When a browser request for a
document arrives at the Apache server it checks the file extension of the
document with its list of handlers and then passes that document to the
appropriate handler. In this case, if the file extension matches, then the
document will be passed to Mod_ooRexx and executed as a ooRexx program.</p>

<br /><br /><br /><br /><br />
<h2><a name="UnixInstall">
Unix Package Installation</a></h2>
<p>
To install the package on Unix, unzip the contents to a temporary subdirectory. Move
the following files to these locations:</p>
<br />
<pre>
   mod_oorexx.so  ->     /opt/Apache2.2/modules
                              or
                         /etc/httpd/modules
                              or
                         the modules location of your Apache Server

   rexx.conf      ->     /opt/Apache2.2/conf.d
                              or
                         /etc/httpd/conf.d
                              or
                         the conf location of your Apache Server

   rspcomp.rex    ->     /usr/bin
                              or
                  ->     /opt/Apache2.2/bin
                              or
                         the bin location of your Apache Server

   Apache.cls     ->     /usr/bin
                              or
                         somewhere in the system PATH

   test.rex       ->     For testing purposes place all these files in Apache's
   otest1.rex            document root subdirectory. You can move them later.
   fotter.rex
   access.rex            Note that ooRexx program files do NOT need to be marked
   rsptest1.rsp          executable in order for Mod_ooRexx to execute them. If
   rsptest2.rsp          you do not mark them executable then they cannot be
   rsptest3.rsp          executed outside of the Mod_ooRexx environment by
                         accident or maliciously through the standard Apache
                         CGI interface.
</pre>
<p><b>Note:</b> Be sure to check the install locations against the entries
in the rexx.conf file. The entries in this file may need to be modified
to reflect your install. locations.
<p>
Be sure the mod_oorexx.so file is marked executable.</p>
<p>
Now restart the Apache server.</p>
<p>
To test that the package is working start your browser and enter the following
URL (where your.domain.com is the name of your server):</p>
<br />
<center>
<table border="1" cellpadding="4" cellspacing="0" width="90%">
<tr><td valign="top" bgcolor="#e6e6e6">
<pre>
http://your.domain.com/test.rex
</pre>
</td></tr>
</table>
</center>
<p>
This should execute the ooRexx program test.rex and a sample HTML page
should be displayed.</p>
<p>
To build your own Apache ooRexx programs just code your program and place it
anywhere in Apache's document tree. Your ooRexx programs should have a file
extension which matches one of the extensions listed in the</p>
<pre>
 AddType application/x-httpd-rexx-script .rex .rexx
</pre>
<p>line of the Apache configuration file. When a browser request for a
document arrives at the Apache server it checks the file extension of the
document with its list of handlers and then passes that document to the
appropriate handler. In this case, if the file extension matches, then the
document will be passed to Mod_ooRexx and executed as a ooRexx program.</p>

<br /><br /><br /><br /><br />
<h2><a name="WinInfo">Windows Information</a></h2>
<p>This package has not been tested yet on Windows.</p>
<p>All the source files, except makefile.nt and the ooRexx sample scripts,
are in Unix format (lines are delimited only by a line feed).</p>

<br /><br /><br /><br /><br />
<h2><a name="UnixInfo">Unix Information</a></h2>
<p>For Linux, the package was compiled under Fedora 10 using the standard GCC
compiler installed from Fedora 10. You will need to
compile your own module for your version of GCC, Linux/AIX, or Apache.</p>
<p>The package was tested using</p>
<ul>
<li>Apache2 for Linux Version 2.2.11-2.</li>
<li>Open Object Rexx for Linux version 4.0.0 (pre-release SVN revision 4320</li>
<li>Fedora 10.</li>
</ul>
<p>For AIX, this package has not been tested yet.</p>
<p>All the source files, except the ooRexx sample scripts,
are in Unix format (lines are delimited only by a line feed).</p>

<br /><br /><br /><br /><br />
<h2><a name="Otherplat">
Other Platforms</a></h2>
<p>If you undertake to compile and test Mod_ooRexx on any platform other than
Linux, AIX or Windows I would appreciate hearing from you.
I would also appreciate
a copy of the makefile used to compile the source for the platform you
used so it can be included in subsequent releases of Mod_ooRexx.</p>

<br /><br /><br /><br /><br />
<h2><a name="VersionInfo">
Version History</a></h2>
<pre>
 Date       Author      Description
 ---------- ----------- -------------------------------------------------------
 2009-03-26 WD Ashley   v2.2.0 Support for Apache 2.2 (rewrite of Mod_Rexx 2.2)
</pre>

<br /><br /><br /><br /><br />
<h2><a name="ProblemInfo">
Known Problems</a></h2>
<ol>
<li>The binary files supplied with this release do not work with versions of
Open Object Rexx which do not match the version used during
compilation and linking. You may need to upgrade your version of ooRexx or
recompile Mod_ooRexx with your version of ooRexx before you get a working
mod_oorexx binary.</li>
<li>During Apache subrequest processing <b>none</b> of the ooRexx handlers
will be invoked. They will always DECLINE the request. This is to prevent
an infinite recursion problem with non-response/content handlers.</li>
<li>Output from the Rexx TRACE instruction will be sent to the
Apache error log. Input to
the TRACE instruction will not be allowed. This limitation has been
imposed due to a problem with ooRexx sending error information to the client
browser as an unknown MIME-type when a ooRexx program/script crashes.</li>
<li>You should not attempt to do I/O to stdin, stdout or stderr in ooRexx
scripts running under Mod_ooRexx since they are not attached to traditional
file system or console handles.</li>
<li>OS/2 is not a supported Mod_ooRexx environment.</li>
<li>If you are using Rexx/SQL in combination with Mod_ooRexx be sure you are using
the latest version which is thread-safe. Otherwise you will have strange problems
and crashes. Also, on Windows, be sure to define all databases used by Mod_ooRexx
via 'SYSTEM DSN'. Databases defined with 'USER DSN' are not available in the
Apache/Mod_ooRexx environment.</li>
</ol>

<br /><br /><br /><br /><br />
<h2><a name="Future">
Future Enhancements</a></h2>
<ol>
<li>Add full autoconf support.</li>
</ol>

<br />
<table border="0" cellpadding="4" cellspacing="0" width="90%">
<tr><td valign="middle">
  <a href="http://validator.w3.org/check/referer">
  <img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!"
       height="31" width="88" />
  </a>
</td>
<td valign="middle">
<img src="./pb_apache_oorexx.gif" alt="Powered by Rexx" />
<br />Copyright (C) W. David Ashley 2004-2008. All Rights Reserved.
<br />Copyright (C) Rexx Language Association 2009-2009. All Rights Reserved.
</td></tr>
</table>

</body>
</html>

