<!--#########################################################################
    #
    # Description: Open Object Rexx: OODialog Reference SGML file.
    #
    # Copyright (c) 2005-2006, Rexx Language Association. All rights reserved.
    # Portions Copyright (c) 2004, IBM Corporation. All rights reserved.
    #
    # This program and the accompanying materials are made available under
    # the terms of the Common Public License v1.0 which accompanies this
    # distribution. A copy is also available at the following address:
    # http://www.oorexx.org/license.html
    #
    # Redistribution and use in source and binary forms, with or
    # without modification, are permitted provided that the following
    # conditions are met:
    #
    # Redistributions of source code must retain the above copyright
    # notice, this list of conditions and the following disclaimer.
    # Redistributions in binary form must reproduce the above copyright
    # notice, this list of conditions and the following disclaimer in
    # the documentation and/or other materials provided with the distribution.
    #
    # Neither the name of Rexx Language Association nor the names
    # of its contributors may be used to endorse or promote products
    # derived from this software without specific prior written permission.
    #
    # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
    # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    # OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    # SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
    # TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
    # OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
    # OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    #
    # Author(s):
    #      W. David Ashley <dashley@us.ibm.com>
    #
    #########################################################################
-->
<chapter id="anibut"><title>AnimatedButton Class</title>
<indexterm><primary>AnimatedButton class</primary></indexterm>
<para>The AnimatedButton class provides the methods to
implement an animated button within a dialog. The attributes and methods are
only described briefly in this document. An example program,
<computeroutput>oowalker.rex</computeroutput>,
is provided with the OODialog sample programs. </para>
<variablelist>
<varlistentry><term>ParentDlg</term>
<listitem><para>Attribute holding the handle of the parent dialog
</para></listitem></varlistentry>
<varlistentry><term>Stopped</term>
<listitem><para>Animation ends when set to 1 (see Stop method)
</para></listitem></varlistentry>
<varlistentry><term>Init</term>
<listitem><para>Initialize the animation parameters:</para>
<programlisting>
<![CDATA[
but = .AnimatedButton~new(buttonid,from,to, ,
                          movex,movey,sizex,sizey,delay, ,
                          startx,starty,parentdialog)
]]>
</programlisting>
<para>The values are
stored in a stem variable: </para>
<variablelist>
<varlistentry><term>sprite.buttonid</term>
<listitem><para>ID of animation button
</para></listitem></varlistentry>
<varlistentry><term>sprite.from</term>
<listitem><para>Array of in-memory bitmap handles, or a bitmap resource ID in a DLL,
or the name of an array in the .local directory containing handles to bitmaps
loaded with <link linkend="h000667">LoadBitmap</link>.
The array has to start with 1 and continue in increments by 1.
</para></listitem></varlistentry>
<varlistentry><term>sprite.to</term>
<listitem><para>0 if sprite.from is an array, or the name of
an array stored in <computeroutput>.local</computeroutput>,
or a bitmap resource ID in a DLL
</para></listitem></varlistentry>
<varlistentry><term>sprite.movex</term>
<listitem><para>Size of one move horizontally (pixels)
</para></listitem></varlistentry>
<varlistentry><term>sprite.movey</term>
<listitem><para>Size of one move vertically
</para></listitem></varlistentry>
<varlistentry><term>sprite.sizex</term>
<listitem><para>Horizontal size of all bitmaps (pixels)
</para></listitem></varlistentry>
<varlistentry><term>sprite.sizey</term>
<listitem><para>Vertical size of all bitmaps
</para></listitem></varlistentry>
<varlistentry><term>sprite.delay</term>
<listitem><para>Time delay between moves (ms)
</para></listitem></varlistentry>
</variablelist>
<para>Startx and starty
are the initial bitmap position, and parentdialog
is stored in the ParentDlg attribute.</para>
<para>Two more
values are initialized in the stem variable: </para>
<variablelist>
<varlistentry><term>sprite.smooth</term>
<listitem><para>Set to 1 for smooth edge change (can be changed to 0 for
a bouncy edge change)
</para></listitem></varlistentry>
<varlistentry><term>sprite.step</term>
<listitem><para>Set to 1 as the step size between sprite.from
and sprite.to for bitmaps in a DLL
</para></listitem></varlistentry>
</variablelist>
</listitem></varlistentry>
<varlistentry><term>SetSprite</term>
<listitem><para>Set all the sprite. animation values using a stem:
<programlisting>
<![CDATA[
mysprite.from = .array~of(bmp1,bmp2,...)
mysprite.to = 0
mysprite.movex = ...
...
self~setSprite(mysprite.)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>GetSprite</term>
<listitem><para>Retrieve the animation values into a stem:
<programlisting>
<![CDATA[
self~getSprite(mysprite.)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>SetFromTo</term>
<listitem><para>Set bitmap information (sprite.from and sprite.to):
<programlisting>
<![CDATA[
self~setFromTo(bmpfrom,bmpto)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>SetMove</term>
<listitem><para>Set size of one move (sprite.movex and sprite.movey):
<programlisting>
<![CDATA[
self~setMove(movex,movey)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>SetDelay</term>
<listitem><para>Set delay between moves in milliseconds (sprite.delay):
<programlisting>
<![CDATA[
self~setDelay(delay)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>SetSmooth</term>
<listitem><para>Set smooth (1) or bouncy (0) edges (sprite.smooth):
<programlisting>
<![CDATA[
self~setSmooth(smooth)  /* 1 or 0 */
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>SetStep</term>
<listitem><para>Set the step size (sprite.step) between sprite.from and
sprite.to for bitmaps in a DLL, for example, if bitmap resources are numbered
202, 204, 206, etc:
<programlisting>
<![CDATA[
self~setFromTo(202,210)
self~setStep(2)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>Run</term>
<listitem><para>Run the animation by going through all the bitmaps repetitively
until dialog is stopped; invokes MoveSeq:
<programlisting>
<![CDATA[
self~run
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>MoveSeq</term>
<listitem><para>Animate one sequence through all the bitmaps in the given move
steps; invokes MovePos:
<programlisting>
<![CDATA[
self~moveSeq
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>MovePos</term>
<listitem><para>Move the bitmaps by the arguments:
<programlisting>
<![CDATA[
self~movePos(movex,movey)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>MoveTo</term>
<listitem><para>Move the bitmaps in the predefined steps to
the given position; invokes MoveSeq:
<programlisting>
<![CDATA[
self~moveTo(posx,posy)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>SetPos</term>
<listitem><para>Set the new starting position of the bitmaps:
<programlisting>
<![CDATA[
self~setPos(newx,newy)
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>GetPos</term>
<listitem><para>Retrieve the current position into a stem:
<programlisting>
<![CDATA[
self~getPos(pos.)
say "pos=" pos.x pos.y
]]>
</programlisting>
</para></listitem></varlistentry>
<varlistentry><term>ParentStopped</term>
<listitem><para>Check the parent dialog window and return its finished attribute (1
means finished)
</para></listitem></varlistentry>
<varlistentry><term>Stop</term>
<listitem><para>Stop animation by setting the stopped attribute to 1
</para></listitem></varlistentry>
<varlistentry><term>HitRight</term>
<listitem><para>Invoked by run when the bitmap hits the right edge (returns 1 and bitmap
starts at left again; you can return 0 and set the new position yourself)
</para></listitem></varlistentry>
<varlistentry><term>HitLeft</term>
<listitem><para>Invoked when the bitmap hits the left edge (default action is to start
at right again)
</para></listitem></varlistentry>
<varlistentry><term>HitBottom</term>
<listitem><para>Invoked when the bitmap hits the bottom edge (default action is to start
at top again)
</para></listitem></varlistentry>
<varlistentry><term>HitTop</term>
<listitem><para>Invoked when the bitmap hits the top edge (default action is to start
at bottom again)
</para></listitem></varlistentry>
</variablelist>
<para>To use an animated button a dialog has to: </para>
<itemizedlist>
<listitem><para>Define a button in a resource file (owner-drawn)</para></listitem>
<listitem><para>Load the bitmaps of the animation into memory using an array</para></listitem>
<listitem><para>Initialize the animated button with the animation parameters</para></listitem>
<listitem><para>Invoke the run method of the animated button</para></listitem>
<listitem><para>Stop the animation and remove the bitmaps from memory</para></listitem>
</itemizedlist>
<para>The dialog may also dynamically change the parameters (for example, the
size of a move, or the speed) and override actions, such as hitting an edge.</para>
<para>See the <computeroutput>oowalker.rex</computeroutput> and
<computeroutput>oowalk2.rex</computeroutput> examples in
<computeroutput>OODIALOG\SAMPLES</computeroutput>.</para>
<para>For further information see
<link linkend="h001393">ConnectAnimatedButton</link>.</para>
</chapter>
